{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/ProductManagement/Analytics.vue?vue&type=style&index=0&id=7aba25a4&scoped=true&lang=css&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/ProductManagement/Analytics.vue","mtime":1658121468786},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouVGl0bGVzLW1haW4gewogIGZvbnQtc2l6ZTogMS40ZW07Cn0KLlRpdGxlcy1zdWIgewogIG1hcmdpbjogMDsKfQo="},{"version":3,"sources":["Analytics.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6cA;AACA;AACA;AACA;AACA;AACA","file":"Analytics.vue","sourceRoot":"src/portal/Chatbot/Dashboard/ProductManagement","sourcesContent":["<template>\n  <div class=\"dash-cont\" style=\"margin-left: 0px; padding: 0px;\">\n    <div class=\"container-fluid\" style=\"padding: 0px;\">\n    <!-- <iframe width=\"1020\" height=\"800\" src=\"https://datastudio.google.com/embed/reporting/4459fc44-46a9-431e-b601-3a91639557d2/page/1M\" frameborder=\"0\" style=\"border:0\" allowfullscreen></iframe> -->\n  <div class=\"dash-card\">\n    <div class=\"card-header\" style=\"padding-left: 0px\">\n      <h1>Google Analytics</h1>\n    </div>\n  <div id=\"analytics_page\" class=\"card-body\" style=\"padding: 0px;\">\n  <template v-if=\"!isSignedIn\" style=\"height: 600px;\">\n    <div class=\"col-sm-12 p-0\">\n    <h5 style=\"margin-bottom: 25px;\">Please Sign-In to your Google Analytics Account by clicking below button.</h5>\n    <a id=\"auth-button\" style=\"cursor: pointer;\"></a>\n    <div class=\"ViewSelector d-flex mb-3\" id=\"view-selector-container\"></div>\n    </div>\n  </template>\n  <template v-else>\n    <div class=\"col-sm-12 d-flex p-0\">\n      <div style=\"font-size: 20px; font-weight: bold;\">Welcome, {{username}}</div>\n      <div class=\"ml-auto\">\n        <button @click=\"logout()\" class=\"darkblue-btn\" id=\"signout-button\" style=\"cursor: pointer; font-size: 1rem; padding: 6px 15px;\">Sign Out</button>\n      </div>\n    </div>\n    <hr>\n    <!-- <div id=\"view-name\"></div> -->\n    <div class=\"col-sm-12 d-flex mt-4 p-0\">\n      <div class=\"ViewSelector d-flex mb-3\" id=\"view-selector-container\"></div>\n      <div class=\"card-act d-flex ml-auto\">\n        <div class=\"form-group mb-0\">\n          <select\n            class=\"form-control\"\n            @change=\"chart_dropdown\"\n            id=\"exampleFormControlSelect1\"\n          >\n            <option value=\"Last 7 days\">Last 7 days</option>\n            <option value=\"Last 30 days\">Last 30 days</option>\n            <option value=\"Last 3 months\">Last 3 months</option>\n            <option value=\"Last 9 months\">Last 9 months</option>\n            <option value=\"Last 12 months\">Last 12 months</option>\n          </select>\n        </div>\n      </div>\n    </div>\n    <hr />\n    <div\n      class=\"grid-container\"\n      style=\"\n        display: grid;\n        grid-template-columns: auto auto;\n        grid-column-gap: 20px;\n        grid-row-gap: 20px;\n        backgroud-color: #c8c8c8;\n      \"\n    >\n      <div class=\"grid-item\">\n        <h1 class=\"Titles-main\">Active User Trend</h1>\n        <p class=\"Titles-sub\">{{ range }}</p>\n        <div id=\"activeuser-container\"></div>\n      </div>\n      <div class=\"grid-item\">\n        <h1 class=\"Titles-main\">Top Devices</h1>\n        <p class=\"Titles-sub\">{{ range }}\n          <a @click=\"download_report('usersbydevice')\" style=\"cursor: pointer;\">\n          <img src=\"/img/download_file.png\" title=\"Download report\" style=\"width: 4%; margin-left: auto\" alt />\n        </a></p>\n        <div id=\"device-chart\"></div>\n      </div>\n      <div class=\"grid-item\">\n        <h1 class=\"Titles-main\">Traffic Source</h1>\n        <p class=\"Titles-sub\">{{ range }}\n          <a @click=\"download_report('usersbysource')\" style=\"cursor: pointer;\">\n          <img src=\"/img/download_file.png\" title=\"Download report\" style=\"width: 4%; margin-left: auto\" alt />\n        </a></p>\n        <div id=\"source-chart\"></div>\n      </div>\n      <div class=\"grid-item\">\n        <h1 class=\"Titles-main\">Most viewed Pages</h1>\n        <p class=\"Titles-sub\" style=\"margin-bottom: 25px\">{{ range }}\n          <a @click=\"download_report('usersbypageview')\" style=\"cursor: pointer;\">\n          <img src=\"/img/download_file.png\" title=\"Download report\" style=\"width: 4%; margin-left: auto\" alt />\n        </a></p>\n        <div id=\"pageview-container\"></div>\n      </div>\n    </div>\n    <div>\n        <h1 class=\"Titles-main\">Users by City</h1>\n        <p class=\"Titles-sub\">{{ range }}\n        <a @click=\"download_report('usersbycity')\" style=\"cursor: pointer;\">\n          <img src=\"/img/download_file.png\" title=\"Download report\" style=\"width: 2%; margin-left: auto\" alt />\n        </a></p>\n        <div id=\"country-chart\"></div>\n      </div>\n    <!-- <div id=\"activeuser-container\"></div>\n    <div id=\"pageview-container\"></div>\n    <div id=\"device-chart\"></div>\n    <div id=\"source-chart\"></div> -->\n    <!-- <div id=\"country-chart\"></div> -->\n  </template>\n  </div>\n  </div>\n  </div>\n  </div>\n</template>\n<script>\nimport swal from 'sweetalert2';\nimport { freeze_portal } from \"@/portal/mixins\";\n\n// import(\"../ProductManagement/AnalyticsImports/view-selector2.js\");\n// import(\"../ProductManagement/AnalyticsImports/date-range-selector.js\");\nexport default {\n  name: \"AnalyticsPage\",\n  mixins: [\n    freeze_portal,\n  ],\n  data() {\n    return {\n      chart_dropdown_value: \"7daysAgo\",\n      range: \"Last 7 days\",\n      newIds: null,\n      isSignedIn: false,\n      username: \"\",\n      timepass: '',\n      usersbycity_download: null,\n      usersbydevice_download: null,\n      usersbypageview_download: null,\n      usersbysource_download: null,\n    };\n  },\n  created() {},\n  mounted() {\n    setTimeout(() => {\n      this.freeze_portal();\n    }, 1000);    \n    const vm = this;\n    // var client_id = \"386372534756-ot9ncbarelh6lqefm6sa2jgq9d387von.apps.googleusercontent.com\";\n\n    gapi.analytics.ready(function () {\n      //   gapi.analytics.auth.authorize(\n      //   {\n      //   container: \"auth-button\",\n      //   userInfoLabel: \"Welcome \",\n      //   clientid: client_id,\n      // });\n\n      // Step 4: Create the view selector.\n     var viewSelector = new gapi.analytics.ViewSelector({\n        container: \"view-selector-container\",\n      });\n\n    var check = gapi.analytics.auth.isAuthorized();\n    if(check != false){\n      var user = gapi.analytics.auth.getUserProfile()\n      vm.username = user.name;\n      viewSelector.execute();\n      vm.isSignedIn = true;\n    }else {\n      vm.login();\n    }\n      // Step 5: Create the chart.\n      // A method is called while excuting viewSelector for Charts\n\n      var deviceQuery = new gapi.analytics.report.Data({\n        query: {\n          \"start-date\": vm.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics: \"ga:sessions\",\n          dimensions: \"ga:deviceCategory\",\n        },\n      });\n\n      deviceQuery.on(\"success\", function (response) {\n        // console.log(\"deviceQuery\", response);\n        vm.usersbydevice_download = response;\n      });\n\n      var pageviewQuery = new gapi.analytics.report.Data({\n        query: {\n          \"start-date\": vm.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics:\n            \"ga:pageviews,ga:timeOnPage\",\n          sort: \"-ga:pageviews\",\n          dimensions: \"ga:pagePath\",\n          \"max-results\": 10,\n        },\n      });\n\n      pageviewQuery.on(\"success\", function (response) {\n        // console.log(\"pageviewQuery\", response);\n        vm.usersbypageview_download = response;\n      });\n\n      var activeusersQuery = new gapi.analytics.report.Data({\n        query: {\n          \"start-date\": \"90daysAgo\",\n          \"end-date\": \"today\",\n          metrics: \"ga:users\",\n          dimensions: \"ga:date\",\n          \"max-results\": 10,\n        },\n      });\n\n      activeusersQuery.on(\"success\", function (response) {\n        // console.log(\"activeusersQuery\", response);\n      });\n\n      var countrycityQuery = new gapi.analytics.report.Data({\n        query: {\n          \"start-date\": vm.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics: \"ga:users\",\n          dimensions: \"ga:country, ga:city\",\n          sort: \"-ga:users\"\n        },\n      });\n\n      countrycityQuery.on(\"success\", function (response) {\n        // console.log(\"countrycityQuery\", response);\n        vm.usersbycity_download = response;\n      });\n\n      var sourceQuery = new gapi.analytics.report.Data({\n        query: {\n          \"start-date\": vm.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics: \"ga:users\",\n          dimensions: \"ga:source\",\n          sort: \"-ga:users\",\n          \"max-results\": 10,\n        },\n      });\n\n      sourceQuery.on(\"success\", function (response) {\n        // console.log(\"sourceQuery\", response);\n        vm.usersbysource_download = response\n      });\n\n      // Step 6: Hook up the components to work together.\n      gapi.analytics.auth.on(\"success\", function (response) {\n        var user = gapi.analytics.auth.getUserProfile();\n        vm.username = user.name;\n        viewSelector.execute();\n        vm.isSignedIn = true;\n      });\n      viewSelector.on(\"change\", function (ids) {\n        vm.newIds = {\n          query: {\n            ids: ids,\n          },\n        };        \n        vm.chart_dropdown();\n\n        deviceQuery.set(vm.newIds).execute();\n        pageviewQuery.set(vm.newIds).execute();\n        // activeusersQuery.set(vm.newIds).execute();\n        countrycityQuery.set(vm.newIds).execute();\n        sourceQuery.set(vm.newIds).execute();\n      });\n    });\n  },\n  methods: {\n    download_report(type){\n      this.spinnerOn = true;\n      var rows = [];\n      var filename = \"\";\n\n      if(type == 'usersbydevice'){\n        var data = this.usersbydevice_download;\n        var csv = 'DeviceCategory,Session\\n';\n        filename = \"Users by Device category report.csv\";\n      }else if(type == 'usersbysource'){\n        var data = this.usersbysource_download;\n        var csv = 'Source,UsersCount\\n';\n        filename = \"Users by Source report.csv\";\n      }else if(type == 'usersbycity'){\n        var data = this.usersbycity_download;\n        var csv = 'Country,City,UsersCount\\n';  \n        filename = \"Users by City report.csv\";\n      }else if(type == 'usersbypageview'){\n        var data = this.usersbypageview_download;\n        var csv = 'PagePath,PageView,TimeOnPage\\n'; \n        filename = \"Users by Page view report.csv\";\n      }\n      for(var i in data.rows){\n        rows.push(data.rows[i]);\n      }\n    rows.forEach(function(row) {  \n            csv += row.join(',');  \n            csv += \"\\n\";  \n    });  \n     \n    var hiddenElement = document.createElement('a');  \n    hiddenElement.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);  \n    hiddenElement.target = '_blank';  \n    hiddenElement.download = filename;  \n    hiddenElement.click();\n    this.spinnerOn = false;\n    },\n    login() {\n      var response = new gapi.analytics.auth.authorize(\n        {\n        container: \"auth-button\",\n        userInfoLabel: \"Welcome \",\n        clientid: process.env.VUE_APP_G_AUTH,\n      });\n      // var response = new gapi.analytics.auth.authorize({\n      //   serverAuth: {\n      //    access_token: temp_access_token\n      //   }\n      // });\n      var render_button = $(\"#auth-button\");\n      if(render_button[0].childElementCount == 0){\n        swal({\n                text:\n                  \"Refresh the page to access the Analytics\",\n                type: \"info\",\n                showConfirmButton: true,\n                showCancelButton: true,\n                cancelButtonColor: \"#d33\",\n              }).then(result => {\n                if(result.value){\n                  this.$router.go();\n                }\n              });\n      }\n      response.on(\"needsAuthorization\", function () {\n        this.isSignedIn = false;\n      });\n      response.on(\"signIn\", function () {\n        this.isSignedIn = true;\n      });\n      response.on(\"error\", function () {\n        this.isSignedIn = false;\n      });\n    },\n    logout() {\n      var response = gapi.analytics.auth.signOut();\n      // console.log(response);\n      response.on(\"signOut\", function (response) {\n        this.isSignedIn = false;\n      });\n      this.$router.go();\n\n    },\n    chart_dropdown() {\n      if (event.target.value == \"Last 7 days\") {\n        this.range = event.target.value;\n        this.chart_dropdown_value = \"7daysAgo\";\n      } else if (event.target.value == \"Last 30 days\") {\n        this.range = event.target.value;\n        this.chart_dropdown_value = \"30daysAgo\";\n      } else if (event.target.value == \"Last 3 months\") {\n        this.range = event.target.value;\n        this.chart_dropdown_value = \"90daysAgo\";\n      } else if (event.target.value == \"Last 9 months\") {\n        this.range = event.target.value;\n        this.chart_dropdown_value = \"180daysAgo\";\n      } else if (event.target.value == \"Last 12 months\") {\n        this.range = event.target.value;\n        this.chart_dropdown_value = \"365daysAgo\";\n      }\n      if (event.target.value == undefined) {\n        this.range = \"Last 7 days\";\n      }\n\n      var activeuserChart = new gapi.analytics.googleCharts.DataChart({\n        // reportType: 'ga',\n        query: {\n          \"start-date\": this.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics: \"ga:sessions,ga:users\",\n          dimensions: \"ga:date\",\n        },\n        chart: {\n          container: \"activeuser-container\",\n          type: \"LINE\",\n          options: { width: \"500\", height: \"450\" },\n        },\n      });\n      var pageviewChart = new gapi.analytics.googleCharts.DataChart({\n        // reportType: 'ga',\n        query: {\n          \"start-date\": this.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics: \"ga:pageviews,ga:avgTimeOnPage\",\n          sort: \"-ga:pageviews\",\n          dimensions: \"ga:pagePath\",\n          \"max-results\": 5,\n        },\n        chart: {\n          container: \"pageview-container\",\n          type: \"TABLE\",\n          options: { width: \"540\", height: \"450\" },\n        },\n      });\n\n      var deviceChart = new gapi.analytics.googleCharts.DataChart({\n        query: {\n          \"start-date\": this.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics: \"ga:users\",\n          dimensions: \"ga:deviceCategory\",\n        },\n        chart: {\n          container: \"device-chart\",\n          type: \"PIE\",\n          options: {\n            width: \"450\",\n            height: \"450\",\n            pieHole: 0.4,\n          },\n        },\n      });\n\n      var sourceChart = new gapi.analytics.googleCharts.DataChart({\n        query: {\n          \"start-date\": this.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics: \"ga:users, ga:sessions\",\n          dimensions: \"ga:source\",\n          sort: \"-ga:users\",\n          \"max-results\": 4,\n        },\n        chart: {\n          container: \"source-chart\",\n          type: \"COLUMN\",\n          options: { width: \"500\", height: \"560\" },\n        },\n      });\n\n      var countrycityChart = new gapi.analytics.googleCharts.DataChart({\n        query: {\n          \"start-date\": this.chart_dropdown_value,\n          \"end-date\": \"today\",\n          metrics: \"ga:users\",\n          dimensions: \"ga:city\",\n          sort: \"-ga:users\",\n          \"max-results\": 10\n        },\n        chart: {\n          container: \"country-chart\",\n          type: \"COLUMN\",\n          options: {\n            width: \"100%\", height: \"400\",\n          // region: \"IN\",\n          // resolution: 'provinces',\n          // displayMode: \"markers\",\n        },\n        }\n      });\n      // console.log(this.newIds);\n      activeuserChart.set(this.newIds).execute();\n      pageviewChart.set(this.newIds).execute();\n      deviceChart.set(this.newIds).execute();\n      sourceChart.set(this.newIds).execute();\n      countrycityChart.set(this.newIds).execute();\n    },\n  },\n};\n</script>\n<style scoped>\n.Titles-main {\n  font-size: 1.4em;\n}\n.Titles-sub {\n  margin: 0;\n}\n</style>"]}]}