{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/analytics/components/StackedBarchartNonTime.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/analytics/components/StackedBarchartNonTime.vue","mtime":1643027096188},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmNvbnN0IGQzID0gcmVxdWlyZSgiZDMiKTsKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogIlN0YWNrZWRCYXJDaGFydE5vblRpbWUiLAogICAgcHJvcHM6IHsKICAgICAgICBkYXRhOiBBcnJheSwKICAgICAgICB4S2V5OiBTdHJpbmcsCiAgICAgICAgeUtleTogU3RyaW5nLAogICAgICAgIHByaW1hcnlfY29sOiBTdHJpbmcsICAKICAgICAgICBzZWNvbmRhcnlfY29sOiBTdHJpbmcsCiAgICAgICAgY3VycmVuY3lfa2V5OiBTdHJpbmcKICAgIH0sCiAgbW91bnRlZCAoKSB7CiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmN1cnJlbmN5X2tleSkKICAgIHZhciB2bSA9IHRoaXM7CiAgICB2YXIgbWFwID0gdGhpcy5kYXRhLnJlZHVjZSgociwgaSkgPT4gKChyW2lbdm0ucHJpbWFyeV9jb2xdXSA9IHJbaVt2bS5wcmltYXJ5X2NvbF1dIHx8IFtdKS5wdXNoKHsKICAgICAgICBkYXRlIDogaVt2bS5zZWNvbmRhcnlfY29sXSwKICAgICAgICBzYWxlczogaVt2bS55S2V5XQogICAgICAgICAgICAgLy8gaQogICAgfSksIHIpLCB7fSk7CiAgICB2YXIgZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKG1hcCk7CiAgICBjb25zdCBzZWNvbmRfZGF0YSA9IFtdOwogICAgZm9yKGxldCBpID0wOyBpIDwgZW50cmllcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBzZWNvbmRfZGF0YS5wdXNoKHsKICAgICAgICAgICAgU3RhdGUgOiBlbnRyaWVzW2ldWzBdLAogICAgICAgIH0pCiAgICAgICAgZm9yKGxldCBqID0wIDsgaiA8IGVudHJpZXNbaV1bMV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgdmFyIHRlbXAgPSBPYmplY3QudmFsdWVzKGVudHJpZXNbaV1bMV1bal0pOwogICAgICAgICAgICB2YXIgYSA9IHRlbXBbMF0sCiAgICAgICAgICAgICAgICBiID0gdGVtcFsxXTsKICAgICAgICAgICAgc2Vjb25kX2RhdGFbaV1bYV0gPSBiOwogICAgICAgIH0KICAgIH0KCiAgICB2YXIgIGRhdGEgPSBbXTsKICAgIGRhdGEgPSBzZWNvbmRfZGF0YTsKICAgIGxldCBrZXlfZGF0YV90ZW1wID0gW10sCiAgICBrZXlfZGF0YV90ZW1wX2xlbmd0aCA9IFtdOwogICAgZm9yKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspewogICAgICAgIGtleV9kYXRhX3RlbXAucHVzaChkMy5rZXlzKGRhdGFbaV0pLnNsaWNlKDEpKQogICAgICAgIGtleV9kYXRhX3RlbXBfbGVuZ3RoLnB1c2goZDMua2V5cyhkYXRhW2ldKS5zbGljZSgxKS5sZW5ndGgpCiAgICB9CgogICAgLy8gY29uc29sZS5sb2coa2V5X2RhdGFfdGVtcCk7CiAgICAvLyBjb25zb2xlLmxvZyhrZXlfZGF0YV90ZW1wX2xlbmd0aCk7CiAgICAvLyBjb25zb2xlLmxvZyhNYXRoLm1heCguLi5rZXlfZGF0YV90ZW1wX2xlbmd0aCkpCiAgICAvLyBjb25zb2xlLmxvZyhpbmRleE9mTWF4KGtleV9kYXRhX3RlbXBfbGVuZ3RoKSkKICAgIHZhciBrZXlzID0ga2V5X2RhdGFfdGVtcFtpbmRleE9mTWF4KGtleV9kYXRhX3RlbXBfbGVuZ3RoKV0KICAgIGZ1bmN0aW9uIGluZGV4T2ZNYXgoYXJyKSB7CiAgICBpZiAoYXJyLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICB2YXIgbWF4ID0gYXJyWzBdOwogICAgdmFyIG1heEluZGV4ID0gMDsKCiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChhcnJbaV0gPiBtYXgpIHsKICAgICAgICAgICAgbWF4SW5kZXggPSBpOwogICAgICAgICAgICBtYXggPSBhcnJbaV07CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiBtYXhJbmRleDsKICAgIH0KICAgIGxldCBrZXlfZGF0YV90ZW1wXzIgPSBbXTsKICAgIGZvcihsZXQgaSA9MDsgaSA8IGtleV9kYXRhX3RlbXAubGVuZ3RoOyBpKyspewogICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCBrZXlfZGF0YV90ZW1wW2ldLmxlbmd0aDsgaisrKXsKICAgICAgICAgICAga2V5X2RhdGFfdGVtcF8yLnB1c2goa2V5X2RhdGFfdGVtcFtpXVtqXSkKICAgICAgICB9CiAgICB9CiAgICAvLyB2YXIga2V5cyA9IGQzLmtleXMoZGF0YVswXSkuc2xpY2UoMSk7CiAgICAvLyBjb25zb2xlLmxvZyhrZXlfZGF0YV90ZW1wKTsKICAgIC8vIGNvbnNvbGUubG9nKGtleV9kYXRhX3RlbXBfMiwgIkhFUlJSRUVFIik7CiAgICAvLyB2YXIgeHl6ID0ga2V5X2RhdGFfdGVtcF8yLmZpbHRlcigodmFsdWUsaW5kZXgpID0+IGtleV9kYXRhX3RlbXBfMi5pbmRleE9mKHZhbHVlKSA9PT0gaW5kZXgpOwogICAgdmFyIHh5eiA9IGtleV9kYXRhX3RlbXBfMi5yZWR1Y2UoZnVuY3Rpb24oYSxiKXsKICAgICAgICBpZihhLmluZGV4T2YoYikgPCAwICkgYS5wdXNoKGIpOwogICAgICAgIHJldHVybiBhOwogICAgfSwgW10pCiAgICAvLyBjb25zb2xlLmxvZyh4eXosICdIRVJFIEZPUiBESVNUSU5DVCcpCiAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgIC8vIGNvbnNvbGUubG9nKGtleXMpOwogICAgLy8gdmFyIGtleXMgPSB4eXo7CiAgICAvLyB2YXIga2V5cyA9IFsiT1BFTiIsICJBUkJJVFJBVElPTiIsICJERU5JRUQiLCAiRHJvcHBlZCIKICAgIC8vICwgIlBBSUQiLCAiUGFpZCBJbiBGdWxsIl0KICAgIC8vICAiU3RvcHBlZCIsICJUbyBMaXRpZ2F0ZSIsICJUcmFuc2ZlcmVkIEtIIiwgIkRJU0NIQVJHRUQiLCAiU1RPUFBFRCIsICJMaWVuIiwgIlNFTlQgVE8gTElUSUdBVElPTiIsICJUcmFuc2ZlcnJlZCB0byBLSCAiLCAiUGFpZCBJbiBGdWxsIiwgCiAgICAvLyAiRG8gTm90IEJpbGwiLCAiVHJhbnNmZXJlZCIsICJDT0xMRUNUIiwgIkRBVEEgRU5UUlkiLCAiQ29sbGVjdCIsICJXcml0ZSBvZmYiXTsKICAgIC8vIGNvbnNvbGUubG9nKGtleXMpOwogICAgZm9yKGxldCBpPSAwOyBpPCBkYXRhLmxlbmd0aDsgaSsrKXsKICAgICAgICBmb3IgKHZhciBqID0gMCwgdCA9IDA7IGogPCBrZXlzLmxlbmd0aDsgKytqKSB7CiAgICAgICAgICAgIHQgKz0gZGF0YVtpXVtrZXlzW2pdXSA9ICtkYXRhW2ldW2tleXNbal1dOwogICAgICAgIH0KICAgIGRhdGFbaV0udG90YWwgPSB0OwogICAgfQogICAgdmFyIGlzU2Nyb2xsRGlzcGxheWVkID0gIGZhbHNlLAogICAgbnVtQmFycyA9IDI1OwogICAgdmFyIG1hcmdpbk92ZXJ2aWV3ID0ge3RvcDogMzAsIHJpZ2h0OiAxMCwgYm90dG9tOiAyMCwgbGVmdDogNzB9OwogICAgdmFyIGhlaWdodE92ZXJ2aWV3ID0gODAgLSBtYXJnaW5PdmVydmlldy50b3AgLSBtYXJnaW5PdmVydmlldy5ib3R0b207CiAgICBpZihlbnRyaWVzLmxlbmd0aCA+IDI1ICkgeyBpc1Njcm9sbERpc3BsYXllZCA9IHRydWU7IH0KICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpCgoKICAgIHZhciBzdmcgPSBkMy5zZWxlY3QoIiNTdGFja2VkQmFyQ2hhcnROb25UaW1lIiksCiAgICAgICAgbWFyZ2luID0ge3RvcDogMTAsIHJpZ2h0OiAwLCBib3R0b206IDEwLCBsZWZ0OiAzMH0sCiAgICAgICAgd2lkdGggPSArc3ZnLmF0dHIoIndpZHRoIikgLSBtYXJnaW4ubGVmdCAtIG1hcmdpbi5yaWdodCwKICAgICAgICBoZWlnaHQgPSArc3ZnLmF0dHIoImhlaWdodCIpIC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b20sCiAgICAgICAgZyA9IHN2Zy5hcHBlbmQoImciKS5hdHRyKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKCIgKyBtYXJnaW4ubGVmdCArICIsIiArIG1hcmdpbi50b3AgKyAiKSIpOwoKICAgIC8vIHNldCB4IHNjYWxlCiAgICB2YXIgeCA9IGQzLnNjYWxlQmFuZCgpCiAgICAgICAgLnJhbmdlUm91bmQoWzUwLCAod2lkdGgtICguMTUgKiB3aWR0aCApKV0pCiAgICAgICAgLnBhZGRpbmdJbm5lcigwLjA1KQogICAgICAgIC5hbGlnbigwLjEpOwoKICAgIC8vIHNldCB5IHNjYWxlCiAgICB2YXIgeSA9IGQzLnNjYWxlTGluZWFyKCkKICAgICAgICAucmFuZ2VSb3VuZChbaGVpZ2h0LTE1MCwgMF0pOwoKICAgIC8vIHNldCB0aGUgY29sb3JzCiAgICAvLyB2YXIgeiA9IGQzLnNjYWxlT3JkaW5hbCgpCiAgICAvLyAgICAgICAgIC5yYW5nZShbIiM5OGFiYzUiLCAiIzhhODlhNiIsICIjN2I2ODg4IiwgIiM2YjQ4NmIiLCAiI2EwNWQ1NiIsICIjZDA3NDNjIiwgIiNmZjhjMDAiXSk7CiAgICAKICAgIC8vIHZhciB6ID0gZDMuc2NhbGVPcmRpbmFsKCkKICAgIC8vICAgICAgICAgLnJhbmdlKFsiIzVkNjJiNSIsICIjMjljM2JlIiwgIiNmMTcyNmUiLCAiI2ZiYzUzZiIsICIjNjJiNThmIiwgIiNkMDc0M2MiLCAiI2ZmOGMwMCIsIiNjYTAwMjAiLCIjZjRhNTgyIiwiI2Q1ZDVkNSIsIiM5MmM1ZGUiLCIjMDU3MWIwIiwiIzA1MTliMCJdKTsKCiAgICAvLyB2YXIgeiA9IGQzLnNjYWxlT3JkaW5hbCgpCiAgICAvLyAgICAgICAgIC5yYW5nZShbIiNGRjk3NTAiLCIjM0ZCQzExIiwgIiM1ZDYyYjUiLCAiIzI5YzNiZSIsICIjZjE3MjZlIiwgIiNmYmM1M2YiLCAiIzYyYjU4ZiIsICIjZDA3NDNjIiwiI2NhMDAyMCIsIiNmNGE1ODIiLCIjOTJjNWRlIiwiIzA1NzFiMCIsICIjZDNmZTE0IiwgIiNmZWM3ZjgiLCAiIzBiN2IzZSIsICIjMGJmMGU5IiwnI0U2NjZCMycsICcjMzM5OTFBJywgJyNDQzk5OTknLCAnI0IzQjMxQScsICcjMDBFNjgwJywKICAgIC8vICAgICAgICAgJyNGRjlBQTInLCAnI0ZGQjdCMicsICcjRkZEQUMxJywgJyNCNUVBRDcnLCAnIzYzZDJhOCcsICIjMjI1YTRiIiwgIiNlNWRmNzMiLCAnIzY2NjZGRicsJyNmZjAwMDAJJywnI2EyNzk4ZicsJyNkN2M2Y2YnLCcjZTg4NzU4JywnI2IxM2ExNScsJyM2ZDM2NTYnLCcjZmZmYTkwJywnI2E0ZmZhYScsJyNhNmNiZmYnLCcjODUwMGY5JywnI2IwNzdiYScsJwkjNzY1Mjg0JywnIzk4NGI2NycsJyM5YzYyNGUnLCcjZmViOGZmJywnIzliZTNiZCcsJyM3NzU5MzQnLCcjMDA4Mzg1JywnIzZhMmNhMScsJyNlNjBlNjgnLCcjZmY2ZDAxJywnI2ZlZTlkMycKICAgIC8vICAgICAgICAgXSk7CiAgICB2YXIgeiA9IGQzLnNjYWxlT3JkaW5hbCgpCiAgICAgICAgICAgIC5yYW5nZShbIiNGQkIzMTciLCIjRkY5NzUwIiwiIzNGQkMxMSIsIiMwMEM3RTYiLCIjRUEzMzc5IiwiIzAxNjVmYyIsIiM0MWZkZmUiLCIjMjRhMGVkIiwiIzFhYzFkZCIsIiM3ZGY5ZmYiLCIjM2YwMGZmIiwiIzA4ZmYwOCIsIiNhZWZmNmUiLCIjNTZmY2EyIiwiIzQ1Y2VhMiIsIiMwNmMyYWMiLCIjZmU2NzAwIiwiI2ZmMzUwMyIsIiNkOTAxNjYiLCIjYmUwM2ZkIiwiI2FkMGFmZCIsIiM2NjAwZmYiLCIjZDAxYzFmIiwiI2YxMTcyZiIsIiNmZmY2MDAiLCIjZmNkMTE2IiwiI2NmZmYwNCIsIiNmZmMzMjQiLCIjZjRjNDMwIiwiI0ZFN0Q2OCIsIiM3MTAxOTMiLAogICAgICAgICAgICAiIzA0OTJDMiIsIiM5ODk3QTkiLCIjNjMyQTBEIiwiIzlBNzk0RSIsIiMxNTFFM0QiLCIjNTk3ODhEIiwiIzFFNDU2RSIsIiMwMTYwNjQiLCIjNDhBQUFEIiwiIzdFN0Q5QyIsIiMzMDMxNTAiLCIjNjA5RDlFIiwiIzI4N0U5RSIsIiNFNEE4MzQiLCIjMDI4OTEwIiwKICAgICAgICAgICAgIiMzNzM3MzciLCIjNkM2MjZEIiwiIzU4NEQ1QiIsIiM0RDRDNUMiXSk7CgogICAgLy8gdmFyIHogPSBbIiM1ZDYyYjUiLCAiIzI5YzNiZSIsICIjZjE3MjZlIiwgIiNmYmM1M2YiLCAiIzYyYjU4ZiIsICIjZDA3NDNjIiwiI2NhMDAyMCIsIiNmNGE1ODIiLCIjOTJjNWRlIiwiIzA1NzFiMCIsICIjZDNmZTE0IiwgIiNmZWM3ZjgiLCAiIzBiN2IzZSIsICIjMGJmMGU5IiwnI0U2NjZCMycsICcjMzM5OTFBJywgJyNDQzk5OTknLCAnI0IzQjMxQScsICcjMDBFNjgwJywKICAgIC8vICcjRkY5QUEyJywgJyNGRkI3QjInLCAnI0ZGREFDMScsICcjQjVFQUQ3JywgJyM2M2QyYTgnLCAiIzIyNWE0YiIsICIjZTVkZjczIiwgJyM2NjY2RkYnLCcJI2ZmMDAwMAknLCcjYTI3OThmJywnI2Q3YzZjZicsJyNlODg3NTgnLCcjYjEzYTE1JywnIzZkMzY1NicsJyNmZmZhOTAnLCcjYTRmZmFhJywnI2E2Y2JmZicsJyM4NTAwZjknLCcjYjA3N2JhJywnCSM3NjUyODQnLCcjOTg0YjY3JywnIzljNjI0ZScsJyNmZWI4ZmYnLCcjOWJlM2JkJywnIzc3NTkzNCcsJyMwMDgzODUnLCcjNmEyY2ExJywnI2U2MGU2OCcsJyNmZjZkMDEnLCcjZmVlOWQzJwogICAgLy8gXTsKCiAgICAvLyB2YXIgeiA9ICBkMy5zY2FsZU9yZGluYWwoKQogICAgLy8gICAgLmRvbWFpbihkYXRhLm1hcChkID0+IGRbIk91dGNvbWUiXSkpCiAgICAvLyAgICAucmFuZ2UoZDMucXVhbnRpemUodCA9PiBkMy5pbnRlcnBvbGF0ZVNwZWN0cmFsICAodCAqIDAuOCArIDAuMSksIGRhdGEubGVuZ3RoKS5yZXZlcnNlKCkpOwoKCiAgICBkYXRhLnNvcnQoZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYi50b3RhbCAtIGEudG90YWw7IH0pOwogICAgaWYoaXNTY3JvbGxEaXNwbGF5ZWQpIHsKICAgICAgICB4LmRvbWFpbihkYXRhLnNsaWNlKDAsbnVtQmFycykubWFwKGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuU3RhdGU7IH0pKTsKICAgIH0gZWxzZSB7CiAgICAgICAgeC5kb21haW4oZGF0YS5tYXAoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5TdGF0ZTsgfSkpOwogICAgfQogICAgeS5kb21haW4oWzAsIGQzLm1heChkYXRhLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnRvdGFsOyB9KV0pLm5pY2UoKTsKICAgIHouZG9tYWluKGtleXMpOwoKICAgIGlmKGlzU2Nyb2xsRGlzcGxheWVkKSB7CiAgICAgICAgCiAgICAgICB2YXIgc3RhY2tzID0gZy5hcHBlbmQoImciKQogICAgICAgIC5hdHRyKCJjbGFzcyIsICJzdGFja3MiKQogICAgICAgIC5zZWxlY3RBbGwoImciKQogICAgICAgIC5kYXRhKGQzLnN0YWNrKCkua2V5cyhrZXlzKShkYXRhLnNsaWNlKDAsbnVtQmFycykpKQogICAgICAgIC5lbnRlcigpLmFwcGVuZCgiZyIpCiAgICAgICAgLmF0dHIoImNsYXNzIiwgIi5iYXItcG9zaXRpdmUtc3RhY2siKQogICAgICAgIC5hdHRyKCJmaWxsIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geihkLmtleSk7IH0pCiAgICAgICAgLnNlbGVjdEFsbCgicmVjdCIpCiAgICAgICAgLmRhdGEoZnVuY3Rpb24oZCkgeyByZXR1cm4gZDsgfSkKICAgICAgICAuZW50ZXIoKS5hcHBlbmQoInJlY3QiKQogICAgICAgIC5hdHRyKCJjbGFzcyIsICIuYmFyLXBvc2l0aXZlLXJlY3QiKQogICAgICAgIC5hdHRyKCJ4IiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geChkLmRhdGEuU3RhdGUpOyB9KQogICAgICAgIC5hdHRyKCJoZWlnaHQiLCBmdW5jdGlvbihkKSB7IHJldHVybiAoaXNOYU4oeShkWzBdKSAtIHkoZFsxXSkpID8gMCA6ICh5KGRbMF0pIC0geShkWzFdKSkgKTsgfSkKICAgICAgICAuYXR0cigid2lkdGgiLCB4LmJhbmR3aWR0aCgpKQogICAgICAgIC5hdHRyKCJ5IiwgZnVuY3Rpb24oZCxpKSB7cmV0dXJuIGkgKiAxMDA7IH0pCiAgICAgICAgLy8gLmF0dHIoInkiLCBmdW5jdGlvbihkKSB7cmV0dXJuIHkoZFsxXSk7IH0pCgoKICAgICAgICAub24oIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKCkgeyB0b29sdGlwLnN0eWxlKCJkaXNwbGF5IiwgbnVsbCk7IH0pCiAgICAgICAgLm9uKCJtb3VzZW91dCIsIGZ1bmN0aW9uKCkgeyB0b29sdGlwLnN0eWxlKCJkaXNwbGF5IiwgIm5vbmUiKTsgfSkKICAgICAgICAub24oIm1vdXNlbW92ZSIsIGZ1bmN0aW9uKGQpIHsKICAgICAgICB2YXIgeFBvc2l0aW9uID0gZDMubW91c2UodGhpcylbMF0gLSA1OwogICAgICAgIHZhciB5UG9zaXRpb24gPSBkMy5tb3VzZSh0aGlzKVsxXSAtIDU7CiAgICAgICAKICAgICAgICB2YXIgY3VycmVudF92YWwgPSAgKGRbMV0tZFswXSk7CiAgICAgICAgdmFyIGRhdGFfbGVuZ3RoID0gT2JqZWN0LnZhbHVlcyhkLmRhdGEpLmxlbmd0aCwgZ3JvdXBuYW1lOwogICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBkYXRhX2xlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmKE9iamVjdC52YWx1ZXMoZC5kYXRhKVtpXSA9PT0gY3VycmVudF92YWwpIHsKICAgICAgICAgICAgICAgICAgZ3JvdXBuYW1lID0gT2JqZWN0LmtleXMoZC5kYXRhKVtpXTsKICAgICAgICAgICAgICAgIC8vICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdG9vbHRpcAogICAgICAgICAuc3R5bGUoImxlZnQiLCBkMy5ldmVudC5wYWdlWCAtIDQwMCArICJweCIpCiAgICAgICAgICAgICAgLnN0eWxlKCJ0b3AiLCBkMy5ldmVudC5wYWdlWSAtIDI3MCArICJweCIpCiAgICAgICAgICAgICAgLnN0eWxlKCJkaXNwbGF5IiwgImlubGluZS1ibG9jayIpCiAgICAgICAgICAgICAgLmh0bWwoIChOdW1iZXIuaXNJbnRlZ2VyKChkWzFdLWRbMF0pKSA/IHZtLmN1cnJlbmN5X2tleSsoZFsxXS1kWzBdKSA6IHZtLmN1cnJlbmN5X2tleSsoZFsxXS1kWzBdKS50b0ZpeGVkKDIpKSArICI8YnI+IiAgKyBkLmRhdGEuU3RhdGUgKyAiPGJyPiA8ZW0+IDxiPiIgKyBncm91cG5hbWUgKyI8Yj48L2VtPiIgKTsKCiAgICAgICAgfSk7CgoKICAgICAgICBzdGFja3MKICAgICAgICAudHJhbnNpdGlvbigpCiAgICAgICAgLmRlbGF5KChkLGkpPT4gaSAqIDE1MCkKICAgICAgICAuZHVyYXRpb24oODAwKQogICAgICAgIC5hdHRyKCJ5IiwgZnVuY3Rpb24oZCkge3JldHVybiB5KGRbMV0pOyB9KQoKCiAgICAgICAgdmFyIHhPdmVydmlldyA9IGQzLnNjYWxlQmFuZCgpCiAgICAgICAgICAgICAgICAgICAgICAgIC5kb21haW4oZGF0YS5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQubGFiZWw7IH0pKQogICAgICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIHdpZHRoXSwgLjIpOwogICAgICAgIHZhciB5T3ZlcnZpZXcgPSBkMy5zY2FsZUxpbmVhcigpLnJhbmdlKFtoZWlnaHRPdmVydmlldywgMF0pOwogICAgICAgIHlPdmVydmlldy5kb21haW4oeS5kb21haW4oKSk7CgogICAgICAgIHZhciBkaXNwbGF5ZWQgPSBkMy5zY2FsZVF1YW50aXplKCkKICAgICAgICAgICAgICAgICAgLmRvbWFpbihbMCwgd2lkdGhdKQogICAgICAgICAgICAgICAgICAucmFuZ2UoZDMucmFuZ2UoZGF0YS5sZW5ndGgpKTsKICAgICAgICAgICAgICAgICAgIHN2Zy5hcHBlbmQoImciKS5hcHBlbmQoInJlY3QiKQogICAgICAgICAgICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSg1NSwgIiArIChoZWlnaHQgLSAxMzQpICsgIikiKQogICAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCAibW92ZXIiKQogICAgICAgICAgICAgICAgICAuYXR0cigieCIsIDApCiAgICAgICAgICAgICAgICAgIC5hdHRyKCJ5IiwgMCkKICAgICAgICAgICAgICAgICAgLmF0dHIoInJ4Iiw1KQogICAgICAgICAgICAgICAgICAuYXR0cigicnkiLDEwKQogICAgICAgICAgICAgICAgICAuYXR0cigiaGVpZ2h0IiwgMTApCiAgICAgICAgICAgICAgICAgIC5hdHRyKCJ3aWR0aCIsTWF0aC5yb3VuZChwYXJzZUZsb2F0KG51bUJhcnMgKiB3aWR0aCkvZGF0YS5sZW5ndGgpKQogICAgICAgICAgICAgICAgICAuYXR0cigicG9pbnRlci1ldmVudHMiLCAiYWxsIikKICAgICAgICAgICAgICAgICAgLmF0dHIoImN1cnNvciIsICJldy1yZXNpemUiKQogICAgICAgICAgICAgICAgICAuY2FsbChkMy5kcmFnKCkub24oImRyYWciLCBkaXNwbGF5KSk7CgogICAgfSBlbHNlIHsKICAgICB2YXIgc3RhY2tzID0gIGcuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigiY2xhc3MiLCAic3RhY2tzIikKICAgICAgICAuc2VsZWN0QWxsKCJnIikKICAgICAgICAuZGF0YShkMy5zdGFjaygpLmtleXMoa2V5cykoZGF0YSkpCiAgICAgICAgLmVudGVyKCkuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigiY2xhc3MiLCAiLmJhci1wb3NpdGl2ZS1zdGFjayIpCiAgICAgICAgLmF0dHIoImZpbGwiLCBmdW5jdGlvbihkKSB7IHJldHVybiB6KGQua2V5KTsgfSkKICAgICAgICAuc2VsZWN0QWxsKCJyZWN0IikKICAgICAgICAuZGF0YShmdW5jdGlvbihkKSB7IHJldHVybiBkOyB9KQogICAgICAgIC5lbnRlcigpLmFwcGVuZCgicmVjdCIpCiAgICAgICAgLmF0dHIoIngiLCBmdW5jdGlvbihkKSB7IHJldHVybiB4KGQuZGF0YS5TdGF0ZSk7IH0pCiAgICAgICAgLy8gLmF0dHIoInkiLCBmdW5jdGlvbihkKSB7cmV0dXJuIHkoZFsxXSk7IH0pCiAgICAgICAgLmF0dHIoInkiLCBmdW5jdGlvbihkLGkpIHsgcmV0dXJuIGkgKiAxMDA7IH0pCiAgICAgICAgLmF0dHIoImhlaWdodCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIChpc05hTih5KGRbMF0pIC0geShkWzFdKSkgPyAwIDogKHkoZFswXSkgLSB5KGRbMV0pKSApOyB9KQogICAgICAgIC5hdHRyKCJ3aWR0aCIsIHguYmFuZHdpZHRoKCkpCiAgICAgICAgLm9uKCJtb3VzZW92ZXIiLCBmdW5jdGlvbigpIHsgdG9vbHRpcC5zdHlsZSgiZGlzcGxheSIsIG51bGwpOyB9KQogICAgICAgIC5vbigibW91c2VvdXQiLCBmdW5jdGlvbigpIHsgdG9vbHRpcC5zdHlsZSgiZGlzcGxheSIsICJub25lIik7IH0pCiAgICAgICAgLm9uKCJtb3VzZW1vdmUiLCBmdW5jdGlvbihkKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coZCk7CiAgICAgICAgdmFyIHhQb3NpdGlvbiA9IGQzLm1vdXNlKHRoaXMpWzBdIC0gNTsKICAgICAgICB2YXIgeVBvc2l0aW9uID0gZDMubW91c2UodGhpcylbMV0gLSA1OwogICAgICAgCiAgICAgICAgdmFyIGN1cnJlbnRfdmFsID0gIChkWzFdLWRbMF0pOwogICAgICAgIC8vIGNvbnNvbGUubG9nKGN1cnJlbnRfdmFsKTsKICAgICAgICB2YXIgZGF0YV9sZW5ndGggPSBPYmplY3QudmFsdWVzKGQuZGF0YSkubGVuZ3RoLCBncm91cG5hbWU7CiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGRhdGFfbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYoT2JqZWN0LnZhbHVlcyhkLmRhdGEpW2ldID09PSBjdXJyZW50X3ZhbCkgewogICAgICAgICAgICAgICAgZ3JvdXBuYW1lID0gT2JqZWN0LmtleXMoZC5kYXRhKVtpXTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRvb2x0aXAKICAgICAgICAgLnN0eWxlKCJsZWZ0IiwgZDMuZXZlbnQucGFnZVggLSA0MDAgKyAicHgiKQogICAgICAgICAgICAgIC5zdHlsZSgidG9wIiwgZDMuZXZlbnQucGFnZVkgLSAyNzAgKyAicHgiKQogICAgICAgICAgICAgIC5zdHlsZSgiZGlzcGxheSIsICJpbmxpbmUtYmxvY2siKQogICAgICAgICAgICAgIC5odG1sKCAgKE51bWJlci5pc0ludGVnZXIoKGRbMV0tZFswXSkpID8gdm0uY3VycmVuY3lfa2V5KyhkWzFdLWRbMF0pIDogdm0uY3VycmVuY3lfa2V5KyhkWzFdLWRbMF0pLnRvRml4ZWQoMikpICsgIjxicj4iICArIGQuZGF0YS5TdGF0ZSArICI8YnI+IDxlbT4gPGI+IiArIGdyb3VwbmFtZSArIjxiPjwvZW0+IiApOwoKICAgICAgICB9KTsKCiAgICAgICAgc3RhY2tzCiAgICAgICAgLnRyYW5zaXRpb24oKQogICAgICAgIC5kZWxheSgoZCxpKT0+IGkgKiAxNTApCiAgICAgICAgLmR1cmF0aW9uKDgwMCkKICAgICAgICAuYXR0cigieSIsIGZ1bmN0aW9uKGQpIHsgCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRbMV0sIHkoZFsxXSkpOyAKICAgICAgICAgICAgaWYoaXNOYU4oZFsxXSkpewogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgIH0gZWxzZSBpZihpc05hTih5KGRbMV0pKSl7IAogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgIH0gZWxzZXsKICAgICAgICAgICAgICAgIHJldHVybiB5KGRbMV0pOyAKICAgICAgICAgICAgfQogICAgICAgICAgICB9KQoKICAgIH0KICAgIGlmKHRoaXMuZGF0YS5sZW5ndGggPiAxNCl7CiAgICAgICAgZy5hcHBlbmQoImciKQogICAgICAgIC5hdHRyKCJjbGFzcyIsICJheGlzIikKICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgwLCIgKyAoaGVpZ2h0LTE0MCkgKyAiKSIpCiAgICAgICAgLmNhbGwoZDMuYXhpc0JvdHRvbSh4KSkKICAgICAgICAuc2VsZWN0QWxsKCJ0ZXh0IikKICAgICAgICAuYXR0cigieSIsIDApCiAgICAgICAgLmF0dHIoIngiLCAtMTApCiAgICAgICAgLmF0dHIoImR5IiwgIi4zNWVtIikKICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgInJvdGF0ZSgtNzApIikKICAgICAgICAuc3R5bGUoInRleHQtYW5jaG9yIiwgImVuZCIpOwogICAgICAgICAgCgogICAgfSBlbHNlIHsKICAgICAgICAgZy5hcHBlbmQoImciKQogICAgICAgIC5hdHRyKCJjbGFzcyIsICJheGlzIikKICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgwLCIgKyAoaGVpZ2h0LTE0MCkgKyAiKSIpCiAgICAgICAgLmNhbGwoZDMuYXhpc0JvdHRvbSh4KSkKICAgICAgICAgZDMuc2VsZWN0QWxsKCIudGljayB0ZXh0IikKICAgICAgICAgIC5jYWxsKHdyYXAsIHguYmFuZHdpZHRoKCkpCiAgICAgICAgICAgZnVuY3Rpb24gd3JhcCh0ZXh0LCB3aWR0aCkgewogICAgICAgICAgICB0ZXh0LmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgdmFyIHRleHQgPSBkMy5zZWxlY3QodGhpcyksCiAgICAgICAgICAgICAgICAgIHdvcmRzID0gdGV4dC50ZXh0KCkuc3BsaXQoL1xzKy8pLnJldmVyc2UoKSwKICAgICAgICAgICAgICAgICAgd29yZCwKICAgICAgICAgICAgICAgICAgbGluZSA9IFtdLAogICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyID0gMCwKICAgICAgICAgICAgICAgICAgbGluZUhlaWdodCA9IDEuMSwgLy8gZW1zCiAgICAgICAgICAgICAgICAgIHkgPSB0ZXh0LmF0dHIoInkiKSwKICAgICAgICAgICAgICAgICAgZHkgPSBwYXJzZUZsb2F0KHRleHQuYXR0cigiZHkiKSksCiAgICAgICAgICAgICAgICAgIHRzcGFuID0gdGV4dC50ZXh0KG51bGwpLmFwcGVuZCgidHNwYW4iKS5hdHRyKCJ4IiwgMCkuYXR0cigieSIsIHkpLmF0dHIoImR5IiwgZHkgKyAiZW0iKTsKICAgICAgICAgICAgICB3aGlsZSAod29yZCA9IHdvcmRzLnBvcCgpKSB7CiAgICAgICAgICAgICAgICBsaW5lLnB1c2god29yZCk7CiAgICAgICAgICAgICAgICB0c3Bhbi50ZXh0KGxpbmUuam9pbigiICIpKTsKICAgICAgICAgICAgICAgIGlmICh0c3Bhbi5ub2RlKCkuZ2V0Q29tcHV0ZWRUZXh0TGVuZ3RoKCkgPiB3aWR0aCkgewogICAgICAgICAgICAgICAgICBsaW5lLnBvcCgpOwogICAgICAgICAgICAgICAgICB0c3Bhbi50ZXh0KGxpbmUuam9pbigiICIpKTsKICAgICAgICAgICAgICAgICAgbGluZSA9IFt3b3JkXTsKICAgICAgICAgICAgICAgICAgdHNwYW4gPSB0ZXh0LmFwcGVuZCgidHNwYW4iKS5hdHRyKCJ4IiwgMCkuYXR0cigieSIsIHkpLmF0dHIoImR5IiwgKytsaW5lTnVtYmVyICogbGluZUhlaWdodCArIGR5ICsgImVtIikudGV4dCh3b3JkKQogICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9ICAKICAgIH0KCiAgICBnLmFwcGVuZCgiZyIpCiAgICAgICAgLmF0dHIoImNsYXNzIiwgImF4aXMiKQogICAgICAgIC5hdHRyKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKDMwLDApIikKICAgICAgICAuY2FsbChkMy5heGlzTGVmdCh5KS50aWNrcyhudWxsLCAicyIpKQogICAgICAgIC5hcHBlbmQoInRleHQiKQogICAgICAgIC5hdHRyKCJ4IiwgMikKICAgICAgICAuYXR0cigieSIsIGZ1bmN0aW9uKCl7IHJldHVybiB5KHkudGlja3MoKS5wb3AoKSkgKyAwLjU7fSkKICAgICAgICAuYXR0cigiZHkiLCAiMC4zMmVtIikKICAgICAgICAuYXR0cigiZmlsbCIsICIjMDAwIikKICAgICAgICAuYXR0cigiZm9udC13ZWlnaHQiLCAiYm9sZCIpCiAgICAgICAgLmF0dHIoInRleHQtYW5jaG9yIiwgInN0YXJ0Iik7CgogICAgCiAgICBpZihrZXlzLmxlbmd0aCA+IDEwICl7CiAgICAgICAgdmFyIGxlZ2VuZF9kaXYgPSBkMy5zZWxlY3QoIiNsZWdlbmRfZGl2IikuYXBwZW5kKCJzdmciKS5zdHlsZSgid2lkdGgiLCIyMDAlIikuc3R5bGUoImhlaWdodCIsIjI1MCUiKTsKICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGxlZ2VuZF9kaXYgPSBkMy5zZWxlY3QoIiNsZWdlbmRfZGl2IikuYXBwZW5kKCJzdmciKS5zdHlsZSgid2lkdGgiLCIyMDAlIikuc3R5bGUoImhlaWdodCIsIjEwMCUiKTsKICAgIH0KICAgIHZhciBsZWdlbmRfZyA9ICBsZWdlbmRfZGl2LmFwcGVuZCgiZyIpLmF0dHIoInRyYW5zZm9ybSIsICJ0cmFuc2xhdGUoMCwwKSIpOwogICAgdmFyIGxlZ2VuZCA9IGxlZ2VuZF9nLmFwcGVuZCgiZyIpCiAgICAgICAgLmF0dHIoImZvbnQtZmFtaWx5IiwgInNhbnMtc2VyaWYiKQogICAgICAgIC5hdHRyKCJmb250LXNpemUiLCAxMCkKICAgICAgICAuYXR0cigidGV4dC1hbmNob3IiLCAiZW5kIikKICAgICAgICAuc2VsZWN0QWxsKCJnIikKICAgICAgICAvLyAuZGF0YShrZXlzLnNsaWNlKCkucmV2ZXJzZSgpKQogICAgICAgIC5kYXRhKGtleXMuc2xpY2UoKSkKICAgICAgICAuZW50ZXIoKS5hcHBlbmQoImciKQogICAgICAgIC8vIC5hdHRyKCJ0cmFuc2Zvcm0iLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiAidHJhbnNsYXRlKDAsMCkiOyB9KTsKICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gInRyYW5zbGF0ZSgwLCIgKyBpICogMjAgKyAiKSI7IH0pOwoKICAgIGxlZ2VuZC5hcHBlbmQoInJlY3QiKQogICAgICAgIC5hdHRyKCJ4IiwgMCkKICAgICAgICAuYXR0cigid2lkdGgiLCAxOSkKICAgICAgICAuYXR0cigiaGVpZ2h0IiwgMTkpCiAgICAgICAgLmF0dHIoImZpbGwiLCB6KTsKCiAgICBsZWdlbmQuYXBwZW5kKCJ0ZXh0IikKICAgICAgICAuYXR0cigieCIsIDI1KQogICAgICAgIC5hdHRyKCJ5IiwgOS41KQogICAgICAgIC5hdHRyKCJjbGFzcyIsICJsZWdlbmRfdGV4dCIpCiAgICAgICAgLmF0dHIoImR5IiwgIjAuMzJlbSIpCiAgICAgICAgLnRleHQoZnVuY3Rpb24oZCkgewogICAgICAgICAgICAvLyByZXR1cm4gZDsKICAgICAgICAgICAgaWYoZC5sZW5ndGggPiAyNSl7CiAgICAgICAgICAgICAgICByZXR1cm4gZC5zdWJzdHJpbmcoMCwyNSkudG9VcHBlckNhc2UoKSsnLi4uJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGQudG9VcHBlckNhc2UoKQogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuc3R5bGUoInRleHQtYW5jaG9yIiwgInN0YXJ0IikKICAgIAogICAgIGQzLnNlbGVjdEFsbCgnLmxlZ2VuZF90ZXh0JykuY2FsbChzaG93X2xvbmdfbGFiZWxzKTsKICAgICAgICBmdW5jdGlvbiBzaG93X2xvbmdfbGFiZWxzKHNlbGVjdGlvbikgewogICAgICAgICAgICBzZWxlY3Rpb24ub24oJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoZCxpKSB7IAogICAgICAgICAgICAgICAgaWYoZC5sZW5ndGggPiAyNSl7CiAgICAgICAgICAgICAgICAgIHRvb2x0aXAKICAgICAgICAgICAgICAgICAgICAuc3R5bGUoImxlZnQiLCBkMy5ldmVudC5wYWdlWCAtIDQwMCArICJweCIpCiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCJ0b3AiLCBkMy5ldmVudC5wYWdlWSAtIDI5MCArICJweCIpCiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCJkaXNwbGF5IiwgImlubGluZS1ibG9jayIpCiAgICAgICAgICAgICAgICAgICAgLmh0bWwoZC50b1VwcGVyQ2FzZSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHNlbGVjdGlvbi5vbigibW91c2VvdXQiLCBmdW5jdGlvbihkLGkpIHsKICAgICAgICAgICAgICAgIC8vIGQzLnNlbGVjdEFsbCgiLnRvb2xUaXAiKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHRvb2x0aXAuc3R5bGUoImRpc3BsYXkiLCAibm9uZSIpOyAvLyBoaWRlIHRvb2x0aXAgZm9yIHRoYXQgZWxlbWVudAogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHNlbGVjdGlvbi5vbigibW91c2Vtb3ZlIiwgZnVuY3Rpb24oZCkgewogICAgICAgICAgICAgICAgdG9vbHRpcAogICAgICAgICAgICAgICAgLnN0eWxlKCJ0b3AiLCBkMy5ldmVudC5sYXllclkgKyAxMCArICJweCIpIAogICAgICAgICAgICAgICAgLnN0eWxlKCJsZWZ0IiwgZDMuZXZlbnQubGF5ZXJYICsgNDEwICsgInB4Iik7IAogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAvLyBQcmVwIHRoZSB0b29sdGlwIGJpdHMsIGluaXRpYWwgZGlzcGxheSBpcyBoaWRkZW4KICAgIHZhciB0b29sdGlwID0gCiAgICAgICAgZDMuc2VsZWN0KCIjc3RhY2tlZGJhcm5vbnRpbWUiKS5hcHBlbmQoImRpdiIpLmF0dHIoImNsYXNzIiwgInRvb2xUaXAiKQoKICAgIC8vIGQzLnNlbGVjdEFsbCgiLnRpY2sgdGV4dCIpCiAgICAvLyAgIC5vbigibW91c2VvdmVyIiwgZnVuY3Rpb24oKSB7ICB9KQogICAgLy8gICAgIC5vbigibW91c2VvdXQiLCBmdW5jdGlvbigpIHsgIH0pCiAgICAvLyAgICAgLm9uKCJtb3VzZW1vdmUiLCBmdW5jdGlvbihkKSB7IGNvbnNvbGUubG9nKGQpOyB9KTsKCiAgICB2YXIgdGV4dF93cmFwID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHNlbGYgPSBkMy5zZWxlY3QodGhpcyksCiAgICAgICAgICAgIHRleHRMZW5ndGggPSBzZWxmLm5vZGUoKS5nZXRDb21wdXRlZFRleHRMZW5ndGgoKSwKICAgICAgICAgICAgdGV4dCA9IHNlbGYudGV4dCgpOwogICAgICAgIHdoaWxlICh0ZXh0TGVuZ3RoID4gKDUwKSAmJiB0ZXh0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdGV4dCA9IHRleHQuc2xpY2UoMCwgLTEpOwogICAgICAgICAgICBzZWxmLnRleHQodGV4dCArICcuLi4nKTsKICAgICAgICAgICAgdGV4dExlbmd0aCA9IHNlbGYubm9kZSgpLmdldENvbXB1dGVkVGV4dExlbmd0aCgpOwogICAgICAgIH0KICAgIH07CiAgICAKICAgIGZ1bmN0aW9uIGRpc3BsYXkgKCkgewogICAgIC8vIGRlYnVnZ2VyOwogICAgICAgIHZhciB4eSA9IHBhcnNlSW50KGQzLnNlbGVjdCh0aGlzKS5hdHRyKCJ4IikpLAogICAgICAgICAgICBueCA9IHh5ICsgZDMuZXZlbnQuZHgsCiAgICAgICAgICAgIHcgPSBwYXJzZUludChkMy5zZWxlY3QodGhpcykuYXR0cigid2lkdGgiKSksCiAgICAgICAgICAgIGYsIG5mLCBuZXdfZGF0YSwgcmVjdHM7CgogICAgICAgIGlmICggbnggPCAwIHx8IG54ICsgdyA+ICh3aWR0aCowLjkpICkgcmV0dXJuOwoKICAgICAgICBkMy5zZWxlY3QodGhpcykuYXR0cigieCIsIG54KTsKCiAgICAgICAgZiA9IGRpc3BsYXllZCh4eSk7CiAgICAgICAgbmYgPSBkaXNwbGF5ZWQobngpOwoKICAgICAgICBpZiAoIGYgPT09IG5mICkgcmV0dXJuOwoKICAgICAgICBuZXdfZGF0YSA9IGRhdGEuc2xpY2UobmYsIG5mICsgbnVtQmFycyk7CgogICAgICAgIHguZG9tYWluKG5ld19kYXRhLm1hcChmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5TdGF0ZTsgfSkpOwoKICAgICAgICBpZihudW1CYXJzID4gOCApewogICAgICAgICAgICBzdmcuc2VsZWN0KCIuYXhpcyIpCiAgICAgICAgICAgIC5jYWxsKGQzLmF4aXNCb3R0b20oeCkpCiAgICAgICAgICAgIC5zZWxlY3RBbGwoInRleHQiKQogICAgICAgICAgLmF0dHIoInkiLCAwKQogICAgICAgICAgLmF0dHIoIngiLCAtMTApCiAgICAgICAgICAuYXR0cigiZHkiLCAiLjM1ZW0iKQogICAgICAgICAgLmF0dHIoInRyYW5zZm9ybSIsICJyb3RhdGUoLTcwKSIpCiAgICAgICAgICAuc3R5bGUoInRleHQtYW5jaG9yIiwgImVuZCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN2Zy5zZWxlY3QoIi5heGlzIikKICAgICAgICAgICAgLmNhbGwoZDMuYXhpc0JvdHRvbSh4KSkKICAgICAgICAgICAgZDMuc2VsZWN0QWxsKCIudGljayB0ZXh0IikKICAgICAgICAgICAgLmNhbGwod3JhcCwgeC5iYW5kd2lkdGgoKSkKICAgICAgICAgICAgZnVuY3Rpb24gd3JhcCh0ZXh0LCB3aWR0aCkgewogICAgICAgICAgICAgICAgdGV4dC5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHZhciB0ZXh0ID0gZDMuc2VsZWN0KHRoaXMpLAogICAgICAgICAgICAgICAgICB3b3JkcyA9IHRleHQudGV4dCgpLnNwbGl0KC9ccysvKS5yZXZlcnNlKCksCiAgICAgICAgICAgICAgICAgIHdvcmQsCiAgICAgICAgICAgICAgICAgIGxpbmUgPSBbXSwKICAgICAgICAgICAgICAgICAgbGluZU51bWJlciA9IDAsCiAgICAgICAgICAgICAgICAgIGxpbmVIZWlnaHQgPSAxLjEsIC8vIGVtcwogICAgICAgICAgICAgICAgICB5ID0gdGV4dC5hdHRyKCJ5IiksCiAgICAgICAgICAgICAgICAgIGR5ID0gcGFyc2VGbG9hdCh0ZXh0LmF0dHIoImR5IikpLAogICAgICAgICAgICAgICAgICB0c3BhbiA9IHRleHQudGV4dChudWxsKS5hcHBlbmQoInRzcGFuIikuYXR0cigieCIsIDApLmF0dHIoInkiLCB5KS5hdHRyKCJkeSIsIGR5ICsgImVtIik7CiAgICAgICAgICAgICAgICAgd2hpbGUgKHdvcmQgPSB3b3Jkcy5wb3AoKSkgewogICAgICAgICAgICAgICAgbGluZS5wdXNoKHdvcmQpOwogICAgICAgICAgICAgICAgdHNwYW4udGV4dChsaW5lLmpvaW4oIiAiKSk7CiAgICAgICAgICAgICAgICBpZiAodHNwYW4ubm9kZSgpLmdldENvbXB1dGVkVGV4dExlbmd0aCgpID4gd2lkdGgpIHsKICAgICAgICAgICAgICAgICAgbGluZS5wb3AoKTsKICAgICAgICAgICAgICAgICAgdHNwYW4udGV4dChsaW5lLmpvaW4oIiAiKSk7CiAgICAgICAgICAgICAgICAgIGxpbmUgPSBbd29yZF07CiAgICAgICAgICAgICAgICAgIHRzcGFuID0gdGV4dC5hcHBlbmQoInRzcGFuIikuYXR0cigieCIsIDApLmF0dHIoInkiLCB5KS5hdHRyKCJkeSIsICsrbGluZU51bWJlciAqIGxpbmVIZWlnaHQgKyBkeSArICJlbSIpLnRleHQod29yZCkKICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSAgCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGQzLnNlbGVjdEFsbCgiLmJhci1wb3NpdGl2ZS1zdGFjayIpLnJlbW92ZSgpOwogICAgICAgIGQzLnNlbGVjdEFsbCgiLnN0YWNrcyIpLnJlbW92ZSgpOwogICAgICAgIHJlY3RzID0gc3ZnLnNlbGVjdEFsbCgiLmJhci1wb3NpdGl2ZS1zdGFjayIpCiAgICAgICAgLmRhdGEobmV3X2RhdGEsIGZ1bmN0aW9uIChkKSB7cmV0dXJuIGQubGFiZWw7IH0pOwogICAgICAgICAgcmVjdHMuYXR0cigieCIsIGZ1bmN0aW9uIChkKSB7IHJldHVybiB4KGQuZGF0YS5TdGF0ZSk7IH0pOwoKICAgICAgICAvLyByZWN0cwogICAgICAgIGcuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigiY2xhc3MiLCAic3RhY2tzIikKICAgICAgICAuc2VsZWN0QWxsKCJnIikKICAgICAgICAuZGF0YShkMy5zdGFjaygpLmtleXMoa2V5cykobmV3X2RhdGEpKQogICAgICAgIC5lbnRlcigpLmFwcGVuZCgiZyIpCiAgICAgICAgLmF0dHIoImNsYXNzIiwgIi5iYXItcG9zaXRpdmUtc3RhY2siKQogICAgICAgIC5hdHRyKCJmaWxsIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geihkLmtleSk7IH0pCiAgICAgICAgLnNlbGVjdEFsbCgicmVjdCIpCiAgICAgICAgLmRhdGEoZnVuY3Rpb24oZCkgeyByZXR1cm4gZDsgfSkKICAgICAgICAuZW50ZXIoKS5hcHBlbmQoInJlY3QiKQogICAgICAgIC5hdHRyKCJ4IiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geChkLmRhdGEuU3RhdGUpOyB9KQogICAgICAgIC5hdHRyKCJ5IiwgZnVuY3Rpb24oZCkge3JldHVybiB5KGRbMV0pOyB9KQogICAgICAgIC8vIC5hdHRyKCJoZWlnaHQiLCBmdW5jdGlvbihkKSB7IHJldHVybiB5KGRbMF0pIC0geShkWzFdKTsgfSkKICAgICAgICAuYXR0cigiaGVpZ2h0IiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gKGlzTmFOKHkoZFswXSkgLSB5KGRbMV0pKSA/IDAgOiAoeShkWzBdKSAtIHkoZFsxXSkpICk7IH0pCiAgICAgICAgLmF0dHIoIndpZHRoIiwgeC5iYW5kd2lkdGgoKSkKICAgICAgICAub24oIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKCkgeyB0b29sdGlwLnN0eWxlKCJkaXNwbGF5IiwgbnVsbCk7IH0pCiAgICAgICAgLm9uKCJtb3VzZW91dCIsIGZ1bmN0aW9uKCkgeyB0b29sdGlwLnN0eWxlKCJkaXNwbGF5IiwgIm5vbmUiKTsgfSkKICAgICAgICAub24oIm1vdXNlbW92ZSIsIGZ1bmN0aW9uKGQpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhkKTsKICAgICAgICB2YXIgeFBvc2l0aW9uID0gZDMubW91c2UodGhpcylbMF0gLSA1OwogICAgICAgIHZhciB5UG9zaXRpb24gPSBkMy5tb3VzZSh0aGlzKVsxXSAtIDU7CiAgICAgICAKICAgICAgICB2YXIgY3VycmVudF92YWwgPSAgKGRbMV0tZFswXSk7CiAgICAgICAgdmFyIGRhdGFfbGVuZ3RoID0gT2JqZWN0LnZhbHVlcyhkLmRhdGEpLmxlbmd0aCwgZ3JvdXBuYW1lOwogICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBkYXRhX2xlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmKE9iamVjdC52YWx1ZXMoZC5kYXRhKVtpXSA9PT0gY3VycmVudF92YWwpIHsKICAgICAgICAgICAgICAgICAgZ3JvdXBuYW1lID0gT2JqZWN0LmtleXMoZC5kYXRhKVtpXQogICAgICAgICAgICAgICAgLy8gICBicmVhazsgICAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0b29sdGlwCiAgICAgICAgIC5zdHlsZSgibGVmdCIsIGQzLmV2ZW50LnBhZ2VYIC0gNDAwICsgInB4IikKICAgICAgICAgICAgICAuc3R5bGUoInRvcCIsIGQzLmV2ZW50LnBhZ2VZIC0gMjcwICsgInB4IikKICAgICAgICAgICAgICAuc3R5bGUoImRpc3BsYXkiLCAiaW5saW5lLWJsb2NrIikKICAgICAgICAgICAgICAuaHRtbCggKE51bWJlci5pc0ludGVnZXIoKGRbMV0tZFswXSkpID8gdm0uY3VycmVuY3lfa2V5KyhkWzFdLWRbMF0pIDogdm0uY3VycmVuY3lfa2V5KyhkWzFdLWRbMF0pLnRvRml4ZWQoMikpICsgICI8YnI+IiAgKyBkLmRhdGEuU3RhdGUgKyAiPGJyPiA8ZW0+IDxiPiIgKyBncm91cG5hbWUgKyI8Yj48L2VtPiIgKTsKCiAgICAgICAgfSk7CiAgICAgICAgcmVjdHMuZXhpdCgpLnJlbW92ZSgpOwogICAgfTsKICB9Cn0K"},{"version":3,"sources":["StackedBarchartNonTime.vue"],"names":[],"mappings":";;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"StackedBarchartNonTime.vue","sourceRoot":"src/portal/analytics/components","sourcesContent":["<template>\n<div>\n  <div id=\"stackedbarnontime\" style=\"display:flex\">\n      <svg id=\"StackedBarChartNonTime\" width=\"800\" height=\"650\"></svg>\n    <div id=\"legend_div\"></div>\n  </div>\n</div>\n</template>\n\n<script>\nconst d3 = require(\"d3\");\nexport default {\n    name: \"StackedBarChartNonTime\",\n    props: {\n        data: Array,\n        xKey: String,\n        yKey: String,\n        primary_col: String,  \n        secondary_col: String,\n        currency_key: String\n    },\n  mounted () {\n    // console.log(this.currency_key)\n    var vm = this;\n    var map = this.data.reduce((r, i) => ((r[i[vm.primary_col]] = r[i[vm.primary_col]] || []).push({\n        date : i[vm.secondary_col],\n        sales: i[vm.yKey]\n             // i\n    }), r), {});\n    var entries = Object.entries(map);\n    const second_data = [];\n    for(let i =0; i < entries.length; i++) {\n            second_data.push({\n            State : entries[i][0],\n        })\n        for(let j =0 ; j < entries[i][1].length; j++) {\n            var temp = Object.values(entries[i][1][j]);\n            var a = temp[0],\n                b = temp[1];\n            second_data[i][a] = b;\n        }\n    }\n\n    var  data = [];\n    data = second_data;\n    let key_data_temp = [],\n    key_data_temp_length = [];\n    for(let i = 0; i < data.length; i++){\n        key_data_temp.push(d3.keys(data[i]).slice(1))\n        key_data_temp_length.push(d3.keys(data[i]).slice(1).length)\n    }\n\n    // console.log(key_data_temp);\n    // console.log(key_data_temp_length);\n    // console.log(Math.max(...key_data_temp_length))\n    // console.log(indexOfMax(key_data_temp_length))\n    var keys = key_data_temp[indexOfMax(key_data_temp_length)]\n    function indexOfMax(arr) {\n    if (arr.length === 0) {\n        return -1;\n    }\n\n    var max = arr[0];\n    var maxIndex = 0;\n\n    for (var i = 1; i < arr.length; i++) {\n        if (arr[i] > max) {\n            maxIndex = i;\n            max = arr[i];\n        }\n    }\n\n    return maxIndex;\n    }\n    let key_data_temp_2 = [];\n    for(let i =0; i < key_data_temp.length; i++){\n        for(let j = 0; j < key_data_temp[i].length; j++){\n            key_data_temp_2.push(key_data_temp[i][j])\n        }\n    }\n    // var keys = d3.keys(data[0]).slice(1);\n    // console.log(key_data_temp);\n    // console.log(key_data_temp_2, \"HERRREEE\");\n    // var xyz = key_data_temp_2.filter((value,index) => key_data_temp_2.indexOf(value) === index);\n    var xyz = key_data_temp_2.reduce(function(a,b){\n        if(a.indexOf(b) < 0 ) a.push(b);\n        return a;\n    }, [])\n    // console.log(xyz, 'HERE FOR DISTINCT')\n    // console.log(data);\n    // console.log(keys);\n    // var keys = xyz;\n    // var keys = [\"OPEN\", \"ARBITRATION\", \"DENIED\", \"Dropped\"\n    // , \"PAID\", \"Paid In Full\"]\n    //  \"Stopped\", \"To Litigate\", \"Transfered KH\", \"DISCHARGED\", \"STOPPED\", \"Lien\", \"SENT TO LITIGATION\", \"Transferred to KH \", \"Paid In Full\", \n    // \"Do Not Bill\", \"Transfered\", \"COLLECT\", \"DATA ENTRY\", \"Collect\", \"Write off\"];\n    // console.log(keys);\n    for(let i= 0; i< data.length; i++){\n        for (var j = 0, t = 0; j < keys.length; ++j) {\n            t += data[i][keys[j]] = +data[i][keys[j]];\n        }\n    data[i].total = t;\n    }\n    var isScrollDisplayed =  false,\n    numBars = 25;\n    var marginOverview = {top: 30, right: 10, bottom: 20, left: 70};\n    var heightOverview = 80 - marginOverview.top - marginOverview.bottom;\n    if(entries.length > 25 ) { isScrollDisplayed = true; }\n    // console.log(data)\n\n\n    var svg = d3.select(\"#StackedBarChartNonTime\"),\n        margin = {top: 10, right: 0, bottom: 10, left: 30},\n        width = +svg.attr(\"width\") - margin.left - margin.right,\n        height = +svg.attr(\"height\") - margin.top - margin.bottom,\n        g = svg.append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    // set x scale\n    var x = d3.scaleBand()\n        .rangeRound([50, (width- (.15 * width ))])\n        .paddingInner(0.05)\n        .align(0.1);\n\n    // set y scale\n    var y = d3.scaleLinear()\n        .rangeRound([height-150, 0]);\n\n    // set the colors\n    // var z = d3.scaleOrdinal()\n    //         .range([\"#98abc5\", \"#8a89a6\", \"#7b6888\", \"#6b486b\", \"#a05d56\", \"#d0743c\", \"#ff8c00\"]);\n    \n    // var z = d3.scaleOrdinal()\n    //         .range([\"#5d62b5\", \"#29c3be\", \"#f1726e\", \"#fbc53f\", \"#62b58f\", \"#d0743c\", \"#ff8c00\",\"#ca0020\",\"#f4a582\",\"#d5d5d5\",\"#92c5de\",\"#0571b0\",\"#0519b0\"]);\n\n    // var z = d3.scaleOrdinal()\n    //         .range([\"#FF9750\",\"#3FBC11\", \"#5d62b5\", \"#29c3be\", \"#f1726e\", \"#fbc53f\", \"#62b58f\", \"#d0743c\",\"#ca0020\",\"#f4a582\",\"#92c5de\",\"#0571b0\", \"#d3fe14\", \"#fec7f8\", \"#0b7b3e\", \"#0bf0e9\",'#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680',\n    //         '#FF9AA2', '#FFB7B2', '#FFDAC1', '#B5EAD7', '#63d2a8', \"#225a4b\", \"#e5df73\", '#6666FF','#ff0000\t','#a2798f','#d7c6cf','#e88758','#b13a15','#6d3656','#fffa90','#a4ffaa','#a6cbff','#8500f9','#b077ba','\t#765284','#984b67','#9c624e','#feb8ff','#9be3bd','#775934','#008385','#6a2ca1','#e60e68','#ff6d01','#fee9d3'\n    //         ]);\n    var z = d3.scaleOrdinal()\n            .range([\"#FBB317\",\"#FF9750\",\"#3FBC11\",\"#00C7E6\",\"#EA3379\",\"#0165fc\",\"#41fdfe\",\"#24a0ed\",\"#1ac1dd\",\"#7df9ff\",\"#3f00ff\",\"#08ff08\",\"#aeff6e\",\"#56fca2\",\"#45cea2\",\"#06c2ac\",\"#fe6700\",\"#ff3503\",\"#d90166\",\"#be03fd\",\"#ad0afd\",\"#6600ff\",\"#d01c1f\",\"#f1172f\",\"#fff600\",\"#fcd116\",\"#cfff04\",\"#ffc324\",\"#f4c430\",\"#FE7D68\",\"#710193\",\n            \"#0492C2\",\"#9897A9\",\"#632A0D\",\"#9A794E\",\"#151E3D\",\"#59788D\",\"#1E456E\",\"#016064\",\"#48AAAD\",\"#7E7D9C\",\"#303150\",\"#609D9E\",\"#287E9E\",\"#E4A834\",\"#028910\",\n            \"#373737\",\"#6C626D\",\"#584D5B\",\"#4D4C5C\"]);\n\n    // var z = [\"#5d62b5\", \"#29c3be\", \"#f1726e\", \"#fbc53f\", \"#62b58f\", \"#d0743c\",\"#ca0020\",\"#f4a582\",\"#92c5de\",\"#0571b0\", \"#d3fe14\", \"#fec7f8\", \"#0b7b3e\", \"#0bf0e9\",'#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680',\n    // '#FF9AA2', '#FFB7B2', '#FFDAC1', '#B5EAD7', '#63d2a8', \"#225a4b\", \"#e5df73\", '#6666FF','\t#ff0000\t','#a2798f','#d7c6cf','#e88758','#b13a15','#6d3656','#fffa90','#a4ffaa','#a6cbff','#8500f9','#b077ba','\t#765284','#984b67','#9c624e','#feb8ff','#9be3bd','#775934','#008385','#6a2ca1','#e60e68','#ff6d01','#fee9d3'\n    // ];\n\n    // var z =  d3.scaleOrdinal()\n    //    .domain(data.map(d => d[\"Outcome\"]))\n    //    .range(d3.quantize(t => d3.interpolateSpectral  (t * 0.8 + 0.1), data.length).reverse());\n\n\n    data.sort(function(a, b) { return b.total - a.total; });\n    if(isScrollDisplayed) {\n        x.domain(data.slice(0,numBars).map(function(d) { return d.State; }));\n    } else {\n        x.domain(data.map(function(d) { return d.State; }));\n    }\n    y.domain([0, d3.max(data, function(d) { return d.total; })]).nice();\n    z.domain(keys);\n\n    if(isScrollDisplayed) {\n        \n       var stacks = g.append(\"g\")\n        .attr(\"class\", \"stacks\")\n        .selectAll(\"g\")\n        .data(d3.stack().keys(keys)(data.slice(0,numBars)))\n        .enter().append(\"g\")\n        .attr(\"class\", \".bar-positive-stack\")\n        .attr(\"fill\", function(d) { return z(d.key); })\n        .selectAll(\"rect\")\n        .data(function(d) { return d; })\n        .enter().append(\"rect\")\n        .attr(\"class\", \".bar-positive-rect\")\n        .attr(\"x\", function(d) { return x(d.data.State); })\n        .attr(\"height\", function(d) { return (isNaN(y(d[0]) - y(d[1])) ? 0 : (y(d[0]) - y(d[1])) ); })\n        .attr(\"width\", x.bandwidth())\n        .attr(\"y\", function(d,i) {return i * 100; })\n        // .attr(\"y\", function(d) {return y(d[1]); })\n\n\n        .on(\"mouseover\", function() { tooltip.style(\"display\", null); })\n        .on(\"mouseout\", function() { tooltip.style(\"display\", \"none\"); })\n        .on(\"mousemove\", function(d) {\n        var xPosition = d3.mouse(this)[0] - 5;\n        var yPosition = d3.mouse(this)[1] - 5;\n       \n        var current_val =  (d[1]-d[0]);\n        var data_length = Object.values(d.data).length, groupname;\n        for(let i = 0; i < data_length; i++) {\n            if(Object.values(d.data)[i] === current_val) {\n                  groupname = Object.keys(d.data)[i];\n                //   break;\n            }\n        }\n        tooltip\n         .style(\"left\", d3.event.pageX - 400 + \"px\")\n              .style(\"top\", d3.event.pageY - 270 + \"px\")\n              .style(\"display\", \"inline-block\")\n              .html( (Number.isInteger((d[1]-d[0])) ? vm.currency_key+(d[1]-d[0]) : vm.currency_key+(d[1]-d[0]).toFixed(2)) + \"<br>\"  + d.data.State + \"<br> <em> <b>\" + groupname +\"<b></em>\" );\n\n        });\n\n\n        stacks\n        .transition()\n        .delay((d,i)=> i * 150)\n        .duration(800)\n        .attr(\"y\", function(d) {return y(d[1]); })\n\n\n        var xOverview = d3.scaleBand()\n                        .domain(data.map(function (d) { return d.label; }))\n                        .range([0, width], .2);\n        var yOverview = d3.scaleLinear().range([heightOverview, 0]);\n        yOverview.domain(y.domain());\n\n        var displayed = d3.scaleQuantize()\n                  .domain([0, width])\n                  .range(d3.range(data.length));\n                   svg.append(\"g\").append(\"rect\")\n                  .attr(\"transform\", \"translate(55, \" + (height - 134) + \")\")\n                  .attr(\"class\", \"mover\")\n                  .attr(\"x\", 0)\n                  .attr(\"y\", 0)\n                  .attr(\"rx\",5)\n                  .attr(\"ry\",10)\n                  .attr(\"height\", 10)\n                  .attr(\"width\",Math.round(parseFloat(numBars * width)/data.length))\n                  .attr(\"pointer-events\", \"all\")\n                  .attr(\"cursor\", \"ew-resize\")\n                  .call(d3.drag().on(\"drag\", display));\n\n    } else {\n     var stacks =  g.append(\"g\")\n        .attr(\"class\", \"stacks\")\n        .selectAll(\"g\")\n        .data(d3.stack().keys(keys)(data))\n        .enter().append(\"g\")\n        .attr(\"class\", \".bar-positive-stack\")\n        .attr(\"fill\", function(d) { return z(d.key); })\n        .selectAll(\"rect\")\n        .data(function(d) { return d; })\n        .enter().append(\"rect\")\n        .attr(\"x\", function(d) { return x(d.data.State); })\n        // .attr(\"y\", function(d) {return y(d[1]); })\n        .attr(\"y\", function(d,i) { return i * 100; })\n        .attr(\"height\", function(d) { return (isNaN(y(d[0]) - y(d[1])) ? 0 : (y(d[0]) - y(d[1])) ); })\n        .attr(\"width\", x.bandwidth())\n        .on(\"mouseover\", function() { tooltip.style(\"display\", null); })\n        .on(\"mouseout\", function() { tooltip.style(\"display\", \"none\"); })\n        .on(\"mousemove\", function(d) {\n        // console.log(d);\n        var xPosition = d3.mouse(this)[0] - 5;\n        var yPosition = d3.mouse(this)[1] - 5;\n       \n        var current_val =  (d[1]-d[0]);\n        // console.log(current_val);\n        var data_length = Object.values(d.data).length, groupname;\n        for(let i = 0; i < data_length; i++) {\n            if(Object.values(d.data)[i] === current_val) {\n                groupname = Object.keys(d.data)[i];\n                break;\n            }\n        }\n        tooltip\n         .style(\"left\", d3.event.pageX - 400 + \"px\")\n              .style(\"top\", d3.event.pageY - 270 + \"px\")\n              .style(\"display\", \"inline-block\")\n              .html(  (Number.isInteger((d[1]-d[0])) ? vm.currency_key+(d[1]-d[0]) : vm.currency_key+(d[1]-d[0]).toFixed(2)) + \"<br>\"  + d.data.State + \"<br> <em> <b>\" + groupname +\"<b></em>\" );\n\n        });\n\n        stacks\n        .transition()\n        .delay((d,i)=> i * 150)\n        .duration(800)\n        .attr(\"y\", function(d) { \n            // console.log(d[1], y(d[1])); \n            if(isNaN(d[1])){\n                return 0;\n            } else if(isNaN(y(d[1]))){ \n                return 0;\n            } else{\n                return y(d[1]); \n            }\n            })\n\n    }\n    if(this.data.length > 14){\n        g.append(\"g\")\n        .attr(\"class\", \"axis\")\n        .attr(\"transform\", \"translate(0,\" + (height-140) + \")\")\n        .call(d3.axisBottom(x))\n        .selectAll(\"text\")\n        .attr(\"y\", 0)\n        .attr(\"x\", -10)\n        .attr(\"dy\", \".35em\")\n        .attr(\"transform\", \"rotate(-70)\")\n        .style(\"text-anchor\", \"end\");\n          \n\n    } else {\n         g.append(\"g\")\n        .attr(\"class\", \"axis\")\n        .attr(\"transform\", \"translate(0,\" + (height-140) + \")\")\n        .call(d3.axisBottom(x))\n         d3.selectAll(\".tick text\")\n          .call(wrap, x.bandwidth())\n           function wrap(text, width) {\n            text.each(function() {\n              var text = d3.select(this),\n                  words = text.text().split(/\\s+/).reverse(),\n                  word,\n                  line = [],\n                  lineNumber = 0,\n                  lineHeight = 1.1, // ems\n                  y = text.attr(\"y\"),\n                  dy = parseFloat(text.attr(\"dy\")),\n                  tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n              while (word = words.pop()) {\n                line.push(word);\n                tspan.text(line.join(\" \"));\n                if (tspan.node().getComputedTextLength() > width) {\n                  line.pop();\n                  tspan.text(line.join(\" \"));\n                  line = [word];\n                  tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word)\n              \n                }\n              }\n            });\n          }  \n    }\n\n    g.append(\"g\")\n        .attr(\"class\", \"axis\")\n        .attr(\"transform\", \"translate(30,0)\")\n        .call(d3.axisLeft(y).ticks(null, \"s\"))\n        .append(\"text\")\n        .attr(\"x\", 2)\n        .attr(\"y\", function(){ return y(y.ticks().pop()) + 0.5;})\n        .attr(\"dy\", \"0.32em\")\n        .attr(\"fill\", \"#000\")\n        .attr(\"font-weight\", \"bold\")\n        .attr(\"text-anchor\", \"start\");\n\n    \n    if(keys.length > 10 ){\n        var legend_div = d3.select(\"#legend_div\").append(\"svg\").style(\"width\",\"200%\").style(\"height\",\"250%\");\n    } else {\n        var legend_div = d3.select(\"#legend_div\").append(\"svg\").style(\"width\",\"200%\").style(\"height\",\"100%\");\n    }\n    var legend_g =  legend_div.append(\"g\").attr(\"transform\", \"translate(0,0)\");\n    var legend = legend_g.append(\"g\")\n        .attr(\"font-family\", \"sans-serif\")\n        .attr(\"font-size\", 10)\n        .attr(\"text-anchor\", \"end\")\n        .selectAll(\"g\")\n        // .data(keys.slice().reverse())\n        .data(keys.slice())\n        .enter().append(\"g\")\n        // .attr(\"transform\", function(d, i) { return \"translate(0,0)\"; });\n        .attr(\"transform\", function(d, i) { return \"translate(0,\" + i * 20 + \")\"; });\n\n    legend.append(\"rect\")\n        .attr(\"x\", 0)\n        .attr(\"width\", 19)\n        .attr(\"height\", 19)\n        .attr(\"fill\", z);\n\n    legend.append(\"text\")\n        .attr(\"x\", 25)\n        .attr(\"y\", 9.5)\n        .attr(\"class\", \"legend_text\")\n        .attr(\"dy\", \"0.32em\")\n        .text(function(d) {\n            // return d;\n            if(d.length > 25){\n                return d.substring(0,25).toUpperCase()+'...';\n            } else {\n            return d.toUpperCase()\n            }\n        })\n        .style(\"text-anchor\", \"start\")\n    \n     d3.selectAll('.legend_text').call(show_long_labels);\n        function show_long_labels(selection) {\n            selection.on('mouseenter', function (d,i) { \n                if(d.length > 25){\n                  tooltip\n                    .style(\"left\", d3.event.pageX - 400 + \"px\")\n                    .style(\"top\", d3.event.pageY - 290 + \"px\")\n                    .style(\"display\", \"inline-block\")\n                    .html(d.toUpperCase());\n            }\n            });\n\n            selection.on(\"mouseout\", function(d,i) {\n                // d3.selectAll(\".toolTip\").remove();\n                tooltip.style(\"display\", \"none\"); // hide tooltip for that element\n            });\n\n            selection.on(\"mousemove\", function(d) {\n                tooltip\n                .style(\"top\", d3.event.layerY + 10 + \"px\") \n                .style(\"left\", d3.event.layerX + 410 + \"px\"); \n            });\n        }\n    // Prep the tooltip bits, initial display is hidden\n    var tooltip = \n        d3.select(\"#stackedbarnontime\").append(\"div\").attr(\"class\", \"toolTip\")\n\n    // d3.selectAll(\".tick text\")\n    //   .on(\"mouseover\", function() {  })\n    //     .on(\"mouseout\", function() {  })\n    //     .on(\"mousemove\", function(d) { console.log(d); });\n\n    var text_wrap = function() {\n        var self = d3.select(this),\n            textLength = self.node().getComputedTextLength(),\n            text = self.text();\n        while (textLength > (50) && text.length > 0) {\n            text = text.slice(0, -1);\n            self.text(text + '...');\n            textLength = self.node().getComputedTextLength();\n        }\n    };\n    \n    function display () {\n     // debugger;\n        var xy = parseInt(d3.select(this).attr(\"x\")),\n            nx = xy + d3.event.dx,\n            w = parseInt(d3.select(this).attr(\"width\")),\n            f, nf, new_data, rects;\n\n        if ( nx < 0 || nx + w > (width*0.9) ) return;\n\n        d3.select(this).attr(\"x\", nx);\n\n        f = displayed(xy);\n        nf = displayed(nx);\n\n        if ( f === nf ) return;\n\n        new_data = data.slice(nf, nf + numBars);\n\n        x.domain(new_data.map(function (d) { return d.State; }));\n\n        if(numBars > 8 ){\n            svg.select(\".axis\")\n            .call(d3.axisBottom(x))\n            .selectAll(\"text\")\n          .attr(\"y\", 0)\n          .attr(\"x\", -10)\n          .attr(\"dy\", \".35em\")\n          .attr(\"transform\", \"rotate(-70)\")\n          .style(\"text-anchor\", \"end\");\n        } else {\n            svg.select(\".axis\")\n            .call(d3.axisBottom(x))\n            d3.selectAll(\".tick text\")\n            .call(wrap, x.bandwidth())\n            function wrap(text, width) {\n                text.each(function() {\n              var text = d3.select(this),\n                  words = text.text().split(/\\s+/).reverse(),\n                  word,\n                  line = [],\n                  lineNumber = 0,\n                  lineHeight = 1.1, // ems\n                  y = text.attr(\"y\"),\n                  dy = parseFloat(text.attr(\"dy\")),\n                  tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n                 while (word = words.pop()) {\n                line.push(word);\n                tspan.text(line.join(\" \"));\n                if (tspan.node().getComputedTextLength() > width) {\n                  line.pop();\n                  tspan.text(line.join(\" \"));\n                  line = [word];\n                  tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word)\n              \n                }\n              }\n            });\n          }  \n        }\n        \n        d3.selectAll(\".bar-positive-stack\").remove();\n        d3.selectAll(\".stacks\").remove();\n        rects = svg.selectAll(\".bar-positive-stack\")\n        .data(new_data, function (d) {return d.label; });\n          rects.attr(\"x\", function (d) { return x(d.data.State); });\n\n        // rects\n        g.append(\"g\")\n        .attr(\"class\", \"stacks\")\n        .selectAll(\"g\")\n        .data(d3.stack().keys(keys)(new_data))\n        .enter().append(\"g\")\n        .attr(\"class\", \".bar-positive-stack\")\n        .attr(\"fill\", function(d) { return z(d.key); })\n        .selectAll(\"rect\")\n        .data(function(d) { return d; })\n        .enter().append(\"rect\")\n        .attr(\"x\", function(d) { return x(d.data.State); })\n        .attr(\"y\", function(d) {return y(d[1]); })\n        // .attr(\"height\", function(d) { return y(d[0]) - y(d[1]); })\n        .attr(\"height\", function(d) { return (isNaN(y(d[0]) - y(d[1])) ? 0 : (y(d[0]) - y(d[1])) ); })\n        .attr(\"width\", x.bandwidth())\n        .on(\"mouseover\", function() { tooltip.style(\"display\", null); })\n        .on(\"mouseout\", function() { tooltip.style(\"display\", \"none\"); })\n        .on(\"mousemove\", function(d) {\n        // console.log(d);\n        var xPosition = d3.mouse(this)[0] - 5;\n        var yPosition = d3.mouse(this)[1] - 5;\n       \n        var current_val =  (d[1]-d[0]);\n        var data_length = Object.values(d.data).length, groupname;\n        for(let i = 0; i < data_length; i++) {\n            if(Object.values(d.data)[i] === current_val) {\n                  groupname = Object.keys(d.data)[i]\n                //   break;   \n            }\n        }\n        tooltip\n         .style(\"left\", d3.event.pageX - 400 + \"px\")\n              .style(\"top\", d3.event.pageY - 270 + \"px\")\n              .style(\"display\", \"inline-block\")\n              .html( (Number.isInteger((d[1]-d[0])) ? vm.currency_key+(d[1]-d[0]) : vm.currency_key+(d[1]-d[0]).toFixed(2)) +  \"<br>\"  + d.data.State + \"<br> <em> <b>\" + groupname +\"<b></em>\" );\n\n        });\n        rects.exit().remove();\n    };\n  }\n}\n</script>"]}]}