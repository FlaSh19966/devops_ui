{"remainingRequest":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Data Inputs/AddIntent.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Data Inputs/AddIntent.vue","mtime":1660042032563},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBTd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwppbXBvcnQgeyBzZXRUaW1lb3V0IH0gZnJvbSAidGltZXJzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJhZGQtaW50ZW50IiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNWaXNpYmxlU2VhcmNoQ2xlYXI6ZmFsc2UsCiAgICAgIHNwaW5uZXJPbjogZmFsc2UsCiAgICAgIGNoZWNrZWRfbGlzdDogW10sCiAgICAgIHRvdGFsX3BhZ2VzOiBudWxsLAogICAgICBwYWdlX25vOiAxLAogICAgICBwZXJfcGFnZTogMjAsCiAgICAgIG5ld19pbnRlbnRfbGlzdDogW10sCiAgICAgIG5ld19pbnRlbnRzOiAiIiwKICAgICAgaW50ZW50bGlzdDogW10sCiAgICAgIGNvbXBhbnluYW1lOiAiIiwKICAgICAgY29tcGFueWlkOiAiIiwKICAgICAgbnVtYmVyX29mX3Jvd3M6IG51bGwsCiAgICAgIGVkaXQ6ICJGYWxzZSIsCiAgICAgIG9sZF9pbnRlbnRfZGF0YTogW10sCiAgICAgIG5ld19pbnRlbnRfZGF0YTogW10sCiAgICAgIHNlYXJjaF9uYW1lOiAiIiwKICAgICAgcGFnZV9hcnJheTogW10sCiAgICAgIGFkZF9pbnRlbnRzX2xpc3Q6IFsiIl0sCiAgICAgIGlzR2xvYmFsRWRpdDogZmFsc2UsCiAgICAgIGdsb2JhbF9pbnRlbnRzX2VkaXRfbGlzdDogW10sCiAgICAgIC8vIHNlYXJjaF9ieTogJycsCiAgICAgIC8vIHNlYXJjaGJ5OiAnJywKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgaXNHbG9iYWxFZGl0KG5ld1ZhbCkgewogICAgICBpZiAoQm9vbGVhbihuZXdWYWwpKSB7CiAgICAgICAgdGhpcy5nbG9iYWxfaW50ZW50c19lZGl0X2xpc3QgPSB0aGlzLmludGVudGxpc3QubWFwKAogICAgICAgICAgKHsgaW50ZW50IH0pID0+IGludGVudAogICAgICAgICk7CiAgICAgIH0KICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgaWYgKHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIikgewogICAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpKSB7CiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiQ29tcGFueUlkIik7CiAgICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55TmFtZSIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQ7CiAgICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7CiAgICAgICAgdG9hc3RyLndhcm5pbmcodGhpcy50bHQoJ3NlbGVjdF9jb21wYW55X25hbWVfdGV4dCcpKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7CiAgICB9CiAgICB0aGlzLmxvYWRfaW50ZW50cygpOwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHZhciB2bSA9IHRoaXM7CiAgICAkKCIjc2VsZWN0YWxsIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICBpZiAoJCh0aGlzKS5pcygiOmNoZWNrZWQiKSkgewogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIHRydWUpOwogICAgICB9IGVsc2UgewogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICB2bS5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgfQogICAgfSk7CiAgICAkKCIjaW50ZW50bW9kZWwiKS5vbigiaGlkZGVuLmJzLm1vZGFsIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICB2bS5jaGVja2VkX2xpc3QgPSBbXTsKICAgIH0pOwogICAgaWYodGhpcy4kcm91dGUucGFyYW1zLm1vZGFsX29wZW5fc3dpdGNoX3RhYil7CiAgICAgICQoIiNpbnRlbnRtb2RlbCIpLm1vZGFsKCJzaG93Iik7CiAgICB9CiAgICAvLyAkKCIjZnJvbV9kYXRlcGlja2VyIikuZGF0ZXBpY2tlcih7CiAgICAvLyAgIGRhdGVGb3JtYXQ6ICJ5eS1tbS1kZCIsCiAgICAvLyAgIG9uQ2xvc2U6IChkYXRlVGV4dCwgaW5zdCkgPT4gewogICAgLy8gICAgIHRoaXMuc2VhcmNoX25hbWU9ZGF0ZVRleHQ7CiAgICAvLyAgIH0sCiAgICAvLyAgIG9uU2VsZWN0OiBmdW5jdGlvbihkYXRlVGV4dCwgaW5zdCkgewogICAgLy8gICB9CiAgICAvLyB9KTsKICB9LAogIHdhdGNoOnsKICAgICAgICBzZWFyY2hfbmFtZSgpewogICAgICAgICAgaWYgKHRoaXMuc2VhcmNoX25hbWUgPT09ICIiKXsKICAgICAgICAgIHRoaXMubG9hZF9pbnRlbnRzKCk7CiAgICAgICAgICB0aGlzLmlzVmlzaWJsZVNlYXJjaENsZWFyID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIGlmICh0aGlzLnNlYXJjaF9uYW1lICE9PSAiIil7CiAgICAgICAgICAgIHRoaXMuaXNWaXNpYmxlU2VhcmNoQ2xlYXIgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBjbGVhcl9zZWFyY2hfbmFtZSgpewogICAgICB0aGlzLnNlYXJjaF9uYW1lID0gIiI7CiAgICB9LAogICAgbG9hZF9pbnRlbnRzKCkgewogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIHRoaXMuaW50ZW50bGlzdCA9IFtdOwogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLmFkZF9pbnRlbnRfdXJsKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgIHNob3dpbnRlbnQ6ICJUcnVlIiwKICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgIT0gInRva2VuIGludmFsaWQiKSB7CiAgICAgICAgICAgIHRoaXMubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhWzNdLm51bWJlcl9vZl9yb3dzOwogICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gTWF0aC5jZWlsKHRoaXMubnVtYmVyX29mX3Jvd3MgLyB0aGlzLnBlcl9wYWdlKTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhWzBdKSB7CiAgICAgICAgICAgICAgdGhpcy5pbnRlbnRsaXN0LnB1c2goewogICAgICAgICAgICAgICAgaW50ZW50OiByZXNwb25zZS5kYXRhWzBdW2ldLnJlcGxhY2UoYCR7dGhpcy5jb21wYW55aWR9X2AsICIiKSwKICAgICAgICAgICAgICAgIGVtYWlsOiByZXNwb25zZS5kYXRhWzFdW2ldLAogICAgICAgICAgICAgICAgY3JlYXRlZDogcmVzcG9uc2UuZGF0YVsyXVtpXSwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIGNhbGxzZWFyY2goKSB7CiAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykgewogICAgICAgIHRoaXMuc2VhcmNoX2ludGVudCgpOwogICAgICB9CiAgICB9LAogICAgc2VhcmNoX2ludGVudCgpIHsKICAgICAgaWYgKHRoaXMuc2VhcmNoX25hbWUgIT0gIiIpIHsKICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgYXhpb3MKICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICBhcGlfY2FsbHMuYWRkX2ludGVudF91cmwoKSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgaXNzZWFyY2g6IHRydWUsCiAgICAgICAgICAgICAga2V5OiB0aGlzLnNlYXJjaF9uYW1lLAogICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9CiAgICAgICAgICApCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuTVNHICE9ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiICYmCiAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5NU0cgIT0gIk5vIEludGVudHMgRm91bmQiCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIHRoaXMuaW50ZW50bGlzdCA9IFtdOwogICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IDE7CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgIT0gInRva2VuIGludmFsaWQiKSB7CiAgICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5pbnRlbnRsaXN0Lmxlbmd0aDsKICAgICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2Vjb3VudDsKICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzcG9uc2UuZGF0YS5pbnRlbnRsaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuaW50ZW50bGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBpbnRlbnQ6IHJlc3BvbnNlLmRhdGEuaW50ZW50bGlzdFtpXS5JbnRlbnQucmVwbGFjZSgKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGFueWlkICsgIl8iLAogICAgICAgICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIGVtYWlsOiByZXNwb25zZS5kYXRhLmludGVudGxpc3RbaV0uQ3JlYXRlZEJ5LAogICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IHJlc3BvbnNlLmRhdGEuaW50ZW50bGlzdFtpXS5DcmVhdGVkRGF0ZSwKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIk5vIEludGVudHMgRm91bmQiKSB7CiAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJObyBpbnRlbnQgZm91bmQiKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLk1TRyA9PSAiSW50cm5hbCBTZXJ2ZXIgRXJyb3IiKSB7CiAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRybmFsIFNlcnZlciBFcnJvciIpOwogICAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIC8vICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgLy8gfSwgMjUwMCk7CiAgICAgICAgICAgICAgdGhpcy5sb2FkX2ludGVudHMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRvYXN0ci5lcnJvcigiRW50ZXIgcHJvcGVyIGRhdGEgZm9yIHNlYXJjaGluZyIpOwogICAgICB9CiAgICB9LAogICAgc2VsZWN0ZWRfaW50ZW50cyhpbnRlbnQpIHsKICAgICAgaWYgKGludGVudCA9PSAiYWxsIikgewogICAgICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgdmFyIHRlbXAgPSB0aGlzLmludGVudGxpc3Q7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRlbXA7CiAgICAgICAgfSBlbHNlIGlmICghZXZlbnQudGFyZ2V0LmNoZWNrZWQpIHsKICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCA9PSB0cnVlKSB7CiAgICAgICAgICBsZXQgdmFsX2luZGV4ID0gdGhpcy5jaGVja2VkX2xpc3QuZmlsdGVyKChpbnRlbnRzKSA9PiB7CiAgICAgICAgICAgIHJldHVybiBpbnRlbnRzLmludGVudCA9PSBpbnRlbnQ7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICh2YWxfaW5kZXgubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QucHVzaChpbnRlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0LmNoZWNrZWQgPT0gZmFsc2UpIHsKICAgICAgICAgIHZhciBzZWxlY3RhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjc2VsZWN0YWxsIik7CiAgICAgICAgICBpZiAoc2VsZWN0YWxsLmNoZWNrZWQgPT0gdHJ1ZSkgewogICAgICAgICAgICBzZWxlY3RhbGwuY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgbGV0IHRlbXAgPSB0aGlzLmNoZWNrZWRfbGlzdC5maWx0ZXIoKGludGVudHMpID0+IHsKICAgICAgICAgICAgcmV0dXJuIGludGVudHMgIT0gaW50ZW50OwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRlbXA7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcGFnZV9jaGFuZ2UocGFnZV9ubykgewogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMuYWRkX2ludGVudF91cmwoKSwKICAgICAgICAgIHsKICAgICAgICAgICAgaW50ZW50OiB0aGlzLmNvbXBhbnlpZCArICJfIiArIHRoaXMubmV3X2ludGVudHMsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgIHNob3dpbnRlbnQ6ICJUcnVlIiwKICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGFbM10ubnVtYmVyX29mX3Jvd3M7CiAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGFbMF0pIHsKICAgICAgICAgICAgdGhpcy5pbnRlbnRsaXN0LnB1c2goewogICAgICAgICAgICAgIGludGVudDogcmVzcG9uc2UuZGF0YVswXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIiksCiAgICAgICAgICAgICAgZW1haWw6IHJlc3BvbnNlLmRhdGFbMV1baV0sCiAgICAgICAgICAgICAgY3JlYXRlZDogcmVzcG9uc2UuZGF0YVsyXVtpXSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIGVkaXRfaW50ZW50KGluZGV4KSB7CiAgICAgIHRoaXMubmV3X2ludGVudHMgPSB0aGlzLmludGVudGxpc3RbaW5kZXhdLmludGVudDsKICAgICAgdGhpcy5vbGRfaW50ZW50X2RhdGEucHVzaCgKICAgICAgICBgJHt0aGlzLmNvbXBhbnlpZH1fJHt0aGlzLmludGVudGxpc3RbaW5kZXhdLmludGVudH1gCiAgICAgICk7CiAgICAgIHRoaXMuZWRpdCA9ICJUcnVlIjsKICAgIH0sCiAgICBkZWxldGVfc2VsZWN0ZWQoKSB7CiAgICAgIGlmICh0aGlzLmNoZWNrZWRfbGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgIFN3YWwuZmlyZSgiTm8gaW50ZW50IHNlbGVjdGVkISIsICIiLCAiZXJyb3IiKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNoZWNrZWRfbGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmNoZWNrZWRfbGlzdCkgewogICAgICAgICAgdGhpcy5uZXdfaW50ZW50X2xpc3QucHVzaCgKICAgICAgICAgICAgdGhpcy5jb21wYW55aWQgKyAiXyIgKyB0aGlzLmNoZWNrZWRfbGlzdFtpXQogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgICB0ZXh0OiAiWW91IHdvbid0IGJlIGFibGUgdG8gcmV2ZXJ0IHRoaXMhIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgZGVsZXRlISEiLAogICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgICBhcGlfY2FsbHMuZGVsZXRlX2ludGVudF91cmwoKSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgaW50ZW50X2xpc3Q6IHRoaXMubmV3X2ludGVudF9saXN0LAogICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikKICAgICAgICAgICAgICAgICAgICAuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PSAiSU5URU5UUyBERUxFVEVEIikgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogIllvdXIgSW50ZW50KHMpIGhhdmUgYmVlbiBkZWxldGVkLiIsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6MjAwMCwKICAgICAgICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkX2ludGVudHMoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhID09ICJOb3RoaW5nIHRvIGRlbGV0ZSEiKSB7CiAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigKICAgICAgICAgICAgICAgICAgICAiWW91IGhhdmUgbm90IHNlbGVjdGVkIGFueSBpbnRlbnQgdG8gYmUgZGVsZXRlZC4iCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKAogICAgICAgICAgICAgICAgICByZXNwb25zZS5kYXRhID09CiAgICAgICAgICAgICAgICAgICJUcmFpbmVkIGludGVudCBkZWxldGlvbiBpcyBjdXJyZW50bHkgZGlzYWJsZWQhIgogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigKICAgICAgICAgICAgICAgICAgICAiRGVsZXRpb24gb2YgdHJhaW5lZC9jb25maWd1cmVkIGludGVudCBpcyBkaXNhYmxlZC4gQSBDb2RlYXJyYXkgQWRtaW4gd2lsbCBnZXQgaW4gY29udGFjdCB3aXRoIHlvdSIKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVfaW50ZW50KGluZGV4KSB7CiAgICAgIHRoaXMubmV3X2ludGVudF9saXN0WzBdID0KICAgICAgICB0aGlzLmNvbXBhbnlpZCArICJfIiArIHRoaXMuaW50ZW50bGlzdFtpbmRleF0uaW50ZW50OwogICAgICBTd2FsLmZpcmUoewogICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgdGV4dDogIllvdSB3b24ndCBiZSBhYmxlIHRvIHJldmVydCB0aGlzISIsCiAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgZGVsZXRlIGl0ISIsCiAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICAgIGFwaV9jYWxscy5kZWxldGVfaW50ZW50X3VybCgpLAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGludGVudF9saXN0OiB0aGlzLm5ld19pbnRlbnRfbGlzdCwKICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJJTlRFTlRTIERFTEVURUQiKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICB0ZXh0OiAiWW91ciBJbnRlbnQocykgaGF2ZSBiZWVuIGRlbGV0ZWQuIiwKICAgICAgICAgICAgICAgICAgdGltZXI6MjAwMCwKICAgICAgICAgICAgICAgICAgYWxsb3dPdXRzaWRlQ2xpY2s6IGZhbHNlLAogICAgICAgICAgICAgICAgICBhbGxvd0VzY2FwZUtleTogZmFsc2UsCiAgICAgICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZF9pbnRlbnRzKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgICAgICAgICByZXNwb25zZS5kYXRhID09CiAgICAgICAgICAgICAgICAiVHJhaW5lZCBpbnRlbnQgZGVsZXRpb24gaXMgY3VycmVudGx5IGRpc2FibGVkISIKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigKICAgICAgICAgICAgICAgICAgIkRlbGV0aW9uIG9mIHRyYWluZWQvY29uZmlndXJlZCBpbnRlbnQgaXMgZGlzYWJsZWQuIEEgQ29kZWFycmF5IEFkbWluIHdpbGwgZ2V0IGluIGNvbnRhY3Qgd2l0aCB5b3UiCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgcGFnZV9yZXF1aXJlKHBhZ2UpIHsKICAgICAgaWYgKHBhZ2UgPT0gMCB8fCBwYWdlID09IHRoaXMudG90YWxfcGFnZXMgKyAxKSB7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuc2VhcmNoX25hbWUgPT0gIiIpIHsKICAgICAgICAgIGlmIChwYWdlID09ICIuLi5zIikgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKDEgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2UgPT0gIi4uLmwiKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgodGhpcy50b3RhbF9wYWdlcyArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHBhZ2U7CiAgICAgICAgICB9CiAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICBheGlvcwogICAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgICBhcGlfY2FsbHMuYWRkX2ludGVudF91cmwoKSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpbnRlbnQ6IHRoaXMubmV3X2ludGVudHMsCiAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgICAgICBzaG93aW50ZW50OiAiVHJ1ZSIsCiAgICAgICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuaW50ZW50bGlzdCA9IFtdOwogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YVswXSkgewogICAgICAgICAgICAgICAgdGhpcy5pbnRlbnRsaXN0LnB1c2goewogICAgICAgICAgICAgICAgICBpbnRlbnQ6IHJlc3BvbnNlLmRhdGFbMF1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpLAogICAgICAgICAgICAgICAgICBlbWFpbDogcmVzcG9uc2UuZGF0YVsxXVtpXSwKICAgICAgICAgICAgICAgICAgY3JlYXRlZDogcmVzcG9uc2UuZGF0YVsyXVtpXSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBpZih0aGlzLnNlYXJjaF9ieT09J0VtYWlsIEFkZHJlc3MnKXsKICAgICAgICAgIC8vICAgdGhpcy5zZWFyY2hieT0nQ3JlYXRlZEJ5JzsKICAgICAgICAgIC8vIH0KICAgICAgICAgIC8vIGVsc2V7CiAgICAgICAgICAvLyAgIHRoaXMuc2VhcmNoYnk9dGhpcy5zZWFyY2hfYnk7CiAgICAgICAgICAvLyB9CiAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgICBpZiAocGFnZW5vID09ICIuLi5zIikgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKDEgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2VubyA9PSAiLi4ubCIpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCh0aGlzLnRvdGFsX3BhZ2VzICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gcGFnZW5vOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgICAgYXhpb3MKICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgYXBpX2NhbGxzLmFkZF9pbnRlbnRfdXJsKCksCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgaXNzZWFyY2g6IHRydWUsCiAgICAgICAgICAgICAgICAvLyBzZWFyY2hieTogdGhpcy5zZWFyY2hieSwKICAgICAgICAgICAgICAgIGtleTogdGhpcy5zZWFyY2hfbmFtZSwKICAgICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5pbnRlbnRsaXN0ID0gW107CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuaW50ZW50bGlzdC5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhICE9ICJ0b2tlbiBpbnZhbGlkIikgewogICAgICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5pbnRlbnRsaXN0Lmxlbmd0aDsKICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnZWNvdW50OwogICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3BvbnNlLmRhdGEuaW50ZW50bGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW50ZW50bGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgIGludGVudDogcmVzcG9uc2UuZGF0YS5pbnRlbnRsaXN0W2ldLkludGVudC5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBhbnlpZCArICJfIiwKICAgICAgICAgICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogcmVzcG9uc2UuZGF0YS5pbnRlbnRsaXN0W2ldLkNyZWF0ZWRCeSwKICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IHJlc3BvbnNlLmRhdGEuaW50ZW50bGlzdFtpXS5DcmVhdGVkRGF0ZSwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJObyBJbnRlbnRzIEZvdW5kIikgewogICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJObyBpbnRlbnQgZm91bmQiKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJJbnRybmFsIFNlcnZlciBFcnJvciIpIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIC8vICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAvLyB9LCAyNTAwKTsKICAgICAgICAgICAgICAgIHRoaXMubG9hZF9pbnRlbnRzKCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIC8vICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAvLyB9LCAyNTAwKTsKICAgICAgICAgICAgICAgIHRoaXMubG9hZF9pbnRlbnRzKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYWRkX2ludGVudHMoKSB7CiAgICAgIGlmICh0aGlzLmlzR2xvYmFsRWRpdCkgewogICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICB2YXIgcmVzdWx0MSA9IFtdOwogICAgICAgIHZhciByZXN1bHQyID0gW107CiAgICAgICAgdmFyIGludGVudHNfbWFwID0gdGhpcy5pbnRlbnRsaXN0Lm1hcCgoeyBpbnRlbnQgfSkgPT4gaW50ZW50KTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnRlbnRzX21hcC5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMuZ2xvYmFsX2ludGVudHNfZWRpdF9saXN0LmluZGV4T2YoaW50ZW50c19tYXBbaV0pID09PSAtMSkgewogICAgICAgICAgICByZXN1bHQxLnB1c2goaW50ZW50c19tYXBbaV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZ2xvYmFsX2ludGVudHNfZWRpdF9saXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAoaW50ZW50c19tYXAuaW5kZXhPZih0aGlzLmdsb2JhbF9pbnRlbnRzX2VkaXRfbGlzdFtpXSkgPT09IC0xKSB7CiAgICAgICAgICAgIHJlc3VsdDIucHVzaCh0aGlzLmdsb2JhbF9pbnRlbnRzX2VkaXRfbGlzdFtpXSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocmVzdWx0Mi5zb21lKCh2YWwsIGkpID0+IHJlc3VsdDIuaW5kZXhPZih2YWwpICE9PSBpKSkgewogICAgICAgICAgdG9hc3RyLmVycm9yKAogICAgICAgICAgICAiWW91IGhhdmUgZW50ZXJlZCBzb21lIGludGVudHMgbW9yZSB0aGFuIG9uY2UsIGVuc3VyZSB1bmlxdWUgdmFsdWVzIgogICAgICAgICAgKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGV0IG9sZF9pbnRlbnRfZGF0YSA9IHJlc3VsdDEubWFwKAogICAgICAgICAgICAoaW50ZW50KSA9PiBgJHt0aGlzLmNvbXBhbnlpZH1fJHtpbnRlbnR9YAogICAgICAgICAgKTsKICAgICAgICAgIGxldCBuZXdfaW50ZW50X2RhdGEgPSByZXN1bHQyLm1hcCgKICAgICAgICAgICAgKGludGVudCkgPT4gYCR7dGhpcy5jb21wYW55aWR9XyR7aW50ZW50fWAKICAgICAgICAgICk7CgogICAgICAgICAgdGhpcy5lZGl0X2ludGVudF9hcGkob2xkX2ludGVudF9kYXRhLCBuZXdfaW50ZW50X2RhdGEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmVkaXQgPT0gIkZhbHNlIikgewogICAgICAgIGlmICh0aGlzLmFkZF9pbnRlbnRzX2xpc3QuaW5jbHVkZXMoIiIpKSB7CiAgICAgICAgICB0b2FzdHIuZXJyb3IoIlBsZWFzZSBFbnRlciB0aGUgSW50ZW50Iik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICAgIHRoaXMubmV3X2ludGVudF9saXN0ID0gdGhpcy5hZGRfaW50ZW50c19saXN0Lm1hcCgKICAgICAgICAgICAgKGludGVudCkgPT4gYCR7dGhpcy5jb21wYW55aWR9XyR7aW50ZW50fWAKICAgICAgICAgICk7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICBheGlvcwogICAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgICBhcGlfY2FsbHMuYWRkX2ludGVudF91cmwoKSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpbnRlbnQ6IHRoaXMubmV3X2ludGVudF9saXN0LAogICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICAgICAgc2hvd2ludGVudDogIkZhbHNlIiwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICB0aGlzLm5ld19pbnRlbnRfbGlzdCA9IFtdOwogICAgICAgICAgICAgIHRoaXMuYWRkX2ludGVudHNfbGlzdCA9IFsiIl07CiAgICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PSAiVXNlciBSb2xlIFNldCIpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgIHRleHQ6ICJGZWVkYmFjayBhZGRlZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICB0aW1lcjoyMDAwLAogICAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgICAgICAgIGFsbG93RXNjYXBlS2V5OiBmYWxzZSwKICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkX2ludGVudHMoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyA9PSAiRmFpbHVyZSIpIHsKICAgICAgICAgICAgICAgIHZhciBteWh0bWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgICAgICAgIHZhciBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgicCIpOwogICAgICAgICAgICAgICAgcC5zdHlsZS50ZXh0QWxpZ24gPSAiY2VudGVyIjsKICAgICAgICAgICAgICAgIC8vIHAuc3R5bGUubWFyZ2luTGVmdCA9ICc1JSc7CiAgICAgICAgICAgICAgICBwLmlubmVySFRNTCA9ICJUaGUgZm9sbG93aW5nIGludGVudChzKSBhbHJlYWR5IGV4aXN0OiI7CiAgICAgICAgICAgICAgICBteWh0bWwuYXBwZW5kQ2hpbGQocCk7CiAgICAgICAgICAgICAgICB2YXIgdWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ1bCIpOwogICAgICAgICAgICAgICAgdWwuc3R5bGUubWFyZ2luTGVmdCA9ICIxMCUiOwogICAgICAgICAgICAgICAgdWwuc2V0QXR0cmlidXRlKCJpZCIsICJwcm9MaXN0Iik7CiAgICAgICAgICAgICAgICB2YXIgcHJvZHVjdExpc3QgPSByZXNwb25zZS5kYXRhLmZhaWxlZF9pbnRlbnRzOwogICAgICAgICAgICAgICAgcHJvZHVjdExpc3QgPSBwcm9kdWN0TGlzdC5tYXAoKGludGVudCkgPT4KICAgICAgICAgICAgICAgICAgaW50ZW50LnNwbGl0KHRoaXMuY29tcGFueWlkICsgIl8iKS5wb3AoKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIG15aHRtbC5hcHBlbmRDaGlsZCh1bCk7CiAgICAgICAgICAgICAgICBwcm9kdWN0TGlzdC5mb3JFYWNoKHJlbmRlclByb2R1Y3RMaXN0KTsKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJlbmRlclByb2R1Y3RMaXN0KGVsZW1lbnQsIGluZGV4LCBhcnIpIHsKICAgICAgICAgICAgICAgICAgdmFyIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGkiKTsKICAgICAgICAgICAgICAgICAgbGkuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJpdGVtIik7CiAgICAgICAgICAgICAgICAgIHVsLmFwcGVuZENoaWxkKGxpKTsKICAgICAgICAgICAgICAgICAgbGkuaW5uZXJIVE1MID0gbGkuaW5uZXJIVE1MICsgZWxlbWVudDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHVsLnN0eWxlLmxpc3RTdHlsZSA9ICJpbml0aWFsIjsKICAgICAgICAgICAgICAgIHVsLnN0eWxlLnRleHRBbGlnbiA9ICJsZWZ0IjsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmZhaWxlZF9pbnRlbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgaHRtbDogbXlodG1sLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAvLyB0aXRsZTogIlRoZSBmb2xsb3dpbmcgaW50ZW50cyBhbHJlYWR5IGV4aXN0OiIKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJUaGUgZm9sbG93aW5nIGludGVudHMgYWxyZWFkeSBleGlzdDoiLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOjI1MDAsCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIkVycm9yIikgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHRleHQ6ICJUaGVyZSB3YXMgYW4gaW50ZXJuYWwgc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgICAgICAgIHRpbWVyOjI1MDAsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIlF1ZXN0aW9uIExpbWl0IEFscmVhZHkgRXhjZWVkZWQhIikgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgdGV4dDoKICAgICAgICAgICAgICAgICAgICAiWW91ciBjYXBhY2l0eSB0byBhZGQgcXVlc3Rpb25zIGhhcyBleGNlZWRlZC4gUGxlYXNlIHVwZ3JhZGUgeW91ciBwbGFucy4iLAogICAgICAgICAgICAgICAgICB0aW1lcjozMDAwLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAvLyB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgJCgiI2ludGVudG1vZGVsIikubW9kYWwoImhpZGUiKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5lZGl0ID09ICJUcnVlIikgewogICAgICAgIGlmICh0aGlzLm5ld19pbnRlbnRzID09ICIiKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogIlBsZWFzZSBlbnRlciB0aGUgcmVxdWlyZWQgZmllbGRzIiwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB0aW1lcjoyNTAwLAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubmV3X2ludGVudF9kYXRhLnB1c2goYCR7dGhpcy5jb21wYW55aWR9XyR7dGhpcy5uZXdfaW50ZW50c31gKTsKICAgICAgICAgIHRoaXMuZWRpdF9pbnRlbnRfYXBpKHRoaXMub2xkX2ludGVudF9kYXRhLCB0aGlzLm5ld19pbnRlbnRfZGF0YSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZWRpdF9pbnRlbnRfYXBpKG9sZF9pbnRlbnRfZGF0YSwgbmV3X2ludGVudF9kYXRhKSB7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgJCgiI2ludGVudG1vZGVsIikubW9kYWwoImhpZGUiKTsKICAgICAgYXhpb3MKICAgICAgICAucG9zdCgKICAgICAgICAgIGFwaV9jYWxscy5hZGRfaW50ZW50X3VybCgpLAogICAgICAgICAgewogICAgICAgICAgICBvbGRfaW50ZW50X2RhdGE6IG9sZF9pbnRlbnRfZGF0YSwKICAgICAgICAgICAgbmV3X2ludGVudF9kYXRhOiBuZXdfaW50ZW50X2RhdGEsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgIGVkaXRpbnRlbnQ6ICJUcnVlIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgdGhpcy5lZGl0ID09ICJGYWxzZSI7CiAgICAgICAgICB0aGlzLmlzR2xvYmFsRWRpdCA9IGZhbHNlOwogICAgICAgICAgLy8gJCgiI2ludGVudG1vZGVsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgIC8vIHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAiRmFpbGVkIHRvIGVkaXQgaW50ZW50KHMpIiB8fAogICAgICAgICAgdGhpcy5jbGVhcl9maWVsZHMoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEuZmFpbGVkX2ludGVudHMpOyAgICAgICAKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyA9PSAiRmFpbHVyZSIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0ZXh0OiAiSW50ZW50KHMpIGFyZSBub3QgdXBkYXRlZCwgZHVlIHRvIHNvbWUgdGVjaG5pY2FsIGlzc3Vlcy4iLAogICAgICAgICAgICAgIHRpbWVyOjI1MDAsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyA9PSAiU3VjY2VzcyIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIHRleHQ6ICJJbnRlbnQocykgVXBkYXRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgICAgICAgICAgICBhbGxvd0VzY2FwZUtleTogZmFsc2UsCiAgICAgICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgdGhpcy5sb2FkX2ludGVudHMoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT0gIkludGVybmFsIFNlcnZlciBFcnJvciIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0ZXh0OiAiVGhlcmUgd2FzIGFuIGludGVybmFsIHNlcnZlciBlcnJvci4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgICAgICAgIHRpbWVyOjI1MDAsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBjbGVhcl9maWVsZHMoKSB7CiAgICAgIHRoaXMubmV3X2ludGVudHMgPSBbXTsKICAgICAgdGhpcy5uZXdfaW50ZW50X2RhdGEgPSBbXTsKICAgICAgdGhpcy5vbGRfaW50ZW50X2RhdGEgPSBbXTsKICAgICAgdGhpcy5hZGRfaW50ZW50c19saXN0ID0gWyIiXTsKICAgICAgdGhpcy5lZGl0ID0gIkZhbHNlIjsKICAgIH0sCiAgICBzZXRwYWdpbmF0aW9uKHBhZ2Vfbm8pIHsKICAgICAgdGhpcy5wYWdlX2FycmF5ID0gW107CiAgICAgIGlmICh0aGlzLnRvdGFsX3BhZ2VzIDw9IDcpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IDEpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gdGhpcy50b3RhbF9wYWdlcykgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CiAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMudG90YWxfcGFnZXMgLSA0OyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPD0gNCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZV9ubyArIDM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPj0gdGhpcy50b3RhbF9wYWdlcyAtIDQpIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gNDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gMzsgaSA8PSBwYWdlX25vICsgMzsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfQogICAgfSwKICAgIC8vIHJlc2V0cGFnZW51bWJlcigpewogICAgLy8gICB0aGlzLnBhZ2Vfbm89MTsKICAgIC8vIH0sCiAgICBwYWdpbmF0aW9uX2NsYXNzKGluZGV4KSB7CiAgICAgIGlmIChpbmRleCA9PSB0aGlzLnBhZ2Vfbm8pIHsKICAgICAgICByZXR1cm4gIiBhY3RpdmUiOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgfSwKICAgIGFkZF90b19pbnRlbnRfbGlzdCh0eXBlLCBpbmRleCkgewogICAgICBpZiAodHlwZSA9PSAiYWRkIikgewogICAgICAgIHRoaXMuYWRkX2ludGVudHNfbGlzdC5wdXNoKCIiKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5hZGRfaW50ZW50c19saXN0LnNwbGljZShpbmRleCwgMSk7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},null]}