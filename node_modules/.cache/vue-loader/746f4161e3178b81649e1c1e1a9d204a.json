{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/End User Response/VerifyResponsesUserFeedback.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/End User Response/VerifyResponsesUserFeedback.vue","mtime":1643027096172},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBzd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IFN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgYXBpX2NhbGxzIGZyb20gIkAvcG9ydGFsL2FwaV9jYWxscyI7CmltcG9ydCB7IHNldFRpbWVvdXQgfSBmcm9tICJ0aW1lcnMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICdWZXJpZnlSZXNwb25zZXNVc2VyRmVlZGJhY2snLAogICAgY29tcG9uZW50czogewogICAgICAgIE11bHRpc2VsZWN0LAogICAgfSwKICAgIHdhdGNoOiB7CiAgICBzZWxlY3RlZF91c2VyX2xpc3QobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgaWYgKG5ld1ZhbC5sZW5ndGggPT09IDApIHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWRfdXNlcl9saXN0ID0gWyJObyJdOwogICAgICAgIH0sIDIwMCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5wYWdlX25vID0gMTsKICAgICAgICAkKCIjc2VsZWN0YWxsIikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191c2VyX2ZlZWRiYWNrKCk7CiAgICAgIH0KICAgIH0sCiAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICB1bmFuc3dlcmVkX2xpc3Q6IFtdLAogICAgICAgIHVzZXJfcm9sZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUsCiAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBpbnRlbnRfbGlzdDogW10sCiAgICAgICAgY2hlY2tlZF9saXN0OiBbXSwKICAgICAgICB1c2VyX2xpc3Q6IFsiWWVzIiwgIk5vIl0sCiAgICAgICAgc2VsZWN0ZWRfdXNlcl9saXN0OiBbIk5vIl0sCiAgICAgICAgaW50ZW50bGlzdDogIiIsCiAgICAgICAgcGVyX3BhZ2U6IDEwLAogICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgdG90YWxfcGFnZXM6IDAsCiAgICAgICAgc2hvd19sb2FkZXI6IGZhbHNlLAogICAgICAgIG51bWJlcl9vZl9yb3dzOiBudWxsLAogICAgICAgIHNlYXJjaF9uYW1lOiAiIiwKICAgICAgICBwYWdlX2FycmF5OiBbXSwKICAgICAgICBvbGRfcXVlc3Rpb246ICIiLAogICAgICAgIG9sZF9pbnRlbnQ6ICIiLAogICAgICAgIG5ld19pbnRlbnRfbGlzdDogW10sCiAgICAgICAgb2xkX2RhdGE6IHsgcXVlc3Rpb246IG51bGwsIGludGVudDogbnVsbCB9LAogICAgICAgIHRodW1ic19kb3duX2ljb246IHJlcXVpcmUoIkAvcG9ydGFsL2Fzc2V0cy9pbWcvR3JvdXAgNjEuc3ZnIiksCiAgICAgICAgdGh1bWJzX3VwX2ljb246IHJlcXVpcmUoIkAvcG9ydGFsL2Fzc2V0cy9pbWcvR3JvdXAgNzEuc3ZnIiksCiAgICAgICAgLy8gdmlld19jb21wb25lbnRfbmFtZTogInVuYW5zd2VyZWRfcXVlc3Rpb25zIiwKICAgICAgICB9OwogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgICAkKCIjc2VsZWN0YWxsIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgIGlmICgkKHRoaXMpLmlzKCI6Y2hlY2tlZCIpKSB7CiAgICAgICAgICAgICQoIi5jaGVja2luZyIpLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2bS5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAgICAgJCgiLmNoZWNraW5nIikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kcm9vdC4kb24oImFkZF9xdWVzdGlvbnNfdXNlcl9yZXNwb25zZXMiLCAoZGF0YSkgPT4gewogICAgICAgICAgICB0aGlzLmFkZF9xdWVzdGlvbnMoKTsKICAgICAgICB9KTsKICAgICAgICB0aGlzLiRyb290LiRvbigic2VhcmNoX3VzZXJfcmVzcG9uc2VzIiwgKGRhdGEpID0+IHsKICAgICAgICAgICAgdGhpcy5zZWFyY2hfbmFtZSA9IGRhdGE7CiAgICAgICAgICAgIHRoaXMuc2VhcmNoX3F1ZXN0aW9uKCk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kcm9vdC4kb24oImRlbGV0ZV9tdWx0aXBsZV91c2VyX3Jlc3BvbnNlcyIsIChkYXRhKSA9PiB7CiAgICAgICAgICAgIHRoaXMuZGVsZXRlX211bHRpcGxlKCk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kcm9vdC4kb24oImxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191c2VyX2ZlZWRiYWNrIiwgKGRhdGEpID0+IHsKICAgICAgICAgICAgdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjaygpOwogICAgICAgIH0pOwogICAgfSwKICAgICBiZWZvcmVEZXN0cm95KCkgewogICAgICAgIHRoaXMuJHJvb3QuJG9mZigiYWRkX3F1ZXN0aW9uc191c2VyX3Jlc3BvbnNlcyIpOwogICAgICAgIHRoaXMuJHJvb3QuJG9mZigic2VhcmNoX3VzZXJfcmVzcG9uc2VzIik7CiAgICAgICAgdGhpcy4kcm9vdC4kb2ZmKCJkZWxldGVfbXVsdGlwbGVfdXNlcl9yZXNwb25zZXMiKTsKICAgICAgICB0aGlzLiRyb290LiRvZmYoImxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191c2VyX2ZlZWRiYWNrIik7CiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjaygpOwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBsb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjaygpewogICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0ID0gW107CiAgICAgICAgdGhpcy5pbnRlbnRfbGlzdCA9IFtdOwogICAgICAgIHRoaXMubmV3X2ludGVudF9saXN0ID0gW107CiAgICAgICAgdGhpcy5zZWFyY2hfbmFtZSA9ICIiOwogICAgICAgIGlmICh0aGlzLnVzZXJfcm9sZSA9PSAiU3VwZXJBZG1pbiIpIHsKICAgICAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpKSB7CiAgICAgICAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlJZCIpOwogICAgICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7CiAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuY29tcGFueW5hbWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGF4aW9zCiAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICBhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICBpc0RlbGV0ZTogIkZhbHNlIiwKICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubywKICAgICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICAgICAgaXNfZ2V0X3VzZXJfcmVzcG9uc2U6IHRydWUsCiAgICAgICAgICAgICAgICBzdGF0dXM6IHRoaXMuc2VsZWN0ZWRfdXNlcl9saXN0CgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGFbMF0ubGVuZ3RoOwogICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YVs0XS5wYWdlY291bnQ7CiAgICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3QgPSBbXTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBkYXRhWzBdKSB7CiAgICAgICAgICAgICAgICBsZXQgdGVtcF9pbnQgPSAiIjsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGFbMl1baV0pOwogICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgIC8vIHRlbXBfaW50ID0gZGF0YVsyXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIik7CiAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IGRhdGFbMl1baV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0ZW1wX2ludCk7CiAgICAgICAgICAgICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiBkYXRhWzBdW2ldLAogICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgIG5ld19pbnRlbnQ6ICIiLAogICAgICAgICAgICAgICAgc291cmNlOiBkYXRhWzFdW2ldLAogICAgICAgICAgICAgICAgdXNlcl9yZXNwb25zZTogZGF0YVsyXVtpXSwKICAgICAgICAgICAgICAgIHVzZXJfZmVlZGJhY2s6IGRhdGFbM11baV0sCiAgICAgICAgICAgICAgICBlZGl0OiBmYWxzZSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc2V0cGFnaW5hdGlvbih0aGlzLnBhZ2Vfbm8pOwogICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihlLm1lc3NhZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwKICAgICAgICAgICAgewogICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgaXNEcm9wZG93bjogIlRydWUiLAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgLy8gZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhWzBdKSB7CiAgICAgICAgICAgIC8vIHRoaXMuaW50ZW50X2xpc3QucHVzaCgKICAgICAgICAgICAgLy8gICAgIHJlc3BvbnNlLmRhdGFbMF1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpCiAgICAgICAgICAgIC8vICk7CiAgICAgICAgICAgIC8vIHRoaXMubmV3X2ludGVudF9saXN0LnB1c2goCiAgICAgICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhWzBdW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKQogICAgICAgICAgICAvLyApOwogICAgICAgICAgICAvLyB9CiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YVswXSkgewogICAgICAgICAgICB0aGlzLmludGVudF9saXN0LnB1c2goCiAgICAgICAgICAgICAgICByZXNwb25zZS5kYXRhWzBdW2ldCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHRoaXMubmV3X2ludGVudF9saXN0LnB1c2goCiAgICAgICAgICAgICAgICByZXNwb25zZS5kYXRhWzBdW2ldCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBzZXRwYWdpbmF0aW9uKHBhZ2Vfbm8pIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkgPSBbXTsKICAgICAgICBpZiAodGhpcy50b3RhbF9wYWdlcyA8PSA3KSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSAxKSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gdGhpcy50b3RhbF9wYWdlcykgewogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMudG90YWxfcGFnZXMgLSA0OyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA8PSA0KSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZV9ubyArIDM7IGkrKykgewogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgICAgfSBlbHNlIGlmIChwYWdlX25vID49IHRoaXMudG90YWxfcGFnZXMgLSA0KSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gcGFnZV9ubyAtIDQ7IGkgPCB0aGlzLnRvdGFsX3BhZ2VzOyBpKyspIHsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gMzsgaSA8PSBwYWdlX25vICsgMzsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHBhZ2VfcmVxdWlyZShwYWdlKSB7CiAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgaWYgKHBhZ2UgPT0gMCB8fCBwYWdlID09IHRoaXMudG90YWxfcGFnZXMgKyAxKSB7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJCgiLmNoZWNraW5nIikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICAgICAgJCgiI3NlbGVjdGFsbCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgICAgIGlmIChwYWdlID09ICIuLi5zIikgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKDEgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFnZSA9PSAiLi4ubCIpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCh0aGlzLnRvdGFsX3BhZ2VzICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09ICIiKSB7CiAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgICBhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICAgIGlzRGVsZXRlOiAiRmFsc2UiLAogICAgICAgICAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubywKICAgICAgICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgICAgICAgICBpc19nZXRfdXNlcl9yZXNwb25zZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHRoaXMuc2VsZWN0ZWRfdXNlcl9saXN0CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdCA9IFtdOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhWzBdKSB7CiAgICAgICAgICAgICAgICAgIGxldCB0ZW1wX2ludCA9ICIiOwogICAgICAgICAgICAgICAgICBpZiAoQm9vbGVhbihyZXNwb25zZS5kYXRhWzJdW2ldKSkgewogICAgICAgICAgICAgICAgICAvLyB0ZW1wX2ludCA9IHJlc3BvbnNlLmRhdGFbMl1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpOwogICAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IHJlc3BvbnNlLmRhdGFbMl1baV07CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiByZXNwb25zZS5kYXRhWzBdW2ldLAogICAgICAgICAgICAgICAgICBpbnRlbnQ6IHRlbXBfaW50LAogICAgICAgICAgICAgICAgICBzb3VyY2U6IHJlc3BvbnNlLmRhdGFbMV1baV0sCiAgICAgICAgICAgICAgICAgIHVzZXJfcmVzcG9uc2U6IHJlc3BvbnNlLmRhdGFbMl1baV0sCiAgICAgICAgICAgICAgICAgIHVzZXJfZmVlZGJhY2s6IHJlc3BvbnNlLmRhdGFbM11baV0sCiAgICAgICAgICAgICAgICAgIGVkaXQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuc2V0cGFnaW5hdGlvbih0aGlzLnBhZ2Vfbm8pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgICAgYXhpb3MKICAgICAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICAgICAgYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgICAgIGlzc2VhcmNoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIC8vIHNlYXJjaGJ5OiB0aGlzLnNlYXJjaF9ieSwKICAgICAgICAgICAgICAgICAgICBrZXk6IHRoaXMuc2VhcmNoX25hbWUsCiAgICAgICAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICAgICAgICAgIGlzX2dldF91c2VyX3Jlc3BvbnNlOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHN0YXR1czogdGhpcy5zZWxlY3RlZF91c2VyX2xpc3QKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhWzRdLnBhZ2Vjb3VudCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlOwogICAgICAgICAgICAgICAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0ID0gW107CiAgICAgICAgICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGFbMF0ubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhWzRdLnBhZ2Vjb3VudDsKICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhWzBdKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHRlbXBfaW50ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIHRlbXBfaW50ID0gZGF0YVsyXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIik7CiAgICAgICAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IGRhdGFbMl1baV07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbjogcmVzcG9uc2UuZGF0YVswXVtpXSwKICAgICAgICAgICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiByZXNwb25zZS5kYXRhWzFdW2ldLAogICAgICAgICAgICAgICAgICAgICAgICB1c2VyX3Jlc3BvbnNlOiByZXNwb25zZS5kYXRhWzJdW2ldLAogICAgICAgICAgICAgICAgICAgICAgICB1c2VyX2ZlZWRiYWNrOiByZXNwb25zZS5kYXRhWzNdW2ldLAogICAgICAgICAgICAgICAgICAgICAgICBlZGl0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgICAgICAgLy8gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgLy8gfSwgMjUwMCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjaygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcXVlc3Rpb25fc2VsZWN0ZWQodmFsdWUpIHsKICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gImFsbCIpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnVuYW5zd2VyZWRfbGlzdCkgewogICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QucHVzaCh0aGlzLnVuYW5zd2VyZWRfbGlzdFtpXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdC5wdXNoKHRoaXMudW5hbnN3ZXJlZF9saXN0W3ZhbHVlXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT0gImFsbCIpIHsKICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGFsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNzZWxlY3RhbGwiKTsKICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGFsbC5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RhbGwuY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gdGhpcy5jaGVja2VkX2xpc3QuZmlsdGVyKChxdWVzdGlvbikgPT4gewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXN0aW9uICE9PSB0aGlzLnVuYW5zd2VyZWRfbGlzdFt2YWx1ZV07CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRlbXA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGRlbGV0ZV9zaW5nbGUoaW5kZXgpIHsKICAgICAgICAgICAgbGV0IHF1ZXN0aW9ubGlzdCA9IFtdOwogICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgdGl0bGU6ICJBcmUgeW91IHN1cmU/IiwKICAgICAgICAgICAgICAgIHRleHQ6ICIgWW91IHdhbnQgdG8gRGVsZXRlIHRoaXMgUXVlc3Rpb24/IiwKICAgICAgICAgICAgICAgIHR5cGU6ICJxdWVzdGlvbiIsCiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIENvbmZpcm0hIiwKICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQudmFsdWUpOwogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImRlbGV0ZWQiKTsKICAgICAgICAgICAgICAgIHF1ZXN0aW9ubGlzdC5wdXNoKHRoaXMudW5hbnN3ZXJlZF9saXN0W2luZGV4XS5xdWVzdGlvbik7CiAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZV9xdWVzdGlvbnNfYXBpKHF1ZXN0aW9ubGlzdCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZGVsZXRlX211bHRpcGxlKCkgewogICAgICAgICAgICBpZiAodGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICB0aXRsZToiTm8gcXVlc3Rpb24gc2VsZWN0ZWQhIiwKICAgICAgICAgICAgICAgIHRleHQ6IiIsCiAgICAgICAgICAgICAgICB0eXBlOiJlcnJvciIsCiAgICAgICAgICAgICAgICB0aW1lcjoyMDAwLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbGV0IHF1ZXN0aW9ubGlzdCA9IFtdOwogICAgICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgICAgICAgICB0ZXh0OiAiIFlvdSB3YW50IHRvIERlbGV0ZSB0aGlzIFF1ZXN0aW9ucz8iLAogICAgICAgICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgQ29uZmlybSEiLAogICAgICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmNoZWNrZWRfbGlzdCkgewogICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9ubGlzdC5wdXNoKHRoaXMuY2hlY2tlZF9saXN0W2ldLnF1ZXN0aW9uKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVfcXVlc3Rpb25zX2FwaShxdWVzdGlvbmxpc3QpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGRlbGV0ZV9xdWVzdGlvbnNfYXBpKHF1ZXN0aW9ubGlzdCkgewogICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgIGF4aW9zCiAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICBhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICAgIHF1ZXN0aW9ubGlzdDogcXVlc3Rpb25saXN0LAogICAgICAgICAgICAgICAgaXNEZWxldGU6ICJUcnVlIiwKICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJEZWxldGVkIFN1Y2Nlc3NmdWxseSIpIHsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJkZWxldGVkIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhWzJdLm51bWJlcl9vZl9yb3dzOwogICAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IE1hdGguY2VpbCh0aGlzLm51bWJlcl9vZl9yb3dzIC8gdGhpcy5wZXJfcGFnZSk7CiAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiRGVsZXRlZCBTdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgLy8gdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAvLyB9LCAxNTAwKTsKICAgICAgICAgICAgICAgIGlmKHF1ZXN0aW9ubGlzdC5sZW5ndGggPT09IHRoaXMudW5hbnN3ZXJlZF9saXN0Lmxlbmd0aCAmJiAKICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPjEpewogICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHRoaXMucGFnZV9ubyAtIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB3aGlsZSh0aGlzLnBhZ2Vfbm8gPiAxICYmIHRoaXMucGFnZV9ubyA+IHRoaXMudG90YWxfcGFnZXMpewogICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHRoaXMucGFnZV9ubyAtIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191c2VyX2ZlZWRiYWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoZS5tZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZWRpdF9pdGVtKGluZGV4KSB7CiAgICAgICAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0W2luZGV4XS5lZGl0ID0gIXRoaXMudW5hbnN3ZXJlZF9saXN0W2luZGV4XS5lZGl0OwogICAgICAgICAgICB0aGlzLm9sZF9xdWVzdGlvbiA9IHRoaXMudW5hbnN3ZXJlZF9saXN0W2luZGV4XS5xdWVzdGlvbjsKICAgICAgICAgICAgLy8gdGhpcy5vbGRfaW50ZW50ID0gdGhpcy51bmFuc3dlcmVkX2xpc3RbaW5kZXhdLmludGVudDsKICAgICAgICAgICAgdGhpcy5vbGRfZGF0YS5xdWVzdGlvbiA9IHRoaXMub2xkX3F1ZXN0aW9uOwogICAgICAgICAgICAvLyB0aGlzLm9sZF9kYXRhLmludGVudCA9IHRoaXMuY29tcGFueWlkICsgIl8iICsgdGhpcy5vbGRfaW50ZW50OwogICAgICAgICAgICAvLyB0aGlzLnF1ZXN0aW9uID0gcXVlc3Rpb24ucXVlc3Rpb247CiAgICAgICAgICAgIC8vIHRoaXMuaW50ZW50ID0gcXVlc3Rpb24uaW50ZW50OwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLm9sZF9kYXRhKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5vbGRfcXVlc3Rpb24pOwogICAgICAgIH0sCiAgICAgICAgc3VibWl0X3F1ZXN0aW9uKCkgewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygic3VibWl0Iik7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJxdWVzdGlvbiIsIHRoaXMub2xkX3F1ZXN0aW9uKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImludGVudCIsIHRoaXMub2xkX2ludGVudCk7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJpbnRlbnQiLCB0aGlzLmlzZWRpdCk7CiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGlmICh0aGlzLm9sZF9xdWVzdGlvbiA9PSAiIikgewogICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgYWxsIHRoZSBmaWVsZHMuIik7CiAgICAgICAgICAgIH0gZWxzZSB7CgkJJCgiI2V4YW1wbGVNb2RhbENlbnRlciIpLm1vZGFsKCdoaWRlJyk7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgICAgICAgICBhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlzX0VkaXQ6ICJUcnVlIiwKICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbjogdGhpcy5vbGRfcXVlc3Rpb24sCiAgICAgICAgICAgICAgICAgICAgLy8gaW50ZW50OiB0aGlzLmNvbXBhbnlpZCArICJfIiArIHRoaXMub2xkX2ludGVudCwKICAgICAgICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICAgICAgICAgIG9sZF9xdWVzdGlvbl9kYXRhOiB0aGlzLm9sZF9kYXRhLAogICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PSAiSW50ZXJuYWwgU2VydmVyIEVycm9yIikgewogICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhID09ICJFZGl0ZWQgU3VjY2Vzc2Z1bGx5IikgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJZb3VyIHF1ZXN0aW9uIGhhcyBiZWVuIGVkaXRlZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lcjoyNTAwLAogICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC8vIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyB9CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2soKTsKCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIGlmIChyZXNwb25zZS5kYXRhID09ICJRdWVzdGlvbiBJbnRlbnQgVXBkYXRlZCIpIHsKICAgICAgICAgICAgICAgICAgICAvLyBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIC8vICAgICB0ZXh0OiAiWW91ciBxdWVzdGlvbiBoYXMgYmVlbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRpbWVyOjIwMDAsCiAgICAgICAgICAgICAgICAgICAgLy8gfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vIH0KICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjaygpOwogICAgICAgICAgICAgICAgICAgIC8vIH0pOwogICAgICAgICAgICAgICAgICAgIC8vIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHBhZ2luYXRpb25fY2xhc3MoaW5kZXgpIHsKICAgICAgICAgICAgaWYgKGluZGV4ID09IHRoaXMucGFnZV9ubykgewogICAgICAgICAgICAgICAgcmV0dXJuICIgYWN0aXZlIjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYWRkX3F1ZXN0aW9ucygpIHsKICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IHRydWU7CiAgICAgICAgICAgIHZhciBxdWVzdGlvbmxpc3QgPSBbXTsKICAgICAgICAgICAgdmFyIHRlbXBfbGlzdCA9IFtdOwogICAgICAgICAgICB2YXIgZW1wdHkgPSB0aGlzLnVuYW5zd2VyZWRfbGlzdC5maWx0ZXIoKHVuYW5zd2VyZWQpID0+IHsKICAgICAgICAgICAgICAgIHJldHVybiB1bmFuc3dlcmVkLm5ld19pbnRlbnQgPT0gIiI7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMudW5hbnN3ZXJlZF9saXN0KSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy51bmFuc3dlcmVkX2xpc3RbaV0ubmV3X2ludGVudCAhPSAiIikgewogICAgICAgICAgICAgICAgdGVtcF9saXN0LnB1c2goCiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3RbaV0ucXVlc3Rpb24sCiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jb21wYW55aWQgKyAiXyIgKyB0aGlzLnVuYW5zd2VyZWRfbGlzdFtpXS5uZXdfaW50ZW50CiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3RbaV0ubmV3X2ludGVudAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIHF1ZXN0aW9ubGlzdC5wdXNoKHRlbXBfbGlzdCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0ZW1wX2xpc3QgPSBbXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocXVlc3Rpb25saXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgICAgICAgICAgYXhpb3MKICAgICAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICAgICAgICAgIGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgICAgICBpc0FkZDogIlRydWUiLAogICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uaW50ZW50OiBxdWVzdGlvbmxpc3QsCiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIkFkZGVkIFN1Y2Nlc3NmdWxseSIpIHsKICAgICAgICAgICAgICAgICAgICAgIHN3YWwoewogICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICJBZGRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogMjAwMCwKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgaWYocXVlc3Rpb25saXN0Lmxlbmd0aCA9PT0gdGhpcy51bmFuc3dlcmVkX2xpc3QubGVuZ3RoICYmIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlX25vID4xKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHRoaXMucGFnZV9ubyAtIDE7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2soKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJObyBxdWVzdGlvbiB0byBhZGQuIFBsZWFzZSBhZGQgc29tZSBxdWVzdGlvbnMuIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgc2VhcmNoX3F1ZXN0aW9uKCkgewogICAgICAgICAgICAvLyBpZih0aGlzLnNlYXJjaF9ieSE9JycpewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiaGV5Iik7CiAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lICE9ICIiKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IHRydWU7CiAgICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgICAgICAgYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgICAgICBpc3NlYXJjaDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAvLyBzZWFyY2hieTogdGhpcy5zZWFyY2hfYnksCiAgICAgICAgICAgICAgICAgICAga2V5OiB0aGlzLnNlYXJjaF9uYW1lLAogICAgICAgICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICAgICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgICAgICAgICAgICAgaXNfZ2V0X3VzZXJfcmVzcG9uc2U6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB0aGlzLnNlbGVjdGVkX3VzZXJfbGlzdAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJObyBRdWVzdGlvbnMgRm91bmQiKSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJObyBRdWVzdGlvbiBGb3VuZCIpOwogICAgICAgICAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICAgICAgICAvLyB9LCAyNTAwKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191c2VyX2ZlZWRiYWNrKCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhWzRdLnBhZ2Vjb3VudCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSAxOwogICAgICAgICAgICAgICAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0ID0gW107CiAgICAgICAgICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGFbMF0ubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhWzRdLnBhZ2Vjb3VudDsKICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhWzBdKSB7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgdGVtcF9pbnQgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKGRhdGFbMl1baV0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlbXBfaW50ID0gZGF0YVsyXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW50ID0gZGF0YVsyXVtpXTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb246IGRhdGFbMF1baV0sCiAgICAgICAgICAgICAgICAgICAgICBpbnRlbnQ6IHRlbXBfaW50LAogICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBkYXRhWzFdW2ldLAogICAgICAgICAgICAgICAgICAgICAgdXNlcl9yZXNwb25zZTogZGF0YVsyXVtpXSwKICAgICAgICAgICAgICAgICAgICAgIHVzZXJfZmVlZGJhY2s6IGRhdGFbM11baV0sCiAgICAgICAgICAgICAgICAgICAgICBlZGl0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnVuYW5zd2VyZWRfbGlzdCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJObyBRdWVzdGlvbnMgRm91bmQiKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gICB0b2FzdHIuZXJyb3IoIk5vIFF1ZXN0aW9uIEZvdW5kIik7CiAgICAgICAgICAgICAgICAgICAgLy8gICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgLy8gICB9LCAyNTAwKTsKICAgICAgICAgICAgICAgICAgICAvLyB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKTsKICAgICAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgLy8gICB9LCAyNTAwKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191c2VyX2ZlZWRiYWNrKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiRW50ZXIgcHJvcGVyIGRhdGEgZm9yIHNlYXJjaGluZyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIH1lbHNlewogICAgICAgICAgICAvLyAgIHRvYXN0ci5lcnJvcigiU2VsZWN0IGhlYWRlciBmb3Igc2VhcmNoaW5nIik7CiAgICAgICAgICAgIC8vIH0KICAgICAgICB9LAogICAgfQp9Cg=="},null]}