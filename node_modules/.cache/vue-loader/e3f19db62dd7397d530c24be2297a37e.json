{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/User Management/AddUser.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/User Management/AddUser.vue","mtime":1643027096184},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBTd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKaW1wb3J0IFBhc3N3b3JkVmFsaWRhdG9yIGZyb20gIi4uL1BhZ2VzL1Bhc3N3b3JkVmFsaWRhdG9yLnZ1ZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiYWRkLXVzZXIiLAogIGNvbXBvbmVudHM6IHsKICAgIE11bHRpc2VsZWN0LAogICAgUGFzc3dvcmRWYWxpZGF0b3IsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNWaXNpYmxlU2VhcmNoQ2xlYXI6IGZhbHNlLAogICAgICBwb3J0YWxfcm9sZXM6IFtdLAogICAgICBjb3JyZWN0X3Bhc3N3b3JkOiBmYWxzZSwKICAgICAgc2VsZWN0ZWRfcm9sZTogIiIsCiAgICAgIGNoZWNrZWRfbGlzdDogW10sCiAgICAgIGVtYWlsbGlzdDogW10sCiAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgZW1haWw6ICIiLAogICAgICBwZXJfcGFnZTogMTAsCiAgICAgIHRvdGFsX3BhZ2VzOiBudWxsLAogICAgICBudW1iZXJfb2Zfcm93czogbnVsbCwKICAgICAgcGFnZV9ubzogMSwKICAgICAgY29tcGFueW5hbWU6ICIiLAogICAgICBjb21wYW55aWQ6ICIiLAogICAgICB1c2VyczogW10sCiAgICAgIHJvbGVzOiBbXSwKICAgICAgcm9sZTogIiIsCiAgICAgIHJlZ19lbWFpbDogL14oWzAtOWEtekEtWl0oWy0uXHddKlswLTlhLXpBLVpdKSpAKFswLTlhLXpBLVpdWy1cd10qWzAtOWEtekEtWl1cLikrW2EtekEtWl17Miw5fSkkLywKICAgICAgcmVnX3B3ZDogL14oPz0uKlthLXpdKSg/PS4qW0EtWl0pKD89LipcZCkoPz0uKlsjQCElKj8mJF0pW0EtWmEtelxkI0AhJSo/JiRdezgsfS8sCiAgICAgIHNob3dfbG9hZGVyOiBmYWxzZSwKICAgICAgLy9oYXJzaAogICAgICBwYWdlX2FycmF5OiBbXSwKICAgICAgc2VhcmNoX25hbWU6ICIiLAogICAgICBzcGlubmVyT246IGZhbHNlLAogICAgICBzaG93X2VtYWlsX2ZpZWxkOiBmYWxzZSwKICAgICAgc2hvd19wYXNzd29yZF9maWVsZDogZmFsc2UsCiAgICAgIHJvbGVzX2Ryb3B3ZG93bjogWwogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAiUG9ydGFsIFJvbGUiLAogICAgICAgICAgbGlzdDogW10sCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogIkJvdCBSb2xlIiwKICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgIH0sCiAgICAgIF0sCiAgICAgIHJvbGVfc2VsZWN0ZWQ6IG51bGwsCiAgICAgIHJvbGVfdHlwZV9zZWxlY3RlZDogbnVsbCwKICAgICAgLy8gbGV0dGVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGV0dGVyIiksCiAgICAgIC8vIGNhcGl0YWw6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYXBpdGFsIiksCiAgICAgIC8vIG51bWJlcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm51bWJlciIpLAogICAgICAvLyBzcGVjaWFsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3BlY2lhbCIpLAogICAgICAvLyBhcnJheTogW10sCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHZhbGlkUGFzc3dvcmQoKSB7CiAgICAgIGlmICh0aGlzLnJlZ19wd2QudGVzdCh0aGlzLnBhc3N3b3JkKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiUGFzc3dvcmQgbXVzdCBjb250YWluIG1pbmltdW0gOCBjaGFyYWN0ZXJzLCBhdGxlYXN0IDEgVXBwZXJDYXNlIEFscGhhYmV0LCAxIExvd2VyQ2FzZSBBbHBoYWJldCwgMSBOdW1iZXIgYW5kIDEgU3BlY2lhbCBDaGFyYWN0ZXIiOwogICAgICB9CiAgICB9LAogICAgdmFsaWRFbWFpbCgpIHsKICAgICAgaWYgKHRoaXMucmVnX2VtYWlsLnRlc3QodGhpcy5lbWFpbCkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5sb2FkX3VzZXIoKTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB2YXIgdm0gPSB0aGlzOwogICAgJCgiI3NlbGVjdGFsbCIpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCQodGhpcykuaXMoIjpjaGVja2VkIikpIHsKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2bS5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgIH0KICAgIH0pOwogICAgJCgiI3VzZXJtb2RlbCIpLm9uKCJoaWRkZW4uYnMubW9kYWwiLCAoKSA9PiB7CiAgICAgIHZtLmNsZWFyX2ZpZWxkcygpOwogICAgICAvLyB2bS5yb2xlX3NlbGVjdGVkID0gbnVsbDsKICAgICAgLy8gdm0ucm9sZV90eXBlX3NlbGVjdGVkID0gbnVsbDsKICAgIH0pOwogICAgLy8gdGhpcy4kcm9vdC4kb24oImNvcnJlY3RQYXNzd29yZCIsICh2YWx1ZSkgPT4gewogICAgLy8gICBjb25zb2xlLmxvZyh2YWx1ZSk7CiAgICAvLyAgIHRoaXMuY29ycmVjdF9wYXNzd29yZCA9IHZhbHVlOwogICAgLy8gfSk7CiAgfSwKICB3YXRjaDogewogICAgc2VhcmNoX25hbWUoKSB7CiAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09PSAiIikgewogICAgICAgIHRoaXMubG9hZF91c2VyKCk7CiAgICAgICAgdGhpcy5pc1Zpc2libGVTZWFyY2hDbGVhciA9IGZhbHNlOwogICAgICB9IGVsc2UgaWYgKHRoaXMuc2VhcmNoX25hbWUgIT09ICIiKSB7CiAgICAgICAgdGhpcy5pc1Zpc2libGVTZWFyY2hDbGVhciA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgfSwKICBfbWV0aG9kczogewogICAgb3Blbl91c2VybW9kZWwoKXsKICAgICAgICBpZih0aGlzLnBvcnRhbF9yb2xlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAkKCIjdXNlcm1vZGVsIikubW9kYWwoInNob3ciKTsKICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgIHRleHQ6Ik5vIFJvbGVzIGhhcyBiZWVuIEFkZGVkIFlldC4gUGxlYXNlIEFkZCBhIFJvbGUgZnJvbSB0aGUgJ1JvbGVzJyBQYWdlIHRvIGNvbnRpbnVlIGFkZGluZyBVc2Vycy4iLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLAogICAgICAgICAgICB0aW1lcjogNjAwMCwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0sCiAgICBjaGVja3Bhc3N3b3JkKGNvcnJlY3RQYXNzd29yZCkgewogICAgICB0aGlzLmNvcnJlY3RfcGFzc3dvcmQgPSBjb3JyZWN0UGFzc3dvcmQ7CiAgICB9LAogICAgLy8gY2hlY2tfdmFsdWUgKCkgewoKICAgIC8vICAgaWYgKHRoaXMucGFzc3dvcmQgIT0gIiIpIHsKICAgIC8vICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWVzc2FnZSIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtZXNzYWdlIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgIC8vICAgfQogICAgLy8gICB2YXIgbG93ZXJDYXNlTGV0dGVycyA9IC9bYS16XS9nOwogICAgLy8gICBpZiAodGhpcy5wYXNzd29yZC5tYXRjaChsb3dlckNhc2VMZXR0ZXJzKSkgewogICAgLy8gICAgIGxldHRlci5jbGFzc0xpc3QucmVtb3ZlKCJpbnZhbGlkIik7CiAgICAvLyAgICAgbGV0dGVyLmNsYXNzTGlzdC5hZGQoInZhbGlkIik7CiAgICAvLyAgICAgdGhpcy5hcnJheVswXSA9IDE7CiAgICAvLyAgIH0gZWxzZSB7CiAgICAvLyAgICAgbGV0dGVyLmNsYXNzTGlzdC5yZW1vdmUoInZhbGlkIik7CiAgICAvLyAgICAgbGV0dGVyLmNsYXNzTGlzdC5hZGQoImludmFsaWQiKTsKICAgIC8vICAgICB0aGlzLmFycmF5WzBdID0gMDsKICAgIC8vICAgfQoKICAgIC8vICAgLy8gVmFsaWRhdGUgY2FwaXRhbCBsZXR0ZXJzCiAgICAvLyAgIHZhciB1cHBlckNhc2VMZXR0ZXJzID0gL1tBLVpdL2c7CiAgICAvLyAgIGlmICh0aGlzLnBhc3N3b3JkLm1hdGNoKHVwcGVyQ2FzZUxldHRlcnMpKSB7CiAgICAvLyAgICAgY2FwaXRhbC5jbGFzc0xpc3QucmVtb3ZlKCJpbnZhbGlkIik7CiAgICAvLyAgICAgY2FwaXRhbC5jbGFzc0xpc3QuYWRkKCJ2YWxpZCIpOwogICAgLy8gICAgIHRoaXMuYXJyYXlbMV0gPSAxOwogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIGNhcGl0YWwuY2xhc3NMaXN0LnJlbW92ZSgidmFsaWQiKTsKICAgIC8vICAgICBjYXBpdGFsLmNsYXNzTGlzdC5hZGQoImludmFsaWQiKTsKICAgIC8vICAgICB0aGlzLmFycmF5WzFdID0gMDsKICAgIC8vICAgfQoKICAgIC8vICAgLy8gVmFsaWRhdGUgbnVtYmVycwogICAgLy8gICB2YXIgbnVtYmVycyA9IC9bMC05XS9nOwogICAgLy8gICBpZiAodGhpcy5wYXNzd29yZC5tYXRjaChudW1iZXJzKSkgewogICAgLy8gICAgIG51bWJlci5jbGFzc0xpc3QucmVtb3ZlKCJpbnZhbGlkIik7CiAgICAvLyAgICAgbnVtYmVyLmNsYXNzTGlzdC5hZGQoInZhbGlkIik7CiAgICAvLyAgICAgdGhpcy5hcnJheVsyXSA9IDE7CiAgICAvLyAgIH0gZWxzZSB7CiAgICAvLyAgICAgbnVtYmVyLmNsYXNzTGlzdC5yZW1vdmUoInZhbGlkIik7CiAgICAvLyAgICAgbnVtYmVyLmNsYXNzTGlzdC5hZGQoImludmFsaWQiKTsKICAgIC8vICAgICB0aGlzLmFycmF5WzJdID0gMDsKICAgIC8vICAgfQoKICAgIC8vICAgLy8gU3BlY2lhbCBDaGFyYWN0ZXIKICAgIC8vICAgdmFyIHNwZWNpYWxzID0gL1sjQCElKj8mJF0vZzsKICAgIC8vICAgaWYgKHRoaXMucGFzc3dvcmQubWF0Y2goc3BlY2lhbHMpKSB7CiAgICAvLyAgICAgc3BlY2lhbC5jbGFzc0xpc3QucmVtb3ZlKCJpbnZhbGlkIik7CiAgICAvLyAgICAgc3BlY2lhbC5jbGFzc0xpc3QuYWRkKCJ2YWxpZCIpOwogICAgLy8gICAgIHRoaXMuYXJyYXlbM10gPSAxOwogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIHNwZWNpYWwuY2xhc3NMaXN0LnJlbW92ZSgidmFsaWQiKTsKICAgIC8vICAgICBzcGVjaWFsLmNsYXNzTGlzdC5hZGQoImludmFsaWQiKTsKICAgIC8vICAgICB0aGlzLmFycmF5WzNdID0gMDsKICAgIC8vICAgfQogICAgLy8gICAvLyBWYWxpZGF0ZSBsZW5ndGgKICAgIC8vICAgaWYgKHRoaXMucGFzc3dvcmQubGVuZ3RoID49IDgpIHsKICAgIC8vICAgICB2YXIgbGVuZ3RoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxlbmd0aCIpOwogICAgLy8gICAgIGxlbmd0aC5jbGFzc0xpc3QucmVtb3ZlKCJpbnZhbGlkIik7CiAgICAvLyAgICAgbGVuZ3RoLmNsYXNzTGlzdC5hZGQoInZhbGlkIik7CiAgICAvLyAgICAgdGhpcy5hcnJheVs0XSA9IDE7CiAgICAvLyAgIH0gZWxzZSB7CiAgICAvLyAgICAgdmFyIGxlbmd0aCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsZW5ndGgiKTsKICAgIC8vICAgICBsZW5ndGguY2xhc3NMaXN0LnJlbW92ZSgidmFsaWQiKTsKICAgIC8vICAgICBsZW5ndGguY2xhc3NMaXN0LmFkZCgiaW52YWxpZCIpOwogICAgLy8gICAgIHRoaXMuYXJyYXlbNF0gPSAwOwogICAgLy8gICB9CiAgICAvLyAgIHZhciBzdW0gPSB0aGlzLmFycmF5WzBdICsgdGhpcy5hcnJheVsxXSArIHRoaXMuYXJyYXlbMl0gKyB0aGlzLmFycmF5WzNdICsgdGhpcy5hcnJheVs0XTsKICAgIC8vICAgaWYgKHN1bSA9PSA1IHx8IHN1bSA9PSAwKSB7CiAgICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1lc3NhZ2UiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtZXNzYWdlIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICBjbGVhcl9zZWFyY2hfbmFtZSgpIHsKICAgICAgdGhpcy5zZWFyY2hfbmFtZSA9ICIiOwogICAgfSwKICAgIGxvYWRfdXNlcigpIHsKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICB0aGlzLmVtYWlsbGlzdCA9IFtdOwogICAgICB0aGlzLnJvbGVfc2VsZWN0ZWQgPSBudWxsOwogICAgICB0aGlzLnBvcnRhbF9yb2xlcyA9IFtdOwogICAgICB0aGlzLnJvbGVzX2Ryb3B3ZG93biA9IFsKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogIlBvcnRhbCBSb2xlIiwKICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICJCb3QgUm9sZSIsCiAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICB9LAogICAgICBdOwogICAgICB0aGlzLnNlbGVjdGVkX3JvbGUgPSAiIjsKICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICBpZiAoCiAgICAgICAgIXRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55SWQiKSAmJgogICAgICAgIHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIgogICAgICApIHsKICAgICAgICB0b2FzdHIud2FybmluZygiUGxlYXNlIHNlbGVjdCBhIGNvbXBhbnkgbmFtZSBmcm9tIHRoZSBkcm9wZG93biIpOwogICAgICB9CiAgICAgIGlmICh0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucm9sZSA9PSAiU3VwZXJBZG1pbiIpIHsKICAgICAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpKSB7CiAgICAgICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55SWQiKTsKICAgICAgICAgIHRoaXMuY29tcGFueW5hbWUgPSB0aGlzLiRzZXNzaW9uLmdldCgiQ29tcGFueU5hbWUiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdG9hc3RyLndhcm5pbmcoIlBsZWFzZSBzZWxlY3QgYSBjb21wYW55IG5hbWUgZnJvbSB0aGUgZHJvcGRvd24iKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgfQogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLmxvYWRfdXNlcnNfdXJsKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGFbMV0ubnVtYmVyX29mX3Jvd3M7CiAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gTWF0aC5jZWlsKHRoaXMubnVtYmVyX29mX3Jvd3MgLyB0aGlzLnBlcl9wYWdlKTsKICAgICAgICAgIHRoaXMudXBkYXRlX3VzZXJzKHJlc3BvbnNlLmRhdGFbMF0uRW1haWwsIHJlc3BvbnNlLmRhdGFbMF0uUm9sZSk7CiAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMubWFpbl9yb2xlX3VybCgpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIGlzU2hvdzogdHJ1ZSwKICAgICAgICAgICAgcGVyX3BhZ2U6IDEwMDAsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgLy8gcG9ydGFsX3JvbGVzID0gW107CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLlBvcnRhbC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXNwb25zZS5kYXRhLlBvcnRhbC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocG9ydGFsX3JvbGVzKTsKICAgICAgICAgICAgICAgIHRoaXMucG9ydGFsX3JvbGVzLnB1c2goewogICAgICAgICAgICAgICAgICAvLyByb2xlOiBbewogICAgICAgICAgICAgICAgICAvLyAgIHJvbGVuYW1lOiByZXNwb25zZS5kYXRhLlBvcnRhbFtpXQogICAgICAgICAgICAgICAgICAvLyAgIH1dLAogICAgICAgICAgICAgICAgICByb2xlOiByZXNwb25zZS5kYXRhLlBvcnRhbFtpXSwKICAgICAgICAgICAgICAgICAgdHlwZTogIlBvcnRhbCIsCiAgICAgICAgICAgICAgICB9KTsgIAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5Cb3QubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzcG9uc2UuZGF0YS5Cb3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMucG9ydGFsX3JvbGVzLnB1c2goewogICAgICAgICAgICAgICAgICAvLyByb2xlOiBbewogICAgICAgICAgICAgICAgICAvLyAgIHJvbGVuYW1lOnJlc3BvbnNlLmRhdGEuQm90W2ldCiAgICAgICAgICAgICAgICAgIC8vIH1dLAogICAgICAgICAgICAgICAgICByb2xlOiByZXNwb25zZS5kYXRhLkJvdFtpXSwKICAgICAgICAgICAgICAgICAgdHlwZTogIkJvdCIsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gCiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wb3J0YWxfcm9sZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgIGlmICh0aGlzLnBvcnRhbF9yb2xlc1tpXS50eXBlID09PSAiUG9ydGFsIikgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLnJvbGVzX2Ryb3B3ZG93bi5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICBpZiAodGhpcy5yb2xlc19kcm9wd2Rvd25bal0udGl0bGUgPT09ICJQb3J0YWwgUm9sZSIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnJvbGVzX2Ryb3B3ZG93bltqXS5saXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5wb3J0YWxfcm9sZXNbaV0ucm9sZSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQb3J0YWwgVXNlciIsCiAgICAgICAgICAgICAgICAgICAgfSk7IAogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICh0aGlzLnBvcnRhbF9yb2xlc1tpXS50eXBlID09PSAiQm90IikgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLnJvbGVzX2Ryb3B3ZG93bi5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICBpZiAodGhpcy5yb2xlc19kcm9wd2Rvd25bal0udGl0bGUgPT09ICJCb3QgUm9sZSIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnJvbGVzX2Ryb3B3ZG93bltqXS5saXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5wb3J0YWxfcm9sZXNbaV0ucm9sZSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJCb3QgVXNlciIsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHBhZ2luYXRpb25fY2xhc3MoaW5kZXgpIHsKICAgICAgaWYgKGluZGV4ID09IHRoaXMucGFnZV9ubykgewogICAgICAgIHJldHVybiAiIGFjdGl2ZSI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICB9LAogICAgY2hlY2tfbGlzdF9hcnJheShlLCBpbmRleCkgewogICAgICBpZiAoaW5kZXggPT0gImFsbCIpIHsKICAgICAgICBpZiAoZS50YXJnZXQuY2hlY2tlZCA9PSB0cnVlKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRoaXMudXNlcnMubWFwKCh1c2VyKSA9PiB7CiAgICAgICAgICAgIHJldHVybiB1c2VyLmVtYWlsOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChlLnRhcmdldC5jaGVja2VkID09IGZhbHNlKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoZS50YXJnZXQuY2hlY2tlZCA9PSB0cnVlKSB7CiAgICAgICAgICBsZXQgdmFsX2luZGV4ID0gdGhpcy5jaGVja2VkX2xpc3QuaW5kZXhPZih0aGlzLnVzZXJzW2luZGV4XS5lbWFpbCk7CiAgICAgICAgICB2YXIgdGVtcCA9IHRoaXMudXNlcnNbaW5kZXhdLmVtYWlsOwogICAgICAgICAgaWYgKHZhbF9pbmRleCA9PSAtMSkgewogICAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdC5wdXNoKHRlbXApOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZS50YXJnZXQuY2hlY2tlZCA9PSBmYWxzZSkgewogICAgICAgICAgdmFyIHNlbGVjdGFsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNzZWxlY3RhbGwiKTsKICAgICAgICAgIHNlbGVjdGFsbC5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICBsZXQgdXNlckluZGV4ID0gdGhpcy5jaGVja2VkX2xpc3QuaW5kZXhPZih0aGlzLnVzZXJzW2luZGV4XS5lbWFpbCk7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdC5zcGxpY2UodXNlckluZGV4LCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVfdXNlcihpbmRleCkgewogICAgICB0aGlzLmVtYWlsbGlzdCA9IFtdOwogICAgICBpZiAoaW5kZXggPT0gImFsbCIpIHsKICAgICAgICBpZiAodGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoID09IDApIHsKICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgIHRpdGxlOiAiTm8gdXNlciBzZWxlY3RlZCEiLAogICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgdGltZXI6IDIwMDAsCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2hlY2tlZF9saXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBuID0gdGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMuZW1haWxsaXN0LnB1c2godGhpcy5jaGVja2VkX2xpc3RbaV0pOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5kZWxldGVfdXNlcl9hcGkoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lbWFpbGxpc3QucHVzaCh0aGlzLnVzZXJzW2luZGV4XS5lbWFpbCk7CiAgICAgICAgdGhpcy5kZWxldGVfdXNlcl9hcGkoKTsKICAgICAgfQogICAgfSwKICAgIGRlbGV0ZV91c2VyX2FwaSgpIHsKICAgICAgU3dhbC5maXJlKHsKICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgIHRleHQ6ICJZb3Ugd29uJ3QgYmUgYWJsZSB0byByZXZlcnQgdGhpcyEiLAogICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIGRlbGV0ZSBpdCEiLAogICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAvLyB0aGlzLnNwaW5uZXJPbj10cnVlOwogICAgICAgICAgaWYocmVzdWx0LmRpc21pc3MgPT09J2NhbmNlbCcpewogICAgICAgICAgICB0aGlzLmVtYWlsbGlzdCA9IFtdOwogICAgICAgICAgfWVsc2UgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgYXhpb3MKICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgYXBpX2NhbGxzLmRlbGV0ZV91c2VyX3VybCgpLAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGVtYWlsbGlzdDogdGhpcy5lbWFpbGxpc3QsCiAgICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICAgICAgdmFyIHVzZXJsaXN0ID0gW107CiAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmVtYWlsbGlzdCkgewogICAgICAgICAgICAgICAgdXNlcmxpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLmVtYWlsbGlzdFtpXS5lbWFpbCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoYXBpX2NhbGxzLnVzZXJzX2xpc3Rfc3luYygpLCB7CiAgICAgICAgICAgICAgICAgIGRlbGV0ZTogdXNlcmxpc3QsCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJRdWVyeSBFeGVjdXRlZCBTdWNjZXNzZnVsbHkiKSB7CiAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiVXNlciBoYXMgYmVlbiBkZWxldGVkIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgICAgICAgaWYoKCh0aGlzLmVtYWlsbGlzdC5sZW5ndGggPT09IDEgJiYgdGhpcy51c2Vycy5sZW5ndGggPT09IDEpIHx8CiAgICAgICAgICAgICAgICAgICh0aGlzLmVtYWlsbGlzdC5sZW5ndGggPT09IHRoaXMudXNlcnMubGVuZ3RoKSkgJiYgCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlX25vID4xKXsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHRoaXMucGFnZV9ubyAtIDE7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAgICAgICB0aGlzLmVtYWlsbGlzdCA9IFtdOwogICAgICAgICAgICAgIHRoaXMubG9hZF91c2VyKCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHBhc3N3b3JkX3RvZ2dsZShldmVudCkgewogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB2YXIgcGFzc3dvcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZm9ybV9wYXNzd29yZCIpOwogICAgICBpZiAocGFzc3dvcmQudHlwZSA9PSAidGV4dCIpIHsKICAgICAgICBwYXNzd29yZC50eXBlID0gInBhc3N3b3JkIjsKICAgICAgfSBlbHNlIGlmIChwYXNzd29yZC50eXBlID09ICJwYXNzd29yZCIpIHsKICAgICAgICBwYXNzd29yZC50eXBlID0gInRleHQiOwogICAgICB9CiAgICB9LAogICAgdXBkYXRlX3VzZXJzKG1lc3NhZ2UxLCBtZXNzYWdlMikgewogICAgICBpZiAobWVzc2FnZTEgPT0gbnVsbCB8fCBtZXNzYWdlMiA9PSBudWxsKSB7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy51c2VycyA9IFtdOwogICAgICAgIGZvciAodmFyIGkgaW4gbWVzc2FnZTEpIHsKICAgICAgICAgIHRoaXMudXNlcnMucHVzaCh7CiAgICAgICAgICAgIGVtYWlsOiBtZXNzYWdlMVtpXSwKICAgICAgICAgICAgcm9sZTogbWVzc2FnZTJbaV0sCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBwYWdlX3JlcXVpcmUocGFnZV9ubykgewogICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgIHRoaXMuZW1haWxsaXN0ID0gW107CiAgICAgIGlmIChwYWdlX25vID09IDAgfHwgcGFnZV9ubyA9PSB0aGlzLnRvdGFsX3BhZ2VzICsgMSkgewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWFyY2hfbmFtZSAhPSAiIikgewogICAgICAgIGlmIChwYWdlX25vID09ICIuLi5zIikgewogICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCgxICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSAiLi4ubCIpIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgodGhpcy50b3RhbF9wYWdlcyArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHBhZ2Vfbm87CiAgICAgICAgfQogICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICBheGlvcwogICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy5sb2FkX3VzZXJzX3VybCgpLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgaXNzZWFyY2g6IHRydWUsCiAgICAgICAgICAgICAga2V5OiB0aGlzLnNlYXJjaF9uYW1lLAogICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICkKICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS51c2VyX2xpc3QubGVuZ3RoICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIHRoaXMubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLnVzZXJfbGlzdC5sZW5ndGg7CiAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnZV9jb3VudDsKICAgICAgICAgICAgICB0aGlzLnVzZXJzID0gW107CiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm51bWJlcl9vZl9yb3dzOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMudXNlcnMucHVzaCh7CiAgICAgICAgICAgICAgICAgIGVtYWlsOiByZXNwb25zZS5kYXRhLnVzZXJfbGlzdFtpXS5FbWFpbCwKICAgICAgICAgICAgICAgICAgcm9sZTogcmVzcG9uc2UuZGF0YS51c2VyX2xpc3RbaV0uUm9sZSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlX25vOwogICAgICAgICAgICAgIHRoaXMuc2V0cGFnaW5hdGlvbih0aGlzLnBhZ2Vfbm8pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJObyBSZXN1bHRzIEZvdW5kIikgewogICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiTm8gdXNlcnMgZm91bmQiKTsKICAgICAgICAgICAgICB0aGlzLmxvYWRfdXNlcigpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJJbnRybmFsIFNlcnZlciBFcnJvciIpIHsKICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludHJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgdGhpcy5sb2FkX3VzZXIoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludHJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgdGhpcy5sb2FkX3VzZXIoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICBpZiAocGFnZV9ubyA9PSAiLi4ucyIpIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgoMSArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gIi4uLmwiKSB7CiAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKHRoaXMudG90YWxfcGFnZXMgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHBhZ2Vfbm87CiAgICAgICAgfQogICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICBheGlvcwogICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy5sb2FkX3VzZXJzX3VybCgpLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW50ZW50OiB0aGlzLm5ld19pbnRlbnRzLAogICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9CiAgICAgICAgICApCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGFbMV0ubnVtYmVyX29mX3Jvd3M7CiAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSBNYXRoLmNlaWwodGhpcy5udW1iZXJfb2Zfcm93cyAvIHRoaXMucGVyX3BhZ2UpOwogICAgICAgICAgICB0aGlzLnVwZGF0ZV91c2VycyhyZXNwb25zZS5kYXRhWzBdLkVtYWlsLCByZXNwb25zZS5kYXRhWzBdLlJvbGUpOwogICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHJvbGVfc3VibWl0X2FwaSgpIHsKICAgICAgYXhpb3MKICAgICAgICAucG9zdCgKICAgICAgICAgIGFwaV9jYWxscy5yb2xlX3VybCgpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgc3VwZXJhZG1pbmNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikKICAgICAgICAgICAgICAuY29tcGFueV9uYW1lLAogICAgICAgICAgICBzdXBlcmFkbWluY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikKICAgICAgICAgICAgICAuY29tcGFueV9pZCwKICAgICAgICAgICAgcm9sZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMucm9sZXMgPSByZXNwb25zZS5kYXRhLnJvbGVsaXN0OwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBhZGRfdXNlcigpIHsKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgaWYgKHRoaXMuZW1haWwgPT0gIiIgfHwgdGhpcy52YWxpZEVtYWlsICE9IHRydWUpIHsKICAgICAgICB0b2FzdHIuZXJyb3IoIlBsZWFzZSBFbnRlciBhIFZhbGlkIEVtYWlsIik7CiAgICAgIH0KICAgICAgLy8gZWxzZSBpZih0aGlzLnNob3dfcGFzc3dvcmRfZmllbGQmJgogICAgICAvLyAgICh0aGlzLnBhc3N3b3JkPT0iInx8dGhpcy52YWxpZFBhc3N3b3JkIT10cnVlKSkgewogICAgICAvLyAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIEVudGVyIGEgVmFsaWQgUGFzc3dvcmQiKTsKICAgICAgLy8gfQogICAgICAvLyBlbHNlIGlmKHRoaXMucG9ydGFsX3JvbGVzLnR5cGUgPT09ICJCb3QiKXsKICAgICAgLy8gICBpZiAodGhpcy5lbWFpbCA9PSAiIiB8fCB0aGlzLnZhbGlkRW1haWwgIT0gdHJ1ZSkgewogICAgICAvLyAgICAgICB0b2FzdHIuZXJyb3IoIlBsZWFzZSBFbnRlciBhIFZhbGlkIEVtYWlsIik7CiAgICAgIC8vIH0KICAgICAgLy8gfQogICAgICBlbHNlIGlmICh0aGlzLmNvcnJlY3RfcGFzc3dvcmQgPT0gZmFsc2UgJiYgdGhpcy5yb2xlX3R5cGVfc2VsZWN0ZWQgPT09ICJQb3J0YWwgVXNlciIpIHsKICAgICAgICB0b2FzdHIuZXJyb3IoIlBsZWFzZSBFbnRlciBhIFZhbGlkIFBhc3N3b3JkIik7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZF9yb2xlID09ICIiKSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgU2VsZWN0IFJvbGUgTmFtZSIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICAkKCIjdXNlcm1vZGVsIikubW9kYWwoImhpZGUiKTsKICAgICAgICB2YXIgY3VycmVudF9kYXRlID0gbmV3IERhdGUoKTsKICAgICAgICAvLyBpZih0aGlzLnJvbGVfdHlwZV9zZWxlY3RlZCA9PT0gIlBvcnRhbCBVc2VyIikKICAgICAgICBheGlvcwogICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy5hZGRfdXNlcl91cmwoKSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHJvbGU6IHRoaXMucm9sZV9zZWxlY3RlZCwKICAgICAgICAgICAgICBzdGFmZmVtYWlsOiB0aGlzLmVtYWlsLAogICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQsCiAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICBkb21haW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5kb21haW4sCiAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICBkYXRlOiBjdXJyZW50X2RhdGUsCiAgICAgICAgICAgICAgdXNlcl90eXBlOiB0aGlzLnJvbGVfdHlwZV9zZWxlY3RlZCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICkKICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICAvLyB0aGlzLnJvbGVfc2VsZWN0ZWQgPSBudWxsOwogICAgICAgICAgICB2YXIgcmVzcG9uc2VfYXBpID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlX2FwaSA9PSAiTmV3IHVzZXIgYWRkZWQiKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogIkFkZGVkIFN1Y2Nlc3NmdWxseSEhIiwKICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgIHRleHQ6CiAgICAgICAgICAgICAgICAgICJUaGUgdmVyaWZpY2F0aW9uIGxpbmsgaGFzIGJlZW4gc2VudCB0byB0aGUgcm9sZSdzIGVtYWlsIHRoYXQgeW91IGhhdmUgYWRkZWQgbm93LiBQbGVhc2UgdmVyaWZ5IGJlZm9yZSBsb2dnaW5nIGluIiwKICAgICAgICAgICAgICAgIHRpbWVyOiAzNTAwLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlX2FwaS5pbmNsdWRlcygiVGhpcyBlbWFpbCBpcyBhIGR1cGxpY2F0ZS4iKSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgIHRleHQ6CiAgICAgICAgICAgICAgICAgICJUaGlzIEVtYWlsIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC4gUGxlYXNlIHRyeSB3aXRoIGFub3RoZXIgZW1haWwiLAogICAgICAgICAgICAgICAgdGltZXI6IDMwMDAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5sb2FkX3VzZXIoKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNsZWFyX2ZpZWxkcygpIHsKICAgICAgdGhpcy5lbWFpbCA9ICIiOwogICAgICB0aGlzLnBhc3N3b3JkID0gIiI7CiAgICAgIHRoaXMuc2VsZWN0ZWRfcm9sZSA9ICIiOwogICAgfSwKICAgIGNhbGxzZWFyY2goKSB7CiAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykgewogICAgICAgIHRoaXMuc2VhcmNoX3Byb2R1Y3QoKTsKICAgICAgfQogICAgfSwKICAgIHNlYXJjaF9wcm9kdWN0KCkgewogICAgICBpZiAodGhpcy5zZWFyY2hfbmFtZSAhPSAiIikgewogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgIHRoaXMuZW1haWxsaXN0ID0gW107CiAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgIGF4aW9zCiAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgYXBpX2NhbGxzLmxvYWRfdXNlcnNfdXJsKCksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICBpc3NlYXJjaDogdHJ1ZSwKICAgICAgICAgICAgICBrZXk6IHRoaXMuc2VhcmNoX25hbWUsCiAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICkKICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YSAhPSAidG9rZW4gaW52YWxpZCIgJiYKICAgICAgICAgICAgICByZXNwb25zZS5kYXRhICE9IG51bGwgJiYKICAgICAgICAgICAgICByZXNwb25zZS5kYXRhLk1TRyAhPSAiTm8gUmVzdWx0cyBGb3VuZCIgJiYKICAgICAgICAgICAgICByZXNwb25zZS5kYXRhLk1TRyAhPSAiSW50cm5hbCBTZXJ2ZXIgRXJyb3IiICYmCiAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5NU0cgIT0gIkludHJuYWwgU2VydmVyIEVycm9yIgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS51c2VyX2xpc3QubGVuZ3RoICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEudXNlcl9saXN0Lmxlbmd0aDsKICAgICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2VfY291bnQ7CiAgICAgICAgICAgICAgICB0aGlzLnVzZXJzID0gW107CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubnVtYmVyX29mX3Jvd3M7IGkrKykgewogICAgICAgICAgICAgICAgICB0aGlzLnVzZXJzLnB1c2goewogICAgICAgICAgICAgICAgICAgIGVtYWlsOiByZXNwb25zZS5kYXRhLnVzZXJfbGlzdFtpXS5FbWFpbCwKICAgICAgICAgICAgICAgICAgICByb2xlOiByZXNwb25zZS5kYXRhLnVzZXJfbGlzdFtpXS5Sb2xlLAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IDE7CiAgICAgICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT09ICJObyBSZXN1bHRzIEZvdW5kIikgewogICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiTm8gdXNlcnMgZm91bmQiKTsKICAgICAgICAgICAgICB0aGlzLmxvYWRfdXNlcigpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJJbnRybmFsIFNlcnZlciBFcnJvciIpIHsKICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludHJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgdGhpcy5sb2FkX3VzZXIoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludHJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgdGhpcy5sb2FkX3VzZXIoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRvYXN0ci5lcnJvcigiRW50ZXIgcHJvcGVyIGRhdGEgZm9yIHNlYXJjaGluZyIpOwogICAgICB9CiAgICB9LAogICAgc2V0cGFnaW5hdGlvbihwYWdlX25vKSB7CiAgICAgIHRoaXMucGFnZV9hcnJheSA9IFtdOwogICAgICBpZiAodGhpcy50b3RhbF9wYWdlcyA8PSA3KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRvdGFsX3BhZ2VzOyBpKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSAxKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IHRoaXMudG90YWxfcGFnZXMpIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgIGZvciAobGV0IGkgPSB0aGlzLnRvdGFsX3BhZ2VzIC0gNDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwYWdlX25vIDw9IDQpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZ2Vfbm8gKyAzOyBpKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfSBlbHNlIGlmIChwYWdlX25vID49IHRoaXMudG90YWxfcGFnZXMgLSA0KSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKICAgICAgICBmb3IgKGxldCBpID0gcGFnZV9ubyAtIDQ7IGkgPCB0aGlzLnRvdGFsX3BhZ2VzOyBpKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKICAgICAgICBmb3IgKGxldCBpID0gcGFnZV9ubyAtIDM7IGkgPD0gcGFnZV9ubyArIDM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSk7CiAgICAgICAgfQogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgIH0KICAgIH0sCiAgICBzaG93X2ZpZWxkKHNlbGVjdGVkT3B0aW9uLCBpZCkgewogICAgICAvLyBjb25zb2xlLmxvZyhzZWxlY3RlZE9wdGlvbik7CiAgICAgIHRoaXMucm9sZV9zZWxlY3RlZCA9IHNlbGVjdGVkT3B0aW9uLm5hbWU7CiAgICAgIHRoaXMucm9sZV90eXBlX3NlbGVjdGVkID0gc2VsZWN0ZWRPcHRpb24udHlwZTsKICAgICAgdGhpcy5zaG93X2VtYWlsX2ZpZWxkID0gZmFsc2U7CiAgICAgIHRoaXMuc2hvd19wYXNzd29yZF9maWVsZCA9IGZhbHNlOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucG9ydGFsX3JvbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMucG9ydGFsX3JvbGVzW2ldLnJvbGUgPT09IHNlbGVjdGVkT3B0aW9uLm5hbWUpIHsKICAgICAgICAgIGlmICh0aGlzLnBvcnRhbF9yb2xlc1tpXS50eXBlID09PSAiQm90IikgewogICAgICAgICAgICB0aGlzLnNob3dfZW1haWxfZmllbGQgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBvcnRhbF9yb2xlc1tpXS50eXBlID09PSAiUG9ydGFsIikgewogICAgICAgICAgICB0aGlzLnNob3dfZW1haWxfZmllbGQgPSB0cnVlOwogICAgICAgICAgICB0aGlzLnNob3dfcGFzc3dvcmRfZmllbGQgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICB9LAogIGdldCBtZXRob2RzKCkgewogICAgcmV0dXJuIHRoaXMuX21ldGhvZHM7CiAgfSwKICBzZXQgbWV0aG9kcyh2YWx1ZSkgewogICAgdGhpcy5fbWV0aG9kcyA9IHZhbHVlOwogIH0sCn07Cg=="},null]}