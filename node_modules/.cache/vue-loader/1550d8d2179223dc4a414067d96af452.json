{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Templates/EmailTemplates.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Templates/EmailTemplates.vue","mtime":1655807120965},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFZ1ZUVkaXRvciB9IGZyb20gInZ1ZTItZWRpdG9yIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IHN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgU3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7CmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IHsgZnJlZXplX3BvcnRhbCxzaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwgfSBmcm9tICJAL3BvcnRhbC9taXhpbnMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRW1haWxUZW1wbGF0ZVBhZ2UiLAogIGNvbXBvbmVudHM6IHsKICAgIFZ1ZUVkaXRvciwKICAgIE11bHRpc2VsZWN0LAogIH0sCiAgbWl4aW5zOiBbZnJlZXplX3BvcnRhbCxzaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWxdLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwZW5jaWxfc3ZnOgogICAgICAgICcgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNS41NDYiIGhlaWdodD0iMTUuNDYxIiB2aWV3Qm94PSIwIDAgMTUuNTQ2IDE1LjQ2MSI+PGRlZnM+PHN0eWxlPi5he2ZpbGw6IzllOWU5ZTt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTc0Ny44ODggLTM1Ni43NjkpIj48cGF0aCBjbGFzcz0iYSIgZD0iTTc1OS40MTYsMzU2Ljc2OWEyLjM1OCwyLjM1OCwwLDAsMSwxLjc3Ny42NjJjLjUzNC41MTMsMS4wNzIsMS4wMjUsMS41NjcsMS41NzVhMi4zLDIuMywwLDAsMS0uMDcxLDMuMzI1Yy0yLjczNiwyLjc2LTUuNDk0LDUuNS04LjIzOCw4LjI1MWExLjM4MSwxLjM4MSwwLDAsMS0uNzU4LjI4OGMtLjcxOS4xNzQtMS40MjkuMzc5LTIuMTQ0LjU3Mi0uOTMyLjI1MS0xLjg2Mi41LTIuNzk1Ljc1MS0uNi4xNTgtLjk4OS0uMjEzLS44MzItLjgwN3EuNjg5LTIuNTk1LDEuNDA2LTUuMTgyYTEuMTY0LDEuMTY0LDAsMCwxLC4yODktLjQ4N3E0LjA5MS00LjEwNyw4LjItOC4yQTIuMjY1LDIuMjY1LDAsMCwxLDc1OS40MTYsMzU2Ljc2OVptLTEuOTg5LDIuOTU2LTYuNTQsNi41MzgsMy4wMjUsMy4wMjQsNi41MzgtNi41MzdabTQuMDIzLDIuMTY1Yy4xMTgtLjEzNS4yMjUtLjI2OS4zNDMtLjM5MmExLjEzNCwxLjEzNCwwLDAsMCwwLTEuNzM0Yy0uNDYtLjQ2Ni0uOTI2LS45MjUtMS4zODgtMS4zOWExLjE2NiwxLjE2NiwwLDAsMC0uODYxLS4zNjhjLS41NzgsMC0uODgxLjQtMS4yMTQuNzZabS0xMi4wODQsOC44NjMsMy4yLS44NjMtMi4zMzctMi4zMzFaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwKSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNODEzLjk0Miw0MjIuNmwtLjc4OS0uOCwzLjgyMS0zLjgxOS43ODQuOFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01OS42NDggLTU1Ljk0NykiLz48L2c+PC9zdmc+JywKICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgc3Bpbm5lck9uOiBmYWxzZSwKICAgICAgdGVtcGxhdGVfbmFtZTogIiIsCiAgICAgIHNhdmVfc21zOiAiIiwKICAgICAgc2F2ZV9lbWFpbDogIiIsCiAgICAgIGlzX3NtczogZmFsc2UsCiAgICAgIGlzX2VtYWlsOiB0cnVlLAogICAgICBzYXZlX3N1YmplY3Q6ICIiLAogICAgICBpc19wdWJsaXNoX2VtYWlsOiB0cnVlLAogICAgICBpc19wdWJsaXNoX3NtczogdHJ1ZSwKICAgICAgaXNfZWRpdF9zbXM6IGZhbHNlLAogICAgICBpc19lZGl0X2VtYWlsOiB0cnVlLAogICAgICB2ZXJpZmljYXRpb25fc3RhdHVzOiBudWxsLAogICAgICB0ZW1wbGF0ZWxpc3Q6IFtdLAogICAgICBjaGVja2VkX2xpc3Q6IFtdLAogICAgICBjdXN0b21Ub29sYmFyOiBbCiAgICAgICAgWyJib2xkIiwgIml0YWxpYyIsICJ1bmRlcmxpbmUiXSwKICAgICAgICBbeyBhbGlnbjogW10gfV0sCiAgICAgICAgW3sgY29sb3I6IFtdIH0sIHsgYmFja2dyb3VuZDogW10gfV0sCiAgICAgICAgW3sgbGlzdDogIm9yZGVyZWQiIH0sIHsgbGlzdDogImJ1bGxldCIgfV0sCiAgICAgICAgWyJsaW5rIl0sCiAgICAgIF0sCiAgICAgIHF1aWxsOiAiIiwKICAgICAgcXVpbGxfZWRpdDogIiIsCiAgICAgIGlzX2h0bWxfYm9keTogZmFsc2UsCiAgICAgIHNsb3RfdmFyaWFibGU6e30sCiAgICAgIGN1cnJlbnRfdGVtcGxhdGU6IFtdLAogICAgICBvbGRfdGVtcGxhdGVfbmFtZTogIiIsCiAgICAgIGlzRWRpdFRlbXBsYXRlOiBmYWxzZSwKICAgICAgbnVtYmVyX29mX3Jvd3M6IG51bGwsCiAgICAgIHRvdGFsX3BhZ2VzOiBudWxsLAogICAgICBwYWdlX25vOiAxLAogICAgICBwZXJfcGFnZTogMTAsCiAgICAgIGltYWdlX2ZpbGU6IG51bGwsCiAgICAgIGltYWdlX2ZpbGVfMjogbnVsbCwKICAgICAgaXNfaW1hZ2VfbmVlZGVkOiAibm9uZSIsCiAgICAgIGlzX2VkaXRfaW1hZ2VfbmVlZGVkOiAibm9uZSIsCiAgICAgIGVtYWlsX3N1YmplY3Q6ICIiLAogICAgICByZWdfdXJsOgogICAgICAgIC9odHRwczpcL1wvWyh3d3dcLik/YS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIoWy1hLXpBLVowLTlAOiVfXCsufiM/JlwvXC89XSopL2ksCiAgICAgIGlzX2VkaXRfcmVnX3VybDoKICAgICAgICAvaHR0cHM6XC9cL1sod3d3XC4pP2EtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKFstYS16QS1aMC05QDolX1wrLn4jPyZcL1wvPV0qKS9pLAogICAgICBpbWdfcmVkaXJlY3RfdXJsOiAiIiwKICAgICAgZWRpdF9pbWdfcmVkaXJlY3RfdXJsOiAiIiwKICAgICAgZmlsZV9sYWJlbDogIkNob29zZSBmaWxlIiwKICAgICAgZWRpdGVkX2ZpbGVfbGFiZWw6ICJDaG9vc2UgZmlsZSIsCiAgICAgIHByZXZpZXdfdGVtcGxhdGVfZGF0YTogIiIsCiAgICAgIHRlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdDogZmFsc2UsCiAgICAgIGVkaXRfdGVtcGxhdGVfbmFtZV9hbHJlYWR5X2V4aXN0OiBmYWxzZSwKICAgICAgcGFnZV9hcnJheTogW10sCiAgICAgIHNlbmRfZW1haWxfYWxsX2N1c3RvbWVyOiB0cnVlLAogICAgICBjdXN0b21lcnNfbGlzdDogW10sCiAgICAgIHNwZWNpZmljX2N1c3RvbWVyX2xpc3Q6IFtdLAogICAgICBkaXNhYmxlX2J0bl9leHBpcmVkOiBmYWxzZSwKICAgICAgZW1haWxfcmVnOgogICAgICAgIC9eKChbXjw+KClbXF1cXC4sOzpcc0BcIl0rKFwuW148PigpW1xdXFwuLDs6XHNAXCJdKykqKXwoXCIuK1wiKSlAKChcW1swLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cXSl8KChbYS16QS1aXC0wLTldK1wuKStbYS16QS1aXXsyLH0pKSQvLAogICAgfTsKICB9LAogIHByb3BzOiB7CiAgICBpc19ub3RpZmljYXRpb25fdGVtcGxhdGU6IEJvb2xlYW4sCiAgfSwKICB3YXRjaDogewogICAgLy8gaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlKCkgewogICAgLy8gICBjb25zb2xlLmxvZyh0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSk7CiAgICAvLyB9LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHZhbGlkVVJMKCkgewogICAgICBpZiAodGhpcy5yZWdfdXJsLnRlc3QodGhpcy5pbWdfcmVkaXJlY3RfdXJsKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIHZhbGlkX2VkaXRfVVJMKCkgewogICAgICBpZiAodGhpcy5pc19lZGl0X3JlZ191cmwudGVzdCh0aGlzLmVkaXRfaW1nX3JlZGlyZWN0X3VybCkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgaWYgKHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIikgewogICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55SWQiKTsKICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55TmFtZSIpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgIHRoaXMuZnJlZXplX3BvcnRhbCgpOwogICAgfSwgMTAwMCk7CiAgICAgdGhpcy4kcm9vdC4kb24oIkVtYWlsVGVtcGxhdGVQYWdlRGlzYWJsZWQiLCAoZGF0YSkgPT57CiAgICAgIGlmKGRhdGE9PT10cnVlKXsKICAgICAgICB0aGlzLmRpc2FibGVfYnRuX2V4cGlyZWQgPSB0cnVlOwogICAgICAgIHRoaXMuc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsKCk7CiAgICAgIH0KICAgIH0pCiAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICBpZiAodGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUgPT09IGZhbHNlKXsKICAgICAgdGhpcy5sb2FkX2N1c3RvbWVyX2xpc3QoKTsKICAgIH0KICAgIHZhciB2bSA9IHRoaXM7CiAgICAkKCIjc2VsZWN0YWxsIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmlzRWRpdFRlbXBsYXRlID0gZmFsc2U7CiAgICAgIHRoaXMuaXNfc21zID0gZmFsc2U7CiAgICAgIHRoaXMuaXNfZW1haWwgPSB0cnVlOwogICAgICBpZiAoJCh0aGlzKS5pcygiOmNoZWNrZWQiKSkgewogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIHRydWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHZtLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgfQogICAgfSk7CiAgICB0aGlzLmVkaXRvcigpOwogICAgaWYgKHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlID09PSB0cnVlKXsKICAgICAgdGhpcy5sb2FkX3Nsb3RfdmFyaWFibGUoKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGxvYWRfc2xvdF92YXJpYWJsZSgpewogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMuZm9ybV9hdXRvbWF0aW9uX2RpYWxvZ190cmVlKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGlzX2dldF9zbG90X3ZhcmlhYmxlOiB0cnVlLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIlN1Y2Nlc3MiKSB7CiAgICAgICAgICAgIHRoaXMuc2xvdF92YXJpYWJsZSA9IHt9OwogICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzcG9uc2UuZGF0YS5zbG90c19saXN0Lmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSByZXNwb25zZS5kYXRhLnNsb3RzX2xpc3RbaW5kZXhdOwogICAgICAgICAgICAgIHRoaXMuc2xvdF92YXJpYWJsZVtlbGVtZW50XSA9ICd7JyArIGVsZW1lbnQgKyAnfSc7CiAgICAgICAgICAgIH0KICAgICAgICAgIC8vIHRoaXMuaW5zZXJ0X3ZhcmlhYmxlKCdxdWlsbCcsIHRoaXMuc2xvdF92YXJpYWJsZSk7CiAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAvLyB0aGlzLmluc2VydF92YXJpYWJsZSgncXVpbGwnLCB0aGlzLnNsb3RfdmFyaWFibGUpOwogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIGVkaXRvcigpewogICAgICB0aGlzLnF1aWxsID0gbmV3IFF1aWxsKCIjZWRpdG9yIiwgewogICAgICAgIG1vZHVsZXM6IHsKICAgICAgICAgIHRvb2xiYXI6IFsKICAgICAgICAgICAgWyJib2xkIiwgIml0YWxpYyIsICJ1bmRlcmxpbmUiXSwKICAgICAgICAgICAgWyJsaW5rIl0sCiAgICAgICAgICAgIFt7IGFsaWduOiBbXSB9XSwKICAgICAgICAgICAgW3sgY29sb3I6IFtdIH0sIHsgYmFja2dyb3VuZDogW10gfV0sCiAgICAgICAgICAgIFt7IGxpc3Q6ICJvcmRlcmVkIiB9LCB7IGxpc3Q6ICJidWxsZXQiIH1dLAogICAgICAgICAgXSwKICAgICAgICB9LAogICAgICAgIHRoZW1lOiAic25vdyIsCiAgICAgIH0pOwogICAgICB0aGlzLnF1aWxsLm9uKCJ0ZXh0LWNoYW5nZSIsICgpID0+IHsKICAgICAgICB0aGlzLiRlbWl0KAogICAgICAgICAgImlucHV0IiwKICAgICAgICAgIHRoaXMucXVpbGwuZ2V0VGV4dCgpID8gdGhpcy5xdWlsbC5yb290LmlubmVySFRNTCA6ICIiCiAgICAgICAgKTsKICAgICAgICB0aGlzLnNhdmVfZW1haWwgPSB0aGlzLnF1aWxsLmdldFRleHQoKSA/IHRoaXMucXVpbGwucm9vdC5pbm5lckhUTUwgOiAiIjsKICAgICAgfSk7CiAgICAgIGlmKHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlKSB7CiAgICAgICAgdGhpcy5pbnNlcnRfdmFyaWFibGUoJ3F1aWxsJywgdGhpcy5zbG90X3ZhcmlhYmxlKTsKICAgICAgfQogICAgfSwKICAgIGVkaXRfZWRpdG9yKCl7CiAgICAgIHRoaXMucXVpbGxfZWRpdCA9IG5ldyBRdWlsbCgiI2VkaXRfZWRpdG9yIiwgewogICAgICBtb2R1bGVzOiB7CiAgICAgICAgdG9vbGJhcjogWwogICAgICAgICAgWyJib2xkIiwgIml0YWxpYyIsICJ1bmRlcmxpbmUiXSwKICAgICAgICAgIFsibGluayJdLAogICAgICAgICAgW3sgYWxpZ246IFtdIH1dLAogICAgICAgICAgW3sgY29sb3I6IFtdIH0sIHsgYmFja2dyb3VuZDogW10gfV0sCiAgICAgICAgICBbeyBsaXN0OiAib3JkZXJlZCIgfSwgeyBsaXN0OiAiYnVsbGV0IiB9XSwKICAgICAgICBdLAogICAgICB9LAogICAgICB0aGVtZTogInNub3ciLAogICAgfSk7CiAgICB0aGlzLnF1aWxsX2VkaXQub24oInRleHQtY2hhbmdlIiwgKCkgPT4gewogICAgICB0aGlzLiRlbWl0KAogICAgICAgICJpbnB1dCIsCiAgICAgICAgdGhpcy5xdWlsbF9lZGl0LmdldFRleHQoKSA/IHRoaXMucXVpbGxfZWRpdC5yb290LmlubmVySFRNTCA6ICIiCiAgICAgICk7CiAgICAgIHRoaXMuY3VycmVudF90ZW1wbGF0ZS5lbWFpbCA9IHRoaXMucXVpbGxfZWRpdC5nZXRUZXh0KCkgPyB0aGlzLnF1aWxsX2VkaXQucm9vdC5pbm5lckhUTUwgOiAiIjsKICAgIH0pOwogICAgdGhpcy5xdWlsbF9lZGl0LnJvb3QuaW5uZXJIVE1MID0gdGhpcy5jdXJyZW50X3RlbXBsYXRlLmVtYWlsOwogICAgdGhpcy5pbnNlcnRfdmFyaWFibGUoJ3F1aWxsX2VkaXQnLCB0aGlzLnNsb3RfdmFyaWFibGUpOwogICAgfSwKICAgIGluc2VydF92YXJpYWJsZSh2YWwsIHNsb3RfdmFyaWFibGUpewogICAgICBpZiAodGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUgPT09IHRydWUpewogICAgICAgIGNvbnN0IGRyb3BEb3duSXRlbXMgPSB7CiAgICAgICAgJ05vIHNsb3QgdmFyaWFibGUnOiAnJywKICAgICAgICB9CiAgICAgICAgY29uc3QgbXlEcm9wRG93biA9IG5ldyBRdWlsbFRvb2xiYXJEcm9wRG93bih7CiAgICAgICAgICAgIGxhYmVsOiAiSW5zZXJ0IFZhcmlhYmxlIiwKICAgICAgICAgICAgcmVtZW1iZXJTZWxlY3Rpb246IGZhbHNlLAogICAgICAgICAgICBpZDogImRyb3Bkb3duX2lkIgogICAgICAgIH0pCiAgICAgICAgaWYoT2JqZWN0LmVudHJpZXMoc2xvdF92YXJpYWJsZSkubGVuZ3RoID09PSAwICYmIHNsb3RfdmFyaWFibGUuY29uc3RydWN0b3IgPT09IE9iamVjdCl7CiAgICAgICAgICBteURyb3BEb3duLnNldEl0ZW1zKGRyb3BEb3duSXRlbXMpOwogICAgICAgIH1lbHNlIHsKICAgICAgICAgIG15RHJvcERvd24uc2V0SXRlbXMoc2xvdF92YXJpYWJsZSk7CiAgICAgICAgfQogICAgICAgIG15RHJvcERvd24ub25TZWxlY3QgPSBmdW5jdGlvbihsYWJlbCwgdmFsdWUsIHF1aWxsKSB7CiAgICAgICAgICAgIGNvbnN0IHsgaW5kZXgsIGxlbmd0aCB9ID0gcXVpbGwuc2VsZWN0aW9uLnNhdmVkUmFuZ2UKICAgICAgICAgICAgcXVpbGwuZGVsZXRlVGV4dChpbmRleCwgbGVuZ3RoKQogICAgICAgICAgICBxdWlsbC5pbnNlcnRUZXh0KGluZGV4LCB2YWx1ZSkKICAgICAgICAgICAgcXVpbGwuc2V0U2VsZWN0aW9uKGluZGV4ICsgdmFsdWUubGVuZ3RoKQogICAgICAgIH0KICAgICAgICBteURyb3BEb3duLmF0dGFjaCh0aGlzLnF1aWxsKQogICAgICAgIGlmICh2YWwgPT09ICdxdWlsbF9lZGl0Jyl7CiAgICAgICAgICBteURyb3BEb3duLmF0dGFjaCh0aGlzLnF1aWxsX2VkaXQpCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYWRkVGFnKG5ld1RhZykgewogICAgICB2YXIgdGFnX2xpc3QgPSBbXTsKICAgICAgdGFnX2xpc3QgPSBuZXdUYWcuc3BsaXQoIiwiKTsKICAgICAgaWYgKHRhZ19saXN0Lmxlbmd0aCA+IDIpIHsKICAgICAgICBzd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX2FkZF92YWxpZF90YWdfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgIHRpbWVyOiA0NTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgZW1haWwgPSB0YWdfbGlzdFswXTsKICAgICAgICB2YXIgY3VzdG9tZXJfbmFtZSA9IEJvb2xlYW4odGFnX2xpc3RbMV0pID8gdGFnX2xpc3RbMV0gOiAiICI7CiAgICAgICAgaWYgKCF0aGlzLmVtYWlsX3JlZy50ZXN0KGVtYWlsKSkgewogICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX3ZhbGlkX2VtYWlsX2FkZHJfbXNnJyksCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgIHRpbWVyOiA0NTAwLAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IHRhZyA9IHsKICAgICAgICBjdXN0b21lcl9uYW1lOiBjdXN0b21lcl9uYW1lLAogICAgICAgIGVtYWlsOiBlbWFpbCwKICAgICAgfTsKICAgICAgdGhpcy5jdXN0b21lcnNfbGlzdC5wdXNoKHRhZyk7CiAgICAgIHRoaXMuc3BlY2lmaWNfY3VzdG9tZXJfbGlzdC5wdXNoKHRhZyk7CiAgICB9LAogICAgbG9hZF9jdXN0b21lcl9saXN0KCkgewogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMuc2VuZF9vZmZlcl90b19jdXN0b21lcnMoKSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgZ2V0X2N1c3RvbWVyc19saXN0OiB0cnVlLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICB0aGlzLmN1c3RvbWVyc19saXN0ID0gcmVzcG9uc2UuZGF0YS5jdXN0b21lcnNfbGlzdDsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIGVtYWlsX3ZlcmlmaWNhdGlvbl9zdGF0dXMoKSB7CiAgICAgIGlmKCF0aGlzLmRpc2FibGVfYnRuX2V4cGlyZWQpewogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMucHJvZHVjdF9zZXR0aW5ncygpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgaXNfZW1haWxfdmVyaWZpY2F0aW9uX3N0YXR1czogdHJ1ZSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKAogICAgICAgICAgICByZXNwb25zZS5kYXRhICE9ICIiICYmCiAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEgIT0gbnVsbCAmJgogICAgICAgICAgICByZXNwb25zZS5kYXRhICE9ICJJbnRlcm5hbCBzZXJ2ZXIgRXJyb3IiCiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy52ZXJpZmljYXRpb25fc3RhdHVzID0gcmVzcG9uc2UuZGF0YS52ZXJpZmljYXRpb25fc3RhdHVzOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnZlcmlmaWNhdGlvbl9zdGF0dXMpOwogICAgICAgICAgICBpZiAodGhpcy52ZXJpZmljYXRpb25fc3RhdHVzID09ICJTdWNjZXNzIikgewogICAgICAgICAgICAgIC8vIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInB1Ymxpc2hfdGVtcGxhdGVfYnRuIikuZGlzYWJsZWQpIHsKICAgICAgICAgICAgICAkKCIjc2VuZGVtYWlsIikubW9kYWwoInNob3ciKTsKICAgICAgICAgICAgICB0aGlzLmxvYWRfY3VzdG9tZXJfbGlzdCgpOwogICAgICAgICAgICAgIC8vIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX25vdF9jb25maWdfaW5zdHJ1Y3Rpb25fbXNnJyksCiAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICB0aW1lcjogMTMwMDAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZihyZXNwb25zZS5kYXRhLk1TRyA9PSAnRU1BSUwgTk9UIEZPVU5EIE9SIE5PVCBDT05GSUdVUkVEJykgewogICAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX25vdF9jb25maWdfaW5zdHJ1Y3Rpb25fbXNnMScpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICB0aW1lcjogMTMwMDAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IAogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcih0aGlzLnRsdCgnZW1haWxfdGVtcF9ub3RfY29uZmlnX3NlcnZlcl9tc2cnKSk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICB0b2FzdHIuZXJyb3IodGhpcy50bHQoJ2VtYWlsX3RlbXBfbm90X2NvbmZpZ19lcnJvcl9vY2N1cl9tc2cnKSk7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfWVsc2V7CiAgICAgICAgdGhpcy5zaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwoKTsKICAgICAgfQogICAgfSwKICAgIHZhbGlkYXRlX3RlbXBsYXRlX25hbWUoKSB7CiAgICAgIGF4aW9zLnBvc3QoCiAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsKCksCiAgICAgICAgewogICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgIGlzX3RlbXBsYXRlX3ByZXNlbnQ6IHRydWUsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICAgIHRlbXBsYXRlX25hbWU6IHRoaXMudGVtcGxhdGVfbmFtZSwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICApCiAgICAgIC50aGVuKChyZXNwb25zZSkgPT57CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJOb3QgRXhpc3RzIikgewogICAgICAgICAgICB0aGlzLnRlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9IGZhbHNlOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVtcGxhdGVfbmFtZV9hZGRfaWQiKS5zdHlsZS5ib3JkZXIgPW51bGw7CiAgICAgICAgICAgIGlmKHRoaXMudGVtcGxhdGVfbmFtZSAhPSAiIil7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRlbXBsYXRlX25hbWVfYWRkX2lkIikuc3R5bGUuYm9yZGVyID0KICAgICAgICAgICAgICAiMXB4IHNvbGlkICMwMGYwMDAiOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJBbHJlYWR5IEV4aXN0cyIpIHsKICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSB0cnVlOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVtcGxhdGVfbmFtZV9hZGRfaWQiKS5zdHlsZS5ib3JkZXIgPQogICAgICAgICAgICAiMXB4IHNvbGlkIHJlZCI7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHZhbGlkYXRlX2VkaXRfdGVtcGxhdGVfbmFtZSgpIHsKICAgICAgYXhpb3MucG9zdCgKICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfZW1haWwoKSwKICAgICAgICB7CiAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgICAgICAgaXNfdGVtcGxhdGVfcHJlc2VudDogdHJ1ZSwKICAgICAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSwKICAgICAgICAgICAgdGVtcGxhdGVfbmFtZTogdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX25hbWUsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgKQogICAgICAudGhlbigocmVzcG9uc2UpID0+ewogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLk1TRyA9PSAiTm90IEV4aXN0cyIpIHsKICAgICAgICAgICAgdGhpcy5lZGl0X3RlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9IGZhbHNlOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdF90ZW1wbGF0ZV9uYW1lX2lkIikuc3R5bGUuYm9yZGVyID1udWxsOwogICAgICAgICAgICBpZih0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfbmFtZSAhPSAiIil7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVkaXRfdGVtcGxhdGVfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9CiAgICAgICAgICAgICAgIjFweCBzb2xpZCAjMDBmMDAwIjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLk1TRyA9PSAiQWxyZWFkeSBFeGlzdHMiKSB7CiAgICAgICAgICAgIGlmICh0aGlzLm9sZF90ZW1wbGF0ZV9uYW1lID09IHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9uYW1lKXsKICAgICAgICAgICAgICB0aGlzLmVkaXRfdGVtcGxhdGVfbmFtZV9hbHJlYWR5X2V4aXN0ID0gZmFsc2U7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVkaXRfdGVtcGxhdGVfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9bnVsbDsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgdGhpcy5lZGl0X3RlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9IHRydWU7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVkaXRfdGVtcGxhdGVfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9CiAgICAgICAgICAgICAgIjFweCBzb2xpZCByZWQiOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHByZXZpZXdfdGVtcGxhdGUoKSB7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MKICAgICAgICAucG9zdCgKICAgICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9lbWFpbCgpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGlzX3ByZXZpZXc6IHRydWUsCiAgICAgICAgICAgIHRlbXBsYXRlX2lkOiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfaWQsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIC8vIGlmIChyZXNwb25zZS5kYXRhICE9IG51bGwpIHsKICAgICAgICAgIC8vICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEucGFnZWNvdW50OwogICAgICAgICAgLy8gICB0aGlzLnRvdGFsX3BhZ2VzID0gTWF0aC5jZWlsKHRoaXMubnVtYmVyX29mX3Jvd3MgLyB0aGlzLnBlcl9wYWdlKTsKICAgICAgICAgIC8vICAgaWYgKHJlc3BvbnNlLmRhdGEgPT09ICJEQiBPUEVSQVRJT04gVU5TVUNDRVNTRlVMIikgewogICAgICAgICAgLy8gICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gW107CiAgICAgICAgICAvLyAgICAgcmV0dXJuOwogICAgICAgICAgLy8gICB9CiAgICAgICAgICAvLyAgIHRoaXMudGVtcGxhdGVsaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgLy8gICBpZiAodGhpcy50ZW1wbGF0ZWxpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgLy8gICAgIC8vIHRoaXMuY3VycmVudF90ZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVsaXN0WzBdOwogICAgICAgICAgLy8gICAgIHRoaXMuc2hvd190ZW1wbGF0ZSgwKTsKICAgICAgICAgIC8vICAgfQogICAgICAgICAgLy8gICB0aGlzLmlzRWRpdFRlbXBsYXRlID0gZmFsc2U7CiAgICAgICAgICAvLyB9CiAgICAgICAgICAvLyB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhICE9IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5wcmV2aWV3X3RlbXBsYXRlX2RhdGEgPSByZXNwb25zZS5kYXRhLlRlbXBsYXRlOwogICAgICAgICAgICAkKCIjcHJldmlld190ZW1wbGF0ZV92aXNpYmxlIikubW9kYWwoInNob3ciKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHNlbmRfZW1haWxfY29uZmlybV9wcm9tcHRfdGV4dChhbGxfY3VzdG9tZXIpIHsKICAgICAgaWYgKGFsbF9jdXN0b21lcikgewogICAgICAgIHJldHVybiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zZW5kX2J1bGtfZW1haWxfbXNnJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMudGx0KCdlbWFpbF90ZW1wX3NlbmRfc3BlY2lmaWNfY3VzdG9tZXJfbXNnJyk7CiAgICAgIH0KICAgIH0sCiAgICBzZW5kX2VtYWlsKCkgewogICAgICBpZiAoIXRoaXMuc2VuZF9lbWFpbF9hbGxfY3VzdG9tZXIpIHsKICAgICAgICBpZighQm9vbGVhbih0aGlzLnNwZWNpZmljX2N1c3RvbWVyX2xpc3QubGVuZ3RoID4gMCkpewogICAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zZWxlY3Rfb25lX2VtYWlsX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdGltZXI6IDUwMDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgICB9CiAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgdGl0bGU6dGhpcy5zZW5kX2VtYWlsX2NvbmZpcm1fcHJvbXB0X3RleHQodGhpcy5zZW5kX2VtYWlsX2FsbF9jdXN0b21lciksCiAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc3dhbF9jb25maXJtX21zZycpLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgdHlwZTond2FybmluZycsCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc3dhbF95ZXNfbXNnJyksCiAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICQoIiNzZW5kZW1haWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgICAgYXhpb3MKICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgYXBpX2NhbGxzLnNlbmRfb2ZmZXJfdG9fY3VzdG9tZXJzKCksCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICBzZW5kX2VtYWlsOiB0cnVlLAogICAgICAgICAgICAgICAgc2VuZF9lbWFpbF9hbGxfY3VzdG9tZXI6IHRoaXMuc2VuZF9lbWFpbF9hbGxfY3VzdG9tZXIsCiAgICAgICAgICAgICAgICBzcGVjaWZpY19jdXN0b21lcl9saXN0OgogICAgICAgICAgICAgICAgICB0aGlzLnNlbmRfZW1haWxfYWxsX2N1c3RvbWVyICE9IHRydWUKICAgICAgICAgICAgICAgICAgICA/IHRoaXMuc3BlY2lmaWNfY3VzdG9tZXJfbGlzdAogICAgICAgICAgICAgICAgICAgIDogW10sCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZDogdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX2lkLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09PSAiU2VuZGluZyBFbWFpbCIpIHsKICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zYXZlX3N1YmplY3QgPSAiIjsKICAgICAgICAgICAgICAgICAgLy8gJCgiI3B1Ymxpc2h0ZW1wbGF0ZW1vZGVsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc2VudF9zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMCwKICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc3dhbF9zdWNjZXNzX21zZycpLAogICAgICAgICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICAgICAgICAkKCIjc2VuZGVtYWlsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmKHJlc3BvbnNlLmRhdGEuTVNHID09PSAiUGxlYXNlIHVwZ3JhZGUgeW91ciBwbGFuIHRvIHNlbmQgZW1haWxzIikgewogICAgICAgICAgICAgICAgICAgIHN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfdXBncmFkZV9wbGFuX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjonIzMwODVkNicsCiAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc3dhbF91cGdyYWRlX25vd19tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX3N3YWxfdXBncmFkZV9sYXRlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAnI2QzMycsCiAgICAgICAgICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlID09IHRydWUpCiAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lOiAnU2V0dGluZ3MnLHBhcmFtczp7U3Vic2NyaXB0aW9uOnRydWV9fSk7ICAgICAKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfaW50ZXJuYWxfc2VydmVyX2FsZXJ0X21zZzEnKSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiAyMDAwLAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX2ludGVybmFsX3NlcnZlcl9hbGVydF9tc2cyJyksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiAyMDAwLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHNlbGVjdGVkX3RlbXBsYXRlcyh2YWx1ZSkgewogICAgICBpZih2YWx1ZSA9PSAiYWxsIil7CiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMudGVtcGxhdGVsaXN0KSB7CiAgICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QucHVzaCh0aGlzLnRlbXBsYXRlbGlzdFtpXS50ZW1wbGF0ZV9pZCk7CiAgICAgICAgICB9CiAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoOyBpKyspewogICAgICAgICAgICAkKCIjIitbaV0pLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgICAgICAgJCgiI3NlbGVjdGFsbCIpLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9ZWxzZSBpZiAoIWV2ZW50LnRhcmdldC5jaGVja2VkKXsKICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgfQoKICAgICAgfWVsc2V7CiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdC5wdXNoKHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKCFldmVudC50YXJnZXQuY2hlY2tlZCl7CiAgICAgICAgICB2YXIgc2VsZWN0YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3NlbGVjdGFsbCIpOwogICAgICAgICAgaWYgKHNlbGVjdGFsbC5jaGVja2VkKSB7CiAgICAgICAgICAgIHNlbGVjdGFsbC5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgdGVtcCA9IHRoaXMuY2hlY2tlZF9saXN0LmZpbHRlcigodGVtcGxhdGVzX2lkKSA9PiB7CiAgICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZXNfaWQgIT0gdmFsdWU7CiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gdGVtcDsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBsb2FkX3RlbXBsYXRlcygpIHsKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgaXNfZ2V0OiB0cnVlLAogICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLnBhZ2Vjb3VudDsKICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IE1hdGguY2VpbCh0aGlzLm51bWJlcl9vZl9yb3dzIC8gdGhpcy5wZXJfcGFnZSk7CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09PSAiREIgT1BFUkFUSU9OIFVOU1VDQ0VTU0ZVTCIpIHsKICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlbGlzdCA9IFtdOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnRlbXBsYXRlbGlzdCA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAvLyB0aGlzLmN1cnJlbnRfdGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlbGlzdFswXTsKICAgICAgICAgICAgICB0aGlzLnNob3dfdGVtcGxhdGUoMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBmaWxlaW5wdXQxKGUpIHsKICAgICAgbGV0IGZpbGVzID0gZS50YXJnZXQuZmlsZXMgfHwgZS5kYXRhVHJhbnNmZXIuZmlsZXM7CiAgICAgIGlmIChmaWxlc1swXS50eXBlID09PSAiaW1hZ2UvcG5nIiB8fCBmaWxlc1swXS50eXBlID09PSAiaW1hZ2UvanBlZyIpIHsKICAgICAgICBpZiAoIWZpbGVzLmxlbmd0aCkgcmV0dXJuOwogICAgICAgIHRoaXMuZmlsZV9sYWJlbCA9IGZpbGVzWzBdLm5hbWU7CiAgICAgICAgdGhpcy5jcmVhdGVJbWFnZShmaWxlc1swXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9pbWFnZV90eXBlX21zZzEnKSwKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNyZWF0ZUltYWdlKGZpbGUsIHR5cGUpIHsKICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICByZWFkZXIub25sb2FkID0gKGUpID0+IHsKICAgICAgICB0aGlzLmltYWdlX2ZpbGUgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoImJhc2U2NCwiKVsxXTsKICAgICAgfTsKICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICB9LAogICAgZmlsZWlucHV0MihlKSB7CiAgICAgIGxldCBmaWxlcyA9IGUudGFyZ2V0LmZpbGVzIHx8IGUuZGF0YVRyYW5zZmVyLmZpbGVzOwogICAgICBpZiAoZmlsZXNbMF0udHlwZSA9PT0gImltYWdlL3BuZyIgfHwgZmlsZXNbMF0udHlwZSA9PT0gImltYWdlL2pwZWciKSB7CiAgICAgICAgaWYgKCFmaWxlcy5sZW5ndGgpIHJldHVybjsKICAgICAgICB0aGlzLm9sZF9lZGl0ZWRfaW1hZ2VfbmFtZSA9IHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWw7CiAgICAgICAgdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbCA9IGZpbGVzWzBdLm5hbWU7CiAgICAgICAgdGhpcy5jcmVhdGVJbWFnZTIoZmlsZXNbMF0pOwogICAgICB9IGVsc2UgewogICAgICAgIHN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfaW1hZ2VfdHlwZV9tc2cyJyksCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVJbWFnZTIoZmlsZSwgdHlwZSkgewogICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4gewogICAgICAgIHRoaXMuaW1hZ2VfZmlsZV8yID0gZS50YXJnZXQucmVzdWx0LnNwbGl0KCJiYXNlNjQsIilbMV07CiAgICAgIH07CiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgfSwKICAgIGNyZWF0ZV9VVUlEKCkgewogICAgICB2YXIgZHQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgdmFyIHV1aWQgPSAieHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Ii5yZXBsYWNlKAogICAgICAgIC9beHldL2csCiAgICAgICAgZnVuY3Rpb24gKGMpIHsKICAgICAgICAgIHZhciByID0gKGR0ICsgTWF0aC5yYW5kb20oKSAqIDE2KSAlIDE2IHwgMDsKICAgICAgICAgIGR0ID0gTWF0aC5mbG9vcihkdCAvIDE2KTsKICAgICAgICAgIHJldHVybiAoYyA9PSAieCIgPyByIDogKHIgJiAweDMpIHwgMHg4KS50b1N0cmluZygxNik7CiAgICAgICAgfQogICAgICApOwogICAgICByZXR1cm4gdXVpZDsKICAgIH0sCiAgICBwYWdlX3JlcXVpcmUocGFnZSkgewogICAgICBpZiAocGFnZSA9PSAwIHx8IHBhZ2UgPT0gdGhpcy50b3RhbF9wYWdlcyArIDEpIHsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAocGFnZSA9PSAiLi4ucyIpIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgoMSArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICB9IGVsc2UgaWYgKHBhZ2UgPT0gIi4uLmwiKSB7CiAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKHRoaXMudG90YWxfcGFnZXMgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHBhZ2U7CiAgICAgICAgfQogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgYXhpb3MKICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfZW1haWwoKSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgIGlzX2dldDogdHJ1ZSwKICAgICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubywKICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICkKICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT09ICJEQiBPUEVSQVRJT04gVU5TVUNDRVNTRlVMIikgewogICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZWxpc3QgPSBbXTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZWxpc3QgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF90ZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVsaXN0WzBdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLmlzRWRpdFRlbXBsYXRlID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBzZXRwYWdpbmF0aW9uKHBhZ2Vfbm8pIHsKICAgICAgdGhpcy5wYWdlX2FycmF5ID0gW107CiAgICAgIGlmICh0aGlzLnRvdGFsX3BhZ2VzIDw9IDcpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IDEpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gdGhpcy50b3RhbF9wYWdlcykgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CiAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMudG90YWxfcGFnZXMgLSA0OyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPD0gNCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZV9ubyArIDM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPj0gdGhpcy50b3RhbF9wYWdlcyAtIDQpIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gNDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gMzsgaSA8PSBwYWdlX25vICsgMzsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfQogICAgfSwKICAgIHBhZ2luYXRpb25fY2xhc3MoaW5kZXgpIHsKICAgICAgaWYgKGluZGV4ID09IHRoaXMucGFnZV9ubykgewogICAgICAgIHJldHVybiAiIGFjdGl2ZSI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICB9LAogICAgc2F2ZV90ZW1wbGF0ZSgpIHsKICAgICAgaWYgKHRoaXMudGVtcGxhdGVfbmFtZSA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX3RlbXBsYXRlX25hbWVfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPT0gdHJ1ZSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX25hbWVfZXhpc3RfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5lbWFpbF9zdWJqZWN0ID09ICIiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfZW50ZXJfc3ViamVjdF9tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzX3NtcyA9PSB0cnVlICYmIHRoaXMuc2F2ZV9zbXMgPT0gIiIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9tb2RlbF9lbnRlcl9zbXNfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc19lbWFpbCA9PSB0cnVlICYmIHRoaXMuc2F2ZV9lbWFpbCA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX2VudGVyX2VtYWlsX2JvZHlfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc19lbWFpbCA9PSBmYWxzZSAmJiB0aGlzLmlzX3NtcyA9PSBmYWxzZSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX3NlbGVjdF9vcHRpb25fbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgdGhpcy5pc19pbWFnZV9uZWVkZWQgPT0gInllcyIgJiYKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5wdXRGaWxlIikudmFsdWUgPT0gIiIKICAgICAgKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfY2hvb3NlX2ltZ19tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzX2ltYWdlX25lZWRlZCA9PSAieWVzIiAmJiAhdGhpcy52YWxpZFVSTCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX3ZhbGlkX3VybF9tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5pc19odG1sX2JvZHkpIHRoaXMuaXNfaW1hZ2VfbmVlZGVkID0gJ25vbmUnOwogICAgICAgIHZhciB1dWlkID0gdGhpcy5jcmVhdGVfVVVJRCgpOwogICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ2VtYWlsX21vZGVsX3N3YWxfYWxlcnRfbXNnJyksCiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfYWRkX2N1cnJlbnRfdGVtcGxhdGVfbXNnJyksCiAgICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfc3dhbF9jb25maXJtX21zZycpLAogICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfc3VibWl0X2RldGFpbHNfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogImluZm8iLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfZW1haWwoKSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgICAgICBpc19zYXZlOiB0cnVlLAogICAgICAgICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZDogdXVpZCwKICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfbmFtZTogdGhpcy50ZW1wbGF0ZV9uYW1lLAogICAgICAgICAgICAgICAgICBzYXZlX2VtYWlsOiB0aGlzLmlzX2VtYWlsID09IHRydWUgPyB0aGlzLnNhdmVfZW1haWwgOiBudWxsLAogICAgICAgICAgICAgICAgICBzYXZlX3NtczogdGhpcy5pc19zbXMgPT0gdHJ1ZSA/IHRoaXMuc2F2ZV9zbXMgOiBudWxsLAogICAgICAgICAgICAgICAgICBlbWFpbF9zdWJqZWN0OiB0aGlzLmVtYWlsX3N1YmplY3QsCiAgICAgICAgICAgICAgICAgIGVtYWlsX2ltZ19maWxlOgogICAgICAgICAgICAgICAgICAgIHRoaXMuaXNfaW1hZ2VfbmVlZGVkID09PSAibm9uZSIgPyBudWxsIDogdGhpcy5pbWFnZV9maWxlLAogICAgICAgICAgICAgICAgICBlbWFpbF9pbWdfbmFtZTogdGhpcy5maWxlX2xhYmVsLAogICAgICAgICAgICAgICAgICBlbWFpbF9pbWdfbGluazogdGhpcy5pbWdfcmVkaXJlY3RfdXJsLAogICAgICAgICAgICAgICAgICBpc19odG1sX2JvZHk6IHRoaXMuaXNfaHRtbF9ib2R5CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIlF1ZXJ5IEV4ZWN1dGVkIFN1Y2Nlc3NmdWxseSIpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9tb2RlbF9kYXRhX2FkZGVkX3N1Y2Nlc3NmdWxfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgICAgICAgICAgICAgJCgiI3RlbXBsYXRlbW9kZWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5Nc2cgPT0gIkR1cGxpY2F0ZSBpbWFnZSIpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfaW1nX2FscmVhZHlfZm91bmRfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB0aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgICAgICAgICAgIHRoaXMubG9hZF90ZW1wbGF0ZXMoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX2Vycm9yX29jY3VyX21zZzEnKSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfZXJyb3Jfb2NjdXJfbXNnMicpLAogICAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBlZGl0X3RlbXBsYXRlKCkgewogICAgICBpZiAodGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX25hbWUgPT0gIiIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X3RlbXBsYXRlX25hbWVfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5lZGl0X3RlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9PSB0cnVlKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF9uYW1lX2FscmVhZHlfZXhpc3RfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXJyZW50X3RlbXBsYXRlLnN1YmplY3QgPT0gIiIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X2VudGVyX3N1YmplY3RfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgdGhpcy5pc19lZGl0X3NtcyA9PSB0cnVlICYmCiAgICAgICAgKHRoaXMuY3VycmVudF90ZW1wbGF0ZS5zbXMgPT0gbnVsbCB8fCB0aGlzLmN1cnJlbnRfdGVtcGxhdGUuc21zID09ICIiKQogICAgICApIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X2VudGVyX3Ntc19tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICgKICAgICAgICB0aGlzLmlzX2VkaXRfZW1haWwgPT0gdHJ1ZSAmJgogICAgICAgICh0aGlzLmN1cnJlbnRfdGVtcGxhdGUuZW1haWwgPT0gbnVsbCB8fAogICAgICAgICAgdGhpcy5jdXJyZW50X3RlbXBsYXRlLmVtYWlsID09ICIiKQogICAgICApIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X2VudGVyX2VtYWlsX2JvZHlfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc19lZGl0X2VtYWlsID09IGZhbHNlICYmIHRoaXMuaXNfZWRpdF9zbXMgPT0gZmFsc2UpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X3NlbGVjdF9vcHRpb25fbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc19lZGl0X2ltYWdlX25lZWRlZCA9PSAieWVzIiAmJiAhdGhpcy52YWxpZF9lZGl0X1VSTCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX2VkaXRfdmFsaWRfdXJsX21zZycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKAogICAgICAgIHRoaXMuaXNfZWRpdF9pbWFnZV9uZWVkZWQgPT0gInllcyIgJiYKICAgICAgICB0aGlzLmVkaXRlZF9maWxlX2xhYmVsID09ICJDaG9vc2UgZmlsZSIgJiYKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5wdXRGaWxlMiIpLnZhbHVlID09ICIiCiAgICAgICkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX2VkaXRfY2hvb3NlX2ltZ19tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5pc19odG1sX2JvZHkpIHRoaXMuaXNfZWRpdF9pbWFnZV9uZWVkZWQgPSAnbm9uZSc7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF9zdWJtaXRfZGV0YWlsc19tc2cnKSwKICAgICAgICAgIHR5cGU6ICJpbmZvIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgIH0pOwogICAgICAgIGF4aW9zCiAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsKCksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBpc19lZGl0OiB0cnVlLAogICAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICAgICAgdGVtcGxhdGVfaWQ6IHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9pZCwKICAgICAgICAgICAgICB0ZW1wbGF0ZV9uYW1lOiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfbmFtZSwKICAgICAgICAgICAgICBlbWFpbF9zdWJqZWN0OiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUuc3ViamVjdCwKICAgICAgICAgICAgICBzYXZlX2VtYWlsOgogICAgICAgICAgICAgICAgdGhpcy5pc19lZGl0X2VtYWlsID09IHRydWUgPyB0aGlzLmN1cnJlbnRfdGVtcGxhdGUuZW1haWwgOiBudWxsLAogICAgICAgICAgICAgIHNhdmVfc21zOgogICAgICAgICAgICAgICAgdGhpcy5pc19lZGl0X3NtcyA9PSB0cnVlID8gdGhpcy5jdXJyZW50X3RlbXBsYXRlLnNtcyA6IG51bGwsCiAgICAgICAgICAgICAgZW1haWxfaW1nX2ZpbGU6CiAgICAgICAgICAgICAgICB0aGlzLmlzX2VkaXRfaW1hZ2VfbmVlZGVkID09PSAibm9uZSIgPyBudWxsIDogdGhpcy5pbWFnZV9maWxlXzIsCiAgICAgICAgICAgICAgZW1haWxfaW1nX25hbWU6CiAgICAgICAgICAgICAgICB0aGlzLmlzX2VkaXRfaW1hZ2VfbmVlZGVkID09PSAibm9uZSIKICAgICAgICAgICAgICAgICAgPyBudWxsCiAgICAgICAgICAgICAgICAgIDogdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbCwKICAgICAgICAgICAgICBlbWFpbF9pbWdfbGluazoKICAgICAgICAgICAgICAgIHRoaXMuaXNfZWRpdF9pbWFnZV9uZWVkZWQgPT09ICJub25lIgogICAgICAgICAgICAgICAgICA/IG51bGwKICAgICAgICAgICAgICAgICAgOiB0aGlzLmVkaXRfaW1nX3JlZGlyZWN0X3VybCwKICAgICAgICAgICAgICBpc19pbWFnZV9lZGl0OgogICAgICAgICAgICAgICAgdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbCAhPSB0aGlzLm9sZF9lZGl0ZWRfaW1hZ2VfbmFtZQogICAgICAgICAgICAgICAgICA/IHRydWUKICAgICAgICAgICAgICAgICAgOiBmYWxzZSwKICAgICAgICAgICAgICBpc19pbWFnZV9wcmVzZW50OgogICAgICAgICAgICAgICAgdGhpcy5pc19lZGl0X2ltYWdlX25lZWRlZCA9PT0gIm5vbmUiID8gZmFsc2UgOiB0cnVlLAogICAgICAgICAgICAgIG9sZF9pbWFnZToKICAgICAgICAgICAgICAgIHRoaXMub2xkX2VkaXRlZF9pbWFnZV9uYW1lID09ICJDaG9vc2UgRmlsZSIKICAgICAgICAgICAgICAgICAgPyBudWxsCiAgICAgICAgICAgICAgICAgIDogdGhpcy5vbGRfZWRpdGVkX2ltYWdlX25hbWUsCiAgICAgICAgICAgICAgaXNfaHRtbF9ib2R5OiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUuaXNfaHRtbF9ib2R5CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9CiAgICAgICAgICApCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIlF1ZXJ5IEV4ZWN1dGVkIFN1Y2Nlc3NmdWxseSIpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X2RhdGFfZWRpdF9zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5Nc2cgPT0gIkR1cGxpY2F0ZSBpbWFnZSIpIHsKICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5wdXRGaWxlMiIpLnZhbHVlID0gIiI7CiAgICAgICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF9pbWdfYWxyZWFkeV9mb3VuZF9tc2cnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICB0aW1lcjogMzAwMCwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF9lcnJvcl9vY2N1cl9tc2cxJyksCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX2VkaXRfZXJyb3Jfb2NjdXJfbXNnMicpLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlX3NlbGVjdGVkKCkgewogICAgICBpZiAodGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoID09IDApIHsKICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdlbWFpbF90ZW1wX25vX3RlbXBsYXRlX3NlbGVjdF9tc2cnKSwKICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgIHRpbWVyOiAyMDAwLAogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc3dhbF9hbGVydF9tc2cyJyksCiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zd2FsX2RlbGV0ZV9jdXJyZW50X3RlbXBsYXRlX21zZycpLAogICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc3dhbF9jb25maXJtX21zZycpLAogICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICB0aGlzLmRlbGV0ZV90ZW1wbGF0ZXModGhpcy5jaGVja2VkX2xpc3QpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlX3RlbXBsYXRlcyhjaGVja2VkX2xpc3QpIHsKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgaXNfZGVsZXRlOiB0cnVlLAogICAgICAgICAgICB0ZW1wbGF0ZV9saXN0OiBjaGVja2VkX2xpc3QsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJEZWxldGVkIFN1Y2Nlc3NmdWxseSIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX2RhdGFfZGVsZXRlZF9tc2cnKSwKICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgICAgICAgdGhpcy5sb2FkX3RlbXBsYXRlcygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHNob3dfdGVtcGxhdGUoaW5kZXgpIHsKICAgICAgaWYgKHRoaXMuaXNFZGl0VGVtcGxhdGUpIHsKICAgICAgICB0aGlzLmVkaXRfdGVtcGxhdGVfZGV0YWlscygpOwogICAgICB9CiAgICAgIHRoaXMuY3VycmVudF90ZW1wbGF0ZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy50ZW1wbGF0ZWxpc3RbaW5kZXhdKSk7CiAgICAgIHRoaXMub2xkX3RlbXBsYXRlX25hbWUgPSB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfbmFtZTsKICAgICAgdGhpcy5jdXJyZW50X3RlbXBsYXRlX2luZGV4ID0gaW5kZXg7CiAgICAgIGlmIChCb29sZWFuKHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9pbWFnZV9uYW1lKSA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuaXNfZWRpdF9pbWFnZV9uZWVkZWQgPSAieWVzIjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzX2VkaXRfaW1hZ2VfbmVlZGVkID0gIm5vbmUiOwogICAgICB9CiAgICAgIGlmICh0aGlzLnRlbXBsYXRlbGlzdFtpbmRleF0uZW1haWwgIT0gbnVsbCkgewogICAgICAgIHRoaXMuaXNfZWRpdF9lbWFpbCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc19lZGl0X2VtYWlsID0gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0W2luZGV4XS5zbXMgIT0gbnVsbCkgewogICAgICAgIHRoaXMuaXNfZWRpdF9zbXMgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNfZWRpdF9zbXMgPSBmYWxzZTsKICAgICAgfQogICAgICBpZiAoQm9vbGVhbih0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfaW1hZ2VfbmFtZSkgPT09IHRydWUpIHsKICAgICAgICB0aGlzLmVkaXRlZF9maWxlX2xhYmVsID0gdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX2ltYWdlX25hbWU7CiAgICAgICAgdGhpcy5vbGRfZWRpdGVkX2ltYWdlX25hbWUgPSB0aGlzLmVkaXRlZF9maWxlX2xhYmVsOwogICAgICAgIHRoaXMuZWRpdF9pbWdfcmVkaXJlY3RfdXJsID0gdGhpcy5jdXJyZW50X3RlbXBsYXRlLmltYWdlX3JlZGlyZWN0X3VybDsKICAgICAgICBpZiAodGhpcy5lZGl0ZWRfZmlsZV9sYWJlbCA9PSAiIikgewogICAgICAgICAgdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbCA9ICJDaG9vc2UgZmlsZSI7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwgPSAiQ2hvb3NlIGZpbGUiOwogICAgICAgIHRoaXMub2xkX2VkaXRlZF9pbWFnZV9uYW1lID0gdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbDsKICAgICAgICB0aGlzLmVkaXRfaW1nX3JlZGlyZWN0X3VybCA9ICIiOwogICAgICB9CiAgICB9LAogICAgZW1wdHlfdmFyaWFibGUoKSB7CiAgICAgIGlmKCF0aGlzLmRpc2FibGVfYnRuX2V4cGlyZWQpewogICAgICAgIHRoaXMuc2VuZF9lbWFpbF9hbGxfY3VzdG9tZXIgPSB0cnVlOwogICAgICAgIHRoaXMucXVpbGwuc2V0VGV4dCgiIik7CiAgICAgICAgdGhpcy5jdXN0b21lcnNfbGlzdCA9IFtdOwogICAgICAgIHRoaXMuc3BlY2lmaWNfY3VzdG9tZXJfbGlzdCA9IFtdOwogICAgICAgIHRoaXMuc2F2ZV9zbXMgPSAiIjsKICAgICAgICB0aGlzLmlzX2h0bWxfYm9keSA9IGZhbHNlOwogICAgICAgIHRoaXMuc2F2ZV9lbWFpbCA9ICIiOwogICAgICAgIHRoaXMudGVtcGxhdGVfbmFtZSA9ICIiOwogICAgICAgIHRoaXMub2xkX3RlbXBsYXRlX25hbWUgPSAiIjsKICAgICAgICB0aGlzLmlzX2VtYWlsID0gdHJ1ZTsKICAgICAgICB0aGlzLmlzX3NtcyA9IGZhbHNlOwogICAgICAgIHRoaXMuc2F2ZV9zdWJqZWN0ID0gIiI7CiAgICAgICAgdGhpcy5pc19wdWJsaXNoX2VtYWlsID0gdHJ1ZTsKICAgICAgICB0aGlzLnZlcmlmaWNhdGlvbl9zdGF0dXMgPSBudWxsOwogICAgICAgIHRoaXMuZmlsZV9sYWJlbCA9ICJDaG9vc2UgZmlsZSI7CiAgICAgICAgdGhpcy5pbWdfcmVkaXJlY3RfdXJsID0gIiI7CiAgICAgICAgdGhpcy5lbWFpbF9zdWJqZWN0ID0gIiI7CiAgICAgICAgdGhpcy5pc19pbWFnZV9uZWVkZWQgPSAibm9uZSI7CiAgICAgICAgdGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSBmYWxzZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVtcGxhdGVfbmFtZV9hZGRfaWQiKS5zdHlsZS5ib3JkZXIgPSBudWxsOwogICAgICB9ZWxzZSB7CiAgICAgICAgdGhpcy5zaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwoKTsKICAgICAgfQogICAgCiAgICB9LAogICAgZWRpdF90ZW1wbGF0ZV9kZXRhaWxzKCkgewogICAgICBpZiAoIXRoaXMuaXNFZGl0VGVtcGxhdGUpIHsKICAgICAgICB0aGlzLmlzRWRpdFRlbXBsYXRlID0gdHJ1ZTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHRoaXMuZWRpdF9lZGl0b3IoKTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZighdGhpcy5jdXJyZW50X3RlbXBsYXRlLmlzX2h0bWxfYm9keSl7CiAgICAgICAgICB2YXIgZWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdF9lZGl0b3JfdGVtcCcpOwogICAgICAgICAgZWxlbWVudHMucmVtb3ZlQ2hpbGQoZWxlbWVudHMuZmlyc3RFbGVtZW50Q2hpbGQpCiAgICAgICAgfQogICAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSBmYWxzZTsKICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgdGhpcy5lZGl0X3RlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgY2hhbmdlX2JvZHlfZm9ybWF0KCl7CiAgICAgICAgaWYoIXRoaXMuaXNfaHRtbF9ib2R5KSB7CiAgICAgICAgICB0aGlzLmlzX2h0bWxfYm9keSA9IHRydWU7CiAgICAgICAgICB0aGlzLnNhdmVfZW1haWwgPSAiIjsKICAgICAgICAgIC8vIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdG9yIik7CiAgICAgICAgICAvLyBlbGVtZW50LnJlbW92ZSgpOwogICAgICAgIH1lbHNlIHsKICAgICAgICAgIHRoaXMuaXNfaHRtbF9ib2R5ID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnNhdmVfZW1haWwgPSAiIjsKICAgICAgICAgIGNvbnNvbGUubG9nKCJjb21pbmcgaGVyZSIpOyAKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5lZGl0b3IoKTsKICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICB9CiAgICAgIC8vIH0sIDEwMDApOwogICAgfSwKICAgIGNoZWNrX2N1cnJlbnRfdGVtcGxhdGVfYWN0aXZlKGluZGV4KSB7CiAgICAgIC8vIGNvbnNvbGUudGFibGUoaW5kZXgsIHRoaXMudGVtcGxhdGVsaXN0W2luZGV4XSwgdGhpcy5jdXJyZW50X3RlbXBsYXRlKTsKICAgICAgaWYgKEJvb2xlYW4odGhpcy50ZW1wbGF0ZWxpc3RbaW5kZXhdKSA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybiB0aGlzLnRlbXBsYXRlbGlzdFtpbmRleF0udGVtcGxhdGVfbmFtZSA9PT0KICAgICAgICAgIHRoaXMub2xkX3RlbXBsYXRlX25hbWUKICAgICAgICAgID8gImN1cnJlbnQtYWN0aXZlLXRlbXBsYXRlIgogICAgICAgICAgOiBudWxsOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["EmailTemplates.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAy0BA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EmailTemplates.vue","sourceRoot":"src/portal/Chatbot/Dashboard/Templates","sourcesContent":["<template>\n  <div>\n    <div class=\"spinner\" id=\"spinner\" v-show=\"spinnerOn\"></div>\n    <div class=\"container-fluid p-0\" id=\"email_page\">\n      <div class=\"card dash-card\" style=\"border: 0\">\n        <div class=\"card dash-card\">\n          <div\n            class=\"\n              card-header\n              d-block d-sm-flex\n              flex-wrap\n              justify-content-between\n            \"\n          >\n            <div class=\"card-act ml-auto d-flex flex-wrap\">\n              <a\n                id=\"send_email_btn\"\n                href=\"#\"\n                class=\"darkblue-btn\"\n                data-toggle=\"modal\"\n                data-target=\"\"\n                title=\"Send Email\"\n                v-if=\"templatelist.length > 0 && is_notification_template === false\"\n                @click=\"email_verification_status()\"\n              >\n                {{tlt('mailer_page_send_email_btn')}}\n              </a>\n              <a\n                id=\"add_template_btn\"\n                href=\"#\"\n                class=\"darkblue-btn\"\n                v-if=\"disable_btn_expired\"\n                title=\"Add new Template\"\n                @click=\"empty_variable\"\n              >\n                {{tlt('mailer_page_add_template_btn_expired')}}\n              </a>\n              <a\n                id=\"add_template_btn\"\n                href=\"#\"\n                v-else\n                class=\"darkblue-btn\"\n                data-toggle=\"modal\"\n                data-target=\"#templatemodel\"\n                title=\"Add new Template\"\n                @click=\"empty_variable\"\n              >\n                {{tlt('mailer_page_add_template_btn')}}\n              </a>\n              <a\n                href=\"javascript:void(0)\"\n                class=\"red-btn\"\n                @click=\"delete_selected\"\n                id=\"delete_intent\"\n              >\n                {{tlt('mailer_page_delete_btn')}}\n              </a>\n            </div>\n          </div>\n\n          <div\n            class=\"modal fade\"\n            id=\"preview_template_visible\"\n            role=\"dialog\"\n            aria-labelledby=\"preview_template_visible\"\n            aria-hidden=\"true\"\n          >\n            <div\n              class=\"modal-dialog modal-dialog-centered modal-lg\"\n              role=\"document\"\n            >\n              <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                  <h5 class=\"modal-title\">\n                    {{tlt('template_email_review_text')}}\n                  </h5>\n                  <button\n                    type=\"button\"\n                    class=\"close\"\n                    data-dismiss=\"modal\"\n                    aria-label=\"Close\"\n                  >\n                    <img src=\"/img/close-icn.png\" alt />\n                  </button>\n                </div>\n                <div class=\"modal-body\">\n                  <div v-html=\"preview_template_data\"></div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-body py-0\" id=\"page\">\n            <div class=\"col-sm-12 d-flex px-0\" v-if=\"templatelist.length > 0\">\n              <div class=\"col-sm-4 pl-0\" style=\"height: 80vh; overflow-y: auto\">\n                <div class=\"table-box\">\n                  <div class=\"table-responsive\">\n                    <table class=\"table\" style=\"overflow-y: auto\">\n                      <thead>\n                        <!-- <tr> -->\n                        <th scope=\"col\">\n                          <div class=\"form-check checkbox checkbox-success\">\n                            <label class=\"form-check-label\">\n                              <input\n                                class=\"form-check-input\"\n                                id=\"selectall\"\n                                type=\"checkbox\"\n                                @change=\"selected_templates('all')\"\n                              />\n                              <span class=\"icn\"></span>\n                            </label>\n                          </div>\n                        </th>\n                        <th\n                          scope=\"col\"\n                          class=\"text-left\"\n                          style=\"\n                            font: normal normal normal 16px/22px Roboto;\n                            letter-spacing: 0px;\n                            color: #414141;\n                          \"\n                        >\n                          {{tlt('template_header')}}\n                        </th>\n                        <!-- </tr> -->\n                      </thead>\n                      <tbody>\n                        <tr\n                          v-for=\"(template, index) in templatelist\"\n                          :key=\"index\"\n                          :class=\"check_current_template_active(index)\"\n                        >\n                          <td scope=\"col\">\n                            <div class=\"form-check checkbox checkbox-success\">\n                              <label class=\"form-check-label\">\n                                <input\n                                  class=\"form-check-input\"\n                                  type=\"checkbox\"\n                                  :id='index'\n                                  @change=\"\n                                    selected_templates(template.template_id)\n                                  \"\n                                />\n                                <span class=\"icn\"></span>\n                              </label>\n                            </div>\n                          </td>\n                          <td\n                            style=\"cursor: pointer\"\n                            @click=\"show_template(index)\"\n                            :title=\"template.template_name\"\n                          >\n                            <template>\n                              <p style=\"margin-bottom: 0\">\n                                {{ template.template_name }}\n                              </p>\n                            </template>\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              </div>\n              <div\n                class=\"col-sm-8 pr-0\"\n                style=\"overflow-y: auto\"\n                v-if=\"templatelist.length > 0\"\n              >\n                <div style=\"border: 1px solid #dbe2e8\">\n                  <div class=\"col-sm-12\">\n                    <div style=\"color: #414141\" class=\"\">\n                      <h5 class=\"mb-0 pt-2 d-flex\">\n                        <span class=\"mt-2 mb-0\">{{tlt('template_details_header')}}</span>\n                        <a\n                          class=\"ml-auto mt-2 mb-0\"\n                          href=\"javascript:void(0)\"\n                          title=\"Click Here for Preview\"\n                          style=\"color: rgb(39, 54, 121)\"\n                          @click=\"preview_template\"\n                          data-toggle=\"modal\"\n                        >\n                          <p\n                            class=\"labe1\"\n                            style=\"margin-right: 1rem; font-size: 1.25rem\"\n                          >\n                            {{tlt('mailer_page_preview_btn')}}\n                          </p></a\n                        >\n                        <span\n                          @click=\"edit_template_details\"\n                          v-html=\"pencil_svg\"\n                          class=\"mr-2 mt-2\"\n                          style=\"cursor: pointer\"\n                        ></span>\n                      </h5>\n                    </div>\n                  </div>\n                  <hr style=\"margin-top: 0\" />\n                  <div class=\"col-sm-12\" style=\"margin-bottom: 1rem\">\n                    <h5>\n                      <p class=\"mt-2 mb-0\" style=\"color: #414141\">\n                        {{tlt('template_name_label')}}\n                      </p>\n                    </h5>\n                    <div v-if=\"!isEditTemplate\" style=\"padding-left: 20px\">\n                      <p>{{ current_template.template_name }}</p>\n                    </div>\n                    <div v-else>\n                      <input\n                        id=\"edit_template_name_id\"\n                        type=\"text\"\n                        v-model.trim=\"current_template.template_name\"\n                        v-on:keyup=\"validate_edit_template_name\"                    \n                        class=\"form-control\"\n                        style=\"padding: 0.375rem 0.75rem\"\n                        placeholder=\"Enter Template Name\"\n                      />\n                      <span\n                        v-show=\"edit_template_name_already_exist\"\n                        style=\"color: red\"\n                        >A Template with this name already exists.</span\n                      >\n                    </div>\n                  </div>\n                  <div class=\"col-sm-12\" style=\"margin-bottom: 1rem\">\n                    <h5>\n                      <p class=\"mt-2 mb-0\" style=\"color: #414141\">\n                        {{tlt('email_subject_label')}}\n                      </p>\n                    </h5>\n                    <div v-if=\"!isEditTemplate\" style=\"padding-left: 20px\">\n                      <p>{{ current_template.subject }}</p>\n                    </div>\n                    <div v-else>\n                      <input\n                        type=\"text\"\n                        v-model.trim=\"current_template.subject\"\n                        class=\"form-control\"\n                        style=\"padding: 0.375rem 0.75rem\"\n                        placeholder=\"Enter Template Name\"\n                      />\n                    </div>\n                  </div>\n                  <div\n                    v-if=\"!isEditTemplate && current_template.email != null\"\n                    class=\"col-sm-12\"\n                    style=\"margin-bottom: 1rem\"\n                  >\n                    <h5>\n                      <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('email_body_label')}}</p>\n                    </h5>\n                    <div style=\"padding-left: 20px\">\n                      <span v-html=\"current_template.email\"></span>\n                    </div>\n                  </div>\n                  <div\n                    v-else-if=\"is_edit_email && isEditTemplate\"\n                    class=\"col-sm-12\"\n                    style=\"margin-bottom: 1rem\"\n                  >\n                    <h5>\n                      <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('email_body_label')}}</p>\n                    </h5>\n                    <!-- <div>\n                      <vue-editor\n                        v-model=\"current_template.email\"\n                        :editorToolbar=\"customToolbar\"\n                      ></vue-editor>\n                    </div> -->\n                    <div id=\"edit_editor_temp\" v-if=\"!Boolean(current_template.is_html_body)\" class=\"form-group\">\n                      <div id=\"edit_editor\"></div>\n                    </div>\n                    <div v-if=\"current_template.is_html_body\">\n                      <textarea name=\"\" v-model=\"current_template.email\" id=\"\" rows=\"8\" style=\"width: 100%;\"></textarea>\n                    </div>\n                  </div>\n                  <div\n                    v-if=\"\n                      !isEditTemplate &&\n                      Boolean(current_template.template_image_name) === true &&\n                      Boolean(current_template.image_redirect_url) === true\n                    \"\n                    class=\"col-sm-12\"\n                    style=\"margin-bottom: 1rem\"\n                  >\n                    <h5>\n                      <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('image_name_label')}}</p>\n                    </h5>\n                    <div style=\"padding-left: 20px\">\n                      <p>{{ current_template.template_image_name }}</p>\n                    </div>\n                    <h5>\n                      <p class=\"mt-2 mb-0\" style=\"color: #414141\">\n                        {{tlt('image_redirect_label')}}\n                      </p>\n                    </h5>\n                    <p>\n                      {{tlt('redirected_link_text')}}\n                    </p>\n                    <div style=\"padding-left: 20px\">\n                      <p>{{ current_template.image_redirect_url }}</p>\n                    </div>\n                  </div>\n                  <div\n                    v-else-if=\"isEditTemplate && !Boolean(current_template.is_html_body)\"\n                    class=\"col-sm-12\"\n                    style=\"margin-bottom: 1rem\"\n                  >\n                    <h5>\n                      {{tlt('add_img_in_email_label')}}<label\n                        style=\"\n                          font-size: 17px;\n                          font-weight: 400;\n                          padding-left: 0.3rem;\n                        \"\n                      >\n                        {{tlt('image_desc_label')}}\n                      </label>\n                    </h5>\n\n                    <div style=\"display: flex; margin: 1%\">\n                      <div class=\"radio\">\n                        <label style=\"vertical-align: text-top\">\n                          <input\n                            type=\"radio\"\n                            value=\"yes\"\n                            name=\"is_edit_image_needed\"\n                            v-model=\"is_edit_image_needed\"\n                          />\n                          <span class=\"icn\" id=\"radio\"></span>\n                          {{tlt('img_in_email_yes_label')}}\n                        </label>\n                      </div>\n                      <div class=\"radio\" style=\"margin-left: 2%\">\n                        <label style=\"vertical-align: text-top\">\n                          <input\n                            type=\"radio\"\n                            value=\"none\"\n                            name=\"is_edit_image_needed\"\n                            v-model=\"is_edit_image_needed\"\n                          />\n                          <span class=\"icn\" id=\"radio\"></span>\n                          {{tlt('img_in_email_no_label')}}\n                        </label>\n                      </div>\n                    </div>\n                    <div\n                      class=\"custom-file\"\n                      v-if=\"is_edit_image_needed == 'yes'\"\n                      style=\"margin-bottom: 1rem\"\n                    >\n                      <input\n                        type=\"file\"\n                        class=\"custom-file-input\"\n                        @change=\"fileinput2\"\n                        id=\"inputFile2\"\n                      />\n                      <label\n                        style=\"\n                          font-weight: 400;\n                          line-height: 10px;\n                          padding-left: 15px;\n                        \"\n                        class=\"custom-file-label form-control\"\n                        for=\"file\"\n                        >{{ edited_file_label }}</label\n                      >\n                    </div>\n                    <div v-if=\"is_edit_image_needed == 'yes'\">\n                      <h5>{{tlt('image_redirect_url_label')}}</h5>\n                      <label>\n                        {{tlt('redirected_url_link_text')}}\n                      </label>\n                      <input\n                        type=\"text\"\n                        v-model=\"edit_img_redirect_url\"\n                        class=\"form-control\"\n                        style=\"padding: 0.375rem 0.75rem\"\n                        placeholder=\"(e.g, https://cense.ai)\"\n                      />\n                    </div>\n                  </div>\n\n                  <div\n                    v-if=\"!isEditTemplate && current_template.sms != null\"\n                    class=\"col-sm-12\"\n                    style=\"margin-bottom: 1rem\"\n                  >\n                    <h5>\n                      <p class=\"mt-2 mb-0\" style=\"color: #414141\">SMS</p>\n                    </h5>\n                    <div style=\"padding-left: 20px\">\n                      <p>{{ current_template.sms }}</p>\n                    </div>\n                  </div>\n                  <div\n                    v-else-if=\"is_edit_sms && isEditTemplate\"\n                    class=\"col-sm-12\"\n                    style=\"margin-bottom: 1rem\"\n                  >\n                    <h5>\n                      <p class=\"mt-2 mb-0\" style=\"color: #414141\">SMS</p>\n                    </h5>\n                    <div>\n                      <textarea\n                        maxlength=\"160\"\n                        class=\"form-control\"\n                        style=\"padding: 0.375rem 0.75rem\"\n                        v-model=\"current_template.sms\"\n                        id=\"exampleFormControlTextarea1\"\n                        rows=\"3\"\n                      >\n                      </textarea>\n                    </div>\n                  </div>\n                  <div class=\"modal-footer\" v-if=\"isEditTemplate\">\n                    <div class=\"dash-modal\">\n                      <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n                        <button\n                          type=\"button\"\n                          class=\"btn btn-link\"\n                          style=\"border-radius: 0\"\n                          data-dismiss=\"modal\"\n                          @click=\"edit_template_details\"\n                        >\n                          {{tlt('product_config_mailer_cancel_btn')}}\n                        </button>\n                        <button\n                          type=\"submit\"\n                          class=\"darkblue-btn\"\n                          id=\"res_n_int_save\"\n                          @click=\"edit_template()\"\n                        >\n                          {{tlt('product_config_mailer_save_btn')}}\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class=\"col-sm-12 d-flex px-0 py-5\" v-else-if=\"!spinnerOn\">\n              <h4 class=\"mx-auto\">\n                {{tlt('no_template_data_text')}}\n              </h4>\n            </div>\n            <div class=\"pagin-table pb-3\" style=\"margin-top: 2%\">\n              <nav aria-label=\"Page navigation example\">\n                <ul class=\"pagination justify-content-center\">\n                  <li class=\"page-item\">\n                    <a\n                      class=\"page-link\"\n                      href=\"#\"\n                      @click=\"page_require(page_no - 1)\"\n                    >\n                      <svg\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        width=\"8.667\"\n                        height=\"15.204\"\n                        viewBox=\"0 0 8.667 15.204\"\n                      >\n                        <g\n                          id=\"arrow-point-to-left\"\n                          transform=\"translate(105.806 15.204) rotate(180)\"\n                        >\n                          <path\n                            id=\"Path_1136\"\n                            data-name=\"Path 1136\"\n                            d=\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\"\n                            transform=\"translate(0 0)\"\n                            fill=\"#9499ae\"\n                          />\n                        </g>\n                      </svg>\n                    </a>\n                  </li>\n                  <li\n                    :class=\"'page-item ' + pagination_class(pageno)\"\n                    v-for=\"pageno in page_array\"\n                    :key=\"pageno\"\n                  >\n                    <a\n                      v-if=\"pageno == '...s' || pageno == '...l'\"\n                      class=\"page-link\"\n                      href=\"#\"\n                      @click=\"page_require(pageno)\"\n                      >...</a\n                    >\n                    <a\n                      v-if=\"pageno != '...s' && pageno != '...l'\"\n                      class=\"page-link\"\n                      href=\"#\"\n                      @click=\"page_require(pageno)\"\n                      >{{ pageno }}</a\n                    >\n                  </li>\n                  <li class=\"page-item\">\n                    <a\n                      class=\"page-link\"\n                      href=\"#\"\n                      @click=\"page_require(page_no + 1)\"\n                    >\n                      <svg\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        width=\"8.667\"\n                        height=\"15.204\"\n                        viewBox=\"0 0 8.667 15.204\"\n                      >\n                        <g\n                          id=\"arrow-point-to-right\"\n                          transform=\"translate(-97.139 0)\"\n                        >\n                          <path\n                            id=\"Path_1136\"\n                            data-name=\"Path 1136\"\n                            d=\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\"\n                            transform=\"translate(0 0)\"\n                            fill=\"#9499ae\"\n                          />\n                        </g>\n                      </svg>\n                    </a>\n                  </li>\n                </ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      id=\"sendemail\"\n      class=\"modal fade dash-modal\"\n      role=\"dialog\"\n      data-backdrop=\"static\"\n      data-keyboard=\"false\"\n    >\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-body\">\n            <div class=\"modal-head d-flex align-items-center\">\n              <div class=\"head-icn\">\n                <img src=\"/img/msg-blue.png\" alt />\n              </div>\n              <h3>{{tlt('email_model_sender_email_header')}}</h3>\n              <button\n                type=\"button\"\n                class=\"close close_btn\"\n                @click=\"empty_variable\"\n                data-dismiss=\"modal\"\n              >\n                <img src=\"/img/close-icn.png\" alt />\n              </button>\n            </div>\n            <div class=\"form-group\">\n              <h5>\n                <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('email_model_template_name_header')}}</p>\n              </h5>\n              <div style=\"padding-left: 20px\">\n                <p>{{ current_template.template_name }}</p>\n              </div>\n            </div>\n            <div class=\"form-group\">\n              <div class=\"d-flex\">\n                <h5>\n                  <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('email_model_send_email_header')}}</p>\n                </h5>\n                <span\n                  v-if=\"!send_email_all_customer\"\n                  style=\"\n                    margin-left: 12px;\n                    margin-top: 10px !important;\n                    color: #0645ad;\n                  \"\n                >\n                  <i\n                    class=\"fa fa-info-circle\"\n                    aria-hidden=\"true\"\n                    style=\"font-size: 16px\"\n                    title=\"you can also specify name while adding new email in this way (john.d@mail.com,John Doe), note this would only work in the case where you add new email.\"\n                  >\n                  </i>\n                </span>\n              </div>\n              <div class=\"radio my-auto\" style=\"padding-left: 20px\">\n                <label>\n                  <input\n                    type=\"radio\"\n                    v-model=\"send_email_all_customer\"\n                    :value=\"true\"\n                    id=\"send_email_all_customer_true_id\"\n                  />\n                  <span class=\"icn\" id=\"filter_portal_user_radio\"></span>\n                  {{tlt('email_model_all_customer_label')}}\n                </label>\n                <label>\n                  <input\n                    type=\"radio\"\n                    v-model=\"send_email_all_customer\"\n                    :value=\"false\"\n                    id=\"send_email_all_customer_false_id\"\n                  />\n                  <span class=\"icn\"></span>\n                  {{tlt('email_model_specific_customer_label')}}\n                </label>\n              </div>\n            </div>\n            <div class=\"form-group\" v-if=\"!send_email_all_customer\">\n              <multiselect\n                v-model=\"specific_customer_list\"\n                :options=\"customers_list\"\n                id=\"specific_customer_list_id\"\n                :searchable=\"true\"\n                :close-on-select=\"false\"\n                :multiple=\"true\"\n                :taggable=\"true\"\n                tag-position=\"top\"\n                tag-placeholder=\"Add this as new email\"\n                placeholder=\"Search customer email or type in to add a new email\"\n                :max-height=\"400\"\n                label=\"email\"\n                track-by=\"email\"\n                open-direction=\"below\"\n                @tag=\"addTag\"\n              >\n                <!-- <span>{{ selected_role }}</span> -->\n              </multiselect>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n              <button\n                type=\"button\"\n                class=\"btn btn-link\"\n                data-dismiss=\"modal\"\n                @click=\"empty_variable\"\n              >\n                {{tlt('template_model_cancel_btn')}}\n              </button>\n              <button\n                type=\"submit\"\n                class=\"darkblue-btn\"\n                id=\"res_n_int_save\"\n                @click=\"send_email()\"\n              >\n                Send\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      id=\"templatemodel\"\n      class=\"modal fade dash-modal\"\n      role=\"dialog\"\n      data-backdrop=\"static\"\n      data-keyboard=\"false\"\n    >\n      <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n          <div class=\"modal-body\">\n            <div class=\"modal-head d-flex align-items-center\">\n              <div class=\"head-icn\">\n                <img src=\"/img/msg-blue.png\" alt />\n              </div>\n              <h3>{{tlt('template_model_header')}}</h3>\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\">\n                <img src=\"/img/close-icn.png\" alt />\n              </button>\n            </div>\n            <div class=\"form-group\">\n              <label>{{tlt('template_model_name_label')}}</label>\n              <input\n                id=\"template_name_add_id\"\n                type=\"text\"\n                v-on:keyup=\"validate_template_name\"\n                v-model.trim=\"template_name\"\n                class=\"form-control\"\n                placeholder=\"Enter Template Name\"\n              />\n              <span v-show=\"template_name_already_exist\" style=\"color: red\"\n                >{{tlt('template_model_name_text')}}</span\n              >\n            </div>\n            <div class=\"form-group\">\n              <label>{{tlt('template_model_email_sub_label')}}</label>\n              <input\n                type=\"text\"\n                v-model=\"email_subject\"\n                class=\"form-control\"\n                placeholder=\"Enter Email Subject\"\n              />\n            </div>\n            <div class=\"form-group\" v-show=\"is_email\">\n              <div class=\"d-flex\">\n                <label\n                  style=\"\n                    margin-top: 2px !important;\n                    margin-bottom: 7px !important;\n                  \"\n                  >{{tlt('template_model_email_body_label')}}</label\n                >\n                <span\n                  style=\"\n                    margin-left: 12px;\n                    margin-bottom: 5px !important;\n                    color: #0645ad;\n                  \"\n                >\n                  <i\n                    class=\"fa fa-info-circle\"\n                    aria-hidden=\"true\"\n                    style=\"font-size: 16px\"\n                    title=\"To Display customer full name in email body use {full_name} and for customer first name use {first_name}. (Example Hi {full_name} would display Hi FirstName LastName).\"\n                  >\n                  </i>\n                </span>\n                 <label\n                  class=\"ml-auto\"\n                  style=\"\n                    margin-top: 2px !important;\n                    margin-right: 10px;\n                    margin-bottom: 7px !important;\n                  \"\n                  >{{tlt('html_body_label')}}</label\n                >\n                <label class=\"switch col-sm-1\" style=\"margin-top:0px;\">\n                  <input\n                    type=\"checkbox\"\n                    @click=\"change_body_format\"\n                    v-model=\"is_html_body\"\n                    id=\"is_display_banner_on_landing_id\"\n                  />\n                  <span\n                    class=\"slider round\"\n                    style=\"border-radius: 50px;\"\n                  ></span>\n                </label>\n              </div>\n              <!-- <vue-editor\n                v-model=\"save_email\"\n                :editorToolbar=\"customToolbar\"\n              ></vue-editor> -->\n              <div v-if=\"!is_html_body\" class=\"form-group\">\n                <div id=\"editor\"></div>\n              </div>\n              <div v-if=\"is_html_body\">\n                <textarea name=\"\" v-model=\"save_email\" id=\"\" rows=\"8\" style=\"width: 100%;\"></textarea>\n              </div>\n            </div>\n            <div v-if=\"!is_html_body\" class=\"form-group\">\n              <label>{{tlt('template_model_add_img_label')}}</label>\n              <label style=\"padding-left: 0.3rem\">\n                {{tlt('template_model_add_img_text')}}\n              </label>\n              <div style=\"display: flex; margin: 1%\">\n                <div class=\"radio\">\n                  <label style=\"vertical-align: text-top\">\n                    <input\n                      type=\"radio\"\n                      value=\"yes\"\n                      name=\"is_image_needed\"\n                      v-model=\"is_image_needed\"\n                    />\n                    <span class=\"icn\" id=\"radio\"></span>\n                    Yes\n                  </label>\n                </div>\n                <div class=\"radio\" style=\"margin-left: 2%\">\n                  <label style=\"vertical-align: text-top\">\n                    <input\n                      type=\"radio\"\n                      value=\"none\"\n                      name=\"is_image_needed\"\n                      v-model=\"is_image_needed\"\n                    />\n                    <span class=\"icn\" id=\"radio\"></span>\n                    No\n                  </label>\n                </div>\n              </div>\n              <div class=\"custom-file\" v-if=\"is_image_needed == 'yes'\">\n                <input\n                  type=\"file\"\n                  class=\"custom-file-input\"\n                  @change=\"fileinput1\"\n                  id=\"inputFile\"\n                />\n                <label\n                  style=\"\n                    font-weight: 400;\n                    line-height: 20px;\n                    padding-left: 15px;\n                  \"\n                  class=\"custom-file-label form-control\"\n                  for=\"file\"\n                  >{{ file_label }}</label\n                >\n              </div>\n            </div>\n            <div class=\"form-group\" v-if=\"is_image_needed == 'yes' && !is_html_body\">\n              <label>{{tlt('template_model_image_url_label')}}</label>\n              <label>\n                {{tlt('template_model_redirected_link_text')}}\n              </label>\n              <input\n                type=\"text\"\n                v-model=\"img_redirect_url\"\n                class=\"form-control\"\n                placeholder=\"(e.g, https://cense.ai)\"\n              />\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n              <button\n                type=\"button\"\n                class=\"btn btn-link\"\n                data-dismiss=\"modal\"\n                @click=\"empty_variable\"\n              >\n                {{tlt('template_model_cancel_btn')}}\n              </button>\n              <button\n                type=\"submit\"\n                class=\"darkblue-btn\"\n                id=\"res_n_int_save\"\n                @click=\"save_template()\"\n              >\n                {{tlt('template_model_save_btn')}}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { VueEditor } from \"vue2-editor\";\nimport axios from \"axios\";\nimport swal from \"sweetalert2\";\nimport Swal from \"sweetalert2\";\nimport api_calls from \"@/portal/api_calls\";\nimport { freeze_portal,show_subscription_expired_swal } from \"@/portal/mixins\";\nimport Multiselect from \"vue-multiselect\";\n\nexport default {\n  name: \"EmailTemplatePage\",\n  components: {\n    VueEditor,\n    Multiselect,\n  },\n  mixins: [freeze_portal,show_subscription_expired_swal],\n  data() {\n    return {\n      pencil_svg:\n        ' <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15.546\" height=\"15.461\" viewBox=\"0 0 15.546 15.461\"><defs><style>.a{fill:#9e9e9e;}</style></defs><g transform=\"translate(-747.888 -356.769)\"><path class=\"a\" d=\"M759.416,356.769a2.358,2.358,0,0,1,1.777.662c.534.513,1.072,1.025,1.567,1.575a2.3,2.3,0,0,1-.071,3.325c-2.736,2.76-5.494,5.5-8.238,8.251a1.381,1.381,0,0,1-.758.288c-.719.174-1.429.379-2.144.572-.932.251-1.862.5-2.795.751-.6.158-.989-.213-.832-.807q.689-2.595,1.406-5.182a1.164,1.164,0,0,1,.289-.487q4.091-4.107,8.2-8.2A2.265,2.265,0,0,1,759.416,356.769Zm-1.989,2.956-6.54,6.538,3.025,3.024,6.538-6.537Zm4.023,2.165c.118-.135.225-.269.343-.392a1.134,1.134,0,0,0,0-1.734c-.46-.466-.926-.925-1.388-1.39a1.166,1.166,0,0,0-.861-.368c-.578,0-.881.4-1.214.76Zm-12.084,8.863,3.2-.863-2.337-2.331Z\" transform=\"translate(0)\"/><path class=\"a\" d=\"M813.942,422.6l-.789-.8,3.821-3.819.784.8Z\" transform=\"translate(-59.648 -55.947)\"/></g></svg>',\n      company_id: this.$session.get(\"UserInformation\").company_id,\n      company_name: this.$session.get(\"UserInformation\").company_name,\n      spinnerOn: false,\n      template_name: \"\",\n      save_sms: \"\",\n      save_email: \"\",\n      is_sms: false,\n      is_email: true,\n      save_subject: \"\",\n      is_publish_email: true,\n      is_publish_sms: true,\n      is_edit_sms: false,\n      is_edit_email: true,\n      verification_status: null,\n      templatelist: [],\n      checked_list: [],\n      customToolbar: [\n        [\"bold\", \"italic\", \"underline\"],\n        [{ align: [] }],\n        [{ color: [] }, { background: [] }],\n        [{ list: \"ordered\" }, { list: \"bullet\" }],\n        [\"link\"],\n      ],\n      quill: \"\",\n      quill_edit: \"\",\n      is_html_body: false,\n      slot_variable:{},\n      current_template: [],\n      old_template_name: \"\",\n      isEditTemplate: false,\n      number_of_rows: null,\n      total_pages: null,\n      page_no: 1,\n      per_page: 10,\n      image_file: null,\n      image_file_2: null,\n      is_image_needed: \"none\",\n      is_edit_image_needed: \"none\",\n      email_subject: \"\",\n      reg_url:\n        /https:\\/\\/[(www\\.)?a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&\\/\\/=]*)/i,\n      is_edit_reg_url:\n        /https:\\/\\/[(www\\.)?a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&\\/\\/=]*)/i,\n      img_redirect_url: \"\",\n      edit_img_redirect_url: \"\",\n      file_label: \"Choose file\",\n      edited_file_label: \"Choose file\",\n      preview_template_data: \"\",\n      template_name_already_exist: false,\n      edit_template_name_already_exist: false,\n      page_array: [],\n      send_email_all_customer: true,\n      customers_list: [],\n      specific_customer_list: [],\n      disable_btn_expired: false,\n      email_reg:\n        /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,\n    };\n  },\n  props: {\n    is_notification_template: Boolean,\n  },\n  watch: {\n    // is_notification_template() {\n    //   console.log(this.is_notification_template);\n    // },\n  },\n  computed: {\n    validURL() {\n      if (this.reg_url.test(this.img_redirect_url)) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    valid_edit_URL() {\n      if (this.is_edit_reg_url.test(this.edit_img_redirect_url)) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n  },\n  created() {\n    if (this.$session.get(\"UserInformation\").role == \"SuperAdmin\") {\n      this.companyid = this.$session.get(\"CompanyId\");\n      this.companyname = this.$session.get(\"CompanyName\");\n    } else {\n      this.companyid = this.$session.get(\"UserInformation\").company_id;\n      this.companyname = this.$session.get(\"UserInformation\").company_name;\n    }\n  },\n  mounted() {\n    setTimeout(() => {\n      this.freeze_portal();\n    }, 1000);\n     this.$root.$on(\"EmailTemplatePageDisabled\", (data) =>{\n      if(data===true){\n        this.disable_btn_expired = true;\n        this.show_subscription_expired_swal();\n      }\n    })\n    this.load_templates();\n    if (this.is_notification_template === false){\n      this.load_customer_list();\n    }\n    var vm = this;\n    $(\"#selectall\").click(function () {\n      this.isEditTemplate = false;\n      this.is_sms = false;\n      this.is_email = true;\n      if ($(this).is(\":checked\")) {\n        $(\"input:checkbox\").prop(\"checked\", true);\n      } else {\n        vm.checked_list = [];\n        $(\"input:checkbox\").prop(\"checked\", false);\n      }\n    });\n    this.editor();\n    if (this.is_notification_template === true){\n      this.load_slot_variable();\n    }\n  },\n  methods: {\n    load_slot_variable(){\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.form_automation_dialog_tree(),\n          {\n            company_id: this.$session.get(\"UserInformation\").company_id,\n            company_name: this.$session.get(\"UserInformation\").company_name,\n            is_get_slot_variable: true,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (response.data.status == \"Success\") {\n            this.slot_variable = {};\n            for (let index = 0; index < response.data.slots_list.length; index++) {\n              const element = response.data.slots_list[index];\n              this.slot_variable[element] = '{' + element + '}';\n            }\n          // this.insert_variable('quill', this.slot_variable);\n          }else {\n            Swal({\n              text: \"Internal Server Error\",\n              toast: true,\n              position: \"top-end\",\n              type: \"error\",\n              showConfirmButton: false,\n              timer: 5000,\n            });\n          }\n        })\n        .catch((e) => {\n          // this.insert_variable('quill', this.slot_variable);\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    editor(){\n      this.quill = new Quill(\"#editor\", {\n        modules: {\n          toolbar: [\n            [\"bold\", \"italic\", \"underline\"],\n            [\"link\"],\n            [{ align: [] }],\n            [{ color: [] }, { background: [] }],\n            [{ list: \"ordered\" }, { list: \"bullet\" }],\n          ],\n        },\n        theme: \"snow\",\n      });\n      this.quill.on(\"text-change\", () => {\n        this.$emit(\n          \"input\",\n          this.quill.getText() ? this.quill.root.innerHTML : \"\"\n        );\n        this.save_email = this.quill.getText() ? this.quill.root.innerHTML : \"\";\n      });\n      if(this.is_notification_template) {\n        this.insert_variable('quill', this.slot_variable);\n      }\n    },\n    edit_editor(){\n      this.quill_edit = new Quill(\"#edit_editor\", {\n      modules: {\n        toolbar: [\n          [\"bold\", \"italic\", \"underline\"],\n          [\"link\"],\n          [{ align: [] }],\n          [{ color: [] }, { background: [] }],\n          [{ list: \"ordered\" }, { list: \"bullet\" }],\n        ],\n      },\n      theme: \"snow\",\n    });\n    this.quill_edit.on(\"text-change\", () => {\n      this.$emit(\n        \"input\",\n        this.quill_edit.getText() ? this.quill_edit.root.innerHTML : \"\"\n      );\n      this.current_template.email = this.quill_edit.getText() ? this.quill_edit.root.innerHTML : \"\";\n    });\n    this.quill_edit.root.innerHTML = this.current_template.email;\n    this.insert_variable('quill_edit', this.slot_variable);\n    },\n    insert_variable(val, slot_variable){\n      if (this.is_notification_template === true){\n        const dropDownItems = {\n        'No slot variable': '',\n        }\n        const myDropDown = new QuillToolbarDropDown({\n            label: \"Insert Variable\",\n            rememberSelection: false,\n            id: \"dropdown_id\"\n        })\n        if(Object.entries(slot_variable).length === 0 && slot_variable.constructor === Object){\n          myDropDown.setItems(dropDownItems);\n        }else {\n          myDropDown.setItems(slot_variable);\n        }\n        myDropDown.onSelect = function(label, value, quill) {\n            const { index, length } = quill.selection.savedRange\n            quill.deleteText(index, length)\n            quill.insertText(index, value)\n            quill.setSelection(index + value.length)\n        }\n        myDropDown.attach(this.quill)\n        if (val === 'quill_edit'){\n          myDropDown.attach(this.quill_edit)\n        }\n      }\n    },\n    addTag(newTag) {\n      var tag_list = [];\n      tag_list = newTag.split(\",\");\n      if (tag_list.length > 2) {\n        swal({\n          text: this.tlt('email_temp_add_valid_tag_msg'),\n          type: \"warning\",\n          showConfirmButton: true,\n          timer: 4500,\n        });\n        return;\n      } else {\n        var email = tag_list[0];\n        var customer_name = Boolean(tag_list[1]) ? tag_list[1] : \" \";\n        if (!this.email_reg.test(email)) {\n          swal({\n            text: this.tlt('email_temp_valid_email_addr_msg'),\n            type: \"warning\",\n            showConfirmButton: true,\n            timer: 4500,\n          });\n          return;\n        }\n      }\n      const tag = {\n        customer_name: customer_name,\n        email: email,\n      };\n      this.customers_list.push(tag);\n      this.specific_customer_list.push(tag);\n    },\n    load_customer_list() {\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.send_offer_to_customers(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            email: this.$session.get(\"UserInformation\").email,\n            license_key: this.$session.get(\"UserInformation\").license_key,\n            token: this.$session.get(\"UserInformation\").tokens,\n            get_customers_list: true,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (response.status == 200) {\n            this.customers_list = response.data.customers_list;\n          }\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    email_verification_status() {\n      if(!this.disable_btn_expired){\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.product_settings(),\n          {\n            company_name: this.companyname,\n            company_id: this.companyid,\n            email: this.$session.get(\"UserInformation\").email,\n            license_key: this.$session.get(\"UserInformation\").license_key,\n            token: this.$session.get(\"UserInformation\").tokens,\n            is_email_verification_status: true,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (\n            response.data != \"\" &&\n            response.data != null &&\n            response.data != \"Internal server Error\"\n          ) {\n            this.verification_status = response.data.verification_status;\n            // console.log(this.verification_status);\n            if (this.verification_status == \"Success\") {\n              // if (!document.getElementById(\"publish_template_btn\").disabled) {\n              $(\"#sendemail\").modal(\"show\");\n              this.load_customer_list();\n              // }\n            } else {\n              swal({\n                text: this.tlt('email_temp_not_config_instruction_msg'),\n                type: \"error\",\n                showConfirmButton: true,\n                timer: 13000,\n              });\n            }\n          } else if(response.data.MSG == 'EMAIL NOT FOUND OR NOT CONFIGURED') {\n            swal({\n                text: this.tlt('email_temp_not_config_instruction_msg1'),\n                type: \"warning\",\n                showConfirmButton: true,\n                timer: 13000,\n              });\n          } \n          else {\n            toastr.error(this.tlt('email_temp_not_config_server_msg'));\n          }\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          toastr.error(this.tlt('email_temp_not_config_error_occur_msg'));\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n      }else{\n        this.show_subscription_expired_swal();\n      }\n    },\n    validate_template_name() {\n      axios.post(\n        api_calls.template_promotional_email(),\n        {\n           company_name: this.companyname,\n            company_id: this.companyid,\n            email: this.$session.get(\"UserInformation\").email,\n            license_key: this.$session.get(\"UserInformation\").license_key,\n            token: this.$session.get(\"UserInformation\").tokens,\n            subscription: this.$session.get(\"UserInformation\").subscription,\n            is_template_present: true,\n            is_notification: this.is_notification_template,\n            template_name: this.template_name,\n        },\n        {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n      )\n      .then((response) =>{\n        if (response.data.MSG == \"Not Exists\") {\n            this.template_name_already_exist = false;\n            document.getElementById(\"template_name_add_id\").style.border =null;\n            if(this.template_name != \"\"){\n              document.getElementById(\"template_name_add_id\").style.border =\n              \"1px solid #00f000\";\n            }\n          } else if (response.data.MSG == \"Already Exists\") {\n            this.template_name_already_exist = true;\n            document.getElementById(\"template_name_add_id\").style.border =\n            \"1px solid red\";\n          }\n        })\n        .catch((e) => {\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    validate_edit_template_name() {\n      axios.post(\n        api_calls.template_promotional_email(),\n        {\n           company_name: this.companyname,\n            company_id: this.companyid,\n            email: this.$session.get(\"UserInformation\").email,\n            license_key: this.$session.get(\"UserInformation\").license_key,\n            token: this.$session.get(\"UserInformation\").tokens,\n            subscription: this.$session.get(\"UserInformation\").subscription,\n            is_template_present: true,\n            is_notification: this.is_notification_template,\n            template_name: this.current_template.template_name,\n        },\n        {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n      )\n      .then((response) =>{\n        if (response.data.MSG == \"Not Exists\") {\n            this.edit_template_name_already_exist = false;\n            document.getElementById(\"edit_template_name_id\").style.border =null;\n            if(this.current_template.template_name != \"\"){\n              document.getElementById(\"edit_template_name_id\").style.border =\n              \"1px solid #00f000\";\n            }\n          } else if (response.data.MSG == \"Already Exists\") {\n            if (this.old_template_name == this.current_template.template_name){\n              this.edit_template_name_already_exist = false;\n              document.getElementById(\"edit_template_name_id\").style.border =null;\n            }else{\n              this.edit_template_name_already_exist = true;\n              document.getElementById(\"edit_template_name_id\").style.border =\n              \"1px solid red\";\n            }\n          }\n        })\n        .catch((e) => {\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    preview_template() {\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.template_promotional_email(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_preview: true,\n            template_id: this.current_template.template_id,\n            is_notification: this.is_notification_template,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          // if (response.data != null) {\n          //   this.number_of_rows = response.data.pagecount;\n          //   this.total_pages = Math.ceil(this.number_of_rows / this.per_page);\n          //   if (response.data === \"DB OPERATION UNSUCCESSFUL\") {\n          //     this.templatelist = [];\n          //     return;\n          //   }\n          //   this.templatelist = response.data.data;\n          //   if (this.templatelist.length > 0) {\n          //     // this.current_template = this.templatelist[0];\n          //     this.show_template(0);\n          //   }\n          //   this.isEditTemplate = false;\n          // }\n          // this.setpagination(this.page_no);\n          if (response.data != null) {\n            this.preview_template_data = response.data.Template;\n            $(\"#preview_template_visible\").modal(\"show\");\n          }\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    send_email_confirm_prompt_text(all_customer) {\n      if (all_customer) {\n        return this.tlt('email_temp_send_bulk_email_msg');\n      } else {\n        return this.tlt('email_temp_send_specific_customer_msg');\n      }\n    },\n    send_email() {\n      if (!this.send_email_all_customer) {\n        if(!Boolean(this.specific_customer_list.length > 0)){\n          swal({\n          text: this.tlt('email_temp_select_one_email_msg'),\n          type: \"warning\",\n          timer: 5000,\n        });\n        return\n        }\n      }\n      Swal.fire({\n        title:this.send_email_confirm_prompt_text(this.send_email_all_customer),\n        text: this.tlt('email_temp_swal_confirm_msg'),\n        showCancelButton: true,\n        type:'warning',\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: this.tlt('email_temp_swal_yes_msg'),\n      }).then((result) => {\n        if (result.value) {\n          $(\"#sendemail\").modal(\"hide\");\n          this.spinnerOn = true;\n          axios\n            .post(\n              api_calls.send_offer_to_customers(),\n              {\n                company_id: this.company_id,\n                company_name: this.company_name,\n                email: this.$session.get(\"UserInformation\").email,\n                license_key: this.$session.get(\"UserInformation\").license_key,\n                token: this.$session.get(\"UserInformation\").tokens,\n                send_email: true,\n                send_email_all_customer: this.send_email_all_customer,\n                specific_customer_list:\n                  this.send_email_all_customer != true\n                    ? this.specific_customer_list\n                    : [],\n                template_id: this.current_template.template_id,\n              },\n              {\n                headers: {\n                  Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                },\n              }\n            )\n            .then((response) => {\n              this.spinnerOn = false;\n              if (response.data != null) {\n                if (response.data.MSG === \"Sending Email\") {\n                  // this.save_subject = \"\";\n                  // $(\"#publishtemplatemodel\").modal(\"hide\");\n                  swal({\n                    text: this.tlt('email_temp_sent_successful_msg'),\n                    type: \"success\",\n                    timer: 5000,\n                    title: this.tlt('email_temp_swal_success_msg'),\n                  }).then((result) => {\n                    $(\"#sendemail\").modal(\"hide\");\n                    this.empty_variable();\n                  });\n                } else if(response.data.MSG === \"Please upgrade your plan to send emails\") {\n                    swal({\n                      type: \"warning\",\n                      text: this.tlt('email_temp_upgrade_plan_msg'),\n                      showCancelButton: true,\n                      confirmButtonColor:'#3085d6',\n                      confirmButtonText: this.tlt('email_temp_swal_upgrade_now_msg'),\n                      cancelButtonText: this.tlt('email_temp_swal_upgrade_later_msg'),\n                      cancelButtonColor: '#d33',\n                    }).then((result) => {\n                      if (result.value == true)\n                      {\n                        this.$router.push({name: 'Settings',params:{Subscription:true}});     \n                      }\n                    });\n                }\n                 else {\n                  swal({\n                    text: this.tlt('email_temp_internal_server_alert_msg1'),\n                    type: \"error\",\n                    timer: 2000,\n                  });\n                }\n              } else {\n                swal({\n                  text: this.tlt('email_temp_internal_server_alert_msg2'),\n                  type: \"error\",\n                  timer: 2000,\n                });\n              }\n            })\n            .catch((e) => {\n              this.spinnerOn = false;\n              if (\n                e.response.status === 410 ||\n                e.response.status === 440 ||\n                e.response.status === 409\n              ) {\n                this.$root.$emit(\"Session_Expired\", e.response.data);\n              }\n            });\n        }\n      });\n    },\n    selected_templates(value) {\n      if(value == \"all\"){\n        if (event.target.checked) {\n          this.checked_list = [];\n            for (var i in this.templatelist) {\n              this.checked_list.push(this.templatelist[i].template_id);\n          }\n          $(\"input:checkbox\").prop(\"checked\", false);\n          for(let i = 0; i < this.checked_list.length; i++){\n            $(\"#\"+[i]).prop(\"checked\", true);\n            $(\"#selectall\").prop(\"checked\", true);\n          }\n        }else if (!event.target.checked){\n          this.checked_list = [];\n          $(\"input:checkbox\").prop(\"checked\", false);\n        }\n\n      }else{\n        if (event.target.checked) {\n          this.checked_list.push(value);\n        } else if (!event.target.checked){\n          var selectall = document.querySelector(\"#selectall\");\n          if (selectall.checked) {\n            selectall.checked = false;\n          }\n          var temp = this.checked_list.filter((templates_id) => {\n            return templates_id != value;\n          });\n          this.checked_list = temp;\n        }\n      }\n    },\n    load_templates() {\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.template_promotional_email(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_get: true,\n            is_notification: this.is_notification_template,\n            page_no: this.page_no,\n            per_page: this.per_page,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (response.data != null) {\n            this.number_of_rows = response.data.pagecount;\n            this.total_pages = Math.ceil(this.number_of_rows / this.per_page);\n            if (response.data === \"DB OPERATION UNSUCCESSFUL\") {\n              this.templatelist = [];\n              return;\n            }\n            this.templatelist = response.data.data;\n            if (this.templatelist.length > 0) {\n              // this.current_template = this.templatelist[0];\n              this.show_template(0);\n            }\n            this.isEditTemplate = false;\n          }\n          this.setpagination(this.page_no);\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    fileinput1(e) {\n      let files = e.target.files || e.dataTransfer.files;\n      if (files[0].type === \"image/png\" || files[0].type === \"image/jpeg\") {\n        if (!files.length) return;\n        this.file_label = files[0].name;\n        this.createImage(files[0]);\n      } else {\n        swal({\n          text: this.tlt('email_temp_image_type_msg1'),\n          type: \"error\",\n          timer: 2500,\n        });\n      }\n    },\n    createImage(file, type) {\n      let reader = new FileReader();\n\n      reader.onload = (e) => {\n        this.image_file = e.target.result.split(\"base64,\")[1];\n      };\n      reader.readAsDataURL(file);\n    },\n    fileinput2(e) {\n      let files = e.target.files || e.dataTransfer.files;\n      if (files[0].type === \"image/png\" || files[0].type === \"image/jpeg\") {\n        if (!files.length) return;\n        this.old_edited_image_name = this.edited_file_label;\n        this.edited_file_label = files[0].name;\n        this.createImage2(files[0]);\n      } else {\n        swal({\n          text: this.tlt('email_temp_image_type_msg2'),\n          type: \"error\",\n          timer: 2500,\n        });\n      }\n    },\n    createImage2(file, type) {\n      let reader = new FileReader();\n\n      reader.onload = (e) => {\n        this.image_file_2 = e.target.result.split(\"base64,\")[1];\n      };\n      reader.readAsDataURL(file);\n    },\n    create_UUID() {\n      var dt = new Date().getTime();\n      var uuid = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(\n        /[xy]/g,\n        function (c) {\n          var r = (dt + Math.random() * 16) % 16 | 0;\n          dt = Math.floor(dt / 16);\n          return (c == \"x\" ? r : (r & 0x3) | 0x8).toString(16);\n        }\n      );\n      return uuid;\n    },\n    page_require(page) {\n      if (page == 0 || page == this.total_pages + 1) {\n      } else {\n        if (page == \"...s\") {\n          this.page_no = Math.ceil((1 + this.page_no) / 2);\n        } else if (page == \"...l\") {\n          this.page_no = Math.ceil((this.total_pages + this.page_no) / 2);\n        } else {\n          this.page_no = page;\n        }\n        $(\"input:checkbox\").prop(\"checked\", false);\n        this.spinnerOn = true;\n        axios\n          .post(\n            api_calls.template_promotional_email(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_get: true,\n              is_notification: this.is_notification_template,\n              page_no: this.page_no,\n              per_page: this.per_page,\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            if (response.data != null) {\n              if (response.data === \"DB OPERATION UNSUCCESSFUL\") {\n                this.templatelist = [];\n                return;\n              }\n              this.templatelist = response.data.data;\n              if (this.templatelist.length > 0) {\n                this.current_template = this.templatelist[0];\n              }\n              this.isEditTemplate = false;\n            }\n            this.setpagination(this.page_no);\n          })\n          .catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      }\n    },\n    setpagination(page_no) {\n      this.page_array = [];\n      if (this.total_pages <= 7) {\n        for (let i = 0; i < this.total_pages; i++) {\n          this.page_array.push(i + 1);\n        }\n      } else if (page_no == 1) {\n        for (let i = 0; i < 4; i++) {\n          this.page_array.push(i + 1);\n        }\n        this.page_array.push(\"...l\");\n        this.page_array.push(this.total_pages);\n      } else if (page_no == this.total_pages) {\n        this.page_array.push(1);\n        this.page_array.push(\"...s\");\n        for (let i = this.total_pages - 4; i < this.total_pages; i++) {\n          this.page_array.push(i + 1);\n        }\n      } else if (page_no <= 4) {\n        for (let i = 0; i < page_no + 3; i++) {\n          this.page_array.push(i + 1);\n        }\n        this.page_array.push(\"...l\");\n        this.page_array.push(this.total_pages);\n      } else if (page_no >= this.total_pages - 4) {\n        this.page_array.push(1);\n        this.page_array.push(\"...s\");\n        for (let i = page_no - 4; i < this.total_pages; i++) {\n          this.page_array.push(i + 1);\n        }\n      } else {\n        this.page_array.push(1);\n        this.page_array.push(\"...s\");\n        for (let i = page_no - 3; i <= page_no + 3; i++) {\n          this.page_array.push(i);\n        }\n        this.page_array.push(\"...l\");\n        this.page_array.push(this.total_pages);\n      }\n    },\n    pagination_class(index) {\n      if (index == this.page_no) {\n        return \" active\";\n      } else {\n        return \"\";\n      }\n    },\n    save_template() {\n      if (this.template_name == \"\") {\n        Swal({\n          text: this.tlt('email_model_template_name_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.template_name_already_exist == true) {\n        Swal({\n          text: this.tlt('email_model_name_exist_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.email_subject == \"\") {\n        Swal({\n          text: this.tlt('email_model_enter_subject_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.is_sms == true && this.save_sms == \"\") {\n        Swal({\n          text: this.tlt('email_model_enter_sms_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.is_email == true && this.save_email == \"\") {\n        Swal({\n          text: this.tlt('email_model_enter_email_body_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.is_email == false && this.is_sms == false) {\n        Swal({\n          text: this.tlt('email_model_select_option_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (\n        this.is_image_needed == \"yes\" &&\n        document.getElementById(\"inputFile\").value == \"\"\n      ) {\n        Swal({\n          text: this.tlt('email_model_choose_img_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.is_image_needed == \"yes\" && !this.validURL) {\n        Swal({\n          text: this.tlt('email_model_valid_url_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else {\n        if (this.is_html_body) this.is_image_needed = 'none';\n        var uuid = this.create_UUID();\n        Swal.fire({\n          title: this.tlt('email_model_swal_alert_msg'),\n          text: this.tlt('email_model_add_current_template_msg'),\n          type: \"question\",\n          showCancelButton: true,\n          confirmButtonColor: \"#3085d6\",\n          cancelButtonColor: \"#d33\",\n          confirmButtonText: this.tlt('email_model_swal_confirm_msg'),\n        }).then((result) => {\n          if (result.value) {\n            Swal({\n              text: this.tlt('email_model_submit_details_msg'),\n              type: \"info\",\n              toast: true,\n              showConfirmButton: false,\n            });\n            axios\n              .post(\n                api_calls.template_promotional_email(),\n                {\n                  company_id: this.company_id,\n                  company_name: this.company_name,\n                  is_save: true,\n                  is_notification: this.is_notification_template,\n                  template_id: uuid,\n                  template_name: this.template_name,\n                  save_email: this.is_email == true ? this.save_email : null,\n                  save_sms: this.is_sms == true ? this.save_sms : null,\n                  email_subject: this.email_subject,\n                  email_img_file:\n                    this.is_image_needed === \"none\" ? null : this.image_file,\n                  email_img_name: this.file_label,\n                  email_img_link: this.img_redirect_url,\n                  is_html_body: this.is_html_body\n                },\n                {\n                  headers: {\n                    Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                  },\n                }\n              )\n              .then((response) => {\n                if (response.data == \"Query Executed Successfully\") {\n                  Swal({\n                    type: \"success\",\n                    text: this.tlt('email_model_data_added_successful_msg'),\n                    timer: 2500,\n                  }).then((result) => {\n                    this.empty_variable();\n                    this.load_templates();\n                    $(\"#templatemodel\").modal(\"hide\");\n                  });\n                } else if (response.data.Msg == \"Duplicate image\") {\n                  Swal({\n                    type: \"error\",\n                    text: this.tlt('email_model_img_already_found_msg'),\n                    timer: 2500,\n                  });\n                  this.empty_variable();\n                  this.load_templates();\n                } else {\n                  Swal({\n                    type: \"error\",\n                    text: this.tlt('email_model_error_occur_msg1'),\n                    timer: 2500,\n                  });\n                }\n              })\n              .catch((e) => {\n                Swal({\n                  type: \"error\",\n                  text: this.tlt('email_model_error_occur_msg2'),\n                  timer: 2500,\n                });\n                if (\n                  e.response.status === 410 ||\n                  e.response.status === 440 ||\n                  e.response.status === 409\n                ) {\n                  this.$root.$emit(\"Session_Expired\", e.response.data);\n                }\n              });\n          }\n        });\n      }\n    },\n    edit_template() {\n      if (this.current_template.template_name == \"\") {\n        Swal({\n          text: this.tlt('email_edit_template_name_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.edit_template_name_already_exist == true) {\n        Swal({\n          text: this.tlt('email_edit_name_already_exist_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.current_template.subject == \"\") {\n        Swal({\n          text: this.tlt('email_edit_enter_subject_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (\n        this.is_edit_sms == true &&\n        (this.current_template.sms == null || this.current_template.sms == \"\")\n      ) {\n        Swal({\n          text: this.tlt('email_edit_enter_sms_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (\n        this.is_edit_email == true &&\n        (this.current_template.email == null ||\n          this.current_template.email == \"\")\n      ) {\n        Swal({\n          text: this.tlt('email_edit_enter_email_body_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.is_edit_email == false && this.is_edit_sms == false) {\n        Swal({\n          text: this.tlt('email_edit_select_option_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (this.is_edit_image_needed == \"yes\" && !this.valid_edit_URL) {\n        Swal({\n          text: this.tlt('email_edit_valid_url_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else if (\n        this.is_edit_image_needed == \"yes\" &&\n        this.edited_file_label == \"Choose file\" &&\n        document.getElementById(\"inputFile2\").value == \"\"\n      ) {\n        Swal({\n          text: this.tlt('email_edit_choose_img_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } else {\n        if (this.is_html_body) this.is_edit_image_needed = 'none';\n        Swal({\n          text: this.tlt('email_edit_submit_details_msg'),\n          type: \"info\",\n          toast: true,\n          showConfirmButton: false,\n        });\n        axios\n          .post(\n            api_calls.template_promotional_email(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_edit: true,\n              is_notification: this.is_notification_template,\n              template_id: this.current_template.template_id,\n              template_name: this.current_template.template_name,\n              email_subject: this.current_template.subject,\n              save_email:\n                this.is_edit_email == true ? this.current_template.email : null,\n              save_sms:\n                this.is_edit_sms == true ? this.current_template.sms : null,\n              email_img_file:\n                this.is_edit_image_needed === \"none\" ? null : this.image_file_2,\n              email_img_name:\n                this.is_edit_image_needed === \"none\"\n                  ? null\n                  : this.edited_file_label,\n              email_img_link:\n                this.is_edit_image_needed === \"none\"\n                  ? null\n                  : this.edit_img_redirect_url,\n              is_image_edit:\n                this.edited_file_label != this.old_edited_image_name\n                  ? true\n                  : false,\n              is_image_present:\n                this.is_edit_image_needed === \"none\" ? false : true,\n              old_image:\n                this.old_edited_image_name == \"Choose File\"\n                  ? null\n                  : this.old_edited_image_name,\n              is_html_body: this.current_template.is_html_body\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            if (response.data == \"Query Executed Successfully\") {\n              Swal({\n                type: \"success\",\n                text: this.tlt('email_edit_data_edit_successful_msg'),\n                timer: 2500,\n              }).then((result) => {\n                this.load_templates();\n              });\n            } else if (response.data.Msg == \"Duplicate image\") {\n              document.getElementById(\"inputFile2\").value = \"\";\n              swal({\n                text: this.tlt('email_edit_img_already_found_msg'),\n                type: \"error\",\n                timer: 3000,\n              });\n            } else {\n              Swal({\n                type: \"error\",\n                text: this.tlt('email_edit_error_occur_msg1'),\n                timer: 2500,\n              });\n              this.load_templates();\n            }\n          })\n          .catch((e) => {\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n            Swal({\n              type: \"error\",\n              text: this.tlt('email_edit_error_occur_msg2'),\n              timer: 2500,\n            });\n          });\n      }\n    },\n    delete_selected() {\n      if (this.checked_list.length == 0) {\n        Swal.fire({\n          title: this.tlt('email_temp_no_template_select_msg'),\n          text: \"\",\n          type: \"error\",\n          timer: 2000,\n        });\n      } else {\n        Swal.fire({\n          title: this.tlt('email_temp_swal_alert_msg2'),\n          text: this.tlt('email_temp_swal_delete_current_template_msg'),\n          type: \"question\",\n          showCancelButton: true,\n          confirmButtonColor: \"#3085d6\",\n          cancelButtonColor: \"#d33\",\n          confirmButtonText: this.tlt('email_temp_swal_confirm_msg'),\n        }).then((result) => {\n          if (result.value) {\n            this.delete_templates(this.checked_list);\n          }\n        });\n      }\n    },\n    delete_templates(checked_list) {\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.template_promotional_email(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_delete: true,\n            template_list: checked_list,\n            is_notification: this.is_notification_template,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (response.data == \"Deleted Successfully\") {\n            Swal({\n              type: \"success\",\n              text: this.tlt('email_temp_data_deleted_msg'),\n              timer: 2500,\n            }).then((result) => {\n              this.checked_list = [];\n              $(\"input:checkbox\").prop(\"checked\", false);\n              this.load_templates();\n            });\n          }\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    show_template(index) {\n      if (this.isEditTemplate) {\n        this.edit_template_details();\n      }\n      this.current_template = JSON.parse(JSON.stringify(this.templatelist[index]));\n      this.old_template_name = this.current_template.template_name;\n      this.current_template_index = index;\n      if (Boolean(this.current_template.template_image_name) === true) {\n        this.is_edit_image_needed = \"yes\";\n      } else {\n        this.is_edit_image_needed = \"none\";\n      }\n      if (this.templatelist[index].email != null) {\n        this.is_edit_email = true;\n      } else {\n        this.is_edit_email = false;\n      }\n      if (this.templatelist[index].sms != null) {\n        this.is_edit_sms = true;\n      } else {\n        this.is_edit_sms = false;\n      }\n      if (Boolean(this.current_template.template_image_name) === true) {\n        this.edited_file_label = this.current_template.template_image_name;\n        this.old_edited_image_name = this.edited_file_label;\n        this.edit_img_redirect_url = this.current_template.image_redirect_url;\n        if (this.edited_file_label == \"\") {\n          this.edited_file_label = \"Choose file\";\n        }\n      } else {\n        this.edited_file_label = \"Choose file\";\n        this.old_edited_image_name = this.edited_file_label;\n        this.edit_img_redirect_url = \"\";\n      }\n    },\n    empty_variable() {\n      if(!this.disable_btn_expired){\n        this.send_email_all_customer = true;\n        this.quill.setText(\"\");\n        this.customers_list = [];\n        this.specific_customer_list = [];\n        this.save_sms = \"\";\n        this.is_html_body = false;\n        this.save_email = \"\";\n        this.template_name = \"\";\n        this.old_template_name = \"\";\n        this.is_email = true;\n        this.is_sms = false;\n        this.save_subject = \"\";\n        this.is_publish_email = true;\n        this.verification_status = null;\n        this.file_label = \"Choose file\";\n        this.img_redirect_url = \"\";\n        this.email_subject = \"\";\n        this.is_image_needed = \"none\";\n        this.template_name_already_exist = false;\n        document.getElementById(\"template_name_add_id\").style.border = null;\n      }else {\n        this.show_subscription_expired_swal();\n      }\n    \n    },\n    edit_template_details() {\n      if (!this.isEditTemplate) {\n        this.isEditTemplate = true;\n        setTimeout(() => {\n          this.edit_editor();\n        }, 1000);\n      } else {\n        if(!this.current_template.is_html_body){\n          var elements = document.getElementById('edit_editor_temp');\n          elements.removeChild(elements.firstElementChild)\n        }\n        this.isEditTemplate = false;\n        this.load_templates();\n        this.edit_template_name_already_exist = false;\n      }\n    },\n    change_body_format(){\n        if(!this.is_html_body) {\n          this.is_html_body = true;\n          this.save_email = \"\";\n          // const element = document.getElementById(\"editor\");\n          // element.remove();\n        }else {\n          this.is_html_body = false;\n          this.save_email = \"\";\n          console.log(\"coming here\"); \n            setTimeout(() => {\n              this.editor();\n            }, 500);\n        }\n      // }, 1000);\n    },\n    check_current_template_active(index) {\n      // console.table(index, this.templatelist[index], this.current_template);\n      if (Boolean(this.templatelist[index]) === true) {\n        return this.templatelist[index].template_name ===\n          this.old_template_name\n          ? \"current-active-template\"\n          : null;\n      }\n    },\n  },\n};\n</script>\n<style>\n.ql-picker-options {\n  max-height: 200px !important;\n  overflow: auto !important;\n}\n.ql-dropdown_id{\n  background: lightgray !important;\n}\n.ql-snow .ql-picker.ql-expanded .ql-picker-label {\n    color: #000 !important;\n    z-index: 2;\n}\n.ql-container{\n  min-height: 150px !important;\n}\n.ql-editor{\n    min-height:150px !important;\n}\n</style>\n<style scoped>\n\n.close_btn{\n  position: absolute !important;\n  top: 30px !important;\n}\n.current-active-template {\n  background: rgba(0, 0, 0, 0.1);\n}\n.modal-xl {\n  max-width: 1140px;\n  min-height: 1140px;\n}\n.table-box tbody tr:hover td,\n.table-box tbody tr:hover th {\n  background: #ececec;\n}\ntextarea {\n  resize: none;\n}\n/* .table-responsive {\n  height: 80vh;\n  overflow-y: auto;\n  border: 1px solid #e3e2e5;\n} */\n/* .table-responsive thead th {\n  top: 0;\n  position: sticky;\n}\n.table-responsive::-webkit-scrollbar {\n  max-height: 10px;\n  width: 7px;\n  height: 7px;\n  border-radius: 10px;\n  overflow-x: hidden;\n}\n.table-responsive::-webkit-scrollbar-track {\n  background: #ffffff;\n  border-radius: 10px;\n}\n.table-responsive::-webkit-scrollbar-thumb {\n  background: #27397b;\n  border-radius: 10px;\n}\n.table-responsive::-webkit-scrollbar-thumb:hover {\n  background: #19295f;\n  border-radius: 10px;\n} */\n</style>"]}]}