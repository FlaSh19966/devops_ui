{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Template.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Template.vue","mtime":1643027096180},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBTd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImFkZC11c2VyIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc3Vic2NyaWJlX3N0YXR1czogIiIsCiAgICAgIHRlbXBsYXRlX25hbWU6ICIiLAogICAgICB0ZW1wbGF0ZV9zdHJ1Y3R1cmU6IFtdLAogICAgICBwb3J0YWxfcm9sZXM6IFtdLAogICAgICBzZWxlY3RlZF9yb2xlOiAiIiwKICAgICAgY2hlY2tfbGlzdDogW10sCiAgICAgIGVtYWlsbGlzdDogW10sCiAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgZW1haWw6ICIiLAogICAgICBwZXJfcGFnZTogMTAsCiAgICAgIHRvdGFsX3BhZ2VzOiBudWxsLAogICAgICBudW1iZXJfb2Zfcm93czogbnVsbCwKICAgICAgcGFnZV9ubzogMSwKICAgICAgY29tcGFueW5hbWU6ICIiLAogICAgICBjb21wYW55aWQ6ICIiLAogICAgICB1c2VyczogW10sCiAgICAgIHJvbGVzOiBbXSwKICAgICAgcm9sZTogIiIsCiAgICAgIHJlZ19lbWFpbDogL14oWzAtOWEtekEtWl0oWy0uXHddKlswLTlhLXpBLVpdKSpAKFswLTlhLXpBLVpdWy1cd10qWzAtOWEtekEtWl1cLikrW2EtekEtWl17Miw5fSkkLywKICAgICAgcmVnX3B3ZDogL14oPz0uKlthLXpdKSg/PS4qW0EtWl0pKD89LipcZCkoPz0uKlsjQCQhJSo/Jl0pW0EtWmEtelxkI0AkISUqPyZdezgsfS8sCiAgICAgIHNob3dfbG9hZGVyOiBmYWxzZSwKICAgICAgLy9oYXJzaAogICAgICBwYWdlX2FycmF5OiBbXSwKICAgICAgc2VhcmNoX25hbWU6ICIiLAogICAgICBzcGlubmVyT246IGZhbHNlLAogICAgICB0ZW1wbGF0ZXMgOiBbXSwKICAgICAgZWRpdGluZGV4IDogbnVsbCwKICAgICAgaXNfZWRpdCA6IGZhbHNlLAogICAgICBjaGF0OiBbXSwKICAgICAgdG9fc2Nyb2xsOiBmYWxzZSwKICAgICAgaXNleGNoYW5nZTogZmFsc2UsCiAgICAgIGVkaXRhYmxlOiBmYWxzZSwKICAgICAgYm90cXVlc3Rpb25zOiBbXSwKICAgICAgc2VsZWN0ZWRfcXVlc3Rpb24gOiAiIiwKICAgICAgdGVtcF9zdHJ1Y3R1cmU6IFtdLAogICAgICBhZG1pbnRlbXBsYXRlczogW10sCiAgICAgIGNlbnNldGVtcGxhdGVzOltdLAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KGFwaV9jYWxscy5nZXRfb3Blbl9ib3RfdGVtcGxhdGUoKSwgewogICAgICAgICAgICBwYXJhbXMgOnsKICAgICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09PSAiU3VjY2VzcyIpIHsKICAgICAgICAgICAgICAgIHRoaXMuY2Vuc2V0ZW1wbGF0ZXMgPSByZXNwb25zZS5kYXRhLnRlbXBsYXRlczsKICAgICAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgLmdldChhcGlfY2FsbHMucG9zdF9vcGVuX2JvdF90ZW1wbGF0ZSgpLCB7CiAgICAgICAgICAgICAgICBwYXJhbXMgOnsKICAgICAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgdGhpcy5hZG1pbnRlbXBsYXRlcyA9IHJlc3BvbnNlLmRhdGEudGVtcGxhdGVzOwogICAgICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVydGVtcGxhdGVzKCk7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgIH0pOwoKICB9LAogIG1vdW50ZWQoKSB7CiAgICQoIiNlZGl0Ym90bW9kZWwiKS5vbigiaGlkZGVuLmJzLm1vZGFsIiwgKCkgPT4gewogICAgICAvLyBkZWJ1Z2dlcjsKICAgICAgYWxlcnQoIkhpIik7CiAgICAgdGhpcy5jaGF0ID0gW107CiAgICAgdGhpcy5ib3RxdWVzdGlvbnMgPSBbXTsKICAgICAgLy8gdm0udmlzaXRfcmVhc29uID0gIiI7CiAgICAgIC8vIHZtLnZpc2l0b3Jfc3ltcHRvbXMgPSAiIjsKICAgICAgLy8gdm0udmlzaXRvcl9udW1iZXIgPSAiIjsKICAgICAgLy8gdm0uc2VsZWN0ZWRfdGltZSA9ICIiOwogICAgICAvLyB2bS5pc0VkaXQgPSBmYWxzZTsKICAgICAgLy8gdm0uc2VsZWN0ZWRfc2NoZWR1bGVfaWQgPSAiIjsKICAgICAgLy8gdm0uc2VsZWN0ZWRfc2NoZWR1bGVfdmlzaXRfc2xvdCA9ICIiOwogICAgICAvLyB2bS5pc1Jlc2NoZWR1bGV0aW1lID0gZmFsc2U7CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHJvdXRlX3RvX3ByZXZpZXcoaW5kZXgpIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ09wZW4gQm90IFRlbXBsYXRlIFByZXZpZXcnLAogICAgICAgIHBhcmFtczoge2JvdGRhdGE6e3N0cnVjdHVyZTp0aGlzLnRlbXBsYXRlc1tpbmRleF0uc3RydWN0dXJlfX0sCiAgICAgIH0pOwogICAgfSwKICAgIGVkaXR0ZW1wbGF0ZShlZGl0aW5kZXgpewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgU3dhbAogICAgICAgIC5maXJlKHsKICAgICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgICB0ZXh0OiAiIFlvdSB3YW50IHRvIEVkaXQgdGhlIFRlbXBsYXRlPyIsCiAgICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAiWWVzLCBDb25maXJtISIKICAgICAgICB9KQogICAgICAgIC50aGVuKCByZXN1bHQgPT4gewogICAgICAgICAgaWYocmVzdWx0LnZhbHVlKXsKICAgICAgICAgICAgLy8gZGVidWdnZXI7CiAgICAgICAgICAgIC8vIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmNoYXQpOwogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJIaSIsIHRoaXMuY2hhdCk7CiAgICAgICAgICAgICAgdmFyIHN0cnVjdHVyZSA9IFtdOwogICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGk8IHRoaXMuY2hhdC5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgICAgICBpZih0aGlzLmNoYXRbaV0uZXZlbnQgPT0gImJvdCIpewogICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmUucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICJib3QiLAogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMuY2hhdFtpXS50ZXh0LAogICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMuY2hhdFtpXS5kYXRhLAogICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB0aGlzLmNoYXRbaV0ubWV0YWRhdGEsCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYodGhpcy5jaGF0W2ldLmV2ZW50ID09ICJ1c2VyIil7CiAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBldmVudDogInVzZXIiLAogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMuY2hhdFtpXS50ZXh0LAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYodGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS50ZW1wbGF0ZV90eXBlID09ICdhZG1pbicpewogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uZmluYWxfdGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICB2YXIgY2Vuc2VfdGVtcGxhdGVfaWRfYXBpID0gdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5jZW5zZV90ZW1wbGF0ZV9pZDsKICAgICAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgICAucG9zdChhcGlfY2FsbHMucG9zdF9vcGVuX2JvdF90ZW1wbGF0ZSgpLCB7CiAgICAgICAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLmRvbWFpbiwKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZDogdGVtcGxhdGVfaWRfYXBpLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlX25hbWU6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0udGVtcGxhdGVfbmFtZSwKICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5kZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmU6IHN0cnVjdHVyZSwKICAgICAgICAgICAgICAgICAgICBjZW5zZV90ZW1wbGF0ZV9pZDogY2Vuc2VfdGVtcGxhdGVfaWRfYXBpLAogICAgICAgICAgICAgICAgfSx7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgIC8vIGlmKCkKICAgICAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PSAiU3VjY2VzcyIpewogICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgICBTd2FsCiAgICAgICAgICAgICAgICAgICAgICAgIC5maXJlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIlRlbXBsYXRlIEVkaXRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lOjIwMDAsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIkZhaWx1cmUiKXsKICAgICAgICAgICAgICAgICAgICAgIFN3YWwKICAgICAgICAgICAgICAgICAgICAgICAgLmZpcmUoewogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiU29tZSBFcnJvciBPY2N1cnJlZCwgUGxlYXNlIFRyeSBBZ2FpbiEiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZToyNTAwCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAkcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0udGVtcGxhdGVfdHlwZSA9PSAnY2Vuc2UnKXsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9pZF9hcGkgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGNlbnNlX3RlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0udGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoYXBpX2NhbGxzLnBvc3Rfb3Blbl9ib3RfdGVtcGxhdGUoKSwgewogICAgICAgICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgICAgIGRvbWFpbjogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5kb21haW4sCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfaWQ6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfbmFtZTogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS50ZW1wbGF0ZV9uYW1lLAogICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLmRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZTogc3RydWN0dXJlLAogICAgICAgICAgICAgICAgICAgIGNlbnNlX3RlbXBsYXRlX2lkOiBjZW5zZV90ZW1wbGF0ZV9pZF9hcGksCiAgICAgICAgICAgICAgICB9LHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgLy8gaWYoKQogICAgICAgICAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09ICJTdWNjZXNzIil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIuZ287CiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgICAgU3dhbAogICAgICAgICAgICAgICAgICAgICAgICAuZmlyZSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJUZW1wbGF0ZSBFZGl0ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZXI6MjAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PSAiRmFpbHVyZSIpewogICAgICAgICAgICAgICAgICAgICAgU3dhbAogICAgICAgICAgICAgICAgICAgICAgICAuZmlyZSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJTb21lIEVycm9yIE9jY3VycmVkLCBQbGVhc2UgVHJ5IEFnYWluISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lcjoyNTAwLAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyB9LCAxMDAwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gdmFyIHRlbXBsYXRlbmFtZSA9IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0udGVtcGxhdGVfbmFtZQoKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgLy8gY29uc29sZS5sb2coc3RydWN0dXJlKTsKCiAgICB9LAogICAgZ2VuZXJhdGVfdGltZSgpIHsKICAgICAgbGV0IGQgPSBuZXcgRGF0ZSgpOwogICAgICBsZXQgaCwgbSwgdHlwZTsKICAgICAgaWYgKGQuZ2V0SG91cnMoKSA+IDEyKSB7CiAgICAgICAgaCA9IGQuZ2V0SG91cnMoKSAlIDEyOwogICAgICAgIHR5cGUgPSAiIHBtIjsKICAgICAgfSBlbHNlIGlmIChkLmdldEhvdXJzKCkgPCAxMikgewogICAgICAgIGggPSBkLmdldEhvdXJzKCk7CiAgICAgICAgdHlwZSA9ICIgYW0iOwogICAgICB9IGVsc2UgaWYgKGQuZ2V0SG91cnMoKSA9PSAxMikgewogICAgICAgIGggPSBkLmdldEhvdXJzKCk7CiAgICAgICAgdHlwZSA9ICIgcG0iOwogICAgICB9CiAgICAgIG0gPSBkLmdldE1pbnV0ZXMoKTsKICAgICAgaWYgKG0gPCAxMCkgewogICAgICAgIG0gPSAwICsgU3RyaW5nKG0pOwogICAgICB9CiAgICAgIHJldHVybiBoICsgIjoiICsgbSArIHR5cGU7CiAgICAgICAgfSwgICAgc2Nyb2xsX2Rvd24oKSB7CiAgICAgIGlmICgKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuY2hhdC1ib2R5Iikuc2Nyb2xsSGVpZ2h0IC0KICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5jaGF0LWJvZHkiKS5zY3JvbGxUb3AgLQogICAgICAgICAgJCgiLmNoYXQtaGlzIikKICAgICAgICAgICAgLmxhc3QoKQogICAgICAgICAgICAuaGVpZ2h0KCkgPD0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuY2hhdC1ib2R5IikuY2xpZW50SGVpZ2h0CiAgICAgICkgewogICAgICAgIHRoaXMudG9fc2Nyb2xsID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy50b19zY3JvbGwgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgZWRpdF9ib3QoaW5kZXgpIHsKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICQoJyNlZGl0Ym90bW9kZWwnKS5tb2RhbCgnc2hvdycpOwogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgIH0sIDYwMCk7CiAgICAgICAgdGhpcy5pc19lZGl0ID0gdHJ1ZTsKICAgICAgICB0aGlzLmNoYXQ9W107CiAgICAgICAgdGhpcy5ib3RxdWVzdGlvbnMgPSBbXTsKICAgICAgICB0aGlzLmVkaXRpbmRleCA9IGluZGV4OwogICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnRlbXBsYXRlc1tpbmRleF0uc3RydWN0dXJlLmxlbmd0aDsgaSs9IDEgKXsKICAgICAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdHJ1Y3R1cmVbaV0uZXZlbnQgPT0gImJvdCIpewogICAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgICAgcmVjZWl2aW5nOiB0cnVlLAogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdHJ1Y3R1cmVbaV0udGV4dCwKICAgICAgICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICAgICAgICB0aW1lOiB0aGlzLmdlbmVyYXRlX3RpbWUoKSwKICAgICAgICAgICAgICBldmVudDogImJvdCIsCiAgICAgICAgICAgICAgZGF0YSA6IHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdHJ1Y3R1cmVbaV0uZGF0YSwKICAgICAgICAgICAgICBtZXRhZGF0YSA6IHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdHJ1Y3R1cmVbaV0ubWV0YWRhdGEKICAgICAgICAgICAgICAvLyBkb21haW46IHRlbXBsYXRlc1tpbmRleF0uZG9tYWluLAogICAgICAgICAgICAgIC8vIHRlbXBsYXRlX2lkOiB0ZW1wbGF0ZXNbaW5kZXhdLnRlbXBsYXRlX2lkLAogICAgICAgICAgICAgIC8vIHRlbXBsYXRlX25hbWU6IHRlbXBsYXRlc1tpbmRleF0udGVtcGxhdGVfbmFtZSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuYm90cXVlc3Rpb25zLnB1c2goewogICAgICAgICAgICAgIHZhbHVlOiBpLAogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdHJ1Y3R1cmVbaV0udGV4dAogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgICAgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN0cnVjdHVyZVtpXS5ldmVudCA9PSAidXNlciIpewogICAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRlbXBsYXRlc1tpbmRleF0uc3RydWN0dXJlW2ldLnRleHQsCiAgICAgICAgICAgICAgICBzZW5kaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICAgICAgICAgIGRlbGl2ZXJlZDogdHJ1ZSwKICAgICAgICAgICAgICAgIGRyb3Bkb3duOiAiIiwKICAgICAgICAgICAgICAgIGV2ZW50OiAidXNlciIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnaScsaSk7CiAgICAgICAgfQogICAgICAgIHRoaXMudGVtcF9zdHJ1Y3R1cmUgPSB0aGlzLmNoYXQ7CiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5lZGl0aW5kZXgpOwogICAgICAgIC8vICQoJyNlZGl0Ym90bW9kZWwnKS5tb2RhbCgnc2hvdycpOwogICAgfSwKICAgIGVkaXR2YWx1ZShpbmRleCkgewogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2hhdGlucHV0IiArIGluZGV4KS5kaXNhYmxlZCA9ICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2hhdGlucHV0IiArIGluZGV4KS5kaXNhYmxlZDsKICAgIH0sCiAgICBhZGRxdWVzdGlvbigpewogICAgICB2YXIgZWRpdGluZGV4ID0gdGhpcy5lZGl0aW5kZXg7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuc2VsZWN0ZWRfcXVlc3Rpb247CiAgICAgIC8vIGNvbnNvbGUubG9nKGluZGV4KTsKICAgICAgaWYoaW5kZXggPT0gJ2EnKSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCJLaW5kbHkgU2VsZWN0IGEgUXVlc3Rpb24iKTsKICAgICAgfQogICAgICBlbHNlIHsKICAgICAgdGhpcy5jaGF0ID0gW107CiAgICAgIHRoaXMuYm90cXVlc3Rpb25zID0gW107CiAgICAgIGZvcih2YXIgaT0wOyBpPD1pbmRleDtpKyspewogICAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ldLmV2ZW50ID09ICJib3QiKXsKICAgICAgICAgICAgdGhpcy5jaGF0LnB1c2goewogICAgICAgICAgICAgIHJlY2VpdmluZzogdHJ1ZSwKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpXS50ZXh0LAogICAgICAgICAgICAgIGNvbnZlcnNhdGlvbl9vbmx5OiB0cnVlLAogICAgICAgICAgICAgIHRpbWU6IHRoaXMuZ2VuZXJhdGVfdGltZSgpLAogICAgICAgICAgICAgIGV2ZW50OiAiYm90IiwKICAgICAgICAgICAgICBkYXRhIDogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaV0uZGF0YSwKICAgICAgICAgICAgICBtZXRhZGF0YSA6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ldLm1ldGFkYXRhCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmJvdHF1ZXN0aW9ucy5wdXNoKHsKICAgICAgICAgICAgICB2YWx1ZTogaSwKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpXS50ZXh0CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgICBpZih0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpXS5ldmVudCA9PSAidXNlciIpewogICAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpXS50ZXh0LAogICAgICAgICAgICAgICAgc2VuZGluZzogdHJ1ZSwKICAgICAgICAgICAgICAgIHRpbWU6IHRoaXMuZ2VuZXJhdGVfdGltZSgpLAogICAgICAgICAgICAgICAgY29udmVyc2F0aW9uX29ubHk6IHRydWUsCiAgICAgICAgICAgICAgICBkZWxpdmVyZWQ6IHRydWUsCiAgICAgICAgICAgICAgICBkcm9wZG93bjogIiIsCiAgICAgICAgICAgICAgZXZlbnQ6ICJ1c2VyIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgcmVjZWl2aW5nOiB0cnVlLAogICAgICAgIHRleHQ6ICcgICAgICcsCiAgICAgICAgY29udmVyc2F0aW9uX29ubHk6IHRydWUsCiAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgZXZlbnQ6ICJib3QiLAogICAgICAgIGRhdGEgOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpXS5kYXRhLAogICAgICAgIG1ldGFkYXRhIDogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaV0ubWV0YWRhdGEKICAgICAgfSk7CiAgICAgIHZhciBjID0gKGluZGV4KzIpOwogICAgICBpID0gbnVsbDsKICAgICAgLy8gY29uc29sZS5sb2coYyk7CiAgICAgIGZvcih2YXIgaT1jOyBpPD10aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZS5sZW5ndGg7IGkrKyApewogICAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ktMV0uZXZlbnQgPT0gImJvdCIpewogICAgICAgICAgdGhpcy5jaGF0LnB1c2goewogICAgICAgICAgICByZWNlaXZpbmc6IHRydWUsCiAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ktMV0udGV4dCwKICAgICAgICAgICAgY29udmVyc2F0aW9uX29ubHk6IHRydWUsCiAgICAgICAgICAgIHRpbWU6IHRoaXMuZ2VuZXJhdGVfdGltZSgpLAogICAgICAgICAgICBldmVudDogImJvdCIsCiAgICAgICAgICAgIGRhdGEgOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpLTFdLmRhdGEsCiAgICAgICAgICAgIG1ldGFkYXRhIDogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaS0xXS5tZXRhZGF0YQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmJvdHF1ZXN0aW9ucy5wdXNoKHsKICAgICAgICAgICAgdmFsdWU6IGktMiwKICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaS0xXS50ZXh0CiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgICBpZih0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpLTFdLmV2ZW50ID09ICJ1c2VyIil7CiAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaS0xXS50ZXh0LAogICAgICAgICAgICAgIHNlbmRpbmc6IHRydWUsCiAgICAgICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgICAgICAgY29udmVyc2F0aW9uX29ubHk6IHRydWUsCiAgICAgICAgICAgICAgZGVsaXZlcmVkOiB0cnVlLAogICAgICAgICAgICAgIGRyb3Bkb3duOiAiIiwKICAgICAgICAgICAgICBldmVudDogInVzZXIiCgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMudGVtcF9zdHJ1Y3R1cmUgPSB0aGlzLmNoYXQ7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjaGF0aW5wdXQiICsgKGluZGV4KzEpKS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlcXVlc3Rpb24oaW5kZXgpIHsKICAgICAgY29uc29sZS5sb2codGhpcy50ZW1wX3N0cnVjdHVyZSk7CiAgICAgIHRoaXMuY2hhdCA9IFtdOwogICAgICB0aGlzLmJvdHF1ZXN0aW9ucyA9IFtdOwogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnRlbXBfc3RydWN0dXJlKTsKICAgICAgdmFyIGVkaXRpbmRleCA9IHRoaXMuZWRpdGluZGV4OwogICAgICAgZm9yKHZhciBpPTA7IGk8aW5kZXg7aSsrKXsKICAgICAgICAgIGlmKHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0uZXZlbnQgPT0gImJvdCIpewogICAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgICAgcmVjZWl2aW5nOiB0cnVlLAogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0udGV4dCwKICAgICAgICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICAgICAgICB0aW1lOiB0aGlzLmdlbmVyYXRlX3RpbWUoKSwKICAgICAgICAgICAgICBldmVudDogImJvdCIsCiAgICAgICAgICAgICAgZGF0YSA6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0uZGF0YSwKICAgICAgICAgICAgICBtZXRhZGF0YSA6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0ubWV0YWRhdGEKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuYm90cXVlc3Rpb25zLnB1c2goewogICAgICAgICAgICAgIHZhbHVlOiBpLAogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0udGV4dAogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgICAgaWYodGhpcy50ZW1wX3N0cnVjdHVyZVtpXS5ldmVudCA9PSAidXNlciIpewogICAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRlbXBfc3RydWN0dXJlW2ldLnRleHQsCiAgICAgICAgICAgICAgICBzZW5kaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICAgICAgICAgIGRlbGl2ZXJlZDogdHJ1ZSwKICAgICAgICAgICAgICAgIGRyb3Bkb3duOiAiIiwKICAgICAgICAgICAgICAgIGV2ZW50OiAidXNlciIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICB9CiAgICAgICBpID0gbnVsbDsKICAgICAgdmFyIGMgPSBpbmRleCArMTsKICAgICAgZm9yKHZhciBpPWM7IGk8dGhpcy50ZW1wX3N0cnVjdHVyZS5sZW5ndGg7IGkrKyApewogICAgICAgIGlmKHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0uZXZlbnQgPT0gImJvdCIpewogICAgICAgICAgdGhpcy5jaGF0LnB1c2goewogICAgICAgICAgICByZWNlaXZpbmc6IHRydWUsCiAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0udGV4dCwKICAgICAgICAgICAgY29udmVyc2F0aW9uX29ubHk6IHRydWUsCiAgICAgICAgICAgIHRpbWU6IHRoaXMuZ2VuZXJhdGVfdGltZSgpLAogICAgICAgICAgICBldmVudDogImJvdCIsCiAgICAgICAgICAgIGRhdGEgOiB0aGlzLnRlbXBfc3RydWN0dXJlW2ldLmRhdGEsCiAgICAgICAgICAgIG1ldGFkYXRhIDogdGhpcy50ZW1wX3N0cnVjdHVyZVtpXS5tZXRhZGF0YQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmJvdHF1ZXN0aW9ucy5wdXNoKHsKICAgICAgICAgICAgdmFsdWU6IGksCiAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0udGV4dAogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgICAgaWYodGhpcy50ZW1wX3N0cnVjdHVyZVtpXS5ldmVudCA9PSAidXNlciIpewogICAgICAgICAgdGhpcy5jaGF0LnB1c2goewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0udGV4dCwKICAgICAgICAgICAgICBzZW5kaW5nOiB0cnVlLAogICAgICAgICAgICAgIHRpbWU6IHRoaXMuZ2VuZXJhdGVfdGltZSgpLAogICAgICAgICAgICAgIGNvbnZlcnNhdGlvbl9vbmx5OiB0cnVlLAogICAgICAgICAgICAgIGRlbGl2ZXJlZDogdHJ1ZSwKICAgICAgICAgICAgICBkcm9wZG93bjogIiIsCiAgICAgICAgICAgICAgZXZlbnQ6ICJ1c2VyIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMudGVtcF9zdHJ1Y3R1cmUgPSB0aGlzLmNoYXQ7CiAgICB9LAogICAgZmlsdGVydGVtcGxhdGVzKCkgewogICAgICBjb25zb2xlLmxvZyh0aGlzLmNlbnNldGVtcGxhdGVzLCdjZW5zZScpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLmFkbWludGVtcGxhdGVzLCAnYWRtaW4nKTsKICAgICAgLy8gaWYodGhpcy5hZG1pbnRlbXBsYXRlcy5sZW5ndGggPiAwKXsKICAgICAgICBmb3IobGV0IGkgPSAwOyBpPHRoaXMuY2Vuc2V0ZW1wbGF0ZXMubGVuZ3RoOyBpICs9IDEpewogICAgICAgICAgaWYodGhpcy5hZG1pbnRlbXBsYXRlcy5sZW5ndGggPT0gMCl7CiAgICAgICAgICAgIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ2ZpbmFsX3RlbXBsYXRlX2lkJ10gPSB0aGlzLmNlbnNldGVtcGxhdGVzW2ldLnRlbXBsYXRlX2lkOwogICAgICAgICAgICB0aGlzLmNlbnNldGVtcGxhdGVzW2ldWyd0ZW1wbGF0ZV90eXBlJ10gPSAnY2Vuc2UnOwogICAgICAgICAgICAvLyB0aGlzLmNlbnNldGVtcGxhdGVzW2ldWydzdWJzY3JpYmVkJ10gPSBmYWxzZTsKICAgICAgICAgICAgaWYodGhpcy5jZW5zZXRlbXBsYXRlc1tpXS5zdWJzY3JpYmVkID09IGZhbHNlKXsKICAgICAgICAgICAgICAgIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ3N1YnNjcmliZWRfdmFsJ10gPSAiRG9udFN1YnNjcmliZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZih0aGlzLmNlbnNldGVtcGxhdGVzW2ldLnN1YnNjcmliZWQgPT0gdHJ1ZSl7CiAgICAgICAgICAgICAgICB0aGlzLmNlbnNldGVtcGxhdGVzW2ldWydzdWJzY3JpYmVkX3ZhbCddID0gIlN1YnNjcmliZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZXMucHVzaCh0aGlzLmNlbnNldGVtcGxhdGVzW2ldKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmb3IobGV0IGo9MDsgajx0aGlzLmFkbWludGVtcGxhdGVzLmxlbmd0aDsgaiArPSAxKXsKICAgICAgICAgICAgaWYoKCh0aGlzLmFkbWludGVtcGxhdGVzW2pdLmNlbnNlX3RlbXBsYXRlX2lkICE9IG51bGwgfHwgdGhpcy5hZG1pbnRlbXBsYXRlc1tqXS5jZW5zZV90ZW1wbGF0ZV9pZCAhPSB1bmRlZmluZWQpKSAmJiAodGhpcy5hZG1pbnRlbXBsYXRlc1tqXS5jZW5zZV90ZW1wbGF0ZV9pZCA9PSB0aGlzLmNlbnNldGVtcGxhdGVzW2ldLnRlbXBsYXRlX2lkKSl7CiAgICAgICAgICAgICAgdGhpcy5hZG1pbnRlbXBsYXRlc1tqXVsnZmluYWxfdGVtcGxhdGVfaWQnXSA9IHRoaXMuYWRtaW50ZW1wbGF0ZXNbal0udGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgdGhpcy5hZG1pbnRlbXBsYXRlc1tqXVsndGVtcGxhdGVfdHlwZSddID0gJ2FkbWluJzsKICAgICAgICAgICAgICBpZih0aGlzLmFkbWludGVtcGxhdGVzW2pdLnN1YnNjcmliZWQgPT0gZmFsc2UpewogICAgICAgICAgICAgICAgdGhpcy5hZG1pbnRlbXBsYXRlc1tqXVsnc3Vic2NyaWJlZF92YWwnXSA9ICJEb250U3Vic2NyaWJlIjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmFkbWludGVtcGxhdGVzW2pdLnN1YnNjcmliZWQgPT0gdHJ1ZSl7CiAgICAgICAgICAgICAgICB0aGlzLmFkbWludGVtcGxhdGVzW2pdWydzdWJzY3JpYmVkX3ZhbCddID0gIlN1YnNjcmliZSI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVzLnB1c2godGhpcy5hZG1pbnRlbXBsYXRlc1tqXSk7CiAgICAgICAgICAgIH0gZWxzZSBpZigoKHRoaXMuYWRtaW50ZW1wbGF0ZXNbal0uY2Vuc2VfdGVtcGxhdGVfaWQgIT0gbnVsbCB8fCB0aGlzLmFkbWludGVtcGxhdGVzW2pdLmNlbnNlX3RlbXBsYXRlX2lkICE9IHVuZGVmaW5lZCkpKXsKICAgICAgICAgICAgICB0aGlzLmNlbnNldGVtcGxhdGVzW2ldWydmaW5hbF90ZW1wbGF0ZV9pZCddID0gdGhpcy5jZW5zZXRlbXBsYXRlc1tpXS50ZW1wbGF0ZV9pZDsKICAgICAgICAgICAgICBpZih0aGlzLmNlbnNldGVtcGxhdGVzW2ldLnN1YnNjcmliZWQgPT0gZmFsc2UpewogICAgICAgICAgICAgICAgdGhpcy5jZW5zZXRlbXBsYXRlc1tpXVsnc3Vic2NyaWJlZF92YWwnXSA9ICJEb250U3Vic2NyaWJlIjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmNlbnNldGVtcGxhdGVzW2ldLnN1YnNjcmliZWQgPT0gdHJ1ZSl7CiAgICAgICAgICAgICAgICB0aGlzLmNlbnNldGVtcGxhdGVzW2ldWydzdWJzY3JpYmVkX3ZhbCddID0gIlN1YnNjcmliZSI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ3N1YnNjcmliZWQnXSA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ3RlbXBsYXRlX3R5cGUnXSA9ICdjZW5zZSc7CiAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZXMucHVzaCh0aGlzLmNlbnNldGVtcGxhdGVzW2ldKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICB9CiAgICAgICAgfQogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAgIGZvcihsZXQgaSA9IDA7IGk8dGhpcy5jZW5zZXRlbXBsYXRlcy5sZW5ndGg7IGkgKz0gMSl7CiAgICAgIC8vICAgICB0aGlzLnRlbXBsYXRlcyA9IHRoaXMuY2Vuc2V0ZW1wbGF0ZXM7CiAgICAgIC8vICAgfQogICAgICAvLyB9CiAgICAgIGNvbnNvbGUubG9nKHRoaXMudGVtcGxhdGVzKTsKICAgIH0sCiAgICBkZWxldGVfYm90KGluZGV4KSB7CiAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2luZGV4XS50ZW1wbGF0ZV90eXBlID09ICdjZW5zZScpewogICAgICAgIHRvYXN0ci5lcnJvcigiWW91IENhbm5vdCBEZWxldGUgU3VwZXJBZG1pbiBUZW1wbGF0ZXMiKTsKICAgICAgfQogICAgICBlbHNlIGlmKHRoaXMudGVtcGxhdGVzW2luZGV4XS50ZW1wbGF0ZV90eXBlICE9ICdjZW5zZScpewogICAgICBTd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6ICJBcmUgeW91IHN1cmU/IiwKICAgICAgICAgIHRleHQ6ICIgWW91IHdhbnQgdG8gRGVsZXRlIHRoaXMgVGVtcGxhdGU/IiwKICAgICAgICAgIHR5cGU6ICJxdWVzdGlvbiIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIENvbmZpcm0hIgogICAgICB9KQogICAgICAgICAudGhlbiggcmVzdWx0ID0+IHsKICAgICAgICAgICAgaWYocmVzdWx0KXsKICAgICAgICAgICAgICAgYXhpb3MKICAgICAgICAgICAgICAgIC5kZWxldGUoYXBpX2NhbGxzLnBvc3Rfb3Blbl9ib3RfdGVtcGxhdGUoKSwgewogICAgICAgICAgICAgICAgICBwYXJhbXMgOiB7CiAgICAgICAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfaWQ6IHRoaXMudGVtcGxhdGVzW2luZGV4XS5maW5hbF90ZW1wbGF0ZV9pZAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PSAiU3VjY2VzcyIgJiYgcmVzcG9uc2UuZGF0YS5tZXNzYWdlID09ICJRdWVyeSBFeGVjdXRlZCBTdWNjZXNzZnVsbHkiKXsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5nbzsKICAgICAgICAgICAgICAgICAgICB9LCAxMTAwKTsKICAgICAgICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiRGVsZXRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXI6MjAwMCwKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLmdvOwogICAgICAgICAgICAgICAgICAgIH0sIDExMDApOwogICAgICAgICAgICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJTb21lIEVycm9yIE9jY3VycmVkLlBsZWFzZSBUcnkgQWdhaW4iLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lcjoyNTAwLAogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgIH0pOwogICAgICAgfQogICAgfSwKICAgIHN1YnNjcmliZXRlbXBsYXRlKGluZGV4KXsKICAgICAgLy8gZGVidWdnZXI7CiAgICAgIHZhciB4ID0gdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN1YnNjcmliZWQ7CiAgICAgIC8vIHZhciB5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnRlbXBsYXRlX2lkKS52YWx1ZTsKICAgICAgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN1YnNjcmliZWRfdmFsID09ICJTdWJzY3JpYmUiKXsKICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgICB0ZXh0OiAiIFlvdSB3YW50IHRvIHN1YnNjcmliZSB0byB0aGlzIHRlbXBsYXRlPyIsCiAgICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAiWWVzLCBDb25maXJtISIKICAgICAgICB9KQogICAgICAgICAudGhlbiggcmVzdWx0ID0+IHsKICAgICAgICAgICAgaWYocmVzdWx0KXsKICAgICAgICAgICAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2luZGV4XS50ZW1wbGF0ZV90eXBlID09ICdhZG1pbicpewogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2luZGV4XS5maW5hbF90ZW1wbGF0ZV9pZDsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV90eXBlID0gJ2N1c3RvbSc7CiAgICAgICAgICAgICAgICAvLyB2YXIgY2Vuc2VfdGVtcGxhdGVfaWRfYXBpID0gdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLmNlbnNlX3RlbXBsYXRlX2lkOwogICAgICAgICAgICAgICAgfSAgZWxzZSBpZih0aGlzLnRlbXBsYXRlc1tpbmRleF0udGVtcGxhdGVfdHlwZSA9PSAnY2Vuc2UnKXsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9pZF9hcGkgPSB0aGlzLnRlbXBsYXRlc1tpbmRleF0uZmluYWxfdGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVfdHlwZSA9ICdjZW5zZSc7CiAgICAgICAgICAgICAgICAvLyAgdmFyIGNlbnNlX3RlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2luZGV4XS50ZW1wbGF0ZV9pZDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoYXBpX2NhbGxzLm9wZW5fYm90X3RlbXBsYXRlX3N1YnNjcmlwdGlvbigpLCB7CiAgICAgICAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfaWQ6IHRlbXBsYXRlX2lkX2FwaSwKICAgICAgICAgICAgICAgICAgICBzZXRfc3Vic2NyaXB0aW9uIDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlX3R5cGU6IHRlbXBsYXRlX3R5cGUKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgIH0pOwogICAgICB9CiAgICAgIGVsc2UgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN1YnNjcmliZWRfdmFsID09ICJEb250U3Vic2NyaWJlIil7CiAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6ICJBcmUgeW91IHN1cmU/IiwKICAgICAgICAgIHRleHQ6ICIgWW91IGRvbid0IHdhbnQgdG8gc3Vic2NyaWJlIHRvIHRoaXMgdGVtcGxhdGU/IiwKICAgICAgICAgIHR5cGU6ICJxdWVzdGlvbiIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIENvbmZpcm0hIgogICAgICAgIH0pCiAgICAgICAgIC50aGVuKCByZXN1bHQgPT4gewogICAgICAgICAgICBpZihyZXN1bHQpewogICAgICAgICAgICAgICBpZih0aGlzLnRlbXBsYXRlc1tpbmRleF0udGVtcGxhdGVfdHlwZSA9PSAnYWRtaW4nKXsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9pZF9hcGkgPSB0aGlzLnRlbXBsYXRlc1tpbmRleF0uZmluYWxfdGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICB2YXIgY2Vuc2VfdGVtcGxhdGVfaWRfYXBpID0gdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLmNlbnNlX3RlbXBsYXRlX2lkOwogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlX3R5cGUgPSAnY3VzdG9tJzsKICAgICAgICAgICAgICAgIH0gIGVsc2UgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnRlbXBsYXRlX3R5cGUgPT0gJ2NlbnNlJyl7CiAgICAgICAgICAgICAgICB2YXIgY2Vuc2VfdGVtcGxhdGVfaWRfYXBpID0gdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLmZpbmFsX3RlbXBsYXRlX2lkOwogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2luZGV4XS5maW5hbF90ZW1wbGF0ZV9pZDsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV90eXBlID0gJ2NlbnNlJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoYXBpX2NhbGxzLm9wZW5fYm90X3RlbXBsYXRlX3N1YnNjcmlwdGlvbigpLCB7CiAgICAgICAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfaWQ6IHRlbXBsYXRlX2lkX2FwaSwKICAgICAgICAgICAgICAgICAgICBzZXRfc3Vic2NyaXB0aW9uIDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVkOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV90eXBlOiB0ZW1wbGF0ZV90eXBlCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICB9Cn0K"},null]}