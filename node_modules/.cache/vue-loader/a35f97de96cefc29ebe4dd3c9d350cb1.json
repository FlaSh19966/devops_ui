{"remainingRequest":"/home/vimalesh/Elixir/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/Elixir/chatbot-portal/src/portal/Chatbot/Dashboard/ProductManagement/ProductsRanking.vue?vue&type=style&index=0&id=5e21d1d0&scoped=true&lang=css&","dependencies":[{"path":"/home/vimalesh/Elixir/chatbot-portal/src/portal/Chatbot/Dashboard/ProductManagement/ProductsRanking.vue","mtime":1643027096180},{"path":"/home/vimalesh/Elixir/chatbot-portal/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Elixir/chatbot-portal/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/vimalesh/Elixir/chatbot-portal/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/vimalesh/Elixir/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Elixir/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmRhcmtibHVlLWJ0bjpob3ZlciB7CiAgYmFja2dyb3VuZDogIzE5Mjc2NTsKICBjb2xvcjogI2ZmZjsKfQoudGFibGUgdGggewogIGJvcmRlci10b3A6IG5vbmU7Cn0KLnRhYmxlLXJlc3BvbnNpdmUgewogIG1heC1oZWlnaHQ6IDUwMHB4OwogIG92ZXJmbG93LXk6IGF1dG87CiAgYm9yZGVyOiAxcHggc29saWQgI2UzZTJlNTsKfQoudGFibGUtcmVzcG9uc2l2ZSB0aGVhZCB0aCB7CiAgdG9wOiAwOwogIHBvc2l0aW9uOiBzdGlja3k7Cn0KLnRhYmxlLXJlc3BvbnNpdmU6Oi13ZWJraXQtc2Nyb2xsYmFyIHsKICBtYXgtaGVpZ2h0OiAxMHB4OwogIHdpZHRoOiA3cHg7CiAgaGVpZ2h0OiA3cHg7CiAgYm9yZGVyLXJhZGl1czogMTBweDsKICBvdmVyZmxvdy14OiBoaWRkZW47Cn0KLnRhYmxlLXJlc3BvbnNpdmU6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsKICBiYWNrZ3JvdW5kOiAjZmZmZmZmOwogIGJvcmRlci1yYWRpdXM6IDEwcHg7Cn0KLnRhYmxlLXJlc3BvbnNpdmU6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsKICBiYWNrZ3JvdW5kOiAjMjczOTdiOwogIGJvcmRlci1yYWRpdXM6IDEwcHg7Cn0KLnRhYmxlLXJlc3BvbnNpdmU6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsKICBiYWNrZ3JvdW5kOiAjMTkyOTVmOwogIGJvcmRlci1yYWRpdXM6IDEwcHg7Cn0K"},{"version":3,"sources":["ProductsRanking.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProductsRanking.vue","sourceRoot":"src/portal/Chatbot/Dashboard/ProductManagement","sourcesContent":["<template>\n  <div>\n    <div class=\"spinner\" id=\"spinner\" v-show=\"spinnerOn\"></div>\n    <div id=\"products_ranking_radio\" class=\"p-0 ml-0\" style=\"max-height: 500px;\">\n      <div class=\"col-sm-12 d-flex mb-3 p-0\">\n        <!-- <div class=\"col-sm-6\" style=\"text-align: center;\">\n        <h4 class=\"mb-sm-0\">Most Saleable Products</h4>\n        </div>\n        <div class=\"col-sm-6\" style=\"text-align: center;\">\n        <h4 class=\"mb-sm-0\">Least Saleable Products</h4>\n        </div> -->\n        <div class=\"radio my-auto\">\n          <label>\n            <input\n              type=\"radio\"\n              v-model=\"filter_products\"\n              value=\"Most\"\n            />\n            <span class=\"icn\" id=\"filter_portal_user_radio\"></span>\n            Most Saleable Products\n          </label>\n          <label>\n            <input\n              type=\"radio\"\n              v-model=\"filter_products\"\n              value=\"Least\"\n            />\n            <span class=\"icn\"></span> Least Saleable Products\n          </label>\n          <label>\n            <input\n              type=\"radio\"\n              v-model=\"filter_products\"\n              value=\"Unsold\"\n            />\n            <span class=\"icn\" id=\"filter_portal_user_radio\"></span>\n            Unsold Products\n          </label>\n        </div>\n        <div class=\"form-group mb-0 ml-auto\" style=\"width: 135px\">\n          <select\n            class=\"form-control\"\n            style=\"padding: 5px 0px\"\n            @change=\"fetch_products_ranking\"            \n            id=\"exampleFormControlSelect1\"\n          >\n            <option>Last 30 days</option>\n            <option>Last 3 months</option>\n            <option>Last 6 months</option>\n            <option>Last 12 months</option>\n          </select>\n        </div>\n        <a\n          href=\"#\"\n          class=\"darkblue-btn\"\n          @click=\"download_csv\"\n          title=\"Download CSV report\"\n          style=\"padding: 4px 13px; height: 33px; margin-left: 10px;\"\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n            width=\"14\"\n            height=\"14\"\n          >\n            <path\n              d=\"M8.124046569796448,3.7048888423811563 V-0.0004725085692590319 H0.8684480275323758 C0.385950724471816,-0.0004725085692590319 -0.0022237975393094665,0.29105224477757613 -0.0022237975393094665,0.6534147886572829 v12.641821079713173 c0,0.3623625438797103 0.3881745220111289,0.6538872972265442 0.8706718250716886,0.6538872972265442 h12.18940555100364 c0.4824973030605619,0 0.8706718250716886,-0.2915247533468346 0.8706718250716886,-0.6538872972265442 V4.358776139607697 H8.994718394868137 c-0.47886950378942883,0 -0.8706718250716886,-0.2942492837519449 -0.8706718250716886,-0.6538872972265442 zm2.773452542780442,5.758567464241761 l-3.497924057225508,2.6073755976908415 c-0.24124865153028063,0.18009145977781071 -0.6308742932498614,0.18009145977781071 -0.872122944780142,0 l-3.497924057225508,-2.6073755976908415 C2.661306427325829,9.189096094828278 2.9196057354304337,8.718024787784655 3.437655471348084,8.718024787784655 H5.802255036271947 v-2.1796243240884783 c0,-0.24084848781177734 0.2597504278130543,-0.4359248648176966 0.5804478833811269,-0.4359248648176966 h1.1608957667622521 c0.3206974555680725,0 0.5804478833811269,0.1950763770059196 0.5804478833811269,0.4359248648176966 v2.1796243240884783 h2.3645995649238625 c0.5180497359176551,0 0.7763490440222554,0.47107130704362293 0.4088529778565816,0.7454315188382611 zM13.674579454628462,2.86028441679687 L10.122963968190199,0.1902446197884852 c-0.16325096720094195,-0.12260386822997718 -0.38454672273999646,-0.1907171283577423 -0.6167258760924463,-0.1907171283577423 H9.284942336558702 v3.4873989185415644 h4.643583067049007 v-0.16619635471174685 c0,-0.1716454155219681 -0.09069498177830096,-0.33784177023371487 -0.2539459489792431,-0.46044563846369135 z\"\n              fill=\"#fff\"\n            />\n          </svg>\n        </a>\n        <button @click=\"show_swal_notification()\"\n         class=\"darkblue-btn\"\n         style=\"margin-left: 10px; cursor: pointer; font-size: 1rem; padding: 6px 15px;\">Send Report\n        </button>\n      </div>\n    </div>\n    <div v-if=\"Boolean(most_products_list.length===0 && unsold_products_list.length===0) && !spinnerOn\">\n      <p class=\"text-center\">\n        <br>\n        <strong>\n          Couldn't find any data regarding orders/sales\n        </strong>\n      </p>\n    </div>\n    <div v-else class=\"col-sm-12 d-flex p-0\">\n      <div class=\"p-0\" style=\"width: 100%\">\n        <div class=\"table-box\">\n          <div class=\"table-responsive\">\n          <table class=\"table table-bordered\">\n            <thead>\n              <tr>\n                <th style=\"color: #414141;\" scope=\"col\">#</th>\n                <th style=\"text-align: left; color: #414141;\" scope=\"col\">PRODUCT NAME</th>\n                <th style=\"text-align: center; color: #414141;\" scope=\"col\">VARIANT</th>\n                <th style=\"color: #414141;\" scope=\"col\">QUANTITY SOLD</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(products, index) in products_list\" :key=\"index\">\n                <td style=\"text-align: center;\">{{ index + 1 }}</td>\n                <td style=\"width: 200px\">{{ products.title }}</td>\n                <td style=\"text-align: center; width: 100px\">{{ products.variant_title }}</td>\n                <td style=\"text-align: center; width: 105px\">\n                  {{ products.quantity }}\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          </div>\n        </div>\n        <!-- </div> -->\n        <!-- <div class=\"col-sm-6\">\n          <div class=\"table-box\">\n                <table class=\"table\">\n                  <thead>\n                    <tr>\n                      <th scope=\"col\">#</th>\n                      <th scope=\"col\">Product Name</th>\n                      <th scope=\"col\">Variant</th>\n                      <th scope=\"col\">Quantity Sold</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr\n                    v-for=\"(products, index) in products_list\"\n                      :key=\"index\"\n                    >\n                      <td>{{ index + 1 }}</td>\n                      <td>{{ products.title }}</td>\n                      <td style=\"width: 100px;\">{{ products.variant_title }}</td>\n                      <td style=\"text-align: center; width: 105px;\">{{ products.quantity }}</td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n        </div> -->\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport api_calls from \"@/portal/api_calls.js\";\nimport Swal from \"sweetalert2\";\nimport { freeze_portal,show_subscription_expired_swal } from \"@/portal/mixins\";\n\nexport default {\n  name: \"ProductsRankingPage\",\n  mixins: [\n    freeze_portal,\n    show_subscription_expired_swal\n  ],\n  data() {\n    return {\n      spinnerOn: false,\n      company_id: this.$session.get(\"UserInformation\").company_id,\n      company_name: this.$session.get(\"UserInformation\").company_name,\n      months: 10,\n      products_list: null,\n      most_products_list: [],\n      least_products_list: [],\n      unsold_products_list: [],\n      filter_products: \"Most\",\n      disable_btn_expired: false,\n    };\n  },\n  mounted() {\n    this.fetch_products_ranking();\n    setTimeout(() => {\n      this.freeze_portal();\n    }, 1000);\n    this.$root.$on(\"ProductsRankingPageDisabled\", (data) => {\n      if(data===true){\n        this.disable_btn_expired = true;\n      }\n    });\n\n  },\n  watch: {\n    filter_products() {\n      if (this.filter_products == \"Most\") {\n          this.products_list = this.most_products_list;\n      } else if (this.filter_products == \"Least\") {\n          this.products_list = this.least_products_list;\n      } else if (this.filter_products == \"Unsold\") {\n          this.products_list = this.unsold_products_list;\n      }\n    },\n  },\n  methods: {\n    download_csv() {\n      this.spinnerOn = true;\n      var rows = [];\n      var filename = \"\";\n\n      var csv = \"product_id,quantity,title,variant_id,variant_title\\n\";\n      if(this.filter_products == 'Most'){\n        filename = \"Most saleable products report.csv\";\n      }else if(this.filter_products == 'Least'){\n        filename = \"Least saleable products report.csv\";\n      }else if(this.filter_products == 'Unsold'){\n        filename = \"Unsold products report.csv\";\n      }\n\n      rows = this.products_list.map((obj) => Object.values(obj));\n      rows.forEach(function (row) {\n        csv += row.join(\",\");\n        csv += \"\\n\";\n      });\n\n      var hiddenElement = document.createElement(\"a\");\n      hiddenElement.href = \"data:text/csv;charset=utf-8,\" + encodeURI(csv);\n      hiddenElement.target = \"_blank\";\n      hiddenElement.download = filename;\n      hiddenElement.click();\n      this.spinnerOn = false;\n    },\n    fetch_products_ranking() {\n      this.spinnerOn = true;\n      if (event.target.value == \"Last 30 days\") {\n        this.months = 1;\n      } else if (event.target.value == \"Last 3 months\") {\n        this.months = 3;\n      } else if (event.target.value == \"Last 6 months\") {\n        this.months = 6;\n      } else if (event.target.value == \"Last 12 months\") {\n        this.months = 12;\n      } else if (event.target.value == undefined) {\n        this.months = 1;\n      }\n      axios\n        .post(api_calls.products_report(), {\n          company_id: this.company_id,\n          company_name: this.company_name,\n          records_timeline: this.months,\n          is_get: true,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n          },\n        })\n        .then(({ data }) => {\n          this.spinnerOn = false;\n            this.most_products_list = data.sorted_list;\n            this.least_products_list = [...data.sorted_list].reverse();\n            this.unsold_products_list = data.unsold;\n            if(this.filter_products == \"Most\"){\n              this.products_list = this.most_products_list;\n            }else if(this.filter_products == \"Least\"){\n              this.products_list = this.least_products_list;\n            }else if(this.filter_products == \"Unsold\"){\n              this.products_list = this.unsold_products_list;\n            }\n        }).catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n        });\n    },\n    show_swal_notification(){\n      if(!this.disable_btn_expired){\n        Swal.fire({\n            title: 'Are you sure?',\n            text: \"You want to send a report                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \",\n            icon: 'warning',\n            showCancelButton: true,\n            confirmButtonColor: '#3085d6',\n            cancelButtonColor: '#d33',\n            confirmButtonText: 'Yes, I Want'\n        }).then((result) => {\n          if (result.value == true) {\n            this.send_report()\n          }\n        })\n      }else {\n        this.show_subscription_expired_swal();\n      }\n    },\n    send_report(){\n      this.spinnerOn = true;\n      // console.log(this.filter_products);\n      axios\n        .post(api_calls.products_report(), {\n          company_id: this.company_id,\n          company_name: this.company_name,\n          records_timeline: this.months,\n          is_send: true,\n          report_type: this.filter_products\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n          },\n        })\n        .then(({ data }) => {\n          this.spinnerOn = false;\n          if(data.message == \"REPORT IS BEING SENT\"){\n            Swal({\n                type: \"success\",\n                text: \"An Email will be sent to your registered address\",\n                allowOutsideClick: false,\n                allowEscapeKey: false,\n                timer: 2500,\n              });\n          }\n          else if(data.message == \"Internal Server Error\"){\n            Swal({\n                type: \"Internal Server Error\",\n                allowOutsideClick: false,\n                allowEscapeKey: false,\n                timer: 2500,\n              });\n          }\n        }).catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n        });\n    },\n  },\n};\n</script>\n<style scoped>\n.darkblue-btn:hover {\n  background: #192765;\n  color: #fff;\n}\n.table th {\n  border-top: none;\n}\n.table-responsive {\n  max-height: 500px;\n  overflow-y: auto;\n  border: 1px solid #e3e2e5;\n}\n.table-responsive thead th {\n  top: 0;\n  position: sticky;\n}\n.table-responsive::-webkit-scrollbar {\n  max-height: 10px;\n  width: 7px;\n  height: 7px;\n  border-radius: 10px;\n  overflow-x: hidden;\n}\n.table-responsive::-webkit-scrollbar-track {\n  background: #ffffff;\n  border-radius: 10px;\n}\n.table-responsive::-webkit-scrollbar-thumb {\n  background: #27397b;\n  border-radius: 10px;\n}\n.table-responsive::-webkit-scrollbar-thumb:hover {\n  background: #19295f;\n  border-radius: 10px;\n}\n</style>"]}]}