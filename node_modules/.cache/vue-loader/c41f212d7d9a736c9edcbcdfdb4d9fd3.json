{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Customer Support/LiveChat.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Customer Support/LiveChat.vue","mtime":1645594423483},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBzd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IHsgU29ja2V0IH0gZnJvbSAicGhvZW5peC1zb2NrZXQiOwppbXBvcnQgeyBzZXRJbnRlcnZhbCB9IGZyb20gInRpbWVycyI7CmltcG9ydCBkZWJvdW5jZSBmcm9tICJ2dWUtZGVib3VuY2UvZGlzdC9kZWJvdW5jZS5taW4uanMiOwppbXBvcnQgeyBnZW5lcmF0ZV90aW1lIH0gZnJvbSAiQC9wb3J0YWwvbWl4aW5zIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcl9saXN0OiBbXSwKICAgICAgY3VycmVudF91c2VyOiB7fSwKICAgICAgY3VycmVudF9jaGFubmVsOiAiIiwKICAgICAgZmlyc3RfbmFtZTogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJGaXJzdE5hbWUiKQogICAgICAgID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJGaXJzdE5hbWUiKQogICAgICAgIDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmZpcnN0X25hbWUsCiAgICAgIGxhc3RfbmFtZTogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJMYXN0TmFtZSIpCiAgICAgICAgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckxhc3ROYW1lIikKICAgICAgICA6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5sYXN0X25hbWUsCiAgICAgIGFnZW50X3VzZXJuYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgIGNoYXRfbGlzdDogW10sCiAgICAgIHRvX3NlbmQ6ICIiLAogICAgICBjaDogbnVsbCwKICAgICAgbWVzc2FnZTogbnVsbCwKICAgICAgdXNlcl9jaGFubmVsczoge30sCiAgICAgIHNvY2tldDogbnVsbCwKICAgICAgbXNnX3NlbmRlcjogIiIsCiAgICAgIGRlbGF5OiAxMDAwMCwKICAgICAgaXNfdHlwaW5nX2luZGljYXRvcl9vbjogZmFsc2UsCiAgICAgIC8vIHVzZXJfbGlzdDogW3siY2hhbm5lbF9uYW1lIjoiY3VzdG9tZXJzX2dyb3VwczpkaHM2YmVubmtsIiwidXNlcm5hbWUiOiJWaW1sZXNoaCIsImlzX2Nvbm5lY3RlZCI6ZmFsc2UsImFnZW50X3VzZXJuYW1lIjpudWxsLCJhZ2VudF9yb2xlIjpudWxsLCJzdGF0ZSI6IndhaXRpbmcifSx7ImNoYW5uZWxfbmFtZSI6ImN1c3RvbWVyc19ncm91cHM6aGVtemFzdG5oZSIsInVzZXJuYW1lIjoiQWtzaGF5IiwiaXNfY29ubmVjdGVkIjpmYWxzZSwiYWdlbnRfdXNlcm5hbWUiOm51bGwsImFnZW50X3JvbGUiOm51bGwsInN0YXRlIjoid2FpdGluZyJ9XQogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICB0b19zZW5kKG5ld1ZhbCkgewogICAgICB0aGlzLmJ1dHRvbl9maWxsKCk7CiAgICB9LAogIH0sCiAgbWl4aW5zOiBbZ2VuZXJhdGVfdGltZV0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuc29ja2V0ID0gbmV3IFNvY2tldChwcm9jZXNzLmVudi5WVUVfQVBQX0xJVkVfQ0hBVF9XRUJTT0NLRVRfRU5EUE9JTlQsIHsKICAgICAgcGFyYW1zOiB7CiAgICAgICAgdXNlcm5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICByb2xlOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucm9sZQogICAgICB9LAogICAgfSk7CiAgICB0aGlzLnNvY2tldC5jb25uZWN0KCk7CiAgICB0aGlzLmNoID0gdGhpcy5zb2NrZXQuY2hhbm5lbCgKICAgICAgImNvbXBhbmllczoiICsgdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZQogICAgKTsKICAgIHRoaXMuY2guam9pbigpOwoKICAgIHRoaXMuY2gub24oJ25ld19uYW1lJywgKHJlcykgPT4gewogICAgICB2YXIgY2hlY2sgPSB0aGlzLnVzZXJfbGlzdC5zb21lKG9iaiA9PiBvYmouY2hhbm5lbF9uYW1lID09PSByZXMudG9waWMpCiAgICAgIHZhciBpbmRleCA9IHRoaXMudXNlcl9saXN0LmZpbmRJbmRleChvYmogPT4gb2JqLmNoYW5uZWxfbmFtZSA9PT0gcmVzLnRvcGljKTsKICAgICAgaWYoY2hlY2spIHRoaXMudXNlcl9saXN0W2luZGV4XS51c2VybmFtZSA9IHJlcy5uYW1lOwogICAgfSkKICAgIHRoaXMuY2gub24oImN1c3RvbWVyX2dyb3VwX3ByZXNlbmNlIiwgKHJlcykgPT4geyAKICAgICAgY29uc29sZS5sb2coImN1c3RvbWVyIGdyb3VwIGludGVydmFsIHVwZGF0ZSIsIHJlcyk7CiAgICAgIHZhciB0ZW1wID0gcmVzOwogICAgICBmb3IgKHZhciBpIGluIHRlbXAubWV0YXMpIHsKICAgICAgICBpZiAoQm9vbGVhbih0ZW1wLm1ldGFzW2ldLnVzZXJfaW5mby5pc19jdXN0b21lcikpIHsKICAgICAgICAgICAgdmFyIGNoYW5uZWxfZ3JvdXAgPSAiY3VzdG9tZXJzX2dyb3VwczoiICsgdGVtcC5tZXRhc1tpXS51c2VyX2luZm8uY3VzdG9tZXJfZ3JvdXBfbmFtZTsKICAgICAgICAgICAgdmFyIGNoZWNrID0gdGhpcy51c2VyX2xpc3Quc29tZShvYmogPT4gb2JqLmNoYW5uZWxfbmFtZSA9PT0gY2hhbm5lbF9ncm91cCkKICAgICAgICAgICAgLy8gdGhpcy51c2VyX2NoYW5uZWxzW2NoYW5uZWxfZ3JvdXBdID0gdGhpcy5zb2NrZXQuY2hhbm5lbChyZXMuY3VzdG9tZXJfY2hhdF9ncm91cCk7CiAgICAgICAgICAgIGlmIChjaGVjaykgewogICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMudXNlcl9saXN0LmZpbmRJbmRleChvYmogPT4gb2JqLmNoYW5uZWxfbmFtZSA9PT0gY2hhbm5lbF9ncm91cCk7CiAgICAgICAgICAgICAgaWYgKHRlbXAubWV0YXMubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgICAgdGhpcy51c2VyX2xpc3RbaW5kZXhdLmlzX2Nvbm5lY3RlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB0aGlzLnVzZXJfbGlzdFtpbmRleF0uYWdlbnRfcm9sZSA9IHRlbXAubWV0YXNbMV0udXNlcl9pbmZvLnJvbGU7CiAgICAgICAgICAgICAgICB0aGlzLnVzZXJfbGlzdFtpbmRleF0uYWdlbnRfdXNlcm5hbWUgPSB0ZW1wLm1ldGFzWzFdLnVzZXJfaW5mby51c2VybmFtZTsKICAgICAgICAgICAgICAgIHRoaXMudXNlcl9saXN0W2luZGV4XS5zdGF0ZSA9PSAiZW5kZWQiID8gImVuZGVkIiA6ICJqb2luZWQiOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLnVzZXJfbGlzdFtpbmRleF0uaXNfY29ubmVjdGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnVzZXJfbGlzdFtpbmRleF0uYWdlbnRfcm9sZSA9IG51bGw7CiAgICAgICAgICAgICAgICB0aGlzLnVzZXJfbGlzdFtpbmRleF0uYWdlbnRfdXNlcm5hbWUgPSBudWxsOwogICAgICAgICAgICAgICAgdGhpcy51c2VyX2xpc3RbaW5kZXhdLnN0YXRlID09ICJlbmRlZCIgPyAiZW5kZWQiIDogIndhaXRpbmciOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLnVzZXJfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICJjaGFubmVsX25hbWUiOiBjaGFubmVsX2dyb3VwLAogICAgICAgICAgICAgICAgInVzZXJuYW1lIjogIiIsCiAgICAgICAgICAgICAgICAiaXNfY29ubmVjdGVkIjogZmFsc2UsCiAgICAgICAgICAgICAgICAiYWdlbnRfdXNlcm5hbWUiOiBudWxsLAogICAgICAgICAgICAgICAgImFnZW50X3JvbGUiOiBudWxsLAogICAgICAgICAgICAgICAgInN0YXRlIjogIndhaXRpbmciCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICB0aGlzLnVzZXJfY2hhbm5lbHNbY2hhbm5lbF9ncm91cF0gPSB0aGlzLnNvY2tldC5jaGFubmVsKAogICAgICAgICAgICAgICAgY2hhbm5lbF9ncm91cAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0pCgogICAgdGhpcy5jaC5vbigiY3VzdG9tZXJfbmVlZHNfc3VwcG9ydF9hZ2VudCIsIChyZXMpID0+IHsKICAgICAgY29uc29sZS5sb2coInVzZXJjaGFubmVsIikKICAgICAgLy8gdGhpcy51c2VyX2xpc3QucHVzaCh7CiAgICAgIC8vICAgY2hhbm5lbF9uYW1lOiByZXMuY3VzdG9tZXJfY2hhdF9ncm91cCwKICAgICAgLy8gICB1c2VybmFtZTogIiIsCiAgICAgIC8vICAgaXNfY29ubmVjdGVkOiBmYWxzZQogICAgICAvLyB9KTsKICAgICAgLy8gdGhpcy5jdXJyZW50X3VzZXIgPSByZXMuY3VzdG9tZXJfY2hhdF9ncm91cDsKICAgICAgLy8gdGhpcy5jdXJyZW50X3VzZXIgPSAiQ3VzdG9tZXIiOwogICAgICAvLyB0aGlzLmN1cnJlbnRfY2hhbm5lbCA9IHJlcy5jdXN0b21lcl9jaGF0X2dyb3VwOwogICAgICB0aGlzLnVzZXJfY2hhbm5lbHNbcmVzLmN1c3RvbWVyX2NoYXRfZ3JvdXBdID0gdGhpcy5zb2NrZXQuY2hhbm5lbCgKICAgICAgICByZXMuY3VzdG9tZXJfY2hhdF9ncm91cAogICAgICApOwogICAgICB0aGlzLm1lc3NhZ2UgPSB0aGlzLnNvY2tldC5jaGFubmVsKHJlcy5jdXN0b21lcl9jaGF0X2dyb3VwKTsKCiAgICAgIHRoaXMudXNlcl9jaGFubmVsc1tyZXMuY3VzdG9tZXJfY2hhdF9ncm91cF0ub24oInN0YXJ0ZWRfdHlwaW5nIiwKICAgICAgICAodHlwaW5nX3Jlc3BvbnNlKSA9PiB7CiAgICAgICAgICBpZiAocmVzLmN1c3RvbWVyX2NoYXRfZ3JvdXAgPT0gdGhpcy5jdXJyZW50X3VzZXIuY2hhbm5lbF9uYW1lKSB7CiAgICAgICAgICAgIGlmICh0eXBpbmdfcmVzcG9uc2Uuc2VuZGVyICE9ICJzdXBwb3J0X2FnZW50IikgewogICAgICAgICAgICAgIHZhciBuYW1lID0gdGhpcy51c2VyX2xpc3QuZmlsdGVyKCh1c2VyKSA9PiB7CiAgICAgICAgICAgICAgICByZXR1cm4gdXNlci5jaGFubmVsX25hbWUgPT0gcmVzLmN1c3RvbWVyX2NoYXRfZ3JvdXA7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgaWYgKG5hbWVbMF0udXNlcm5hbWUgPT0gIiIpIHsKICAgICAgICAgICAgICAgIHRoaXMubXNnX3NlbmRlciA9IHR5cGluZ19yZXNwb25zZS5zZW5kZXI7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMubXNnX3NlbmRlciA9IG5hbWVbMF0udXNlcm5hbWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuaXNfdHlwaW5nX2luZGljYXRvcl9vbiA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICApOwogICAgICB0aGlzLnVzZXJfY2hhbm5lbHNbcmVzLmN1c3RvbWVyX2NoYXRfZ3JvdXBdLm9uKCJzdG9wcGVkX3R5cGluZyIsICgpID0+IHsKICAgICAgICB0aGlzLmlzX3R5cGluZ19pbmRpY2F0b3Jfb24gPSBmYWxzZTsKICAgICAgfSk7CiAgICAgIHRoaXMudXNlcl9jaGFubmVsc1tyZXMuY3VzdG9tZXJfY2hhdF9ncm91cF0ub24oIm5ld19jaGF0X21lc3NhZ2UiLAogICAgICAgIChyZXNwb25zZSkgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLnNlbmRlciA9PSAiY3VzdG9tZXIiKSB7CiAgICAgICAgICAgIHRoaXMuY2hhdF9saXN0LnB1c2goewogICAgICAgICAgICAgIHJlY2VpdmVkOiB0cnVlLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLm1lc3NhZ2UsCiAgICAgICAgICAgICAgY3VycmVudF9jaGFubmVsOiByZXMuY3VzdG9tZXJfY2hhdF9ncm91cCwKICAgICAgICAgICAgICB0aW1lOiB0aGlzLmdlbmVyYXRlX3RpbWUoKSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMudXBkYXRlX3Njcm9sbGJhcigpOwogICAgICAgICAgICB0aGlzLm5vX3Jlc3BvbnNlKHRoaXMpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgKTsKICAgICAgLy8gdGhpcy51c2VyX2NoYW5uZWxzW3Jlcy5jdXN0b21lcl9jaGF0X2dyb3VwXS5vbigibmV3X25hbWUiLCAocmVzcCkgPT4gewogICAgICAvLyAgIGZvciAobGV0IGkgPSAwLCBuID0gdGhpcy51c2VyX2xpc3QubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgIC8vICAgICBpZiAodGhpcy51c2VyX2xpc3RbaV0uY2hhbm5lbF9uYW1lID09IHJlcy5jdXN0b21lcl9jaGF0X2dyb3VwKSB7CiAgICAgIC8vICAgICAgIHRoaXMudXNlcl9saXN0W2ldLnVzZXJuYW1lID0gcmVzcC5uYW1lOwogICAgICAvLyAgICAgfQogICAgICAvLyAgIH0KICAgICAgLy8gICB0aGlzLmN1cnJlbnRfdXNlciA9IHJlc3AubmFtZTsKICAgICAgLy8gICB0aGlzLm5vX3Jlc3BvbnNlKHRoaXMpOwogICAgICAvLyB9KTsKICAgICAgdGhpcy51c2VyX2NoYW5uZWxzW3Jlcy5jdXN0b21lcl9jaGF0X2dyb3VwXS5vbigic3RvcHBlZF9jaGF0IiwgKHJlc3ApID0+IHsKICAgICAgICB0aGlzLmNoYXRfbGlzdC5wdXNoKHsKICAgICAgICAgIHJlY2VpdmVkOiB0cnVlLAogICAgICAgICAgdGV4dDogcmVzcC5uYW1lICsgcmVzcC5tZXNzYWdlLAogICAgICAgICAgY3VycmVudF9jaGFubmVsOiByZXNwLnRvcGljLAogICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy51cGRhdGVfc2Nyb2xsYmFyKCk7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiByZXMubmFtZSArIHJlcy5tZXNzYWdlLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogImluZm8iLAogICAgICAgICAgdGltZXI6IDUwMDAsCiAgICAgICAgfSk7CiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy51c2VyX2xpc3QuZmluZEluZGV4KG9iaiA9PiBvYmouY2hhbm5lbF9uYW1lID09PSByZXNwLnRvcGljKTsKICAgICAgICB0aGlzLnVzZXJfbGlzdFtpbmRleF0uYWdlbnRfdXNlcm5hbWUgPSB0aGlzLmFnZW50X3VzZXJuYW1lOwogICAgICAgIHRoaXMudXNlcl9saXN0W2luZGV4XS5pc19jb25uZWN0ZWQgPSB0cnVlOwogICAgICAgIHRoaXMudXNlcl9saXN0W2luZGV4XS5zdGF0ZSA9ICJlbmRlZCI7CiAgICAgICAgLy8gdG9hc3RyLmluZm8ocmVzcC5uYW1lICsgIiAiICsgcmVzcC5tZXNzYWdlKTsKICAgICAgICAvLyB0aGlzLnVzZXJfbGlzdCA9IHRoaXMudXNlcl9saXN0LmZpbHRlcigodXNlcikgPT4gewogICAgICAgIC8vICAgcmV0dXJuIHVzZXIudXNlcm5hbWUgIT0gcmVzcC5uYW1lOwogICAgICAgIC8vIH0pOwogICAgICAgIC8vIHRoaXMuY2hhdF9saXN0ID0gdGhpcy5jaGF0X2xpc3QuZmlsdGVyKChjaGF0KSA9PiB7CiAgICAgICAgLy8gICByZXR1cm4gY2hhdC5jdXJyZW50X2NoYW5uZWwgIT0gdGhpcy5jdXJyZW50X2NoYW5uZWw7CiAgICAgICAgLy8gfSk7CiAgICAgICAgLy8gdGhpcy5jdXJyZW50X3VzZXIgPSB0aGlzLmZpcnN0X25hbWU7CiAgICAgIH0pOwoKICAgICAgLy8gdGhpcy51c2VyX2NoYW5uZWxzW3Jlcy5jdXN0b21lcl9jaGF0X2dyb3VwXS5qb2luKCk7CiAgICB9KTsKICB9LAogIGJlZm9yZURlc3Ryb3koKXsgCiAgICB0aGlzLmNoLmxlYXZlKCk7CiAgICAvL2Rpc2Nvbm5lY3QgYWxsIGN1c3RvbWVyIHdoZW4gU0EgbmF2aWdhdGVzIHRvIG90aGVyIHBhZ2UKICAgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBpbiB0aGlzLnVzZXJfY2hhbm5lbHMpIHsKICAgICAgdGhpcy51c2VyX2NoYW5uZWxzW3Byb3BlcnR5XS5wdXNoKCJzdG9wcGVkX2NoYXQiLCB7CiAgICAgICAgICBuYW1lOiAiU3VwcG9ydCBBZ2VudCIsCiAgICAgICAgICBtZXNzYWdlOiAiaGFzIGVuZGVkIHRoaXMgY29udmVyc2F0aW9uLiIsCiAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy51c2VyX2NoYW5uZWxzW3Byb3BlcnR5XS5sZWF2ZSgpOwogICAgICB9CiAgICB0aGlzLnNvY2tldC5kaXNjb25uZWN0KCk7IAogIH0sCiAgbWV0aG9kczogewogICAgam9pbl9jdXN0b21lcihyZXMpIHsKICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgdGhpcy51c2VyX2NoYW5uZWxzW3Jlcy5jaGFubmVsX25hbWVdLmpvaW4oKTsKICAgICAgdmFyIGluZGV4ID0gdGhpcy51c2VyX2xpc3QuZmluZEluZGV4KG9iaiA9PiBvYmouY2hhbm5lbF9uYW1lID09PSByZXMuY2hhbm5lbF9uYW1lKTsKICAgICAgdGhpcy51c2VyX2xpc3RbaW5kZXhdLmFnZW50X3VzZXJuYW1lID0gdGhpcy5hZ2VudF91c2VybmFtZTsKICAgICAgdGhpcy51c2VyX2xpc3RbaW5kZXhdLmlzX2Nvbm5lY3RlZCA9IHRydWU7CiAgICAgIHRoaXMudXNlcl9saXN0W2luZGV4XS5zdGF0ZSA9ICJqb2luZWQiOwogICAgICB0aGlzLmNoLm9uKCJjdXN0b21lcl9ncm91cF9wcmVzZW5jZSIsIChyZXMpID0+IHsgCiAgICAgIH0pCiAgICB9LAogICAgYnV0dG9uX2ZpbGwoKSB7CiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoInN2ZyIpLnN0eWxlLmZpbGwgPSAiIzI3MzY3OSI7CiAgICAgIGlmICh0aGlzLnRvX3NlbmQgPT0gIiIpIHsKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJzdmciKS5zdHlsZS5maWxsID0gIiM4YThhOGE2MyI7CiAgICAgIH0gZWxzZSBpZiAodGhpcy50b19zZW5kICE9ICIiKSB7CiAgICAgICAgdGhpcy51c2VyX2NoYW5uZWxzW3RoaXMuY3VycmVudF91c2VyLmNoYW5uZWxfbmFtZV0ucHVzaCgic3RhcnRlZF90eXBpbmciKTsKICAgICAgfQogICAgICB0aGlzLnN0b3BfdHlwaW5nKHRoaXMpOwogICAgfSwKICAgIHN0b3BfdHlwaW5nOiBkZWJvdW5jZShmdW5jdGlvbiAodm0pIHsKICAgICAgdm0udXNlcl9jaGFubmVsc1t2bS5jdXJyZW50X3VzZXIuY2hhbm5lbF9uYW1lXS5wdXNoKCJzdG9wcGVkX3R5cGluZyIpOwogICAgfSwgNTAwMCksCiAgICBub19yZXNwb25zZTogZGVib3VuY2UoZnVuY3Rpb24gKHZtKSB7CiAgICAgIHZtLnVzZXJfY2hhbm5lbHNbdm0uY3VycmVudF91c2VyLmNoYW5uZWxfbmFtZV0ucHVzaCgibm9fcmVzcG9uc2UiLCB7CiAgICAgICAgc2VuZGVyOiAic2VuZGVyIiwKICAgICAgfSk7CiAgICB9LCAxMDAwMCksCiAgICBzZW5kX21lc3NhZ2UoKSB7CiAgICAgIGlmICh0aGlzLnRvX3NlbmQgIT0gIiIgJiYgdGhpcy51c2VyX2xpc3QubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuY2hhdF9saXN0LnB1c2goewogICAgICAgICAgc2VudDogdHJ1ZSwKICAgICAgICAgIHRleHQ6IHRoaXMudG9fc2VuZCwKICAgICAgICAgIHRpbWU6IHRoaXMuZ2VuZXJhdGVfdGltZSgpLAogICAgICAgICAgY3VycmVudF9jaGFubmVsOiB0aGlzLmN1cnJlbnRfdXNlci5jaGFubmVsX25hbWUsCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy51c2VyX2NoYW5uZWxzW3RoaXMuY3VycmVudF91c2VyLmNoYW5uZWxfbmFtZV0ucHVzaCgibmV3X2NoYXRfbWVzc2FnZSIsIHsKICAgICAgICAgIG1lc3NhZ2U6IHRoaXMudG9fc2VuZCwKICAgICAgICB9KTsKICAgICAgICB0aGlzLnRvX3NlbmQgPSAiIjsKICAgICAgICB0aGlzLm5vX3Jlc3BvbnNlKHRoaXMpOwogICAgICAgIHRoaXMudXBkYXRlX3Njcm9sbGJhcigpOwogICAgICB9CiAgICB9LAogICAgZGlzY29ubmVjdF9zdXBwb3J0X2NoYXQoKSB7CiAgICAgIHRoaXMudXNlcl9jaGFubmVsc1t0aGlzLmN1cnJlbnRfdXNlci5jaGFubmVsX25hbWVdLnB1c2goInN0b3BwZWRfY2hhdCIsIHsKICAgICAgICBuYW1lOiAiU3VwcG9ydCBBZ2VudCIsCiAgICAgICAgbWVzc2FnZTogImhhcyBlbmRlZCB0aGlzIGNvbnZlcnNhdGlvbi4iLAogICAgICB9KTsKICAgICAgdGhpcy51c2VyX2NoYW5uZWxzW3RoaXMuY3VycmVudF91c2VyLmNoYW5uZWxfbmFtZV0ubGVhdmUoKTsKICAgICAgLy8gdGhpcy51c2VyX2xpc3QgPSB0aGlzLnVzZXJfbGlzdC5maWx0ZXIoKHVzZXIpID0+IHsKICAgICAgLy8gICByZXR1cm4gdXNlci5jaGFubmVsX25hbWUgIT0gdGhpcy5jdXJyZW50X3VzZXIuY2hhbm5lbF9uYW1lOwogICAgICAvLyB9KTsKCiAgICAgIHZhciBpbmRleCA9IHRoaXMudXNlcl9saXN0LmZpbmRJbmRleChvYmogPT4gb2JqLmNoYW5uZWxfbmFtZSA9PT0gdGhpcy5jdXJyZW50X3VzZXIuY2hhbm5lbF9uYW1lKTsKICAgICAgdGhpcy51c2VyX2xpc3RbaW5kZXhdLmFnZW50X3VzZXJuYW1lID0gdGhpcy5hZ2VudF91c2VybmFtZTsKICAgICAgdGhpcy51c2VyX2xpc3RbaW5kZXhdLmlzX2Nvbm5lY3RlZCA9IHRydWU7CiAgICAgIHRoaXMudXNlcl9saXN0W2luZGV4XS5zdGF0ZSA9ICJlbmRlZCI7CiAgICAgIC8vIHRoaXMuY3VycmVudF91c2VyID0gdGhpcy5maXJzdF9uYW1lOwogICAgfSwKICAgIHVwZGF0ZV9zY3JvbGxiYXIoKSB7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMuaXNfdHlwaW5nX2luZGljYXRvcl9vbiA9IGZhbHNlOwogICAgICB9LCAxNTAwKTsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmNoYXQtYm9keSIpLnNjcm9sbFRvcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoCiAgICAgICAgICAiLmNoYXQtYm9keSIKICAgICAgICApLnNjcm9sbEhlaWdodDsKICAgICAgfSwgMjAwKTsKICAgIH0sCiAgICAvLyB1c2VyX2xpc3RfY2xhc3MoY2hhbm5lbG5hbWUpIHsKICAgICAgLy8gaWYgKGNoYW5uZWxuYW1lID09IHRoaXMuY3VycmVudF9jaGFubmVsKSB7CiAgICAgIC8vICAgcmV0dXJuICJuYXYtbGluayBhY3RpdmUiOwogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAgIHJldHVybiAibmF2LWxpbmsgaW5hY3RpdmUiOwogICAgICAvLyB9CiAgICAvLyB9LAogICAgc2VsZWN0X3VzZXIodXNlcikgewogICAgICB0aGlzLmN1cnJlbnRfdXNlciA9IHVzZXI7CiAgICAgIHRoaXMudXBkYXRlX3Njcm9sbGJhcigpOwogICAgfSwKICAgIGNoZWNrX2N1cnJlbnRfYWN0aXZlX3VzZXIoaW5kZXgpIHsKICAgICAgaWYgKEJvb2xlYW4odGhpcy5jdXJyZW50X3VzZXIpID09PSB0cnVlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudF91c2VyLmNoYW5uZWxfbmFtZSA9PT0KICAgICAgICAgIHRoaXMudXNlcl9saXN0W2luZGV4XS5jaGFubmVsX25hbWUKICAgICAgICAgID8gImN1cnJlbnQtYWN0aXZlLXVzZXIiCiAgICAgICAgICA6IG51bGw7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["LiveChat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoLA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LiveChat.vue","sourceRoot":"src/portal/Chatbot/Dashboard/Customer Support","sourcesContent":["<template>\n  <div class=\"dash-cont\">\n    <div class=\"container-fluid\">\n      <div class=\"card dash-card\">\n        <div class=\"card-body p-0\">\n          <div class=\"d-flex\" style=\"border-bottom: 1px solid #dbe2e8\">\n            <div class=\"col-md-3\" style=\"border-right: 1px solid #dbe2e8\">\n              <div style=\"display: flex\">\n                <!-- <span\n                  class=\"user-img text-center\"\n                  style=\"font-size: x-large; margin-bottom: 5px\"\n                  >{{ first_name[0] }}{{ last_name[0] }}</span\n                > -->\n                <!-- <h4 style=\"margin-top: 3%; margin-left: 5%\">\n                  {{ first_name }}&nbsp;\n                </h4> -->\n                <h4 style=\"margin-top: 3%;\">Online Customers</h4>\n              </div>\n            </div>\n            <div class=\"col-md-9\">\n              <div class=\"card-act d-flex flex-wrap\" style=\"margin-top: 1%\">\n                <h4 class=\"mb-sm-0\" v-if=\"Boolean(current_user.username)\">{{ current_user.username }}</h4>\n                <h4 class=\"mb-sm-0\" v-else-if=\"current_user.username == ''\">{{\"Customer\"}}</h4>\n                <h4 class=\"mb-sm-0\" v-else>{{\"Select a Customer\"}}</h4>\n                <div class=\"ml-auto\" v-show=\"user_list.length\">\n                <a\n                  href=\"#\"\n                  class=\"ml-auto\"\n                  style=\"color: red;\"\n                  v-if=\"current_user.state == 'joined'\"\n                  @click=\"disconnect_support_chat\"\n                  >Stop Chat</a\n                >\n                <a\n                  href=\"#\"\n                  class=\"ml-auto\"\n                  style=\"color: black;\"\n                  v-else-if=\"current_user.state == 'ended'\"\n                  >Chat Ended</a\n                >\n                <a\n                  href=\"#\"\n                  class=\"ml-auto\"\n                  @click=\"join_customer(user)\"\n                  v-else-if=\"current_user.state == 'waiting'\"\n                  >Join</a\n                >\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"d-flex\">\n            <div class=\"col-sm-3 p-0\" style=\"border-right: 1px solid #dbe2e8\">\n              <ul class=\"navbar-nav flex-column\" style=\"width: 100%\">\n                <div v-for=\"(user, index) in user_list\"\n                  :key=\"index\">\n                <li\n                  class=\"nav-item\"\n                  v-if=\"user.agent_username == agent_username || user.agent_username == null\"\n                  style=\"cursor: pointer\"\n                  :class=\"check_current_active_user(index)\"\n                  @click=\"select_user(user)\"\n                >\n                  <a\n                    class=\"d-flex\"\n                    href=\"#\"\n                    role=\"button\"\n                  >\n                    <template v-if=\"user.username == ''\">\n                      <p style=\"color: black; margin: 0;\">User</p> \n                    </template>\n                    <template v-else-if=\"user.username != ''\">\n                      <p style=\"color: black; margin: 0;\">{{user.username}}</p> \n                    </template>\n                    <span\n                      href=\"#\"\n                      v-if=\"user.is_connected == false\"\n                      class=\"ml-auto\"\n                      @click=\"select_user(user) ,join_customer(user)\"\n                    >\n                      Join\n                    </span>\n                    <span\n                      v-if=\"user.state == 'ended'\"\n                      class=\"ml-auto\"\n                      style=\"color: black;\"\n                    >\n                      Chat Ended\n                    </span>\n                  </a>\n                </li>\n                </div>\n              </ul>\n            </div>\n            <div class=\"col-md-9\" id=\"chat\">\n              <div class=\"chat-master\">\n                <div class=\"chat-body\" style=\"height: 65vh; overflow-y: auto\">\n                  <div\n                    class=\"chat-inner\"\n                    v-for=\"(chat, item) in chat_list\"\n                    :key=\"item\"\n                    v-show=\"chat.current_channel == current_user.channel_name\"\n                  >\n                    <div class=\"chat-row sender\" v-if=\"chat.sent\">\n                      <div class=\"chat\" v-html=\"chat.text\"></div>\n                      <div class=\"chat-his justify-content-between\">\n                        <span class=\"time\" style=\"color: #000\">{{\n                          chat.time\n                        }}</span>\n                        <span class=\"del-note delivered\">Delivered</span>\n                      </div>\n                    </div>\n                    <div class=\"chat-row receiver\" v-if=\"chat.received\">\n                      <div class=\"chat\" v-html=\"chat.text\"></div>\n                      <div class=\"chat-his justify-content-between\">\n                        <span class=\"time\" style=\"color: #000\">{{\n                          chat.time\n                        }}</span>\n                        <span class=\"del-note delivered\">Delivered</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"chat-footer\" style=\"margin-bottom: 20px\">\n                  <div\n                    class=\"typing-indicator\"\n                    style=\"margin-left: 10px\"\n                    v-show=\"is_typing_indicator_on\"\n                  >\n                    <p style=\"font-size: 13px; font-weight: 300\">\n                      {{ msg_sender }} is typing\n                    </p>\n                    <span></span>\n                    <span></span>\n                    <span></span>\n                  </div>\n                </div>\n                <div\n                  class=\"chat-footer\"\n                  style=\"\n                    border-top: solid 1px #dbe2e8;\n                    border-radius: 0 0 0 0;\n                    overflow: hidden;\n                  \"\n                >\n                  <div class=\"chat-txt\">\n                    <div class=\"input-group mb-0\">\n                      <input\n                        type=\"text\"\n                        class=\"form-control\"\n                        placeholder=\"Type your message here ...\"\n                        v-model=\"to_send\"\n                        @keypress.enter=\"send_message\"\n                      />\n                      <div class=\"input-group-append\">\n                        <button class=\"btn\" type=\"button\" @click=\"send_message\">\n                          <svg\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                            style=\"fill: #8a8a8a63\"\n                            width=\"40\"\n                            height=\"25\"\n                            viewBox=\"0 0 24 24\"\n                          >\n                            <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\" />\n                            <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                          </svg>\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport axios from \"axios\";\nimport swal from \"sweetalert2\";\nimport { Socket } from \"phoenix-socket\";\nimport { setInterval } from \"timers\";\nimport debounce from \"vue-debounce/dist/debounce.min.js\";\nimport { generate_time } from \"@/portal/mixins\";\n\nexport default {\n  data() {\n    return {\n      user_list: [],\n      current_user: {},\n      current_channel: \"\",\n      first_name: this.$session.has(\"UserFirstName\")\n        ? this.$session.get(\"UserFirstName\")\n        : this.$session.get(\"UserInformation\").first_name,\n      last_name: this.$session.has(\"UserLastName\")\n        ? this.$session.get(\"UserLastName\")\n        : this.$session.get(\"UserInformation\").last_name,\n      agent_username: this.$session.get(\"UserInformation\").email,\n      chat_list: [],\n      to_send: \"\",\n      ch: null,\n      message: null,\n      user_channels: {},\n      socket: null,\n      msg_sender: \"\",\n      delay: 10000,\n      is_typing_indicator_on: false,\n      // user_list: [{\"channel_name\":\"customers_groups:dhs6bennkl\",\"username\":\"Vimleshh\",\"is_connected\":false,\"agent_username\":null,\"agent_role\":null,\"state\":\"waiting\"},{\"channel_name\":\"customers_groups:hemzastnhe\",\"username\":\"Akshay\",\"is_connected\":false,\"agent_username\":null,\"agent_role\":null,\"state\":\"waiting\"}]\n    };\n  },\n  watch: {\n    to_send(newVal) {\n      this.button_fill();\n    },\n  },\n  mixins: [generate_time],\n  mounted() {\n    this.socket = new Socket(process.env.VUE_APP_LIVE_CHAT_WEBSOCKET_ENDPOINT, {\n      params: {\n        username: this.$session.get(\"UserInformation\").email,\n        token: this.$session.get(\"UserInformation\").tokens,\n        role: this.$session.get(\"UserInformation\").role\n      },\n    });\n    this.socket.connect();\n    this.ch = this.socket.channel(\n      \"companies:\" + this.$session.get(\"UserInformation\").company_name\n    );\n    this.ch.join();\n\n    this.ch.on('new_name', (res) => {\n      var check = this.user_list.some(obj => obj.channel_name === res.topic)\n      var index = this.user_list.findIndex(obj => obj.channel_name === res.topic);\n      if(check) this.user_list[index].username = res.name;\n    })\n    this.ch.on(\"customer_group_presence\", (res) => { \n      console.log(\"customer group interval update\", res);\n      var temp = res;\n      for (var i in temp.metas) {\n        if (Boolean(temp.metas[i].user_info.is_customer)) {\n            var channel_group = \"customers_groups:\" + temp.metas[i].user_info.customer_group_name;\n            var check = this.user_list.some(obj => obj.channel_name === channel_group)\n            // this.user_channels[channel_group] = this.socket.channel(res.customer_chat_group);\n            if (check) {\n              var index = this.user_list.findIndex(obj => obj.channel_name === channel_group);\n              if (temp.metas.length > 1) {\n                this.user_list[index].is_connected = true;\n                this.user_list[index].agent_role = temp.metas[1].user_info.role;\n                this.user_list[index].agent_username = temp.metas[1].user_info.username;\n                this.user_list[index].state == \"ended\" ? \"ended\" : \"joined\";\n              } else {\n                this.user_list[index].is_connected = false;\n                this.user_list[index].agent_role = null;\n                this.user_list[index].agent_username = null;\n                this.user_list[index].state == \"ended\" ? \"ended\" : \"waiting\";\n              }\n            } else {\n              this.user_list.push({\n                \"channel_name\": channel_group,\n                \"username\": \"\",\n                \"is_connected\": false,\n                \"agent_username\": null,\n                \"agent_role\": null,\n                \"state\": \"waiting\"\n              })\n              this.user_channels[channel_group] = this.socket.channel(\n                channel_group\n              );\n            }\n        }\n      }\n    })\n\n    this.ch.on(\"customer_needs_support_agent\", (res) => {\n      console.log(\"userchannel\")\n      // this.user_list.push({\n      //   channel_name: res.customer_chat_group,\n      //   username: \"\",\n      //   is_connected: false\n      // });\n      // this.current_user = res.customer_chat_group;\n      // this.current_user = \"Customer\";\n      // this.current_channel = res.customer_chat_group;\n      this.user_channels[res.customer_chat_group] = this.socket.channel(\n        res.customer_chat_group\n      );\n      this.message = this.socket.channel(res.customer_chat_group);\n\n      this.user_channels[res.customer_chat_group].on(\"started_typing\",\n        (typing_response) => {\n          if (res.customer_chat_group == this.current_user.channel_name) {\n            if (typing_response.sender != \"support_agent\") {\n              var name = this.user_list.filter((user) => {\n                return user.channel_name == res.customer_chat_group;\n              });\n              if (name[0].username == \"\") {\n                this.msg_sender = typing_response.sender;\n              } else {\n                this.msg_sender = name[0].username;\n              }\n            }\n            this.is_typing_indicator_on = true;\n          }\n        }\n      );\n      this.user_channels[res.customer_chat_group].on(\"stopped_typing\", () => {\n        this.is_typing_indicator_on = false;\n      });\n      this.user_channels[res.customer_chat_group].on(\"new_chat_message\",\n        (response) => {\n          if (response.sender == \"customer\") {\n            this.chat_list.push({\n              received: true,\n              text: response.message,\n              current_channel: res.customer_chat_group,\n              time: this.generate_time(),\n            });\n            this.update_scrollbar();\n            this.no_response(this);\n          }\n        }\n      );\n      // this.user_channels[res.customer_chat_group].on(\"new_name\", (resp) => {\n      //   for (let i = 0, n = this.user_list.length; i < n; i++) {\n      //     if (this.user_list[i].channel_name == res.customer_chat_group) {\n      //       this.user_list[i].username = resp.name;\n      //     }\n      //   }\n      //   this.current_user = resp.name;\n      //   this.no_response(this);\n      // });\n      this.user_channels[res.customer_chat_group].on(\"stopped_chat\", (resp) => {\n        this.chat_list.push({\n          received: true,\n          text: resp.name + resp.message,\n          current_channel: resp.topic,\n          time: this.generate_time(),\n        });\n        this.update_scrollbar();\n        swal({\n          text: res.name + res.message,\n          toast: true,\n          showConfirmButton: false,\n          position: \"top-end\",\n          type: \"info\",\n          timer: 5000,\n        });\n        var index = this.user_list.findIndex(obj => obj.channel_name === resp.topic);\n        this.user_list[index].agent_username = this.agent_username;\n        this.user_list[index].is_connected = true;\n        this.user_list[index].state = \"ended\";\n        // toastr.info(resp.name + \" \" + resp.message);\n        // this.user_list = this.user_list.filter((user) => {\n        //   return user.username != resp.name;\n        // });\n        // this.chat_list = this.chat_list.filter((chat) => {\n        //   return chat.current_channel != this.current_channel;\n        // });\n        // this.current_user = this.first_name;\n      });\n\n      // this.user_channels[res.customer_chat_group].join();\n    });\n  },\n  beforeDestroy(){ \n    this.ch.leave();\n    //disconnect all customer when SA navigates to other page\n      for (const property in this.user_channels) {\n      this.user_channels[property].push(\"stopped_chat\", {\n          name: \"Support Agent\",\n          message: \"has ended this conversation.\",\n          });\n            this.user_channels[property].leave();\n      }\n    this.socket.disconnect(); \n  },\n  methods: {\n    join_customer(res) {\n      console.log(res);\n      this.user_channels[res.channel_name].join();\n      var index = this.user_list.findIndex(obj => obj.channel_name === res.channel_name);\n      this.user_list[index].agent_username = this.agent_username;\n      this.user_list[index].is_connected = true;\n      this.user_list[index].state = \"joined\";\n      this.ch.on(\"customer_group_presence\", (res) => { \n      })\n    },\n    button_fill() {\n      document.querySelector(\"svg\").style.fill = \"#273679\";\n      if (this.to_send == \"\") {\n        document.querySelector(\"svg\").style.fill = \"#8a8a8a63\";\n      } else if (this.to_send != \"\") {\n        this.user_channels[this.current_user.channel_name].push(\"started_typing\");\n      }\n      this.stop_typing(this);\n    },\n    stop_typing: debounce(function (vm) {\n      vm.user_channels[vm.current_user.channel_name].push(\"stopped_typing\");\n    }, 5000),\n    no_response: debounce(function (vm) {\n      vm.user_channels[vm.current_user.channel_name].push(\"no_response\", {\n        sender: \"sender\",\n      });\n    }, 10000),\n    send_message() {\n      if (this.to_send != \"\" && this.user_list.length > 0) {\n        this.chat_list.push({\n          sent: true,\n          text: this.to_send,\n          time: this.generate_time(),\n          current_channel: this.current_user.channel_name,\n        });\n        this.user_channels[this.current_user.channel_name].push(\"new_chat_message\", {\n          message: this.to_send,\n        });\n        this.to_send = \"\";\n        this.no_response(this);\n        this.update_scrollbar();\n      }\n    },\n    disconnect_support_chat() {\n      this.user_channels[this.current_user.channel_name].push(\"stopped_chat\", {\n        name: \"Support Agent\",\n        message: \"has ended this conversation.\",\n      });\n      this.user_channels[this.current_user.channel_name].leave();\n      // this.user_list = this.user_list.filter((user) => {\n      //   return user.channel_name != this.current_user.channel_name;\n      // });\n\n      var index = this.user_list.findIndex(obj => obj.channel_name === this.current_user.channel_name);\n      this.user_list[index].agent_username = this.agent_username;\n      this.user_list[index].is_connected = true;\n      this.user_list[index].state = \"ended\";\n      // this.current_user = this.first_name;\n    },\n    update_scrollbar() {\n      setTimeout(() => {\n        this.is_typing_indicator_on = false;\n      }, 1500);\n      setTimeout(() => {\n        document.querySelector(\".chat-body\").scrollTop = document.querySelector(\n          \".chat-body\"\n        ).scrollHeight;\n      }, 200);\n    },\n    // user_list_class(channelname) {\n      // if (channelname == this.current_channel) {\n      //   return \"nav-link active\";\n      // } else {\n      //   return \"nav-link inactive\";\n      // }\n    // },\n    select_user(user) {\n      this.current_user = user;\n      this.update_scrollbar();\n    },\n    check_current_active_user(index) {\n      if (Boolean(this.current_user) === true) {\n        return this.current_user.channel_name ===\n          this.user_list[index].channel_name\n          ? \"current-active-user\"\n          : null;\n      }\n    },\n  },\n};\n</script>\n<style scoped>\n/* ul {\n  list-style-type: none;\n  padding: 0;\n  border: 1px solid #ddd;\n} */\n\nli {\n  padding: 8px 16px;\n  border-bottom: 1px solid #ddd;\n}\n\n/* ul li:last-child {\n  border-bottom: none\n}\nul li:first-child {\n  border-top: none\n} */\n.current-active-user {\n  background: rgba(0, 0, 0, 0.1);\n}\n.darkblue-btn {\n  padding: 10px 6px;\n  font-size: 12px;\n}\n.nav-link.inactive {\n  text-align: center;\n  border: 1px solid #fff;\n}\n.nav-link.active {\n  border: 1px solid #293978;\n  text-align: center;\n}\n/* .nav-item :hover {\n  border: 1px solid #293978;\n} */\n.user-img {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  border: solid 1px #293978;\n  display: inline-block;\n  overflow: hidden;\n  vertical-align: middle;\n}\n.chat {\n  transform: scale(0);\n  transform-origin: 0 0;\n  animation: bounce 500ms linear both;\n  border-radius: 5px;\n  padding: 5px 8px;\n  width: fit-content;\n}\n.receiver .chat {\n  color: #000 !important;\n  text-align: left;\n  /* margin-top: 3%; */\n}\n.sender {\n  color: #fff;\n  margin-left: 50%;\n  text-align: right;\n  margin-top: 3%;\n}\n.sender .chat {\n  background: #293978;\n}\n.chat-row:not(:first-child) {\n  margin: 10px 0;\n}\n#chat,\n.chat-txt input {\n  background-image: url(/img/sdk-background.png);\n}\ndiv::-webkit-scrollbar {\n  max-height: 20px;\n  width: 6px;\n  border-radius: 10px;\n}\n\n/* Track */\ndiv::-webkit-scrollbar-track {\n  background: #f1f1f1;\n  border-radius: 10px;\n}\n\n/* Handle */\ndiv::-webkit-scrollbar-thumb {\n  background: #7d7d7d;\n  border-radius: 10px;\n}\n\n/* Handle on hover */\ndiv::-webkit-scrollbar-thumb:hover {\n  background: #555;\n  border-radius: 10px;\n}\n</style>\n"]}]}