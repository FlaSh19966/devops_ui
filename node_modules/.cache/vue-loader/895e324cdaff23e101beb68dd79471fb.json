{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Campaigns/EmailCampaign.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Campaigns/EmailCampaign.vue","mtime":1663910265450},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFZ1ZUVkaXRvciB9IGZyb20gInZ1ZTItZWRpdG9yIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IHN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgU3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7CmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IHsgZnJlZXplX3BvcnRhbCxzaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwgLCBjbG9zZV9tb2RhbH0gZnJvbSAiQC9wb3J0YWwvbWl4aW5zIjsKaW1wb3J0IE11bHRpc2VsZWN0IGZyb20gInZ1ZS1tdWx0aXNlbGVjdCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkVtYWlsQ2FtcGFpZ25QYWdlIiwKICBjb21wb25lbnRzOiB7CiAgICBWdWVFZGl0b3IsCiAgICBNdWx0aXNlbGVjdCwKICB9LAogIG1peGluczogW2ZyZWV6ZV9wb3J0YWwsc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsICwgY2xvc2VfbW9kYWxdLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwZW5jaWxfc3ZnOgogICAgICAgICcgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNS41NDYiIGhlaWdodD0iMTUuNDYxIiB2aWV3Qm94PSIwIDAgMTUuNTQ2IDE1LjQ2MSI+PGRlZnM+PHN0eWxlPi5he2ZpbGw6IzllOWU5ZTt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTc0Ny44ODggLTM1Ni43NjkpIj48cGF0aCBjbGFzcz0iYSIgZD0iTTc1OS40MTYsMzU2Ljc2OWEyLjM1OCwyLjM1OCwwLDAsMSwxLjc3Ny42NjJjLjUzNC41MTMsMS4wNzIsMS4wMjUsMS41NjcsMS41NzVhMi4zLDIuMywwLDAsMS0uMDcxLDMuMzI1Yy0yLjczNiwyLjc2LTUuNDk0LDUuNS04LjIzOCw4LjI1MWExLjM4MSwxLjM4MSwwLDAsMS0uNzU4LjI4OGMtLjcxOS4xNzQtMS40MjkuMzc5LTIuMTQ0LjU3Mi0uOTMyLjI1MS0xLjg2Mi41LTIuNzk1Ljc1MS0uNi4xNTgtLjk4OS0uMjEzLS44MzItLjgwN3EuNjg5LTIuNTk1LDEuNDA2LTUuMTgyYTEuMTY0LDEuMTY0LDAsMCwxLC4yODktLjQ4N3E0LjA5MS00LjEwNyw4LjItOC4yQTIuMjY1LDIuMjY1LDAsMCwxLDc1OS40MTYsMzU2Ljc2OVptLTEuOTg5LDIuOTU2LTYuNTQsNi41MzgsMy4wMjUsMy4wMjQsNi41MzgtNi41MzdabTQuMDIzLDIuMTY1Yy4xMTgtLjEzNS4yMjUtLjI2OS4zNDMtLjM5MmExLjEzNCwxLjEzNCwwLDAsMCwwLTEuNzM0Yy0uNDYtLjQ2Ni0uOTI2LS45MjUtMS4zODgtMS4zOWExLjE2NiwxLjE2NiwwLDAsMC0uODYxLS4zNjhjLS41NzgsMC0uODgxLjQtMS4yMTQuNzZabS0xMi4wODQsOC44NjMsMy4yLS44NjMtMi4zMzctMi4zMzFaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwKSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNODEzLjk0Miw0MjIuNmwtLjc4OS0uOCwzLjgyMS0zLjgxOS43ODQuOFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01OS42NDggLTU1Ljk0NykiLz48L2c+PC9zdmc+JywKICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgc3Bpbm5lck9uOiBmYWxzZSwKICAgICAgdGVtcGxhdGVfbmFtZTogIiIsCiAgICAgIHNhdmVfc21zOiAiIiwKICAgICAgc2F2ZV9lbWFpbDogIiIsCiAgICAgIGlzX3NtczogZmFsc2UsCiAgICAgIGlzX2VtYWlsOiB0cnVlLAogICAgICBzYXZlX3N1YmplY3Q6ICIiLAogICAgICBpc19wdWJsaXNoX2VtYWlsOiB0cnVlLAogICAgICBpc19wdWJsaXNoX3NtczogdHJ1ZSwKICAgICAgaXNfZWRpdF9zbXM6IGZhbHNlLAogICAgICBpc19lZGl0X2VtYWlsOiB0cnVlLAogICAgICB2ZXJpZmljYXRpb25fc3RhdHVzOiBudWxsLAogICAgICB0ZW1wbGF0ZWxpc3Q6IFtdLAogICAgICBjaGVja2VkX2xpc3Q6IFtdLAogICAgICBjdXN0b21Ub29sYmFyOiBbCiAgICAgICAgWyJib2xkIiwgIml0YWxpYyIsICJ1bmRlcmxpbmUiXSwKICAgICAgICBbeyBhbGlnbjogW10gfV0sCiAgICAgICAgW3sgY29sb3I6IFtdIH0sIHsgYmFja2dyb3VuZDogW10gfV0sCiAgICAgICAgW3sgbGlzdDogIm9yZGVyZWQiIH0sIHsgbGlzdDogImJ1bGxldCIgfV0sCiAgICAgICAgWyJsaW5rIl0sCiAgICAgIF0sCiAgICAgIHF1aWxsOiAiIiwKICAgICAgcXVpbGxfZWRpdDogIiIsCiAgICAgIGlzX2h0bWxfYm9keTogZmFsc2UsCiAgICAgIHNsb3RfdmFyaWFibGU6e30sCiAgICAgIGN1cnJlbnRfdGVtcGxhdGU6IFtdLAogICAgICBvbGRfdGVtcGxhdGVfbmFtZTogIiIsCiAgICAgIGlzRWRpdFRlbXBsYXRlOiBmYWxzZSwKICAgICAgbnVtYmVyX29mX3Jvd3M6IG51bGwsCiAgICAgIHRvdGFsX3BhZ2VzOiBudWxsLAogICAgICBwYWdlX25vOiAxLAogICAgICBwZXJfcGFnZTogMTAsCiAgICAgIGltYWdlX2ZpbGU6IG51bGwsCiAgICAgIGltYWdlX2ZpbGVfMjogbnVsbCwKICAgICAgaXNfaW1hZ2VfbmVlZGVkOiAibm9uZSIsCiAgICAgIGlzX2VkaXRfaW1hZ2VfbmVlZGVkOiAibm9uZSIsCiAgICAgIGVtYWlsX3N1YmplY3Q6ICIiLAogICAgICByZWdfdXJsOgogICAgICAgIC9odHRwczpcL1wvWyh3d3dcLik/YS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIoWy1hLXpBLVowLTlAOiVfXCsufiM/JlwvXC89XSopL2ksCiAgICAgIGlzX2VkaXRfcmVnX3VybDoKICAgICAgICAvaHR0cHM6XC9cL1sod3d3XC4pP2EtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKFstYS16QS1aMC05QDolX1wrLn4jPyZcL1wvPV0qKS9pLAogICAgICBpbWdfcmVkaXJlY3RfdXJsOiAiIiwKICAgICAgZWRpdF9pbWdfcmVkaXJlY3RfdXJsOiAiIiwKICAgICAgZmlsZV9sYWJlbDogIkNob29zZSBmaWxlIiwKICAgICAgZWRpdGVkX2ZpbGVfbGFiZWw6ICJDaG9vc2UgZmlsZSIsCiAgICAgIHByZXZpZXdfdGVtcGxhdGVfZGF0YTogIiIsCiAgICAgIHRlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdDogZmFsc2UsCiAgICAgIGVkaXRfdGVtcGxhdGVfbmFtZV9hbHJlYWR5X2V4aXN0OiBmYWxzZSwKICAgICAgcGFnZV9hcnJheTogW10sCiAgICAgIHNlbmRfZW1haWxfYWxsX2N1c3RvbWVyOiB0cnVlLAogICAgICBjdXN0b21lcnNfbGlzdDogW10sCiAgICAgIHNwZWNpZmljX2N1c3RvbWVyX2xpc3Q6IFtdLAogICAgICBkaXNhYmxlX2J0bl9leHBpcmVkOiBmYWxzZSwKICAgICAgZW1haWxfcmVnOgogICAgICAgIC9eKChbXjw+KClbXF1cXC4sOzpcc0BcIl0rKFwuW148PigpW1xdXFwuLDs6XHNAXCJdKykqKXwoXCIuK1wiKSlAKChcW1swLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cXSl8KChbYS16QS1aXC0wLTldK1wuKStbYS16QS1aXXsyLH0pKSQvLAogICAgICBzZWFyY2hfbmFtZTogIiIsCiAgICAgIGlzVmlzaWJsZVNlYXJjaENsZWFyOiBmYWxzZSwKICAgIH07CiAgfSwKICBwcm9wczogewogICAgaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlOiBCb29sZWFuLAogIH0sCiAgd2F0Y2g6IHsKICAgIHNlYXJjaF9uYW1lKCkgewogICAgICBpZiAodGhpcy5zZWFyY2hfbmFtZSA9PT0gIiIpIHsKICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgdGhpcy5pc1Zpc2libGVTZWFyY2hDbGVhciA9IGZhbHNlOwogICAgICB9IGVsc2UgaWYgKHRoaXMuc2VhcmNoX25hbWUgIT09ICIiKSB7CiAgICAgICAgdGhpcy5pc1Zpc2libGVTZWFyY2hDbGVhciA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICAvLyBpc19ub3RpZmljYXRpb25fdGVtcGxhdGUoKSB7CiAgICAvLyAgIGNvbnNvbGUubG9nKHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlKTsKICAgIC8vIH0sCiAgfSwKICBjb21wdXRlZDogewogICAgdmFsaWRVUkwoKSB7CiAgICAgIGlmICh0aGlzLnJlZ191cmwudGVzdCh0aGlzLmltZ19yZWRpcmVjdF91cmwpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9LAogICAgdmFsaWRfZWRpdF9VUkwoKSB7CiAgICAgIGlmICh0aGlzLmlzX2VkaXRfcmVnX3VybC50ZXN0KHRoaXMuZWRpdF9pbWdfcmVkaXJlY3RfdXJsKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUgPT0gIlN1cGVyQWRtaW4iKSB7CiAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlJZCIpOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgdGhpcy5mcmVlemVfcG9ydGFsKCk7CiAgICB9LCAxMDAwKTsKICAgICB0aGlzLiRyb290LiRvbigiRW1haWxUZW1wbGF0ZVBhZ2VEaXNhYmxlZCIsIChkYXRhKSA9PnsKICAgICAgaWYoZGF0YT09PXRydWUpewogICAgICAgIHRoaXMuZGlzYWJsZV9idG5fZXhwaXJlZCA9IHRydWU7CiAgICAgICAgdGhpcy5zaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwoKTsKICAgICAgfQogICAgfSkKICAgIHRoaXMubG9hZF90ZW1wbGF0ZXMoKTsKICAgIGlmICh0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSA9PT0gZmFsc2UpewogICAgICB0aGlzLmxvYWRfY3VzdG9tZXJfbGlzdCgpOwogICAgfQogICAgdmFyIHZtID0gdGhpczsKICAgICQoIiNzZWxlY3RhbGwiKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSBmYWxzZTsKICAgICAgdGhpcy5pc19zbXMgPSBmYWxzZTsKICAgICAgdGhpcy5pc19lbWFpbCA9IHRydWU7CiAgICAgIGlmICgkKHRoaXMpLmlzKCI6Y2hlY2tlZCIpKSB7CiAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgdHJ1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdm0uY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICB9CiAgICB9KTsKICAgIHRoaXMuZWRpdG9yKCk7CiAgICBpZiAodGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUgPT09IHRydWUpewogICAgICB0aGlzLmxvYWRfc2xvdF92YXJpYWJsZSgpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgY2xlYXJfc2VhcmNoX25hbWUoKSB7CiAgICAgIHRoaXMuc2VhcmNoX25hbWUgPSAiIjsKICAgIH0sCiAgICBjYWxsc2VhcmNoKCkgewogICAgICBpZiAodGhpcy5zZWFyY2hfbmFtZSAhPSAiIil7CiAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgIGF4aW9zCiAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsX2NhbXBhaWduKCksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBpc19zZWFyY2g6IHRydWUsCiAgICAgICAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICAgIHNlYXJjaF9rZXk6IHRoaXMuc2VhcmNoX25hbWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICkKICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnRlbXBsYXRlbGlzdCA9IFtdOwogICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGEgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhOwogICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2UgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlOwogICAgICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuVEVNUExBVEVfRE9FU19OT1RfRVhJU1RTX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZWxpc3QgPSBbXTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuVEVNUExBVEVfU0VBUkNIX1JFU1VMVF9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhLnRlbXBsYXRlX3NlYXJjaDsKICAgICAgICAgICAgICBpZiAodGhpcy50ZW1wbGF0ZWxpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgdGhpcy5zaG93X3RlbXBsYXRlKDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmlzRWRpdFRlbXBsYXRlID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuc2V0cGFnaW5hdGlvbigxKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGxvYWRfc2xvdF92YXJpYWJsZSgpewogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMuZm9ybV9hdXRvbWF0aW9uX2RpYWxvZ190cmVlKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGlzX2dldF9zbG90X3ZhcmlhYmxlOiB0cnVlLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEVfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICB0aGlzLnNsb3RfdmFyaWFibGUgPSB7fTsKICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHJlc3BvbnNlLmRhdGEuZGF0YS5zbG90c19saXN0Lmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSByZXNwb25zZS5kYXRhLmRhdGEuc2xvdHNfbGlzdFtpbmRleF07CiAgICAgICAgICAgICAgdGhpcy5zbG90X3ZhcmlhYmxlW2VsZW1lbnRdID0gJ3snICsgZWxlbWVudCArICd9JzsKICAgICAgICAgICAgfQogICAgICAgICAgLy8gdGhpcy5pbnNlcnRfdmFyaWFibGUoJ3F1aWxsJywgdGhpcy5zbG90X3ZhcmlhYmxlKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGlzLmFwaV9zdGF0dXNfY29kZS5OT19TTE9UU19GT1VORF9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIC8vIHRoaXMuaW5zZXJ0X3ZhcmlhYmxlKCdxdWlsbCcsIHRoaXMuc2xvdF92YXJpYWJsZSk7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgZWRpdG9yKCl7CiAgICAgIHRoaXMucXVpbGwgPSBuZXcgUXVpbGwoIiNlZGl0b3IiLCB7CiAgICAgICAgbW9kdWxlczogewogICAgICAgICAgdG9vbGJhcjogWwogICAgICAgICAgICBbImJvbGQiLCAiaXRhbGljIiwgInVuZGVybGluZSJdLAogICAgICAgICAgICBbImxpbmsiXSwKICAgICAgICAgICAgW3sgYWxpZ246IFtdIH1dLAogICAgICAgICAgICBbeyBjb2xvcjogW10gfSwgeyBiYWNrZ3JvdW5kOiBbXSB9XSwKICAgICAgICAgICAgW3sgbGlzdDogIm9yZGVyZWQiIH0sIHsgbGlzdDogImJ1bGxldCIgfV0sCiAgICAgICAgICBdLAogICAgICAgIH0sCiAgICAgICAgdGhlbWU6ICJzbm93IiwKICAgICAgfSk7CiAgICAgIHRoaXMucXVpbGwub24oInRleHQtY2hhbmdlIiwgKCkgPT4gewogICAgICAgIHRoaXMuJGVtaXQoCiAgICAgICAgICAiaW5wdXQiLAogICAgICAgICAgdGhpcy5xdWlsbC5nZXRUZXh0KCkgPyB0aGlzLnF1aWxsLnJvb3QuaW5uZXJIVE1MIDogIiIKICAgICAgICApOwogICAgICAgIHRoaXMuc2F2ZV9lbWFpbCA9IHRoaXMucXVpbGwuZ2V0VGV4dCgpID8gdGhpcy5xdWlsbC5yb290LmlubmVySFRNTCA6ICIiOwogICAgICB9KTsKICAgICAgaWYodGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUpIHsKICAgICAgICB0aGlzLmluc2VydF92YXJpYWJsZSgncXVpbGwnLCB0aGlzLnNsb3RfdmFyaWFibGUpOwogICAgICB9CiAgICB9LAogICAgZWRpdF9lZGl0b3IoKXsKICAgICAgdGhpcy5xdWlsbF9lZGl0ID0gbmV3IFF1aWxsKCIjZWRpdF9lZGl0b3IiLCB7CiAgICAgIG1vZHVsZXM6IHsKICAgICAgICB0b29sYmFyOiBbCiAgICAgICAgICBbImJvbGQiLCAiaXRhbGljIiwgInVuZGVybGluZSJdLAogICAgICAgICAgWyJsaW5rIl0sCiAgICAgICAgICBbeyBhbGlnbjogW10gfV0sCiAgICAgICAgICBbeyBjb2xvcjogW10gfSwgeyBiYWNrZ3JvdW5kOiBbXSB9XSwKICAgICAgICAgIFt7IGxpc3Q6ICJvcmRlcmVkIiB9LCB7IGxpc3Q6ICJidWxsZXQiIH1dLAogICAgICAgIF0sCiAgICAgIH0sCiAgICAgIHRoZW1lOiAic25vdyIsCiAgICB9KTsKICAgIHRoaXMucXVpbGxfZWRpdC5vbigidGV4dC1jaGFuZ2UiLCAoKSA9PiB7CiAgICAgIHRoaXMuJGVtaXQoCiAgICAgICAgImlucHV0IiwKICAgICAgICB0aGlzLnF1aWxsX2VkaXQuZ2V0VGV4dCgpID8gdGhpcy5xdWlsbF9lZGl0LnJvb3QuaW5uZXJIVE1MIDogIiIKICAgICAgKTsKICAgICAgdGhpcy5jdXJyZW50X3RlbXBsYXRlLmVtYWlsID0gdGhpcy5xdWlsbF9lZGl0LmdldFRleHQoKSA/IHRoaXMucXVpbGxfZWRpdC5yb290LmlubmVySFRNTCA6ICIiOwogICAgfSk7CiAgICB0aGlzLnF1aWxsX2VkaXQucm9vdC5pbm5lckhUTUwgPSB0aGlzLmN1cnJlbnRfdGVtcGxhdGUuZW1haWw7CiAgICB0aGlzLmluc2VydF92YXJpYWJsZSgncXVpbGxfZWRpdCcsIHRoaXMuc2xvdF92YXJpYWJsZSk7CiAgICB9LAogICAgaW5zZXJ0X3ZhcmlhYmxlKHZhbCwgc2xvdF92YXJpYWJsZSl7CiAgICAgIGlmICh0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSA9PT0gdHJ1ZSl7CiAgICAgICAgY29uc3QgZHJvcERvd25JdGVtcyA9IHsKICAgICAgICAnTm8gc2xvdCB2YXJpYWJsZSc6ICcnLAogICAgICAgIH0KICAgICAgICBjb25zdCBteURyb3BEb3duID0gbmV3IFF1aWxsVG9vbGJhckRyb3BEb3duKHsKICAgICAgICAgICAgbGFiZWw6ICJJbnNlcnQgVmFyaWFibGUiLAogICAgICAgICAgICByZW1lbWJlclNlbGVjdGlvbjogZmFsc2UsCiAgICAgICAgICAgIGlkOiAiZHJvcGRvd25faWQiCiAgICAgICAgfSkKICAgICAgICBpZihPYmplY3QuZW50cmllcyhzbG90X3ZhcmlhYmxlKS5sZW5ndGggPT09IDAgJiYgc2xvdF92YXJpYWJsZS5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KXsKICAgICAgICAgIG15RHJvcERvd24uc2V0SXRlbXMoZHJvcERvd25JdGVtcyk7CiAgICAgICAgfWVsc2UgewogICAgICAgICAgbXlEcm9wRG93bi5zZXRJdGVtcyhzbG90X3ZhcmlhYmxlKTsKICAgICAgICB9CiAgICAgICAgbXlEcm9wRG93bi5vblNlbGVjdCA9IGZ1bmN0aW9uKGxhYmVsLCB2YWx1ZSwgcXVpbGwpIHsKICAgICAgICAgICAgY29uc3QgeyBpbmRleCwgbGVuZ3RoIH0gPSBxdWlsbC5zZWxlY3Rpb24uc2F2ZWRSYW5nZQogICAgICAgICAgICBxdWlsbC5kZWxldGVUZXh0KGluZGV4LCBsZW5ndGgpCiAgICAgICAgICAgIHF1aWxsLmluc2VydFRleHQoaW5kZXgsIHZhbHVlKQogICAgICAgICAgICBxdWlsbC5zZXRTZWxlY3Rpb24oaW5kZXggKyB2YWx1ZS5sZW5ndGgpCiAgICAgICAgfQogICAgICAgIG15RHJvcERvd24uYXR0YWNoKHRoaXMucXVpbGwpCiAgICAgICAgaWYgKHZhbCA9PT0gJ3F1aWxsX2VkaXQnKXsKICAgICAgICAgIG15RHJvcERvd24uYXR0YWNoKHRoaXMucXVpbGxfZWRpdCkKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhZGRUYWcobmV3VGFnKSB7CiAgICAgIHZhciB0YWdfbGlzdCA9IFtdOwogICAgICB0YWdfbGlzdCA9IG5ld1RhZy5zcGxpdCgiLCIpOwogICAgICBpZiAodGFnX2xpc3QubGVuZ3RoID4gMikgewogICAgICAgIHN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfYWRkX3ZhbGlkX3RhZ19tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLAogICAgICAgICAgdGltZXI6IDQ1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBlbWFpbCA9IHRhZ19saXN0WzBdOwogICAgICAgIHZhciBjdXN0b21lcl9uYW1lID0gQm9vbGVhbih0YWdfbGlzdFsxXSkgPyB0YWdfbGlzdFsxXSA6ICIgIjsKICAgICAgICBpZiAoIXRoaXMuZW1haWxfcmVnLnRlc3QoZW1haWwpKSB7CiAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfdmFsaWRfZW1haWxfYWRkcl9tc2cnKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgdGltZXI6IDQ1MDAsCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3QgdGFnID0gewogICAgICAgIGN1c3RvbWVyX25hbWU6IGN1c3RvbWVyX25hbWUsCiAgICAgICAgZW1haWw6IGVtYWlsLAogICAgICB9OwogICAgICB0aGlzLmN1c3RvbWVyc19saXN0LnB1c2godGFnKTsKICAgICAgdGhpcy5zcGVjaWZpY19jdXN0b21lcl9saXN0LnB1c2godGFnKTsKICAgIH0sCiAgICBsb2FkX2N1c3RvbWVyX2xpc3QoKSB7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MKICAgICAgICAucG9zdCgKICAgICAgICAgIGFwaV9jYWxscy5zZW5kX29mZmVyX3RvX2N1c3RvbWVycygpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBnZXRfY3VzdG9tZXJzX2xpc3Q6IHRydWUsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5TVEFUVVNfU1VDQ0VTU19NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICB0aGlzLmN1c3RvbWVyc19saXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhLmN1c3RvbWVyc19saXN0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBlbWFpbF92ZXJpZmljYXRpb25fc3RhdHVzKCkgewogICAgICBpZighdGhpcy5kaXNhYmxlX2J0bl9leHBpcmVkKXsKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLnByb2R1Y3Rfc2V0dGluZ3MoKSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIGlzX2VtYWlsX3ZlcmlmaWNhdGlvbl9zdGF0dXM6IHRydWUsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgdGhpcy5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEUuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFCiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy52ZXJpZmljYXRpb25fc3RhdHVzID0gcmVzcG9uc2UuZGF0YS5kYXRhLnZlcmlmaWNhdGlvbl9zdGF0dXM7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudmVyaWZpY2F0aW9uX3N0YXR1cyk7CiAgICAgICAgICAgIGlmICh0aGlzLnZlcmlmaWNhdGlvbl9zdGF0dXMgPT0gIlN1Y2Nlc3MiKSB7CiAgICAgICAgICAgICAgLy8gaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHVibGlzaF90ZW1wbGF0ZV9idG4iKS5kaXNhYmxlZCkgewogICAgICAgICAgICAgICQoIiNzZW5kZW1haWwiKS5tb2RhbCgic2hvdyIpOwogICAgICAgICAgICAgIHRoaXMubG9hZF9jdXN0b21lcl9saXN0KCk7CiAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfbm90X2NvbmZpZ19pbnN0cnVjdGlvbl9tc2cnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIHRpbWVyOiAxMzAwMCwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmKHRoaXMuYXBpX3N0YXR1c19jb2RlLkVNQUlMX05PVF9DT05GSUdVUkVELk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX25vdF9jb25maWdfaW5zdHJ1Y3Rpb25fbXNnMScpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICB0aW1lcjogMTMwMDAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IAogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCdlbWFpbF90ZW1wX25vdF9jb25maWdfZXJyb3Jfb2NjdXJfbXNnJykpOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH1lbHNlewogICAgICAgIHRoaXMuc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsKCk7CiAgICAgIH0KICAgIH0sCiAgICB2YWxpZGF0ZV90ZW1wbGF0ZV9uYW1lKCkgewogICAgICBheGlvcy5wb3N0KAogICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9lbWFpbF9jYW1wYWlnbigpLAogICAgICAgIHsKICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICBpc190ZW1wbGF0ZV9wcmVzZW50OiB0cnVlLAogICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICB0ZW1wbGF0ZV9uYW1lOiB0aGlzLnRlbXBsYXRlX25hbWUsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgKQogICAgICAudGhlbigocmVzcG9uc2UpID0+ewogICAgICAgIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5OT1RfRVhJU1RTX01PREVMUy5NU0dfQ09ERSA9PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSBmYWxzZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRlbXBsYXRlX25hbWVfYWRkX2lkIikuc3R5bGUuYm9yZGVyID1udWxsOwogICAgICAgICAgICBpZih0aGlzLnRlbXBsYXRlX25hbWUgIT0gIiIpewogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0ZW1wbGF0ZV9uYW1lX2FkZF9pZCIpLnN0eWxlLmJvcmRlciA9CiAgICAgICAgICAgICAgIjFweCBzb2xpZCAjMDBmMDAwIjsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuQUxSRUFEWV9FWElTVFNfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgdGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSB0cnVlOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVtcGxhdGVfbmFtZV9hZGRfaWQiKS5zdHlsZS5ib3JkZXIgPQogICAgICAgICAgICAiMXB4IHNvbGlkIHJlZCI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgdmFsaWRhdGVfZWRpdF90ZW1wbGF0ZV9uYW1lKCkgewogICAgICBheGlvcy5wb3N0KAogICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9lbWFpbF9jYW1wYWlnbigpLAogICAgICAgIHsKICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICBpc190ZW1wbGF0ZV9wcmVzZW50OiB0cnVlLAogICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICB0ZW1wbGF0ZV9uYW1lOiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfbmFtZSwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICApCiAgICAgIC50aGVuKChyZXNwb25zZSkgPT57CiAgICAgICAgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLk5PVF9FWElTVFNfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICB0aGlzLmVkaXRfdGVtcGxhdGVfbmFtZV9hbHJlYWR5X2V4aXN0ID0gZmFsc2U7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlZGl0X3RlbXBsYXRlX25hbWVfaWQiKS5zdHlsZS5ib3JkZXIgPW51bGw7CiAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9uYW1lICE9ICIiKXsKICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdF90ZW1wbGF0ZV9uYW1lX2lkIikuc3R5bGUuYm9yZGVyID0KICAgICAgICAgICAgICAiMXB4IHNvbGlkICMwMGYwMDAiOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLkFMUkVBRFlfRVhJU1RTX01PREVMUy5NU0dfQ09ERSA9PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgaWYgKHRoaXMub2xkX3RlbXBsYXRlX25hbWUgPT0gdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX25hbWUpewogICAgICAgICAgICAgIHRoaXMuZWRpdF90ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSBmYWxzZTsKICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdF90ZW1wbGF0ZV9uYW1lX2lkIikuc3R5bGUuYm9yZGVyID1udWxsOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICB0aGlzLmVkaXRfdGVtcGxhdGVfbmFtZV9hbHJlYWR5X2V4aXN0ID0gdHJ1ZTsKICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdF90ZW1wbGF0ZV9uYW1lX2lkIikuc3R5bGUuYm9yZGVyID0KICAgICAgICAgICAgICAiMXB4IHNvbGlkIHJlZCI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHByZXZpZXdfdGVtcGxhdGUoKSB7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MKICAgICAgICAucG9zdCgKICAgICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9lbWFpbF9jYW1wYWlnbigpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGlzX3ByZXZpZXc6IHRydWUsCiAgICAgICAgICAgIHRlbXBsYXRlX2lkOiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfaWQsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5URU1QTEFURV9SRUNFSVZFRF9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIHRoaXMucHJldmlld190ZW1wbGF0ZV9kYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhLlRlbXBsYXRlOwogICAgICAgICAgICAkKCIjcHJldmlld190ZW1wbGF0ZV92aXNpYmxlIikubW9kYWwoInNob3ciKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGlzLmFwaV9zdGF0dXNfY29kZS5URU1QTEFURV9ET0VTX05PVF9FWElTVFNfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgc2VuZF9lbWFpbF9jb25maXJtX3Byb21wdF90ZXh0KGFsbF9jdXN0b21lcikgewogICAgICBpZiAoYWxsX2N1c3RvbWVyKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudGx0KCdlbWFpbF90ZW1wX3NlbmRfYnVsa19lbWFpbF9tc2cnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy50bHQoJ2VtYWlsX3RlbXBfc2VuZF9zcGVjaWZpY19jdXN0b21lcl9tc2cnKTsKICAgICAgfQogICAgfSwKICAgIHNlbmRfZW1haWwoKSB7CiAgICAgIGlmICghdGhpcy5zZW5kX2VtYWlsX2FsbF9jdXN0b21lcikgewogICAgICAgIGlmKCFCb29sZWFuKHRoaXMuc3BlY2lmaWNfY3VzdG9tZXJfbGlzdC5sZW5ndGggPiAwKSl7CiAgICAgICAgICBzd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX3NlbGVjdF9vbmVfZW1haWxfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0aW1lcjogNTAwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgIH0KICAgICAgU3dhbC5maXJlKHsKICAgICAgICB0aXRsZTp0aGlzLnNlbmRfZW1haWxfY29uZmlybV9wcm9tcHRfdGV4dCh0aGlzLnNlbmRfZW1haWxfYWxsX2N1c3RvbWVyKSwKICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zd2FsX2NvbmZpcm1fbXNnJyksCiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICB0eXBlOid3YXJuaW5nJywKICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zd2FsX3llc19tc2cnKSwKICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgJCgiI3NlbmRlbWFpbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICBheGlvcwogICAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgICBhcGlfY2FsbHMuc2VuZF9vZmZlcl90b19jdXN0b21lcnMoKSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgIHNlbmRfZW1haWw6IHRydWUsCiAgICAgICAgICAgICAgICBzZW5kX2VtYWlsX2FsbF9jdXN0b21lcjogdGhpcy5zZW5kX2VtYWlsX2FsbF9jdXN0b21lciwKICAgICAgICAgICAgICAgIHNwZWNpZmljX2N1c3RvbWVyX2xpc3Q6CiAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZF9lbWFpbF9hbGxfY3VzdG9tZXIgIT0gdHJ1ZQogICAgICAgICAgICAgICAgICAgID8gdGhpcy5zcGVjaWZpY19jdXN0b21lcl9saXN0CiAgICAgICAgICAgICAgICAgICAgOiBbXSwKICAgICAgICAgICAgICAgIHRlbXBsYXRlX2lkOiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfaWQsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuU0VORElOR19FTUFJTF9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgICAvLyB0aGlzLnNhdmVfc3ViamVjdCA9ICIiOwogICAgICAgICAgICAgICAgLy8gJCgiI3B1Ymxpc2h0ZW1wbGF0ZW1vZGVsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgICAgIHN3YWwoewogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zZW50X3N1Y2Nlc3NmdWxfbXNnJyksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAsCiAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zd2FsX3N1Y2Nlc3NfbXNnJyksCiAgICAgICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICAgICAgJCgiI3NlbmRlbWFpbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgICAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSBpZih0aGlzLmFwaV9zdGF0dXNfY29kZS5VUEdSQURFX1BMQU5fVE9fU0VORF9FTUFJTF9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgICAgIHN3YWwoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF91cGdyYWRlX3BsYW5fbXNnJyksCiAgICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6JyMzMDg1ZDYnLAogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zd2FsX3VwZ3JhZGVfbm93X21zZycpLAogICAgICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX3N3YWxfdXBncmFkZV9sYXRlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogJyNkMzMnLAogICAgICAgICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlID09IHRydWUpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICdTZXR0aW5ncycscGFyYW1zOntTdWJzY3JpcHRpb246dHJ1ZX19KTsgICAgIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBzZWxlY3RlZF90ZW1wbGF0ZXModmFsdWUpIHsKICAgICAgaWYodmFsdWUgPT0gImFsbCIpewogICAgICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnRlbXBsYXRlbGlzdCkgewogICAgICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0LnB1c2godGhpcy50ZW1wbGF0ZWxpc3RbaV0udGVtcGxhdGVfaWQpOwogICAgICAgICAgfQogICAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuY2hlY2tlZF9saXN0Lmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgJCgiIyIrW2ldKS5wcm9wKCJjaGVja2VkIiwgdHJ1ZSk7CiAgICAgICAgICAgICQoIiNzZWxlY3RhbGwiKS5wcm9wKCJjaGVja2VkIiwgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfWVsc2UgaWYgKCFldmVudC50YXJnZXQuY2hlY2tlZCl7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgIH0KCiAgICAgIH1lbHNlewogICAgICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QucHVzaCh2YWx1ZSk7CiAgICAgICAgfSBlbHNlIGlmICghZXZlbnQudGFyZ2V0LmNoZWNrZWQpewogICAgICAgICAgdmFyIHNlbGVjdGFsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNzZWxlY3RhbGwiKTsKICAgICAgICAgIGlmIChzZWxlY3RhbGwuY2hlY2tlZCkgewogICAgICAgICAgICBzZWxlY3RhbGwuY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHRlbXAgPSB0aGlzLmNoZWNrZWRfbGlzdC5maWx0ZXIoKHRlbXBsYXRlc19pZCkgPT4gewogICAgICAgICAgICByZXR1cm4gdGVtcGxhdGVzX2lkICE9IHZhbHVlOwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRlbXA7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgbG9hZF90ZW1wbGF0ZXMoKSB7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MKICAgICAgICAucG9zdCgKICAgICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9lbWFpbF9jYW1wYWlnbigpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGlzX2dldDogdHJ1ZSwKICAgICAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSwKICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYodGhpcy5hcGlfc3RhdHVzX2NvZGUuU1RBVFVTX1NVQ0NFU1NfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGEgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhOwogICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZSA9PSB1bmRlZmluZWQgPyAwIDogcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2U7CiAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZWxpc3QgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIC8vIHRoaXMuY3VycmVudF90ZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVsaXN0WzBdOwogICAgICAgICAgICAgICAgdGhpcy5zaG93X3RlbXBsYXRlKDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLmlzRWRpdFRlbXBsYXRlID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgaWYodGhpcy5hcGlfc3RhdHVzX2NvZGUuVU5TVUNDRVNTRlVMX0RCX09QRVJBVElPTl9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gW107CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIGZpbGVpbnB1dDEoZSkgewogICAgICBsZXQgZmlsZXMgPSBlLnRhcmdldC5maWxlcyB8fCBlLmRhdGFUcmFuc2Zlci5maWxlczsKICAgICAgaWYgKGZpbGVzWzBdLnR5cGUgPT09ICJpbWFnZS9wbmciIHx8IGZpbGVzWzBdLnR5cGUgPT09ICJpbWFnZS9qcGVnIikgewogICAgICAgIGlmICghZmlsZXMubGVuZ3RoKSByZXR1cm47CiAgICAgICAgdGhpcy5maWxlX2xhYmVsID0gZmlsZXNbMF0ubmFtZTsKICAgICAgICB0aGlzLmNyZWF0ZUltYWdlKGZpbGVzWzBdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF90ZW1wX2ltYWdlX3R5cGVfbXNnMScpLAogICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlSW1hZ2UoZmlsZSwgdHlwZSkgewogICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4gewogICAgICAgIHRoaXMuaW1hZ2VfZmlsZSA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdCgiYmFzZTY0LCIpWzFdOwogICAgICB9OwogICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgIH0sCiAgICBmaWxlaW5wdXQyKGUpIHsKICAgICAgbGV0IGZpbGVzID0gZS50YXJnZXQuZmlsZXMgfHwgZS5kYXRhVHJhbnNmZXIuZmlsZXM7CiAgICAgIGlmIChmaWxlc1swXS50eXBlID09PSAiaW1hZ2UvcG5nIiB8fCBmaWxlc1swXS50eXBlID09PSAiaW1hZ2UvanBlZyIpIHsKICAgICAgICBpZiAoIWZpbGVzLmxlbmd0aCkgcmV0dXJuOwogICAgICAgIHRoaXMub2xkX2VkaXRlZF9pbWFnZV9uYW1lID0gdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbDsKICAgICAgICB0aGlzLmVkaXRlZF9maWxlX2xhYmVsID0gZmlsZXNbMF0ubmFtZTsKICAgICAgICB0aGlzLmNyZWF0ZUltYWdlMihmaWxlc1swXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9pbWFnZV90eXBlX21zZzInKSwKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNyZWF0ZUltYWdlMihmaWxlLCB0eXBlKSB7CiAgICAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgcmVhZGVyLm9ubG9hZCA9IChlKSA9PiB7CiAgICAgICAgdGhpcy5pbWFnZV9maWxlXzIgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoImJhc2U2NCwiKVsxXTsKICAgICAgfTsKICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICB9LAogICAgY3JlYXRlX1VVSUQoKSB7CiAgICAgIHZhciBkdCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgICB2YXIgdXVpZCA9ICJ4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgiLnJlcGxhY2UoCiAgICAgICAgL1t4eV0vZywKICAgICAgICBmdW5jdGlvbiAoYykgewogICAgICAgICAgdmFyIHIgPSAoZHQgKyBNYXRoLnJhbmRvbSgpICogMTYpICUgMTYgfCAwOwogICAgICAgICAgZHQgPSBNYXRoLmZsb29yKGR0IC8gMTYpOwogICAgICAgICAgcmV0dXJuIChjID09ICJ4IiA/IHIgOiAociAmIDB4MykgfCAweDgpLnRvU3RyaW5nKDE2KTsKICAgICAgICB9CiAgICAgICk7CiAgICAgIHJldHVybiB1dWlkOwogICAgfSwKICAgIHBhZ2VfcmVxdWlyZShwYWdlKSB7CiAgICAgIGlmIChwYWdlID09IDAgfHwgcGFnZSA9PSB0aGlzLnRvdGFsX3BhZ2VzICsgMSkgewogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09ICIiKSB7CiAgICAgICAgICBpZiAocGFnZSA9PSAiLi4ucyIpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCgxICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgICAgfSBlbHNlIGlmIChwYWdlID09ICIuLi5sIikgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKHRoaXMudG90YWxfcGFnZXMgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlOwogICAgICAgICAgfQogICAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgICAgYXhpb3MKICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsX2NhbXBhaWduKCksCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICAgIGlzX2dldDogdHJ1ZSwKICAgICAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICAgIGlmKHRoaXMuYXBpX3N0YXR1c19jb2RlLlNUQVRVU19TVUNDRVNTX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhID09IHVuZGVmaW5lZCA/IDAgOiByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfZGF0YTsKICAgICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2UgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlOwogICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgICAgIGlmICh0aGlzLnRlbXBsYXRlbGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudF90ZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVsaXN0WzBdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSBmYWxzZTsKICAgICAgICAgICAgICB9IGVsc2UgaWYodGhpcy5hcGlfc3RhdHVzX2NvZGUuVU5TVUNDRVNTRlVMX0RCX09QRVJBVElPTl9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlbGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChwYWdlID09ICIuLi5zIikgewogICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgoMSArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChwYWdlID09ICIuLi5sIikgewogICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgodGhpcy50b3RhbF9wYWdlcyArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlOwogICAgICAgICAgICB9CiAgICAgICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsX2NhbXBhaWduKCksCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICAgICAgaXNfc2VhcmNoOiB0cnVlLAogICAgICAgICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICAgICAgICBzZWFyY2hfa2V5OiB0aGlzLnNlYXJjaF9uYW1lCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gW107CiAgICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGEgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhOwogICAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlID09IHVuZGVmaW5lZCA/IDAgOiByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5URU1QTEFURV9ET0VTX05PVF9FWElTVFNfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZWxpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5URU1QTEFURV9TRUFSQ0hfUkVTVUxUX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhLnRlbXBsYXRlX3NlYXJjaDsKICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfdGVtcGxhdGUoMCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKDEpOwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzZXRwYWdpbmF0aW9uKHBhZ2Vfbm8pIHsKICAgICAgdGhpcy5wYWdlX2FycmF5ID0gW107CiAgICAgIGlmICh0aGlzLnRvdGFsX3BhZ2VzIDw9IDcpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IDEpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gdGhpcy50b3RhbF9wYWdlcykgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CiAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMudG90YWxfcGFnZXMgLSA0OyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPD0gNCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZV9ubyArIDM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPj0gdGhpcy50b3RhbF9wYWdlcyAtIDQpIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gNDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gMzsgaSA8PSBwYWdlX25vICsgMzsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfQogICAgfSwKICAgIHBhZ2luYXRpb25fY2xhc3MoaW5kZXgpIHsKICAgICAgaWYgKGluZGV4ID09IHRoaXMucGFnZV9ubykgewogICAgICAgIHJldHVybiAiIGFjdGl2ZSI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICB9LAogICAgc2F2ZV90ZW1wbGF0ZSgpIHsKICAgICAgaWYgKHRoaXMudGVtcGxhdGVfbmFtZSA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX3RlbXBsYXRlX25hbWVfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPT0gdHJ1ZSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX25hbWVfZXhpc3RfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5lbWFpbF9zdWJqZWN0ID09ICIiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfZW50ZXJfc3ViamVjdF9tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzX3NtcyA9PSB0cnVlICYmIHRoaXMuc2F2ZV9zbXMgPT0gIiIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9tb2RlbF9lbnRlcl9zbXNfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc19lbWFpbCA9PSB0cnVlICYmIHRoaXMuc2F2ZV9lbWFpbCA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX2VudGVyX2VtYWlsX2JvZHlfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc19lbWFpbCA9PSBmYWxzZSAmJiB0aGlzLmlzX3NtcyA9PSBmYWxzZSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX3NlbGVjdF9vcHRpb25fbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgdGhpcy5pc19pbWFnZV9uZWVkZWQgPT0gInllcyIgJiYKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5wdXRGaWxlIikudmFsdWUgPT0gIiIKICAgICAgKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfY2hvb3NlX2ltZ19tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzX2ltYWdlX25lZWRlZCA9PSAieWVzIiAmJiAhdGhpcy52YWxpZFVSTCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX3ZhbGlkX3VybF9tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5pc19odG1sX2JvZHkpIHRoaXMuaXNfaW1hZ2VfbmVlZGVkID0gJ25vbmUnOwogICAgICAgIHZhciB1dWlkID0gdGhpcy5jcmVhdGVfVVVJRCgpOwogICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfZW1haWxfY2FtcGFpZ24oKSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgICAgICBpc19zYXZlOiB0cnVlLAogICAgICAgICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZDogdXVpZCwKICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfbmFtZTogdGhpcy50ZW1wbGF0ZV9uYW1lLAogICAgICAgICAgICAgICAgICBzYXZlX2VtYWlsOiB0aGlzLmlzX2VtYWlsID09IHRydWUgPyB0aGlzLnNhdmVfZW1haWwgOiBudWxsLAogICAgICAgICAgICAgICAgICBzYXZlX3NtczogdGhpcy5pc19zbXMgPT0gdHJ1ZSA/IHRoaXMuc2F2ZV9zbXMgOiBudWxsLAogICAgICAgICAgICAgICAgICBlbWFpbF9zdWJqZWN0OiB0aGlzLmVtYWlsX3N1YmplY3QsCiAgICAgICAgICAgICAgICAgIGVtYWlsX2ltZ19maWxlOgogICAgICAgICAgICAgICAgICAgIHRoaXMuaXNfaW1hZ2VfbmVlZGVkID09PSAibm9uZSIgPyBudWxsIDogdGhpcy5pbWFnZV9maWxlLAogICAgICAgICAgICAgICAgICBlbWFpbF9pbWdfbmFtZTogdGhpcy5maWxlX2xhYmVsLAogICAgICAgICAgICAgICAgICBlbWFpbF9pbWdfbGluazogdGhpcy5pbWdfcmVkaXJlY3RfdXJsLAogICAgICAgICAgICAgICAgICBpc19odG1sX2JvZHk6IHRoaXMuaXNfaHRtbF9ib2R5CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlNVQ0NFU1NGVUxfREJfUVVFUllfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX21vZGVsX2RhdGFfYWRkZWRfc3VjY2Vzc2Z1bF9tc2cnKSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbXB0eV92YXJpYWJsZSgpOwogICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZF90ZW1wbGF0ZXMoKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLklNR19EVVBMSUNBVEVfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9tb2RlbF9pbWdfYWxyZWFkeV9mb3VuZF9tc2cnKSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkX3RlbXBsYXRlcygpOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlVOU1VDQ0VTU0ZVTF9EQl9PUEVSQVRJT05fTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgdGhpcy5lbXB0eV92YXJpYWJsZSgpOwogICAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9tb2RlbF9lcnJvcl9vY2N1cl9tc2cyJyksCiAgICAgICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLmNsb3NlX21vZGFsKCJzYXZlX3RlbXBsYXRlX2J0biIpOwogICAgICAgICAgICAgIAogICAgICAgIC8vIFN3YWwuZmlyZSh7CiAgICAgICAgLy8gICB0aXRsZTogdGhpcy50bHQoJ2VtYWlsX21vZGVsX3N3YWxfYWxlcnRfbXNnJyksCiAgICAgICAgLy8gICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfYWRkX2N1cnJlbnRfdGVtcGxhdGVfbXNnJyksCiAgICAgICAgLy8gICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgIC8vICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAvLyAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgIC8vICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAvLyAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfc3dhbF9jb25maXJtX21zZycpLAogICAgICAgIC8vIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgIC8vICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgIC8vICAgICBTd2FsKHsKICAgICAgICAvLyAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfbW9kZWxfc3VibWl0X2RldGFpbHNfbXNnJyksCiAgICAgICAgLy8gICAgICAgdHlwZTogImluZm8iLAogICAgICAgIC8vICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgIC8vICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAvLyAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgICAKICAgICAgICAgICAgICAKICAgICAgICAgIH0KICAgICAgICAgIAogICAgICAgICAKICAgICAKICAgICAgCiAgICB9LAogICAgZWRpdF90ZW1wbGF0ZSgpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9uYW1lID09ICIiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF90ZW1wbGF0ZV9uYW1lX21zZycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMuZWRpdF90ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPT0gdHJ1ZSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX2VkaXRfbmFtZV9hbHJlYWR5X2V4aXN0X21zZycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudF90ZW1wbGF0ZS5zdWJqZWN0ID09ICIiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF9lbnRlcl9zdWJqZWN0X21zZycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKAogICAgICAgIHRoaXMuaXNfZWRpdF9zbXMgPT0gdHJ1ZSAmJgogICAgICAgICh0aGlzLmN1cnJlbnRfdGVtcGxhdGUuc21zID09IG51bGwgfHwgdGhpcy5jdXJyZW50X3RlbXBsYXRlLnNtcyA9PSAiIikKICAgICAgKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF9lbnRlcl9zbXNfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgdGhpcy5pc19lZGl0X2VtYWlsID09IHRydWUgJiYKICAgICAgICAodGhpcy5jdXJyZW50X3RlbXBsYXRlLmVtYWlsID09IG51bGwgfHwKICAgICAgICAgIHRoaXMuY3VycmVudF90ZW1wbGF0ZS5lbWFpbCA9PSAiIikKICAgICAgKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF9lbnRlcl9lbWFpbF9ib2R5X21zZycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMuaXNfZWRpdF9lbWFpbCA9PSBmYWxzZSAmJiB0aGlzLmlzX2VkaXRfc21zID09IGZhbHNlKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfZWRpdF9zZWxlY3Rfb3B0aW9uX21zZycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMuaXNfZWRpdF9pbWFnZV9uZWVkZWQgPT0gInllcyIgJiYgIXRoaXMudmFsaWRfZWRpdF9VUkwpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X3ZhbGlkX3VybF9tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICgKICAgICAgICB0aGlzLmlzX2VkaXRfaW1hZ2VfbmVlZGVkID09ICJ5ZXMiICYmCiAgICAgICAgdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbCA9PSAiQ2hvb3NlIGZpbGUiICYmCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlucHV0RmlsZTIiKS52YWx1ZSA9PSAiIgogICAgICApIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X2Nob29zZV9pbWdfbXNnJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuaXNfaHRtbF9ib2R5KSB0aGlzLmlzX2VkaXRfaW1hZ2VfbmVlZGVkID0gJ25vbmUnOwogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX2VkaXRfc3VibWl0X2RldGFpbHNfbXNnJyksCiAgICAgICAgICB0eXBlOiAiaW5mbyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICB9KTsKICAgICAgICBheGlvcwogICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9lbWFpbF9jYW1wYWlnbigpLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgaXNfZWRpdDogdHJ1ZSwKICAgICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICAgIHRlbXBsYXRlX2lkOiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfaWQsCiAgICAgICAgICAgICAgdGVtcGxhdGVfbmFtZTogdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX25hbWUsCiAgICAgICAgICAgICAgZW1haWxfc3ViamVjdDogdGhpcy5jdXJyZW50X3RlbXBsYXRlLnN1YmplY3QsCiAgICAgICAgICAgICAgc2F2ZV9lbWFpbDoKICAgICAgICAgICAgICAgIHRoaXMuaXNfZWRpdF9lbWFpbCA9PSB0cnVlID8gdGhpcy5jdXJyZW50X3RlbXBsYXRlLmVtYWlsIDogbnVsbCwKICAgICAgICAgICAgICBzYXZlX3NtczoKICAgICAgICAgICAgICAgIHRoaXMuaXNfZWRpdF9zbXMgPT0gdHJ1ZSA/IHRoaXMuY3VycmVudF90ZW1wbGF0ZS5zbXMgOiBudWxsLAogICAgICAgICAgICAgIGVtYWlsX2ltZ19maWxlOgogICAgICAgICAgICAgICAgdGhpcy5pc19lZGl0X2ltYWdlX25lZWRlZCA9PT0gIm5vbmUiID8gbnVsbCA6IHRoaXMuaW1hZ2VfZmlsZV8yLAogICAgICAgICAgICAgIGVtYWlsX2ltZ19uYW1lOgogICAgICAgICAgICAgICAgdGhpcy5pc19lZGl0X2ltYWdlX25lZWRlZCA9PT0gIm5vbmUiCiAgICAgICAgICAgICAgICAgID8gbnVsbAogICAgICAgICAgICAgICAgICA6IHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwsCiAgICAgICAgICAgICAgZW1haWxfaW1nX2xpbms6CiAgICAgICAgICAgICAgICB0aGlzLmlzX2VkaXRfaW1hZ2VfbmVlZGVkID09PSAibm9uZSIKICAgICAgICAgICAgICAgICAgPyBudWxsCiAgICAgICAgICAgICAgICAgIDogdGhpcy5lZGl0X2ltZ19yZWRpcmVjdF91cmwsCiAgICAgICAgICAgICAgaXNfaW1hZ2VfZWRpdDoKICAgICAgICAgICAgICAgIHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwgIT0gdGhpcy5vbGRfZWRpdGVkX2ltYWdlX25hbWUKICAgICAgICAgICAgICAgICAgPyB0cnVlCiAgICAgICAgICAgICAgICAgIDogZmFsc2UsCiAgICAgICAgICAgICAgaXNfaW1hZ2VfcHJlc2VudDoKICAgICAgICAgICAgICAgIHRoaXMuaXNfZWRpdF9pbWFnZV9uZWVkZWQgPT09ICJub25lIiA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICAgICAgICBvbGRfaW1hZ2U6CiAgICAgICAgICAgICAgICB0aGlzLm9sZF9lZGl0ZWRfaW1hZ2VfbmFtZSA9PSAiQ2hvb3NlIEZpbGUiCiAgICAgICAgICAgICAgICAgID8gbnVsbAogICAgICAgICAgICAgICAgICA6IHRoaXMub2xkX2VkaXRlZF9pbWFnZV9uYW1lLAogICAgICAgICAgICAgIGlzX2h0bWxfYm9keTogdGhpcy5jdXJyZW50X3RlbXBsYXRlLmlzX2h0bWxfYm9keQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfQogICAgICAgICAgKQogICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5TVUNDRVNTRlVMX0RCX1FVRVJZX01PREVMUy5NU0dfQ09ERSA9PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlbWFpbF9lZGl0X2RhdGFfZWRpdF9zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuSU1HX0RVUExJQ0FURV9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlucHV0RmlsZTIiKS52YWx1ZSA9ICIiOwogICAgICAgICAgICAgIHN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX2VkaXRfaW1nX2FscmVhZHlfZm91bmRfbXNnJyksCiAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgdGltZXI6IDMwMDAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuVU5TVUNDRVNTRlVMX0RCX09QRVJBVElPTl9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VtYWlsX2VkaXRfZXJyb3Jfb2NjdXJfbXNnMicpLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlX3NlbGVjdGVkKCkgewogICAgICBpZiAodGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoID09IDApIHsKICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdlbWFpbF90ZW1wX25vX3RlbXBsYXRlX3NlbGVjdF9tc2cnKSwKICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgIHRpbWVyOiAyMDAwLAogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc3dhbF9hbGVydF9tc2cyJyksCiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9zd2FsX2RlbGV0ZV9jdXJyZW50X3RlbXBsYXRlX21zZycpLAogICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ2VtYWlsX3RlbXBfc3dhbF9jb25maXJtX21zZycpLAogICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICB0aGlzLmRlbGV0ZV90ZW1wbGF0ZXModGhpcy5jaGVja2VkX2xpc3QpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlX3RlbXBsYXRlcyhjaGVja2VkX2xpc3QpIHsKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsX2NhbXBhaWduKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgaXNfZGVsZXRlOiB0cnVlLAogICAgICAgICAgICB0ZW1wbGF0ZV9saXN0OiBjaGVja2VkX2xpc3QsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5ERUxFVEVEX1NVQ0NFU1NGVUxMWV8wMDA0X01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZW1haWxfdGVtcF9kYXRhX2RlbGV0ZWRfbXNnJyksCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgICAgICAgIHRoaXMubG9hZF90ZW1wbGF0ZXMoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlVOU1VDQ0VTU0ZVTF9EQl9PUEVSQVRJT05fTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgIH0pCiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLk5PVEhJTkdfVE9fREVMRVRFX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHNob3dfdGVtcGxhdGUoaW5kZXgpIHsKICAgICAgaWYgKHRoaXMuaXNFZGl0VGVtcGxhdGUpIHsKICAgICAgICB0aGlzLmVkaXRfdGVtcGxhdGVfZGV0YWlscygpOwogICAgICB9CiAgICAgIHRoaXMuY3VycmVudF90ZW1wbGF0ZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy50ZW1wbGF0ZWxpc3RbaW5kZXhdKSk7CiAgICAgIHRoaXMub2xkX3RlbXBsYXRlX25hbWUgPSB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfbmFtZTsKICAgICAgdGhpcy5jdXJyZW50X3RlbXBsYXRlX2luZGV4ID0gaW5kZXg7CiAgICAgIGlmIChCb29sZWFuKHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9pbWFnZV9uYW1lKSA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMuaXNfZWRpdF9pbWFnZV9uZWVkZWQgPSAieWVzIjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzX2VkaXRfaW1hZ2VfbmVlZGVkID0gIm5vbmUiOwogICAgICB9CiAgICAgIGlmICh0aGlzLnRlbXBsYXRlbGlzdFtpbmRleF0uZW1haWwgIT0gbnVsbCkgewogICAgICAgIHRoaXMuaXNfZWRpdF9lbWFpbCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc19lZGl0X2VtYWlsID0gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0W2luZGV4XS5zbXMgIT0gbnVsbCkgewogICAgICAgIHRoaXMuaXNfZWRpdF9zbXMgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNfZWRpdF9zbXMgPSBmYWxzZTsKICAgICAgfQogICAgICBpZiAoQm9vbGVhbih0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfaW1hZ2VfbmFtZSkgPT09IHRydWUpIHsKICAgICAgICB0aGlzLmVkaXRlZF9maWxlX2xhYmVsID0gdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX2ltYWdlX25hbWU7CiAgICAgICAgdGhpcy5vbGRfZWRpdGVkX2ltYWdlX25hbWUgPSB0aGlzLmVkaXRlZF9maWxlX2xhYmVsOwogICAgICAgIHRoaXMuZWRpdF9pbWdfcmVkaXJlY3RfdXJsID0gdGhpcy5jdXJyZW50X3RlbXBsYXRlLmltYWdlX3JlZGlyZWN0X3VybDsKICAgICAgICBpZiAodGhpcy5lZGl0ZWRfZmlsZV9sYWJlbCA9PSAiIikgewogICAgICAgICAgdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbCA9ICJDaG9vc2UgZmlsZSI7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwgPSAiQ2hvb3NlIGZpbGUiOwogICAgICAgIHRoaXMub2xkX2VkaXRlZF9pbWFnZV9uYW1lID0gdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbDsKICAgICAgICB0aGlzLmVkaXRfaW1nX3JlZGlyZWN0X3VybCA9ICIiOwogICAgICB9CiAgICB9LAogICAgZW1wdHlfdmFyaWFibGUoKSB7CiAgICAgIGlmKCF0aGlzLmRpc2FibGVfYnRuX2V4cGlyZWQpewogICAgICAgIHRoaXMuc2VuZF9lbWFpbF9hbGxfY3VzdG9tZXIgPSB0cnVlOwogICAgICAgIHRoaXMucXVpbGwuc2V0VGV4dCgiIik7CiAgICAgICAgdGhpcy5jdXN0b21lcnNfbGlzdCA9IFtdOwogICAgICAgIHRoaXMuc3BlY2lmaWNfY3VzdG9tZXJfbGlzdCA9IFtdOwogICAgICAgIHRoaXMuc2F2ZV9zbXMgPSAiIjsKICAgICAgICB0aGlzLmlzX2h0bWxfYm9keSA9IGZhbHNlOwogICAgICAgIHRoaXMuc2F2ZV9lbWFpbCA9ICIiOwogICAgICAgIHRoaXMudGVtcGxhdGVfbmFtZSA9ICIiOwogICAgICAgIHRoaXMub2xkX3RlbXBsYXRlX25hbWUgPSAiIjsKICAgICAgICB0aGlzLmlzX2VtYWlsID0gdHJ1ZTsKICAgICAgICB0aGlzLmlzX3NtcyA9IGZhbHNlOwogICAgICAgIHRoaXMuc2F2ZV9zdWJqZWN0ID0gIiI7CiAgICAgICAgdGhpcy5pc19wdWJsaXNoX2VtYWlsID0gdHJ1ZTsKICAgICAgICB0aGlzLnZlcmlmaWNhdGlvbl9zdGF0dXMgPSBudWxsOwogICAgICAgIHRoaXMuZmlsZV9sYWJlbCA9ICJDaG9vc2UgZmlsZSI7CiAgICAgICAgdGhpcy5pbWdfcmVkaXJlY3RfdXJsID0gIiI7CiAgICAgICAgdGhpcy5lbWFpbF9zdWJqZWN0ID0gIiI7CiAgICAgICAgdGhpcy5pc19pbWFnZV9uZWVkZWQgPSAibm9uZSI7CiAgICAgICAgdGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSBmYWxzZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVtcGxhdGVfbmFtZV9hZGRfaWQiKS5zdHlsZS5ib3JkZXIgPSBudWxsOwogICAgICB9ZWxzZSB7CiAgICAgICAgdGhpcy5zaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwoKTsKICAgICAgfQogICAgCiAgICB9LAogICAgZWRpdF90ZW1wbGF0ZV9kZXRhaWxzKCkgewogICAgICBpZiAoIXRoaXMuaXNFZGl0VGVtcGxhdGUpIHsKICAgICAgICB0aGlzLmlzRWRpdFRlbXBsYXRlID0gdHJ1ZTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHRoaXMuZWRpdF9lZGl0b3IoKTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZighdGhpcy5jdXJyZW50X3RlbXBsYXRlLmlzX2h0bWxfYm9keSl7CiAgICAgICAgICB2YXIgZWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdF9lZGl0b3JfdGVtcCcpOwogICAgICAgICAgZWxlbWVudHMucmVtb3ZlQ2hpbGQoZWxlbWVudHMuZmlyc3RFbGVtZW50Q2hpbGQpCiAgICAgICAgfQogICAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSBmYWxzZTsKICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgdGhpcy5lZGl0X3RlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgY2hhbmdlX2JvZHlfZm9ybWF0KCl7CiAgICAgICAgaWYoIXRoaXMuaXNfaHRtbF9ib2R5KSB7CiAgICAgICAgICB0aGlzLmlzX2h0bWxfYm9keSA9IHRydWU7CiAgICAgICAgICB0aGlzLnNhdmVfZW1haWwgPSAiIjsKICAgICAgICAgIC8vIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdG9yIik7CiAgICAgICAgICAvLyBlbGVtZW50LnJlbW92ZSgpOwogICAgICAgIH1lbHNlIHsKICAgICAgICAgIHRoaXMuaXNfaHRtbF9ib2R5ID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnNhdmVfZW1haWwgPSAiIjsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5lZGl0b3IoKTsKICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICB9CiAgICAgIC8vIH0sIDEwMDApOwogICAgfSwKICAgIGNoZWNrX2N1cnJlbnRfdGVtcGxhdGVfYWN0aXZlKGluZGV4KSB7CiAgICAgIC8vIGNvbnNvbGUudGFibGUoaW5kZXgsIHRoaXMudGVtcGxhdGVsaXN0W2luZGV4XSwgdGhpcy5jdXJyZW50X3RlbXBsYXRlKTsKICAgICAgaWYgKEJvb2xlYW4odGhpcy50ZW1wbGF0ZWxpc3RbaW5kZXhdKSA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybiB0aGlzLnRlbXBsYXRlbGlzdFtpbmRleF0udGVtcGxhdGVfbmFtZSA9PT0KICAgICAgICAgIHRoaXMub2xkX3RlbXBsYXRlX25hbWUKICAgICAgICAgID8gImN1cnJlbnQtYWN0aXZlLXRlbXBsYXRlIgogICAgICAgICAgOiBudWxsOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["EmailCampaign.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAs1BA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EmailCampaign.vue","sourceRoot":"src/portal/Chatbot/Dashboard/Campaigns","sourcesContent":["<template>\n    <div :class=\"is_notification_template === true ? '':'dash-cont'\" >\n      <div class=\"spinner\" id=\"spinner\" v-show=\"spinnerOn\"></div>\n      <div :class=\"is_notification_template === true ? 'container-fluid p-0' : 'container-fluid'\" id=\"email_page\">\n        <div class=\"card dash-card\" style=\"border: 0\">\n          <div class=\"card dash-card\">\n            <div\n              class=\"card-header d-block d-sm-flex flex-wrap justify-content-between\"\n            >\n            <h4 class=\"mb-sm-0\">{{tlt('Email Campaign')}}</h4>\n              <div class=\"card-act d-flex flex-wrap\">\n                <input\n                    class=\"form-control search-bar\"\n                    style=\"padding: 0px 15px; height: 36px !important;\"\n                    id=\"search_bar_id\"\n                    :placeholder=\"tlt('search_template')\"\n                    v-model.trim=\"search_name\"\n                    v-on:keyup=\"callsearch\"\n                />\n                <a\n                  type=\"button\"\n                  v-if=\"isVisibleSearchClear\"\n                  class=\"btn bg-transparent mt-auto mb-auto py-0\"\n                  @click=\"clear_search_name\"\n                  style=\"margin-left: -40px; z-index: 10\"\n                >\n                  <img src=\"/img/close-icn.png\" alt />\n                </a>\n                <a\n                  id=\"send_email_btn\"\n                  href=\"#\"\n                  class=\"darkblue-btn\"\n                  data-toggle=\"modal\"\n                  data-target=\"\"\n                  title=\"Send Email\"\n                  v-if=\"templatelist.length > 0 && is_notification_template === false\"\n                  @click=\"email_verification_status()\"\n                >\n                  {{tlt('mailer_page_send_email_btn')}}\n                </a>\n                <a\n                  id=\"add_template_btn\"\n                  href=\"#\"\n                  class=\"darkblue-btn\"\n                  v-if=\"disable_btn_expired\"\n                  title=\"Add new Template\"\n                  @click=\"empty_variable\"\n                >\n                  {{tlt('mailer_page_add_template_btn_expired')}}\n                </a>\n                <a\n                  id=\"add_template_btn\"\n                  href=\"#\"\n                  v-else\n                  class=\"darkblue-btn\"\n                  data-toggle=\"modal\"\n                  data-target=\"#templatemodel\"\n                  title=\"Add new Template\"\n                  @click=\"empty_variable\"\n                >\n                  {{tlt('mailer_page_add_template_btn')}}\n                </a>\n                <a\n                  href=\"javascript:void(0)\"\n                  class=\"red-btn\"\n                  @click=\"delete_selected\"\n                  id=\"delete_intent\"\n                >\n                  {{tlt('mailer_page_delete_btn')}}\n                </a>\n              </div>\n            </div>\n            <div\n              class=\"modal fade\"\n              id=\"preview_template_visible\"\n              role=\"dialog\"\n              aria-labelledby=\"preview_template_visible\"\n              aria-hidden=\"true\"\n            >\n              <div\n                class=\"modal-dialog modal-dialog-centered modal-lg\"\n                role=\"document\"\n              >\n                <div class=\"modal-content\">\n                  <div class=\"modal-header\">\n                    <h5 class=\"modal-title\">\n                      {{tlt('template_email_review_text')}}\n                    </h5>\n                    <button\n                      type=\"button\"\n                      class=\"close\"\n                      data-dismiss=\"modal\"\n                      aria-label=\"Close\"\n                    >\n                      <img src=\"/img/close-icn.png\" alt />\n                    </button>\n                  </div>\n                  <div class=\"modal-body\">\n                    <div v-html=\"preview_template_data\"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class=\"card-body py-0\" id=\"page\">\n              <div class=\"col-sm-12 d-flex px-0\" v-if=\"templatelist.length > 0\">\n                <div class=\"col-sm-4 pl-0\" style=\"height: 80vh; overflow-y: auto\">\n                  <div class=\"table-box\">\n                    <div class=\"table-responsive\">\n                      <table class=\"table\" style=\"overflow-y: auto\">\n                        <thead>\n                          <!-- <tr> -->\n                          <th scope=\"col\">\n                            <div class=\"form-check checkbox checkbox-success\">\n                              <label class=\"form-check-label\">\n                                <input\n                                  class=\"form-check-input\"\n                                  id=\"selectall\"\n                                  type=\"checkbox\"\n                                  @change=\"selected_templates('all')\"\n                                />\n                                <span class=\"icn\"></span>\n                              </label>\n                            </div>\n                          </th>\n                          <th\n                            scope=\"col\"\n                            class=\"text-left\"\n                            style=\"\n                              font: normal normal normal 16px/22px Roboto;\n                              letter-spacing: 0px;\n                              color: #414141;\n                            \"\n                          >\n                            {{tlt('template_header')}}\n                          </th>\n                          <!-- </tr> -->\n                        </thead>\n                        <tbody>\n                          <tr\n                            v-for=\"(template, index) in templatelist\"\n                            :key=\"index\"\n                            :class=\"check_current_template_active(index)\"\n                          >\n                            <td scope=\"col\">\n                              <div class=\"form-check checkbox checkbox-success\">\n                                <label class=\"form-check-label\">\n                                  <input\n                                    class=\"form-check-input\"\n                                    type=\"checkbox\"\n                                    :id='index'\n                                    @change=\"\n                                      selected_templates(template.template_id)\n                                    \"\n                                  />\n                                  <span class=\"icn\"></span>\n                                </label>\n                              </div>\n                            </td>\n                            <td\n                              style=\"cursor: pointer\"\n                              @click=\"show_template(index)\"\n                              :title=\"template.template_name\"\n                            >\n                              <template>\n                                <p style=\"margin-bottom: 0\">\n                                  {{ template.template_name }}\n                                </p>\n                              </template>\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n                    </div>\n                  </div>\n                </div>\n                <div\n                  class=\"col-sm-8 pr-0\"\n                  style=\"overflow-y: auto\"\n                  v-if=\"templatelist.length > 0\"\n                >\n                  <div style=\"border: 1px solid #dbe2e8\">\n                    <div class=\"col-sm-12\">\n                      <div style=\"color: #414141\" class=\"\">\n                        <h5 class=\"mb-0 pt-2 d-flex\">\n                          <span class=\"mt-2 mb-0\">{{tlt('template_details_header')}}</span>\n                          <a\n                            class=\"ml-auto mt-2 mb-0\"\n                            href=\"javascript:void(0)\"\n                            title=\"Click Here for Preview\"\n                            style=\"color: rgb(39, 54, 121)\"\n                            @click=\"preview_template\"\n                            data-toggle=\"modal\"\n                          >\n                            <p\n                              class=\"labe1\"\n                              style=\"margin-right: 1rem; font-size: 1.25rem\"\n                            >\n                              {{tlt('mailer_page_preview_btn')}}\n                            </p></a\n                          >\n                          <span\n                            @click=\"edit_template_details\"\n                            v-html=\"pencil_svg\"\n                            class=\"mr-2 mt-2\"\n                            style=\"cursor: pointer\"\n                          ></span>\n                        </h5>\n                      </div>\n                    </div>\n                    <hr style=\"margin-top: 0\" />\n                    <div class=\"col-sm-12\" style=\"margin-bottom: 1rem\">\n                      <h5>\n                        <p class=\"mt-2 mb-0\" style=\"color: #414141\">\n                          {{tlt('template_name_label')}}\n                        </p>\n                      </h5>\n                      <div v-if=\"!isEditTemplate\" style=\"padding-left: 20px\">\n                        <p>{{ current_template.template_name }}</p>\n                      </div>\n                      <div v-else>\n                        <input\n                          id=\"edit_template_name_id\"\n                          type=\"text\"\n                          v-model.trim=\"current_template.template_name\"\n                          v-on:keyup=\"validate_edit_template_name\"                    \n                          class=\"form-control\"\n                          style=\"padding: 0.375rem 0.75rem\"\n                          :placeholder=\"tlt('template_name_label')\"\n                        />\n                        <span\n                          v-show=\"edit_template_name_already_exist\"\n                          style=\"color: red\"\n                          >{{tlt('template_name_exist')}}</span\n                        >\n                      </div>\n                    </div>\n                    <div class=\"col-sm-12\" style=\"margin-bottom: 1rem\">\n                      <h5>\n                        <p class=\"mt-2 mb-0\" style=\"color: #414141\">\n                          {{tlt('email_subject_label')}}\n                        </p>\n                      </h5>\n                      <div v-if=\"!isEditTemplate\" style=\"padding-left: 20px\">\n                        <p>{{ current_template.subject }}</p>\n                      </div>\n                      <div v-else>\n                        <input\n                          type=\"text\"\n                          v-model.trim=\"current_template.subject\"\n                          class=\"form-control\"\n                          style=\"padding: 0.375rem 0.75rem\"\n                          :placeholder=\"tlt('email_subject')\"\n                        />\n                      </div>\n                    </div>\n                    <div\n                      v-if=\"!isEditTemplate && current_template.email != null\"\n                      class=\"col-sm-12\"\n                      style=\"margin-bottom: 1rem\"\n                    >\n                      <h5>\n                        <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('email_body_label')}}</p>\n                      </h5>\n                      <div style=\"padding-left: 20px\">\n                        <span v-html=\"current_template.email\"></span>\n                      </div>\n                    </div>\n                    <div\n                      v-else-if=\"is_edit_email && isEditTemplate\"\n                      class=\"col-sm-12\"\n                      style=\"margin-bottom: 1rem\"\n                    >\n                      <h5>\n                        <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('email_body_label')}}</p>\n                      </h5>\n                      <!-- <div>\n                        <vue-editor\n                          v-model=\"current_template.email\"\n                          :editorToolbar=\"customToolbar\"\n                        ></vue-editor>\n                      </div> -->\n                      <div id=\"edit_editor_temp\" v-if=\"!Boolean(current_template.is_html_body)\" class=\"form-group\">\n                        <div id=\"edit_editor\"></div>\n                      </div>\n                      <div v-if=\"current_template.is_html_body\">\n                        <textarea name=\"\" v-model=\"current_template.email\" id=\"\" rows=\"8\" style=\"width: 100%;\"></textarea>\n                      </div>\n                    </div>\n                    <div\n                      v-if=\"\n                        !isEditTemplate &&\n                        Boolean(current_template.template_image_name) === true &&\n                        Boolean(current_template.image_redirect_url) === true\n                      \"\n                      class=\"col-sm-12\"\n                      style=\"margin-bottom: 1rem\"\n                    >\n                      <h5>\n                        <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('image_name_label')}}</p>\n                      </h5>\n                      <div style=\"padding-left: 20px\">\n                        <p>{{ current_template.template_image_name }}</p>\n                      </div>\n                      <h5>\n                        <p class=\"mt-2 mb-0\" style=\"color: #414141\">\n                          {{tlt('image_redirect_label')}}\n                        </p>\n                      </h5>\n                      <p>\n                        {{tlt('redirected_link_text')}}\n                      </p>\n                      <div style=\"padding-left: 20px\">\n                        <p>{{ current_template.image_redirect_url }}</p>\n                      </div>\n                    </div>\n                    <div\n                      v-else-if=\"isEditTemplate && !Boolean(current_template.is_html_body)\"\n                      class=\"col-sm-12\"\n                      style=\"margin-bottom: 1rem\"\n                    >\n                      <h5>\n                        {{tlt('add_img_in_email_label')}}<label\n                          style=\"\n                            font-size: 17px;\n                            font-weight: 400;\n                            padding-left: 0.3rem;\n                          \"\n                        >\n                          {{tlt('image_desc_label')}}\n                        </label>\n                      </h5>\n  \n                      <div style=\"display: flex; margin: 1%\">\n                        <div class=\"radio\">\n                          <label style=\"vertical-align: text-top\">\n                            <input\n                              type=\"radio\"\n                              value=\"yes\"\n                              name=\"is_edit_image_needed\"\n                              v-model=\"is_edit_image_needed\"\n                            />\n                            <span class=\"icn\" id=\"radio\"></span>\n                            {{tlt('img_in_email_yes_label')}}\n                          </label>\n                        </div>\n                        <div class=\"radio\" style=\"margin-left: 2%\">\n                          <label style=\"vertical-align: text-top\">\n                            <input\n                              type=\"radio\"\n                              value=\"none\"\n                              name=\"is_edit_image_needed\"\n                              v-model=\"is_edit_image_needed\"\n                            />\n                            <span class=\"icn\" id=\"radio\"></span>\n                            {{tlt('img_in_email_no_label')}}\n                          </label>\n                        </div>\n                      </div>\n                      <div\n                        class=\"custom-file\"\n                        v-if=\"is_edit_image_needed == 'yes'\"\n                        style=\"margin-bottom: 1rem\"\n                      >\n                        <input\n                          type=\"file\"\n                          class=\"custom-file-input\"\n                          @change=\"fileinput2\"\n                          id=\"inputFile2\"\n                        />\n                        <label\n                          style=\"\n                            font-weight: 400;\n                            line-height: 10px;\n                            padding-left: 15px;\n                          \"\n                          class=\"custom-file-label form-control\"\n                          for=\"file\"\n                          >{{ edited_file_label }}</label\n                        >\n                      </div>\n                      <div v-if=\"is_edit_image_needed == 'yes'\">\n                        <h5>{{tlt('image_redirect_url_label')}}</h5>\n                        <label>\n                          {{tlt('redirected_url_link_text')}}\n                        </label>\n                        <input\n                          type=\"text\"\n                          v-model=\"edit_img_redirect_url\"\n                          class=\"form-control\"\n                          style=\"padding: 0.375rem 0.75rem\"\n                          :placeholder=\"tlt('url_example')\"\n                        />\n                      </div>\n                    </div>\n  \n                    <div\n                      v-if=\"!isEditTemplate && current_template.sms != null\"\n                      class=\"col-sm-12\"\n                      style=\"margin-bottom: 1rem\"\n                    >\n                      <h5>\n                        <p class=\"mt-2 mb-0\" style=\"color: #414141\">SMS</p>\n                      </h5>\n                      <div style=\"padding-left: 20px\">\n                        <p>{{ current_template.sms }}</p>\n                      </div>\n                    </div>\n                    <div\n                      v-else-if=\"is_edit_sms && isEditTemplate\"\n                      class=\"col-sm-12\"\n                      style=\"margin-bottom: 1rem\"\n                    >\n                      <h5>\n                        <p class=\"mt-2 mb-0\" style=\"color: #414141\">SMS</p>\n                      </h5>\n                      <div>\n                        <textarea\n                          maxlength=\"160\"\n                          class=\"form-control\"\n                          style=\"padding: 0.375rem 0.75rem\"\n                          v-model=\"current_template.sms\"\n                          id=\"exampleFormControlTextarea1\"\n                          rows=\"3\"\n                        >\n                        </textarea>\n                      </div>\n                    </div>\n                    <div class=\"modal-footer\" v-if=\"isEditTemplate\">\n                      <div class=\"dash-modal\">\n                        <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n                          <button\n                            type=\"button\"\n                            class=\"btn btn-link\"\n                            style=\"border-radius: 0\"\n                            data-dismiss=\"modal\"\n                            @click=\"edit_template_details\"\n                          >\n                            {{tlt('product_config_mailer_cancel_btn')}}\n                          </button>\n                          <button\n                            type=\"submit\"\n                            class=\"darkblue-btn\"\n                            id=\"res_n_int_save\"\n                            @click=\"edit_template()\"\n                          >\n                            {{tlt('product_config_mailer_save_btn')}}\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"col-sm-12 d-flex px-0 py-5\" v-else-if=\"!spinnerOn\">\n                <h4 class=\"mx-auto\">\n                  {{tlt('no_template_data_text')}}\n                </h4>\n              </div>\n              <div class=\"pagin-table pb-3\" style=\"margin-top: 2%\" v-if=\"templatelist.length > 0\">\n                <nav aria-label=\"Page navigation example\">\n                  <ul class=\"pagination justify-content-center\">\n                    <li class=\"page-item\">\n                      <a\n                        class=\"page-link\"\n                        href=\"#\"\n                        @click=\"page_require(page_no - 1)\"\n                      >\n                        <svg\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                          width=\"8.667\"\n                          height=\"15.204\"\n                          viewBox=\"0 0 8.667 15.204\"\n                        >\n                          <g\n                            id=\"arrow-point-to-left\"\n                            transform=\"translate(105.806 15.204) rotate(180)\"\n                          >\n                            <path\n                              id=\"Path_1136\"\n                              data-name=\"Path 1136\"\n                              d=\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\"\n                              transform=\"translate(0 0)\"\n                              fill=\"#9499ae\"\n                            />\n                          </g>\n                        </svg>\n                      </a>\n                    </li>\n                    <li\n                      :class=\"'page-item ' + pagination_class(pageno)\"\n                      v-for=\"pageno in page_array\"\n                      :key=\"pageno\"\n                    >\n                      <a\n                        v-if=\"pageno == '...s' || pageno == '...l'\"\n                        class=\"page-link\"\n                        href=\"#\"\n                        @click=\"page_require(pageno)\"\n                        >...</a\n                      >\n                      <a\n                        v-if=\"pageno != '...s' && pageno != '...l'\"\n                        class=\"page-link\"\n                        href=\"#\"\n                        @click=\"page_require(pageno)\"\n                        >{{ pageno }}</a\n                      >\n                    </li>\n                    <li class=\"page-item\">\n                      <a\n                        class=\"page-link\"\n                        href=\"#\"\n                        @click=\"page_require(page_no + 1)\"\n                      >\n                        <svg\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                          width=\"8.667\"\n                          height=\"15.204\"\n                          viewBox=\"0 0 8.667 15.204\"\n                        >\n                          <g\n                            id=\"arrow-point-to-right\"\n                            transform=\"translate(-97.139 0)\"\n                          >\n                            <path\n                              id=\"Path_1136\"\n                              data-name=\"Path 1136\"\n                              d=\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\"\n                              transform=\"translate(0 0)\"\n                              fill=\"#9499ae\"\n                            />\n                          </g>\n                        </svg>\n                      </a>\n                    </li>\n                  </ul>\n                </nav>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div\n        id=\"sendemail\"\n        class=\"modal fade dash-modal\"\n        role=\"dialog\"\n        data-backdrop=\"static\"\n        data-keyboard=\"false\"\n      >\n        <div class=\"modal-dialog\">\n          <div class=\"modal-content\">\n            <div class=\"modal-body\">\n              <div class=\"modal-head d-flex align-items-center\">\n                <div class=\"head-icn\">\n                  <img src=\"/img/msg-blue.png\" alt />\n                </div>\n                <h3>{{tlt('email_model_sender_email_header')}}</h3>\n                <button\n                  type=\"button\"\n                  class=\"close close_btn\"\n                  @click=\"empty_variable\"\n                  data-dismiss=\"modal\"\n                >\n                  <img src=\"/img/close-icn.png\" alt />\n                </button>\n              </div>\n              <div class=\"form-group\">\n                <h5>\n                  <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('email_model_template_name_header')}}</p>\n                </h5>\n                <div style=\"padding-left: 20px\">\n                  <p>{{ current_template.template_name }}</p>\n                </div>\n              </div>\n              <div class=\"form-group\">\n                <div class=\"d-flex\">\n                  <h5>\n                    <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('email_model_send_email_header')}}</p>\n                  </h5>\n                  <span\n                    v-if=\"!send_email_all_customer\"\n                    style=\"\n                      margin-left: 12px;\n                      margin-top: 10px !important;\n                      color: #0645ad;\n                    \"\n                  >\n                    <i\n                      class=\"fa fa-info-circle\"\n                      aria-hidden=\"true\"\n                      style=\"font-size: 16px\"\n                      title=\"you can also specify name while adding new email in this way (john.d@mail.com,John Doe), note this would only work in the case where you add new email.\"\n                    >\n                    </i>\n                  </span>\n                </div>\n                <div class=\"radio my-auto\" style=\"padding-left: 20px\">\n                  <label>\n                    <input\n                      type=\"radio\"\n                      v-model=\"send_email_all_customer\"\n                      :value=\"true\"\n                      id=\"send_email_all_customer_true_id\"\n                    />\n                    <span class=\"icn\" id=\"filter_portal_user_radio\"></span>\n                    {{tlt('email_model_all_customer_label')}}\n                  </label>\n                  <label>\n                    <input\n                      type=\"radio\"\n                      v-model=\"send_email_all_customer\"\n                      :value=\"false\"\n                      id=\"send_email_all_customer_false_id\"\n                    />\n                    <span class=\"icn\"></span>\n                    {{tlt('email_model_specific_customer_label')}}\n                  </label>\n                </div>\n              </div>\n              <div class=\"form-group\" v-if=\"!send_email_all_customer\">\n                <multiselect\n                  v-model=\"specific_customer_list\"\n                  :options=\"customers_list\"\n                  id=\"specific_customer_list_id\"\n                  :searchable=\"true\"\n                  :close-on-select=\"false\"\n                  :multiple=\"true\"\n                  :taggable=\"true\"\n                  tag-position=\"top\"\n                  tag-placeholder=\"Add this as new email\"\n                  :placeholder=\"tlt('search_customer_email')\"\n                  :max-height=\"400\"\n                  label=\"email\"\n                  track-by=\"email\"\n                  open-direction=\"below\"\n                  @tag=\"addTag\"\n                >\n                  <!-- <span>{{ selected_role }}</span> -->\n                </multiselect>\n              </div>\n            </div>\n            <div class=\"modal-footer\">\n              <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n                <button\n                  type=\"button\"\n                  class=\"btn btn-link\"\n                  data-dismiss=\"modal\"\n                  @click=\"empty_variable\"\n                >\n                  {{tlt('template_model_cancel_btn')}}\n                </button>\n                <button\n                  type=\"submit\"\n                  class=\"darkblue-btn\"\n                  id=\"res_n_int_save\"\n                  @click=\"send_email()\"\n                >\n                 {{tlt('send_btn')}} \n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div\n        id=\"templatemodel\"\n        class=\"modal fade dash-modal\"\n        role=\"dialog\"\n        data-backdrop=\"static\"\n        data-keyboard=\"false\"\n      >\n        <div class=\"modal-dialog modal-lg\">\n          <div class=\"modal-content\">\n            <div class=\"modal-body\">\n              <div class=\"modal-head d-flex align-items-center\">\n                <div class=\"head-icn\">\n                  <img src=\"/img/msg-blue.png\" alt />\n                </div>\n                <h3>{{tlt('template_model_header')}}</h3>\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">\n                  <img src=\"/img/close-icn.png\" alt />\n                </button>\n              </div>\n              <div class=\"form-group\">\n                <label>{{tlt('template_model_name_label')}}</label>\n                <input\n                  id=\"template_name_add_id\"\n                  type=\"text\"\n                  v-on:keyup=\"validate_template_name\"\n                  v-model.trim=\"template_name\"\n                  class=\"form-control\"\n                  :placeholder=\"tlt('template_name_label')\"\n                />\n                <span v-show=\"template_name_already_exist\" style=\"color: red\"\n                  >{{tlt('template_model_name_text')}}</span\n                >\n              </div>\n              <div class=\"form-group\">\n                <label>{{tlt('template_model_email_sub_label')}}</label>\n                <input\n                  type=\"text\"\n                  v-model=\"email_subject\"\n                  class=\"form-control\"\n                  :placeholder=\"tlt('email_subject')\"\n                />\n              </div>\n              <div class=\"form-group\" v-show=\"is_email\">\n                <div class=\"d-flex\">\n                  <label\n                    style=\"\n                      margin-top: 2px !important;\n                      margin-bottom: 7px !important;\n                    \"\n                    >{{tlt('template_model_email_body_label')}}</label\n                  >\n                  <span\n                    style=\"\n                      margin-left: 12px;\n                      margin-bottom: 5px !important;\n                      color: #0645ad;\n                    \"\n                  >\n                    <i\n                      class=\"fa fa-info-circle\"\n                      aria-hidden=\"true\"\n                      style=\"font-size: 16px\"\n                      title=\"To Display customer full name in email body use {full_name} and for customer first name use {first_name}. (Example Hi {full_name} would display Hi FirstName LastName).\"\n                    >\n                    </i>\n                  </span>\n                   <label\n                    class=\"ml-auto\"\n                    style=\"\n                      margin-top: 2px !important;\n                      margin-right: 10px;\n                      margin-bottom: 7px !important;\n                    \"\n                    >{{tlt('html_body_label')}}</label\n                  >\n                  <label class=\"switch col-sm-1\" style=\"margin-top:0px;\">\n                    <input\n                      type=\"checkbox\"\n                      @click=\"change_body_format\"\n                      v-model=\"is_html_body\"\n                      id=\"is_display_banner_on_landing_id\"\n                    />\n                    <span\n                      class=\"slider round\"\n                      style=\"border-radius: 50px;\"\n                    ></span>\n                  </label>\n                </div>\n                <!-- <vue-editor\n                  v-model=\"save_email\"\n                  :editorToolbar=\"customToolbar\"\n                ></vue-editor> -->\n                <div v-if=\"!is_html_body\" class=\"form-group\">\n                  <div id=\"editor\"></div>\n                </div>\n                <div v-if=\"is_html_body\">\n                  <textarea name=\"\" v-model=\"save_email\" id=\"\" rows=\"8\" style=\"width: 100%;\"></textarea>\n                </div>\n              </div>\n              <div v-if=\"!is_html_body\" class=\"form-group\">\n                <label>{{tlt('template_model_add_img_label')}}</label>\n                <label style=\"padding-left: 0.3rem\">\n                  {{tlt('template_model_add_img_text')}}\n                </label>\n                <div style=\"display: flex; margin: 1%\">\n                  <div class=\"radio\">\n                    <label style=\"vertical-align: text-top\">\n                      <input\n                        type=\"radio\"\n                        value=\"yes\"\n                        name=\"is_image_needed\"\n                        v-model=\"is_image_needed\"\n                      />\n                      <span class=\"icn\" id=\"radio\"></span>\n                      Yes\n                    </label>\n                  </div>\n                  <div class=\"radio\" style=\"margin-left: 2%\">\n                    <label style=\"vertical-align: text-top\">\n                      <input\n                        type=\"radio\"\n                        value=\"none\"\n                        name=\"is_image_needed\"\n                        v-model=\"is_image_needed\"\n                      />\n                      <span class=\"icn\" id=\"radio\"></span>\n                      No\n                    </label>\n                  </div>\n                </div>\n                <div class=\"custom-file\" v-if=\"is_image_needed == 'yes'\">\n                  <input\n                    type=\"file\"\n                    class=\"custom-file-input\"\n                    @change=\"fileinput1\"\n                    id=\"inputFile\"\n                  />\n                  <label\n                    style=\"\n                      font-weight: 400;\n                      line-height: 20px;\n                      padding-left: 15px;\n                    \"\n                    class=\"custom-file-label form-control\"\n                    for=\"file\"\n                    >{{ file_label }}</label\n                  >\n                </div>\n              </div>\n              <div class=\"form-group\" v-if=\"is_image_needed == 'yes' && !is_html_body\">\n                <label>{{tlt('template_model_image_url_label')}}</label>\n                <label>\n                  {{tlt('template_model_redirected_link_text')}}\n                </label>\n                <input\n                  type=\"text\"\n                  v-model=\"img_redirect_url\"\n                  class=\"form-control\"\n                  :placeholder=\"tlt('url_example')\"\n                />\n              </div>\n            </div>\n            <div class=\"modal-footer\">\n              <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n                <button\n                  type=\"button\"\n                  class=\"btn btn-link\"\n                  data-dismiss=\"modal\"\n                  @click=\"empty_variable\"\n                >\n                  {{tlt('template_model_cancel_btn')}}\n                </button>\n                <button\n                  type=\"submit\"\n                  class=\"darkblue-btn \"\n                  id=\"save_template_btn\"\n                  data-dismiss=\"\"\n                  @click=\"save_template()\"\n                >\n                  {{tlt('template_model_save_btn')}}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import { VueEditor } from \"vue2-editor\";\n  import axios from \"axios\";\n  import swal from \"sweetalert2\";\n  import Swal from \"sweetalert2\";\n  import api_calls from \"@/portal/api_calls\";\n  import { freeze_portal,show_subscription_expired_swal , close_modal} from \"@/portal/mixins\";\n  import Multiselect from \"vue-multiselect\";\n  \n  export default {\n    name: \"EmailCampaignPage\",\n    components: {\n      VueEditor,\n      Multiselect,\n    },\n    mixins: [freeze_portal,show_subscription_expired_swal , close_modal],\n    data() {\n      return {\n        pencil_svg:\n          ' <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15.546\" height=\"15.461\" viewBox=\"0 0 15.546 15.461\"><defs><style>.a{fill:#9e9e9e;}</style></defs><g transform=\"translate(-747.888 -356.769)\"><path class=\"a\" d=\"M759.416,356.769a2.358,2.358,0,0,1,1.777.662c.534.513,1.072,1.025,1.567,1.575a2.3,2.3,0,0,1-.071,3.325c-2.736,2.76-5.494,5.5-8.238,8.251a1.381,1.381,0,0,1-.758.288c-.719.174-1.429.379-2.144.572-.932.251-1.862.5-2.795.751-.6.158-.989-.213-.832-.807q.689-2.595,1.406-5.182a1.164,1.164,0,0,1,.289-.487q4.091-4.107,8.2-8.2A2.265,2.265,0,0,1,759.416,356.769Zm-1.989,2.956-6.54,6.538,3.025,3.024,6.538-6.537Zm4.023,2.165c.118-.135.225-.269.343-.392a1.134,1.134,0,0,0,0-1.734c-.46-.466-.926-.925-1.388-1.39a1.166,1.166,0,0,0-.861-.368c-.578,0-.881.4-1.214.76Zm-12.084,8.863,3.2-.863-2.337-2.331Z\" transform=\"translate(0)\"/><path class=\"a\" d=\"M813.942,422.6l-.789-.8,3.821-3.819.784.8Z\" transform=\"translate(-59.648 -55.947)\"/></g></svg>',\n        company_id: this.$session.get(\"UserInformation\").company_id,\n        company_name: this.$session.get(\"UserInformation\").company_name,\n        spinnerOn: false,\n        template_name: \"\",\n        save_sms: \"\",\n        save_email: \"\",\n        is_sms: false,\n        is_email: true,\n        save_subject: \"\",\n        is_publish_email: true,\n        is_publish_sms: true,\n        is_edit_sms: false,\n        is_edit_email: true,\n        verification_status: null,\n        templatelist: [],\n        checked_list: [],\n        customToolbar: [\n          [\"bold\", \"italic\", \"underline\"],\n          [{ align: [] }],\n          [{ color: [] }, { background: [] }],\n          [{ list: \"ordered\" }, { list: \"bullet\" }],\n          [\"link\"],\n        ],\n        quill: \"\",\n        quill_edit: \"\",\n        is_html_body: false,\n        slot_variable:{},\n        current_template: [],\n        old_template_name: \"\",\n        isEditTemplate: false,\n        number_of_rows: null,\n        total_pages: null,\n        page_no: 1,\n        per_page: 10,\n        image_file: null,\n        image_file_2: null,\n        is_image_needed: \"none\",\n        is_edit_image_needed: \"none\",\n        email_subject: \"\",\n        reg_url:\n          /https:\\/\\/[(www\\.)?a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&\\/\\/=]*)/i,\n        is_edit_reg_url:\n          /https:\\/\\/[(www\\.)?a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&\\/\\/=]*)/i,\n        img_redirect_url: \"\",\n        edit_img_redirect_url: \"\",\n        file_label: \"Choose file\",\n        edited_file_label: \"Choose file\",\n        preview_template_data: \"\",\n        template_name_already_exist: false,\n        edit_template_name_already_exist: false,\n        page_array: [],\n        send_email_all_customer: true,\n        customers_list: [],\n        specific_customer_list: [],\n        disable_btn_expired: false,\n        email_reg:\n          /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,\n        search_name: \"\",\n        isVisibleSearchClear: false,\n      };\n    },\n    props: {\n      is_notification_template: Boolean,\n    },\n    watch: {\n      search_name() {\n        if (this.search_name === \"\") {\n          this.load_templates();\n          this.isVisibleSearchClear = false;\n        } else if (this.search_name !== \"\") {\n          this.isVisibleSearchClear = true;\n        }\n      },\n      // is_notification_template() {\n      //   console.log(this.is_notification_template);\n      // },\n    },\n    computed: {\n      validURL() {\n        if (this.reg_url.test(this.img_redirect_url)) {\n          return true;\n        } else {\n          return false;\n        }\n      },\n      valid_edit_URL() {\n        if (this.is_edit_reg_url.test(this.edit_img_redirect_url)) {\n          return true;\n        } else {\n          return false;\n        }\n      },\n    },\n    created() {\n      if (this.$session.get(\"UserInformation\").role == \"SuperAdmin\") {\n        this.companyid = this.$session.get(\"CompanyId\");\n        this.companyname = this.$session.get(\"CompanyName\");\n      } else {\n        this.companyid = this.$session.get(\"UserInformation\").company_id;\n        this.companyname = this.$session.get(\"UserInformation\").company_name;\n      }\n    },\n    mounted() {\n      setTimeout(() => {\n        this.freeze_portal();\n      }, 1000);\n       this.$root.$on(\"EmailTemplatePageDisabled\", (data) =>{\n        if(data===true){\n          this.disable_btn_expired = true;\n          this.show_subscription_expired_swal();\n        }\n      })\n      this.load_templates();\n      if (this.is_notification_template === false){\n        this.load_customer_list();\n      }\n      var vm = this;\n      $(\"#selectall\").click(function () {\n        this.isEditTemplate = false;\n        this.is_sms = false;\n        this.is_email = true;\n        if ($(this).is(\":checked\")) {\n          $(\"input:checkbox\").prop(\"checked\", true);\n        } else {\n          vm.checked_list = [];\n          $(\"input:checkbox\").prop(\"checked\", false);\n        }\n      });\n      this.editor();\n      if (this.is_notification_template === true){\n        this.load_slot_variable();\n      }\n    },\n    methods: {\n      clear_search_name() {\n        this.search_name = \"\";\n      },\n      callsearch() {\n        if (this.search_name != \"\"){\n          this.spinnerOn = true;\n          axios\n            .post(\n              api_calls.template_promotional_email_campaign(),\n              {\n                company_id: this.company_id,\n                company_name: this.company_name,\n                is_search: true,\n                page_no: 1,\n                per_page: this.per_page,\n                is_notification: this.is_notification_template,\n                search_key: this.search_name\n              },\n              {\n                headers: {\n                  Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                },\n              }\n            )\n            .then((response) => {\n              this.spinnerOn = false;\n              this.templatelist = [];\n              this.number_of_rows = response.data.pagination.total_data == undefined ? 0 : response.data.pagination.total_data;\n              this.total_pages = response.data.pagination.total_page == undefined ? 0 : response.data.pagination.total_page;\n              if (this.api_status_code.TEMPLATE_DOES_NOT_EXISTS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n                this.templatelist = [];\n                return;\n              } else if (this.api_status_code.TEMPLATE_SEARCH_RESULT_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n                this.templatelist = response.data.data.template_search;\n                if (this.templatelist.length > 0) {\n                  this.show_template(0);\n                }\n              } else {\n                Swal({\n                  title: response.data.message.MSG_CODE,\n                  text: response.data.message.MSG,\n                  showCancelButton: false,\n                  showConfirmButton: false,\n                  type: \"error\"\n                })\n              }\n              this.isEditTemplate = false;\n              this.setpagination(1);\n            })\n            .catch((e) => {\n              this.spinnerOn = false;\n              if (\n                e.response.status === 410 ||\n                e.response.status === 440 ||\n                e.response.status === 409\n              ) {\n                this.$root.$emit(\"Session_Expired\", e.response.data);\n              }\n            });\n        }\n      },\n      load_slot_variable(){\n        this.spinnerOn = true;\n        axios\n          .post(\n            api_calls.form_automation_dialog_tree(),\n            {\n              company_id: this.$session.get(\"UserInformation\").company_id,\n              company_name: this.$session.get(\"UserInformation\").company_name,\n              is_get_slot_variable: true,\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            if (this.api_status_code.DATA_AVAILABLE_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              this.slot_variable = {};\n              for (let index = 0; index < response.data.data.slots_list.length; index++) {\n                const element = response.data.data.slots_list[index];\n                this.slot_variable[element] = '{' + element + '}';\n              }\n            // this.insert_variable('quill', this.slot_variable);\n            } else if(this.api_status_code.NO_SLOTS_FOUND_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            } else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n          })\n          .catch((e) => {\n            // this.insert_variable('quill', this.slot_variable);\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      },\n      editor(){\n        this.quill = new Quill(\"#editor\", {\n          modules: {\n            toolbar: [\n              [\"bold\", \"italic\", \"underline\"],\n              [\"link\"],\n              [{ align: [] }],\n              [{ color: [] }, { background: [] }],\n              [{ list: \"ordered\" }, { list: \"bullet\" }],\n            ],\n          },\n          theme: \"snow\",\n        });\n        this.quill.on(\"text-change\", () => {\n          this.$emit(\n            \"input\",\n            this.quill.getText() ? this.quill.root.innerHTML : \"\"\n          );\n          this.save_email = this.quill.getText() ? this.quill.root.innerHTML : \"\";\n        });\n        if(this.is_notification_template) {\n          this.insert_variable('quill', this.slot_variable);\n        }\n      },\n      edit_editor(){\n        this.quill_edit = new Quill(\"#edit_editor\", {\n        modules: {\n          toolbar: [\n            [\"bold\", \"italic\", \"underline\"],\n            [\"link\"],\n            [{ align: [] }],\n            [{ color: [] }, { background: [] }],\n            [{ list: \"ordered\" }, { list: \"bullet\" }],\n          ],\n        },\n        theme: \"snow\",\n      });\n      this.quill_edit.on(\"text-change\", () => {\n        this.$emit(\n          \"input\",\n          this.quill_edit.getText() ? this.quill_edit.root.innerHTML : \"\"\n        );\n        this.current_template.email = this.quill_edit.getText() ? this.quill_edit.root.innerHTML : \"\";\n      });\n      this.quill_edit.root.innerHTML = this.current_template.email;\n      this.insert_variable('quill_edit', this.slot_variable);\n      },\n      insert_variable(val, slot_variable){\n        if (this.is_notification_template === true){\n          const dropDownItems = {\n          'No slot variable': '',\n          }\n          const myDropDown = new QuillToolbarDropDown({\n              label: \"Insert Variable\",\n              rememberSelection: false,\n              id: \"dropdown_id\"\n          })\n          if(Object.entries(slot_variable).length === 0 && slot_variable.constructor === Object){\n            myDropDown.setItems(dropDownItems);\n          }else {\n            myDropDown.setItems(slot_variable);\n          }\n          myDropDown.onSelect = function(label, value, quill) {\n              const { index, length } = quill.selection.savedRange\n              quill.deleteText(index, length)\n              quill.insertText(index, value)\n              quill.setSelection(index + value.length)\n          }\n          myDropDown.attach(this.quill)\n          if (val === 'quill_edit'){\n            myDropDown.attach(this.quill_edit)\n          }\n        }\n      },\n      addTag(newTag) {\n        var tag_list = [];\n        tag_list = newTag.split(\",\");\n        if (tag_list.length > 2) {\n          swal({\n            text: this.tlt('email_temp_add_valid_tag_msg'),\n            type: \"warning\",\n            showConfirmButton: true,\n            timer: 4500,\n          });\n          return;\n        } else {\n          var email = tag_list[0];\n          var customer_name = Boolean(tag_list[1]) ? tag_list[1] : \" \";\n          if (!this.email_reg.test(email)) {\n            swal({\n              text: this.tlt('email_temp_valid_email_addr_msg'),\n              type: \"warning\",\n              showConfirmButton: true,\n              timer: 4500,\n            });\n            return;\n          }\n        }\n        const tag = {\n          customer_name: customer_name,\n          email: email,\n        };\n        this.customers_list.push(tag);\n        this.specific_customer_list.push(tag);\n      },\n      load_customer_list() {\n        this.spinnerOn = true;\n        axios\n          .post(\n            api_calls.send_offer_to_customers(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              email: this.$session.get(\"UserInformation\").email,\n              license_key: this.$session.get(\"UserInformation\").license_key,\n              token: this.$session.get(\"UserInformation\").tokens,\n              get_customers_list: true,\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            if (this.api_status_code.STATUS_SUCCESS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n              this.customers_list = response.data.data.customers_list;\n            } else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n          })\n          .catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      },\n      email_verification_status() {\n        if(!this.disable_btn_expired){\n        this.spinnerOn = true;\n        axios\n          .post(\n            api_calls.product_settings(),\n            {\n              company_name: this.companyname,\n              company_id: this.companyid,\n              email: this.$session.get(\"UserInformation\").email,\n              license_key: this.$session.get(\"UserInformation\").license_key,\n              token: this.$session.get(\"UserInformation\").tokens,\n              is_email_verification_status: true,\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            if (\n              this.api_status_code.DATA_AVAILABLE.MSG_CODE == response.data.message.MSG_CODE\n            ) {\n              this.verification_status = response.data.data.verification_status;\n              // console.log(this.verification_status);\n              if (this.verification_status == \"Success\") {\n                // if (!document.getElementById(\"publish_template_btn\").disabled) {\n                $(\"#sendemail\").modal(\"show\");\n                this.load_customer_list();\n                // }\n              } else {\n                swal({\n                  text: this.tlt('email_temp_not_config_instruction_msg'),\n                  type: \"error\",\n                  showConfirmButton: true,\n                  timer: 13000,\n                });\n              }\n            } else if(this.api_status_code.EMAIL_NOT_CONFIGURED.MSG_CODE == response.data.message.MSG_CODE) {\n              swal({\n                  text: this.tlt('email_temp_not_config_instruction_msg1'),\n                  type: \"warning\",\n                  showConfirmButton: true,\n                  timer: 13000,\n                });\n            } \n            else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n          })\n          .catch((e) => {\n            this.spinnerOn = false;\n            toastr.error(this.tlt('email_temp_not_config_error_occur_msg'));\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n        }else{\n          this.show_subscription_expired_swal();\n        }\n      },\n      validate_template_name() {\n        axios.post(\n          api_calls.template_promotional_email_campaign(),\n          {\n             company_name: this.companyname,\n              company_id: this.companyid,\n              email: this.$session.get(\"UserInformation\").email,\n              license_key: this.$session.get(\"UserInformation\").license_key,\n              token: this.$session.get(\"UserInformation\").tokens,\n              subscription: this.$session.get(\"UserInformation\").subscription,\n              is_template_present: true,\n              is_notification: this.is_notification_template,\n              template_name: this.template_name,\n          },\n          {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n        )\n        .then((response) =>{\n          if (this.api_status_code.NOT_EXISTS_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              this.template_name_already_exist = false;\n              document.getElementById(\"template_name_add_id\").style.border =null;\n              if(this.template_name != \"\"){\n                document.getElementById(\"template_name_add_id\").style.border =\n                \"1px solid #00f000\";\n              }\n          } else if (this.api_status_code.ALREADY_EXISTS_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n            this.template_name_already_exist = true;\n              document.getElementById(\"template_name_add_id\").style.border =\n              \"1px solid red\";\n          } else {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n          }\n          })\n          .catch((e) => {\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      },\n      validate_edit_template_name() {\n        axios.post(\n          api_calls.template_promotional_email_campaign(),\n          {\n             company_name: this.companyname,\n              company_id: this.companyid,\n              email: this.$session.get(\"UserInformation\").email,\n              license_key: this.$session.get(\"UserInformation\").license_key,\n              token: this.$session.get(\"UserInformation\").tokens,\n              subscription: this.$session.get(\"UserInformation\").subscription,\n              is_template_present: true,\n              is_notification: this.is_notification_template,\n              template_name: this.current_template.template_name,\n          },\n          {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n        )\n        .then((response) =>{\n          if (this.api_status_code.NOT_EXISTS_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              this.edit_template_name_already_exist = false;\n              document.getElementById(\"edit_template_name_id\").style.border =null;\n              if(this.current_template.template_name != \"\"){\n                document.getElementById(\"edit_template_name_id\").style.border =\n                \"1px solid #00f000\";\n              }\n            } else if (this.api_status_code.ALREADY_EXISTS_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              if (this.old_template_name == this.current_template.template_name){\n                this.edit_template_name_already_exist = false;\n                document.getElementById(\"edit_template_name_id\").style.border =null;\n              }else{\n                this.edit_template_name_already_exist = true;\n                document.getElementById(\"edit_template_name_id\").style.border =\n                \"1px solid red\";\n              }\n            } else {\n                  Swal({\n                    title: response.data.message.MSG_CODE,\n                    text: response.data.message.MSG,\n                    showCancelButton: false,\n                    showConfirmButton: false,\n                    type: \"error\"\n                  })\n                }\n          })\n          .catch((e) => {\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      },\n      preview_template() {\n        this.spinnerOn = true;\n        axios\n          .post(\n            api_calls.template_promotional_email_campaign(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_preview: true,\n              template_id: this.current_template.template_id,\n              is_notification: this.is_notification_template,\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            if (this.api_status_code.TEMPLATE_RECEIVED_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              this.preview_template_data = response.data.data.Template;\n              $(\"#preview_template_visible\").modal(\"show\");\n            } else if(this.api_status_code.TEMPLATE_DOES_NOT_EXISTS_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            } else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n          })\n          .catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      },\n      send_email_confirm_prompt_text(all_customer) {\n        if (all_customer) {\n          return this.tlt('email_temp_send_bulk_email_msg');\n        } else {\n          return this.tlt('email_temp_send_specific_customer_msg');\n        }\n      },\n      send_email() {\n        if (!this.send_email_all_customer) {\n          if(!Boolean(this.specific_customer_list.length > 0)){\n            swal({\n            text: this.tlt('email_temp_select_one_email_msg'),\n            type: \"warning\",\n            timer: 5000,\n          });\n          return\n          }\n        }\n        Swal.fire({\n          title:this.send_email_confirm_prompt_text(this.send_email_all_customer),\n          text: this.tlt('email_temp_swal_confirm_msg'),\n          showCancelButton: true,\n          type:'warning',\n          confirmButtonColor: \"#3085d6\",\n          cancelButtonColor: \"#d33\",\n          confirmButtonText: this.tlt('email_temp_swal_yes_msg'),\n        }).then((result) => {\n          if (result.value) {\n            $(\"#sendemail\").modal(\"hide\");\n            this.spinnerOn = true;\n            axios\n              .post(\n                api_calls.send_offer_to_customers(),\n                {\n                  company_id: this.company_id,\n                  company_name: this.company_name,\n                  email: this.$session.get(\"UserInformation\").email,\n                  license_key: this.$session.get(\"UserInformation\").license_key,\n                  token: this.$session.get(\"UserInformation\").tokens,\n                  send_email: true,\n                  send_email_all_customer: this.send_email_all_customer,\n                  specific_customer_list:\n                    this.send_email_all_customer != true\n                      ? this.specific_customer_list\n                      : [],\n                  template_id: this.current_template.template_id,\n                },\n                {\n                  headers: {\n                    Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                  },\n                }\n              )\n              .then((response) => {\n                this.spinnerOn = false;\n                if (this.api_status_code.SENDING_EMAIL_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                  // this.save_subject = \"\";\n                  // $(\"#publishtemplatemodel\").modal(\"hide\");\n                  swal({\n                    text: this.tlt('email_temp_sent_successful_msg'),\n                    type: \"success\",\n                    timer: 5000,\n                    title: this.tlt('email_temp_swal_success_msg'),\n                  }).then((result) => {\n                    $(\"#sendemail\").modal(\"hide\");\n                    this.empty_variable();\n                  });\n                } else if(this.api_status_code.UPGRADE_PLAN_TO_SEND_EMAIL_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                    swal({\n                      type: \"warning\",\n                      text: this.tlt('email_temp_upgrade_plan_msg'),\n                      showCancelButton: true,\n                      confirmButtonColor:'#3085d6',\n                      confirmButtonText: this.tlt('email_temp_swal_upgrade_now_msg'),\n                      cancelButtonText: this.tlt('email_temp_swal_upgrade_later_msg'),\n                      cancelButtonColor: '#d33',\n                    }).then((result) => {\n                      if (result.value == true)\n                      {\n                        this.$router.push({name: 'Settings',params:{Subscription:true}});     \n                      }\n                    });\n                } else {\n                  Swal({\n                    title: response.data.message.MSG_CODE,\n                    text: response.data.message.MSG,\n                    showCancelButton: false,\n                    showConfirmButton: false,\n                    type: \"error\"\n                  })\n                }\n              })\n              .catch((e) => {\n                this.spinnerOn = false;\n                if (\n                  e.response.status === 410 ||\n                  e.response.status === 440 ||\n                  e.response.status === 409\n                ) {\n                  this.$root.$emit(\"Session_Expired\", e.response.data);\n                }\n              });\n          }\n        });\n      },\n      selected_templates(value) {\n        if(value == \"all\"){\n          if (event.target.checked) {\n            this.checked_list = [];\n              for (var i in this.templatelist) {\n                this.checked_list.push(this.templatelist[i].template_id);\n            }\n            $(\"input:checkbox\").prop(\"checked\", false);\n            for(let i = 0; i < this.checked_list.length; i++){\n              $(\"#\"+[i]).prop(\"checked\", true);\n              $(\"#selectall\").prop(\"checked\", true);\n            }\n          }else if (!event.target.checked){\n            this.checked_list = [];\n            $(\"input:checkbox\").prop(\"checked\", false);\n          }\n  \n        }else{\n          if (event.target.checked) {\n            this.checked_list.push(value);\n          } else if (!event.target.checked){\n            var selectall = document.querySelector(\"#selectall\");\n            if (selectall.checked) {\n              selectall.checked = false;\n            }\n            var temp = this.checked_list.filter((templates_id) => {\n              return templates_id != value;\n            });\n            this.checked_list = temp;\n          }\n        }\n      },\n      load_templates() {\n        this.spinnerOn = true;\n        axios\n          .post(\n            api_calls.template_promotional_email_campaign(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_get: true,\n              is_notification: this.is_notification_template,\n              page_no: this.page_no,\n              per_page: this.per_page,\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            if(this.api_status_code.STATUS_SUCCESS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n                this.number_of_rows = response.data.pagination.total_data == undefined ? 0 : response.data.pagination.total_data;\n                this.total_pages = response.data.pagination.total_page == undefined ? 0 : response.data.pagination.total_page;\n                this.templatelist = response.data.data;\n                if (this.templatelist.length > 0) {\n                  // this.current_template = this.templatelist[0];\n                  this.show_template(0);\n                }\n                this.isEditTemplate = false;\n            } else if(this.api_status_code.UNSUCCESSFUL_DB_OPERATION_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n                this.templatelist = [];\n                return;\n            } else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n            this.setpagination(this.page_no);\n          })\n          .catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      },\n      fileinput1(e) {\n        let files = e.target.files || e.dataTransfer.files;\n        if (files[0].type === \"image/png\" || files[0].type === \"image/jpeg\") {\n          if (!files.length) return;\n          this.file_label = files[0].name;\n          this.createImage(files[0]);\n        } else {\n          swal({\n            text: this.tlt('email_temp_image_type_msg1'),\n            type: \"error\",\n            timer: 2500,\n          });\n        }\n      },\n      createImage(file, type) {\n        let reader = new FileReader();\n  \n        reader.onload = (e) => {\n          this.image_file = e.target.result.split(\"base64,\")[1];\n        };\n        reader.readAsDataURL(file);\n      },\n      fileinput2(e) {\n        let files = e.target.files || e.dataTransfer.files;\n        if (files[0].type === \"image/png\" || files[0].type === \"image/jpeg\") {\n          if (!files.length) return;\n          this.old_edited_image_name = this.edited_file_label;\n          this.edited_file_label = files[0].name;\n          this.createImage2(files[0]);\n        } else {\n          swal({\n            text: this.tlt('email_temp_image_type_msg2'),\n            type: \"error\",\n            timer: 2500,\n          });\n        }\n      },\n      createImage2(file, type) {\n        let reader = new FileReader();\n  \n        reader.onload = (e) => {\n          this.image_file_2 = e.target.result.split(\"base64,\")[1];\n        };\n        reader.readAsDataURL(file);\n      },\n      create_UUID() {\n        var dt = new Date().getTime();\n        var uuid = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(\n          /[xy]/g,\n          function (c) {\n            var r = (dt + Math.random() * 16) % 16 | 0;\n            dt = Math.floor(dt / 16);\n            return (c == \"x\" ? r : (r & 0x3) | 0x8).toString(16);\n          }\n        );\n        return uuid;\n      },\n      page_require(page) {\n        if (page == 0 || page == this.total_pages + 1) {\n        } else {\n          if (this.search_name == \"\") {\n            if (page == \"...s\") {\n              this.page_no = Math.ceil((1 + this.page_no) / 2);\n            } else if (page == \"...l\") {\n              this.page_no = Math.ceil((this.total_pages + this.page_no) / 2);\n            } else {\n              this.page_no = page;\n            }\n            $(\"input:checkbox\").prop(\"checked\", false);\n            this.spinnerOn = true;\n            axios\n              .post(\n                api_calls.template_promotional_email_campaign(),\n                {\n                  company_id: this.company_id,\n                  company_name: this.company_name,\n                  is_get: true,\n                  is_notification: this.is_notification_template,\n                  page_no: this.page_no,\n                  per_page: this.per_page,\n                },\n                {\n                  headers: {\n                    Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                  },\n                }\n              )\n              .then((response) => {\n                this.spinnerOn = false;\n                if(this.api_status_code.STATUS_SUCCESS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n                this.number_of_rows = response.data.pagination.total_data == undefined ? 0 : response.data.pagination.total_data;\n                this.total_pages = response.data.pagination.total_page == undefined ? 0 : response.data.pagination.total_page;\n                this.templatelist = response.data.data;\n                if (this.templatelist.length > 0) {\n                    this.current_template = this.templatelist[0];\n                  }\n                this.isEditTemplate = false;\n                } else if(this.api_status_code.UNSUCCESSFUL_DB_OPERATION_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n                    this.templatelist = [];\n                    return;\n                } else {\n                  Swal({\n                    title: response.data.message.MSG_CODE,\n                    text: response.data.message.MSG,\n                    showCancelButton: false,\n                    showConfirmButton: false,\n                    type: \"error\"\n                  })\n                }\n                this.setpagination(this.page_no);\n              })\n              .catch((e) => {\n                this.spinnerOn = false;\n                if (\n                  e.response.status === 410 ||\n                  e.response.status === 440 ||\n                  e.response.status === 409\n                ) {\n                  this.$root.$emit(\"Session_Expired\", e.response.data);\n                }\n              });\n          } else {\n            if (page == \"...s\") {\n                this.page_no = Math.ceil((1 + this.page_no) / 2);\n              } else if (page == \"...l\") {\n                this.page_no = Math.ceil((this.total_pages + this.page_no) / 2);\n              } else {\n                this.page_no = page;\n              }\n              $(\"input:checkbox\").prop(\"checked\", false);\n              this.spinnerOn = true;\n              axios\n                .post(\n                  api_calls.template_promotional_email_campaign(),\n                  {\n                    company_id: this.company_id,\n                    company_name: this.company_name,\n                    is_search: true,\n                    page_no: this.page_no,\n                    per_page: this.per_page,\n                    is_notification: this.is_notification_template,\n                    search_key: this.search_name\n                  },\n                  {\n                    headers: {\n                      Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                    },\n                  }\n                )\n                .then((response) => {\n                  this.spinnerOn = false;\n                  this.templatelist = [];\n                  this.number_of_rows = response.data.pagination.total_data == undefined ? 0 : response.data.pagination.total_data;\n                  this.total_pages = response.data.pagination.total_page == undefined ? 0 : response.data.pagination.total_page;\n                  if (this.api_status_code.TEMPLATE_DOES_NOT_EXISTS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n                    this.templatelist = [];\n                    return;\n                  } else if (this.api_status_code.TEMPLATE_SEARCH_RESULT_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n                    this.templatelist = response.data.data.template_search;\n                    if (this.templatelist.length > 0) {\n                      this.show_template(0);\n                    }\n                  } else {\n                    Swal({\n                      title: response.data.message.MSG_CODE,\n                      text: response.data.message.MSG,\n                      showCancelButton: false,\n                      showConfirmButton: false,\n                      type: \"error\"\n                    })\n                  }\n                  this.isEditTemplate = false;\n                  this.setpagination(1);\n                })\n                .catch((e) => {\n                  this.spinnerOn = false;\n                  if (\n                    e.response.status === 410 ||\n                    e.response.status === 440 ||\n                    e.response.status === 409\n                  ) {\n                    this.$root.$emit(\"Session_Expired\", e.response.data);\n                  }\n                });\n            }\n        }\n      },\n      setpagination(page_no) {\n        this.page_array = [];\n        if (this.total_pages <= 7) {\n          for (let i = 0; i < this.total_pages; i++) {\n            this.page_array.push(i + 1);\n          }\n        } else if (page_no == 1) {\n          for (let i = 0; i < 4; i++) {\n            this.page_array.push(i + 1);\n          }\n          this.page_array.push(\"...l\");\n          this.page_array.push(this.total_pages);\n        } else if (page_no == this.total_pages) {\n          this.page_array.push(1);\n          this.page_array.push(\"...s\");\n          for (let i = this.total_pages - 4; i < this.total_pages; i++) {\n            this.page_array.push(i + 1);\n          }\n        } else if (page_no <= 4) {\n          for (let i = 0; i < page_no + 3; i++) {\n            this.page_array.push(i + 1);\n          }\n          this.page_array.push(\"...l\");\n          this.page_array.push(this.total_pages);\n        } else if (page_no >= this.total_pages - 4) {\n          this.page_array.push(1);\n          this.page_array.push(\"...s\");\n          for (let i = page_no - 4; i < this.total_pages; i++) {\n            this.page_array.push(i + 1);\n          }\n        } else {\n          this.page_array.push(1);\n          this.page_array.push(\"...s\");\n          for (let i = page_no - 3; i <= page_no + 3; i++) {\n            this.page_array.push(i);\n          }\n          this.page_array.push(\"...l\");\n          this.page_array.push(this.total_pages);\n        }\n      },\n      pagination_class(index) {\n        if (index == this.page_no) {\n          return \" active\";\n        } else {\n          return \"\";\n        }\n      },\n      save_template() {\n        if (this.template_name == \"\") {\n          Swal({\n            text: this.tlt('email_model_template_name_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.template_name_already_exist == true) {\n          Swal({\n            text: this.tlt('email_model_name_exist_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.email_subject == \"\") {\n          Swal({\n            text: this.tlt('email_model_enter_subject_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.is_sms == true && this.save_sms == \"\") {\n          Swal({\n            text: this.tlt('email_model_enter_sms_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.is_email == true && this.save_email == \"\") {\n          Swal({\n            text: this.tlt('email_model_enter_email_body_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.is_email == false && this.is_sms == false) {\n          Swal({\n            text: this.tlt('email_model_select_option_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (\n          this.is_image_needed == \"yes\" &&\n          document.getElementById(\"inputFile\").value == \"\"\n        ) {\n          Swal({\n            text: this.tlt('email_model_choose_img_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.is_image_needed == \"yes\" && !this.validURL) {\n          Swal({\n            text: this.tlt('email_model_valid_url_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else {\n          if (this.is_html_body) this.is_image_needed = 'none';\n          var uuid = this.create_UUID();\n          axios\n                .post(\n                  api_calls.template_promotional_email_campaign(),\n                  {\n                    company_id: this.company_id,\n                    company_name: this.company_name,\n                    is_save: true,\n                    is_notification: this.is_notification_template,\n                    template_id: uuid,\n                    template_name: this.template_name,\n                    save_email: this.is_email == true ? this.save_email : null,\n                    save_sms: this.is_sms == true ? this.save_sms : null,\n                    email_subject: this.email_subject,\n                    email_img_file:\n                      this.is_image_needed === \"none\" ? null : this.image_file,\n                    email_img_name: this.file_label,\n                    email_img_link: this.img_redirect_url,\n                    is_html_body: this.is_html_body\n                  },\n                  {\n                    headers: {\n                      Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                    },\n                  }\n                )\n                .then((response) => {\n                  if (this.api_status_code.SUCCESSFUL_DB_QUERY_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                    Swal({\n                      type: \"success\",\n                      text: this.tlt('email_model_data_added_successful_msg'),\n                      timer: 2500,\n                    }).then((result) => {\n                      this.empty_variable();\n                      this.load_templates();\n                      \n                    });\n                  } else if (this.api_status_code.IMG_DUPLICATE_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                    Swal({\n                      type: \"error\",\n                      text: this.tlt('email_model_img_already_found_msg'),\n                      timer: 2500,\n                    });\n                    this.empty_variable();\n                    this.load_templates();\n                    return;\n                  } else if (this.api_status_code.UNSUCCESSFUL_DB_OPERATION_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                    Swal({\n                      title: response.data.message.MSG_CODE,\n                      text: response.data.message.MSG,\n                      showCancelButton: false,\n                      showConfirmButton: false,\n                      type: \"error\"\n                    })\n                    this.empty_variable();\n                    this.load_templates();\n                    return;\n                  } else {\n                    Swal({\n                      title: response.data.message.MSG_CODE,\n                      text: response.data.message.MSG,\n                      showCancelButton: false,\n                      showConfirmButton: false,\n                      type: \"error\"\n                    })\n                    return\n                  }\n                })\n                .catch((e) => {\n                  Swal({\n                    type: \"error\",\n                    text: this.tlt('email_model_error_occur_msg2'),\n                    timer: 2500,\n                  });\n                  if (\n                    e.response.status === 410 ||\n                    e.response.status === 440 ||\n                    e.response.status === 409\n                  ) {\n                    this.$root.$emit(\"Session_Expired\", e.response.data);\n                  }\n                });\n                this.close_modal(\"save_template_btn\");\n                \n          // Swal.fire({\n          //   title: this.tlt('email_model_swal_alert_msg'),\n          //   text: this.tlt('email_model_add_current_template_msg'),\n          //   type: \"question\",\n          //   showCancelButton: true,\n          //   confirmButtonColor: \"#3085d6\",\n          //   cancelButtonColor: \"#d33\",\n          //   confirmButtonText: this.tlt('email_model_swal_confirm_msg'),\n          // }).then((result) => {\n          //   if (result.value) {\n          //     Swal({\n          //       text: this.tlt('email_model_submit_details_msg'),\n          //       type: \"info\",\n          //       toast: true,\n          //       showConfirmButton: false,\n          //     });\n              \n           \n                \n            }\n            \n           \n       \n        \n      },\n      edit_template() {\n        if (this.current_template.template_name == \"\") {\n          Swal({\n            text: this.tlt('email_edit_template_name_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.edit_template_name_already_exist == true) {\n          Swal({\n            text: this.tlt('email_edit_name_already_exist_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.current_template.subject == \"\") {\n          Swal({\n            text: this.tlt('email_edit_enter_subject_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (\n          this.is_edit_sms == true &&\n          (this.current_template.sms == null || this.current_template.sms == \"\")\n        ) {\n          Swal({\n            text: this.tlt('email_edit_enter_sms_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (\n          this.is_edit_email == true &&\n          (this.current_template.email == null ||\n            this.current_template.email == \"\")\n        ) {\n          Swal({\n            text: this.tlt('email_edit_enter_email_body_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.is_edit_email == false && this.is_edit_sms == false) {\n          Swal({\n            text: this.tlt('email_edit_select_option_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (this.is_edit_image_needed == \"yes\" && !this.valid_edit_URL) {\n          Swal({\n            text: this.tlt('email_edit_valid_url_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else if (\n          this.is_edit_image_needed == \"yes\" &&\n          this.edited_file_label == \"Choose file\" &&\n          document.getElementById(\"inputFile2\").value == \"\"\n        ) {\n          Swal({\n            text: this.tlt('email_edit_choose_img_msg'),\n            toast: true,\n            position: \"top-end\",\n            type: \"warning\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n          return;\n        } else {\n          if (this.is_html_body) this.is_edit_image_needed = 'none';\n          Swal({\n            text: this.tlt('email_edit_submit_details_msg'),\n            type: \"info\",\n            toast: true,\n            showConfirmButton: false,\n          });\n          axios\n            .post(\n              api_calls.template_promotional_email_campaign(),\n              {\n                company_id: this.company_id,\n                company_name: this.company_name,\n                is_edit: true,\n                is_notification: this.is_notification_template,\n                template_id: this.current_template.template_id,\n                template_name: this.current_template.template_name,\n                email_subject: this.current_template.subject,\n                save_email:\n                  this.is_edit_email == true ? this.current_template.email : null,\n                save_sms:\n                  this.is_edit_sms == true ? this.current_template.sms : null,\n                email_img_file:\n                  this.is_edit_image_needed === \"none\" ? null : this.image_file_2,\n                email_img_name:\n                  this.is_edit_image_needed === \"none\"\n                    ? null\n                    : this.edited_file_label,\n                email_img_link:\n                  this.is_edit_image_needed === \"none\"\n                    ? null\n                    : this.edit_img_redirect_url,\n                is_image_edit:\n                  this.edited_file_label != this.old_edited_image_name\n                    ? true\n                    : false,\n                is_image_present:\n                  this.is_edit_image_needed === \"none\" ? false : true,\n                old_image:\n                  this.old_edited_image_name == \"Choose File\"\n                    ? null\n                    : this.old_edited_image_name,\n                is_html_body: this.current_template.is_html_body\n              },\n              {\n                headers: {\n                  Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                },\n              }\n            )\n            .then((response) => {\n              if (this.api_status_code.SUCCESSFUL_DB_QUERY_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                Swal({\n                  type: \"success\",\n                  text: this.tlt('email_edit_data_edit_successful_msg'),\n                  timer: 2500,\n                }).then((result) => {\n                  this.load_templates();\n                });\n              } else if (this.api_status_code.IMG_DUPLICATE_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                document.getElementById(\"inputFile2\").value = \"\";\n                swal({\n                  text: this.tlt('email_edit_img_already_found_msg'),\n                  type: \"error\",\n                  timer: 3000,\n                });\n              } else if (this.api_status_code.UNSUCCESSFUL_DB_OPERATION_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                Swal({\n                  title: response.data.message.MSG_CODE,\n                  text: response.data.message.MSG,\n                  showCancelButton: false,\n                  showConfirmButton: false,\n                  type: \"error\"\n                })\n              } else {\n                Swal({\n                  title: response.data.message.MSG_CODE,\n                  text: response.data.message.MSG,\n                  showCancelButton: false,\n                  showConfirmButton: false,\n                  type: \"error\"\n                })\n              }\n            })\n            .catch((e) => {\n              if (\n                e.response.status === 410 ||\n                e.response.status === 440 ||\n                e.response.status === 409\n              ) {\n                this.$root.$emit(\"Session_Expired\", e.response.data);\n              }\n              Swal({\n                type: \"error\",\n                text: this.tlt('email_edit_error_occur_msg2'),\n                timer: 2500,\n              });\n            });\n        }\n      },\n      delete_selected() {\n        if (this.checked_list.length == 0) {\n          Swal.fire({\n            title: this.tlt('email_temp_no_template_select_msg'),\n            text: \"\",\n            type: \"error\",\n            timer: 2000,\n          });\n        } else {\n          Swal.fire({\n            title: this.tlt('email_temp_swal_alert_msg2'),\n            text: this.tlt('email_temp_swal_delete_current_template_msg'),\n            type: \"question\",\n            showCancelButton: true,\n            confirmButtonColor: \"#3085d6\",\n            cancelButtonColor: \"#d33\",\n            confirmButtonText: this.tlt('email_temp_swal_confirm_msg'),\n          }).then((result) => {\n            if (result.value) {\n              this.delete_templates(this.checked_list);\n            }\n          });\n        }\n      },\n      delete_templates(checked_list) {\n        this.spinnerOn = true;\n        axios\n          .post(\n            api_calls.template_promotional_email_campaign(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_delete: true,\n              template_list: checked_list,\n              is_notification: this.is_notification_template,\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            if (this.api_status_code.DELETED_SUCCESSFULLY_0004_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n              Swal({\n                type: \"success\",\n                text: this.tlt('email_temp_data_deleted_msg'),\n                timer: 2500,\n              }).then((result) => {\n                this.checked_list = [];\n                $(\"input:checkbox\").prop(\"checked\", false);\n                this.load_templates();\n              });\n            } else if (this.api_status_code.UNSUCCESSFUL_DB_OPERATION_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n              Swal({\n                  title: response.data.message.MSG_CODE,\n                  text: response.data.message.MSG,\n                  showCancelButton: false,\n                  showConfirmButton: false,\n                  type: \"error\"\n                })\n            } else if (this.api_status_code.NOTHING_TO_DELETE_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n              Swal({\n                  title: response.data.message.MSG_CODE,\n                  text: response.data.message.MSG,\n                  showCancelButton: false,\n                  showConfirmButton: false,\n                  type: \"error\"\n                })\n            } else {\n                Swal({\n                  title: response.data.message.MSG_CODE,\n                  text: response.data.message.MSG,\n                  showCancelButton: false,\n                  showConfirmButton: false,\n                  type: \"error\"\n                })\n            }\n          })\n          .catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      },\n      show_template(index) {\n        if (this.isEditTemplate) {\n          this.edit_template_details();\n        }\n        this.current_template = JSON.parse(JSON.stringify(this.templatelist[index]));\n        this.old_template_name = this.current_template.template_name;\n        this.current_template_index = index;\n        if (Boolean(this.current_template.template_image_name) === true) {\n          this.is_edit_image_needed = \"yes\";\n        } else {\n          this.is_edit_image_needed = \"none\";\n        }\n        if (this.templatelist[index].email != null) {\n          this.is_edit_email = true;\n        } else {\n          this.is_edit_email = false;\n        }\n        if (this.templatelist[index].sms != null) {\n          this.is_edit_sms = true;\n        } else {\n          this.is_edit_sms = false;\n        }\n        if (Boolean(this.current_template.template_image_name) === true) {\n          this.edited_file_label = this.current_template.template_image_name;\n          this.old_edited_image_name = this.edited_file_label;\n          this.edit_img_redirect_url = this.current_template.image_redirect_url;\n          if (this.edited_file_label == \"\") {\n            this.edited_file_label = \"Choose file\";\n          }\n        } else {\n          this.edited_file_label = \"Choose file\";\n          this.old_edited_image_name = this.edited_file_label;\n          this.edit_img_redirect_url = \"\";\n        }\n      },\n      empty_variable() {\n        if(!this.disable_btn_expired){\n          this.send_email_all_customer = true;\n          this.quill.setText(\"\");\n          this.customers_list = [];\n          this.specific_customer_list = [];\n          this.save_sms = \"\";\n          this.is_html_body = false;\n          this.save_email = \"\";\n          this.template_name = \"\";\n          this.old_template_name = \"\";\n          this.is_email = true;\n          this.is_sms = false;\n          this.save_subject = \"\";\n          this.is_publish_email = true;\n          this.verification_status = null;\n          this.file_label = \"Choose file\";\n          this.img_redirect_url = \"\";\n          this.email_subject = \"\";\n          this.is_image_needed = \"none\";\n          this.template_name_already_exist = false;\n          document.getElementById(\"template_name_add_id\").style.border = null;\n        }else {\n          this.show_subscription_expired_swal();\n        }\n      \n      },\n      edit_template_details() {\n        if (!this.isEditTemplate) {\n          this.isEditTemplate = true;\n          setTimeout(() => {\n            this.edit_editor();\n          }, 1000);\n        } else {\n          if(!this.current_template.is_html_body){\n            var elements = document.getElementById('edit_editor_temp');\n            elements.removeChild(elements.firstElementChild)\n          }\n          this.isEditTemplate = false;\n          this.load_templates();\n          this.edit_template_name_already_exist = false;\n        }\n      },\n      change_body_format(){\n          if(!this.is_html_body) {\n            this.is_html_body = true;\n            this.save_email = \"\";\n            // const element = document.getElementById(\"editor\");\n            // element.remove();\n          }else {\n            this.is_html_body = false;\n            this.save_email = \"\";\n              setTimeout(() => {\n                this.editor();\n              }, 500);\n          }\n        // }, 1000);\n      },\n      check_current_template_active(index) {\n        // console.table(index, this.templatelist[index], this.current_template);\n        if (Boolean(this.templatelist[index]) === true) {\n          return this.templatelist[index].template_name ===\n            this.old_template_name\n            ? \"current-active-template\"\n            : null;\n        }\n      },\n    },\n  };\n  </script>\n  <style>\n  .ql-picker-options {\n    max-height: 200px !important;\n    overflow: auto !important;\n  }\n  .ql-dropdown_id{\n    background: lightgray !important;\n  }\n  .ql-snow .ql-picker.ql-expanded .ql-picker-label {\n      color: #000 !important;\n      z-index: 2;\n  }\n  .ql-container{\n    min-height: 150px !important;\n  }\n  .ql-editor{\n      min-height:150px !important;\n  }\n  </style>\n  <style scoped>\n  \n  .close_btn{\n    position: absolute !important;\n    top: 30px !important;\n  }\n  .current-active-template {\n    background: rgba(0, 0, 0, 0.1);\n  }\n  .modal-xl {\n    max-width: 1140px;\n    min-height: 1140px;\n  }\n  .table-box tbody tr:hover td,\n  .table-box tbody tr:hover th {\n    background: #ececec;\n  }\n  textarea {\n    resize: none;\n  }\n  /* .table-responsive {\n    height: 80vh;\n    overflow-y: auto;\n    border: 1px solid #e3e2e5;\n  } */\n  /* .table-responsive thead th {\n    top: 0;\n    position: sticky;\n  }\n  .table-responsive::-webkit-scrollbar {\n    max-height: 10px;\n    width: 7px;\n    height: 7px;\n    border-radius: 10px;\n    overflow-x: hidden;\n  }\n  .table-responsive::-webkit-scrollbar-track {\n    background: #ffffff;\n    border-radius: 10px;\n  }\n  .table-responsive::-webkit-scrollbar-thumb {\n    background: #27397b;\n    border-radius: 10px;\n  }\n  .table-responsive::-webkit-scrollbar-thumb:hover {\n    background: #19295f;\n    border-radius: 10px;\n  } */\n  </style>"]}]}