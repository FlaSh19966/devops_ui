{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Template.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Template.vue","mtime":1660042032579},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBTd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImFkZC11c2VyIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc3Vic2NyaWJlX3N0YXR1czogIiIsCiAgICAgIHRlbXBsYXRlX25hbWU6ICIiLAogICAgICB0ZW1wbGF0ZV9zdHJ1Y3R1cmU6IFtdLAogICAgICBwb3J0YWxfcm9sZXM6IFtdLAogICAgICBzZWxlY3RlZF9yb2xlOiAiIiwKICAgICAgY2hlY2tfbGlzdDogW10sCiAgICAgIGVtYWlsbGlzdDogW10sCiAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgZW1haWw6ICIiLAogICAgICBwZXJfcGFnZTogMTAsCiAgICAgIHRvdGFsX3BhZ2VzOiBudWxsLAogICAgICBudW1iZXJfb2Zfcm93czogbnVsbCwKICAgICAgcGFnZV9ubzogMSwKICAgICAgY29tcGFueW5hbWU6ICIiLAogICAgICBjb21wYW55aWQ6ICIiLAogICAgICB1c2VyczogW10sCiAgICAgIHJvbGVzOiBbXSwKICAgICAgcm9sZTogIiIsCiAgICAgIHJlZ19lbWFpbDogL14oWzAtOWEtekEtWl0oWy0uXHddKlswLTlhLXpBLVpdKSpAKFswLTlhLXpBLVpdWy1cd10qWzAtOWEtekEtWl1cLikrW2EtekEtWl17Miw5fSkkLywKICAgICAgcmVnX3B3ZDogL14oPz0uKlthLXpdKSg/PS4qW0EtWl0pKD89LipcZCkoPz0uKlsjQCQhJSo/Jl0pW0EtWmEtelxkI0AkISUqPyZdezgsfS8sCiAgICAgIHNob3dfbG9hZGVyOiBmYWxzZSwKICAgICAgLy9oYXJzaAogICAgICBwYWdlX2FycmF5OiBbXSwKICAgICAgc2VhcmNoX25hbWU6ICIiLAogICAgICBzcGlubmVyT246IGZhbHNlLAogICAgICB0ZW1wbGF0ZXMgOiBbXSwKICAgICAgZWRpdGluZGV4IDogbnVsbCwKICAgICAgaXNfZWRpdCA6IGZhbHNlLAogICAgICBjaGF0OiBbXSwKICAgICAgdG9fc2Nyb2xsOiBmYWxzZSwKICAgICAgaXNleGNoYW5nZTogZmFsc2UsCiAgICAgIGVkaXRhYmxlOiBmYWxzZSwKICAgICAgYm90cXVlc3Rpb25zOiBbXSwKICAgICAgc2VsZWN0ZWRfcXVlc3Rpb24gOiAiIiwKICAgICAgdGVtcF9zdHJ1Y3R1cmU6IFtdLAogICAgICBhZG1pbnRlbXBsYXRlczogW10sCiAgICAgIGNlbnNldGVtcGxhdGVzOltdLAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KGFwaV9jYWxscy5nZXRfb3Blbl9ib3RfdGVtcGxhdGUoKSwgewogICAgICAgICAgICBwYXJhbXMgOnsKICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICAgICAgICB9LAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09ICJTdWNjZXNzIikgewogICAgICAgICAgICAgICAgdGhpcy5jZW5zZXRlbXBsYXRlcyA9IHJlc3BvbnNlLmRhdGEudGVtcGxhdGVzOwogICAgICAgICAgICAgICAgYXhpb3MKICAgICAgICAgICAgICAuZ2V0KGFwaV9jYWxscy5wb3N0X29wZW5fYm90X3RlbXBsYXRlKCksIHsKICAgICAgICAgICAgICAgIHBhcmFtcyA6ewogICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuYWRtaW50ZW1wbGF0ZXMgPSByZXNwb25zZS5kYXRhLnRlbXBsYXRlczsKICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcnRlbXBsYXRlcygpOwogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICB9KTsKCiAgfSwKICBtb3VudGVkKCkgewogICAkKCIjZWRpdGJvdG1vZGVsIikub24oImhpZGRlbi5icy5tb2RhbCIsICgpID0+IHsKICAgICAgLy8gZGVidWdnZXI7CiAgICAgIGFsZXJ0KCJIaSIpOwogICAgIHRoaXMuY2hhdCA9IFtdOwogICAgIHRoaXMuYm90cXVlc3Rpb25zID0gW107CiAgICAgIC8vIHZtLnZpc2l0X3JlYXNvbiA9ICIiOwogICAgICAvLyB2bS52aXNpdG9yX3N5bXB0b21zID0gIiI7CiAgICAgIC8vIHZtLnZpc2l0b3JfbnVtYmVyID0gIiI7CiAgICAgIC8vIHZtLnNlbGVjdGVkX3RpbWUgPSAiIjsKICAgICAgLy8gdm0uaXNFZGl0ID0gZmFsc2U7CiAgICAgIC8vIHZtLnNlbGVjdGVkX3NjaGVkdWxlX2lkID0gIiI7CiAgICAgIC8vIHZtLnNlbGVjdGVkX3NjaGVkdWxlX3Zpc2l0X3Nsb3QgPSAiIjsKICAgICAgLy8gdm0uaXNSZXNjaGVkdWxldGltZSA9IGZhbHNlOwogICAgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICByb3V0ZV90b19wcmV2aWV3KGluZGV4KSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICdPcGVuIEJvdCBUZW1wbGF0ZSBQcmV2aWV3JywKICAgICAgICBwYXJhbXM6IHtib3RkYXRhOntzdHJ1Y3R1cmU6dGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN0cnVjdHVyZX19LAogICAgICB9KTsKICAgIH0sCiAgICBlZGl0dGVtcGxhdGUoZWRpdGluZGV4KXsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIFN3YWwKICAgICAgICAuZmlyZSh7CiAgICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgICAgdGV4dDogIiBZb3Ugd2FudCB0byBFZGl0IHRoZSBUZW1wbGF0ZT8iLAogICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgQ29uZmlybSEiCiAgICAgICAgfSkKICAgICAgICAudGhlbiggcmVzdWx0ID0+IHsKICAgICAgICAgIGlmKHJlc3VsdC52YWx1ZSl7CiAgICAgICAgICAgIC8vIGRlYnVnZ2VyOwogICAgICAgICAgICAvLyB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5jaGF0KTsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiSGkiLCB0aGlzLmNoYXQpOwogICAgICAgICAgICAgIHZhciBzdHJ1Y3R1cmUgPSBbXTsKICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpPCB0aGlzLmNoYXQubGVuZ3RoOyBpKyspewogICAgICAgICAgICAgICAgaWYodGhpcy5jaGF0W2ldLmV2ZW50ID09ICJib3QiKXsKICAgICAgICAgICAgICAgICAgc3RydWN0dXJlLnB1c2goewogICAgICAgICAgICAgICAgICAgIGV2ZW50OiAiYm90IiwKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLmNoYXRbaV0udGV4dCwKICAgICAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLmNoYXRbaV0uZGF0YSwKICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogdGhpcy5jaGF0W2ldLm1ldGFkYXRhLAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHRoaXMuY2hhdFtpXS5ldmVudCA9PSAidXNlciIpewogICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmUucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICJ1c2VyIiwKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLmNoYXRbaV0udGV4dCwKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0udGVtcGxhdGVfdHlwZSA9PSAnYWRtaW4nKXsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9pZF9hcGkgPSB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLmZpbmFsX3RlbXBsYXRlX2lkOwogICAgICAgICAgICAgICAgdmFyIGNlbnNlX3RlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uY2Vuc2VfdGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoYXBpX2NhbGxzLnBvc3Rfb3Blbl9ib3RfdGVtcGxhdGUoKSwgewogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLmRvbWFpbiwKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZDogdGVtcGxhdGVfaWRfYXBpLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlX25hbWU6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0udGVtcGxhdGVfbmFtZSwKICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5kZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmU6IHN0cnVjdHVyZSwKICAgICAgICAgICAgICAgICAgICBjZW5zZV90ZW1wbGF0ZV9pZDogY2Vuc2VfdGVtcGxhdGVfaWRfYXBpLAogICAgICAgICAgICAgICAgfSx7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgIC8vIGlmKCkKICAgICAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PSAiU3VjY2VzcyIpewogICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgICBTd2FsCiAgICAgICAgICAgICAgICAgICAgICAgIC5maXJlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIlRlbXBsYXRlIEVkaXRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lOjIwMDAsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIkZhaWx1cmUiKXsKICAgICAgICAgICAgICAgICAgICAgIFN3YWwKICAgICAgICAgICAgICAgICAgICAgICAgLmZpcmUoewogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiU29tZSBFcnJvciBPY2N1cnJlZCwgUGxlYXNlIFRyeSBBZ2FpbiEiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZToyNTAwCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAkcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0udGVtcGxhdGVfdHlwZSA9PSAnY2Vuc2UnKXsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9pZF9hcGkgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGNlbnNlX3RlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0udGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoYXBpX2NhbGxzLnBvc3Rfb3Blbl9ib3RfdGVtcGxhdGUoKSwgewogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLmRvbWFpbiwKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZDogbnVsbCwKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9uYW1lOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnRlbXBsYXRlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgc3RydWN0dXJlOiBzdHJ1Y3R1cmUsCiAgICAgICAgICAgICAgICAgICAgY2Vuc2VfdGVtcGxhdGVfaWQ6IGNlbnNlX3RlbXBsYXRlX2lkX2FwaSwKICAgICAgICAgICAgICAgIH0sewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAvLyBpZigpCiAgICAgICAgICAgICAgICAgICAgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIlN1Y2Nlc3MiKXsKICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5nbzsKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgICAgICAgICBTd2FsCiAgICAgICAgICAgICAgICAgICAgICAgIC5maXJlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIlRlbXBsYXRlIEVkaXRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lcjoyMDAwLAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09ICJGYWlsdXJlIil7CiAgICAgICAgICAgICAgICAgICAgICBTd2FsCiAgICAgICAgICAgICAgICAgICAgICAgIC5maXJlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIlNvbWUgRXJyb3IgT2NjdXJyZWQsIFBsZWFzZSBUcnkgQWdhaW4hIiwKICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOjI1MDAsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAkcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyB2YXIgdGVtcGxhdGVuYW1lID0gdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS50ZW1wbGF0ZV9uYW1lCgogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAvLyBjb25zb2xlLmxvZyhzdHJ1Y3R1cmUpOwoKICAgIH0sCiAgICBnZW5lcmF0ZV90aW1lKCkgewogICAgICBsZXQgZCA9IG5ldyBEYXRlKCk7CiAgICAgIGxldCBoLCBtLCB0eXBlOwogICAgICBpZiAoZC5nZXRIb3VycygpID4gMTIpIHsKICAgICAgICBoID0gZC5nZXRIb3VycygpICUgMTI7CiAgICAgICAgdHlwZSA9ICIgcG0iOwogICAgICB9IGVsc2UgaWYgKGQuZ2V0SG91cnMoKSA8IDEyKSB7CiAgICAgICAgaCA9IGQuZ2V0SG91cnMoKTsKICAgICAgICB0eXBlID0gIiBhbSI7CiAgICAgIH0gZWxzZSBpZiAoZC5nZXRIb3VycygpID09IDEyKSB7CiAgICAgICAgaCA9IGQuZ2V0SG91cnMoKTsKICAgICAgICB0eXBlID0gIiBwbSI7CiAgICAgIH0KICAgICAgbSA9IGQuZ2V0TWludXRlcygpOwogICAgICBpZiAobSA8IDEwKSB7CiAgICAgICAgbSA9IDAgKyBTdHJpbmcobSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGggKyAiOiIgKyBtICsgdHlwZTsKICAgICAgICB9LCAgICBzY3JvbGxfZG93bigpIHsKICAgICAgaWYgKAogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5jaGF0LWJvZHkiKS5zY3JvbGxIZWlnaHQgLQogICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmNoYXQtYm9keSIpLnNjcm9sbFRvcCAtCiAgICAgICAgICAkKCIuY2hhdC1oaXMiKQogICAgICAgICAgICAubGFzdCgpCiAgICAgICAgICAgIC5oZWlnaHQoKSA8PQogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5jaGF0LWJvZHkiKS5jbGllbnRIZWlnaHQKICAgICAgKSB7CiAgICAgICAgdGhpcy50b19zY3JvbGwgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRvX3Njcm9sbCA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBlZGl0X2JvdChpbmRleCkgewogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgJCgnI2VkaXRib3Rtb2RlbCcpLm1vZGFsKCdzaG93Jyk7CiAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgfSwgNjAwKTsKICAgICAgICB0aGlzLmlzX2VkaXQgPSB0cnVlOwogICAgICAgIHRoaXMuY2hhdD1bXTsKICAgICAgICB0aGlzLmJvdHF1ZXN0aW9ucyA9IFtdOwogICAgICAgIHRoaXMuZWRpdGluZGV4ID0gaW5kZXg7CiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdHJ1Y3R1cmUubGVuZ3RoOyBpKz0gMSApewogICAgICAgICAgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN0cnVjdHVyZVtpXS5ldmVudCA9PSAiYm90Iil7CiAgICAgICAgICAgIHRoaXMuY2hhdC5wdXNoKHsKICAgICAgICAgICAgICByZWNlaXZpbmc6IHRydWUsCiAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN0cnVjdHVyZVtpXS50ZXh0LAogICAgICAgICAgICAgIGNvbnZlcnNhdGlvbl9vbmx5OiB0cnVlLAogICAgICAgICAgICAgIHRpbWU6IHRoaXMuZ2VuZXJhdGVfdGltZSgpLAogICAgICAgICAgICAgIGV2ZW50OiAiYm90IiwKICAgICAgICAgICAgICBkYXRhIDogdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN0cnVjdHVyZVtpXS5kYXRhLAogICAgICAgICAgICAgIG1ldGFkYXRhIDogdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN0cnVjdHVyZVtpXS5tZXRhZGF0YQogICAgICAgICAgICAgIC8vIGRvbWFpbjogdGVtcGxhdGVzW2luZGV4XS5kb21haW4sCiAgICAgICAgICAgICAgLy8gdGVtcGxhdGVfaWQ6IHRlbXBsYXRlc1tpbmRleF0udGVtcGxhdGVfaWQsCiAgICAgICAgICAgICAgLy8gdGVtcGxhdGVfbmFtZTogdGVtcGxhdGVzW2luZGV4XS50ZW1wbGF0ZV9uYW1lLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5ib3RxdWVzdGlvbnMucHVzaCh7CiAgICAgICAgICAgICAgdmFsdWU6IGksCiAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN0cnVjdHVyZVtpXS50ZXh0CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgICBpZih0aGlzLnRlbXBsYXRlc1tpbmRleF0uc3RydWN0dXJlW2ldLmV2ZW50ID09ICJ1c2VyIil7CiAgICAgICAgICAgIHRoaXMuY2hhdC5wdXNoKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdHJ1Y3R1cmVbaV0udGV4dCwKICAgICAgICAgICAgICAgIHNlbmRpbmc6IHRydWUsCiAgICAgICAgICAgICAgICB0aW1lOiB0aGlzLmdlbmVyYXRlX3RpbWUoKSwKICAgICAgICAgICAgICAgIGNvbnZlcnNhdGlvbl9vbmx5OiB0cnVlLAogICAgICAgICAgICAgICAgZGVsaXZlcmVkOiB0cnVlLAogICAgICAgICAgICAgICAgZHJvcGRvd246ICIiLAogICAgICAgICAgICAgICAgZXZlbnQ6ICJ1c2VyIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdpJyxpKTsKICAgICAgICB9CiAgICAgICAgdGhpcy50ZW1wX3N0cnVjdHVyZSA9IHRoaXMuY2hhdDsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmVkaXRpbmRleCk7CiAgICAgICAgLy8gJCgnI2VkaXRib3Rtb2RlbCcpLm1vZGFsKCdzaG93Jyk7CiAgICB9LAogICAgZWRpdHZhbHVlKGluZGV4KSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjaGF0aW5wdXQiICsgaW5kZXgpLmRpc2FibGVkID0gIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjaGF0aW5wdXQiICsgaW5kZXgpLmRpc2FibGVkOwogICAgfSwKICAgIGFkZHF1ZXN0aW9uKCl7CiAgICAgIHZhciBlZGl0aW5kZXggPSB0aGlzLmVkaXRpbmRleDsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5zZWxlY3RlZF9xdWVzdGlvbjsKICAgICAgLy8gY29uc29sZS5sb2coaW5kZXgpOwogICAgICBpZihpbmRleCA9PSAnYScpIHsKICAgICAgICB0b2FzdHIuZXJyb3IoIktpbmRseSBTZWxlY3QgYSBRdWVzdGlvbiIpOwogICAgICB9CiAgICAgIGVsc2UgewogICAgICB0aGlzLmNoYXQgPSBbXTsKICAgICAgdGhpcy5ib3RxdWVzdGlvbnMgPSBbXTsKICAgICAgZm9yKHZhciBpPTA7IGk8PWluZGV4O2krKyl7CiAgICAgICAgaWYodGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaV0uZXZlbnQgPT0gImJvdCIpewogICAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgICAgcmVjZWl2aW5nOiB0cnVlLAogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ldLnRleHQsCiAgICAgICAgICAgICAgY29udmVyc2F0aW9uX29ubHk6IHRydWUsCiAgICAgICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgICAgICAgZXZlbnQ6ICJib3QiLAogICAgICAgICAgICAgIGRhdGEgOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpXS5kYXRhLAogICAgICAgICAgICAgIG1ldGFkYXRhIDogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaV0ubWV0YWRhdGEKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuYm90cXVlc3Rpb25zLnB1c2goewogICAgICAgICAgICAgIHZhbHVlOiBpLAogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ldLnRleHQKICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ldLmV2ZW50ID09ICJ1c2VyIil7CiAgICAgICAgICAgIHRoaXMuY2hhdC5wdXNoKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ldLnRleHQsCiAgICAgICAgICAgICAgICBzZW5kaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICAgICAgICAgIGRlbGl2ZXJlZDogdHJ1ZSwKICAgICAgICAgICAgICAgIGRyb3Bkb3duOiAiIiwKICAgICAgICAgICAgICBldmVudDogInVzZXIiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuY2hhdC5wdXNoKHsKICAgICAgICByZWNlaXZpbmc6IHRydWUsCiAgICAgICAgdGV4dDogJyAgICAgJywKICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICB0aW1lOiB0aGlzLmdlbmVyYXRlX3RpbWUoKSwKICAgICAgICBldmVudDogImJvdCIsCiAgICAgICAgZGF0YSA6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ldLmRhdGEsCiAgICAgICAgbWV0YWRhdGEgOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpXS5tZXRhZGF0YQogICAgICB9KTsKICAgICAgdmFyIGMgPSAoaW5kZXgrMik7CiAgICAgIGkgPSBudWxsOwogICAgICAvLyBjb25zb2xlLmxvZyhjKTsKICAgICAgZm9yKHZhciBpPWM7IGk8PXRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlLmxlbmd0aDsgaSsrICl7CiAgICAgICAgaWYodGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaS0xXS5ldmVudCA9PSAiYm90Iil7CiAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgIHJlY2VpdmluZzogdHJ1ZSwKICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wbGF0ZXNbZWRpdGluZGV4XS5zdHJ1Y3R1cmVbaS0xXS50ZXh0LAogICAgICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgICAgIGV2ZW50OiAiYm90IiwKICAgICAgICAgICAgZGF0YSA6IHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ktMV0uZGF0YSwKICAgICAgICAgICAgbWV0YWRhdGEgOiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpLTFdLm1ldGFkYXRhCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuYm90cXVlc3Rpb25zLnB1c2goewogICAgICAgICAgICB2YWx1ZTogaS0yLAogICAgICAgICAgICB0ZXh0OiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpLTFdLnRleHQKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2VkaXRpbmRleF0uc3RydWN0dXJlW2ktMV0uZXZlbnQgPT0gInVzZXIiKXsKICAgICAgICAgIHRoaXMuY2hhdC5wdXNoKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRlbXBsYXRlc1tlZGl0aW5kZXhdLnN0cnVjdHVyZVtpLTFdLnRleHQsCiAgICAgICAgICAgICAgc2VuZGluZzogdHJ1ZSwKICAgICAgICAgICAgICB0aW1lOiB0aGlzLmdlbmVyYXRlX3RpbWUoKSwKICAgICAgICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICAgICAgICBkZWxpdmVyZWQ6IHRydWUsCiAgICAgICAgICAgICAgZHJvcGRvd246ICIiLAogICAgICAgICAgICAgIGV2ZW50OiAidXNlciIKCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy50ZW1wX3N0cnVjdHVyZSA9IHRoaXMuY2hhdDsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNoYXRpbnB1dCIgKyAoaW5kZXgrMSkpLmRpc2FibGVkID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVxdWVzdGlvbihpbmRleCkgewogICAgICBjb25zb2xlLmxvZyh0aGlzLnRlbXBfc3RydWN0dXJlKTsKICAgICAgdGhpcy5jaGF0ID0gW107CiAgICAgIHRoaXMuYm90cXVlc3Rpb25zID0gW107CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudGVtcF9zdHJ1Y3R1cmUpOwogICAgICB2YXIgZWRpdGluZGV4ID0gdGhpcy5lZGl0aW5kZXg7CiAgICAgICBmb3IodmFyIGk9MDsgaTxpbmRleDtpKyspewogICAgICAgICAgaWYodGhpcy50ZW1wX3N0cnVjdHVyZVtpXS5ldmVudCA9PSAiYm90Iil7CiAgICAgICAgICAgIHRoaXMuY2hhdC5wdXNoKHsKICAgICAgICAgICAgICByZWNlaXZpbmc6IHRydWUsCiAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wX3N0cnVjdHVyZVtpXS50ZXh0LAogICAgICAgICAgICAgIGNvbnZlcnNhdGlvbl9vbmx5OiB0cnVlLAogICAgICAgICAgICAgIHRpbWU6IHRoaXMuZ2VuZXJhdGVfdGltZSgpLAogICAgICAgICAgICAgIGV2ZW50OiAiYm90IiwKICAgICAgICAgICAgICBkYXRhIDogdGhpcy50ZW1wX3N0cnVjdHVyZVtpXS5kYXRhLAogICAgICAgICAgICAgIG1ldGFkYXRhIDogdGhpcy50ZW1wX3N0cnVjdHVyZVtpXS5tZXRhZGF0YQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5ib3RxdWVzdGlvbnMucHVzaCh7CiAgICAgICAgICAgICAgdmFsdWU6IGksCiAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wX3N0cnVjdHVyZVtpXS50ZXh0CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgICBpZih0aGlzLnRlbXBfc3RydWN0dXJlW2ldLmV2ZW50ID09ICJ1c2VyIil7CiAgICAgICAgICAgIHRoaXMuY2hhdC5wdXNoKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0udGV4dCwKICAgICAgICAgICAgICAgIHNlbmRpbmc6IHRydWUsCiAgICAgICAgICAgICAgICB0aW1lOiB0aGlzLmdlbmVyYXRlX3RpbWUoKSwKICAgICAgICAgICAgICAgIGNvbnZlcnNhdGlvbl9vbmx5OiB0cnVlLAogICAgICAgICAgICAgICAgZGVsaXZlcmVkOiB0cnVlLAogICAgICAgICAgICAgICAgZHJvcGRvd246ICIiLAogICAgICAgICAgICAgICAgZXZlbnQ6ICJ1c2VyIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgIH0KICAgICAgIGkgPSBudWxsOwogICAgICB2YXIgYyA9IGluZGV4ICsxOwogICAgICBmb3IodmFyIGk9YzsgaTx0aGlzLnRlbXBfc3RydWN0dXJlLmxlbmd0aDsgaSsrICl7CiAgICAgICAgaWYodGhpcy50ZW1wX3N0cnVjdHVyZVtpXS5ldmVudCA9PSAiYm90Iil7CiAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgIHJlY2VpdmluZzogdHJ1ZSwKICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wX3N0cnVjdHVyZVtpXS50ZXh0LAogICAgICAgICAgICBjb252ZXJzYXRpb25fb25seTogdHJ1ZSwKICAgICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgICAgIGV2ZW50OiAiYm90IiwKICAgICAgICAgICAgZGF0YSA6IHRoaXMudGVtcF9zdHJ1Y3R1cmVbaV0uZGF0YSwKICAgICAgICAgICAgbWV0YWRhdGEgOiB0aGlzLnRlbXBfc3RydWN0dXJlW2ldLm1ldGFkYXRhCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuYm90cXVlc3Rpb25zLnB1c2goewogICAgICAgICAgICB2YWx1ZTogaSwKICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wX3N0cnVjdHVyZVtpXS50ZXh0CiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgICBpZih0aGlzLnRlbXBfc3RydWN0dXJlW2ldLmV2ZW50ID09ICJ1c2VyIil7CiAgICAgICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZW1wX3N0cnVjdHVyZVtpXS50ZXh0LAogICAgICAgICAgICAgIHNlbmRpbmc6IHRydWUsCiAgICAgICAgICAgICAgdGltZTogdGhpcy5nZW5lcmF0ZV90aW1lKCksCiAgICAgICAgICAgICAgY29udmVyc2F0aW9uX29ubHk6IHRydWUsCiAgICAgICAgICAgICAgZGVsaXZlcmVkOiB0cnVlLAogICAgICAgICAgICAgIGRyb3Bkb3duOiAiIiwKICAgICAgICAgICAgICBldmVudDogInVzZXIiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy50ZW1wX3N0cnVjdHVyZSA9IHRoaXMuY2hhdDsKICAgIH0sCiAgICBmaWx0ZXJ0ZW1wbGF0ZXMoKSB7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuY2Vuc2V0ZW1wbGF0ZXMsJ2NlbnNlJyk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuYWRtaW50ZW1wbGF0ZXMsICdhZG1pbicpOwogICAgICAvLyBpZih0aGlzLmFkbWludGVtcGxhdGVzLmxlbmd0aCA+IDApewogICAgICAgIGZvcihsZXQgaSA9IDA7IGk8dGhpcy5jZW5zZXRlbXBsYXRlcy5sZW5ndGg7IGkgKz0gMSl7CiAgICAgICAgICBpZih0aGlzLmFkbWludGVtcGxhdGVzLmxlbmd0aCA9PSAwKXsKICAgICAgICAgICAgdGhpcy5jZW5zZXRlbXBsYXRlc1tpXVsnZmluYWxfdGVtcGxhdGVfaWQnXSA9IHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV0udGVtcGxhdGVfaWQ7CiAgICAgICAgICAgIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ3RlbXBsYXRlX3R5cGUnXSA9ICdjZW5zZSc7CiAgICAgICAgICAgIC8vIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ3N1YnNjcmliZWQnXSA9IGZhbHNlOwogICAgICAgICAgICBpZih0aGlzLmNlbnNldGVtcGxhdGVzW2ldLnN1YnNjcmliZWQgPT0gZmFsc2UpewogICAgICAgICAgICAgICAgdGhpcy5jZW5zZXRlbXBsYXRlc1tpXVsnc3Vic2NyaWJlZF92YWwnXSA9ICJEb250U3Vic2NyaWJlIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmKHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV0uc3Vic2NyaWJlZCA9PSB0cnVlKXsKICAgICAgICAgICAgICAgIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ3N1YnNjcmliZWRfdmFsJ10gPSAiU3Vic2NyaWJlIjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnRlbXBsYXRlcy5wdXNoKHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvcihsZXQgaj0wOyBqPHRoaXMuYWRtaW50ZW1wbGF0ZXMubGVuZ3RoOyBqICs9IDEpewogICAgICAgICAgICBpZigoKHRoaXMuYWRtaW50ZW1wbGF0ZXNbal0uY2Vuc2VfdGVtcGxhdGVfaWQgIT0gbnVsbCB8fCB0aGlzLmFkbWludGVtcGxhdGVzW2pdLmNlbnNlX3RlbXBsYXRlX2lkICE9IHVuZGVmaW5lZCkpICYmICh0aGlzLmFkbWludGVtcGxhdGVzW2pdLmNlbnNlX3RlbXBsYXRlX2lkID09IHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV0udGVtcGxhdGVfaWQpKXsKICAgICAgICAgICAgICB0aGlzLmFkbWludGVtcGxhdGVzW2pdWydmaW5hbF90ZW1wbGF0ZV9pZCddID0gdGhpcy5hZG1pbnRlbXBsYXRlc1tqXS50ZW1wbGF0ZV9pZDsKICAgICAgICAgICAgICB0aGlzLmFkbWludGVtcGxhdGVzW2pdWyd0ZW1wbGF0ZV90eXBlJ10gPSAnYWRtaW4nOwogICAgICAgICAgICAgIGlmKHRoaXMuYWRtaW50ZW1wbGF0ZXNbal0uc3Vic2NyaWJlZCA9PSBmYWxzZSl7CiAgICAgICAgICAgICAgICB0aGlzLmFkbWludGVtcGxhdGVzW2pdWydzdWJzY3JpYmVkX3ZhbCddID0gIkRvbnRTdWJzY3JpYmUiOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuYWRtaW50ZW1wbGF0ZXNbal0uc3Vic2NyaWJlZCA9PSB0cnVlKXsKICAgICAgICAgICAgICAgIHRoaXMuYWRtaW50ZW1wbGF0ZXNbal1bJ3N1YnNjcmliZWRfdmFsJ10gPSAiU3Vic2NyaWJlIjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZXMucHVzaCh0aGlzLmFkbWludGVtcGxhdGVzW2pdKTsKICAgICAgICAgICAgfSBlbHNlIGlmKCgodGhpcy5hZG1pbnRlbXBsYXRlc1tqXS5jZW5zZV90ZW1wbGF0ZV9pZCAhPSBudWxsIHx8IHRoaXMuYWRtaW50ZW1wbGF0ZXNbal0uY2Vuc2VfdGVtcGxhdGVfaWQgIT0gdW5kZWZpbmVkKSkpewogICAgICAgICAgICAgIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ2ZpbmFsX3RlbXBsYXRlX2lkJ10gPSB0aGlzLmNlbnNldGVtcGxhdGVzW2ldLnRlbXBsYXRlX2lkOwogICAgICAgICAgICAgIGlmKHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV0uc3Vic2NyaWJlZCA9PSBmYWxzZSl7CiAgICAgICAgICAgICAgICB0aGlzLmNlbnNldGVtcGxhdGVzW2ldWydzdWJzY3JpYmVkX3ZhbCddID0gIkRvbnRTdWJzY3JpYmUiOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV0uc3Vic2NyaWJlZCA9PSB0cnVlKXsKICAgICAgICAgICAgICAgIHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV1bJ3N1YnNjcmliZWRfdmFsJ10gPSAiU3Vic2NyaWJlIjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gdGhpcy5jZW5zZXRlbXBsYXRlc1tpXVsnc3Vic2NyaWJlZCddID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5jZW5zZXRlbXBsYXRlc1tpXVsndGVtcGxhdGVfdHlwZSddID0gJ2NlbnNlJzsKICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlcy5wdXNoKHRoaXMuY2Vuc2V0ZW1wbGF0ZXNbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgIH0KICAgICAgICB9CiAgICAgIC8vIH0gZWxzZSB7CiAgICAgIC8vICAgZm9yKGxldCBpID0gMDsgaTx0aGlzLmNlbnNldGVtcGxhdGVzLmxlbmd0aDsgaSArPSAxKXsKICAgICAgLy8gICAgIHRoaXMudGVtcGxhdGVzID0gdGhpcy5jZW5zZXRlbXBsYXRlczsKICAgICAgLy8gICB9CiAgICAgIC8vIH0KICAgICAgY29uc29sZS5sb2codGhpcy50ZW1wbGF0ZXMpOwogICAgfSwKICAgIGRlbGV0ZV9ib3QoaW5kZXgpIHsKICAgICAgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnRlbXBsYXRlX3R5cGUgPT0gJ2NlbnNlJyl7CiAgICAgICAgdG9hc3RyLmVycm9yKCJZb3UgQ2Fubm90IERlbGV0ZSBTdXBlckFkbWluIFRlbXBsYXRlcyIpOwogICAgICB9CiAgICAgIGVsc2UgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnRlbXBsYXRlX3R5cGUgIT0gJ2NlbnNlJyl7CiAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgICAgdGV4dDogIiBZb3Ugd2FudCB0byBEZWxldGUgdGhpcyBUZW1wbGF0ZT8iLAogICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgQ29uZmlybSEiCiAgICAgIH0pCiAgICAgICAgIC50aGVuKCByZXN1bHQgPT4gewogICAgICAgICAgICBpZihyZXN1bHQpewogICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLmRlbGV0ZShhcGlfY2FsbHMucG9zdF9vcGVuX2JvdF90ZW1wbGF0ZSgpLCB7CiAgICAgICAgICAgICAgICAgIHBhcmFtcyA6IHsKICAgICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlX2lkOiB0aGlzLnRlbXBsYXRlc1tpbmRleF0uZmluYWxfdGVtcGxhdGVfaWQKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIlN1Y2Nlc3MiICYmIHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAiUXVlcnkgRXhlY3V0ZWQgU3VjY2Vzc2Z1bGx5Iil7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIuZ287CiAgICAgICAgICAgICAgICAgICAgfSwgMTEwMCk7CiAgICAgICAgICAgICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIkRlbGV0ZWQiLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOjIwMDAsCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5nbzsKICAgICAgICAgICAgICAgICAgICB9LCAxMTAwKTsKICAgICAgICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiU29tZSBFcnJvciBPY2N1cnJlZC5QbGVhc2UgVHJ5IEFnYWluIiwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXI6MjUwMCwKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICB9KTsKICAgICAgIH0KICAgIH0sCiAgICBzdWJzY3JpYmV0ZW1wbGF0ZShpbmRleCl7CiAgICAgIC8vIGRlYnVnZ2VyOwogICAgICB2YXIgeCA9IHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdWJzY3JpYmVkOwogICAgICAvLyB2YXIgeSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKHRoaXMudGVtcGxhdGVzW2luZGV4XS50ZW1wbGF0ZV9pZCkudmFsdWU7CiAgICAgIGlmKHRoaXMudGVtcGxhdGVzW2luZGV4XS5zdWJzY3JpYmVkX3ZhbCA9PSAiU3Vic2NyaWJlIil7CiAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgICAgdGV4dDogIiBZb3Ugd2FudCB0byBzdWJzY3JpYmUgdG8gdGhpcyB0ZW1wbGF0ZT8iLAogICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgQ29uZmlybSEiCiAgICAgICAgfSkKICAgICAgICAgLnRoZW4oIHJlc3VsdCA9PiB7CiAgICAgICAgICAgIGlmKHJlc3VsdCl7CiAgICAgICAgICAgICAgICBpZih0aGlzLnRlbXBsYXRlc1tpbmRleF0udGVtcGxhdGVfdHlwZSA9PSAnYWRtaW4nKXsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9pZF9hcGkgPSB0aGlzLnRlbXBsYXRlc1tpbmRleF0uZmluYWxfdGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVfdHlwZSA9ICdjdXN0b20nOwogICAgICAgICAgICAgICAgLy8gdmFyIGNlbnNlX3RlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2luZGV4XS5jZW5zZV90ZW1wbGF0ZV9pZDsKICAgICAgICAgICAgICAgIH0gIGVsc2UgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnRlbXBsYXRlX3R5cGUgPT0gJ2NlbnNlJyl7CiAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVfaWRfYXBpID0gdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLmZpbmFsX3RlbXBsYXRlX2lkOwogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlX3R5cGUgPSAnY2Vuc2UnOwogICAgICAgICAgICAgICAgLy8gIHZhciBjZW5zZV90ZW1wbGF0ZV9pZF9hcGkgPSB0aGlzLnRlbXBsYXRlc1tpbmRleF0udGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYXhpb3MKICAgICAgICAgICAgICAgIC5wb3N0KGFwaV9jYWxscy5vcGVuX2JvdF90ZW1wbGF0ZV9zdWJzY3JpcHRpb24oKSwgewogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfaWQ6IHRlbXBsYXRlX2lkX2FwaSwKICAgICAgICAgICAgICAgICAgICBzZXRfc3Vic2NyaXB0aW9uIDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVkOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlX3R5cGU6IHRlbXBsYXRlX3R5cGUKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgIH0pOwogICAgICB9CiAgICAgIGVsc2UgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnN1YnNjcmliZWRfdmFsID09ICJEb250U3Vic2NyaWJlIil7CiAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6ICJBcmUgeW91IHN1cmU/IiwKICAgICAgICAgIHRleHQ6ICIgWW91IGRvbid0IHdhbnQgdG8gc3Vic2NyaWJlIHRvIHRoaXMgdGVtcGxhdGU/IiwKICAgICAgICAgIHR5cGU6ICJxdWVzdGlvbiIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIENvbmZpcm0hIgogICAgICAgIH0pCiAgICAgICAgIC50aGVuKCByZXN1bHQgPT4gewogICAgICAgICAgICBpZihyZXN1bHQpewogICAgICAgICAgICAgICBpZih0aGlzLnRlbXBsYXRlc1tpbmRleF0udGVtcGxhdGVfdHlwZSA9PSAnYWRtaW4nKXsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9pZF9hcGkgPSB0aGlzLnRlbXBsYXRlc1tpbmRleF0uZmluYWxfdGVtcGxhdGVfaWQ7CiAgICAgICAgICAgICAgICB2YXIgY2Vuc2VfdGVtcGxhdGVfaWRfYXBpID0gdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLmNlbnNlX3RlbXBsYXRlX2lkOwogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlX3R5cGUgPSAnY3VzdG9tJzsKICAgICAgICAgICAgICAgIH0gIGVsc2UgaWYodGhpcy50ZW1wbGF0ZXNbaW5kZXhdLnRlbXBsYXRlX3R5cGUgPT0gJ2NlbnNlJyl7CiAgICAgICAgICAgICAgICB2YXIgY2Vuc2VfdGVtcGxhdGVfaWRfYXBpID0gdGhpcy50ZW1wbGF0ZXNbaW5kZXhdLmZpbmFsX3RlbXBsYXRlX2lkOwogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlX2lkX2FwaSA9IHRoaXMudGVtcGxhdGVzW2luZGV4XS5maW5hbF90ZW1wbGF0ZV9pZDsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV90eXBlID0gJ2NlbnNlJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoYXBpX2NhbGxzLm9wZW5fYm90X3RlbXBsYXRlX3N1YnNjcmlwdGlvbigpLCB7CiAgICAgICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZDogdGVtcGxhdGVfaWRfYXBpLAogICAgICAgICAgICAgICAgICAgIHNldF9zdWJzY3JpcHRpb24gOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlX3R5cGU6IHRlbXBsYXRlX3R5cGUKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgIH0pOwogICAgICB9CiAgICB9LAogIH0KfQo="},null]}