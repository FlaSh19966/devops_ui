{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/WhatsappChat.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/WhatsappChat.vue","mtime":1655807120969},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IHsgU29ja2V0LCBQcmVzZW5jZSB9IGZyb20gInBob2VuaXgiOwppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7CmltcG9ydCBTd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IE11bHRpc2VsZWN0IGZyb20gInZ1ZS1tdWx0aXNlbGVjdCI7CmltcG9ydCBWdWVQaG9uZU51bWJlcklucHV0IGZyb20gInZ1ZS1waG9uZS1udW1iZXItaW5wdXQiOwppbXBvcnQgc3dhbCBmcm9tICdzd2VldGFsZXJ0Mic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiV2hhdHNhcHBDaGF0IiwKICBjb21wb25lbnRzOiB7CiAgICBNdWx0aXNlbGVjdCwKICAgIFZ1ZVBob25lTnVtYmVySW5wdXQKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzaG93X3NwaW5uZXI6IGZhbHNlLAogICAgICBoaXN0b3J5OiBbXSwKICAgICAgY29udGFjdF9saXN0OiBbXSwKICAgICAgcGhvbmVubzogbnVsbCwKICAgICAgY3VzdG9tZXJfbmFtZTogIiIsCiAgICAgIGNoYXRfZGV0YWlsczogW10sCiAgICAgIHNlYXJjaF92YWx1ZTogIiIsCiAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICBjb21wYW55X25hbWU6dGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwgCiAgICAgIHNlc3Npb25fdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgIGluaXRpYWxfbWVzc2FnZV9sb2FkOiBmYWxzZSwKICAgICAgaXNfcHJvZmlsZV9zZXR1cDogZmFsc2UsCiAgICAgIG1lc3NhZ2VfcGFnaW5hdGlvbjogewogICAgICAgIGlzX3Njcm9sbF91cDogZmFsc2UsCiAgICAgICAgcGVyX3BhZ2U6IDUsCiAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICB0b3RhbF9yZWNvcmRzOiAxMCwKICAgICAgICBwYWdlX3JlY29yZF9mZXRjaGVkOiBbXQogICAgICB9LAogICAgICBpc19wYWdpbmF0ZWRfY2FsbDogZmFsc2UsCiAgICAgIGRlZmF1bHRfd2hhdHNhcHBfc3RhdHVzOiAnSGV5IHRoZXJlISBJIGFtIHVzaW5nIHdoYXRzYXBwJywKICAgICAgZWRpdF9zdGF0dXM6IGZhbHNlLAogICAgICBzY3JvbGxfc3Bpbm5lcl9jaGF0OiBmYWxzZSwKICAgICAgc2hvd19zZW5kX21lc3NhZ2U6IGZhbHNlLAogICAgICBpc19tZXNzYWdlX3NlbmRpbmdfZW5hYmxlZDogZmFsc2UsCiAgICAgIGlzX3Nob3dfbWVzc2FnZV9kaXNhYmxlZDogdHJ1ZSwKICAgICAgd2hhdHNhcHBfcHJvZmlsZSA6ICcnLAogICAgICBlZGl0X2VtYWlsOiBmYWxzZSwKICAgICAgZWRpdF9hZGRyZXNzOiBmYWxzZSwKICAgICAgZWRpdF9kZXNjcmlwdGlvbjogZmFsc2UsCiAgICAgIGVkaXRfd2Vic2l0ZTogZmFsc2UsCiAgICAgIGVtYWlsX2FkZHJlc3M6ICcnLAogICAgICBidXNpbmVzc19hZGRyZXNzOiAnJywKICAgICAgZGVzY3JpcHRpb24gOiAnJywKICAgICAgd2Vic2l0ZV91cmwgOiAnJywKICAgICAgd2hhdHNhcHBfcGhvbmVfbnVtYmVyOiBudWxsLAogICAgICBjaGFubmVsOiBudWxsLAogICAgICBjaGF0X3NvY2tldDogbnVsbCwKICAgICAgc3VwcG9ydF9jaGFubmVsOiBudWxsLAogICAgICBtZXNzYWdlX3RvX3NlbmQ6IG51bGwsCiAgICAgIHdoYXRzYXBwX3N0YXR1cyA6ICcnLAogICAgICBpbmRleF91cGRhdGU6bnVsbCwKICAgICAgc2Vjb25kX3dlYnNpdGUgOmZhbHNlLAogICAgICBzZWxlY3RlZF9maWxlcyA6JycsCiAgICAgIG1vdXNlX2hvdmVyX3RleHQgOiBmYWxzZSwKICAgICAgdmVydGljYWxfdHlwZXMgOiBbJ0F1dG9tb3RpdmUnLCdCZWF1dHknLCAnU3BhIGFuZCBTYWxvbicsJ0Nsb3RoaW5nIGFuZCBBcHBhcmVsJywnRWR1Y2F0aW9uJywKICAgICAgICAgICAgICAnRW50ZXJ0YWlubWVudCcsJ0V2ZW50IFBsYW5uaW5nIGFuZCBTZXJ2aWNlJywnRmluYW5jZSBhbmQgQmFua2luZycsJ0Zvb2QgYW5kIEdyb2NlcnknCiAgICAgICAgICAgICAgLCdQdWJsaWMgU2VydmljZScsJ0hvdGVsIGFuZCBMb2RnaW5nJywnTWVkaWNhbCBhbmQgSGVhbHRoJywnTm9uLXByb2ZpdCcsCiAgICAgICAgICAgICAgJ1Byb2Zlc3Npb25hbCBTZXJ2aWNlcycsJ1Nob3BwaW5nIGFuZCBSZXRhaWwnLCdUcmF2ZWwgYW5kIFRyYW5zcG9ydGF0aW9uJywnUmVzdGF1cmFudCcsJ090aGVyJ10sCiAgICAgIGN1cnJlbnRfY29udGFjdF9udW1iZXI6IG51bGwsCiAgICAgIGlzX2NvbnRhY3RfbGlzdCA6IGZhbHNlLAogICAgICBjdXJyZW50X2NvbnRhY3RfaW5kZXg6IG51bGwsCiAgICAgIHNlYXJjaF9pbl9jb250YWN0X2xpc3Q6ICcnLAogICAgICBhbGxfY29udGFjdF9saXN0IDogW10sCiAgICAgIHN0YXJ0X25ld19jb252X2RhdGEgOiB7CiAgICAgICAgc3RhcnRfbmV3X2NvbnY6IGZhbHNlLAogICAgICAgIGlzX21lc3NhZ2Vfc2VuZGluZ19lbmFibGVkOiBmYWxzZQogICAgICB9LAogICAgICBhbGxfY29udGFjdF9wYWdpbmF0aW9uOnsKICAgICAgICBwZXJfcGFnZTogMTAsCiAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICB0b3RhbF9yZWNvcmRzOiAxMCwKICAgICAgfSwKICAgICAgc2VuZF9hdHRhY2htZW50X2RldGFpbDogewogICAgICAgIG1lZGlhX2ZpbGVfbmFtZTogbnVsbCwKICAgICAgICBtZWRpYV9maWxlOiBudWxsLAogICAgICAgIHNob3dfcHJldmlldzogZmFsc2UsCiAgICAgICAgbWVkaWFfY29udGVudF90eXBlOiBudWxsLAogICAgICAgIG1lZGlhX3R5cGU6IG51bGwsCiAgICAgICAgc2VuZF9tZWRpYTogdHJ1ZSwKICAgICAgICBkb2N1bWVudF9jb250ZW50OiBudWxsLAogICAgICAgIG1lZGlhX2NhcHRpb246IG51bGwKICAgICAgfSwKICAgICAgY3VycmVudF9mdWxsc2NyZWVuX2ltYWdlX3NyYzogbnVsbCwKICAgICAgYWRkX25ld19jb250YWN0OiB7CiAgICAgICAgcGhvbmVfbnVtYmVyOiBudWxsLAogICAgICAgIGlzX2FkZF9jb250YWN0OiB0cnVlLAogICAgICAgIGNvbnRhY3RfbmFtZTogbnVsbCwKICAgICAgICBmb3JtYXR0ZWROdW1iZXI6IG51bGwKICAgICAgfSwKICAgICAgYWRkX25ld19jb250YWN0X2Zvcm1hdHRlZF9waG9uZV9udW1iZXI6IG51bGwsCiAgICAgIGZpbGVfZXh0ZW5zaW9uczogewogICAgICAgIGFsbF9hbGxvd2VkX2ZpbGVfZXh0ZW5zaW9uczogWyJpbWFnZS9wbmciLCJpbWFnZS9qcGVnIiwgImFwcGxpY2F0aW9uL3BkZiIsICJ0ZXh0L3BsYWluIiwgImFwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCIsICJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi92bmQubXMtcG93ZXJwb2ludCIsICJhcHBsaWNhdGlvbi9tc3dvcmQiLCAiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwuZG9jdW1lbnQiLCAidGV4dC9jc3YiXSwKICAgICAgICBpbWFnZV9maWxlX2V4dGVuc2lvbnM6IFsiaW1hZ2UvcG5nIiwgImltYWdlL2pwZWciXSwKICAgICAgICBkb2N1bWVudF9maWxlX2V4dGVuc2lvbnM6IFsiYXBwbGljYXRpb24vcGRmIiwgInRleHQvcGxhaW4iLCAiYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsIiwgImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0IiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi92bmQubXMtcG93ZXJwb2ludCIsICJhcHBsaWNhdGlvbi9tc3dvcmQiLCAiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwuZG9jdW1lbnQiLCAidGV4dC9jc3YiXQogICAgICB9LAogICAgICB3aGF0c2FwcF90ZW1wbGF0ZXM6IHsKICAgICAgICB0ZW1wbGF0ZXNfbGlzdDogW10sCiAgICAgICAgcGFnaW5hdGlvbl9kYXRhOiB7CiAgICAgICAgICBwZXJfcGFnZTogMTAsCiAgICAgICAgICBwYWdlX25vOiAxLAogICAgICAgICAgdG90YWxfcmVjb3JkczogMTAsCiAgICAgICAgfSwKICAgICAgICBzZWxlY3RlZF90ZW1wbGF0ZTogbnVsbCwKICAgICAgICBwcmV2aWV3X3RlbXBsYXRlX2RhdGE6IG51bGwKICAgICAgfSwKICAgICAgY29udGFjdF9jc3Y6IHsKICAgICAgICBmaWxlX2xhYmVsOiAnQ2hvb3NlIEZpbGUnLAogICAgICAgIGZpbGVfY29udGVudDogbnVsbCwKICAgICAgICBmaWxlX3NlbGVjdGVkOiBmYWxzZQogICAgICB9CiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHRvdGFsX3BhZ2VzX2xvYWRlZCgpIHsKICAgICAgaWYgKCh0aGlzLm1lc3NhZ2VfcGFnaW5hdGlvbi5wYWdlX25vICogdGhpcy5tZXNzYWdlX3BhZ2luYXRpb24ucGVyX3BhZ2UpID49IHRoaXMubWVzc2FnZV9wYWdpbmF0aW9uLnRvdGFsX3JlY29yZHMpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgbWVzc2FnZV90ZXh0X2JveF9wbGFjZWhvbGRlcigpIHsKICAgICAgcmV0dXJuICJTZW5kIGEgbWVzc2FnZSB0byB1c2VyIgogICAgfSwKICAgIHRvdGFsX2NvbnRhY3RfbG9hZGVkKCl7CiAgICAgIGlmICgodGhpcy5hbGxfY29udGFjdF9wYWdpbmF0aW9uLnBhZ2Vfbm8gKiB0aGlzLmFsbF9jb250YWN0X3BhZ2luYXRpb24ucGVyX3BhZ2UpID49IHRoaXMuYWxsX2NvbnRhY3RfcGFnaW5hdGlvbi50b3RhbF9yZWNvcmRzKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0X2NvbnRhY3RfbGlzdCh0cnVlKTsKICAgIHRoaXMuZ2V0X3Byb2ZpbGVfZGV0YWlscygpOwogICAgY29uc3Qgdm0gPSB0aGlzOwogICAgJCh3aW5kb3cpLmJpbmQoJ21vdXNld2hlZWwnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgaWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YSA+PSAwKSB7CiAgICAgICAgdm0ubWVzc2FnZV9wYWdpbmF0aW9uLmlzX3Njcm9sbF91cCA9IHRydWU7CiAgICAgIH0KICAgICAgZWxzZSB7CiAgICAgICAgdm0ubWVzc2FnZV9wYWdpbmF0aW9uLmlzX3Njcm9sbF91cCA9IGZhbHNlOwogICAgICB9CiAgICB9KTsKICAgIC8vIHZhciBsYXN0U2Nyb2xsVG9wID0gMDsKICAgIC8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoCiAgICAvLyAgICJzY3JvbGwiLAogICAgLy8gICBmdW5jdGlvbiAoZXYpIHsKICAgIC8vICAgICBpZiAoZXYudGFyZ2V0LmlkID09PSAic2Nyb2xsaW5nLWRpdi13aGF0c2FwcCIpIHsKICAgIC8vICAgICAgIGNvbnNvbGUubG9nKGV2KQogICAgLy8gICAgICAgdmFyIHN0ID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7IC8vIENyZWRpdHM6ICJodHRwczovL2dpdGh1Yi5jb20vcWVyZW15L3NvL2Jsb2IvbWFzdGVyL3NvLmRvbS5qcyNMNDI2IgogICAgLy8gICAgICAgaWYgKHN0ID4gbGFzdFNjcm9sbFRvcCl7CiAgICAvLyAgICAgICAgIHZtLm1lc3NhZ2VfcGFnaW5hdGlvbi5pc19zY3JvbGxfdXAgPSBmYWxzZTsKICAgIC8vICAgICAgIH0gZWxzZSB7CiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCJTY3JvbGxpbmcgVXAiKQogICAgLy8gICAgICAgICB2bS5tZXNzYWdlX3BhZ2luYXRpb24uaXNfc2Nyb2xsX3VwID0gdHJ1ZTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgICAgIGxhc3RTY3JvbGxUb3AgPSBzdCA8PSAwID8gMCA6IHN0OwoKICAgIC8vICAgICAgIC8vIHZtLnNjcm9sbFBvc2l0aW9uID0gZXYudGFyZ2V0WyJzY3JvbGxUb3AiXTsKICAgIC8vICAgICB9CiAgICAvLyAgIH0sCiAgICAvLyAgIHRydWUKICAgIC8vICk7CiAgICAkKCIjc2hvd0ltYWdlTW9kYWwiKS5vbigiaGlkZGVuLmJzLm1vZGFsIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB2bS5jdXJyZW50X2Z1bGxzY3JlZW5faW1hZ2Vfc3JjID0gbnVsbDsKICAgIH0pOwogICAgJCgiI2ltcG9ydENvbnRhY3RDU1ZNb2RhbCIpLm9uKCJoaWRkZW4uYnMubW9kYWwiLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHZtLmVtcHR5X3VwbG9hZF9jc3ZfY29udGFjdHMoKTsKICAgIH0pOwogICAgJCgnW2RhdGEtdG9nZ2xlPSJwb3BvdmVyIl0nKS5wb3BvdmVyKHsKICAgICAgaHRtbDogdHJ1ZSwKICAgICAgdGl0bGU6ICJMZWdlbmQgZm9yIENvbnRhY3RzIiwKICAgICAgY29udGVudDogYDxzcGFuIHN0eWxlPSdjb2xvcjojMjVhZjAyO2ZvbnQtc2l6ZTogbGFyZ2VyOyc+JiN4MjVDRjs8L3NwYW4+IDxzcGFuPiAgVGhpcyBjb250YWN0IGlzIG9uIHdoYXRzYXBwPC9zcGFuPiA8YnI+CiAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0nY29sb3I6I2ZmNDc0Nztmb250LXNpemU6IGxhcmdlcjsnPiYjeDI1Q0Y7PC9zcGFuPiA8c3Bhbj4gVGhpcyBjb250YWN0IGlzIG5vdCBvbiB3aGF0c2FwcDwvc3Bhbj4gPGJyPgogICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9J2NvbG9yOiNmZmMzNDc7Zm9udC1zaXplOiBsYXJnZXI7Jz4mI3gyNUNGOzwvc3Bhbj4gPHNwYW4+IFdlIGRvbid0IGtub3cgeWV0IHdoZXRoZXIgdGhpcyBjb250YWN0IGlzIG9uIHdoYXRzYXBwPC9zcGFuPmAKICAgIH0pOwogICAgYXhpb3MucG9zdChhcGlfY2FsbHMuaW5pdGlhbGl6ZV93aGF0c2FwcF90b3BpYygpLCAKICAgIHsKICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICB3aGF0c2FwcF9waG9uZV9udW1iZXI6ICIxMDAiLAogICAgICB0ZXN0OiBidG9hKCJ0ZXN0X3BhcmFtYXRlciIpCiAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZSkKICAgICAgLy8gdGhpcy5jaGF0X2dyb3VwX25hbWUgPSByZXNwb25zZS5kYXRhLmNoYXRfZ3JvdXBfbmFtZTsKICAgICAgLy8gdGhpcy5saXZlX2NoYXRfdG9rZW4gPSByZXNwb25zZS5kYXRhLnRva2VuOwogICAgICAvLyB0aGlzLmxpdmVfY2hhdF9vbiA9IHRydWU7CiAgICAgIHRoaXMuY2hhdF9zb2NrZXQgPSBuZXcgU29ja2V0KAogICAgICAgIHByb2Nlc3MuZW52LlZVRV9BUFBfTElWRV9DSEFUX1dFQlNPQ0tFVF9FTkRQT0lOVCwKICAgICAgICB7CiAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgd2hhdHNhcHA6ICJ0cnVlIiwKICAgICAgICAgICAgZWxpeGlyX3Rva2VuIDogcmVzcG9uc2UuZGF0YS5lbGl4aXJfdG9rZW4sCiAgICAgICAgICAgIHRva2VuOiB0aGlzLnNlc3Npb25fdG9rZW4sCiAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwKICAgICAgICAgIH0sCiAgICAgICAgfQogICAgICApOwogICAgICB0aGlzLmNoYXRfc29ja2V0LmNvbm5lY3QoKTsKICAgICAgdGhpcy5jaGFubmVsID0gdGhpcy5jaGF0X3NvY2tldC5jaGFubmVsKAogICAgICAgICJ3aGF0c2FwcDoiICsgdGhpcy5jb21wYW55X2lkCiAgICAgICk7CiAgICAgIHRoaXMuY2hhbm5lbC5qb2luKCk7CiAgICAgIHRoaXMuY2hhbm5lbC5vbigibmV3X3doYXRzYXBwX21lc3NhZ2UiLCAocmVzKSA9PiB7CiAgICAgICAgaWYocmVzLmNvbXBhbnlfaWQgPT09IHRoaXMuY29tcGFueV9pZCl7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpCiAgICAgICAgICBsZXQgY29udGFjdF9pbmRleCA9IHRoaXMuY29udGFjdF9saXN0LmZpbmRJbmRleCgoaXRlbSkgPT4ge3JldHVybiBpdGVtLndoYXRzYXBwX3Bob25lX251bWJlciA9PT0gcmVzLndoYXRzYXBwX3Bob25lX251bWJlcn0pOwogICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLCAiZWxzZSIsIGNvbnRhY3RfaW5kZXgpCiAgICAgICAgICBpZiAoY29udGFjdF9pbmRleCAhPSAtMSl7CiAgICAgICAgICAgIHRoaXMuY29udGFjdF9saXN0W2NvbnRhY3RfaW5kZXhdLmxhc3RfYm90X3Jlc3BvbnNlLnRleHQgPSByZXMud2hhdHNhcHBfbWVzc2FnZTsKICAgICAgICAgICAgdGhpcy5jb250YWN0X2xpc3RbY29udGFjdF9pbmRleF0uaXNfbmV3X25vdGlmaWNhdGlvbiA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuY29udGFjdF9saXN0W2NvbnRhY3RfaW5kZXhdLm5ld19tZXNzYWdlX2NvdW50ID0gMTsKICAgICAgICAgICAgdGhpcy5jb250YWN0X2xpc3QgPSB0aGlzLmFycmF5X21vdmUodGhpcy5jb250YWN0X2xpc3QsIGNvbnRhY3RfaW5kZXgsIDApOwogICAgICAgICAgICAvLyB0aGlzLmN1cnJlbnRfY29udGFjdF9pbmRleAogICAgICAgICAgfQogICAgICAgICAgaWYodGhpcy5jaGVja19jdXJyZW50X251bWJlcihyZXMpKXsgCiAgICAgICAgICAgIGxldCBjdXJyZW50X3RpbWVzdGFtcCA9IG5ldyBEYXRlKCksCiAgICAgICAgICAgIGN1cnJlbnRfZGF0ZSA9IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCcpOwogICAgICAgICAgICB0aGlzLmhpc3RvcnkucHVzaCgKICAgICAgICAgICAgewogICAgICAgICAgICAgICJCT1RSZXNwb25zZSI6IFtdLAogICAgICAgICAgICAgICJVc2VyUXVlcnkiOiByZXMud2hhdHNhcHBfbWVzc2FnZSwKICAgICAgICAgICAgICAiYm90X3Jlc3BvbnNlX2RhdGUiOiBjdXJyZW50X2RhdGUsIAogICAgICAgICAgICAgICJib3RfcmVzcG9uc2VfdGltZSI6IGN1cnJlbnRfdGltZXN0YW1wLCAKICAgICAgICAgICAgICAidXNlcl9xdWVyeV9kYXRlIjogY3VycmVudF9kYXRlLAogICAgICAgICAgICAgICJ1c2VyX3F1ZXJ5X3RpbWUiOiBjdXJyZW50X3RpbWVzdGFtcCwKICAgICAgICAgICAgICAiVXNlclF1ZXJ5X0RhdGVUaW1lIjogY3VycmVudF90aW1lc3RhbXAudG9JU09TdHJpbmcoKQogICAgICAgICAgICB9CiAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gbGV0IGNvbnRhY3RfaW5kZXggPSB0aGlzLmNvbnRhY3RfbGlzdC5maW5kSW5kZXgoKGl0ZW0pID0+IHtyZXR1cm4gaXRlbS53aGF0c2FwcF9waG9uZV9udW1iZXIgPT09IHJlcy53aGF0c2FwcF9waG9uZV9udW1iZXJ9KTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLCAiZWxzZSIsIGNvbnRhY3RfaW5kZXgpCiAgICAgICAgICAgIC8vIGlmIChjb250YWN0X2luZGV4ICE9IC0xKXsKICAgICAgICAgICAgLy8gICB0aGlzLmNvbnRhY3RfbGlzdCA9IHRoaXMuYXJyYXlfbW92ZSh0aGlzLmNvbnRhY3RfbGlzdCwgY29udGFjdF9pbmRleCwgMCk7CiAgICAgICAgICAgIC8vIH0KICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc2Nyb2xsX2Rvd24oKTsKICAgICAgICB9CiAgICAgIH0pCiAgICB9KQogIH0sCiAgd2F0Y2g6IHsKICAgIHNlYXJjaF92YWx1ZShuZXdWYWx1ZSkgewogICAgICBpZiAobmV3VmFsdWUgIT0gIiIgJiYgbmV3VmFsdWUubGVuZ3RoID4gMikgIHsKICAgICAgICBheGlvcwogICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy53aGF0c2FwcF9jaGF0KCksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBpc19zZWFyY2g6IHRydWUsCiAgICAgICAgICAgICAgc2VhcmNoX3N0cmluZzogbmV3VmFsdWUsCiAgICAgICAgICAgICAgaXNfZ2V0X2NvbnRhY3RzOiB0cnVlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9CiAgICAgICAgICApCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgaWYgKChyZXNwb25zZS5kYXRhID09ICJObyBjb250YWN0cyBmb3VuZCIpIHx8IChyZXNwb25zZS5kYXRhID09ICJEYXRhIG5vdCBmb3VuZCIpKSB7CiAgICAgICAgICAgICAgdGhpcy5jb250YWN0X2xpc3QgPSBbXTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgdGhpcy5jb250YWN0X2xpc3QgPSByZXNwb25zZS5kYXRhLmNvbnRhY3RzOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5nZXRfY29udGFjdF9saXN0KGZhbHNlKTsKICAgICAgfQogICAgfSwKICAgIHNlYXJjaF9pbl9jb250YWN0X2xpc3QobmV3VmFsdWUpewogICAgICBpZiAobmV3VmFsdWUgIT0gIiIgJiYgbmV3VmFsdWUubGVuZ3RoID4gMikgIHsKICAgICAgICBheGlvcwogICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy53aGF0c2FwcF9jaGF0KCksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBpc19zZWFyY2g6IHRydWUsCiAgICAgICAgICAgICAgc2VhcmNoX3N0cmluZzogbmV3VmFsdWUsCiAgICAgICAgICAgICAgaXNfZ2V0X2FsbF9jb250YWN0czogdHJ1ZQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfQogICAgICAgICAgKQogICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIk5vIGNvbnRhY3RzIGZvdW5kIikgewogICAgICAgICAgICAgIHRoaXMuYWxsX2NvbnRhY3RfbGlzdCA9IFtdOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICB0aGlzLmFsbF9jb250YWN0X2xpc3QgPSByZXNwb25zZS5kYXRhLmNvbnRhY3RzOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5nZXRfYWxsX2NvbnRhY3RfbGlzdCgpOwogICAgICB9CiAgICB9LAogICAgJ3doYXRzYXBwX3RlbXBsYXRlcy5zZWxlY3RlZF90ZW1wbGF0ZSc6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gKG5ld1ZhbCwgb2xkVmFsKXsKICAgICAgICBjb25zb2xlLmxvZyhuZXdWYWwpOwogICAgICAgIHZhciBjdXJyZW50X3RlbXBsYXRlID0gdGhpcy53aGF0c2FwcF90ZW1wbGF0ZXMudGVtcGxhdGVzX2xpc3QuZmluZCgoaXRlbSkgPT4gaXRlbS50ZW1wbGF0ZV9pZCA9PSBuZXdWYWwpOwogICAgICAgIHZhciB0ZW1wbGF0ZV9pZCA9IG5ld1ZhbDsKICAgICAgICB2YXIgdmFyaWFibGVfZGljdCA9IGN1cnJlbnRfdGVtcGxhdGUudmFyaWFibGVfZGljdDsKICAgICAgICB2YXIgaXNfcGFyZW50X3RlbXBsYXRlID0gZmFsc2U7CiAgICAgICAgYXhpb3MKICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfdGVtcGxhdGUoKSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogZmFsc2UsCiAgICAgICAgICAgICAgaXNfcHJldmlldzogdHJ1ZSwKICAgICAgICAgICAgICBpc19wYXJlbnRfdGVtcGxhdGU6IGlzX3BhcmVudF90ZW1wbGF0ZSwKICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZDogdGVtcGxhdGVfaWQsCiAgICAgICAgICAgICAgdmFyaWFibGVfZGljdDogdmFyaWFibGVfZGljdCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICkKICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIlN1Y2Nlc3MiKSB7CiAgICAgICAgICAgICAgdGhpcy53aGF0c2FwcF90ZW1wbGF0ZXMucHJldmlld190ZW1wbGF0ZV9kYXRhID0gcmVzcG9uc2UuZGF0YS5ib2R5OwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpCiAgICAgICAgICB9KQogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBlbXB0eV92YXJpYWJsZSgpIHsKICAgICAgKHRoaXMuaGlzdG9yeSA9IFtdKSwgKHRoaXMucGhvbmVubyA9IG51bGwpOwogICAgICB0aGlzLmN1c3RvbWVyX25hbWUgPSAiIjsKICAgICAgdGhpcy5jaGF0X2RldGFpbHMgPSBbXTsKICAgICAgdGhpcy5tZXNzYWdlX3BhZ2luYXRpb24ucGVyX3BhZ2UgPSA1OwogICAgICB0aGlzLm1lc3NhZ2VfcGFnaW5hdGlvbi5wYWdlX25vID0gMTsKICAgICAgdGhpcy5tZXNzYWdlX3BhZ2luYXRpb24udG90YWxfcmVjb3JkcyA9IDEwOwogICAgICB0aGlzLm1lc3NhZ2VfcGFnaW5hdGlvbi5wYWdlX3JlY29yZF9mZXRjaGVkID0gW107CiAgICAgIHRoaXMubWVzc2FnZV90b19zZW5kID0gbnVsbDsKICAgICAgdGhpcy5jdXJyZW50X2NvbnRhY3RfaW5kZXggPSBudWxsOwogICAgICB0aGlzLmFsbF9jb250YWN0X3BhZ2luYXRpb24ucGVyX3BhZ2UgPSAxMDsKICAgICAgdGhpcy5hbGxfY29udGFjdF9wYWdpbmF0aW9uLnBhZ2Vfbm8gPSAxOwogICAgICB0aGlzLmFsbF9jb250YWN0X3BhZ2luYXRpb24udG90YWxfcmVjb3JkcyA9IDEwOwogICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwgPSB7CiAgICAgICAgbWVkaWFfZmlsZV9uYW1lOiBudWxsLAogICAgICAgIG1lZGlhX2ZpbGU6IG51bGwsCiAgICAgICAgc2hvd19wcmV2aWV3OiBmYWxzZSwKICAgICAgICBtZWRpYV9jb250ZW50X3R5cGU6IG51bGwsCiAgICAgICAgbWVkaWFfdHlwZTogbnVsbCwKICAgICAgICBzZW5kX21lZGlhOiB0cnVlLAogICAgICAgIGRvY3VtZW50X2NvbnRlbnQ6IG51bGwsCiAgICAgICAgbWVkaWFfY2FwdGlvbjogbnVsbAogICAgICB9CiAgICB9LAogICAgZ2V0X2hpc3RvcnlfZGF0YSh3aGF0c2FwcF9ubywgdXNlcl9uYW1lLCBjb250YWN0X2luZGV4LCBjb250YWN0KSB7CiAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICB0aGlzLmN1c3RvbWVyX25hbWUgPSB1c2VyX25hbWU7CiAgICAgIHRoaXMuY3VycmVudF9jb250YWN0X251bWJlciA9IHdoYXRzYXBwX25vOwogICAgICB0aGlzLnNob3dfc2VuZF9tZXNzYWdlID0gZmFsc2U7CiAgICAgIHRoaXMuY3VycmVudF9jb250YWN0X2luZGV4ID0gY29udGFjdF9pbmRleDsKICAgICAgdGhpcy5zdGFydF9uZXdfY29udl9kYXRhLnN0YXJ0X25ld19jb252ID0gZmFsc2U7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfY2hhdCgpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGdldF9ieV93aGF0c2FwcF9waG9uZV9udW1iZXI6IHRydWUsCiAgICAgICAgICAgIHdoYXRzYXBwX3Bob25lX251bWJlcjogd2hhdHNhcHBfbm8sCiAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLm1lc3NhZ2VfcGFnaW5hdGlvbi5wZXJfcGFnZSwKICAgICAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNob3dfc2VuZF9tZXNzYWdlID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJEYXRhIG5vdCBmb3VuZCIpIHsKICAgICAgICAgICAgICB0aGlzLnN0YXJ0X25ld19jb252X2RhdGEuc3RhcnRfbmV3X2NvbnYgPSB0cnVlOwogICAgICAgICAgICAgIHRoaXMubmV3X2NvbnZfY29udGFjdF9kYXRhID0gY29udGFjdDsKICAgICAgICAgICAgfSBlbHNlewogICAgICAgICAgICB0aGlzLmhpc3RvcnkgPSB0aGlzLmZvcm1hdF9oaXN0b3J5X3Jlc3BvbnNlKHJlc3BvbnNlLmRhdGEuY2hhdF9oaXN0b3J5KTsKICAgICAgICAgICAgdGhpcy5waG9uZW5vID0gcmVzcG9uc2UuZGF0YS53aGF0c2FwcF9waG9uZV9udW1iZXIgfHwgd2hhdHNhcHBfbm87CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucGhvbmVubywgdGhpcy5jb250YWN0X2xpc3QpOwogICAgICAgICAgICBsZXQgY29udGFjdF9saXN0X2luZGV4ID0gdGhpcy5jb250YWN0X2xpc3QuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS53aGF0c2FwcF9waG9uZV9udW1iZXIgPT0gdGhpcy5waG9uZW5vKTsKICAgICAgICAgICAgaWYoY29udGFjdF9saXN0X2luZGV4ID49IDEpewogICAgICAgICAgICAgIC8vIHRoaXMuY29udGFjdF9saXN0ID0gdGhpcy5hcnJheV9tb3ZlKHRoaXMuY29udGFjdF9saXN0LCBjb250YWN0X2xpc3RfaW5kZXgsIDApOwogICAgICAgICAgICAgIHRoaXMuY3VycmVudF9jb250YWN0X2luZGV4ID1jb250YWN0X2xpc3RfaW5kZXg7CiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X2NvbnRhY3RfbnVtYmVyID0gdGhpcy5waG9uZW5vOwogICAgICAgICAgICAgIC8vIHRoaXMuY29udGFjdF9saXN0W2NvbnRhY3RfbGlzdF9pbmRleF0uaXNfbWVzc2FnZV9zZW5kaW5nX2VuYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLm1lc3NhZ2VfcGFnaW5hdGlvbi50b3RhbF9yZWNvcmRzID0gcmVzcG9uc2UuZGF0YS50b3RhbF9jaGF0X2hpc3Rvcnk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIHRoaXMuc2Nyb2xsX2Rvd24oKTsKICAgICAgICAgICAgICB0aGlzLmluaXRpYWxfbWVzc2FnZV9sb2FkID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VfcGFnaW5hdGlvbi5pc19zY3JvbGxfdXAgPSB0cnVlOwogICAgICAgICAgICAgIHRoaXMuY2hhdFNjcm9sbE1lc3NhZ2VzKHRydWUpOwogICAgICAgICAgICB9LCA0MDApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIGdldF9jb250YWN0X2xpc3QoZW5hYmxlX2JvdF9yZXNwb25zZXMpIHsKICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLndoYXRzYXBwX2NoYXQoKSwKICAgICAgICAgIHsKICAgICAgICAgICAgaXNfZ2V0X2NvbnRhY3RzOiB0cnVlLAogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGVuYWJsZV9ib3RfcmVzcG9uc2VfYWxsOiBlbmFibGVfYm90X3Jlc3BvbnNlcwogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGlmICgocmVzcG9uc2UuZGF0YSA9PSAiTm8gY29udGFjdHMgZm91bmQiKSB8fCAocmVzcG9uc2UuZGF0YSA9PSAiRGF0YSBub3QgZm91bmQiKSkgewogICAgICAgICAgICB0aGlzLmNvbnRhY3RfbGlzdCA9IFtdOwogICAgICAgICAgfSBlbHNlewogICAgICAgICAgICB0aGlzLmNvbnRhY3RfbGlzdCA9IHJlc3BvbnNlLmRhdGEuY29udGFjdHM7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgLy8gdGhpcy5jb250YWN0X2xpc3QgPSByZXNwb25zZS5kYXRhLmNvbnRhY3RzOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgc2Nyb2xsX2Rvd24oKSB7CiAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIubWVzc2FnZS10YWJsZS1zY3JvbGwiKTsKICAgICAgLy8gY29uc29sZS5sb2coY29udGFpbmVyKTsKICAgICAgaWYgKEJvb2xlYW4oY29udGFpbmVyKSkgewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgY29udGFpbmVyLnNjcm9sbFRvcCA9IGNvbnRhaW5lci5zY3JvbGxIZWlnaHQ7CiAgICAgICAgfSwgMTAwKQogICAgICAgIC8vIHRoaXMuaW5pdGlhbF9tZXNzYWdlX2xvYWQgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgc2Nyb2xsX2Rvd25fZWZmZWN0KCkgewogICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLm1lc3NhZ2UtdGFibGUtc2Nyb2xsIik7CiAgICAgIC8vIGNvbnNvbGUubG9nKGNvbnRhaW5lcik7CiAgICAgIGlmIChCb29sZWFuKGNvbnRhaW5lcikpIHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AgPSAxMDsKICAgICAgICB9LCAwKQogICAgICAgIC8vIHRoaXMuaW5pdGlhbF9tZXNzYWdlX2xvYWQgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgcHJvZHVjdF92YXJpYXRpb24ocHJvZHVjdHNfbGlzdCkgewogICAgICBsZXQgbmV3X3Byb2R1Y3RfbGlzdCA9IFtdOwogICAgICBmb3IgKGxldCBpIGluIHByb2R1Y3RzX2xpc3QpIHsKICAgICAgICBsZXQgY29tcG9uZW50cyA9IHByb2R1Y3RzX2xpc3RbaV0udGVtcGxhdGUuY29tcG9uZW50czsKICAgICAgICBsZXQgdGVtcCA9IHt9OwogICAgICAgIGZvciAobGV0IGogaW4gY29tcG9uZW50cykgewogICAgICAgICAgaWYgKGogPT0gMCkgewogICAgICAgICAgICB0ZW1wWyJpbWdfdXJsIl0gPSBjb21wb25lbnRzW2pdLnBhcmFtZXRlcnNbMF0uaW1hZ2UubGluazsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChqID09IDEpIHsKICAgICAgICAgICAgdGVtcFsidGl0bGUiXSA9IGNvbXBvbmVudHNbal0ucGFyYW1ldGVyc1swXS50ZXh0OwogICAgICAgICAgICB0ZW1wWyJ2YXJpYXRpb24iXSA9IGNvbXBvbmVudHNbal0ucGFyYW1ldGVyc1sxXS50ZXh0OwogICAgICAgICAgICB0ZW1wWyJwcmljZSJdID0gY29tcG9uZW50c1tqXS5wYXJhbWV0ZXJzWzJdLnRleHQ7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoaiA9PSAyKSB7CiAgICAgICAgICAgIHRlbXBbInVybCJdID0gY29tcG9uZW50c1tqXS5wYXJhbWV0ZXJzWzBdLnRleHQ7CiAgICAgICAgICAgIHRlbXBbInR5cGUiXSA9IGNvbXBvbmVudHNbal0ucGFyYW1ldGVycy50eXBlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBuZXdfcHJvZHVjdF9saXN0LnB1c2godGVtcCk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5ld19wcm9kdWN0X2xpc3Q7CiAgICB9LAogICAgY2hlY2tfaW1hZ2VfdHlwZShpbWFnZSkgewogICAgICBpZiAodHlwZW9mIGltYWdlID09ICJzdHJpbmciKSB7CiAgICAgICAgcmV0dXJuIGltYWdlOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChpbWFnZSAhPSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gaW1hZ2Uuc3JjOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdHJpbV9jYXJkX2Rlc2NyaXB0aW9uKHRleHQpIHsKICAgICAgaWYgKEJvb2xlYW4odGV4dCkpewogICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDEwMCkgewogICAgICAgICAgbGV0IHN0cmluZ190ZXh0ID0gdGV4dC5zdWJzdHJpbmcoMCwgODApICsgIi4uLiI7CiAgICAgICAgICByZXR1cm4gc3RyaW5nX3RleHQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0ZXh0OwogICAgICB9CiAgICB9LAogICAgbGF0ZXN0X2JvdF90ZXh0KHRleHQpIHsKICAgICAgaWYodGV4dCA9PT0gbnVsbCl7CiAgICAgICAgcmV0dXJuICJDdXN0b20gQm90IFJlc3BvbnNlIgogICAgICB9CiAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDM1KSB7CiAgICAgICAgcmV0dXJuIGAke3RleHQuc3Vic3RyaW5nKDAsIDM1KX0uLi5gOwogICAgICB9CiAgICAgIHJldHVybiB0ZXh0OwogICAgfSwKICAgIHNlYXJjaF9jb250YWN0X2xpc3QoKSB7CiAgICAgIGlmICh0aGlzLnNlYXJjaF92YWx1ZSA9PSAiIikgewogICAgICAgIHJldHVybiB0aGlzLmNvbnRhY3RfbGlzdDsKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgbmV3X3ZhbCA9IHRoaXMuc2VhcmNoX3ZhbHVlOwogICAgICAgIGlmIChuZXdfdmFsICE9IHRoaXMuc2VhcmNoX3ZhbHVlKSB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnNlYXJjaF92YWx1ZSk7CiAgICAgICAgICBheGlvcwogICAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfY2hhdCgpLAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICBpc19nZXRfYWxsX2NvbnRhY3RzOiB0cnVlLAogICAgICAgICAgICAgICAgaXNfc2VhcmNoOiB0cnVlLAogICAgICAgICAgICAgICAgc2VhcmNoX3N0cmluZzogdGhpcy5zZWFyY2hfdmFsdWUsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLmNvbnRhY3RfbGlzdCA9IHJlc3BvbnNlLmRhdGEuY29udGFjdHM7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpcy5jb250YWN0X2xpc3Q7CiAgICAgIH0KICAgIH0sCiAgICBjaGF0U2Nyb2xsTWVzc2FnZXMoc2Nyb2xsX2Rvd24pIHsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy5pbml0aWFsX21lc3NhZ2VfbG9hZCk7CiAgICAgIGlmICh0aGlzLmluaXRpYWxfbWVzc2FnZV9sb2FkID09PSB0cnVlKSB7CiAgICAgICAgbGV0IGNvbnRhaW5lcl9kaXZfc2Nyb2xsX3RvcCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoCiAgICAgICAgICAibWVzc2FnZS10YWJsZS1zY3JvbGwiCiAgICAgICAgKVswXS5zY3JvbGxUb3A7CiAgICAgICAgaWYgKGNvbnRhaW5lcl9kaXZfc2Nyb2xsX3RvcCA8IDUwICYmIHRoaXMubWVzc2FnZV9wYWdpbmF0aW9uLmlzX3Njcm9sbF91cCA9PT0gdHJ1ZSAmJiAhdGhpcy5pc19wYWdpbmF0ZWRfY2FsbCAmJiAhdGhpcy50b3RhbF9wYWdlc19sb2FkZWQpIHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJhcGkgY2FsbCBwYWdpbmF0ZWQiKQogICAgICAgICAgdGhpcy5pc19wYWdpbmF0ZWRfY2FsbCA9IHRydWU7CiAgICAgICAgICB0aGlzLnNjcm9sbF9zcGlubmVyX2NoYXQgPSB0cnVlOwogICAgICAgICAgYXhpb3MKICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgYXBpX2NhbGxzLndoYXRzYXBwX2NoYXQoKSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgICAgZ2V0X2J5X3doYXRzYXBwX3Bob25lX251bWJlcjogdHJ1ZSwKICAgICAgICAgICAgICAgIHdoYXRzYXBwX3Bob25lX251bWJlcjogdGhpcy5jdXJyZW50X2NvbnRhY3RfbnVtYmVyLAogICAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMubWVzc2FnZV9wYWdpbmF0aW9uLnBlcl9wYWdlLAogICAgICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5tZXNzYWdlX3BhZ2luYXRpb24ucGFnZV9ubyArIDEsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgdGhpcy5zY3JvbGxfc3Bpbm5lcl9jaGF0ID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5pc19wYWdpbmF0ZWRfY2FsbCA9IGZhbHNlOwogICAgICAgICAgICAgIGlmICghdGhpcy5tZXNzYWdlX3BhZ2luYXRpb24ucGFnZV9yZWNvcmRfZmV0Y2hlZC5pbmNsdWRlcyhyZXNwb25zZS5kYXRhLnBhZ2Vfbm8pKSB7CiAgICAgICAgICAgICAgICBsZXQgbmV3X2RhdGEgPSB0aGlzLmZvcm1hdF9oaXN0b3J5X3Jlc3BvbnNlKHJlc3BvbnNlLmRhdGEuY2hhdF9oaXN0b3J5KTsKICAgICAgICAgICAgICAgIHRoaXMuaGlzdG9yeSA9IG5ld19kYXRhLmNvbmNhdCh0aGlzLmhpc3RvcnkpOwogICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlX3BhZ2luYXRpb24ucGFnZV9yZWNvcmRfZmV0Y2hlZC5wdXNoKHJlc3BvbnNlLmRhdGEucGFnZV9ubyk7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmhpc3RvcnkpOwogICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlX3BhZ2luYXRpb24ucGFnZV9ubyArPSAxOwogICAgICAgICAgICAgICAgaWYoc2Nyb2xsX2Rvd24gPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbF9kb3duKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAvLyB0aGlzLnNjcm9sbF9kb3duX2VmZmVjdCgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2hvd19wcm9maWxlX3NldHVwKCkgewogICAgICB0aGlzLmlzX3Byb2ZpbGVfc2V0dXAgPSAhdGhpcy5pc19wcm9maWxlX3NldHVwOwogICAgICB0aGlzLmdldF9wcm9maWxlX2RldGFpbHMoKTsKICAgIH0sCiAgICBzaG93X2FsbF9jb250YWN0cygpewogICAgICB0aGlzLmlzX3Byb2ZpbGVfc2V0dXAgPSAhdGhpcy5pc19wcm9maWxlX3NldHVwOwogICAgICB0aGlzLmlzX2NvbnRhY3RfbGlzdCA9ICF0aGlzLmlzX2NvbnRhY3RfbGlzdDsKICAgICAgdGhpcy5nZXRfYWxsX2NvbnRhY3RfbGlzdCgpOwogICAgfSwKICAgIGZvcm1hdF9oaXN0b3J5X3Jlc3BvbnNlKHJlc3BvbnNlKSB7CiAgICAgIGxldCBjb25fZGF0ZSA9ICIiOwogICAgICBmb3IgKGxldCBpIGluIHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKGkgPT0gMCkgewogICAgICAgICAgY29uX2RhdGUgPSByZXNwb25zZVtpXS5ib3RfcmVzcG9uc2VfZGF0ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGNvbl9kYXRlID09IHJlc3BvbnNlW2ldLmJvdF9yZXNwb25zZV9kYXRlICYmIGkgIT0gMCkgewogICAgICAgICAgcmVzcG9uc2VbaV0uYm90X3Jlc3BvbnNlX2RhdGUgPSAiIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uX2RhdGUgPSByZXNwb25zZVtpXS5ib3RfcmVzcG9uc2VfZGF0ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgfSwKICAgIHNlbmRfbWVzc2FnZV90b191c2VyKCkgewogICAgICBpZihCb29sZWFuKHRoaXMubWVzc2FnZV90b19zZW5kKT09PSBmYWxzZSAmJiB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwuc2hvd19wcmV2aWV3ID09IGZhbHNlKSByZXR1cm4gZmFsc2U7CiAgICAgICAgbGV0IGN1cnJlbnRfdGltZXN0YW1wID0gIG5ldyBEYXRlKCksCiAgICAgICAgY3VycmVudF9kYXRlID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREJykKICAgICAgICBpZih0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwuc2hvd19wcmV2aWV3ID09IHRydWUpewogICAgICAgICAgdGhpcy5zZW5kX2F0dGFjaG1lbnRfZGV0YWlsLmNvbXBhbnlfaWQgPSB0aGlzLmNvbXBhbnlfaWQ7CiAgICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwuY29tcGFueV9uYW1lID0gdGhpcy5jb21wYW55X25hbWU7CiAgICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwud2hhdHNhcHBfY29udGFjdF9udW1iZXIgPSB0aGlzLmN1cnJlbnRfY29udGFjdF9udW1iZXI7CiAgICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwuZG9jdW1lbnRfY29udGVudCA9IG51bGw7CiAgICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwubWVkaWFfY2FwdGlvbiA9IHRoaXMubWVzc2FnZV90b19zZW5kOwogICAgICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMud2hhdHNhcHBfY2hhdCgpLCB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwsCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PT0gIldoYXRzYXBwIG1lZGlhIHNlbnQgc3VjY2Vzc2Z1bGx5Iil7CiAgICAgICAgICAgICAgbGV0IGJvdF9yZXNwb25zZSA9IFtdOwogICAgICAgICAgICAgIGlmKHRoaXMuZmlsZV9leHRlbnNpb25zLmltYWdlX2ZpbGVfZXh0ZW5zaW9ucy5pbmNsdWRlcyh0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwubWVkaWFfY29udGVudF90eXBlKSl7CiAgICAgICAgICAgICAgICBib3RfcmVzcG9uc2UgPSBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgInRleHQiOiBudWxsLCAKICAgICAgICAgICAgICAgICAgICAgICJyZWNpcGllbnRfaWQiOiB0aGlzLmN1cnJlbnRfY29udGFjdF9udW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAiaW1hZ2UiIDogewogICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uOiB0aGlzLm1lc3NhZ2VfdG9fc2VuZCwKICAgICAgICAgICAgICAgICAgICAgICAgbGluayA6IHJlc3BvbnNlLmRhdGEuZmlsZV9saW5rCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwgCiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBpZih0aGlzLmZpbGVfZXh0ZW5zaW9ucy5kb2N1bWVudF9maWxlX2V4dGVuc2lvbnMuaW5jbHVkZXModGhpcy5zZW5kX2F0dGFjaG1lbnRfZGV0YWlsLm1lZGlhX2NvbnRlbnRfdHlwZSkpewogICAgICAgICAgICAgICAgYm90X3Jlc3BvbnNlID0gWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICJ0ZXh0IjogbnVsbCwgCiAgICAgICAgICAgICAgICAgICAgICAicmVjaXBpZW50X2lkIjogdGhpcy5jdXJyZW50X2NvbnRhY3RfbnVtYmVyLAogICAgICAgICAgICAgICAgICAgICAgImltYWdlIiA6IGBodHRwczovL3N0b3JhZ2UuY2Vuc2UuYWkvJHt0aGlzLmNvbXBhbnlfaWR9L1doYXRzYXBwTWVkaWEvJHt0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwubWVkaWFfZmlsZV9uYW1lfWAKICAgICAgICAgICAgICAgICAgICB9LCAKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy5oaXN0b3J5LnB1c2goCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICJCT1RSZXNwb25zZSI6IGJvdF9yZXNwb25zZSwKICAgICAgICAgICAgICAgICAgInVzZXJfcXVlcnlfdGltZSI6Y3VycmVudF90aW1lc3RhbXAsCiAgICAgICAgICAgICAgICAgICJVc2VyUXVlcnkiOiAiIiwKICAgICAgICAgICAgICAgICAgImJvdF9yZXNwb25zZV9kYXRlIjogY3VycmVudF9kYXRlLCAKICAgICAgICAgICAgICAgICAgImJvdF9yZXNwb25zZV90aW1lIjogY3VycmVudF90aW1lc3RhbXAsIAogICAgICAgICAgICAgICAgICAidXNlcl9xdWVyeV9kYXRlIjogY3VycmVudF9kYXRlLAogICAgICAgICAgICAgICAgICAiQ2hhdF9EYXRldGltZSI6IGN1cnJlbnRfdGltZXN0YW1wLnRvSVNPU3RyaW5nKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHRoaXMuc2Nyb2xsX2Rvd24oKTsKICAgICAgICAgICAgICB0aGlzLmNvbnRhY3RfbGlzdFt0aGlzLmN1cnJlbnRfY29udGFjdF9pbmRleF0ubGFzdF9ib3RfcmVzcG9uc2UudGV4dCA9IHRoaXMubWVzc2FnZV90b19zZW5kOwogICAgICAgICAgICAgIHRoaXMuY29udGFjdF9saXN0ID0gdGhpcy5hcnJheV9tb3ZlKHRoaXMuY29udGFjdF9saXN0LCB0aGlzLmN1cnJlbnRfY29udGFjdF9pbmRleCwgMCk7CiAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlX3RvX3NlbmQgPSBudWxsOwogICAgICAgICAgICAgIHRoaXMuY3VycmVudF9jb250YWN0X2luZGV4ID0gMDsKICAgICAgICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwuc2hvd19wcmV2aWV3ID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9KS5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhlKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9KQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy53aGF0c2FwcF9jaGF0KCksIHsKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICBzZW5kX21lc3NhZ2U6IHRydWUsCiAgICAgICAgdGV4dDogdGhpcy5tZXNzYWdlX3RvX3NlbmQsCiAgICAgICAgd2hhdHNhcHBfY29udGFjdF9udW1iZXI6IHRoaXMuY3VycmVudF9jb250YWN0X251bWJlcgogICAgICB9LAogICAgICB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgfSwKICAgICAgfSkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgIGlmKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PT0gIldoYXRzYXBwIG1lc3NhZ2Ugc2VudCBzdWNjZXNzZnVsbHkiKXsKICAgICAgICAgIGlmKHRoaXMuc3RhcnRfbmV3X2NvbnZfZGF0YS5zdGFydF9uZXdfY29udil7CiAgICAgICAgICAgIHRoaXMuY3VycmVudF9jb250YWN0X2luZGV4ID0gMDsKICAgICAgICAgICAgdGhpcy5uZXdfY29udl9jb250YWN0X2RhdGEuY2hhdF9kYXRldGltZSA9IGN1cnJlbnRfdGltZXN0YW1wLnRvSVNPU3RyaW5nKCkKICAgICAgICAgICAgdGhpcy5uZXdfY29udl9jb250YWN0X2RhdGEuaXNfbWVzc2FnZV9zZW5kaW5nX2VuYWJsZWQgPSB0cnVlCiAgICAgICAgICAgIHRoaXMubmV3X2NvbnZfY29udGFjdF9kYXRhLmxhc3RfYm90X3Jlc3BvbnNlID0gewogICAgICAgICAgICAgIHRleHQ6IHRoaXMubWVzc2FnZV90b19zZW5kLCAKICAgICAgICAgICAgICBjaGF0X2RhdGV0aW1lOiBjdXJyZW50X3RpbWVzdGFtcC50b0lTT1N0cmluZygpLCAKICAgICAgICAgICAgICBkYXRlOiBjdXJyZW50X2RhdGUsIAogICAgICAgICAgICAgIHRpbWU6IGAke2N1cnJlbnRfdGltZXN0YW1wLmdldFVUQ0hvdXJzKCl9OiR7Y3VycmVudF90aW1lc3RhbXAuZ2V0VVRDTWludXRlcygpfWAKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmNvbnRhY3RfbGlzdC51bnNoaWZ0KAogICAgICAgICAgICAgIHRoaXMubmV3X2NvbnZfY29udGFjdF9kYXRhCiAgICAgICAgICAgICkKICAgICAgICAgICAgdGhpcy5zdGFydF9uZXdfY29udl9kYXRhLnN0YXJ0X25ld19jb252ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmhpc3RvcnkucHVzaCgKICAgICAgICAgICAgewogICAgICAgICAgICAgICJCT1RSZXNwb25zZSI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgInRleHQiOiB0aGlzLm1lc3NhZ2VfdG9fc2VuZCwgCiAgICAgICAgICAgICAgICAgICJyZWNpcGllbnRfaWQiOiB0aGlzLmN1cnJlbnRfY29udGFjdF9udW1iZXIKICAgICAgICAgICAgICAgIH0sIAogICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgInVzZXJfcXVlcnlfdGltZSI6Y3VycmVudF90aW1lc3RhbXAsCiAgICAgICAgICAgICAgIlVzZXJRdWVyeSI6ICIiLAogICAgICAgICAgICAgICJib3RfcmVzcG9uc2VfZGF0ZSI6IGN1cnJlbnRfZGF0ZSwgCiAgICAgICAgICAgICAgImJvdF9yZXNwb25zZV90aW1lIjogY3VycmVudF90aW1lc3RhbXAsIAogICAgICAgICAgICAgICJ1c2VyX3F1ZXJ5X2RhdGUiOiBjdXJyZW50X2RhdGUsCiAgICAgICAgICAgICAgIkNoYXRfRGF0ZXRpbWUiOiBjdXJyZW50X3RpbWVzdGFtcC50b0lTT1N0cmluZygpCiAgICAgICAgICAgIH0KICAgICAgICAgICk7CiAgICAgICAgICB0aGlzLnNjcm9sbF9kb3duKCk7CiAgICAgICAgICB0aGlzLmNvbnRhY3RfbGlzdFt0aGlzLmN1cnJlbnRfY29udGFjdF9pbmRleF0ubGFzdF9ib3RfcmVzcG9uc2UudGV4dCA9IHRoaXMubWVzc2FnZV90b19zZW5kOwogICAgICAgICAgdGhpcy5jb250YWN0X2xpc3QgPSB0aGlzLmFycmF5X21vdmUodGhpcy5jb250YWN0X2xpc3QsIHRoaXMuY3VycmVudF9jb250YWN0X2luZGV4LCAwKTsKICAgICAgICAgIHRoaXMubWVzc2FnZV90b19zZW5kID0gbnVsbDsKICAgICAgICAgIHRoaXMuY3VycmVudF9jb250YWN0X2luZGV4ID0gMDsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKChlKSA9PiB7CiAgICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICBzd2FsKHsKICAgICAgICAgIHRpdGxlOiAiT29wcyIsCiAgICAgICAgICB0ZXh0OiAiU29tZSBFcnJvciBPY2N1cnJlZCIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZQogICAgICAgIH0pCiAgICAgIH0pCiAgICB9LAogICAgZWRpdF93ZWJzaXRlX3ZhbHVlKGluZGV4KXsKICAgICAgdGhpcy5pbmRleF91cGRhdGUgPSBpbmRleDsKICAgICAgdGhpcy5lZGl0X3dlYnNpdGUgPSB0cnVlOwogICAgfSwKICAgIGdldF9wcm9maWxlX2RldGFpbHMoKXsKICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICB0aGlzLmVkaXRfZW1haWwgPWZhbHNlOwogICAgICB0aGlzLmVkaXRfYWRkcmVzcyA9IGZhbHNlOwogICAgICB0aGlzLmVkaXRfZGVzY3JpcHRpb24gPSBmYWxzZTsKICAgICAgdGhpcy5lZGl0X3dlYnNpdGUgPSBmYWxzZTsKICAgICAgdGhpcy5lZGl0X3N0YXR1cyA9IGZhbHNlOwogICAgICB0aGlzLmluZGV4X3VwZGF0ZSA9IG51bGwgOwogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLndoYXRzYXBwX3Byb2ZpbGUoKSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICBpc19nZXQ6dHJ1ZQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICB0aGlzLndoYXRzYXBwX3Byb2ZpbGUgPSByZXNwb25zZS5kYXRhLndoYXRzYXBwX3Byb2ZpbGUKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHVwZGF0ZV9wcm9maWxlX2RldGFpbHMoKXsKICAgICAgdGhpcy5lZGl0X2VtYWlsID1mYWxzZTsKICAgICAgdGhpcy5lZGl0X2FkZHJlc3MgPSBmYWxzZTsKICAgICAgdGhpcy5lZGl0X2Rlc2NyaXB0aW9uID0gZmFsc2U7CiAgICAgIHRoaXMuZWRpdF93ZWJzaXRlID0gZmFsc2U7CiAgICAgIHRoaXMuZWRpdF9zdGF0dXMgPSBmYWxzZTsKICAgICAgdGhpcy5pbmRleF91cGRhdGUgPSBudWxsIDsKICAgICAgaWYgKHRoaXMud2hhdHNhcHBfcHJvZmlsZS53ZWJzaXRlcy5sZW5ndGggPT0gMikgewogICAgICAgICAgIHRoaXMuc2Vjb25kX3dlYnNpdGUgPSB0cnVlOyAKICAgICAgfQogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfcHJvZmlsZSgpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGlzX2VkaXQ6dHJ1ZSwKICAgICAgICAgICAgd2hhdHNhcHBfcHJvZmlsZTp0aGlzLndoYXRzYXBwX3Byb2ZpbGUKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgbGV0IHJlc3AgPSByZXNwb25zZS5kYXRhLnVwZGF0ZV9yZXNwb25zZTsKICAgICAgICAgIGlmIChyZXNwID09ICJlZGl0IHN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICAgICAgdGhpcy5nZXRfcHJvZmlsZV9kZXRhaWxzKCk7CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogIlBsZWFzZSBlbnRyZSB2YWxpZCBkYXRhIiwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDIwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuZ2V0X3Byb2ZpbGVfZGV0YWlscygpOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICB1cGRhdGVfcHJvZmlsZV9pbWFnZShlKXsKICAgICAgdGhpcy5zZWxlY3RlZF9maWxlcyA9IGUudGFyZ2V0LmZpbGVzWzBdOwogICAgICBpZiAodGhpcy5zZWxlY3RlZF9maWxlcy50eXBlID09ICdpbWFnZS9wbmcnIHx8IHRoaXMuc2VsZWN0ZWRfZmlsZXMudHlwZSA9PSAnaW1hZ2UvanBnJyB8fCB0aGlzLnNlbGVjdGVkX2ZpbGVzLnR5cGUgPT0gJ2ltYWdlL2pwZWcnICApIHsKICAgICAgICBpZiAodGhpcy5zZWxlY3RlZF9maWxlcy5zaXplID4gNTA5NzE1MikgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRleHQ6ICJVcGxvYWQgaW1hZ2Ugd2l0aCBzaXplIHNob3VsZCBiZSBsZXNzIHRoYW4gNU1CIiwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDIwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zZWxlY3RlZF9maWxlcyA9Jyc7CiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgICAgbGV0IGZpbGVfdG9fdXBsb2FkID0gdGhpcy5zZWxlY3RlZF9maWxlczsKICAgICAgICB2YXIgcHJvZmlsZV9pbWcgPSB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgcGhvdG86ZmlsZV90b191cGxvYWQKICAgICAgICAgIH0KICAgICAgICB2YXIganNvbiA9IEpTT04uc3RyaW5naWZ5KHByb2ZpbGVfaW1nKTsKICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtqc29uXSwgewogICAgICAgICAgICB0eXBlOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgZmQgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICBmZC5hcHBlbmQoCiAgICAgICAgICAncGhvdG8nLAogICAgICAgICAgdGhpcy5zZWxlY3RlZF9maWxlcwogICAgICAgICkKICAgICAgICBmZC5hcHBlbmQoImpzb24iLCBibG9iKTsKICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgICAgYXhpb3MKICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfcHJvZmlsZSgpLGZkLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfQogICAgICAgICAgKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgIGxldCByZXNwID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgIGlmIChyZXNwID09ICJQaG90byB1cGRhdGluZyBzdWNjZXNzZnVsIikgewogICAgICAgICAgICAgIHRoaXMuZ2V0X3Byb2ZpbGVfZGV0YWlscygpOwogICAgICAgICAgfQogICAgICAgICAgZWxzZSBpZiAocmVzcCA9PSAiQ2Fubm90IHVwZGF0ZSBwaG90byB5ZXQiKXsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiAiWW91IGNhbm5vdCB1cGRhdGUgdGhlIHByb2ZpbGUgcGljdHVyZSB5ZXQsIHBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5nZXRfcHJvZmlsZV9kZXRhaWxzKCk7CiAgICAgICAgICB9CiAgICAgICAgICBlbHNlewogICAgICAgICAgICB0aGlzLmdldF9wcm9maWxlX2RldGFpbHMoKTsKICAgICAgICAgIH0gICAgICAKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIH1lbHNlIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogIlVwbG9hZCBpbWFnZSB3aXRoIHNwZWNpZmljIGZvcm1hdGUoanBnIGpwZWcgcG5nKSIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiAyMDAwCiAgICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHJlbW92ZV9wcm9maWxlX2ltYWdlKCl7CiAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gdHJ1ZTsKICAgICAgYXhpb3MKICAgICAgICAucG9zdCgKICAgICAgICAgIGFwaV9jYWxscy53aGF0c2FwcF9wcm9maWxlKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgaXNfcmVtb3ZlX3Bob3RvOnRydWUKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgaWYocmVzcG9uc2UuZGF0YSA9PT0gIlBob3RvIHJlbW92ZWQiKXsKICAgICAgICAgICAgdGhpcy5nZXRfcHJvZmlsZV9kZXRhaWxzKCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PT0iUGhvdG8gcmVtb3ZhbCB1bnN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICAgIHRoaXMuZ2V0X3Byb2ZpbGVfZGV0YWlscygpOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgY29ubmVjdF9lbGl4aXJfc29ja2V0KCl7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmluaXRpYWxpemVfd2hhdHNhcHBfdG9waWMoKSx7CiAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgIHdoYXRzYXBwX3Bob25lX251bWJlcjogIjEwMCIKICAgICAgfSkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZSkKICAgICAgICAvLyB0aGlzLmNoYXRfZ3JvdXBfbmFtZSA9IHJlc3BvbnNlLmRhdGEuY2hhdF9ncm91cF9uYW1lOwogICAgICAgIC8vIHRoaXMubGl2ZV9jaGF0X3Rva2VuID0gcmVzcG9uc2UuZGF0YS50b2tlbjsKICAgICAgICAvLyB0aGlzLmxpdmVfY2hhdF9vbiA9IHRydWU7CiAgICAgICAgdGhpcy5jaGF0X3NvY2tldCA9IG5ldyBTb2NrZXQoCiAgICAgICAgICBwcm9jZXNzLmVudi5WVUVfQVBQX0xJVkVfQ0hBVF9XRUJTT0NLRVRfRU5EUE9JTlQsCiAgICAgICAgICB7CiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIHdoYXRzYXBwOiAidHJ1ZSIsCiAgICAgICAgICAgICAgdG9rZW4gOiByZXNwb25zZS5kYXRhLnRva2VuCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKTsKICAgICAgICB0aGlzLmNoYXRfc29ja2V0LmNvbm5lY3QoKTsKICAgICAgICB0aGlzLmNoYW5uZWwgPSB0aGlzLmNoYXRfc29ja2V0LmNoYW5uZWwoCiAgICAgICAgICAid2hhdHNhcHA6IiArIHJlc3BvbnNlLmRhdGEud2hhdHNhcHBfdG9waWMKICAgICAgICApOwogICAgICAgIHRoaXMuY2hhbm5lbC5qb2luKCk7CiAgICAgICAgdGhpcy5jaGFubmVsLm9uKCJuZXdfd2hhdHNhcHBfbWVzc2FnZSIsIChyZXMpID0+IHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJuZXdfd2hhdHNhcHBfbWVzc2FnZSIsIHJlcykKICAgICAgICB9KQogICAgICB9KQogICAgfSwKICAgIGVuYWJsZV9zZW5kaW5nX21lc3NhZ2VzX2Zvcl91c2VyKCl7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLndoYXRzYXBwX2NoYXQoKSwgewogICAgICAgIHVwZGF0ZV9ib3RfcmVzcG9uc2U6IHRydWUsCiAgICAgICAgd2hhdHNhcHBfY29udGFjdF9udW1iZXI6IHRoaXMuY3VycmVudF9jb250YWN0X251bWJlciwKICAgICAgICBib3RfcmVzcG9uc2U6IGZhbHNlLAogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICB9LAogICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gIlN1Y2Nlc3MiKSB7CiAgICAgICAgICBpZih0aGlzLnN0YXJ0X25ld19jb252X2RhdGEuc3RhcnRfbmV3X2NvbnYgPT09IHRydWUpewogICAgICAgICAgICB0aGlzLnN0YXJ0X25ld19jb252X2RhdGEuaXNfbWVzc2FnZV9zZW5kaW5nX2VuYWJsZWQgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5jb250YWN0X2xpc3RbdGhpcy5jdXJyZW50X2NvbnRhY3RfaW5kZXhdLmlzX21lc3NhZ2Vfc2VuZGluZ19lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuY29udGFjdF9saXN0LCB0aGlzLmN1cnJlbnRfY29udGFjdF9pbmRleCwgdGhpcy5jb250YWN0X2xpc3RbdGhpcy5jdXJyZW50X2NvbnRhY3RfaW5kZXhdKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgdGhpcy4kcmVmc1sibWVzc2FnZV9zZW5kaW5nX3RleHRib3giXS5mb2N1cygpOwogICAgICAgICAgfSkKICAgICAgICB9IGVsc2UgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09ICJGYWlsdXJlIil7CgogICAgICAgIH0gZWxzZSBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gIkVycm9yIil7CgogICAgICAgIH0KICAgICAgfSkuY2F0Y2goKGUpID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhlKQoKICAgICAgfSkKICAgIH0sIAogICAgZXhwYW5kX3RleHRib3goaWQsIGtleSkgewogICAgICBpZiAoaWQgIT0gJyNidXNpbmVzc19hZGRyZXNzJykgewogICAgICAgIHRoaXMuY2FsbHNlYXJjaCgpOwogICAgICB9ZWxzZXsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB2YXIgdGV4dGFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGlkKTsKICAgICAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZSA9PnsKICAgICAgICAgIGxldCBzY3JvbGxfaGVpZ2h0ID1lLnRhcmdldC5zY3JvbGxIZWlnaHQ7CiAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5oZWlnaHQgPSBgJHtzY3JvbGxfaGVpZ2h0fXB4YAogICAgICAgIH0pOwogICAgICAgIH0sMTApOwogICAgICB9CiAgICB9LAogICAgY2FsbHNlYXJjaCgpIHsKICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzICYmICFldmVudC5zaGlmdEtleSkgewogICAgICAgIHRoaXMudXBkYXRlX3Byb2ZpbGVfZGV0YWlscygpOwogICAgICB9CiAgICB9LAogICAgY2hlY2tfY3VycmVudF9udW1iZXIocmVzKXsKICAgICAgcmV0dXJuIHJlcy53aGF0c2FwcF9waG9uZV9udW1iZXIgPT09IHRoaXMuY3VycmVudF9jb250YWN0X251bWJlciA/IHRydWUgOiBmYWxzZTsKICAgIH0sCiAgICBmb3JtYXRfdXNlcl9xdWVyeV9kYXRlKHVzZXJfcXVlcnlfZGF0ZSwgaW5kZXgpewogICAgICAvLyBjb25zb2xlLmxvZyhPYmplY3Qua2V5cyh0aGlzLmhpc3RvcnlbaW5kZXgtMV0pKQogICAgICBpZih0aGlzLmhpc3RvcnlbaW5kZXgtMV0udXNlcl9xdWVyeV9kYXRlID09IHVzZXJfcXVlcnlfZGF0ZSl7CiAgICAgICAgcmV0dXJuICIiCiAgICAgIH0KICAgICAgcmV0dXJuIHVzZXJfcXVlcnlfZGF0ZQogICAgfSwKICAgIGdldF9hbGxfY29udGFjdF9saXN0KCkgewogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfY2hhdCgpLAogICAgICAgICAgewogICAgICAgICAgICBpc19nZXRfYWxsX2NvbnRhY3RzOiB0cnVlLAogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuYWxsX2NvbnRhY3RfbGlzdCA9IHJlc3BvbnNlLmRhdGEuY29udGFjdHM7CiAgICAgICAgICB0aGlzLmFsbF9jb250YWN0X3BhZ2luYXRpb24udG90YWxfcmVjb3JkcyA9IHJlc3BvbnNlLmRhdGEudG90YWxfY29udGFjdHM7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBuZXdfY29udGFjdF9saXN0KCkgewogICAgICAgbGV0IHNjcm9sbGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYWxsLWNvbnRhY3QtbGlzdCcpWzBdLnNjcm9sbFRvcDsKICAgICAgIGlmIChzY3JvbGxlciA+IDEyMCAmJiAhdGhpcy5pc19wYWdpbmF0ZWRfY2FsbCAmJiAhdGhpcy50b3RhbF9jb250YWN0X2xvYWRlZCkgewogICAgICAgIHRoaXMuaXNfcGFnaW5hdGVkX2NhbGwgPSB0cnVlOwogICAgICAgIHRoaXMuc2Nyb2xsX3NwaW5uZXJfY2hhdCA9IHRydWU7CiAgICAgICAgYXhpb3MKICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfY2hhdCgpLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaXNfZ2V0X2FsbF9jb250YWN0czogdHJ1ZSwKICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5hbGxfY29udGFjdF9wYWdpbmF0aW9uLnBlcl9wYWdlLAogICAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMuYWxsX2NvbnRhY3RfcGFnaW5hdGlvbi5wYWdlX25vICsgMSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfQogICAgICAgICAgKQogICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zY3JvbGxfc3Bpbm5lcl9jaGF0ID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5pc19wYWdpbmF0ZWRfY2FsbCA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuYWxsX2NvbnRhY3RfbGlzdCA9IHRoaXMuYWxsX2NvbnRhY3RfbGlzdC5jb25jYXQocmVzcG9uc2UuZGF0YS5jb250YWN0cyk7CiAgICAgICAgICAgICAgdGhpcy5hbGxfY29udGFjdF9wYWdpbmF0aW9uLnBhZ2Vfbm8gKz0gMTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zY3JvbGxfc3Bpbm5lcl9jaGF0ID0gZmFsc2U7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0sCiAgICBhcnJheV9tb3ZlKGFyciwgb2xkX2luZGV4LCBuZXdfaW5kZXgpIHsKICAgICAgaWYgKG5ld19pbmRleCA+PSBhcnIubGVuZ3RoKSB7CiAgICAgICAgICB2YXIgayA9IG5ld19pbmRleCAtIGFyci5sZW5ndGggKyAxOwogICAgICAgICAgd2hpbGUgKGstLSkgewogICAgICAgICAgICAgIGFyci5wdXNoKHVuZGVmaW5lZCk7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgYXJyLnNwbGljZShuZXdfaW5kZXgsIDAsIGFyci5zcGxpY2Uob2xkX2luZGV4LCAxKVswXSk7CiAgICAgIHJldHVybiBhcnI7IC8vIGZvciB0ZXN0aW5nCiAgICB9LAogICAgZm9ybWF0VXNlclF1ZXJ5VGltZSh1c2VyX3F1ZXJ5X3RpbWUpewogICAgICAKICAgICAgcmV0dXJuIG5ldyBEYXRlKHVzZXJfcXVlcnlfdGltZSkudG9Mb2NhbGVUaW1lU3RyaW5nKG5hdmlnYXRvci5sYW5ndWFnZSwgewogICAgICAgIGhvdXI6ICcyLWRpZ2l0JywKICAgICAgICBtaW51dGU6JzItZGlnaXQnCiAgICAgIH0pCiAgICAgIC8vIHJldHVybiB1c2VyX3F1ZXJ5X3RpbWUKICAgIH0sCiAgICBpc19hY3RpdmVfY2hhdChpbmRleCkgewogICAgICBpZihpbmRleCA9PT0gdGhpcy5jdXJyZW50X2NvbnRhY3RfaW5kZXgpIHsKICAgICAgICByZXR1cm4gImJhY2tncm91bmQ6ICNmMGY4ZmYiCiAgICAgIH0gCiAgICAgIHJldHVybiAiYmFja2dyb3VuZDogI2ZmZmZmZiIKICAgIH0sCiAgICBmb3JtYXRDb250YWN0TGFzdE1lc3NhZ2VEYXRlKGRhdGUsIHRpbWUpIHsKICAgICAgaWYobW9tZW50KGRhdGUpLmlzU2FtZShEYXRlLm5vdygpLCAnZGF5JykpewogICAgICAgIHJldHVybiBuZXcgRGF0ZShgJHtkYXRlfSAke3RpbWV9WmApLnRvTG9jYWxlVGltZVN0cmluZyhuYXZpZ2F0b3IubGFuZ3VhZ2UsIHsKICAgICAgICBob3VyOiAnMi1kaWdpdCcsCiAgICAgICAgbWludXRlOicyLWRpZ2l0JwogICAgICB9KQogICAgICB9IAogICAgICByZXR1cm4gZGF0ZQogICAgfSwKICAgIGNoZWNrX3ByZXZpb3VzX21lc3NhZ2VfZGF0ZV9zYW1lKGluZGV4KXsKICAgICAgLy8gY29uc29sZS5sb2coaW5kZXgpCiAgICAgIHJldHVybiB0cnVlOyAKICAgICAgLy8gaWYoaW5kZXggPT0gMCkgewogICAgICAvLyAgIHJldHVybiB0cnVlOyAKICAgICAgLy8gfQogICAgICAvLyByZXR1cm4gdGhpcy5oaXN0b3J5W2luZGV4LTFdLmJvdF9yZXNwb25zZV9kYXRlID09IHRoaXMuaGlzdG9yeVtpbmRleF0uYm90X3Jlc3BvbnNlX2RhdGUgPyB0cnVlIDogZmFsc2U7IAogICAgfSwKICAgIHByb2Nlc3NfYXR0YWNobWVudF9maWxlKGUpIHsKICAgICAgbGV0IGZpbGVzID0gZS50YXJnZXQuZmlsZXMgfHwgZS5kYXRhVHJhbnNmZXIuZmlsZXM7CiAgICAgIGlmIChmaWxlc1swXS5zaXplID4gMjA5NzE1MikgewogICAgICAgIHN3YWwoewogICAgICAgICAgdGV4dDogIlVwbG9hZCBpbWFnZSB3aXRoIHNpemUgbGVzcyB0aGFuIDJNQiIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDEwMDAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5maWxlX2V4dGVuc2lvbnMuYWxsX2FsbG93ZWRfZmlsZV9leHRlbnNpb25zLmluY2x1ZGVzKGZpbGVzWzBdLnR5cGUpKSB7CiAgICAgICAgaWYgKCFmaWxlcy5sZW5ndGgpIHJldHVybjsKICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwubWVkaWFfZmlsZV9uYW1lID0gZmlsZXNbMF0ubmFtZTsKICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwubWVkaWFfY29udGVudF90eXBlID0gZmlsZXNbMF0udHlwZTsKICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwuZG9jdW1lbnRfY29udGVudCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZXNbMF0pOwogICAgICAgIHRoaXMuc2VuZF9hdHRhY2htZW50X2RldGFpbC5zaG93X3ByZXZpZXcgPSB0cnVlOwogICAgICAgIHRoaXMuc2VuZF9hdHRhY2htZW50X2RldGFpbC5tZWRpYV90eXBlID0gdGhpcy5maWxlX2V4dGVuc2lvbnMuaW1hZ2VfZmlsZV9leHRlbnNpb25zLmluY2x1ZGVzKGZpbGVzWzBdLnR5cGUpID8gJ2ltYWdlJzogJ2RvY3VtZW50JzsKICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwubWVkaWFfY2FwdGlvbiA9IHRoaXMubWVzc2FnZV90b19zZW5kOwogICAgICAgIHRoaXMuY3JlYXRlQXR0YWNobWVudChmaWxlc1swXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0aXRsZTogIlBsZWFzZSBTZWxlY3QgYSBwcm9wZXIgZG9jdW1lbnQgb3IgaW1hZ2UgaGF2aW5nIHRoZSBjb3JyZWN0IGZpbGV0eXBlIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZQogICAgICAgIH0pCiAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVBdHRhY2htZW50KGZpbGUsIHR5cGUpIHsKICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICByZWFkZXIub25sb2FkID0gKGUpID0+IHsKICAgICAgICB0aGlzLnNlbmRfYXR0YWNobWVudF9kZXRhaWwubWVkaWFfZmlsZSA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdCgiYmFzZTY0LCIpWzFdOwogICAgICB9OwogICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgcmVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImltZy1wcmV2aWV3Iikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW1nLXByZXZpZXciKS5pbm5lckhUTUwgPSAnPGltZyBjbGFzcz0iY3VzdG9tLWRpc3BsYXktaW1hZ2UiIHN0eWxlPSJtYXgtaGVpZ2h0OjUwMHB4OyBwYWRkaW5nOiAxcmVtO21hcmdpbi1sZWZ0OiBhdXRvOyBtYXJnaW4tcmlnaHQ6IGF1dG87IiBzcmM9IicgKyB0aGlzLnJlc3VsdCArICciIC8+JzsKICAgICAgfSk7ICAgIAogICAgfSwKICAgIGlzX3Jlc3BvbnNlX2ltYWdlKGRhdGEpewogICAgICBpZihkYXRhLnRlbXBsYXRlID09IG51bGwgJiYgZGF0YS50ZXh0ID09IG51bGwgJiYgQm9vbGVhbihkYXRhLmltYWdlKSE9IG51bGwpewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBpc19yZXNwb25zZV9kb2N1bWVudChkYXRhKXsKICAgICAgaWYoZGF0YS50ZW1wbGF0ZSA9PSBudWxsICYmIGRhdGEudGV4dCA9PSBudWxsICYmIGRhdGEuaW1hZ2U9PSBudWxsICYmIEJvb2xlYW4oZGF0YS5hdHRhY2htZW50KSAhPSBudWxsKXsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgc2hvd19pbWFnZV9mdWxsc2NyZWVuKGltZ19zcmMpewogICAgICAkKCIjc2hvd0ltYWdlTW9kYWwiKS5tb2RhbCgic2hvdyIpOwogICAgICB0aGlzLmN1cnJlbnRfZnVsbHNjcmVlbl9pbWFnZV9zcmMgPSBpbWdfc3JjOwogICAgfSwKICAgIGFkZF9uZXdfY29udGFjdF9tb2RhbCgpewogICAgICAvLyBjb25zb2xlLmxvZygiYWRkIG5ldyBjb250YWN0LWFkZENvbnRhY3RNb2RhbCIpCiAgICAgICQoIiNhZGRDb250YWN0TW9kYWwiKS5tb2RhbCgic2hvdyIpOwogICAgfSwKICAgIHNhdmVfbmV3X2NvbnRhY3QoKSB7CiAgICAgIHRoaXMuYWRkX25ld19jb250YWN0LmNvbXBhbnlfaWQgPSB0aGlzLmNvbXBhbnlfaWQ7CiAgICAgIHRoaXMuYWRkX25ld19jb250YWN0LmNvbXBhbnlfbmFtZSA9IHRoaXMuY29tcGFueV9uYW1lOwogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgIC5wb3N0KAogICAgICAgIGFwaV9jYWxscy53aGF0c2FwcF9jaGF0KCksdGhpcy5hZGRfbmV3X2NvbnRhY3QsCiAgICAgICAgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgIH0sCiAgICAgICAgfQogICAgICApCiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgIGlmKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAnV2hhdHNhcHAgQ29udGFjdCBBZGRlZCBTdWNjZXNzZnVsbHknKXsKICAgICAgICAgIHN3YWwoewogICAgICAgICAgICB0aXRsZTogIlN1Y2Nlc3MiLAogICAgICAgICAgICB0ZXh0OiAiQ29udGFjdCBBZGRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlCiAgICAgICAgICB9KQogICAgICAgICAgJCgiI2FkZENvbnRhY3RNb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICB0aGlzLmNsZWFyX2FkZF9jb250YWN0KCk7CiAgICAgICAgICB0aGlzLmdldF9hbGxfY29udGFjdF9saXN0KCk7CiAgICAgICAgfSBlbHNlIGlmKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAnUHJvdmlkZWQgbnVtYmVyIGFscmVhZHkgZXhpc3RzIGluIGNvbnRhY3RzJykgewogICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiAiT29wcyEiLAogICAgICAgICAgICB0ZXh0OiAiQ29udGFjdCBBbHJlYWR5IEV4aXN0cyIsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlCiAgICAgICAgICB9KQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgdGl0bGU6ICJPb3BzISIsCiAgICAgICAgICAgIHRleHQ6ICJTb21lIEVycm9yIE9jY3VycmVkLiBQbGVhc2UgVHJ5IEFnYWluISIsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goKGUpID0+IHsKICAgICAgICBzd2FsKHsKICAgICAgICAgIHRpdGxlOiAiT29wcyEiLAogICAgICAgICAgdGV4dDogIlNvbWUgRXJyb3IgT2NjdXJyZWQuIFBsZWFzZSBUcnkgQWdhaW4hIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZQogICAgICAgIH0pCiAgICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICBpZiAoCiAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgKSB7CiAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2xlYXJfYWRkX2NvbnRhY3QoKXsKICAgICAgdGhpcy5hZGRfbmV3X2NvbnRhY3QgPSB7CiAgICAgICAgcGhvbmVfbnVtYmVyOiBudWxsLAogICAgICAgIGlzX2FkZF9jb250YWN0OiB0cnVlLAogICAgICAgIGNvbnRhY3RfbmFtZTogbnVsbCwKICAgICAgICBmb3JtYXR0ZWROdW1iZXI6IG51bGwKICAgICAgfQogICAgfSwKICAgIGRvd25sb2FkX2RvY3VtZW50KGF0dGFjaG1lbnQpewogICAgICBjb25zb2xlLmxvZyhhdHRhY2htZW50KQogICAgICB2YXIgYVRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgYVRhZy5zZXRBdHRyaWJ1dGUoJ2lkJywnYWJjZGVmZycpOwogICAgICBhVGFnLnNldEF0dHJpYnV0ZSgnZG93bmxvYWQnLCAnZG93bmxvYWQnKTsKICAgICAgYVRhZy5zZXRBdHRyaWJ1dGUoJ2hyZWYnLGF0dGFjaG1lbnQubGluayk7CiAgICAgIGFUYWcuc2V0QXR0cmlidXRlKCd0YXJnZXQnLCJfYmxhbmsiKTsKICAgICAgYVRhZy5jbGljaygpOwoKICAgICAgLy8gY29uc3QgYmxvYiA9IG5ldyBCbG9iKFthdHRhY2htZW50LmxpbmtdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pCiAgICAgIC8vIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykKICAgICAgLy8gbGluay5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKQogICAgICAvLyBsaW5rLmRvd25sb2FkID0gYXR0YWNobWVudC5maWxlbmFtZQogICAgICAvLyBsaW5rLmNsaWNrKCkKICAgICAgLy8gVVJMLnJldm9rZU9iamVjdFVSTChsaW5rLmhyZWYpCiAgICAgIC8vIGxpbmsuY2xpY2soKTsKICAgIH0sCiAgICBvcGVuX3NlbmRfdGVtcGxhdGVfdG9fdXNlcigpewogICAgICB0aGlzLnJldHJpZXZlX2FsbF90ZW1wbGF0ZXMoKTsKICAgICAgJCgiI3NlbmRUZW1wbGF0ZU1vZGFsIikubW9kYWwoInNob3ciKTsKICAgIH0sCiAgICByZXRyaWV2ZV9hbGxfdGVtcGxhdGVzKCl7CiAgICAgIHRoaXMuY3VycmVudF90ZW1wbGF0ZSA9IHt9OwogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfdGVtcGxhdGUoKSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubywKICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhICE9IG51bGwpIHsKICAgICAgICAgICAgdGhpcy53aGF0c2FwcF90ZW1wbGF0ZXMudGVtcGxhdGVzX2xpc3QgPSBbXTsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PT0gIk5vIFdoYXRzYXBwIFRlbXBsYXRlIGluIGRhdGFiYXNlIikgewogICAgICAgICAgICAgIHRoaXMud2hhdHNhcHBfdGVtcGxhdGVzLnRlbXBsYXRlc19saXN0ID0gW107CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEudGVtcGxhdGVzICE9IG51bGwpIHsKICAgICAgICAgICAgICB0aGlzLndoYXRzYXBwX3RlbXBsYXRlcy50ZW1wbGF0ZXNfbGlzdCA9IHJlc3BvbnNlLmRhdGEudGVtcGxhdGVzOwogICAgICAgICAgICAgIHRoaXMud2hhdHNhcHBfdGVtcGxhdGVzLnBhZ2luYXRpb25fZGF0YS5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEucGFnZV9jb3VudDsKICAgICAgICAgICAgICB0aGlzLndoYXRzYXBwX3RlbXBsYXRlcy5wYWdpbmF0aW9uX2RhdGEudG90YWxfcGFnZXMgPSBNYXRoLmNlaWwodGhpcy5udW1iZXJfb2Zfcm93cyAvIHRoaXMucGVyX3BhZ2UpOwogICAgICAgICAgICAgIC8vIGlmICh0aGlzLndoYXRzYXBwX3RlbXBsYXRlcy50ZW1wbGF0ZXNfbGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgLy8gICB0aGlzLnNob3dfdGVtcGxhdGUoMCk7CiAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICAgIC8vIHRoaXMuc2V0cGFnaW5hdGlvbih0aGlzLnBhZ2Vfbm8pOwogICAgICAgICAgICB9IGVsc2UgaWYocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09PSAiSW50ZXJuYWwgU2VydmVyIEVycm9yIikgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgIHRleHQ6ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiLAogICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogIlNvbWUgZXJyb3Igb2NjdXJlZCIsCiAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgc2VuZF90ZW1wbGF0ZV90b19jdXN0b21lcigpewogICAgICBheGlvcwogICAgICAucG9zdCgKICAgICAgICBhcGlfY2FsbHMud2hhdHNhcHBfdGVtcGxhdGUoKSwKICAgICAgICB7CiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogZmFsc2UsCiAgICAgICAgICB0ZW1wbGF0ZV9pZDogdGhpcy53aGF0c2FwcF90ZW1wbGF0ZXMuc2VsZWN0ZWRfdGVtcGxhdGUsCiAgICAgICAgICBjb250YWN0c19saXN0OiBbdGhpcy5jdXJyZW50X2NvbnRhY3RfbnVtYmVyXSwKICAgICAgICAgIHB1Ymxpc2hfdGVtcGxhdGU6IHRydWUsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgfSwKICAgICAgICB9CiAgICAgICkKICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAiU2VsZWN0ZWQgdGVtcGxhdGUgbm90IGZvdW5kIGluIGRiIikgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiAiSW5zdWZmaWNpZW50IGNyZWRpdHMiLAogICAgICAgICAgICB0ZXh0OiAiWW91IGhhdmUgbm8gY3JlZGl0cyBsZWZ0IHRvIHNlbmQgdGVtcGxhdGUgdG8gTm9uLVVTIHJlZ2lvbiwgWW91IGNhbiBwdXJjaGFzZSBDZW5zZSBBZGQgT25zIHRvIGNvbnRpbnVlIHNlbmRpbmcgdGVtcGxhdGUiLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgICByZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT0gIk5vIGNyZWRpdHMgbGVmdCBmb3IgdGVtcGxhdGUgdG8gbm9uIHVzIgogICAgICAgICkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiAiSW5zdWZmaWNpZW50IGNyZWRpdHMiLAogICAgICAgICAgICB0ZXh0OiAiWW91IGhhdmUgbm8gY3JlZGl0cyBsZWZ0IHRvIHNlbmQgdGVtcGxhdGUgdG8gTm9uLVVTIHJlZ2lvbiwgWW91IGNhbiBwdXJjaGFzZSBDZW5zZSBBZGQgT25zIHRvIGNvbnRpbnVlIHNlbmRpbmcgdGVtcGxhdGUiLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09ICJ0ZW1wbGF0ZSBpcyBiZWluZyBzZW50IikgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiAiVGVtcGxhdGUgaXMgYmVpbmcgc2VudCIsCiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLndoYXRzYXBwX3RlbXBsYXRlcy5zZWxlY3RlZF90ZW1wbGF0ZSA9IG51bGwgOwogICAgICAgICAgJCgiI3NlbmRUZW1wbGF0ZU1vZGFsIikubW9kYWwoImhpZGUiKTsKICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAiTm8gY3JlZGl0cyBsZWZ0IHRvIHNlbmQgdGVtcGxhdGUiKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6ICJJbnN1ZmZpY2llbnQgY3JlZGl0cyIsCiAgICAgICAgICAgIHRleHQ6ICJZb3UgaGF2ZSBubyBjcmVkaXRzIGxlZnQgdG8gc2VuZCB0ZW1wbGF0ZSB0byBVUyByZWdpb24sIFlvdSBjYW4gcHVyY2hhc2UgQ2Vuc2UgQWRkIE9ucyB0byBjb250aW51ZSBzZW5kaW5nIHRlbXBsYXRlIiwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09PSAiSW50ZXJuYWwgU2VydmVyIEVycm9yIikgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHRleHQ6ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiLAogICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogIlNvbWUgZXJyb3Igb2NjdXJlZCIsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pCiAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgIGlmICgKICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICApIHsKICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGdldF9jb250YWN0X2Rpc3BsYXlfbmFtZShjb250YWN0KXsKICAgICAgaWYoY29udGFjdC5jb250YWN0X25hbWUpIHJldHVybiBjb250YWN0LmNvbnRhY3RfbmFtZSAKICAgICAgaWYoY29udGFjdC5wcm9maWxlX25hbWUpIHJldHVybiBjb250YWN0LnByb2ZpbGVfbmFtZQogICAgICByZXR1cm4gY29udGFjdC53aGF0c2FwcF9waG9uZV9udW1iZXIKICAgIH0sCiAgICBvcGVuX2ltcG9ydF9mcm9tX2Nzdl9tb2RhbCgpewogICAgICAkKCIjYWRkQ29udGFjdE1vZGFsIikubW9kYWwoImhpZGUiKTsKICAgICAgJCgiI2ltcG9ydENvbnRhY3RDU1ZNb2RhbCIpLm1vZGFsKCJzaG93Iik7CiAgICB9LAogICAgZmlsZV9pbnB1dF9jb250YWN0c19jc3YoZSl7CiAgICAgIGlmIChlLnRhcmdldC5maWxlc1swXS50eXBlID09ICd0ZXh0L2NzdicpewogICAgICAgIHRoaXMuY29udGFjdF9jc3YuZmlsZV9sYWJlbCA9IGUudGFyZ2V0LmZpbGVzWzBdLm5hbWU7CiAgICAgICAgdGhpcy5jb250YWN0X2Nzdi5maWxlX2NvbnRlbnQgPSBlLnRhcmdldC5maWxlc1swXTsKICAgICAgICB0aGlzLmNvbnRhY3RfY3N2LmZpbGVfc2VsZWN0ZWQgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHN3YWwoewogICAgICAgICAgdGl0bGU6ICJQbGVhc2Ugc2VsZWN0IGEgcHJvcGVyIGRvY3VtZW50IGhhdmluZyBDU1YgZmlsZXR5cGUiLAogICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlCiAgICAgICAgfSkKICAgICAgfQogICAgfSwKICAgIGZpbGVfc3VibWl0X3VwbG9hZF9jb250YWN0cygpIHsKICAgICAgaWYgKCQoIiNpbnB1dEdyb3VwVXBsb2FkRmlsZWNzdiIpLnZhbCgpID09ICcnKSB7CiAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiAiT29wcyEiLAogICAgICAgICAgdGV4dDogIlBsZWFzZSBTZWxlY3QgYSBDU1YgZmlsZSIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIHVzZXJfZGV0YWlscyA9IHsKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgfTsKICAgICAgdmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeSh1c2VyX2RldGFpbHMpOwogICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtqc29uXSwgewogICAgICAgIHR5cGU6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgfSk7CiAgICAgIGNvbnN0IGZkID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGZkLmFwcGVuZCgKICAgICAgICAiZmlsZSIsCiAgICAgICAgdGhpcy5jb250YWN0X2Nzdi5maWxlX2NvbnRlbnQsCiAgICAgICAgdGhpcy5jb250YWN0X2Nzdi5maWxlX2xhYmVsCiAgICAgICk7CiAgICAgIC8vIGZkLmFwcGVuZCgianNvbiIsIGJsb2IpOwogICAgICBmZC5hcHBlbmQoImNvbXBhbnlpZCIsIHRoaXMuY29tcGFueV9pZCk7CiAgICAgIGZkLmFwcGVuZCgiY29tcGFueW5hbWUiLCB0aGlzLmNvbXBhbnlfbmFtZSk7CiAgICAgIGZkLmFwcGVuZCgiZW1haWwiLCB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwpOwogICAgICBheGlvcwogICAgICAucG9zdChhcGlfY2FsbHMud2hhdHNhcHBfaW1wb3J0X2NvbnRhY3RzKCksIGZkLCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgfSwKICAgICAgfSkKICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09ICdTdWNjZXNzJyl7CiAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgdGl0bGU6ICJTdWNjZXNzIiwKICAgICAgICAgICAgdGV4dDogIk11bHRpcGxlIGNvbnRhY3RzIGFyZSBiZWluZyBhZGRlZC4gWW91IHdpbGwgcmVjZWl2ZSBhIG1haWwgd2hlbiB0aGUgcHJvY2Vzc2luZyBpcyBmaW5pc2hlZC4iLAogICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlCiAgICAgICAgICB9KQogICAgICAgIH0gZWxzZSBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gJ0ZhaWx1cmUnKSB7CiAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgdGl0bGU6ICJJbmNvcnJlY3QgRmlsZSBGb3JtYXQhIiwKICAgICAgICAgICAgdGV4dDogIlBsZWFzZSB0cnkgYWdhaW4gd2l0aCBhIGRpZmZlcmVudCBjc3YgZmlsZSB3aGljaCBtYXRjaGVzIHRoZSBzYW1wbGUgZmlsZSBzdHJ1Y3R1cmUiLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgfSkKICAgICAgICB9IGVsc2UgaWYocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09ICdFcnJvcicpIHsKICAgICAgICAgIHN3YWwoewogICAgICAgICAgICB0aXRsZTogIlNvbWUgRXJyb3IgT2NjdXJyZWQhIiwKICAgICAgICAgICAgdGV4dDogIlBsZWFzZSB0cnkgYWdhaW4uIiwKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN3YWwoewogICAgICAgICAgICB0aXRsZTogIlNvbWUgRXJyb3IgT2NjdXJyZWQhIiwKICAgICAgICAgICAgdGV4dDogIlBsZWFzZSB0cnkgYWdhaW4uIiwKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICBzd2FsKHsKICAgICAgICAgIHRpdGxlOiAiU29tZSBFcnJvciBPY2N1cnJlZCEiLAogICAgICAgICAgdGV4dDogIlBsZWFzZSBUcnkgQWdhaW4iLAogICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgfSkKICAgICAgICAgIGlmICgKICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICApIHsKICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGVtcHR5X3VwbG9hZF9jc3ZfY29udGFjdHMoKXsKICAgICAgdGhpcy5jb250YWN0X2NzdiA9IHsKICAgICAgICBmaWxlX2xhYmVsOiAnQ2hvb3NlIEZpbGUnLAogICAgICAgIGZpbGVfY29udGVudDogbnVsbCwKICAgICAgICBmaWxlX3NlbGVjdGVkOiBmYWxzZQogICAgICB9OwogICAgICAkKCIjaW5wdXRHcm91cFVwbG9hZEZpbGVjc3YiKS52YWwoJycpOwogICAgfSwKICAgIGRvd25sb2FkX3NhbXBsZV9jb250YWN0X2ZpbGUoKXsKICAgICAgYXhpb3MoewogICAgICAgIG1ldGhvZDogInBvc3QiLAogICAgICAgIHVybDogYXBpX2NhbGxzLmZpbGVfZG93bmxvYWQoKSwKICAgICAgICByZXNwb25zZVR5cGU6ICJibG9iIiwKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBzYW1wbGVfZmlsZTogIndoYXRzYXBwX2NvbnRhY3RzIiwKICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIH0sCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgfSwKICAgICAgfSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uRmlsZURvd25sb2FkID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09PSAiTm90IGFibGUgdG8gZG93bmxvYWQgZmlsZSIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6ICJTb21lIEVycm9yIE9jY3VycmVkLiBQbGVhc2UgVHJ5IEFnYWluIiwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbcmVzcG9uc2UuZGF0YV0pKTsKICAgICAgICAgICAgdmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5jb21wYW55bmFtZSkKICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoImRvd25sb2FkIiwgInRlc3QuY3N2Iik7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT25GaWxlRG93bmxvYWQgPSBmYWxzZTsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogIlNvbWUgRXJyb3IgT2NjdXJyZWQuIFBsZWFzZSBUcnkgQWdhaW4iLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CiAgfSwKICBiZWZvcmVEZXN0cm95KCl7CiAgICB0aGlzLmNoYW5uZWwubGVhdmUoKTsgCiAgICB0aGlzLmNoYXRfc29ja2V0LmRpc2Nvbm5lY3QoKTsKICB9Cn07Cg=="},{"version":3,"sources":["WhatsappChat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2vCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"WhatsappChat.vue","sourceRoot":"src/portal/Chatbot/Dashboard","sourcesContent":["<template>\n  <div class=\"log-wrap d-flex align-items-center\">\n    <div class=\"spinner\" v-show=\"show_spinner\" id=\"spinner\"></div>\n    <div class=\"container\">\n      <!-- <div class=\"container-fluid front-container p-0 m-0\">\n        <div class=\"back-top\"></div>\n        <div class=\"back-main\"></div>\n      </div> -->\n      <div class=\"container-fluid\" style=\"padding: 50px;\">\n        <div class=\"col-sm-12 d-flex p-0\">\n          <button\n            type=\"button\"\n            class=\"close\"\n            aria-label=\"Close\"\n            style=\"padding-bottom: 10px;\"\n            @click=\"$router.push('/bot/dashboard')\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-box-arrow-in-left\" viewBox=\"0 0 16 16\">\n              <path fill-rule=\"evenodd\" d=\"M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z\"/>\n              <path fill-rule=\"evenodd\" d=\"M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z\"/>\n            </svg>\n            <span> Go back</span>\n          </button>\n        </div>\n        <div class=\"col-sm-12 row\">\n          <div class=\"col-sm-4 chat-top p-0\" v-show=\"!is_profile_setup\" style=\"height: 600px;\">\n          <div class=\"d-flex p-2\"\n            style=\"align-items: center;\">\n            <!-- top-bar -->\n            <div>\n              <img v-if=\"whatsapp_profile.photo\" \n                :src=whatsapp_profile.photo\n                class=\"rounded-circle\" \n                @click=\"show_profile_setup\"\n                height=\"40px\" width=\"40px\"\n                style=\"cursor: pointer;\">\n              <img v-else src=\"/img/whatsapp-dp.png\" \n                class=\"rounded-circle\" \n                @click=\"show_profile_setup\"\n                height=\"40px\" width=\"40px\"\n                style=\"cursor: pointer;\">\n            </div>\n            <span class=\"ml-auto mt-1 d-flex\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" fill=\"currentColor\"\n                class=\"bi bi-chat-left-text mr-4\" viewBox=\"0 0 16 16\" @click=\"show_all_contacts\" style=\"cursor:pointer;\">\n                <path\n                  d=\"M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z\" />\n                <path\n                  d=\"M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6zm0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z\" />\n              </svg>\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"18\" fill=\"currentColor\"\n                class=\"bi bi-three-dots-vertical\" viewBox=\"0 0 16 16\">\n                <path\n                  d=\"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\" />\n              </svg>\n            </span>\n          </div>\n          <div class=\"contacts pr-0\">\n            <!-- seach tab -->\n            <div class=\"search-chat\">\n              <div>\n                <input type=\"text\" placeholder=\"Search or start new chat\" v-model=\"search_value\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" fill=\"currentColor\" class=\"bi bi-search\"\n                  viewBox=\"0 0 16 16\">\n                  <path\n                    d=\"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z\" />\n                </svg>\n              </div>\n            </div>\n            <div class=\"contact-table-scroll\">\n              <table class=\"table table-hover\" style=\"margin-bottom: 0rem !important\">\n                <tbody v-if=\"contact_list.length > 0\">\n                  <tr v-for=\"(contact, index) in contact_list\" :key=\"index\"\n                    @click=\"get_history_data(contact.whatsapp_phone_number, contact.profile_name, index)\"\n                    style=\"cursor:pointer\" :style=\"is_active_chat(index)\">\n                    <td class=\"\" style=\"width: 22%;\"><img src=\"/img/whatsapp-dp.png\" alt=\"\"\n                        class=\"user-profile-picture rounded-circle\"></td>\n                    <td class=\"pl-0 pb-1 pr-3\" style=\"font-size: 13px;\">\n                      <div class=\"user-name-date d-flex\">\n                        <div class=\"user-name\">\n                          <span v-if=\"contact.profile_name\">{{ contact.profile_name }}</span>\n                          <span v-else>{{ contact.whatsapp_phone_number }}</span>\n                        </div>\n                        <div class=\"date\" v-if=\"contact.last_bot_response\">\n                          <span>{{ formatContactLastMessageDate(contact.last_bot_response.date, contact.last_bot_response.time) }}</span>\n                        </div>\n                      </div>\n                      <div>\n                        <span v-if=\"contact.last_bot_response\" class=\"user-msg-latest-conv\"><span\n                            :title=\"contact.last_bot_response.text\">{{ latest_bot_text(contact.last_bot_response.text)\n                            }}</span></span>\n                            <!-- <span v-if=\"contact.is_new_notification || false\" style=\"float: right\">{{contact.new_message_count || 1}}</span> -->\n                      </div>\n                    </td>\n                  </tr>\n                </tbody>\n                <tbody v-else>\n                  <tr>\n                    <td style=\"position: relative; padding:44px; text-align: center;\">\n                      <span class=\"contact-list-empty\">No chats,contacts or messages found</span>\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n          </div>\n          <div class=\"col-sm-4 p-0\" v-show=\"is_profile_setup && !is_contact_list\" style=\"height: 600px;\">\n            <!-- profile -->\n            <div\n              style=\"border-right: 1px solid rgba(0,0,0,0.2);align-items: center; justify-content: space-between; height: 100%;\">\n              <div class=\"profile-top d-flex\">\n                <span style=\"margin:0 0 10px 17px;cursor: pointer;\" @click=\"show_profile_setup\"><svg\n                    xmlns=\"http://www.w3.org/2000/svg\" width=\"38\" height=\"22\" fill=\"currentColor\"\n                    class=\"bi bi-arrow-left left-arrow\" viewBox=\"0 0 16 16\">\n                    <path fill-rule=\"evenodd\"\n                      d=\"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z\" />\n                  </svg>\n                </span>\n                <span style=\"opacity:2;font-size:1.1rem;margin:0 0 8px 17px;\">Profile</span>\n              </div>\n              <!-- profile pic -->\n              <div class=\"profile-bottom\">\n                <div class=\"profile-pic \">\n                  <div style=\"width: 100%;height: 100%;position: relative;\">\n                    <div class=\"second-circle\" v-if=\"whatsapp_profile.photo === ''\">\n                      <input type=\"file\" id=\"imgupload\" @change=\"update_profile_image\"/> \n                      <div class=\"img-circle-gry\">\n                        <span class=\"img-circle-title-cam\">\n                          <span>ADD PROFILE</span>\n                          <span>PHOTO</span>\n                        </span>\n                      </div>\n                    </div>\n                    <div class=\"second-circle-image\" v-else>\n                      <div style=\"width:300px\">\n                        <input type=\"file\" id=\"imgupload\" @change=\"update_profile_image\"/>\n                      </div>\n                      <img :src=whatsapp_profile.photo  alt=\"\">\n                    </div>                \n                  </div>\n                </div>\n                <div class=\"img-cricle\">\n                  <div class=\"remove-profile-pic\" v-if=\"whatsapp_profile.photo != ''\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" style=\"cursor: pointer;\" @click=\"remove_profile_image()\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-trash\" viewBox=\"0 0 16 16\">\n                      <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/>\n                      <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\"/>\n                    </svg>\n                  </div>\n                  <div class=\"no-image\">\n                  </div>\n                </div>\n                <!-- profile-details -->\n                <div class=\"profile-details\">\n                  <div class=\"all-basic-info\">\n                    <div class=\"user-email-details\">\n                      <div class=\"user-email\" v-if=\"!edit_email\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-envelope-fill\" viewBox=\"0 0 16 16\">\n                          <path d=\"M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z\"/>\n                        </svg>\n                        <span v-if=\"whatsapp_profile.email == ''\"> Email Address</span>\n                        <span v-else>{{whatsapp_profile.email}}</span>\n                        <svg v-if=\"!edit_address && !edit_description && !edit_website\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil-fill\" viewBox=\"0 0 16 16\" @click=\"edit_email = true\"  style=\"cursor: pointer;\">\n                          <path d=\"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z\"/>\n                        </svg>\n                      </div>\n                      <div class=\"edit-user-email\" v-if=\"edit_email\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-envelope-fill\" viewBox=\"0 0 16 16\">\n                          <path d=\"M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z\"/>\n                        </svg>                      \n                        <textarea \n                          class=\"input ml-1\" \n                          id=\"user_email_address\" \n                          v-model=\"whatsapp_profile.email\" \n                          placeholder=\"Email Address\"\n                          @keydown=\"expand_textbox('#user_email_address')\"\n                          >\n                        </textarea>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"22\" fill=\"currentColor\" class=\"bi bi-check2\" viewBox=\"0 0 16 16\"  @click=\"update_profile_details()\" style=\"cursor: pointer;top:1vh !important;right:0 !important;\n                          position: absolute;\"\n                        >\n                          <path d=\"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z\"/>\n                        </svg>\n                      </div>\n                    </div>\n                    <div class=\"user-address-details\">\n                      <div class=\"user-address\" v-if=\"!edit_address\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-geo-alt\" viewBox=\"0 0 16 16\">\n                          <path d=\"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A31.493 31.493 0 0 1 8 14.58a31.481 31.481 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z\"/>\n                          <path d=\"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z\"/>\n                        </svg>\n                        <span v-if=\"whatsapp_profile.address == ''\">Business Address</span>\n                        <span v-else>{{whatsapp_profile.address}}</span>\n                        <svg v-if=\"!edit_email && !edit_description && !edit_website\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil-fill\" viewBox=\"0 0 16 16\" @click=\"edit_address = true\"  style=\"cursor: pointer;\">\n                          <path d=\"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z\"/>\n                        </svg>                    \n                      </div>\n                      <div class=\"edit-user-address\" v-if=\"edit_address\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-geo-alt\" viewBox=\"0 0 16 16\">\n                          <path d=\"M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A31.493 31.493 0 0 1 8 14.58a31.481 31.481 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z\"/>\n                          <path d=\"M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z\"/>\n                        </svg>                     \n                        <textarea \n                          class=\"input ml-1\"\n                          id=\"business_address\"\n                          v-model=\"whatsapp_profile.address\"\n                          placeholder=\"Business Address\"\n                          @keydown=\"expand_textbox('#business_address')\"\n                          ></textarea>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"22\" fill=\"currentColor\" class=\"bi bi-check2\" viewBox=\"0 0 16 16\"  @click=\"update_profile_details()\" style=\"cursor: pointer;top:1vh !important;right:0 !important;\n                          position: absolute;\"\n                        >\n                          <path d=\"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z\"/>\n                        </svg>\n                      </div>  \n                    </div>\n                    <div class=\"description-details\">\n                      <div class=\"description\" v-if=\"!edit_description\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-shop\" viewBox=\"0 0 16 16\">\n                          <path d=\"M2.97 1.35A1 1 0 0 1 3.73 1h8.54a1 1 0 0 1 .76.35l2.609 3.044A1.5 1.5 0 0 1 16 5.37v.255a2.375 2.375 0 0 1-4.25 1.458A2.371 2.371 0 0 1 9.875 8 2.37 2.37 0 0 1 8 7.083 2.37 2.37 0 0 1 6.125 8a2.37 2.37 0 0 1-1.875-.917A2.375 2.375 0 0 1 0 5.625V5.37a1.5 1.5 0 0 1 .361-.976l2.61-3.045zm1.78 4.275a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 1 0 2.75 0V5.37a.5.5 0 0 0-.12-.325L12.27 2H3.73L1.12 5.045A.5.5 0 0 0 1 5.37v.255a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0zM1.5 8.5A.5.5 0 0 1 2 9v6h1v-5a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v5h6V9a.5.5 0 0 1 1 0v6h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1V9a.5.5 0 0 1 .5-.5zM4 15h3v-5H4v5zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3zm3 0h-2v3h2v-3z\"/>\n                        </svg>\n                        <span v-if=\"whatsapp_profile.description == ''\">Description</span>                      \n                        <span v-else>{{whatsapp_profile.description}}</span>\n                        <svg v-if=\"!edit_address && !edit_email && !edit_website\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil-fill\" viewBox=\"0 0 16 16\" @click=\"edit_description = true\"  style=\"cursor: pointer;\">\n                          <path d=\"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z\"/>\n                        </svg>                         \n                      </div>\n                      <div class=\"edit-description\" v-if=\"edit_description\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-shop\" viewBox=\"0 0 16 16\">\n                          <path d=\"M2.97 1.35A1 1 0 0 1 3.73 1h8.54a1 1 0 0 1 .76.35l2.609 3.044A1.5 1.5 0 0 1 16 5.37v.255a2.375 2.375 0 0 1-4.25 1.458A2.371 2.371 0 0 1 9.875 8 2.37 2.37 0 0 1 8 7.083 2.37 2.37 0 0 1 6.125 8a2.37 2.37 0 0 1-1.875-.917A2.375 2.375 0 0 1 0 5.625V5.37a1.5 1.5 0 0 1 .361-.976l2.61-3.045zm1.78 4.275a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 1 0 2.75 0V5.37a.5.5 0 0 0-.12-.325L12.27 2H3.73L1.12 5.045A.5.5 0 0 0 1 5.37v.255a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0zM1.5 8.5A.5.5 0 0 1 2 9v6h1v-5a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v5h6V9a.5.5 0 0 1 1 0v6h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1V9a.5.5 0 0 1 .5-.5zM4 15h3v-5H4v5zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3zm3 0h-2v3h2v-3z\"/>\n                        </svg>                     \n                        <textarea \n                          class=\"input ml-1\" \n                          v-model=\"whatsapp_profile.description\" \n                          placeholder=\" Description\"\n                          id=\"user_description\"\n                          @keydown=\"expand_textbox('#user_description')\"\n                          ></textarea>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"22\" fill=\"currentColor\" class=\"bi bi-check2\" viewBox=\"0 0 16 16\"  @click=\"update_profile_details()\" style=\"cursor: pointer;top:1vh !important;right:0 !important;\n                          position: absolute;\"\n                        >\n                          <path d=\"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z\"/>\n                        </svg>\n                      </div>                      \n                    </div>\n                    <div class=\"website-details mb-1\">\n                      <div  v-if=\"!edit_website\">\n                        <span v-if=\"whatsapp_profile.websites\">\n                          <div v-if=\"whatsapp_profile.websites.length == 0\" class=\"website\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-globe\" viewBox=\"0 0 16 16\">\n                              <path d=\"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4a9.267 9.267 0 0 1 .64-1.539 6.7 6.7 0 0 1 .597-.933A7.025 7.025 0 0 0 2.255 4H4.09zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a6.958 6.958 0 0 0-.656 2.5h2.49zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5H4.847zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5H4.51zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12c.138.386.295.744.468 1.068.552 1.035 1.218 1.65 1.887 1.855V12H5.145zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11a13.652 13.652 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5H3.82zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855.173-.324.33-.682.468-1.068H8.5zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5a6.959 6.959 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5h2.49zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4a7.966 7.966 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4h2.355z\"/>\n                            </svg>\n                            <span>Website Url</span>\n                            <svg v-if=\"!edit_address && !edit_email && !edit_description\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil-fill\" viewBox=\"0 0 16 16\" @click=\"edit_website_value(0)\"  style=\"cursor: pointer;\">\n                              <path d=\"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z\"/>\n                            </svg>\n                          </div>\n                          <div v-else v-for=\"(website,index) in whatsapp_profile.websites\"\n                          :key=\"index\" class=\"website mb-2 mt-1\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-globe\" viewBox=\"0 0 16 16\">\n                              <path d=\"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4a9.267 9.267 0 0 1 .64-1.539 6.7 6.7 0 0 1 .597-.933A7.025 7.025 0 0 0 2.255 4H4.09zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a6.958 6.958 0 0 0-.656 2.5h2.49zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5H4.847zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5H4.51zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12c.138.386.295.744.468 1.068.552 1.035 1.218 1.65 1.887 1.855V12H5.145zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11a13.652 13.652 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5H3.82zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855.173-.324.33-.682.468-1.068H8.5zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5a6.959 6.959 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5h2.49zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4a7.966 7.966 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4h2.355z\"/>\n                            </svg>\n                            <span >{{website}}</span>\n                            <svg v-if=\"!edit_address && !edit_email && !edit_description\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil-fill\" viewBox=\"0 0 16 16\" @click=\"edit_website_value(index)\"  style=\"cursor: pointer;\">\n                              <path d=\"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z\"/>\n                            </svg>\n                          </div>\n                          <div v-if=\"whatsapp_profile.websites.length == 1 && !second_website\">\n                            <span class=\"add-another-website\" @click=\"edit_website_value(1)\">ADD ANOTHER WEBSITE</span>\n                          </div>\n                        </span>\n                      </div>\n                      <div class=\"edit-website\" v-if=\"edit_website\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-globe\" viewBox=\"0 0 16 16\">\n                          <path d=\"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4a9.267 9.267 0 0 1 .64-1.539 6.7 6.7 0 0 1 .597-.933A7.025 7.025 0 0 0 2.255 4H4.09zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a6.958 6.958 0 0 0-.656 2.5h2.49zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5H4.847zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5H4.51zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12c.138.386.295.744.468 1.068.552 1.035 1.218 1.65 1.887 1.855V12H5.145zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11a13.652 13.652 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5H3.82zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855.173-.324.33-.682.468-1.068H8.5zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5a6.959 6.959 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5h2.49zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4a7.966 7.966 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4h2.355z\"/>\n                        </svg>                  \n                        <textarea \n                          class=\"input ml-1\"\n                          v-model=\"whatsapp_profile.websites[index_update]\" \n                          placeholder=\"Website URL\"\n                          id=\"business_website_url\"\n                          @keydown=\"expand_textbox('#business_website_url')\"                      \n                          ></textarea>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"22\" fill=\"currentColor\" class=\"bi bi-check2\" viewBox=\"0 0 16 16\"  @click=\"update_profile_details()\" style=\"cursor: pointer;top:1vh !important;right:0 !important;\n                          position: absolute;\"\n                        >\n                          <path d=\"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z\"/>\n                        </svg>\n                      </div>\n                    </div>\n                    <div class=\"webiste-vertical-details mb-3\">\n                      <div class=\"webiste-vertical d-flex\" style=\"\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\"  style=\"margin-right: 1rem;\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-tag-fill\" viewBox=\"0 0 16 16\">\n                          <path d=\"M2 1a1 1 0 0 0-1 1v4.586a1 1 0 0 0 .293.707l7 7a1 1 0 0 0 1.414 0l4.586-4.586a1 1 0 0 0 0-1.414l-7-7A1 1 0 0 0 6.586 1H2zm4 3.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\"/>\n                        </svg>\n                        <multiselect\n                          :options=\"vertical_types\"\n                          v-model=\"whatsapp_profile.vertical\"\n                          :searchable=\"false\"\n                          :allow-empty=\"false\"\n                          :show-labels=\"false\"\n                          :close-on-select=\"true\"\n                          placeholder=\"Pick a categories\"\n                          style=\"width: 80%;z-index:4000;\"\n                        >\n                        </multiselect>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"22\" fill=\"currentColor\" class=\"bi bi-check2\" viewBox=\"0 0 16 16\"  @click=\"update_profile_details()\" style=\"cursor: pointer;top:1vh !important;right:0 !important;\n                          position: absolute;\"\n                        >\n                          <path d=\"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z\"/>\n                        </svg>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"about-phone\" >\n                    <div class=\"mb-4\"><span class=\"abt-phone-title\">About and Phone Number</span></div>\n                    <div class=\"whts-app-status\">\n                      <div class=\"d-flex whts-status\" v-if=\"!edit_status\">\n                        <span v-if=\"whatsapp_profile.about == ''\">{{default_whatsapp_status}}</span>\n                        <span v-else>{{whatsapp_profile.about}}</span>\n                        <svg v-if=\"!edit_address && !edit_email && !edit_website && !edit_description\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil-fill\" viewBox=\"0 0 16 16\" @click=\"edit_status = true\"  style=\"cursor: pointer;\">\n                          <path d=\"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z\"/>\n                        </svg>\n                      </div>\n                      <div class=\"edit-status\" v-if=\"edit_status\">\n                        <textarea \n                          class=\"input\"\n                          v-model=\"whatsapp_profile.about\"\n                          id=\"whtsapp_status\"\n                          @keydown=\"expand_textbox('#whtsapp_status')\"  \n                        ></textarea>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"22\" fill=\"currentColor\" class=\"bi bi-check2\" viewBox=\"0 0 16 16\"  @click=\"update_profile_details()\" style=\"cursor: pointer;  top: 1.6vh;right: 15px;\n                          position: absolute;\"\n                        >\n                          <path d=\"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z\"/>\n                        </svg>\n                      </div>\n                    </div>\n                    <div class=\"whtsapp-no mt-3\">\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-telephone-fill\" viewBox=\"0 0 16 16\" style=\"color:#8696a0;\">\n                        <path fill-rule=\"evenodd\" d=\"M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z\"/>\n                      </svg>\n                      <span class=\"ml-3\">{{whatsapp_profile.whatsapp_phone_number}}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-sm-4 p-0\" v-show=\"is_contact_list\">\n            <!-- whatsapp all contacts -->\n            <div\n              style=\"border-right: 1px solid rgba(0,0,0,0.2);align-items: center; justify-content: space-between; height: 550px;\">\n              <div class=\"profile-top d-flex\">\n                <span style=\" margin:0 0 10px 17px;cursor: pointer;\" @click=\"show_all_contacts\"><svg\n                    xmlns=\"http://www.w3.org/2000/svg\" width=\"38\" height=\"22\" fill=\"currentColor\"\n                    class=\"bi bi-arrow-left left-arrow\" viewBox=\"0 0 16 16\">\n                    <path fill-rule=\"evenodd\"\n                      d=\"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z\" />\n                  </svg>\n                </span>\n                <span style=\"opacity:2;font-size:1.1rem;margin:0 0 8px 17px;\">New chat</span>\n                <span style=\"margin: 0 5px 8px auto;\">\n                  <button style=\"border: none; cursor: pointer;\" type=\"button\" data-container=\"body\" data-toggle=\"popover\" data-placement=\"right\" data-trigger=\"focus\">\n                    <i class=\"fa fa-question-circle\" ></i></button>\n                </span>\n\n              </div>\n              <div class=\"contacts-list pr-0\">\n                <div class=\"search-contact\">\n                  <div>\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" fill=\"currentColor\" class=\"bi bi-search\"\n                      viewBox=\"0 0 16 16\">\n                      <path\n                        d=\"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z\" />\n                    </svg>\n                    <input type=\"text\" placeholder=\"Search or start new chat\" v-model=\"search_in_contact_list\">\n                  </div>\n                </div>\n                <div class=\"all-contact-list\"  @scroll=\"new_contact_list\" >\n                  <ul v-if=\"all_contact_list.length>0\"\n                      id=\"all_contacts_scroll\" \n                  >\n                    <li class=\"d-flex\"\n                      style=\"cursor:pointer;\"\n                      @click=\"add_new_contact_modal()\"\n                      >\n                        <!-- <div style=\"width: 15%;\"><img src=\"/img/whatsapp-dp.png\" alt=\"\"\n                        class=\"user-profile-picture rounded-circle\">\n                        </div> -->\n                        <div class=\"user-name\">\n                          Add New Contact\n                          <!-- <span v-if=\"contact.profile_name\">{{ contact.profile_name }}</span>\n                          <span v-else>{{ contact.whatsapp_phone_number }}</span> -->\n                        </div>\n                    </li>\n                    <li v-for=\"(contact, index) in all_contact_list\" \n                    :key=\"index\"\n                    class=\"d-flex\"\n                    style=\"cursor:pointer;\"\n                    @click=\"get_history_data(contact.whatsapp_phone_number, contact.profile_name, 0,contact)\"\n                    >\n                      <div style=\"width: 15%;\"><img src=\"/img/whatsapp-dp.png\" alt=\"\"\n                      class=\"user-profile-picture rounded-circle\">\n                      </div>\n                      <div class=\"user-name\">\n                        <span>{{get_contact_display_name(contact)}}</span>\n                        <!-- <span v-if=\"contact.contact_name\">{{ contact.contact_name }}</span>\n                        <span v-else-if=\"contact.profile_name\">{{ contact.profile_name }}</span>\n                        <span v-else>{{ contact.whatsapp_phone_number }}</span> -->\n                      </div>\n                      <div class=\"contact-verified-status ml-auto\" :class=\"contact.verify_status\" :title=\"contact.verify_status\">\n                        &#x25CF;\n                      </div>\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-sm-8 p-0\" style=\"height: 600px; background-color: #f0f2f5 !important;\">\n            <div class=\"user-info-page\" v-show=\"history.length == 0 && !start_new_conv_data.start_new_conv\">\n              <div class=\"cense-whatsapp-image\" v-show=\"!show_spinner\">\n                  <img src=\"/img/cense_image.png\" alt=\"\" class=\"cense-image\">\n                  <img src=\"@/portal/assets/img/WhatsApp-Logo-PNG6.png\" alt=\"\" class=\"whats-app-image\">\n                  <h4>Whatsapp-Web powered by Cense AI</h4>\n                  <div class=\"contacts-legend-preview\">\n                    <h6>Legends for Contacts:</h6>\n                    <span style='color:#25af02;font-size: larger;'>&#x25CF;</span> <span>  This contact is on whatsapp</span> <br>\n                    <span style='color:#ff4747;font-size: larger;'>&#x25CF;</span> <span> This contact is not on whatsapp</span> <br>\n                    <span style='color:#ffc347;font-size: larger;'>&#x25CF;</span> <span> We don't know yet whether this contact is on whatsapp</span>\n                </div>\n              </div>\n            </div>\n            <div class=\"col-sm-12 d-flex\" v-if=\"history.length > 0\">\n              <img src=\"/img/whatsapp-dp.png\" alt=\"\" class=\"no-profile-image-conv rounded-circle my-2\" height=\"40px\" width=\"40px\">\n              <div>\n                <p v-if=\"customer_name != ''\" class=\"mt-3 ml-2 customer-name\">{{ customer_name }}</p>\n                <p v-else class=\"mt-3 ml-2\">{{ phoneno }}</p>\n              </div>\n              <div class=\"ml-auto mt-3 d-flex\">\n                <div>\n                  <label style=\"cursor:pointer;\">\n                    <input type=\"file\" hidden  name=\"send_attachment\" id=\"send_attachment\" :accept=\"file_extensions.all_allowed_file_extensions.toString()\" @change=\"process_attachment_file\" />\n                      <i class=\"fa fa-paperclip mr-2\" aria-hidden=\"true\"></i>\n                    <!-- Upload -->\n                  </label>\n\n                    <!-- <input type=\"file\" name=\"send_attachment\" id=\"send_attachment\" @change=\"process_attachment_file\"> -->\n                    <!-- </i> -->\n                </div>\n              <div class=\"dropdown\">\n                <button class=\"btn p-0\" type=\"button\" id=\"dropdownMenuButton\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                  <!-- <i class=\"fa fa-paperclip mr-2\" aria-hidden=\"true\"></i> -->\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" fill=\"currentColor\"\n                    class=\"bi bi-three-dots-vertical\" viewBox=\"0 0 16 16\">\n                    <path\n                      d=\"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\" />\n                  </svg>\n                </button>\n                <div class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuButton\">\n                  <a class=\"dropdown-item\" href=\"javascript:void(0);\" @click=\"open_send_template_to_user\">Send Template</a>\n                </div>\n              </div>\n                <!-- <span class=\"d-flex\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" fill=\"currentColor\"\n                    class=\"bi bi-three-dots-vertical\" viewBox=\"0 0 16 16\">\n                    <path\n                      d=\"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\" />\n                  </svg>\n                </span> -->\n              </div>\n            </div>\n            <div class=\"message-area\" v-if=\"history.length > 0 && send_attachment_detail.show_preview == false\"> \n              <div class=\"message-table-scroll\" id=\"scrolling-div-whatsapp\" @scroll=\"chatScrollMessages\">\n                <div v-if=\"scroll_spinner_chat\">\n                  <div class=\"lds-ring\">\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                  </div>\n                </div>\n                <div class=\"d-flex flex-column\" style=\"overflow: hidden; width: 100%\">\n                    <div v-for=\"(data, index) in history\" :key=\"index\">\n                      <div class=\"m-2\"\n                        style=\"text-align: center;\" \n                        v-if=\"![null,''].includes(data.bot_response_date) && check_previous_message_date_same(index)\">\n                        <span class=\"conversation-date\">{{ data.bot_response_date}}</span>\n                      </div>\n                      <div class=\"col-sm-12\" v-if=\"data.UserQuery!==''\">\n                        <td class=\"pt-2 pl-2 pb-0\">\n                          <p class=\"bg-white mb-0 shadow-sm text-black rounded user-msg\" style=\"word-break: break-all;\">{{ data.UserQuery }}</p>\n                          <span class=\"user-msg-flag\"><small></small></span>\n                          <p class=\"text-black user-msg-time pr-2\"><small>{{ formatUserQueryTime(data.UserQuery_DateTime) }}</small></p>\n                        </td>\n                      </div>\n                      <div v-if=\"data.BOTResponse.length > 0\">\n                        <div class=\"row justify-content-end\" v-if=\"data.BOTResponse[0].text\">\n                          <div class=\"col-auto\">\n                            <div class=\"col-sm\" style=\"padding-right: 25px;\">\n                              <div v-for=\"(texts, index) in data.BOTResponse\" :key=\"index\" class=\"mb-1\">\n                                <p class=\" mb-0 shadow-sm text-black pt-2 pr-2 pl-3 bot-resp-msg\" style=\"word-break: break-all;\">\n                                  {{ texts.text }}\n                                </p>\n                                <p class=\"text-black bot-resp-time pr-2\"><small>{{ formatUserQueryTime(data.Chat_Datetime) }}</small></p>\n                                <p class=\"bot-resp-msg-flag\"><small></small></p>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                        <div v-if=\"data.BOTResponse[0].products\">\n                          <div class=\"row justify-content-end\">\n                          <div class=\"col-4 bot-resp\">\n                          <div class=\"col-sm\" v-for=\"(product, index) in  product_variation(data.BOTResponse[0].products.products_list)\"\n                                :key=\"index\">\n                                \n                            <div class=\"cards\">\n                            <img class=\"cards-img\" v-if=\"product.img_url != null\" :src=\"check_image_type(product.img_url)\"/>\n                            <img class=\"cards-img\" v-else src=\"/img/blank_product_image.png\"\n                              alt=\"No Product Image\" />\n                            <div>\n                              <label class=\"mb-0\" style=\"line-height: 1.5;\">\n                                {{ product.title }}\n                              </label>\n                              <br>\n                              <label class=\"mb-0\" style=\"line-height: 1.5;\">\n                                {{ product.variation }}\n                              </label>\n                              <br>\n                              <label class=\"mb-0\" style=\"line-height: 1.5;\">\n                                {{ product.price }}\n                              </label>\n                            </div>\n                            <p class=\"text-black\" style=\"text-align: end !important; margin: 0;\">\n                              <small>{{ data.bot_response_time }}</small>\n                            </p>\n                          <!-- </div> -->\n                            </div>\n                            <div class=\"d-flex\" \n                              style=\"margin-top: 1px; max-width: 205px\">\n                              <div\n                                style=\"width: 100%\"\n                              >\n                                <div\n                                  class=\"preview-button-div\"\n                                  style=\"text-align: center;\"\n                                >\n                                  <a\n                                    class=\"preview-button\"\n                                    :href=\"product.url\"\n                                    target=\"_blank\"\n                                  >\n                                    <span color=\"#0b67aa\" class=\"\"\n                                    ><svg\n                                      xmlns=\"http://www.w3.org/2000/svg\"\n                                      width=\"17\"\n                                      height=\"17\"\n                                      viewBox=\"0 0 24 24\"\n                                      fill=\"none\"\n                                      stroke=\"#0b67aa\"\n                                      stroke-width=\"2\"\n                                      stroke-linecap=\"round\"\n                                      stroke-linejoin=\"round\"\n                                      class=\"mr-2\"\n                                    >\n                                      <path\n                                        d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"\n                                      ></path>\n                                      <polyline points=\"15 3 21 3 21 9\"></polyline>\n                                      <line\n                                        x1=\"10\"\n                                        y1=\"14\"\n                                        x2=\"21\"\n                                        y2=\"3\"\n                                      ></line></svg\n                                      >Buy Now\n                                    </span>\n                                  </a>\n                                </div>\n                              </div>\n                            </div>\n                            <p class=\"bot-resp-msg-flag-card\"><small></small></p>\n                          </div>\n                          </div>\n                          </div>\n                        </div>\n                        <div v-if=\"data.BOTResponse[0].card != undefined\">\n                          <div div class=\"row justify-content-end\">\n                          <div class=\"col-4 bot-resp\">\n                              <div class=\"col-sm carousel_cards\" style=\"\" v-for=\"(carousel, index) in data.BOTResponse[0].card\"\n                                :key=\"index\">\n                              <div class=\"cards\">\n                                <div class=\"carousel_card_single\">\n                                  <div v-if=\"carousel.image\">\n                                    <img class=\"cards-img\" :src=carousel.image alt=\"carousel Image\">\n                                  </div>\n                                  <div v-if=\"carousel.video\">\n                                    <iframe :src=\"carousel.video\" allowfullscreen allowtransparency\n                                      allow=\"autoplay\"></iframe>\n                                  </div>\n                                  <div class=\"pl-1\">\n                                    <p v-if=\"carousel.title\">{{ carousel.title }}</p>\n                                    <div>\n                                      <div v-if=\"carousel.text\">\n                                        <p>{{ carousel.text }}</p>\n                                      </div>\n                                    </div>\n                                  </div>\n                                  <p class=\"text-black\" style=\"text-align: end !important; margin: 0;\">\n                                    <small>{{ data.bot_response_time }}</small>\n                                  </p>\n                                </div>\n                              </div>\n                                <div v-for=\"(btn, indx) in carousel.buttons\" :key=\"indx\"\n                                        class=\"d-flex\" \n                                        style=\"margin-top: 1px; max-width: 205px\">\n                                  <div class=\"preview-button-div\" v-if=\"Boolean(btn.title) && Boolean(btn.value)\">\n                                    <a class=\"preview-button\" type=\"button\" @click=\"custom_button_click(btn, item)\" :key=\"index\">\n                                      {{ btn.title }}\n                                    </a>\n                                  </div>\n                                </div>\n                                <p class=\"bot-resp-msg-flag-card\"><small></small></p>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                        <div v-if=\"Boolean(data.BOTResponse[0].template)\">\n                          <div div class=\"row justify-content-end\">\n                          <div class=\"col-4 bot-resp\">\n                          <div class=\"col-sm\">\n                          <div class=\"cards\">\n                        <!-- <div\n                          v-for=\"(comp, name, index) in preview_template_data\"\n                          :key=\"index\"\n                        > -->\n                          <div v-if=\"Boolean(data.BOTResponse[0].template['HEADER'])\">\n                            <div v-if=\"data.BOTResponse[0].template['HEADER'].type == 'IMAGE'\">\n                              <img class=\"cards-img\" :src=\"data.BOTResponse[0].template['HEADER'].body\">\n                            </div>\n                            <div v-else>\n                                <p>{{data.BOTResponse[0].template['HEADER'].body}}</p>\n                            </div>\n                          </div>\n                          <div class=\"\" v-if=\"Boolean(data.BOTResponse[0].template['BODY'])\">\n                            <label v-if=\"data.BOTResponse[0].template['BODY'].type == 'text'\"\n                            style=\"line-height: 1.5;\">\n                              {{ data.BOTResponse[0].template['BODY'].body }}\n                            </label>\n                          </div>\n                          <div v-if=\"Boolean(data.BOTResponse[0].template['FOOTER'])\">\n                            <span \n                              v-if=\"data.BOTResponse[0].template['FOOTER'].type == 'text'\"\n                              style=\"font-size: 10px; line-height: 1.5; font-weight: 300;\">\n                              {{data.BOTResponse[0].template['FOOTER'].body}}\n                            </span>\n                          </div>\n                          <p class=\"text-black\" style=\"text-align: end !important; margin: 0;\">\n                            <small>{{ data.bot_response_time }}</small>\n                          </p>\n                        <!-- </div> -->\n                          </div>\n                          <div class=\"d-flex\" \n                            style=\"margin-top: 1px; max-width: 205px\" \n                            v-if=\"Boolean(data.BOTResponse[0].template['BUTTON'])\">\n                            <div\n                              v-for=\"(btn, index1) in data.BOTResponse[0].template['BUTTON'].body\"\n                              :key=\"index1\" style=\"width: 100%\"\n                            >\n                              <div\n                                v-if=\"btn['type'] === 'QUICK_REPLY'\"\n                                class=\"preview-button-div\"\n                                style=\"text-align: center;\"\n                                :style=\"btn['text'] == 'Yes' ? 'margin-right: 1px;' : ''\"\n                              >\n                                <a\n                                  class=\"preview-button\"\n                                >\n                                  <span color=\"rgba(11,103,170,1)\" class=\"\"\n                                    >{{ btn['text'] }}\n                                  </span>\n                                </a>\n                              </div>\n                              <div\n                                v-else-if=\"btn['type'] === 'URL'\"\n                                class=\"preview-button-div\"\n                                style=\"text-align: center;\"\n                              >\n                                <a\n                                  :href=\"btn.url\"\n                                  target=\"_blank\"\n                                  class=\"preview-button\"\n                                >\n                                  <span color=\"#0b67aa\" class=\"\"\n                                    ><svg\n                                      xmlns=\"http://www.w3.org/2000/svg\"\n                                      width=\"17\"\n                                      height=\"17\"\n                                      viewBox=\"0 0 24 24\"\n                                      fill=\"none\"\n                                      stroke=\"#0b67aa\"\n                                      stroke-width=\"2\"\n                                      stroke-linecap=\"round\"\n                                      stroke-linejoin=\"round\"\n                                      class=\"mr-2\"\n                                    >\n                                      <path\n                                        d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"\n                                      ></path>\n                                      <polyline points=\"15 3 21 3 21 9\"></polyline>\n                                      <line\n                                        x1=\"10\"\n                                        y1=\"14\"\n                                        x2=\"21\"\n                                        y2=\"3\"\n                                      ></line></svg\n                                    >{{ btn['text'] }}</span\n                                  >\n                                </a>\n                              </div>\n                            </div>\n                          </div>\n                          <p class=\"bot-resp-msg-flag-card\"><small></small></p>\n                          </div>\n                          </div>\n                          </div>\n                        </div>\n                        <div v-if=\"is_response_image(data.BOTResponse[0])\" class=\"pt-2 pl-2 pb-0\">\n                          <div v-if=\"typeof(data.BOTResponse[0].image) == 'string'\" >\n                            <div div class=\"row justify-content-end\">\n                              <div class=\"col-6 bot-resp\">\n                                <div class=\"col-sm carousel_cards\" style=\"\" >\n                                <div class=\"cards image-custom\">\n                                  <div class=\"carousel_card_single\" @click=\"show_image_fullscreen(data.BOTResponse[0].image)\" style=\"cursor:pointer;\">\n                                      <img class=\"cards-img\" :src=data.BOTResponse[0].image alt=\"carousel Image\">\n                                    <p class=\"text-black\" style=\"text-align: end !important; margin: 0;\">\n                                      <small>{{ formatUserQueryTime(data.Chat_Datetime) }}</small>\n                                    </p> \n                                  </div>\n                                </div>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n\n                          <div v-if=\"typeof(data.BOTResponse[0].image) == 'object'\">\n                            <div div class=\"row justify-content-end\">\n                              <div class=\"col-6 bot-resp\">\n                                <div class=\"col-sm carousel_cards\" style=\"\" >\n                                <div class=\"cards image-custom\">\n                                  <div class=\"carousel_card_single\" @click=\"show_image_fullscreen(data.BOTResponse[0].image.link)\" style=\"cursor:pointer;\">\n                                    <img class=\"cards-img\" :src=data.BOTResponse[0].image.link alt=\"carousel Image\">\n                                    <p class=\"text-black\" style=\"margin: 0;word-break: break-all;\" v-if=\"data.BOTResponse[0].image.caption\">\n                                     {{data.BOTResponse[0].image.caption}}\n                                    </p>\n                                    <p class=\"text-black\" style=\"text-align: end !important; margin: 0;\">\n                                      <small>{{ formatUserQueryTime(data.Chat_Datetime) }}</small>\n                                    </p> \n                                  </div>\n                                </div>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                        <div v-if=\"is_response_document(data.BOTResponse[0])\">\n                          <div v-if=\"typeof(data.BOTResponse[0].attachment) == 'object'\" class=\"\" style=\"margin-bottom: 1rem;\">\n                            <div div class=\"row justify-content-end\">\n                              <div class=\"col-6 bot-resp\">\n                                <div class=\"col-sm carousel_cards\" style=\"\" >\n                                  <div class=\"cards image-custom\">\n                                    <!-- {{data.BOTResponse[0].attachment.filename}} -->\n                                    <!-- <div class=\"carousel_card_single\" @click=\"show_image_fullscreen(data.BOTResponse[0].image)\" style=\"cursor:pointer;\">\n                                        <img class=\"cards-img\" :src=data.BOTResponse[0].image alt=\"carousel Image\">\n                                      <p class=\"text-black\" style=\"text-align: end !important; margin: 0;\">\n                                        <small>{{ data.bot_response_time }}</small>\n                                      </p> \n                                    </div> -->\n                                    <div class=\"carousel_cards\" style=\"\">\n                                      <div class=\"\">\n                                        <div class=\"carousel_card_single\">\n                                          <div>\n                                            <img style=\"filter: blur(2.2px);\" class=\"cards-img\" src=/img/pdf-placeholder-2.png alt=\"carousel Image\">\n                                          </div>\n                                          <!-- <div v-if=\"carousel.video\">\n                                            <iframe :src=\"carousel.video\" allowfullscreen allowtransparency\n                                              allow=\"autoplay\"></iframe>\n                                          </div> -->\n                                          <div class=\"pl-1\">\n                                            <p v-if=\"data.BOTResponse[0].attachment.filename\" class=\"d-flex\">\n                                              <i style=\"cursor: pointer;\" @click=\"show_image_fullscreen(data.BOTResponse[0].attachment.link)\" class=\"fa fa-2x pt-1 fa-arrow-circle-down\" aria-hidden=\"true\"></i>\n                                              <span class=\"ml-auto pt-1\"> {{data.BOTResponse[0].attachment.filename}}</span>\n                                            </p>\n                                            <!-- <div>\n                                              <div v-if=\"carousel.text\">\n                                                <p>{{ carousel.text }}</p>\n                                              </div>\n                                            </div> -->\n                                          </div>\n                                          <p class=\"text-black\" style=\"text-align: end !important; margin: 0;\">\n                                            <small>{{ formatUserQueryTime(data.Chat_Datetime) }}</small>\n                                          </p>\n                                        </div>\n                                      </div>\n                                        <!-- <div v-for=\"(btn, indx) in carousel.buttons\" :key=\"indx\"\n                                                class=\"d-flex\" \n                                                style=\"margin-top: 1px; max-width: 205px\">\n                                          <div class=\"preview-button-div\" v-if=\"Boolean(btn.title) && Boolean(btn.value)\">\n                                            <a class=\"preview-button\" type=\"button\" @click=\"custom_button_click(btn, item)\" :key=\"index\">\n                                              {{ btn.title }}\n                                            </a>\n                                          </div>\n                                        </div> -->\n                                        <p class=\"bot-resp-msg-flag-card\"><small></small></p>\n                                      </div>\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                        <div>\n                        </div>\n                      </div>\n                    </div>\n                </div>\n                <!-- <div class=\"d-flex\">\n                  <input disabled type=\"text\" placeholder=\"Type here to chat...\" class=\"form-control\" id=\"send_message_whatsapp\">\n                  <button\n                    class=\"btn\"\n                    type=\"button\"\n                    id=\"send_btn\"\n                    @click=\"send_message_to_user\"\n                  >\n                    <svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      id=\"send_button\"\n                      style=\"fill: #8a8a8a63\"\n                      width=\"40\"\n                      height=\"25\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\" />\n                      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                    </svg>\n                  </button>\n                </div> -->\n              </div>\n              <!-- <div v-else>\n                  <div class=\"text-center\">\n                    <h3 class=\"mt-3\">Welcome to Whatsapp Interface of Cense</h3>\n                    <h6>Please select a contact or start a new chat</h6>\n                  </div>\n                </div> -->\n            </div>\n            <div class=\"start-new-conv\" v-if=\"start_new_conv_data.start_new_conv\">\n              <div class=\"col-sm-12 d-flex\">\n                <img src=\"/img/whatsapp-dp.png\" alt=\"\" class=\"no-profile-image-conv rounded-circle my-2\" height=\"40px\" width=\"40px\">\n                <div>\n                  <p v-if=\"customer_name != ''\" class=\"mt-3 ml-2 customer-name\">{{ customer_name }}</p>\n                  <p v-else class=\"mt-3 ml-2\">{{ phoneno }}</p>\n                </div>\n              </div>\n               <div class=\"message-area\" > \n              <div class=\"message-table-scroll\" id=\"scrolling-div-whatsapp\" @scroll=\"chatScrollMessages\">\n              </div>\n              </div>\n\n              \n              <!-- <div class=\"user-info pb-2\">\n                <span class=\"w-25 d-flex\">\n                  <img src=\"/img/whatsapp-dp.png\" alt=\"\" class=\"profile-image rounded-circle\">\n                  <span>\n                    <p v-if=\"customer_name != ''\" class=\"mt-3 mb-0 pl-3 customer-name\">{{ customer_name }}</p>\n                    <p v-else class=\"mt-0 mb-1\">{{ phoneno }}</p>\n                  </span>\n                </span>\n                <span class=\"w-75\">\n                  <span class=\"float-right d-flex w-25\"\n                    style=\"align-items: center;padding-left:3rem;justify-content: space-around;margin-top: 5px;\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" fill=\"currentColor\"\n                      class=\"bi bi-three-dots-vertical mr-4\" viewBox=\"0 0 16 16\">\n                      <path\n                        d=\"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\" />\n                    </svg>\n                  </span>\n                </span>\n              </div> -->\n            </div>\n            <div class=\"document-preview\" v-show=\"send_attachment_detail.show_preview == true && file_extensions.image_file_extensions.includes(send_attachment_detail.media_content_type)\">\n              <div class=\"image-preview-container\">\n               <div id=\"img-preview\"></div>\n              </div>  \n            </div>\n             <div class=\"document-preview\" v-show=\"send_attachment_detail.show_preview == true && file_extensions.document_file_extensions.includes(send_attachment_detail.media_content_type)\">\n              <div class=\"document-preview-container\">\n               <!-- <div id=\"img-preview\"></div> -->\n               <!-- <div style=\"height:500px;display: flex;\" v-if=\"send_attachment_detail.media_content_type == 'application/pdf'\"> -->\n               <div style=\"height:500px;\">\n                   <span aria-hidden=\"true\" style=\"font-size: 2rem;color: aliceblue;\">&times;</span>\n                  <div class=\"d-flex\">                \n                    <img style=\"max-height: 300px;text-align: center;margin-left: auto;margin-right: auto;\" src=\"/img/document-placeholder-1.png\" alt=\"\">\n                  </div>\n                  <p class=\"text-center pt-4\">{{send_attachment_detail.media_file_name}}</p>\n               </div>\n\n              </div>  \n            </div>\n            <div style=\"width:100%\" class=\"send-message-to-user d-flex\" v-if=\"show_send_message && !start_new_conv_data.start_new_conv\">\n              <input type=\"text\" ref=\"message_sending_textbox\" style=\"padding: 21px !important;\" class=\"form-control\" :disabled=\"!contact_list[current_contact_index].is_message_sending_enabled\"\n                :placeholder=\"message_text_box_placeholder\" v-model=\"message_to_send\" @keypress.enter=\"send_message_to_user\">\n              <button class=\"btn\" type=\"button\" id=\"send_btn\" @click=\"send_message_to_user\" v-if=\"contact_list[current_contact_index].is_message_sending_enabled\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" id=\"send_button\" style=\"fill: #8a8a8a63\" width=\"40\" height=\"25\"\n                  viewBox=\"0 0 24 24\">\n                  <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\" />\n                  <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                </svg>\n              </button>\n              <a href=\"javascript:void(0);\" id=\"enable-message-sending\" @click=\"enable_sending_messages_for_user\" v-if=\"!contact_list[current_contact_index].is_message_sending_enabled\">Enable Message Sending</a>\n            </div>\n            <div style=\"width:100%\" class=\"send-message-to-user d-flex\" v-if=\"show_send_message && start_new_conv_data.start_new_conv\" >\n              <input type=\"text\" ref=\"message_sending_textbox\" style=\"padding: 21px !important;\" class=\"form-control\" :disabled=\"!start_new_conv_data.is_message_sending_enabled\"\n                :placeholder=\"message_text_box_placeholder\" v-model=\"message_to_send\" @keypress.enter=\"send_message_to_user\">\n              <button class=\"btn\" type=\"button\" id=\"send_btn\" @click=\"send_message_to_user\" v-if=\"start_new_conv_data.is_message_sending_enabled\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" id=\"send_button\" style=\"fill: #8a8a8a63\" width=\"40\" height=\"25\"\n                  viewBox=\"0 0 24 24\">\n                  <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\" />\n                  <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                </svg>\n              </button>\n              <a href=\"javascript:void(0);\" id=\"enable-message-sending\" @click=\"enable_sending_messages_for_user\" v-if=\"!start_new_conv_data.is_message_sending_enabled\">Enable Message Sending</a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      id=\"showImageModal\"\n      class=\"modal fade dash-modal\"\n      role=\"dialog\"\n    >\n      <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">\n          <span aria-hidden=\"true\" style=\"font-size: 2rem;color: aliceblue;\">&times;</span>\n        </button>\n        <img :src=\"current_fullscreen_image_src\" >\n        <!-- <iframe :src=\"current_fullscreen_image_src\" frameborder=\"0\"></iframe> -->\n        </div>\n      </div>\n    </div>\n    <div\n      id=\"addContactModal\"\n      class=\"modal fade dash-modal\"\n      role=\"dialog\"\n    >\n      <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n        <div class=\"modal-head d-flex align-items-center m-2\">\n          <div class=\"head-icn\">\n            <img src=\"/img/msg-blue.png\" alt />\n          </div>\n          <h3>Add Contact</h3>\n          <button type=\"button\" class=\"close\" data-dismiss=\"modal\" style=\"top: initial;\">\n            <img src=\"/img/close-icn.png\" alt />\n          </button>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <label>Number</label>\n            <!-- <input\n              type=\"text\"\n              v-model.trim=\"add_new_contact.phone_number\"\n              class=\"form-control\"\n              placeholder=\"Enter Phone Number\"\n              id=\"phone_number\"\n            /> -->\n            <vue-phone-number-input\n              v-model=\"add_new_contact.formattedNumber\"\n              :no-use-browser-locale=\"true\"\n              color=\"#53b9d0\"\n              valid-color=\"#ccc\"\n              @update=\"add_new_contact.phone_number = $event.formattedNumber\"\n            >\n            </vue-phone-number-input>\n            <label>Name</label>\n            <input\n              type=\"text\"\n              v-model.trim=\"add_new_contact.contact_name\"\n              class=\"form-control\"\n              placeholder=\"Enter Contact Name\"\n              id=\"contact_name\"\n            />\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <div class=\"mr-auto\" @click=\"open_import_from_csv_modal\" style=\"cursor:pointer;\">\n            <i class=\"fa fa-paperclip mr-2\" aria-hidden=\"true\"></i> Import from CSV File\n          </div>\n            <div class=\"btn-wrap card-act text-right mt-0 py-0 border-top-0\">\n              <button\n                type=\"button\"\n                class=\"btn btn-link\"\n                data-dismiss=\"modal\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                class=\"darkblue-btn\"\n                id=\"res_n_int_save\"\n              >\n                Save\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      id=\"sendTemplateModal\"\n      class=\"modal fade dash-modal\"\n      role=\"dialog\"\n    >\n      <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n        <div class=\"modal-head d-flex align-items-center m-2\">\n          <div class=\"head-icn\">\n            <img src=\"/img/msg-blue.png\" alt />\n          </div>\n          <h3>Send Template</h3>\n          <button type=\"button\" class=\"close\" data-dismiss=\"modal\" style=\"top: initial;\">\n            <img src=\"/img/close-icn.png\" alt />\n          </button>\n        </div>\n        <div class=\"modal-body\">\n          <div>\n            <h6> Select Template:</h6>\n            <!-- <div class=\"d-flex\"> -->\n              <table class=\"table\" style=\"overflow-y: auto\">\n                <tr\n                  v-for=\"(template, index) in whatsapp_templates.templates_list\"\n                  :key=\"index\"\n                >\n                  <td scope=\"row\" style=\"border:none; padding:0.25rem;\">\n                    <div class=\"form-check\">\n                      <input  type=\"radio\" name=\"dsdf\" id=\"indexab\" :value=\"template.template_id\" v-model=\"whatsapp_templates.selected_template\">\n                     <label for=\"\" class=\"ml-3\"> {{ template.template_name }}</label>\n                    </div>\n                  </td>\n                </tr>\n              </table>\n              <!-- <div>\n                <div\n                      v-if=\"Boolean(whatsapp_templates.preview_template_data)\"\n                      class=\"cards\"\n                      style=\"width: 50%; margin: 0 auto\"\n                    >\n                      <div v-if=\"Boolean(whatsapp_templates.preview_template_data['HEADER'])\">\n                        <div\n                          v-if=\"whatsapp_templates.preview_template_data['HEADER'].type == 'IMAGE'\"\n                        >\n                          <img\n                            :src=\"preview_template_data['HEADER'].body\"\n                            width=\"100%\"\n                          />\n                        </div>\n                        <div v-else>\n                          <p>{{ whatsapp_templates.preview_template_data[\"HEADER\"].body }}</p>\n                        </div>\n                      </div>\n                      <div\n                        class=\"mt-4\"\n                        v-if=\"Boolean(whatsapp_templates.preview_template_data['BODY'])\"\n                      >\n                        <label\n                          v-if=\"whatsapp_templates.preview_template_data['BODY'].type == 'text'\"\n                          style=\"line-height: 1.5\"\n                        >\n                          {{ whatsapp_templates.preview_template_data[\"BODY\"].body }}\n                        </label>\n                      </div>\n                      <div v-if=\"Boolean(whatsapp_templates.preview_template_data['FOOTER'])\">\n                        <span\n                          v-if=\"whatsapp_templates.preview_template_data['FOOTER'].type == 'text'\"\n                          style=\"\n                            font-size: 10px;\n                            line-height: 1.5;\n                            font-weight: 300;\n                          \"\n                        >\n                          {{ whatsapp_templates.preview_template_data[\"FOOTER\"].body }}\n                        </span>\n                      </div>\n                    </div>\n                    <div\n                      v-if=\"\n                        Boolean(whatsapp_templates.preview_template_data) &&\n                        Boolean(whatsapp_templates.preview_template_data['BUTTON'])\n                      \"\n                    >\n                      <div\n                        v-for=\"(btn, index1) in whatsapp_templates.preview_template_data['BUTTON']\n                          .body\"\n                        :key=\"index1\"\n                      >\n                        <div\n                          v-if=\"btn['type'] === 'QUICK_REPLY'\"\n                          class=\"preview-button-div\"\n                          style=\"width: 50%; margin: 0 auto\"\n                        >\n                          <button\n                            color=\"rgba(11,103,170,1)\"\n                            class=\"btn preview-button\"\n                          >\n                            <span color=\"rgba(11,103,170,1)\" class=\"\"\n                              >{{ btn[\"text\"] }}\n                            </span>\n                          </button>\n                        </div>\n                        <div\n                          v-else-if=\"btn['type'] === 'URL'\"\n                          class=\"preview-button-div\"\n                          style=\"width: 50%; margin: 0 auto\"\n                        >\n                          <a\n                            :href=\"btn.url\"\n                            target=\"_blank\"\n                            class=\"btn preview-button\"\n                          >\n                            <span color=\"#0b67aa\" class=\"\"\n                              ><svg\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                width=\"17\"\n                                height=\"17\"\n                                viewBox=\"0 0 24 24\"\n                                fill=\"none\"\n                                stroke=\"#0b67aa\"\n                                stroke-width=\"2\"\n                                stroke-linecap=\"round\"\n                                stroke-linejoin=\"round\"\n                                class=\"mr-2\"\n                              >\n                                <path\n                                  d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"\n                                ></path>\n                                <polyline points=\"15 3 21 3 21 9\"></polyline>\n                                <line\n                                  x1=\"10\"\n                                  y1=\"14\"\n                                  x2=\"21\"\n                                  y2=\"3\"\n                                ></line></svg\n                              >{{ btn[\"text\"] }}</span\n                            >\n                          </a>\n                        </div>\n                      </div>\n                    </div>\n              </div> -->\n              <!-- </div> -->\n            <div class=\"modal-footer\">\n              <div class=\"btn-wrap card-act text-right mt-0 py-0 border-top-0\">\n                <button\n                  type=\"button\"\n                  class=\"btn btn-link\"\n                  data-dismiss=\"modal\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  class=\"darkblue-btn\"\n                  id=\"res_n_int_save\"\n                  @click=\"send_template_to_customer()\"\n                >\n                  Send\n                </button>\n              </div>\n           </div>\n          </div>\n        </div>\n        </div>\n      </div>\n    </div>\n    <div\n      id=\"importContactCSVModal\"\n      class=\"modal fade dash-modal\"\n      role=\"dialog\"\n    >\n      <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n        <div class=\"modal-head d-flex align-items-center m-2\">\n          <div class=\"head-icn\">\n            <img src=\"/img/msg-blue.png\" alt />\n          </div>\n          <h3>Import Contacts from CSV</h3>\n          <button type=\"button\" class=\"close\" data-dismiss=\"modal\" style=\"top: initial;\">\n            <img src=\"/img/close-icn.png\" alt />\n          </button>\n        </div>\n        <div class=\"modal-body\">\n          <div>\n            <form @submit.prevent=\"file_submit_upload_contacts\">\n              <div class=\"form-group\">\n                <div class=\"custom-file\">\n                  <input\n                    type=\"file\"\n                    accept=\".csv\"\n                    class=\"custom-file-input\"\n                    @change=\"file_input_contacts_csv\"\n                    id=\"inputGroupUploadFilecsv\"\n                    aria-describedby=\"inputGroupFileAddoncsv\"\n                  />\n                  <label\n                    style=\"font-weight: 400; line-height: 15px\"\n                    class=\"custom-file-label form-control\"\n                    for=\"file\"\n                    >{{contact_csv.file_label}}</label\n                  >\n                </div>\n                <!-- <p class=\"mt-2\" style=\"color: #fa0000; font-size: 0.85rem\">\n                  * Please Note that only Responses with only Text Response can\n                  be added via CSV, API Endpoints and Responses with Image need\n                  to be added from the portal.\n                </p> -->\n              </div>\n              <div class=\"btn-wrap text-right\">\n                <a href=\"javascript:void(0)\" @click=\"download_sample_contact_file\">\n                  Download Sample CSV File\n                  <!-- <i\n                    class=\"fa fa-spinner fa-spin\"\n                  ></i> -->\n                </a>\n                <button\n                  type=\"button\"\n                  class=\"btn btn-link\"\n                  @click=\"empty_upload_csv_contacts\"\n                  data-dismiss=\"modal\"\n                >\n                  Cancel\n                </button>\n                <button type=\"submit\" class=\"darkblue-btn\">Submit</button>\n              </div>\n            </form>\n              \n            <!-- <div class=\"modal-footer\">\n              <div class=\"btn-wrap card-act text-right mt-0 py-0 border-top-0\">\n                <button\n                  type=\"button\"\n                  class=\"btn btn-link\"\n                  data-dismiss=\"modal\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  class=\"darkblue-btn\"\n                  id=\"res_n_int_save\"\n                  @click=\"send_template_to_customer()\"\n                >\n                  Send\n                </button>\n              </div>\n           </div> -->\n          </div>\n        </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport api_calls from \"@/portal/api_calls\";\nimport { Socket, Presence } from \"phoenix\";\nimport moment from 'moment';\nimport Swal from \"sweetalert2\";\nimport Multiselect from \"vue-multiselect\";\nimport VuePhoneNumberInput from \"vue-phone-number-input\";\nimport swal from 'sweetalert2';\nexport default {\n  name: \"WhatsappChat\",\n  components: {\n    Multiselect,\n    VuePhoneNumberInput\n  },\n  data() {\n    return {\n      show_spinner: false,\n      history: [],\n      contact_list: [],\n      phoneno: null,\n      customer_name: \"\",\n      chat_details: [],\n      search_value: \"\",\n      company_id: this.$session.get(\"UserInformation\").company_id,\n      company_name:this.$session.get(\"UserInformation\").company_name, \n      session_token: this.$session.get(\"UserInformation\").tokens,\n      initial_message_load: false,\n      is_profile_setup: false,\n      message_pagination: {\n        is_scroll_up: false,\n        per_page: 5,\n        page_no: 1,\n        total_records: 10,\n        page_record_fetched: []\n      },\n      is_paginated_call: false,\n      default_whatsapp_status: 'Hey there! I am using whatsapp',\n      edit_status: false,\n      scroll_spinner_chat: false,\n      show_send_message: false,\n      is_message_sending_enabled: false,\n      is_show_message_disabled: true,\n      whatsapp_profile : '',\n      edit_email: false,\n      edit_address: false,\n      edit_description: false,\n      edit_website: false,\n      email_address: '',\n      business_address: '',\n      description : '',\n      website_url : '',\n      whatsapp_phone_number: null,\n      channel: null,\n      chat_socket: null,\n      support_channel: null,\n      message_to_send: null,\n      whatsapp_status : '',\n      index_update:null,\n      second_website :false,\n      selected_files :'',\n      mouse_hover_text : false,\n      vertical_types : ['Automotive','Beauty', 'Spa and Salon','Clothing and Apparel','Education',\n              'Entertainment','Event Planning and Service','Finance and Banking','Food and Grocery'\n              ,'Public Service','Hotel and Lodging','Medical and Health','Non-profit',\n              'Professional Services','Shopping and Retail','Travel and Transportation','Restaurant','Other'],\n      current_contact_number: null,\n      is_contact_list : false,\n      current_contact_index: null,\n      search_in_contact_list: '',\n      all_contact_list : [],\n      start_new_conv_data : {\n        start_new_conv: false,\n        is_message_sending_enabled: false\n      },\n      all_contact_pagination:{\n        per_page: 10,\n        page_no: 1,\n        total_records: 10,\n      },\n      send_attachment_detail: {\n        media_file_name: null,\n        media_file: null,\n        show_preview: false,\n        media_content_type: null,\n        media_type: null,\n        send_media: true,\n        document_content: null,\n        media_caption: null\n      },\n      current_fullscreen_image_src: null,\n      add_new_contact: {\n        phone_number: null,\n        is_add_contact: true,\n        contact_name: null,\n        formattedNumber: null\n      },\n      add_new_contact_formatted_phone_number: null,\n      file_extensions: {\n        all_allowed_file_extensions: [\"image/png\",\"image/jpeg\", \"application/pdf\", \"text/plain\", \"application/vnd.ms-excel\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", \n                                      \"application/vnd.ms-powerpoint\", \"application/msword\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", \"text/csv\"],\n        image_file_extensions: [\"image/png\", \"image/jpeg\"],\n        document_file_extensions: [\"application/pdf\", \"text/plain\", \"application/vnd.ms-excel\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", \n                                    \"application/vnd.ms-powerpoint\", \"application/msword\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", \"text/csv\"]\n      },\n      whatsapp_templates: {\n        templates_list: [],\n        pagination_data: {\n          per_page: 10,\n          page_no: 1,\n          total_records: 10,\n        },\n        selected_template: null,\n        preview_template_data: null\n      },\n      contact_csv: {\n        file_label: 'Choose File',\n        file_content: null,\n        file_selected: false\n      }\n    };\n  },\n  computed: {\n    total_pages_loaded() {\n      if ((this.message_pagination.page_no * this.message_pagination.per_page) >= this.message_pagination.total_records) {\n        return true;\n      }\n      return false;\n    },\n    message_text_box_placeholder() {\n      return \"Send a message to user\"\n    },\n    total_contact_loaded(){\n      if ((this.all_contact_pagination.page_no * this.all_contact_pagination.per_page) >= this.all_contact_pagination.total_records) {\n        return true;\n      }\n      return false;\n    }\n  },\n  mounted() {\n    this.get_contact_list(true);\n    this.get_profile_details();\n    const vm = this;\n    $(window).bind('mousewheel', function (event) {\n      if (event.originalEvent.wheelDelta >= 0) {\n        vm.message_pagination.is_scroll_up = true;\n      }\n      else {\n        vm.message_pagination.is_scroll_up = false;\n      }\n    });\n    // var lastScrollTop = 0;\n    // document.addEventListener(\n    //   \"scroll\",\n    //   function (ev) {\n    //     if (ev.target.id === \"scrolling-div-whatsapp\") {\n    //       console.log(ev)\n    //       var st = window.pageYOffset || document.documentElement.scrollTop; // Credits: \"https://github.com/qeremy/so/blob/master/so.dom.js#L426\"\n    //       if (st > lastScrollTop){\n    //         vm.message_pagination.is_scroll_up = false;\n    //       } else {\n    //         console.log(\"Scrolling Up\")\n    //         vm.message_pagination.is_scroll_up = true;\n    //       }\n    //       lastScrollTop = st <= 0 ? 0 : st;\n\n    //       // vm.scrollPosition = ev.target[\"scrollTop\"];\n    //     }\n    //   },\n    //   true\n    // );\n    $(\"#showImageModal\").on(\"hidden.bs.modal\", function (e) {\n        vm.current_fullscreen_image_src = null;\n    });\n    $(\"#importContactCSVModal\").on(\"hidden.bs.modal\", function (e) {\n        vm.empty_upload_csv_contacts();\n    });\n    $('[data-toggle=\"popover\"]').popover({\n      html: true,\n      title: \"Legend for Contacts\",\n      content: `<span style='color:#25af02;font-size: larger;'>&#x25CF;</span> <span>  This contact is on whatsapp</span> <br>\n                <span style='color:#ff4747;font-size: larger;'>&#x25CF;</span> <span> This contact is not on whatsapp</span> <br>\n                <span style='color:#ffc347;font-size: larger;'>&#x25CF;</span> <span> We don't know yet whether this contact is on whatsapp</span>`\n    });\n    axios.post(api_calls.initialize_whatsapp_topic(), \n    {\n      company_id: this.company_id,\n      whatsapp_phone_number: \"100\",\n      test: btoa(\"test_paramater\")\n    }).then((response) => {\n      // console.log(response)\n      // this.chat_group_name = response.data.chat_group_name;\n      // this.live_chat_token = response.data.token;\n      // this.live_chat_on = true;\n      this.chat_socket = new Socket(\n        process.env.VUE_APP_LIVE_CHAT_WEBSOCKET_ENDPOINT,\n        {\n          params: {\n            whatsapp: \"true\",\n            elixir_token : response.data.elixir_token,\n            token: this.session_token,\n            username: this.$session.get(\"UserInformation\").email\n          },\n        }\n      );\n      this.chat_socket.connect();\n      this.channel = this.chat_socket.channel(\n        \"whatsapp:\" + this.company_id\n      );\n      this.channel.join();\n      this.channel.on(\"new_whatsapp_message\", (res) => {\n        if(res.company_id === this.company_id){\n          // console.log(res)\n          let contact_index = this.contact_list.findIndex((item) => {return item.whatsapp_phone_number === res.whatsapp_phone_number});\n          // console.log(res, \"else\", contact_index)\n          if (contact_index != -1){\n            this.contact_list[contact_index].last_bot_response.text = res.whatsapp_message;\n            this.contact_list[contact_index].is_new_notification = true;\n            this.contact_list[contact_index].new_message_count = 1;\n            this.contact_list = this.array_move(this.contact_list, contact_index, 0);\n            // this.current_contact_index\n          }\n          if(this.check_current_number(res)){ \n            let current_timestamp = new Date(),\n            current_date = moment().format('YYYY-MM-DD');\n            this.history.push(\n            {\n              \"BOTResponse\": [],\n              \"UserQuery\": res.whatsapp_message,\n              \"bot_response_date\": current_date, \n              \"bot_response_time\": current_timestamp, \n              \"user_query_date\": current_date,\n              \"user_query_time\": current_timestamp,\n              \"UserQuery_DateTime\": current_timestamp.toISOString()\n            }\n          );\n          } else {\n            // let contact_index = this.contact_list.findIndex((item) => {return item.whatsapp_phone_number === res.whatsapp_phone_number});\n            // console.log(res, \"else\", contact_index)\n            // if (contact_index != -1){\n            //   this.contact_list = this.array_move(this.contact_list, contact_index, 0);\n            // }\n          }\n          this.scroll_down();\n        }\n      })\n    })\n  },\n  watch: {\n    search_value(newValue) {\n      if (newValue != \"\" && newValue.length > 2)  {\n        axios\n          .post(\n            api_calls.whatsapp_chat(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_search: true,\n              search_string: newValue,\n              is_get_contacts: true\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            if ((response.data == \"No contacts found\") || (response.data == \"Data not found\")) {\n              this.contact_list = [];\n            }else{\n              this.contact_list = response.data.contacts;\n            }\n          })\n          .catch((e) => {\n            this.show_spinner = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      } else {\n        this.get_contact_list(false);\n      }\n    },\n    search_in_contact_list(newValue){\n      if (newValue != \"\" && newValue.length > 2)  {\n        axios\n          .post(\n            api_calls.whatsapp_chat(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_search: true,\n              search_string: newValue,\n              is_get_all_contacts: true\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            // console.log(response);\n            if (response.data == \"No contacts found\") {\n              this.all_contact_list = [];\n            }else{\n              this.all_contact_list = response.data.contacts;\n            }\n          })\n          .catch((e) => {\n            this.show_spinner = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      } else {\n        this.get_all_contact_list();\n      }\n    },\n    'whatsapp_templates.selected_template': {\n      handler: function (newVal, oldVal){\n        console.log(newVal);\n        var current_template = this.whatsapp_templates.templates_list.find((item) => item.template_id == newVal);\n        var template_id = newVal;\n        var variable_dict = current_template.variable_dict;\n        var is_parent_template = false;\n        axios\n          .post(\n            api_calls.whatsapp_template(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_notification: false,\n              is_preview: true,\n              is_parent_template: is_parent_template,\n              template_id: template_id,\n              variable_dict: variable_dict,\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            if (response.data.status == \"Success\") {\n              this.whatsapp_templates.preview_template_data = response.data.body;\n            }\n          })\n          .catch((e) => {\n            console.log(e)\n          })\n      },\n      deep: true\n    }\n  },\n  methods: {\n    empty_variable() {\n      (this.history = []), (this.phoneno = null);\n      this.customer_name = \"\";\n      this.chat_details = [];\n      this.message_pagination.per_page = 5;\n      this.message_pagination.page_no = 1;\n      this.message_pagination.total_records = 10;\n      this.message_pagination.page_record_fetched = [];\n      this.message_to_send = null;\n      this.current_contact_index = null;\n      this.all_contact_pagination.per_page = 10;\n      this.all_contact_pagination.page_no = 1;\n      this.all_contact_pagination.total_records = 10;\n      this.send_attachment_detail = {\n        media_file_name: null,\n        media_file: null,\n        show_preview: false,\n        media_content_type: null,\n        media_type: null,\n        send_media: true,\n        document_content: null,\n        media_caption: null\n      }\n    },\n    get_history_data(whatsapp_no, user_name, contact_index, contact) {\n      this.empty_variable();\n      this.show_spinner = true;\n      this.customer_name = user_name;\n      this.current_contact_number = whatsapp_no;\n      this.show_send_message = false;\n      this.current_contact_index = contact_index;\n      this.start_new_conv_data.start_new_conv = false;\n      axios\n        .post(\n          api_calls.whatsapp_chat(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            get_by_whatsapp_phone_number: true,\n            whatsapp_phone_number: whatsapp_no,\n            per_page: this.message_pagination.per_page,\n            page_no: 1,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.show_send_message = true;\n          this.show_spinner = false;\n          if (response.data != null) {\n            if (response.data == \"Data not found\") {\n              this.start_new_conv_data.start_new_conv = true;\n              this.new_conv_contact_data = contact;\n            } else{\n            this.history = this.format_history_response(response.data.chat_history);\n            this.phoneno = response.data.whatsapp_phone_number || whatsapp_no;\n            // console.log(this.phoneno, this.contact_list);\n            let contact_list_index = this.contact_list.findIndex(item => item.whatsapp_phone_number == this.phoneno);\n            if(contact_list_index >= 1){\n              // this.contact_list = this.array_move(this.contact_list, contact_list_index, 0);\n              this.current_contact_index =contact_list_index;\n              this.current_contact_number = this.phoneno;\n              // this.contact_list[contact_list_index].is_message_sending_enabled = false;\n            }\n            this.message_pagination.total_records = response.data.total_chat_history;\n            setTimeout(() => {\n              this.scroll_down();\n              this.initial_message_load = true;\n              this.message_pagination.is_scroll_up = true;\n              this.chatScrollMessages(true);\n            }, 400);\n            }\n          }\n        })\n        .catch((e) => {\n          this.show_spinner = false;\n          console.log(e);\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    get_contact_list(enable_bot_responses) {\n      this.show_spinner = true;\n      axios\n        .post(\n          api_calls.whatsapp_chat(),\n          {\n            is_get_contacts: true,\n            company_id: this.company_id,\n            company_name: this.company_name,\n            enable_bot_response_all: enable_bot_responses\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          if ((response.data == \"No contacts found\") || (response.data == \"Data not found\")) {\n            this.contact_list = [];\n          } else{\n            this.contact_list = response.data.contacts;\n          }\n          this.show_spinner = false;\n          // this.contact_list = response.data.contacts;\n        })\n        .catch((e) => {\n          this.show_spinner = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    scroll_down() {\n      var container = document.querySelector(\".message-table-scroll\");\n      // console.log(container);\n      if (Boolean(container)) {\n        setTimeout(() => {\n          container.scrollTop = container.scrollHeight;\n        }, 100)\n        // this.initial_message_load = true;\n      }\n    },\n    scroll_down_effect() {\n      var container = document.querySelector(\".message-table-scroll\");\n      // console.log(container);\n      if (Boolean(container)) {\n        setTimeout(() => {\n          container.scrollTop = 10;\n        }, 0)\n        // this.initial_message_load = true;\n      }\n    },\n    product_variation(products_list) {\n      let new_product_list = [];\n      for (let i in products_list) {\n        let components = products_list[i].template.components;\n        let temp = {};\n        for (let j in components) {\n          if (j == 0) {\n            temp[\"img_url\"] = components[j].parameters[0].image.link;\n          }\n          if (j == 1) {\n            temp[\"title\"] = components[j].parameters[0].text;\n            temp[\"variation\"] = components[j].parameters[1].text;\n            temp[\"price\"] = components[j].parameters[2].text;\n          }\n          if (j == 2) {\n            temp[\"url\"] = components[j].parameters[0].text;\n            temp[\"type\"] = components[j].parameters.type;\n          }\n        }\n        new_product_list.push(temp);\n      }\n      return new_product_list;\n    },\n    check_image_type(image) {\n      if (typeof image == \"string\") {\n        return image;\n      } else {\n        if (image != null) {\n          return image.src;\n        } else {\n          return \"\";\n        }\n      }\n    },\n    trim_card_description(text) {\n      if (Boolean(text)){\n        if (text.length > 100) {\n          let string_text = text.substring(0, 80) + \"...\";\n          return string_text;\n        }\n        return text;\n      }\n    },\n    latest_bot_text(text) {\n      if(text === null){\n        return \"Custom Bot Response\"\n      }\n      if (text.length > 35) {\n        return `${text.substring(0, 35)}...`;\n      }\n      return text;\n    },\n    search_contact_list() {\n      if (this.search_value == \"\") {\n        return this.contact_list;\n      } else {\n        let new_val = this.search_value;\n        if (new_val != this.search_value) {\n          // console.log(this.search_value);\n          axios\n            .post(\n              api_calls.whatsapp_chat(),\n              {\n                company_id: this.company_id,\n                company_name: this.company_name,\n                is_get_all_contacts: true,\n                is_search: true,\n                search_string: this.search_value,\n              },\n              {\n                headers: {\n                  Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                },\n              }\n            )\n            .then((response) => {\n              this.show_spinner = false;\n              this.contact_list = response.data.contacts;\n            })\n            .catch((e) => {\n              this.show_spinner = false;\n              if (\n                e.response.status === 410 ||\n                e.response.status === 440 ||\n                e.response.status === 409\n              ) {\n                this.$root.$emit(\"Session_Expired\", e.response.data);\n              }\n            });\n        }\n        return this.contact_list;\n      }\n    },\n    chatScrollMessages(scroll_down) {\n      // console.log(this.initial_message_load);\n      if (this.initial_message_load === true) {\n        let container_div_scroll_top = document.getElementsByClassName(\n          \"message-table-scroll\"\n        )[0].scrollTop;\n        if (container_div_scroll_top < 50 && this.message_pagination.is_scroll_up === true && !this.is_paginated_call && !this.total_pages_loaded) {\n          // console.log(\"api call paginated\")\n          this.is_paginated_call = true;\n          this.scroll_spinner_chat = true;\n          axios\n            .post(\n              api_calls.whatsapp_chat(),\n              {\n                company_id: this.company_id,\n                company_name: this.company_name,\n                get_by_whatsapp_phone_number: true,\n                whatsapp_phone_number: this.current_contact_number,\n                per_page: this.message_pagination.per_page,\n                page_no: this.message_pagination.page_no + 1,\n              },\n              {\n                headers: {\n                  Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                },\n              }\n            )\n            .then((response) => {\n              // console.log(response.data);\n              this.scroll_spinner_chat = false;\n              this.is_paginated_call = false;\n              if (!this.message_pagination.page_record_fetched.includes(response.data.page_no)) {\n                let new_data = this.format_history_response(response.data.chat_history);\n                this.history = new_data.concat(this.history);\n                this.message_pagination.page_record_fetched.push(response.data.page_no);\n                // console.log(this.history);\n                this.message_pagination.page_no += 1;\n                if(scroll_down == true) {\n                  this.scroll_down();\n                } else {\n                  // this.scroll_down_effect()\n                }\n              }\n            })\n            .catch((e) => {\n              console.log(e);\n            });\n        }\n      }\n    },\n    show_profile_setup() {\n      this.is_profile_setup = !this.is_profile_setup;\n      this.get_profile_details();\n    },\n    show_all_contacts(){\n      this.is_profile_setup = !this.is_profile_setup;\n      this.is_contact_list = !this.is_contact_list;\n      this.get_all_contact_list();\n    },\n    format_history_response(response) {\n      let con_date = \"\";\n      for (let i in response) {\n        if (i == 0) {\n          con_date = response[i].bot_response_date;\n        }\n        if (con_date == response[i].bot_response_date && i != 0) {\n          response[i].bot_response_date = \"\";\n        } else {\n          con_date = response[i].bot_response_date;\n        }\n      }\n      return response;\n    },\n    send_message_to_user() {\n      if(Boolean(this.message_to_send)=== false && this.send_attachment_detail.show_preview == false) return false;\n        let current_timestamp =  new Date(),\n        current_date = moment().format('YYYY-MM-DD')\n        if(this.send_attachment_detail.show_preview == true){\n          this.send_attachment_detail.company_id = this.company_id;\n          this.send_attachment_detail.company_name = this.company_name;\n          this.send_attachment_detail.whatsapp_contact_number = this.current_contact_number;\n          this.send_attachment_detail.document_content = null;\n          this.send_attachment_detail.media_caption = this.message_to_send;\n          this.show_spinner = true;\n          axios.post(api_calls.whatsapp_chat(), this.send_attachment_detail,\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }).then((response) => {\n            this.show_spinner = false;\n            if(response.data.message === \"Whatsapp media sent successfully\"){\n              let bot_response = [];\n              if(this.file_extensions.image_file_extensions.includes(this.send_attachment_detail.media_content_type)){\n                bot_response = [\n                    {\n                      \"text\": null, \n                      \"recipient_id\": this.current_contact_number,\n                      \"image\" : {\n                        caption: this.message_to_send,\n                        link : response.data.file_link\n                      }\n                    }, \n                ]\n              };\n              if(this.file_extensions.document_file_extensions.includes(this.send_attachment_detail.media_content_type)){\n                bot_response = [\n                    {\n                      \"text\": null, \n                      \"recipient_id\": this.current_contact_number,\n                      \"image\" : `https://storage.cense.ai/${this.company_id}/WhatsappMedia/${this.send_attachment_detail.media_file_name}`\n                    }, \n                ]\n              }\n              this.history.push(\n                {\n                  \"BOTResponse\": bot_response,\n                  \"user_query_time\":current_timestamp,\n                  \"UserQuery\": \"\",\n                  \"bot_response_date\": current_date, \n                  \"bot_response_time\": current_timestamp, \n                  \"user_query_date\": current_date,\n                  \"Chat_Datetime\": current_timestamp.toISOString()\n                }\n              );\n              this.scroll_down();\n              this.contact_list[this.current_contact_index].last_bot_response.text = this.message_to_send;\n              this.contact_list = this.array_move(this.contact_list, this.current_contact_index, 0);\n              this.message_to_send = null;\n              this.current_contact_index = 0;\n              this.send_attachment_detail.show_preview = false;\n            }\n            // console.log(response);\n            return;\n          }).catch((e) => {\n            console.log(e)\n            return;\n          })\n          return false;\n        }\n      this.show_spinner = true;\n      axios.post(api_calls.whatsapp_chat(), {\n        company_id: this.company_id,\n        company_name: this.company_name,\n        send_message: true,\n        text: this.message_to_send,\n        whatsapp_contact_number: this.current_contact_number\n      },\n      {\n        headers: {\n          Authorization: `Bearer ${this.$session.get(\"at\")}`,\n        },\n      }).then((response) => {\n        this.show_spinner = false;\n        if(response.data.message === \"Whatsapp message sent successfully\"){\n          if(this.start_new_conv_data.start_new_conv){\n            this.current_contact_index = 0;\n            this.new_conv_contact_data.chat_datetime = current_timestamp.toISOString()\n            this.new_conv_contact_data.is_message_sending_enabled = true\n            this.new_conv_contact_data.last_bot_response = {\n              text: this.message_to_send, \n              chat_datetime: current_timestamp.toISOString(), \n              date: current_date, \n              time: `${current_timestamp.getUTCHours()}:${current_timestamp.getUTCMinutes()}`\n            }\n            this.contact_list.unshift(\n              this.new_conv_contact_data\n            )\n            this.start_new_conv_data.start_new_conv = false;\n          }\n          this.history.push(\n            {\n              \"BOTResponse\": [\n                {\n                  \"text\": this.message_to_send, \n                  \"recipient_id\": this.current_contact_number\n                }, \n              ],\n              \"user_query_time\":current_timestamp,\n              \"UserQuery\": \"\",\n              \"bot_response_date\": current_date, \n              \"bot_response_time\": current_timestamp, \n              \"user_query_date\": current_date,\n              \"Chat_Datetime\": current_timestamp.toISOString()\n            }\n          );\n          this.scroll_down();\n          this.contact_list[this.current_contact_index].last_bot_response.text = this.message_to_send;\n          this.contact_list = this.array_move(this.contact_list, this.current_contact_index, 0);\n          this.message_to_send = null;\n          this.current_contact_index = 0;\n        }\n      }).catch((e) => {\n        this.show_spinner = false;\n        swal({\n          title: \"Oops\",\n          text: \"Some Error Occurred\",\n          showCancelButton: false\n        })\n      })\n    },\n    edit_website_value(index){\n      this.index_update = index;\n      this.edit_website = true;\n    },\n    get_profile_details(){\n      this.show_spinner = true;\n      this.edit_email =false;\n      this.edit_address = false;\n      this.edit_description = false;\n      this.edit_website = false;\n      this.edit_status = false;\n      this.index_update = null ;\n      axios\n        .post(\n          api_calls.whatsapp_profile(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_get:true\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.show_spinner = false;\n          this.whatsapp_profile = response.data.whatsapp_profile\n        })\n        .catch((e) => {\n          this.show_spinner = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    update_profile_details(){\n      this.edit_email =false;\n      this.edit_address = false;\n      this.edit_description = false;\n      this.edit_website = false;\n      this.edit_status = false;\n      this.index_update = null ;\n      if (this.whatsapp_profile.websites.length == 2) {\n           this.second_website = true; \n      }\n      this.show_spinner = true;\n      axios\n        .post(\n          api_calls.whatsapp_profile(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_edit:true,\n            whatsapp_profile:this.whatsapp_profile\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.show_spinner = false;\n          let resp = response.data.update_response;\n          if (resp == \"edit successful\") {\n              this.get_profile_details();\n          }\n          else{\n            Swal({\n            text: \"Please entre valid data\",\n            toast: true,\n            position: \"top-end\",\n            type: \"error\",\n            showConfirmButton: false,\n            timer: 2000\n            });\n            this.get_profile_details();\n          }\n        })\n        .catch((e) => {\n          console.log(e);\n          this.show_spinner = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    update_profile_image(e){\n      this.selected_files = e.target.files[0];\n      if (this.selected_files.type == 'image/png' || this.selected_files.type == 'image/jpg' || this.selected_files.type == 'image/jpeg'  ) {\n        if (this.selected_files.size > 5097152) {\n          Swal({\n            text: \"Upload image with size should be less than 5MB\",\n            toast: true,\n            position: \"top-end\",\n            type: \"error\",\n            showConfirmButton: false,\n            timer: 2000\n          });\n          this.selected_files ='';\n          return\n        }\n        let file_to_upload = this.selected_files;\n        var profile_img = {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            photo:file_to_upload\n          }\n        var json = JSON.stringify(profile_img);\n        var blob = new Blob([json], {\n            type: \"application/json\",\n        });\n        const fd = new FormData();\n        fd.append(\n          'photo',\n          this.selected_files\n        )\n        fd.append(\"json\", blob);\n        this.show_spinner = true;\n        axios\n          .post(\n            api_calls.whatsapp_profile(),fd,\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          ).then((response) => {\n          this.show_spinner = false;\n          let resp = response.data;\n          if (resp == \"Photo updating successful\") {\n              this.get_profile_details();\n          }\n          else if (resp == \"Cannot update photo yet\"){\n              Swal({\n              text: \"You cannot update the profile picture yet, please try again later\",\n              type: \"warning\",\n              showConfirmButton: true,\n              timer: 2000\n            });\n            this.get_profile_details();\n          }\n          else{\n            this.get_profile_details();\n          }      \n          })\n          .catch((e) => {\n            console.log(e);\n            this.show_spinner = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      }else {\n        Swal({\n            text: \"Upload image with specific formate(jpg jpeg png)\",\n            toast: true,\n            position: \"top-end\",\n            type: \"error\",\n            showConfirmButton: false,\n            timer: 2000\n          });\n      }\n    },\n    remove_profile_image(){\n      this.show_spinner = true;\n      axios\n        .post(\n          api_calls.whatsapp_profile(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_remove_photo:true\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.show_spinner = false;\n          if(response.data === \"Photo removed\"){\n            this.get_profile_details();\n          }\n          if (response.data ===\"Photo removal unsuccessful\") {\n            this.get_profile_details();\n          }\n        })\n        .catch((e) => {\n          this.show_spinner = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    connect_elixir_socket(){\n      axios.post(api_calls.initialize_whatsapp_topic(),{\n        company_id: this.company_id,\n        whatsapp_phone_number: \"100\"\n      }).then((response) => {\n        // console.log(response)\n        // this.chat_group_name = response.data.chat_group_name;\n        // this.live_chat_token = response.data.token;\n        // this.live_chat_on = true;\n        this.chat_socket = new Socket(\n          process.env.VUE_APP_LIVE_CHAT_WEBSOCKET_ENDPOINT,\n          {\n            params: {\n              whatsapp: \"true\",\n              token : response.data.token\n            },\n          }\n        );\n        this.chat_socket.connect();\n        this.channel = this.chat_socket.channel(\n          \"whatsapp:\" + response.data.whatsapp_topic\n        );\n        this.channel.join();\n        this.channel.on(\"new_whatsapp_message\", (res) => {\n          // console.log(\"new_whatsapp_message\", res)\n        })\n      })\n    },\n    enable_sending_messages_for_user(){\n      axios.post(api_calls.whatsapp_chat(), {\n        update_bot_response: true,\n        whatsapp_contact_number: this.current_contact_number,\n        bot_response: false,\n        company_name: this.company_name,\n        company_id: this.company_id\n      },\n      {\n        headers: {\n          Authorization: `Bearer ${this.$session.get(\"at\")}`,\n        },\n      }).then((response) => {\n        // console.log(response);\n        if(response.data.status === \"Success\") {\n          if(this.start_new_conv_data.start_new_conv === true){\n            this.start_new_conv_data.is_message_sending_enabled = true;\n          } else {\n            this.contact_list[this.current_contact_index].is_message_sending_enabled = true;\n            this.$set(this.contact_list, this.current_contact_index, this.contact_list[this.current_contact_index]);\n          }\n          this.$nextTick(() => {\n            this.$refs[\"message_sending_textbox\"].focus();\n          })\n        } else if(response.data.status === \"Failure\"){\n\n        } else if(response.data.status === \"Error\"){\n\n        }\n      }).catch((e) => {\n        console.log(e)\n\n      })\n    }, \n    expand_textbox(id, key) {\n      if (id != '#business_address') {\n        this.callsearch();\n      }else{\n        setTimeout(() => {\n        var textarea = document.querySelector(id);\n        textarea.addEventListener('keydown', e =>{\n          let scroll_height =e.target.scrollHeight;\n          textarea.style.height = `${scroll_height}px`\n        });\n        },10);\n      }\n    },\n    callsearch() {\n      if (event.keyCode === 13 && !event.shiftKey) {\n        this.update_profile_details();\n      }\n    },\n    check_current_number(res){\n      return res.whatsapp_phone_number === this.current_contact_number ? true : false;\n    },\n    format_user_query_date(user_query_date, index){\n      // console.log(Object.keys(this.history[index-1]))\n      if(this.history[index-1].user_query_date == user_query_date){\n        return \"\"\n      }\n      return user_query_date\n    },\n    get_all_contact_list() {\n      this.show_spinner = true;\n      axios\n        .post(\n          api_calls.whatsapp_chat(),\n          {\n            is_get_all_contacts: true,\n            company_id: this.company_id,\n            company_name: this.company_name,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.show_spinner = false;\n          this.all_contact_list = response.data.contacts;\n          this.all_contact_pagination.total_records = response.data.total_contacts;\n        })\n        .catch((e) => {\n          this.show_spinner = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    new_contact_list() {\n       let scroller = document.getElementsByClassName('all-contact-list')[0].scrollTop;\n       if (scroller > 120 && !this.is_paginated_call && !this.total_contact_loaded) {\n        this.is_paginated_call = true;\n        this.scroll_spinner_chat = true;\n        axios\n          .post(\n            api_calls.whatsapp_chat(),\n            {\n              is_get_all_contacts: true,\n              company_id: this.company_id,\n              company_name: this.company_name,\n              per_page: this.all_contact_pagination.per_page,\n              page_no: this.all_contact_pagination.page_no + 1,\n            },\n            {\n                headers: {\n                  Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                },\n              }\n          )\n          .then((response) => {\n              this.scroll_spinner_chat = false;\n              this.is_paginated_call = false;\n              this.all_contact_list = this.all_contact_list.concat(response.data.contacts);\n              this.all_contact_pagination.page_no += 1;\n            })\n            .catch((e) => {\n              this.scroll_spinner_chat = false;\n              if (\n                e.response.status === 410 ||\n                e.response.status === 440 ||\n                e.response.status === 409\n              ) {\n                this.$root.$emit(\"Session_Expired\", e.response.data);\n              }\n            });\n        }\n    },\n    array_move(arr, old_index, new_index) {\n      if (new_index >= arr.length) {\n          var k = new_index - arr.length + 1;\n          while (k--) {\n              arr.push(undefined);\n          }\n      }\n      arr.splice(new_index, 0, arr.splice(old_index, 1)[0]);\n      return arr; // for testing\n    },\n    formatUserQueryTime(user_query_time){\n      \n      return new Date(user_query_time).toLocaleTimeString(navigator.language, {\n        hour: '2-digit',\n        minute:'2-digit'\n      })\n      // return user_query_time\n    },\n    is_active_chat(index) {\n      if(index === this.current_contact_index) {\n        return \"background: #f0f8ff\"\n      } \n      return \"background: #ffffff\"\n    },\n    formatContactLastMessageDate(date, time) {\n      if(moment(date).isSame(Date.now(), 'day')){\n        return new Date(`${date} ${time}Z`).toLocaleTimeString(navigator.language, {\n        hour: '2-digit',\n        minute:'2-digit'\n      })\n      } \n      return date\n    },\n    check_previous_message_date_same(index){\n      // console.log(index)\n      return true; \n      // if(index == 0) {\n      //   return true; \n      // }\n      // return this.history[index-1].bot_response_date == this.history[index].bot_response_date ? true : false; \n    },\n    process_attachment_file(e) {\n      let files = e.target.files || e.dataTransfer.files;\n      if (files[0].size > 2097152) {\n        swal({\n          text: \"Upload image with size less than 2MB\",\n          toast: true,\n          position: \"top-end\",\n          type: \"error\",\n          showConfirmButton: false,\n          timer: 10000,\n        });\n        return;\n      }\n      if (this.file_extensions.all_allowed_file_extensions.includes(files[0].type)) {\n        if (!files.length) return;\n        this.send_attachment_detail.media_file_name = files[0].name;\n        this.send_attachment_detail.media_content_type = files[0].type;\n        this.send_attachment_detail.document_content = URL.createObjectURL(files[0]);\n        this.send_attachment_detail.show_preview = true;\n        this.send_attachment_detail.media_type = this.file_extensions.image_file_extensions.includes(files[0].type) ? 'image': 'document';\n        this.send_attachment_detail.media_caption = this.message_to_send;\n        this.createAttachment(files[0]);\n      } else {\n        swal({\n          title: \"Please Select a proper document or image having the correct filetype\",\n          type: \"error\",\n          showCancelButton: false\n        })\n      }\n    },\n    createAttachment(file, type) {\n      let reader = new FileReader();\n\n      reader.onload = (e) => {\n        this.send_attachment_detail.media_file = e.target.result.split(\"base64,\")[1];\n      };\n      reader.readAsDataURL(file);\n      reader.addEventListener(\"load\", function () {\n        document.getElementById(\"img-preview\").style.display = \"flex\";\n        document.getElementById(\"img-preview\").innerHTML = '<img class=\"custom-display-image\" style=\"max-height:500px; padding: 1rem;margin-left: auto; margin-right: auto;\" src=\"' + this.result + '\" />';\n      });    \n    },\n    is_response_image(data){\n      if(data.template == null && data.text == null && Boolean(data.image)!= null){\n        return true;\n      }\n      return false;\n    },\n    is_response_document(data){\n      if(data.template == null && data.text == null && data.image== null && Boolean(data.attachment) != null){\n        return true;\n      }\n      return false;\n    },\n    show_image_fullscreen(img_src){\n      $(\"#showImageModal\").modal(\"show\");\n      this.current_fullscreen_image_src = img_src;\n    },\n    add_new_contact_modal(){\n      // console.log(\"add new contact-addContactModal\")\n      $(\"#addContactModal\").modal(\"show\");\n    },\n    save_new_contact() {\n      this.add_new_contact.company_id = this.company_id;\n      this.add_new_contact.company_name = this.company_name;\n      this.show_spinner = true;\n      axios\n      .post(\n        api_calls.whatsapp_chat(),this.add_new_contact,\n        {\n          headers: {\n            Authorization: `Bearer ${this.$session.get(\"at\")}`,\n          },\n        }\n      )\n      .then((response) => {\n      this.show_spinner = false;\n        if(response.data.message == 'Whatsapp Contact Added Successfully'){\n          swal({\n            title: \"Success\",\n            text: \"Contact Added Successfully\",\n            type: \"success\",\n            showCancelButton: false\n          })\n          $(\"#addContactModal\").modal(\"hide\");\n          this.clear_add_contact();\n          this.get_all_contact_list();\n        } else if(response.data.message == 'Provided number already exists in contacts') {\n          swal({\n            title: \"Oops!\",\n            text: \"Contact Already Exists\",\n            type: \"error\",\n            showCancelButton: false\n          })\n        } else {\n          swal({\n            title: \"Oops!\",\n            text: \"Some Error Occurred. Please Try Again!\",\n            type: \"error\",\n            showCancelButton: false\n          })\n        }\n      }).catch((e) => {\n        swal({\n          title: \"Oops!\",\n          text: \"Some Error Occurred. Please Try Again!\",\n          type: \"error\",\n          showCancelButton: false\n        })\n        this.show_spinner = false;\n        if (\n          e.response.status === 410 ||\n          e.response.status === 440 ||\n          e.response.status === 409\n        ) {\n          this.$root.$emit(\"Session_Expired\", e.response.data);\n        }\n      });\n    },\n    clear_add_contact(){\n      this.add_new_contact = {\n        phone_number: null,\n        is_add_contact: true,\n        contact_name: null,\n        formattedNumber: null\n      }\n    },\n    download_document(attachment){\n      console.log(attachment)\n      var aTag = document.createElement('a');\n      aTag.setAttribute('id','abcdefg');\n      aTag.setAttribute('download', 'download');\n      aTag.setAttribute('href',attachment.link);\n      aTag.setAttribute('target',\"_blank\");\n      aTag.click();\n\n      // const blob = new Blob([attachment.link], { type: 'application/pdf' })\n      // const link = document.createElement('a')\n      // link.href = URL.createObjectURL(blob)\n      // link.download = attachment.filename\n      // link.click()\n      // URL.revokeObjectURL(link.href)\n      // link.click();\n    },\n    open_send_template_to_user(){\n      this.retrieve_all_templates();\n      $(\"#sendTemplateModal\").modal(\"show\");\n    },\n    retrieve_all_templates(){\n      this.current_template = {};\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.whatsapp_template(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_get: true,\n            is_notification: this.is_notification_template,\n            page_no: this.page_no,\n            per_page: this.per_page,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (response.data != null) {\n            this.whatsapp_templates.templates_list = [];\n            if (response.data.message === \"No Whatsapp Template in database\") {\n              this.whatsapp_templates.templates_list = [];\n              return;\n            } else if (response.data.templates != null) {\n              this.whatsapp_templates.templates_list = response.data.templates;\n              this.whatsapp_templates.pagination_data.number_of_rows = response.data.page_count;\n              this.whatsapp_templates.pagination_data.total_pages = Math.ceil(this.number_of_rows / this.per_page);\n              // if (this.whatsapp_templates.templates_list.length > 0) {\n              //   this.show_template(0);\n              // }\n              // this.setpagination(this.page_no);\n            } else if(response.data.message === \"Internal Server Error\") {\n              Swal({\n                type: \"error\",\n                text: \"Internal Server Error\",\n                timer: 2500,\n              });\n            } \n          } else {\n              Swal({\n                text: \"Some error occured\",\n                type: \"error\",\n                showConfirmButton: false,\n                timer: 2500,\n              });\n            }\n        })\n        .catch((e) => {\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    send_template_to_customer(){\n      axios\n      .post(\n        api_calls.whatsapp_template(),\n        {\n          company_name: this.company_name,\n          company_id: this.company_id,\n          email: this.$session.get(\"UserInformation\").email,\n          license_key: this.$session.get(\"UserInformation\").license_key,\n          token: this.$session.get(\"UserInformation\").tokens,\n          subscription: this.$session.get(\"UserInformation\").subscription,\n          is_notification: false,\n          template_id: this.whatsapp_templates.selected_template,\n          contacts_list: [this.current_contact_number],\n          publish_template: true,\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${this.$session.get(\"at\")}`,\n          },\n        }\n      )\n      .then((response) => {\n        if (response.data.message == \"Selected template not found in db\") {\n          Swal({\n            title: \"Insufficient credits\",\n            text: \"You have no credits left to send template to Non-US region, You can purchase Cense Add Ons to continue sending template\",\n            type: \"warning\",\n            showConfirmButton: false,\n          });\n        } else if (\n          response.data.message == \"No credits left for template to non us\"\n        ) {\n          Swal({\n            title: \"Insufficient credits\",\n            text: \"You have no credits left to send template to Non-US region, You can purchase Cense Add Ons to continue sending template\",\n            type: \"warning\",\n            showConfirmButton: false,\n          });\n        } else if (response.data.message == \"template is being sent\") {\n          Swal({\n            title: \"Template is being sent\",\n            type: \"success\",\n            showConfirmButton: false,\n          });\n          this.whatsapp_templates.selected_template = null ;\n          $(\"#sendTemplateModal\").modal(\"hide\");\n        } else if (response.data.message == \"No credits left to send template\") {\n          Swal({\n            title: \"Insufficient credits\",\n            text: \"You have no credits left to send template to US region, You can purchase Cense Add Ons to continue sending template\",\n            type: \"warning\",\n            showConfirmButton: false,\n          });\n        } else if(response.data.message === \"Internal Server Error\") {\n          Swal({\n            type: \"error\",\n            text: \"Internal Server Error\",\n            timer: 2500,\n          });\n        } else {\n          Swal({\n            text: \"Some error occured\",\n            type: \"error\",\n            showConfirmButton: false,\n            timer: 2500,\n          });\n        }\n      })\n      .catch((e) => {\n        if (\n          e.response.status === 410 ||\n          e.response.status === 440 ||\n          e.response.status === 409\n        ) {\n          this.$root.$emit(\"Session_Expired\", e.response.data);\n        }\n      })\n    },\n    get_contact_display_name(contact){\n      if(contact.contact_name) return contact.contact_name \n      if(contact.profile_name) return contact.profile_name\n      return contact.whatsapp_phone_number\n    },\n    open_import_from_csv_modal(){\n      $(\"#addContactModal\").modal(\"hide\");\n      $(\"#importContactCSVModal\").modal(\"show\");\n    },\n    file_input_contacts_csv(e){\n      if (e.target.files[0].type == 'text/csv'){\n        this.contact_csv.file_label = e.target.files[0].name;\n        this.contact_csv.file_content = e.target.files[0];\n        this.contact_csv.file_selected = true;\n      } else {\n        swal({\n          title: \"Please select a proper document having CSV filetype\",\n          type: \"error\",\n          showCancelButton: false\n        })\n      }\n    },\n    file_submit_upload_contacts() {\n      if ($(\"#inputGroupUploadFilecsv\").val() == '') {\n        Swal.fire({\n          title: \"Oops!\",\n          text: \"Please Select a CSV file\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      }\n      var user_details = {\n        email: this.$session.get(\"UserInformation\").email,\n        companyname: this.companyname,\n        companyid: this.companyid,\n        license_key: this.$session.get(\"UserInformation\").license_key,\n      };\n      var json = JSON.stringify(user_details);\n      var blob = new Blob([json], {\n        type: \"application/json\",\n      });\n      const fd = new FormData();\n      fd.append(\n        \"file\",\n        this.contact_csv.file_content,\n        this.contact_csv.file_label\n      );\n      // fd.append(\"json\", blob);\n      fd.append(\"companyid\", this.company_id);\n      fd.append(\"companyname\", this.company_name);\n      fd.append(\"email\", this.$session.get(\"UserInformation\").email);\n      axios\n      .post(api_calls.whatsapp_import_contacts(), fd, {\n        headers: {\n          Authorization: `Bearer ${this.$session.get(\"at\")}`,\n        },\n      })\n      .then((response) => {\n        if(response.data.status === 'Success'){\n          swal({\n            title: \"Success\",\n            text: \"Multiple contacts are being added. You will receive a mail when the processing is finished.\",\n            type: \"success\",\n            showCancelButton: false\n          })\n        } else if(response.data.status === 'Failure') {\n          swal({\n            title: \"Incorrect File Format!\",\n            text: \"Please try again with a different csv file which matches the sample file structure\",\n            showCancelButton: false,\n            type: \"error\"\n          })\n        } else if(response.data.status === 'Error') {\n          swal({\n            title: \"Some Error Occurred!\",\n            text: \"Please try again.\",\n            showCancelButton: false,\n            type: \"error\"\n          })\n        } else {\n          swal({\n            title: \"Some Error Occurred!\",\n            text: \"Please try again.\",\n            showCancelButton: false,\n            type: \"error\"\n          })\n        }\n      })\n      .catch((e) => {\n        swal({\n          title: \"Some Error Occurred!\",\n          text: \"Please Try Again\",\n          showCancelButton: false,\n          type: \"error\"\n        })\n          if (\n          e.response.status === 410 ||\n          e.response.status === 440 ||\n          e.response.status === 409\n        ) {\n          this.$root.$emit(\"Session_Expired\", e.response.data);\n        }\n      })\n    },\n    empty_upload_csv_contacts(){\n      this.contact_csv = {\n        file_label: 'Choose File',\n        file_content: null,\n        file_selected: false\n      };\n      $(\"#inputGroupUploadFilecsv\").val('');\n    },\n    download_sample_contact_file(){\n      axios({\n        method: \"post\",\n        url: api_calls.file_download(),\n        responseType: \"blob\",\n        data: {\n          sample_file: \"whatsapp_contacts\",\n          companyid: this.$session.get(\"UserInformation\").company_id,\n          company_name: this.$session.get(\"UserInformation\").company_name,\n          license_key: this.$session.get(\"UserInformation\").license_key,\n          token: this.$session.get(\"UserInformation\").tokens,\n          email: this.$session.get(\"UserInformation\").email,\n        },\n        headers: {\n          Authorization: `Bearer ${this.$session.get(\"at\")}`,\n        },\n      })\n        .then((response) => {\n          this.spinnerOnFileDownload = false;\n          if (response.data.message === \"Not able to download file\") {\n            Swal({\n              title: \"Some Error Occurred. Please Try Again\",\n              type: \"error\",\n              timer: 2500,\n            });\n          } else {\n            var url = window.URL.createObjectURL(new Blob([response.data]));\n            var link = document.createElement(\"a\");\n            link.href = url;\n            // console.log(this.companyname)\n            link.setAttribute(\"download\", \"test.csv\");\n            document.body.appendChild(link);\n            link.click();\n          }\n        })\n        .catch((e) => {\n          this.spinnerOnFileDownload = false;\n          Swal({\n            title: \"Some Error Occurred. Please Try Again\",\n            type: \"error\",\n            timer: 2500,\n          });\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    }\n  },\n  beforeDestroy(){\n    this.channel.leave(); \n    this.chat_socket.disconnect();\n  }\n};\n</script>\n\n<style scoped>\n.log-wrap {\n  position: relative;\n  min-height: 100vh;\n  background: linear-gradient(\n    to bottom,\n    #47a884 0%,\n    #47a884 20%,\n    #dedfdd 20%,\n    #dedfdd 100%\n  );\n}\n.container{\n  /* height: 95vh; */\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.cards {\n  /* margin-left: 150px; */\n  background: rgb(255, 255, 255);\n  border-radius: 6px 6px 0 0;\n  position: relative;\n  padding: 5px 5px 0 5px;\n  /* min-height: 175px; */\n  max-width: 205px;\n  /* box-shadow: 0px 2px 8px rgba(12, 12, 13, 0.1); */\n}\n.cards-img {\n  width: 100%;\n  max-height: 195px;\n}\n.preview-button-div {\n  display: grid;\n  gap: 4px;\n  width: 100%;\n  text-align: center;\n  grid-auto-columns: minmax(50%, 100%);\n}\n.preview-button {\n  background: rgb(255, 255, 255);\n  border-top: solid 1px #D3D3D3;\n  border-radius: 0 0 6px 6px;\n  padding: 0.375rem 0.75rem;\n  position: relative;\n  /* box-shadow: 0px 2px 8px rgba(12, 12, 13, 0.1); */\n  color: #0b67aa;\n  cursor: pointer;\n}\n.back-top {\n  background: linear-gradient(\n    #47a884 0%,\n    #47a884 130px,\n    #d9dbd5 30px,\n    #d9dbd5 100%\n  ) !important;\n  height: 14vh !important;\n}\n\n.back-main {\n  background-color: #dedfdd !important; \n  height: 82vh !important;\n}\n\n.back-container {\n  position: relative !important;\n}\n\n.search-chat {\n  /* width: 100% !important; */\n  height: 50px !important;\n  background: #ffff !important;\n  display: flex !important;\n  justify-content: center !important;\n  align-items: center !important;\n  position: relative;\n}\n\n.search-chat div {\n  width: 95% !important;\n}\n\n.search-chat div input {\n  width: 100% !important;\n  outline: none !important;\n  border: none !important;\n  background: #f0f2f5 !important; \n  height: 35px !important;\n  border-radius: 10px !important;\n  font-size: 13px !important;\n  padding-left: 50px !important;\n}\n\n.search-chat div svg {\n  position: absolute !important;\n  left: 1.7rem !important;\n  top: 1.2rem !important;\n}\n.front-container{\n position: absolute !important;    \n top:0 !important;\n left:0 !important;\n right: 0 !important;\n}\n.front-container1{\n  padding: 2rem 0 1rem 0 !important;\n  margin-left: auto !important;\n  margin-right: auto !important;\n  max-width: 75% !important;\n  position: relative !important;\n}\n.chat-top{\n /* height: 89vh !important; */\n /* position: relative !important; */\n border-right: 1px solid rgba(0, 0, 0, 0.2);\n background-color: #f0f2f5 !important;\n /* min-height: 40px !important; */\n}\n.contacts{\n  width: 100% !important;\n  height: inherit;\n  /* background-color: #ffffff !important;\n  border-right: 1px solid rgba(0,0,0,0.2) !important; */\n}\n.contact-table-scroll{\n  overflow-y: scroll !important;\n  height: 494px !important;\n  background-color: white;\n}\n.message-area{\n background-color:  #e4e1de !important;\n height: 500px;\n}\n.profile-image{\n  height: 81%!important;\n  width: 81% !important;\n  margin-left: 15px !important;\n}\n.no-profile-image{\n  height: 13%!important;\n  width: 13% !important;\n  margin-left: 15px !important;\n}\n.no-profile-image-conv{\n  /* height: 70%!important;\n  width: 13% !important;\n  margin-left: 15px !important; */\n}\n\n.user-profile-picture {\n  height: 40px !important;\n  width: 40px !important;\n  padding: 0 !important;\n}\n\n.message-table-scroll {\n  position: relative !important;\n  overflow-y: scroll !important;\n  overflow-x: auto !important;\n  width: 100% !important;\n  height: 100% !important;\n  background-image: url(/img/web-whatsapp-bg-2.png);\n  background-color: #efeae2;    \n}\n\n.conversation-date {\n  font-size: 0.7em !important;\n  border-radius: 5px !important;\n  padding: 6px !important;\n  background: #ffff !important;\n  color: #757bb0 !important;\n}\n\n.bot-resp {\n  position: relative !important;\n}\n\n.bot-resp-msg {\n  max-width: 550px !important;\n  min-width: 100px !important;\n  text-align: justify !important;\n  background: #dcf8c6 !important;\n  font-size: 0.8em !important;\n  border-radius: 10px 10px 0 0 !important;\n  padding: 6px 6px 0 11px !important;\n}\n\n.bot-resp-time {\n  width: 100% !important;\n  text-align: end !important;\n  background: #dcf8c6 !important;\n  font-size: 0.8em !important;\n  border-radius: 0 0 10px 10px !important;\n}\n\n.bot-resp-msg2 {\n  margin-bottom: 0.5rem !important; \n  width: 100% !important;\n  text-align: end !important;\n  background: #f0f2f5 !important;\n  font-size: 0.8em !important;\n  border-radius: 0 0 10px 10px !important;\n  padding: 0 5px 2px 0 !important;\n}\n\n.bot-resp-msg3 {\n  width: 100% !important;\n  text-align: end !important;\n  background: #f0f2f5 !important;\n  font-size: 0.8em !important;\n  border-radius: 0 0 10px 10px !important;\n  padding: 0 5px 2px 0 !important;\n}\n.bot-resp-msg-flag-card ::after {\n  content: \"\" !important;\n  position: absolute !important;\n  top: 0px !important;\n  right: 5px !important;\n  background: #ffffff !important;\n  width: 16px !important;\n  height: 20px !important;\n  background: linear-gradient(\n    135deg,\n    #ffffff 0%,\n    #ffffff 50%,\n    transparent 50%,\n    transparent\n  ) !important;\n}\n.bot-resp-msg-flag ::after {\n  content: \"\" !important;\n  position: absolute !important;\n  top: 0px !important;\n  right: 14px !important;\n  background: #dcf8c6 !important;\n  width: 16px !important;\n  height: 20px !important;\n  background: linear-gradient(\n    135deg,\n    #dcf8c6 0%,\n    #dcf8c6 50%,\n    transparent 50%,\n    transparent\n  ) !important;\n}\n\n.user-msg {\n  max-width: 550px !important;\n  min-width: 100px !important;\n  text-align: justify !important;\n  font-size: 0.8em !important;\n  border-radius: 0 10px 0 0 !important;\n  padding: 6px 6px 0 11px !important;\n}\n\n.user-msg-flag ::after {\n  content: \"\" !important;\n  position: absolute !important;\n  top: 8px !important;\n  left: 10px !important;\n  background: #dcf8c6 !important;\n  width: 15px !important;\n  height: 15px !important;\n  background: linear-gradient(\n    225deg,\n    #fff 0%,\n    #fff 50%,\n    transparent 50%,\n    transparent\n  ) !important;\n}\n\n.user-msg-time {\n  width: 100% !important;\n  text-align: end !important;\n  background: #ffff !important;\n  font-size: 0.8em !important;\n  border-radius: 0 0 10px 10px !important;\n}\n\n.user-info-page {\n  /* height: 89vh !important;\n  position: relative !important;\n  background: #f8f8f8 !important; */\n}\n.cense-whatsapp-image{\n  position: relative !important;\n  height:100% !important;\n  text-align: center !important\n}\n.cense-whatsapp-image .cense-image {\n  width: 150px !important;\n  margin-top: 26% !important;\n}\n.cense-whatsapp-image .whats-app-image {\n  width: 150px !important;\n  margin-top: 26% !important;\n  position: relative !important;\n  margin-left: 3rem !important;\n}\n.cense-whatsapp-image h4 {\n  color:#41525d !important ;\n}\n.profile-info{\n  height: 89vh !important;\n  position: relative !important;\n  min-height: 40px !important;\n  ;\n}\n\n.profile-top {\n  height: 10% !important;\n  align-items: end !important;\n  background: #f0f2f5 !important\n}\n.profile-bottom {\n  overflow: auto !important;\n  height: 90% !important;\n  background: #ffffff !important\n}\n.profile-details {\n  padding: 24px 24px 24px 24px !important;\n  height: 49vh !important;\n  position: relative !important;\n  min-height: 40px !important;\n  background: #ffffff !important;\n}\n\n.user-info {\n  display: flex !important;\n  align-items: center !important;\n  justify-content: space-between !important;\n  background: #f0f2f5 !important;\n}\n\n.user-info div p {\n  font-size: 15px !important;\n}\n\n.image-container {\n  position: relative !important;\n}\n\n.message-table-scroll {\n  scroll-behavior: smooth !important;\n}\n\n.carousel_cards {\n  /* min-width: 75% !important;\n  margin-left: 0.9em !important;\n  height: auto !important;\n  margin-bottom: 0.8rem !important; */\n}\n\n.carousel_card_single {\n  /* height: auto !important;\n  min-width: 55% !important;\n  border-radius: 0.25rem !important;\n  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;\n  background-color: #f0f2f5 !important;\n  border-radius: 1.3rem !important; */\n}\n\n.carousel_card_single img {\n  /* width: 100% !important;\n  height: 8.7em !important;\n  background-position: center center !important;\n  background-size: cover !important;\n  border-top-left-radius: 1.6em !important;\n  border-top-right-radius: 1.6em !important;\n  display: block !important; */\n}\n\n.carousel_card_single iframe {\n  width: 100% !important;\n  height: 10em !important;\n  background-position: center center !important;\n  background-size: cover !important;\n  border-top-left-radius: 1.6em !important;\n  border-top-right-radius: 1.6em !important;\n  display: block !important;\n}\n\n.carousel_card_single p {\n  /* font-family: var(--bot-font-style) !important;\n  width: 100% !important;\n  font-size: 0.8805rem !important;\n  font-weight: 300 !important;\n  line-height: 1em !important;\n  text-align: initial !important;\n  color: #4a4a4a !important;\n  margin-bottom: 0.3em !important; */\n}\n\n.carousel_card_single h4 {\n  /* font-family: var(--bot-font-style) !important;\n  color: rgba(0, 0, 0, 1) !important;\n  font-weight: 700 !important;\n  font-size: 0.95rem !important;\n  margin-bottom: 0.3em !important; */\n}\n\n.carousel_card_single a {\n  /* width: 93% !important;\n  font-family: var(--bot-font-style) !important;\n  margin-bottom: 0.2em !important;\n  border-radius: 8px !important;\n  font-size: 14px !important;\n  text-align: center !important;\n  color: rgba(0, 0, 0, 1) !important;\n  background: #e4e6eb !important;\n  border: 1px solid #e4e6eb !important;\n  padding: 6px 15px !important;\n  font-weight: 550 !important;\n  line-height: 1.9vh !important;\n  display: inline-block !important;\n  border-radius: 7px !important;\n  cursor: pointer !important; */\n}\n\n.carousel_card_button {\n  text-align: center !important;\n}\n\n.carousel_card_single a:hover {\n  /* opacity: 0.8 !important;\n  background: #c8cbce !important; */\n}\n\n.carousel_card_single a:active {\n  /* transform: translateY(1px) !important;\n  background: #a5cff1 !important; */\n}\n\n.single-product {\n  margin-left: 100px;\n  background: rgb(255, 255, 255);\n  border-radius: 6px 6px 0 0;\n  position: relative;\n  padding: 10px;\n  min-height: 175px;\n}\n\n.single-product img {\n  width: 100% !important;\n  height: 8.7em !important;\n  background-position: center center !important;\n  background-size: cover !important;\n  border-top-left-radius: 1.6em !important;\n  border-top-right-radius: 1.6em !important;\n  display: block !important;\n  border-bottom: 1px solid rgb(78, 77, 77) !important;\n}\n\n::-webkit-scrollbar {\n  width: 6px !important;\n  height: 6px !important;\n}\n\n::-webkit-scrollbar-thumb {\n  background-color: #ced0d1 !important;\n}\n\n::-webkit-scrollbar-track {\n  background: #ffff !important;\n}\n\n.user-name-date {\n  justify-content: space-between !important;\n}\n\n.user-name-date .user-name {\n  font-weight: 400 !important;\n  color: black !important;\n  font-size: 15px !important;\n}\n\n.user-info .customer-name {\n  font-weight: 400 !important;\n  color: black !important;\n  font-size: 15px !important;\n}\n\n.contact-list-empty {\n  /* position: absolute !important;\n  text-align: center !important;\n  padding-right: 2.3rem !important;\n  padding-left: 4.3rem !important;\n  padding-top: 4em !important;\n  font-size: 0.9em !important; */\n  color: #8696a0 !important;\n}\n\n.about-phone {\n  margin-bottom: 30px !important;\n}\n.abt-phone-title{\n  color: #008069 !important;\n  font-weight:400 !important;\n  font-size: 14px !important;\n}\n.add-another-website {\n  color: #008069 !important;\n  font-weight:400 !important;\n  font-size: 12px !important; \n  margin-left: 30px !important;\n  cursor: pointer !important;\n}\n.whts-status {\n  display: flex !important;\n  align-items: center !important;\n  justify-content: space-between !important;\n}\n.edit-status{\n  display: flex !important;\n  align-content: center !important;\n  position: relative !important;\n}\n\n.edit-status textarea {\n  outline: 0 !important;\n  border-width: 0 0 2px !important;\n  border-color: #47a884 !important;\n  padding:5px !important;\n  resize: none !important;\n  width: 88% !important;\n  height: 40px;\n}\n\n.whtsapp-no {\n  display: flex !important;\n  align-items: center !important;\n  padding-bottom: 20px !important;\n}\n.user-email-details{\n  padding: 5px !important;\n  min-height: 3.1rem !important;\n}\n.user-email-details .user-email {\n  display: flex !important;\n  align-items: center !important;\n}\n.user-email-details .user-email span {\n  margin-left: 1rem !important;\n  width: 90% !important;\n  margin-right: 1rem !important;\n}\n.user-email-details .edit-user-email {\n  display: flex !important;\n  align-items: center !important;\n  position: relative !important;\n}\n.user-email-details .edit-user-email textarea{\n  outline: 0 !important;\n  border-width: 0 0 2px !important;\n  border-color: #47a884 !important;\n  padding:5px !important;\n  resize: none !important;\n  width: 88% !important;\n  height: 35px ;\n  overflow: hidden !important;\n}\n.user-address-details{\n  padding: 5px !important;\n  min-height: 3.1rem !important;\n}\n.user-address-details .user-address{\n  display: flex !important;\n  align-items: center !important;\n}\n.user-address-details .user-address span {\n  margin-left: 1rem !important;\n  width: 90% !important;\n  margin-right: 1rem !important;\n}\n.user-address-details .edit-user-address {\n  display: flex !important; \n  align-items: center !important;\n  position: relative !important; \n}\n.user-address-details .edit-user-address textarea{\n  outline: 0 !important;\n  border-width: 0 0 2px !important;\n  border-color: #47a884 !important;\n  padding:5px !important;\n  resize: none !important;\n  width: 88% !important;\n  height: 35px ;\n  overflow: hidden !important;\n}\n.description-details {\n  padding: 5px !important;\n  min-height: 3.1rem !important;\n}\n.description-details .description {\n  display: flex !important;\n  align-items: center !important;\n}\n.description-details .description span { \n  margin-left: 1rem !important;\n  width: 90% !important;\n  margin-right: 1rem !important;\n}\n.description-details .edit-description {\n  display: flex !important;\n  align-items: center !important;\n  position: relative !important;    \n}\n.description-details .edit-description textarea{\n  outline: 0 !important;\n  border-width: 0 0 2px !important;\n  border-color: #47a884 !important;\n  padding:5px !important; \n  resize: none !important;\n  width: 88% !important;\n  height: 35px ;\n  overflow: hidden !important;\n}\n.website-details{\n  padding: 5px !important;\n  min-height: 3.1rem !important;\n}\n.website-details .website {\n  display:flex !important;\n  align-items: center !important;\n}\n.website-details .website span {\n  margin-left: 1rem !important;\n  width: 90% !important;\n}\n.website-details .edit-website {\n  display: flex !important;\n  align-items: center !important;\n  position: relative !important; \n}\n.website-details .edit-website textarea{\n  outline: 0 !important;\n  border-width: 0 0 2px !important;\n  border-color: #47a884 !important;\n  padding:5px !important;\n  resize: none !important;\n  width: 88% !important;\n  height: 35px;\n  overflow: hidden !important;\n}\n.webiste-vertical-details{\n  padding: 5px !important;\n  min-height: 3.1rem !important;\n}\n.webiste-vertical-details .webiste-vertical{\n  display: flex !important;\n  align-items:center !important;\n  position: relative !important;\n}\n\n</style>\n<style scoped>\n.lds-ring {\n  display: inline-block;\n  position: absolute;\n  width: 80px;\n  height: 80px;\n  left: 27vw;\n}\n\n.lds-ring div {\n  box-sizing: border-box;\n  display: block;\n  position: absolute;\n  width: 24px;\n  height: 24px;\n  margin: 8px;\n  border: 3px solid rgb(105, 100, 100);\n  border-radius: 50%;\n  animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n  border-color: rgb(110, 109, 109) transparent transparent transparent;\n}\n\n.lds-ring div:nth-child(1) {\n  animation-delay: -0.45s;\n}\n\n.lds-ring div:nth-child(2) {\n  animation-delay: -0.3s;\n}\n\n.lds-ring div:nth-child(3) {\n  animation-delay: -0.15s;\n}\n.profile-pic {\n  width: 100% !important;\n  height: 150px !important;\n  background: #eaf2f5 !important;\n  position: relative !important;\n}\n.profile-pic .second-circle {\n  position: absolute !important;\n  width: 130px !important;\n  height: 110px !important;\n  background: #76848c!important;\n  top: 150px !important;\n  left: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  margin: auto !important;\n  border-radius: 50% !important;\n  z-index: 1000 !important;\n  cursor: pointer;\n  border: 5px solid #ffff;\n}\n.profile-pic .second-circle input{\n  position: absolute !important;\n  width: 128px !important;\n  opacity: 0.01 !important;\n  height: 110px !important;\n  top: 0 !important;\n  left: 3px !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  margin: auto !important;\n  border-radius: 50% !important;\n  z-index: 2000 !important;\n  cursor: pointer;\n}\n.profile-pic .second-circle .img-circle-gry {\n  width: 100% !important;\n  height: 100% !important;\n}\n.profile-pic .second-circle .img-circle-gry .img-circle-title-cam {\n  display: flex !important;\n  flex-direction: column !important;\n  justify-content: center !important;\n  align-items: center !important;\n  padding-top: 40px !important;\n}\n.profile-pic .second-circle .img-circle-gry .img-circle-title-cam span {\n  font-size: 12px !important;\n  color: #ffff !important;\n}\n.profile-pic .second-circle-image img{\n  position: absolute !important;\n  width: 128px !important;\n  height: 120px !important;\n  top: 150px !important;\n  left: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  margin: auto !important;\n  border-radius: 50% !important;\n  z-index: 1000 !important;\n  cursor: pointer;\n  border: 5px solid #ffff;\n}\n.profile-pic .second-circle-image input{\n  position: absolute !important;\n  width: 128px !important;\n  opacity: 0.01 !important;\n  height: 110px !important;\n  top: 150px !important;\n  left: 3px !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  margin: auto !important;\n  border-radius: 50% !important;\n  z-index: 2000 !important;\n  cursor: pointer;\n}\n.img-cricle {\n  width: 100%;\n  height: 49px;\n  background: #ffff;\n}\n.img-cricle .no-image {\n  width: 100%;\n  height:7vh;\n  background: #ffff;\n  text-align: center;\n  position: relative;\n}\n.remove-profile-pic {\n  padding-top: 28px;\n  text-align: center;\n  margin-left: 120px;\n}\n.remove-profile-pic:hover .remove-profile-pic-hover{\n  visibility: visible;\n}\n@keyframes lds-ring {\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n#send_message_whatsapp {\n  width: 100%\n}\n\n\n\n#enable-message-sending {\n  position: absolute !important;\n  right: 1vw !important;\n  top: 31% !important;\n  font-size: 14px !important;\n}\n.search-contact{\n  width: 100% !important;\n  height: 50px !important;\n  background: #ffff !important;\n  display: flex !important;\n  justify-content: center !important;\n  align-items: center !important;\n  position: relative;\n}\n.search-contact div {\n  width: 95% !important;\n}\n.search-contact div input {\n  width: 100% !important;\n  outline: none !important;\n  border: none !important;\n  background: #f0f2f5 !important; \n  height: 35px !important;\n  border-radius: 10px !important;\n  font-size: 13px !important;\n  padding-left: 50px !important;\n}\n.search-contact div svg {\n  position: absolute !important;\n  left: 1.7rem !important;\n  top: 1.2rem !important;\n}\n.contacts-list{\n  background-color: #ffffff !important;\n}\n.all-contact-list{\n  overflow-y:scroll !important;\n  height: 495px !important;\n}\n.all-contact-list ul {\n  margin: 5px !important;\n}\n.all-contact-list li {\n  margin-bottom: 10px !important;\n  border-bottom: 1px solid #dee2e6 !important;\n  padding-bottom: 8px !important;\n  padding-left: 5px;\n}\n.all-contact-list li .user-name {\n  font-weight: 400 !important;\n  color: black !important;\n  font-size: 15px !important;\n  padding-bottom:5px !important;\n  padding-top:4px !important;\n  padding-left: 9px !important;\n}\n/* input#send_attachment{\n  display: inline-block;\n  width: 100%;\n  padding: 120px 0 0 0;\n  height: 10px;\n  overflow: hidden;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  background: url('https://cdn1.iconfinder.com/data/icons/hawcons/32/698394-icon-130-cloud-upload-512.png') center center no-repeat #e4e4e4;\n  border-radius: 20px;\n  background-size: 60px 60px;\n} */\n</style>\n\n<style lang=\"scss\" scoped>\n\n.send-message-to-user {\n  position:relative !important;\n  height: 6.6% !important;\n}\n\n// #img-preview {\n//   display: none; \n//   width: 155px;   \n//   border: 2px dashed #333;  \n//   margin-bottom: 20px;\n// }\n// #img-preview img {  \n//   width: 100%;\n//   height: auto; \n//   display: block;   \n// }\n.image-preview-container{\n  background-color: white;\n}\n// .custom-display-image {\n//   max-width: 100%;\n//   max-height: 100%;\n//   padding: 0.8rem;\n// }\n.image-custom {\nmax-width: 100%;\n}\n#showImageModal>.modal-dialog{\n  max-width: 75vw;\n}\n#showImageModal .close{\n  right: -2.5%;\n  top: 0%;\n}\n.form-check label {\n  display: inline-block;\n  width: auto;\n}\n.contact-verified-status {\n  text-transform:capitalize;\n  // border: 0.5px solid;\n  padding: 0.2rem;\n  // width: 20%;\n  text-align: center;\n  font-size: larger;\n}\n.contact-verified-status.pending{\n  color: #ffc347;\n}\n.contact-verified-status.valid{\n  color: #25af02;\n}\n.contacts-legend-preview{\n    text-align: left;\n    padding-top: 6rem;\n    padding-left: 2rem;\n}\n</style>"]}]}