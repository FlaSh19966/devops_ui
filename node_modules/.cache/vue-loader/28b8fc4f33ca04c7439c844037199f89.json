{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/User Management/Permissions.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/User Management/Permissions.vue","mtime":1655807120969},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOw0KaW1wb3J0IE11bHRpc2VsZWN0IGZyb20gInZ1ZS1tdWx0aXNlbGVjdCI7DQppbXBvcnQgU3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7DQppbXBvcnQgeyBzZXRUaW1lb3V0IH0gZnJvbSAidGltZXJzIjsNCmltcG9ydCBzaWRlYmFyaXRlbXMgZnJvbSAiLi4vTGF5b3V0L1NpZGVCYXJJdGVtIjsNCmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAicGVybWlzc2lvbnMiLA0KICBjb21wb25lbnRzOiB7DQogICAgTXVsdGlzZWxlY3QsDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHVzZXI6IFtdLA0KICAgICAgcm9sZXM6IFtdLA0KICAgICAgcGFnZV9ubzogMSwNCiAgICAgIHBlcl9wYWdlOiAxMCwNCiAgICAgIHNlbGVjdGVkX3JvbGU6ICIiLA0KICAgICAgc2VsZWN0ZWRfcGVybWlzc2lvbnM6IFtdLA0KICAgICAgcm9sZV9saXN0OiBbXSwNCiAgICAgIGNvbXBsZXRlX3JvbGVfbGlzdDogW10sDQogICAgICBwZXJtaXNzaW9uc19saXN0OiBbXSwNCiAgICAgIHBvcnRhbF9wZXJtaXNzaW9uc19saXN0OiBbXSwNCiAgICAgIGJvdF9wZXJtaXNzaW9uc19saXN0OiBbXSwNCiAgICAgIGludGVudGxpc3Q6IFtdLA0KICAgICAgY2hlY2tlZF9saXN0OiBbXSwNCiAgICAgIG51bWJlcl9vZl9yb3dzOiBudWxsLA0KICAgICAgdG90YWxfcGFnZXM6IG51bGwsDQogICAgICB1c2VyX3R5cGU6ICJQb3J0YWwiLA0KICAgICAgbWVudV9saXN0X2Zyb21fYXBpOiBudWxsLA0KICAgICAgc3Bpbm5lck9uOiBmYWxzZSwNCiAgICAgIGNvbXBhbnlpZDoNCiAgICAgICAgdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUgPT0gIlN1cGVyQWRtaW4iDQogICAgICAgICAgPyB0aGlzLiRzZXNzaW9uLmdldCgiQ29tcGFueUlkIikNCiAgICAgICAgICA6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLA0KICAgICAgY29tcGFueW5hbWU6DQogICAgICAgIHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIg0KICAgICAgICAgID8gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIikNCiAgICAgICAgICA6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsDQogICAgICB1c2VyX3JvbGU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlLA0KICAgICAgLy9oYXJzaA0KICAgICAgcGFnZV9hcnJheTogW10sDQogICAgICBzZWFyY2hfbmFtZTogIiIsDQogICAgICBwb3J0YWxfcm9sZXM6IFtdLA0KICAgICAgYm90X3JvbGVzOiBbXSwNCiAgICAgIGlzU2hvd19wb3J0YWxfcm9sZXM6IHRydWUsDQogICAgICBpc1Nob3dfYm90X3JvbGVzOiBmYWxzZSwNCiAgICAgIGlzVmlzaWJsZVNlYXJjaENsZWFyOiBmYWxzZSwNCiAgICAgIHNlbGVjdF9yb2xlX25hbWVfZGlzYWJsZTogZmFsc2UsDQogICAgICBmaWx0ZXJfdXNlcl90eXBlOiAiUG9ydGFsIiwNCiAgICAgIHVzZXJfdHlwZV9jaGFuZ2U6IHRydWUsIA0KICAgIH07DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgcGVybWlzc2lvbnNfdGl0bGUoKSB7DQogICAgICBpZiAodGhpcy51c2VyX3R5cGUgPT0gIlBvcnRhbCIpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMudGx0KCdwb3J0YWxfbWVudV9sYWJlbCcpOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLnVzZXJfdHlwZSA9PSAiQm90Iikgew0KICAgICAgICByZXR1cm4gdGhpcy50bHQoJ2JvdF9pbnRlbnRfbGFiZWwnKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGNoZWNrX3BvcnRhbF9ib3Rfcm9sZV9sZW5ndGgoKSB7DQogICAgICBpZiAodGhpcy51c2VyX3R5cGUgPT0gIlBvcnRhbCIgJiYgdGhpcy5wb3J0YWxfcm9sZXMubGVuZ3RoID4gMCkgew0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgIH0gZWxzZSBpZiAodGhpcy51c2VyX3R5cGUgPT0gIlBvcnRhbCIgJiYgdGhpcy5wb3J0YWxfcm9sZXMubGVuZ3RoID09IDApIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLnVzZXJfdHlwZSA9PSAiQm90IiAmJiB0aGlzLmJvdF9yb2xlcy5sZW5ndGggPiAwKSB7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLnVzZXJfdHlwZSA9PSAiQm90IiAmJiB0aGlzLmJvdF9yb2xlcy5sZW5ndGggPT0gMCkgew0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgfSwNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmxvYWRfcGVybWlzc2lvbigpOw0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHZhciB2bSA9IHRoaXM7DQogICAgLy8gY29uc29sZS5sb2codGhpcy5wYWdlX25vKTsNCiAgICAkKCIjc2VsZWN0YWxsIikuY2xpY2soZnVuY3Rpb24gKCkgew0KICAgICAgaWYgKCQodGhpcykuaXMoIjpjaGVja2VkIikpIHsNCiAgICAgICAgLy8gJCgnZGl2OmlucHV0JykucHJvcCgnY2hlY2tlZCcsdHJ1ZSk7DQogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIHRydWUpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdm0uY2hlY2tlZF9saXN0ID0gW107DQogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsNCiAgICAgIH0NCiAgICB9KTsNCiAgICAkKCIjaW50ZW50bW9kYWwiKS5vbigiaGlkZGVuLmJzLm1vZGFsIiwgZnVuY3Rpb24gKGUpIHsNCiAgICAgIHZtLmNsZWFyX2ZpZWxkcygpOw0KICAgICAgLy8gdm0udXNlcl90eXBlID0gIlBvcnRhbCI7DQogICAgICB2bS51c2VyX3R5cGVfY2hhbmdlID0gdHJ1ZQ0KICAgICAgdm0uc2VsZWN0X3JvbGVfbmFtZV9kaXNhYmxlID0gZmFsc2UNCiAgICB9KTsNCiAgICAkKCJzZWxlY3QgLmZvcm0tY29udHJvbCIpLm9uKCJjbGljayIsIGZ1bmN0aW9uICgpIHt9KTsNCiAgfSwNCiAgd2F0Y2g6ew0KICAgICAgICBzZWFyY2hfbmFtZSgpew0KICAgICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09PSAiIil7DQogICAgICAgICAgdGhpcy5sb2FkX3Blcm1pc3Npb24oKTsNCiAgICAgICAgICB0aGlzLmlzVmlzaWJsZVNlYXJjaENsZWFyID0gZmFsc2U7DQogICAgICAgICAgfQ0KICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc2VhcmNoX25hbWUgIT09ICIiKXsNCiAgICAgICAgICAgIHRoaXMuaXNWaXNpYmxlU2VhcmNoQ2xlYXIgPSB0cnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgZmlsdGVyX3VzZXJfdHlwZSgpew0KICAgICAgICAgIGlmKHRoaXMuZmlsdGVyX3VzZXJfdHlwZSA9PSAiUG9ydGFsIil7DQogICAgICAgICAgICB0aGlzLmlzU2hvd19wb3J0YWxfcm9sZXMgPSB0cnVlOw0KICAgICAgICAgICAgdGhpcy5pc1Nob3dfYm90X3JvbGVzID0gZmFsc2U7DQogICAgICAgICAgICB0aGlzLnVzZXJfdHlwZSA9ICJQb3J0YWwiDQogICAgICAgICAgICB0aGlzLmxvYWRfcGVybWlzc2lvbigpDQogICAgICAgICAgfWVsc2UgaWYoIHRoaXMuZmlsdGVyX3VzZXJfdHlwZSA9PSAiQm90Iil7DQogICAgICAgICAgICB0aGlzLmlzU2hvd19ib3Rfcm9sZXMgPSB0cnVlOw0KICAgICAgICAgICAgdGhpcy5pc1Nob3dfcG9ydGFsX3JvbGVzID0gZmFsc2U7DQogICAgICAgICAgICB0aGlzLnVzZXJfdHlwZSA9ICJCb3QiDQogICAgICAgICAgICB0aGlzLmxvYWRfcGVybWlzc2lvbigpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGNsZWFyX3NlYXJjaF9uYW1lKCl7DQogICAgICB0aGlzLnNlYXJjaF9uYW1lID0gIiI7DQogICAgfSwNCiAgICByZW1vdmVfc2VsZWN0ZWRfcGVybWlzc2lvbihyZW1vdmVkT3B0aW9uLCBpZCl7DQogICAgICBpZiAocmVtb3ZlZE9wdGlvbi5zdWJfbWVudSA9PSAiRGFzaGJvYXJkIil7DQogICAgICAgIHRvYXN0ci53YXJuaW5nKHRoaXMudGx0KCdwZXJtaXNzaW9uX2Nhbm5vdF9yZW1vdmVfc2VsZWN0X21zZycpKTsNCiAgICAgICAgdGhpcy5hZGRfc2VsZWN0ZWRfcGVybWlzc2lvbihyZW1vdmVkT3B0aW9uLnN1Yl9tZW51KTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGFkZF9zZWxlY3RlZF9wZXJtaXNzaW9uKHJlbW92ZWRPcHRpb24pew0KICAgICAgdGhpcy5zZWxlY3RlZF9wZXJtaXNzaW9ucy51bnNoaWZ0KHsNCiAgICAgICAgc3ViX21lbnU6IHJlbW92ZWRPcHRpb24sDQogICAgICB9KQ0KICAgIH0sDQogICAgbG9hZF9wZXJtaXNzaW9uKCl7DQogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7DQogICAgICB0aGlzLnJvbGVzID0gW107DQogICAgICB0aGlzLnBvcnRhbF9yb2xlcyA9IFtdOw0KICAgICAgdGhpcy5ib3Rfcm9sZXMgPSBbXTsNCiAgICAgIHRoaXMucGVybWlzc2lvbnNfbGlzdCA9W107DQogICAgICB0aGlzLnNlbGVjdGVkX3Blcm1pc3Npb25zID0gW107DQogICAgICB0aGlzLmludGVudGxpc3QgPSBbXQ0KICAgICAgdGhpcy5ib3RfcGVybWlzc2lvbnNfbGlzdCA9IFtdOw0KICAgICAgdGhpcy5wb3J0YWxfcGVybWlzc2lvbnNfbGlzdCA9IFtdOw0KICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOw0KICAgICAgaWYgKA0KICAgICAgICAhdGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpICYmDQogICAgICAgIHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIg0KICAgICAgKSB7DQogICAgICAgIHRvYXN0ci53YXJuaW5nKHRoaXMudGx0KCdwZXJtaXNzaW9uX3NlbGVjdF9jb21wYW55X25hbWVfbXNnJykpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsNCiAgICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7DQogICAgICB9DQogICAgICBpZiAodGhpcy5jb21wYW55bmFtZSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgIGF4aW9zDQogICAgICAgICAgLnBvc3QoDQogICAgICAgICAgICBhcGlfY2FsbHMucm9sZV91cmwoKSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwNCiAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsDQogICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsDQogICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksDQogICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLA0KICAgICAgICAgICAgICBpc1Nob3c6IHRydWUsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9DQogICAgICAgICAgKQ0KICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGFbMV0ubnVtYmVyX29mX3Jvd3M7DQogICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gTWF0aC5jZWlsKHRoaXMubnVtYmVyX29mX3Jvd3MgLyB0aGlzLnBlcl9wYWdlKTsNCiAgICAgICAgICAgIHRoaXMudXBkYXRlX2xpc3QocmVzcG9uc2UuZGF0YSk7DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8DQogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgICBheGlvcw0KICAgICAgICAgIC5wb3N0KA0KICAgICAgICAgICAgYXBpX2NhbGxzLnBvcnRhbF9wZXJtaXNzaW9uc191cmwoKSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwNCiAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsDQogICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsDQogICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksDQogICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLA0KICAgICAgICAgICAgICBpc0Ryb3Bkb3duOiB0cnVlLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLA0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICkNCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAgIHRoaXMuY29tcGxldGVfcm9sZV9saXN0ID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhWzBdLlBvcnRhbC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzcG9uc2UuZGF0YVswXS5Qb3J0YWwubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICB0aGlzLnBvcnRhbF9yb2xlcy5wdXNoKA0KICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YVswXS5Qb3J0YWxbaV0NCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YVswXS5Cb3QubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3BvbnNlLmRhdGFbMF0uQm90Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgdGhpcy5ib3Rfcm9sZXMucHVzaCgNCiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGFbMF0uQm90W2ldDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKChlKSA9PiB7DQogICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwNCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fA0KICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5DQogICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgICAgYXhpb3MNCiAgICAgICAgICAucG9zdCgNCiAgICAgICAgICAgIGFwaV9jYWxscy5wb3J0YWxfcGVybWlzc2lvbnNfdXJsKCksDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsDQogICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLA0KICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLA0KICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LA0KICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywNCiAgICAgICAgICAgICAgaXNHZXRNZW51OiB0cnVlLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLA0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICkNCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAgIHRoaXMubWVudV9saXN0X2Zyb21fYXBpID0gcmVzcG9uc2UuZGF0YS5NZW51Ow0KICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSByZXNwb25zZS5kYXRhLk1lbnU7DQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhtZXNzYWdlKTsNCiAgICAgICAgICAgIGxldCBtZW51ID0ge307DQogICAgICAgICAgICBsZXQgbWFpbl9tZW51X2xpc3QgPSBtZXNzYWdlLmZpbHRlcigoYXJyKSA9PiAoYXJyLklzTWFzdGVyTWVudSA9PSB0cnVlKSAmJiAoYXJyLkVuYWJsZWQgPT0gdHJ1ZSkpOw0KICAgICAgICAgICAgbGV0IG1haW5fbWVudV9saXN0X2ZpbHRlcmVkID0gW10NCiAgICAgICAgICAgIGxldCBzdWJfbWVudV9saXN0ID0gbWVzc2FnZS5maWx0ZXIoKGFycikgPT4gKGFyci5IYXNTdWJNZW51cyA9PSBmYWxzZSkgJiYgKGFyci5FbmFibGVkID09IHRydWUpICYmIChhcnIuSXNTdWJNZW51ID09IHRydWUpKTsNCg0KICAgICAgICAgICAgZm9yIChsZXQgaSA9MCwgbiA9IG1haW5fbWVudV9saXN0Lmxlbmd0aDsgaSA8IG47IGkgKz0gMSkgew0KICAgICAgICAgICAgICBsZXQgbWVudUZpbHRlciA9IHNpZGViYXJpdGVtcy5maWx0ZXIoKHNpZGViYXIpID0+IHsNCiAgICAgICAgICAgICAgICAgIHJldHVybiAoDQogICAgICAgICAgICAgICAgICAgIHNpZGViYXIubmFtZSA9PT0gbWFpbl9tZW51X2xpc3RbaV0uTWVudUl0ZW0gJiYgQm9vbGVhbihzaWRlYmFyLnN2Z19odG1sKQ0KICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgaWYgKG1lbnVGaWx0ZXIubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgbWFpbl9tZW51X2xpc3RfZmlsdGVyZWQucHVzaChtZW51RmlsdGVyWzBdKTsNCiAgICAgICAgICAgICAgICAgIG1lbnVbbWVudUZpbHRlclswXS5uYW1lXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG1lbnVGaWx0ZXJbMF0ubmFtZSwNCiAgICAgICAgICAgICAgICAgICAgbWVudV9saXN0OiBbXQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgaWYgKG1haW5fbWVudV9saXN0W2ldLkhhc1N1Yk1lbnVzID09IGZhbHNlKXsNCiAgICAgICAgICAgICAgICAgICAgICBtZW51W21lbnVGaWx0ZXJbMF0ubmFtZV0ubWVudV9saXN0LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgc3ViX21lbnU6IG1lbnVGaWx0ZXJbMF0ubmFtZQ0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwLCBuID0gc3ViX21lbnVfbGlzdC5sZW5ndGg7IGkgPCBuOyBpICs9IDEpew0KICAgICAgICAgICAgICAgIGZvciAodmFyIGogaW4gc2lkZWJhcml0ZW1zKSB7DQogICAgICAgICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgICAgICAgIChzaWRlYmFyaXRlbXNbal0ubmFtZSA9PT0gc3ViX21lbnVfbGlzdFtpXS5NZW51SXRlbSkgJiYNCiAgICAgICAgICAgICAgICAgIChCb29sZWFuKHNpZGViYXJpdGVtc1tqXS5wYWdlX3BhdGggJiYgc2lkZWJhcml0ZW1zW2pdLm1hc3Rlcl9tZW51ID09PSBzdWJfbWVudV9saXN0W2ldLk1hc3Rlck1lbnUpKQ0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2lkZWJhcml0ZW1zW2pdLm5hbWUpDQogICAgICAgICAgICAgICAgICBsZXQgdGVtcF92YXIgPSB7DQogICAgICAgICAgICAgICAgICAgIHN1Yl9tZW51OiBzaWRlYmFyaXRlbXNbal0ubmFtZQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgbWVudVtzdWJfbWVudV9saXN0W2ldLk1hc3Rlck1lbnVdLm1lbnVfbGlzdC5wdXNoKHRlbXBfdmFyKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBjYXRjaChlKSB7DQogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGUpOw0KICAgICAgICAgICAgICAvLyBkZWJ1Z2dlcjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG1lbnUgPSBPYmplY3QudmFsdWVzKG1lbnUpDQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhtZW51KTsNCiAgICAgICAgICAgIC8vIG1lbnUgPSBbXTsNCiAgICAgICAgICAgIC8vIHZhciB0aXRsZSA9IFtdOw0KICAgICAgICAgICAgLy8gdmFyIHN1Ym1lbnVzID0gW107DQogICAgICAgICAgICAvLyBmb3IgKGxldCBpID0gMCwgbiA9IHJlc3BvbnNlLmRhdGEuTWVudS5sZW5ndGg7IGkgPCBuOyBpICs9IDEpIHsNCiAgICAgICAgICAgIC8vICAgaWYgKA0KICAgICAgICAgICAgLy8gICAgIHJlc3BvbnNlLmRhdGEuTWVudVtpXS5IYXNTdWJNZW51cyA9PSBmYWxzZSAmJg0KICAgICAgICAgICAgLy8gICAgIHJlc3BvbnNlLmRhdGEuTWVudVtpXS5Jc01hc3Rlck1lbnUNCiAgICAgICAgICAgIC8vICAgKSB7DQogICAgICAgICAgICAvLyAgICAgZm9yICh2YXIgaiBpbiBzaWRlYmFyaXRlbXMpIHsNCiAgICAgICAgICAgIC8vICAgICAgIGlmIChzaWRlYmFyaXRlbXNbal0ubmFtZSA9PT0gcmVzcG9uc2UuZGF0YS5NZW51W2ldLk1lbnVJdGVtKSB7DQogICAgICAgICAgICAvLyAgICAgICAgIHRpdGxlID0gc2lkZWJhcml0ZW1zW2pdLm5hbWU7DQogICAgICAgICAgICAvLyAgICAgICAgIHN1Ym1lbnVzLnB1c2goew0KICAgICAgICAgICAgLy8gICAgICAgICAgIHN1Yl9tZW51OiBzaWRlYmFyaXRlbXNbal0ubmFtZSwNCiAgICAgICAgICAgIC8vICAgICAgICAgfSk7DQogICAgICAgICAgICAvLyAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLk1lbnVbaV0uRW5hYmxlZCkgew0KICAgICAgICAgICAgLy8gICAgICAgICAgIHRoaXMuc2VsZWN0ZWRfcGVybWlzc2lvbnMucHVzaCh7DQogICAgICAgICAgICAvLyAgICAgICAgICAgICBzdWJfbWVudTogc2lkZWJhcml0ZW1zW2pdLm5hbWUsDQogICAgICAgICAgICAvLyAgICAgICAgICAgfSk7DQogICAgICAgICAgICAvLyAgICAgICAgIH0NCiAgICAgICAgICAgIC8vICAgICAgIH0NCiAgICAgICAgICAgIC8vICAgICB9DQogICAgICAgICAgICAvLyAgIH0gZWxzZSBpZiAoDQogICAgICAgICAgICAvLyAgICAgcmVzcG9uc2UuZGF0YS5NZW51W2ldLkhhc1N1Yk1lbnVzID09IHRydWUgJiYNCiAgICAgICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhLk1lbnVbaV0uSXNNYXN0ZXJNZW51DQogICAgICAgICAgICAvLyAgICkgew0KICAgICAgICAgICAgLy8gICAgIGZvciAodmFyIGogaW4gc2lkZWJhcml0ZW1zKSB7DQogICAgICAgICAgICAvLyAgICAgICBpZiAoc2lkZWJhcml0ZW1zW2pdLm5hbWUgPT09IHJlc3BvbnNlLmRhdGEuTWVudVtpXS5NZW51SXRlbSkgew0KICAgICAgICAgICAgLy8gICAgICAgICB0aXRsZSA9IHNpZGViYXJpdGVtc1tqXS5uYW1lOw0KICAgICAgICAgICAgLy8gICAgICAgfQ0KICAgICAgICAgICAgLy8gICAgIH0NCiAgICAgICAgICAgIC8vICAgfSBlbHNlIGlmICgNCiAgICAgICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhLk1lbnVbaV0uSGFzU3ViTWVudXMgPT0gZmFsc2UgJiYNCiAgICAgICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhLk1lbnVbaV0uSXNTdWJNZW51DQogICAgICAgICAgICAvLyAgICkgew0KICAgICAgICAgICAgLy8gICAgIGZvciAodmFyIGogaW4gc2lkZWJhcml0ZW1zKSB7DQogICAgICAgICAgICAvLyAgICAgICBpZiAoc2lkZWJhcml0ZW1zW2pdLm5hbWUgPT09IHJlc3BvbnNlLmRhdGEuTWVudVtpXS5NZW51SXRlbSkgew0KICAgICAgICAgICAgLy8gICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5NZW51W2ldLkVuYWJsZWQpIHsNCiAgICAgICAgICAgIC8vICAgICAgICAgICB0aGlzLnNlbGVjdGVkX3Blcm1pc3Npb25zLnB1c2goew0KICAgICAgICAgICAgLy8gICAgICAgICAgICAgc3ViX21lbnU6IHNpZGViYXJpdGVtc1tqXS5uYW1lLA0KICAgICAgICAgICAgLy8gICAgICAgICAgIH0pOw0KICAgICAgICAgICAgLy8gICAgICAgICB9DQogICAgICAgICAgICAvLyAgICAgICAgIHN1Ym1lbnVzLnB1c2goew0KICAgICAgICAgICAgLy8gICAgICAgICAgIHN1Yl9tZW51OiBzaWRlYmFyaXRlbXNbal0ubmFtZSwNCiAgICAgICAgICAgIC8vICAgICAgICAgfSk7DQogICAgICAgICAgICAvLyAgICAgICB9DQogICAgICAgICAgICAvLyAgICAgfQ0KICAgICAgICAgICAgLy8gICB9DQogICAgICAgICAgICAvLyAgIGlmIChpID09PSBuIC0gMSkgew0KICAgICAgICAgICAgLy8gICAgIG1lbnUucHVzaCh7DQogICAgICAgICAgICAvLyAgICAgICB0aXRsZTogdGl0bGUsDQogICAgICAgICAgICAvLyAgICAgICBtZW51X2xpc3Q6IHN1Ym1lbnVzLA0KICAgICAgICAgICAgLy8gICAgIH0pOw0KICAgICAgICAgICAgLy8gICAgIHRpdGxlID0gW107DQogICAgICAgICAgICAvLyAgICAgc3VibWVudXMgPSBbXTsNCiAgICAgICAgICAgIC8vICAgfSBlbHNlIGlmICgNCiAgICAgICAgICAgIC8vICAgICBpIDwgbiAtIDEgJiYNCiAgICAgICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhLk1lbnVbaSArIDFdLkhhc1N1Yk1lbnVzID09IHRydWUgJiYNCiAgICAgICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhLk1lbnVbaSArIDFdLklzTWFzdGVyTWVudQ0KICAgICAgICAgICAgLy8gICApIHsNCiAgICAgICAgICAgIC8vICAgICBtZW51LnB1c2goew0KICAgICAgICAgICAgLy8gICAgICAgdGl0bGU6IHRpdGxlLA0KICAgICAgICAgICAgLy8gICAgICAgbWVudV9saXN0OiBzdWJtZW51cywNCiAgICAgICAgICAgIC8vICAgICB9KTsNCiAgICAgICAgICAgIC8vICAgICB0aXRsZSA9IFtdOw0KICAgICAgICAgICAgLy8gICAgIHN1Ym1lbnVzID0gW107DQogICAgICAgICAgICAvLyAgIH0NCiAgICAgICAgICAgIC8vIH0NCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG1lbnUpOw0KICAgICAgICAgICAgdGhpcy5wb3J0YWxfcGVybWlzc2lvbnNfbGlzdCA9IG1lbnU7DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8DQogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgYXhpb3MNCiAgICAgICAgLnBvc3QoDQogICAgICAgICAgYXBpX2NhbGxzLmdldF90YXNrX2xpc3QoKSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLA0KICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsDQogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLA0KICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwNCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLA0KICAgICAgICAgICAgaXNHZXRNZW51OiB0cnVlLA0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgfQ0KICAgICAgICApDQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgdGhpcy5ib3RfcGVybWlzc2lvbnNfbGlzdC5wdXNoKHsNCiAgICAgICAgICAgICAgcGVybWlzc2lvbnM6IHJlc3BvbnNlLmRhdGFbaV0sDQogICAgICAgICAgICAgIHRvX2JlX2Rpc3BsYXllZDogcmVzcG9uc2UuZGF0YVtpXSwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYm90X3Blcm1pc3Npb25zX2xpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHRoaXMuYm90X3Blcm1pc3Npb25zX2xpc3RbDQogICAgICAgICAgICAgIGkNCiAgICAgICAgICAgIF0udG9fYmVfZGlzcGxheWVkID0gdGhpcy5ib3RfcGVybWlzc2lvbnNfbGlzdFtpXS50b19iZV9kaXNwbGF5ZWQNCiAgICAgICAgICAgICAgLnJlcGxhY2UoL18vZywgIiAiKQ0KICAgICAgICAgICAgICAudG9Mb3dlckNhc2UoKQ0KICAgICAgICAgICAgICAuc3BsaXQoIiAiKQ0KICAgICAgICAgICAgICAubWFwKChzKSA9PiBzLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcy5zdWJzdHJpbmcoMSkpDQogICAgICAgICAgICAgIC5qb2luKCIgIik7DQogICAgICAgICAgICB0aGlzLmJvdF9wZXJtaXNzaW9uc19saXN0Ww0KICAgICAgICAgICAgICBpDQogICAgICAgICAgICBdLnRvX2JlX2Rpc3BsYXllZCA9IHRoaXMuYm90X3Blcm1pc3Npb25zX2xpc3RbDQogICAgICAgICAgICAgIGkNCiAgICAgICAgICAgIF0udG9fYmVfZGlzcGxheWVkLnJlcGxhY2UoL0Zvcm0vZywgIiIpOw0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLnVwZGF0ZV9ib3Rfcm9sZXMoKTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKChlKSA9PiB7DQogICAgICAgICAgaWYgKA0KICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fA0KICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQ0KICAgICAgICAgICkgew0KICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgaWYodGhpcy5maWx0ZXJfdXNlcl90eXBlID09ICJQb3J0YWwiKXsNCiAgICAgICAgYXhpb3MNCiAgICAgICAgICAucG9zdCgNCiAgICAgICAgICAgIGFwaV9jYWxscy5wb3J0YWxfcGVybWlzc2lvbnNfdXJsKCksDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsDQogICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLA0KICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLA0KICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LA0KICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywNCiAgICAgICAgICAgICAgaXNTaG93OiB0aGlzLmlzU2hvd19wb3J0YWxfcm9sZXMsDQogICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLA0KICAgICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9DQogICAgICAgICAgKQ0KICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMucm9sZXMgPSBbXTsNCiAgICAgICAgICAgIHZhciBsaXN0ID0gcmVzcG9uc2UuZGF0YS5Sb2xlUGVybWlzc2lvbkRhdGE7DQogICAgICAgICAgICBmb3IgKHZhciBpIGluIGxpc3QpIHsNCiAgICAgICAgICAgICAgdmFyIHBlcm1pc3Npb25zID0gbGlzdFtpXS5NZW51LmZpbHRlcigobWVudWxpc3QpID0+IHsNCiAgICAgICAgICAgICAgICBpZiAobWVudWxpc3QuRW5hYmxlZCAmJiAhbWVudWxpc3QuSGFzU3ViTWVudXMpIHsNCiAgICAgICAgICAgICAgICAgIHJldHVybiBtZW51bGlzdC5NZW51SXRlbTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICB2YXIgcGVybV9saXN0ID0gW107DQogICAgICAgICAgICAgIGZvciAodmFyIGogaW4gcGVybWlzc2lvbnMpIHsNCiAgICAgICAgICAgICAgICBwZXJtX2xpc3QucHVzaChwZXJtaXNzaW9uc1tqXS5NZW51SXRlbSk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgdGhpcy5yb2xlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICB1c2VyX3JvbGU6IGxpc3RbaV0uUm9sZSwNCiAgICAgICAgICAgICAgICB1c2VyOiBsaXN0W2ldLlVzZXJUeXBlLA0KICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zOiBwZXJtX2xpc3QsDQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnZWNvdW50Ow0KICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKDEpOw0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKChlKSA9PiB7DQogICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwNCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fA0KICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5DQogICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIGF4aW9zDQogICAgICAgIC5wb3N0KA0KICAgICAgICAgIGFwaV9jYWxscy5zaG93X2ludGVudF91cmwoKSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLA0KICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsDQogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLA0KICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwNCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLA0KICAgICAgICAgICAgZ2V0X2ludGVudHM6IHRydWUsDQogICAgICAgICAgICBzaG93aW50ZW50OiAiVHJ1ZSIsDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICB9DQogICAgICAgICkNCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhKSB7DQogICAgICAgICAgICB0aGlzLmludGVudGxpc3QucHVzaCh7DQogICAgICAgICAgICAgIC8vIHBlcm1pc3Npb25zOiByZXNwb25zZS5kYXRhW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKSwNCiAgICAgICAgICAgICAgLy8gdG9fYmVfZGlzcGxheWVkOiByZXNwb25zZS5kYXRhW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKSwNCiAgICAgICAgICAgICAgcGVybWlzc2lvbnM6IHJlc3BvbnNlLmRhdGFbaV0sDQogICAgICAgICAgICAgIHRvX2JlX2Rpc3BsYXllZDogcmVzcG9uc2UuZGF0YVtpXSwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKChlKSA9PiB7DQogICAgICAgICAgaWYgKA0KICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fA0KICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQ0KICAgICAgICAgICkgew0KICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgc3ZnX2VuYWJsZSh2YWx1ZSkgew0KICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnNlbGVjdGVkX3JvbGUpIHsNCiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRfcm9sZVtpXS5zdWJfbWVudSA9PSB2YWx1ZSkgew0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXR1cm4gImRpc3BsYXk6bm9uZSI7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgIHNlbGVjdGVkX3JvbGVzKGluZGV4KSB7DQogICAgICBpZiAoaW5kZXggPT0gImFsbCIpIHsNCiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7DQogICAgICAgICAgdmFyIHRlbXAgPSB0aGlzLnJvbGVzOw0KICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gdGVtcDsNCiAgICAgICAgfSBlbHNlIGlmICghZXZlbnQudGFyZ2V0LmNoZWNrZWQpIHsNCiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOw0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNoZWNrZWQgPT0gdHJ1ZSkgew0KICAgICAgICAgIGxldCB2YWxfaW5kZXggPSB0aGlzLmNoZWNrZWRfbGlzdC5pbmRleE9mKHRoaXMucm9sZXNbaW5kZXhdKTsNCiAgICAgICAgICB2YXIgdGVtcCA9IHRoaXMucm9sZXNbaW5kZXhdOw0KICAgICAgICAgIGlmICh2YWxfaW5kZXggPT0gLTEpIHsNCiAgICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0LnB1c2godGVtcCk7DQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkID09IGZhbHNlKSB7DQogICAgICAgICAgdmFyIHNlbGVjdGFsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNzZWxlY3RhbGwiKTsNCiAgICAgICAgICBpZiAoc2VsZWN0YWxsLmNoZWNrZWQgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgc2VsZWN0YWxsLmNoZWNrZWQgPSBmYWxzZTsNCiAgICAgICAgICB9DQogICAgICAgICAgdmFyIHRlbXAgPSB0aGlzLmNoZWNrZWRfbGlzdC5maWx0ZXIoKHJvbGVzKSA9PiB7DQogICAgICAgICAgICByZXR1cm4gcm9sZS5yb2xlICE9PSBpbmRleDsNCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRlbXA7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgIHJvbGVfbW9kYWwodHlwZSkgew0KICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgIC8vIGRlYnVnZ2VyOw0KICAgICAgLy8gaWYodHlwZSA9PSAndG9nZ2xlJyl7DQogICAgICBpZiAodGhpcy51c2VyX3R5cGUgPT09IG51bGwpIHsNCiAgICAgICAgLy8gdG9hc3RyLmVycm9yKCJQbGVhc2Ugc2VsZWN0IGVpdGhlciBvZiB0aGUgVXNlciBUeXBlcyIpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5yb2xlX2xpc3QgPSB0aGlzLmNvbXBsZXRlX3JvbGVfbGlzdFt0aGlzLnVzZXJfdHlwZV07DQogICAgICB9DQogICAgICBpZiAodGhpcy51c2VyX3R5cGUgPT0gIlBvcnRhbCIpIHsNCiAgICAgICAgaWYgKHRoaXMucG9ydGFsX3JvbGVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICB0aGlzLnJvbGVfbGlzdCA9IHRoaXMuY29tcGxldGVfcm9sZV9saXN0WyJQb3J0YWwiXTsNCiAgICAgICAgICB0aGlzLnBlcm1pc3Npb25zX2xpc3QgPSB0aGlzLnBvcnRhbF9wZXJtaXNzaW9uc19saXN0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRvYXN0ci5lcnJvcih0aGlzLnRsdCgncGVybWlzc2lvbl9ub19yb2xlc19wb3J0YWxfdHlwZV9tc2cnKSk7DQogICAgICAgIH0NCiAgICAgIH0gZWxzZSBpZiAodGhpcy51c2VyX3R5cGUgPT0gIkJvdCIpIHsNCiAgICAgICAgaWYgKHRoaXMuYm90X3JvbGVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICB0aGlzLnJvbGVfbGlzdCA9IHRoaXMuY29tcGxldGVfcm9sZV9saXN0WyJCb3QiXTsNCiAgICAgICAgICB0aGlzLnBlcm1pc3Npb25zX2xpc3QgPSBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIFR5cGU6ICJBY3Rpb25zIiwNCiAgICAgICAgICAgICAgRGV0YWlsczogdGhpcy5ib3RfcGVybWlzc2lvbnNfbGlzdCwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIFR5cGU6ICJJbnRlbnRzIiwNCiAgICAgICAgICAgICAgRGV0YWlsczogdGhpcy5pbnRlbnRsaXN0LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICBdOw0KICAgICAgICAgIHRoaXMuc2VsZWN0ZWRfcGVybWlzc2lvbnMgPSAiIjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBTd2FsLmZpcmUoew0KICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ3Blcm1pc3Npb25fbm9fcm9sZXNfYm90X3R5cGVfbXNnJyksDQogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsDQogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwNCiAgICAgICAgICAgIHRpbWVyOiA2MDAwLA0KICAgICAgICAgIH0pOw0KICAgICAgICAgIC8vIHRvYXN0ci53YXJuaW5nKCJObyBSb2xlcyBBZGRlZCBmb3IgQm90IFVzZXIgVHlwZS4gUGxlYXNlIEFkZCBhIFJvbGUgZnJvbSB0aGUgJ1JvbGVzJyBQYWdlIHRvIGNvbnRpbnVlIGFkZGluZyBQZXJtaXNzaW9ucy4iKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgDQogICAgICBpZiAodHlwZSA9PSAib3BlbiIpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RlZF9yb2xlID0gIiI7DQogICAgICAgIHRoaXMuc2VsZWN0ZWRfcGVybWlzc2lvbnMgPSBbXTsNCiAgICAgICAgdGhpcy51c2VyX3R5cGVfY2hhbmdlID0gZmFsc2U7DQogICAgICAgIC8vIGlmICh0aGlzLnBvcnRhbF9yb2xlcy5sZW5ndGggPiAwIHx8IHRoaXMuYm90X3JvbGVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgaWYgKHRoaXMuYm90X3JvbGVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAvLyB0aGlzLmNsZWFyX2ZpZWxkcygpDQogICAgICAgICAgJCgiI2ludGVudG1vZGFsIikubW9kYWwoInNob3ciKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAvLyB0b2FzdHIuZXJyb3IoDQogICAgICAgICAgLy8gICAiUGxlYXNlIEFkZCBhIFJvbGUgZnJvbSB0aGUgJ1JvbGVzJyBQYWdlIHRvIGNvbnRpbnVlIGFkZGluZyBQZXJtaXNzaW9ucyINCiAgICAgICAgICAvLyApOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICBkZWxldGVfc2VsZWN0ZWQoKSB7DQogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgbGV0IHJvbGVsaXN0ID0gW10sDQogICAgICAgIHJlc3RyaWN0aW9ubGlzdCA9IFtdOw0KICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnJvbGVzKSB7DQogICAgICAgIHJvbGVsaXN0LnB1c2godGhpcy5yb2xlc1tpbmRleF0ucm9sZSk7DQogICAgICAgIHJlc3RyaWN0aW9ubGlzdC5wdXNoKHRoaXMucm9sZXNbaW5kZXhdLnBlcm1pc3Npb25zKTsNCiAgICAgIH0NCiAgICAgIHRoaXMuZGVsZXRlX3Fuc19hcGkocm9sZWxpc3QsIHJlc3RyaWN0aW9ubGlzdCk7DQogICAgfSwNCiAgICBkZWxldGVfcm9sZShpbmRleCkgew0KICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICB9LA0KICAgIGVkaXRfbW9kYWwoaW5kZXgpIHsNCiAgICAgIHRoaXMudXNlcl90eXBlX2NoYW5nZSA9IGZhbHNlOw0KICAgICAgdGhpcy5zZWxlY3Rfcm9sZV9uYW1lX2Rpc2FibGUgPSB0cnVlOw0KICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3BvcnRhbF9ib3giKS5kaXNhYmxlZCA9IHRydWU7DQogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjYm90X2JveCIpLmRpc2FibGVkID0gdHJ1ZTsNCiAgICAgIHRoaXMuc2VsZWN0ZWRfcm9sZSA9IHRoaXMucm9sZXNbaW5kZXhdLnVzZXJfcm9sZTsNCiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucm9sZXNbaW5kZXhdLnVzZXJfcm9sZSk7DQogICAgICB0aGlzLnVzZXJfdHlwZSA9IHRoaXMucm9sZXNbaW5kZXhdLnVzZXIucmVwbGFjZSgiIFVzZXIiLCAiIik7DQogICAgICB0aGlzLnNlbGVjdGVkX3Blcm1pc3Npb25zID0gW107DQogICAgICBpZiAodGhpcy51c2VyX3R5cGUgPT0gIkJvdCIpIHsNCiAgICAgICAgLy8gdGhpcy5wZXJtaXNzaW9uc19saXN0ID0gdGhpcy5ib3RfcGVybWlzc2lvbnNfbGlzdDsNCiAgICAgICAgdGhpcy5wZXJtaXNzaW9uc19saXN0ID0gWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIFR5cGU6ICJBY3Rpb25zIiwNCiAgICAgICAgICAgIERldGFpbHM6IHRoaXMuYm90X3Blcm1pc3Npb25zX2xpc3QsDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBUeXBlOiAiSW50ZW50cyIsDQogICAgICAgICAgICBEZXRhaWxzOiB0aGlzLmludGVudGxpc3QsDQogICAgICAgICAgfSwNCiAgICAgICAgXTsNCiAgICAgIH0gZWxzZSBpZiAodGhpcy51c2VyX3R5cGUgPT0gIlBvcnRhbCIpIHsNCiAgICAgICAgdGhpcy5wZXJtaXNzaW9uc19saXN0ID0gdGhpcy5wb3J0YWxfcGVybWlzc2lvbnNfbGlzdDsNCiAgICAgIH0NCiAgICAgIGZvciAodmFyIGogaW4gdGhpcy5yb2xlc1tpbmRleF0ucGVybWlzc2lvbnMpIHsNCiAgICAgICAgaWYgKHRoaXMudXNlcl90eXBlID09ICJCb3QiKSB7DQogICAgICAgICAgdGhpcy5zZWxlY3RlZF9wZXJtaXNzaW9ucy5wdXNoKHsNCiAgICAgICAgICAgIHBlcm1pc3Npb25zOiB0aGlzLnJvbGVzW2luZGV4XS5vcmlnaW5hbF9wZXJtaXNzaW9uc1tqXSwNCiAgICAgICAgICAgIHRvX2JlX2Rpc3BsYXllZDogdGhpcy5yb2xlc1tpbmRleF0ucGVybWlzc2lvbnNbal0sDQogICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSBpZiAodGhpcy51c2VyX3R5cGUgPT0gIlBvcnRhbCIpIHsNCiAgICAgICAgICB0aGlzLnNlbGVjdGVkX3Blcm1pc3Npb25zLnB1c2goew0KICAgICAgICAgICAgc3ViX21lbnU6IHRoaXMucm9sZXNbaW5kZXhdLnBlcm1pc3Npb25zW2pdLA0KICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICB9DQogICAgICB0aGlzLnJvbGVfbGlzdCA9IHRoaXMuY29tcGxldGVfcm9sZV9saXN0W3RoaXMudXNlcl90eXBlXTsNCiAgICB9LA0KICAgIHBhZ2VfcmVxdWlyZShwYWdlKSB7DQogICAgICBpZiAocGFnZSA9PSAwIHx8IHBhZ2UgPT0gdGhpcy50b3RhbF9wYWdlcyArIDEpIHsNCiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09ICIiKSB7DQogICAgICAgICAgaWYgKHRoaXMuZmlsdGVyX3VzZXJfdHlwZSA9PSAiUG9ydGFsIil7DQogICAgICAgICAgICBpZiAocGFnZSA9PSAiLi4ucyIpIHsNCiAgICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCgxICsgdGhpcy5wYWdlX25vKSAvIDIpOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChwYWdlID09ICIuLi5sIikgew0KICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKHRoaXMudG90YWxfcGFnZXMgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOw0KICAgICAgICAgICAgLy8gdGhpcy5wYWdlX25vID0gcGFnZTsNCiAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsNCiAgICAgICAgICAgICAgYXhpb3MNCiAgICAgICAgICAgICAgICAucG9zdCgNCiAgICAgICAgICAgICAgICAgIGFwaV9jYWxscy5wb3J0YWxfcGVybWlzc2lvbnNfdXJsKCksDQogICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHJvbGU6IHRoaXMudXNlcl9yb2xlLA0KICAgICAgICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwNCiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwNCiAgICAgICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwNCiAgICAgICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwNCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsDQogICAgICAgICAgICAgICAgICAgIGlzU2hvdzogdGhpcy5pc1Nob3dfcG9ydGFsX3JvbGVzLA0KICAgICAgICAgICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sDQogICAgICAgICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLA0KICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLA0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5Sb2xlUGVybWlzc2lvbkRhdGEubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnZWNvdW50Ow0KICAgICAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7DQogICAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IHJlc3BvbnNlLmRhdGEuUm9sZVBlcm1pc3Npb25EYXRhOw0KICAgICAgICAgICAgICAgICAgdGhpcy5yb2xlcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBsaXN0KSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBwZXJtaXNzaW9ucyA9IGxpc3RbaV0uTWVudS5maWx0ZXIoKG1lbnVsaXN0KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKG1lbnVsaXN0LkVuYWJsZWQgJiYgIW1lbnVsaXN0Lkhhc1N1Yk1lbnVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVudWxpc3QuTWVudUl0ZW07DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHBlcm1fbGlzdCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqIGluIHBlcm1pc3Npb25zKSB7DQogICAgICAgICAgICAgICAgICAgICAgcGVybV9saXN0LnB1c2gocGVybWlzc2lvbnNbal0uTWVudUl0ZW0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMucm9sZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgdXNlcl9yb2xlOiBsaXN0W2ldLlJvbGUsDQogICAgICAgICAgICAgICAgICAgICAgdXNlcjogbGlzdFtpXS5Vc2VyVHlwZSwNCiAgICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uczogcGVybV9saXN0LA0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2Vjb3VudDsNCiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0cGFnaW5hdGlvbih0aGlzLnBhZ2Vfbm8pOw0KICAgICAgICAgICAgICAgIH0pICAgICANCiAgICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7DQogICAgICAgICAgICAgICAgaWYgKA0KICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fA0KICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQ0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5maWx0ZXJfdXNlcl90eXBlID09ICJCb3QiKSB7DQogICAgICAgICAgICBpZiAocGFnZSA9PSAiLi4ucyIpIHsNCiAgICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCgxICsgdGhpcy5wYWdlX25vKSAvIDIpOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChwYWdlID09ICIuLi5sIikgew0KICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKHRoaXMudG90YWxfcGFnZXMgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYXhpb3MNCiAgICAgICAgICAgICAgLnBvc3QoDQogICAgICAgICAgICAgICAgYXBpX2NhbGxzLmFkZF9lZGl0X2JvdF9yb2xlKCksDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwNCiAgICAgICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLA0KICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwNCiAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksDQogICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywNCiAgICAgICAgICAgICAgICAgIGlzU2hvdzogdGhpcy5pc1Nob3dfYm90X3JvbGVzLA0KICAgICAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsDQogICAgICAgICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLA0KICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdlY291bnQ7DQogICAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7DQogICAgICAgICAgICAgICAgdGhpcy5yb2xlcyA9IFtdOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YS5Cb3RSb2xlUGVybWlzc2lvbkRhdGEpIHsNCiAgICAgICAgICAgICAgICAgIC8vIGxldCBib3RSb2xlcyA9IHRoaXMuYm90X3JvbGVzLm1hcCgoeyByb2xlIH0pID0+IHsNCiAgICAgICAgICAgICAgICAgIC8vICAgcmV0dXJuIHJvbGU7DQogICAgICAgICAgICAgICAgICAvLyB9KTsNCiAgICAgICAgICAgICAgICAgIC8vIGlmIChib3RSb2xlcy5pbmNsdWRlcyhpKSkgew0KICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYm90X3JvbGVzLmluY2x1ZGVzKGkpKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucm9sZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgdXNlcjogIkJvdCBVc2VyIiwNCiAgICAgICAgICAgICAgICAgICAgICB1c2VyX3JvbGU6IGAke2l9YCwNCiAgICAgICAgICAgICAgICAgICAgICBpbnB1dF9lbmFibGU6IHRydWUsDQogICAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbnM6IHJlc3BvbnNlLmRhdGEuQm90Um9sZVBlcm1pc3Npb25EYXRhW2ldLm1hcCgocmVzKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzDQogICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9fL2csICIgIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLnRvTG93ZXJDYXNlKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCIgIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgocykgPT4gcy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHMuc3Vic3RyaW5nKDEpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbigiICIpOw0KICAgICAgICAgICAgICAgICAgICAgIH0pLA0KICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsX3Blcm1pc3Npb25zOiByZXNwb25zZS5kYXRhLkJvdFJvbGVQZXJtaXNzaW9uRGF0YVtpXSwNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2Vjb3VudDsNCiAgICAgICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsNCiAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7DQogICAgICAgICAgICAgICAgaWYgKA0KICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fA0KICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQ0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBpZiAocGFnZSA9PSAiLi4ucyIpIHsNCiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgoMSArIHRoaXMucGFnZV9ubykgLyAyKTsNCiAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2UgPT0gIi4uLmwiKSB7DQogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKHRoaXMudG90YWxfcGFnZXMgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHBhZ2U7DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsNCiAgICAgICAgICBheGlvcw0KICAgICAgICAgICAgLnBvc3QoDQogICAgICAgICAgICAgIGFwaV9jYWxscy5wb3J0YWxfcGVybWlzc2lvbnNfdXJsKCksDQogICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLA0KICAgICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLA0KICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksDQogICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwNCiAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywNCiAgICAgICAgICAgICAgICBpc3NlYXJjaDogdHJ1ZSwNCiAgICAgICAgICAgICAgICBrZXk6IHRoaXMuc2VhcmNoX25hbWUsDQogICAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsDQogICAgICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLA0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7DQogICAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgICByZXNwb25zZS5kYXRhICE9ICJ0b2tlbiBpbnZhbGlkIiAmJg0KICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEgIT0gbnVsbCAmJg0KICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuTVNHICE9ICJObyBSZXN1bHRzIEZvdW5kIiAmJg0KICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuTVNHICE9ICJJbnRybmFsIFNlcnZlciBFcnJvciINCiAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgdmFyIGxpc3QgPSByZXNwb25zZS5kYXRhLlJvbGVQZXJtaXNzaW9uRGF0YTsNCiAgICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5Sb2xlUGVybWlzc2lvbkRhdGEubGVuZ3RoOw0KICAgICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2VfY291bnQ7DQogICAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7DQogICAgICAgICAgICAgICAgdGhpcy5yb2xlcyA9IFtdOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gbGlzdCkgew0KICAgICAgICAgICAgICAgICAgdmFyIHBlcm1pc3Npb25zID0gbGlzdFtpXS5NZW51LmZpbHRlcigobWVudWxpc3QpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG1lbnVsaXN0LkVuYWJsZWQgJiYgIW1lbnVsaXN0Lkhhc1N1Yk1lbnVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lbnVsaXN0Lk1lbnVJdGVtOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIHZhciBwZXJtX2xpc3QgPSBbXTsNCiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogaW4gcGVybWlzc2lvbnMpIHsNCiAgICAgICAgICAgICAgICAgICAgcGVybV9saXN0LnB1c2gocGVybWlzc2lvbnNbal0uTWVudUl0ZW0pOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgdGhpcy5yb2xlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgdXNlcl9yb2xlOiBsaXN0W2ldLlJvbGUsDQogICAgICAgICAgICAgICAgICAgIHVzZXI6IGxpc3RbaV0uVXNlclR5cGUsDQogICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zOiBwZXJtX2xpc3QsDQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgLy8gZWxzZSBpZihyZXNwb25zZS5kYXRhLk1TRz09J05vIFJlc3VsdHMgRm91bmQnKXsNCiAgICAgICAgICAgICAgLy8gICB0b2FzdHIuZXJyb3IoIk5vIHJvbGUgZm91bmQiKTsNCiAgICAgICAgICAgICAgLy8gICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgLy8gICAgICAgdGhpcy4kcm91dGVyLmdvKCk7DQogICAgICAgICAgICAgIC8vICAgICB9LCAyNTAwKTsNCiAgICAgICAgICAgICAgLy8gfQ0KICAgICAgICAgICAgICAvLyBlbHNlIGlmKHJlc3BvbnNlLmRhdGEuTVNHPT0nSW50cm5hbCBTZXJ2ZXIgRXJyb3InKXsNCiAgICAgICAgICAgICAgLy8gICB0b2FzdHIuZXJyb3IoIkludHJuYWwgU2VydmVyIEVycm9yIik7DQogICAgICAgICAgICAgIC8vICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgIC8vICAgICAgIHRoaXMuJHJvdXRlci5nbygpOw0KICAgICAgICAgICAgICAvLyAgICAgfSwgMjUwMCk7DQogICAgICAgICAgICAgIC8vIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsNCiAgICAgICAgICAgICAgaWYgKA0KICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwNCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8DQogICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQ0KICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQogICAgc2F2ZV9yb2xlKCkgew0KICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRfcm9sZSA9PSAiIiB8fCB0aGlzLnNlbGVjdGVkX3Blcm1pc3Npb25zLmxlbmd0aCA9PSAwKSB7DQogICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRfcm9sZSA9PSAiQWRtaW4iKSB7DQogICAgICAgIHRoaXMuY2xlYXJfZmllbGRzKCk7DQogICAgICB9IGVsc2UgaWYgKHRoaXMudXNlcl90eXBlID09ICJQb3J0YWwiKSB7DQogICAgICAgIHZhciBzZWxlY3RlZF9tZW51ID0gW107DQogICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5zZWxlY3RlZF9wZXJtaXNzaW9ucykgew0KICAgICAgICAgIHNlbGVjdGVkX21lbnUucHVzaCh0aGlzLnNlbGVjdGVkX3Blcm1pc3Npb25zW2ldLnN1Yl9tZW51KTsNCiAgICAgICAgfQ0KICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMubWVudV9saXN0X2Zyb21fYXBpKSB7DQogICAgICAgICAgaWYgKHNlbGVjdGVkX21lbnUuaW5jbHVkZXModGhpcy5tZW51X2xpc3RfZnJvbV9hcGlbaV0uTWVudUl0ZW0pKQ0KICAgICAgICAgICAgdGhpcy5tZW51X2xpc3RfZnJvbV9hcGlbaV0uRW5hYmxlZCA9IHRydWU7DQogICAgICAgICAgZWxzZSB0aGlzLm1lbnVfbGlzdF9mcm9tX2FwaVtpXS5FbmFibGVkID0gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgYXhpb3MNCiAgICAgICAgICAucG9zdCgNCiAgICAgICAgICAgIGFwaV9jYWxscy5wb3J0YWxfcGVybWlzc2lvbnNfdXJsKCksDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsDQogICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLA0KICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLA0KICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LA0KICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywNCiAgICAgICAgICAgICAgaXNFZGl0OiB0cnVlLA0KICAgICAgICAgICAgICByb2xlX25hbWU6IHRoaXMuc2VsZWN0ZWRfcm9sZSwNCiAgICAgICAgICAgICAgdXNlcl90eXBlOiB0aGlzLnVzZXJfdHlwZSArICIgVXNlciIsDQogICAgICAgICAgICAgIG1lbnU6IHRoaXMubWVudV9saXN0X2Zyb21fYXBpLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLA0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICkNCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJVc2VyIFJvbGUgRWRpdGVkIikgew0KICAgICAgICAgICAgICB0b2FzdHIuc3VjY2Vzcyh0aGlzLnRsdCgncGVybWlzc2lvbl91cGRhdGVkX2Zvcl9sb2dpbl9tc2cxJykpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJCgiI2ludGVudG1vZGFsIikubW9kYWwoImhpZGUiKTsNCiAgICAgICAgICAgIHRoaXMubG9hZF9wZXJtaXNzaW9uKCk7DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8DQogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLnVzZXJfdHlwZSA9PSAiQm90Iikgew0KICAgICAgICB2YXIgc2VsZWN0ZWRfbWVudSA9IFtdOw0KICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMuc2VsZWN0ZWRfcGVybWlzc2lvbnMpIHsNCiAgICAgICAgICBzZWxlY3RlZF9tZW51LnB1c2godGhpcy5zZWxlY3RlZF9wZXJtaXNzaW9uc1tpXS5wZXJtaXNzaW9ucyk7DQogICAgICAgIH0NCiAgICAgICAgYXhpb3MNCiAgICAgICAgICAucG9zdCgNCiAgICAgICAgICAgIGFwaV9jYWxscy5hZGRfZWRpdF9ib3Rfcm9sZSgpLA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLA0KICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwNCiAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwNCiAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwNCiAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsDQogICAgICAgICAgICAgIGJvdF9yb2xlX25hbWU6IHRoaXMuc2VsZWN0ZWRfcm9sZSwNCiAgICAgICAgICAgICAgcGVybWlzc2lvbl9saXN0OiBzZWxlY3RlZF9tZW51LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLA0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICkNCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJRdWVyeSBFeGVjdXRlZCBTdWNjZXNzZnVsbHkiKSB7DQogICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKHRoaXMudGx0KCdwZXJtaXNzaW9uX3VwZGF0ZWRfZm9yX2xvZ2luX21zZzInKSk7DQogICAgICAgICAgICAgIHRoaXMubG9hZF9wZXJtaXNzaW9uKCk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIkludGVybmFsIFNlcnZlciBFcnJvciIpIHsNCiAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCdwZXJtaXNzaW9uX2ludGVybmFsX3NlcnZlcl9tc2cnKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAkKCIjaW50ZW50bW9kYWwiKS5tb2RhbCgiaGlkZSIpOw0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKChlKSA9PiB7DQogICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwNCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fA0KICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5DQogICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGVkaXRfcmVzdHJpY3Rpb25zKGluZGV4KSB7DQogICAgICBpZiAodGhpcy5yb2xlc1tpbmRleF0udXNlciAhPSAiIikgew0KICAgICAgICB0aGlzLnJvbGVzW2luZGV4XS5pbnB1dF9lbmFibGUgPSAhdGhpcy5yb2xlc1tpbmRleF0uaW5wdXRfZW5hYmxlOw0KICAgICAgfQ0KICAgICAgdGhpcy5lZGl0ID0gdHJ1ZTsNCiAgICB9LA0KICAgIHVwZGF0ZV9saXN0KHJlc3BvbnNlKSB7DQogICAgICAvLyB0aGlzLnJvbGVzID0gW107DQogICAgICB2YXIgaW5wdXQ7DQogICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZSkNCiAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UucmVzdHJpY3Rpb25saXN0KSB7DQogICAgICAgIGlmIChyZXNwb25zZS5yZXN0cmljdGlvbmxpc3RbaV0gPT0gIiIpIHsNCiAgICAgICAgICBpbnB1dCA9IHRydWU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgaW5wdXQgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnJvbGVzLnB1c2goew0KICAgICAgICAgIHVzZXI6IHJlc3BvbnNlLnJlc3RyaWN0aW9ubGlzdFtpXSwNCiAgICAgICAgICByb2xlOiByZXNwb25zZS5yb2xlbGlzdFtpXSwNCiAgICAgICAgICBpbnB1dF9lbmFibGU6IGlucHV0LA0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KICAgIHVwZGF0ZV9ib3Rfcm9sZXMoKSB7DQogICAgICBpZiAodGhpcy5maWx0ZXJfdXNlcl90eXBlID09ICJCb3QiKXsNCiAgICAgICAgYXhpb3MNCiAgICAgICAgICAucG9zdCgNCiAgICAgICAgICAgIGFwaV9jYWxscy5hZGRfZWRpdF9ib3Rfcm9sZSgpLA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLA0KICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwNCiAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwNCiAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwNCiAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsDQogICAgICAgICAgICAgIGlzU2hvdzogdGhpcy5pc1Nob3dfYm90X3JvbGVzLA0KICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwNCiAgICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLA0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICkNCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7DQogICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdlY291bnQ7DQogICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YS5Cb3RSb2xlUGVybWlzc2lvbkRhdGEpIHsNCiAgICAgICAgICAgICAgLy8gbGV0IGJvdFJvbGVzID0gdGhpcy5ib3Rfcm9sZXMubWFwKCh7IHJvbGUgfSkgPT4gew0KICAgICAgICAgICAgICAvLyAgIHJldHVybiByb2xlOw0KICAgICAgICAgICAgICAvLyB9KTsNCiAgICAgICAgICAgICAgLy8gaWYgKGJvdFJvbGVzLmluY2x1ZGVzKGkpKSB7DQogICAgICAgICAgICAgIGlmICh0aGlzLmJvdF9yb2xlcy5pbmNsdWRlcyhpKSkgew0KICAgICAgICAgICAgICAgIHRoaXMucm9sZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICB1c2VyOiAiQm90IFVzZXIiLA0KICAgICAgICAgICAgICAgICAgdXNlcl9yb2xlOiBgJHtpfWAsDQogICAgICAgICAgICAgICAgICBpbnB1dF9lbmFibGU6IHRydWUsDQogICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uczogcmVzcG9uc2UuZGF0YS5Cb3RSb2xlUGVybWlzc2lvbkRhdGFbaV0ubWFwKChyZXMpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcw0KICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9fL2csICIgIikNCiAgICAgICAgICAgICAgICAgICAgICAudG9Mb3dlckNhc2UoKQ0KICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgiICIpDQogICAgICAgICAgICAgICAgICAgICAgLm1hcCgocykgPT4gcy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHMuc3Vic3RyaW5nKDEpKQ0KICAgICAgICAgICAgICAgICAgICAgIC5qb2luKCIgIik7DQogICAgICAgICAgICAgICAgICB9KSwNCiAgICAgICAgICAgICAgICAgIG9yaWdpbmFsX3Blcm1pc3Npb25zOiByZXNwb25zZS5kYXRhLkJvdFJvbGVQZXJtaXNzaW9uRGF0YVtpXSwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnZWNvdW50Ow0KICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8DQogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQogICAgcGFnaW5hdGlvbl9jbGFzcyhpbmRleCkgew0KICAgICAgaWYgKGluZGV4ID09IHRoaXMucGFnZV9ubykgew0KICAgICAgICByZXR1cm4gIiBhY3RpdmUiOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICIiOw0KICAgICAgfQ0KICAgIH0sDQogICAgY2xlYXJfZmllbGRzKCkgew0KICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3BvcnRhbF9ib3giKS5kaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2JvdF9ib3giKS5kaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgdGhpcy5zZWxlY3RlZF9yb2xlID0gIiI7DQogICAgICB0aGlzLnNlbGVjdGVkX3Blcm1pc3Npb25zID0gW107DQogICAgICAkKCIjaW50ZW50bW9kYWwiKS5tb2RhbCgiaGlkZSIpOw0KICAgIH0sDQogICAgY2FsbHNlYXJjaCgpIHsNCiAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykgew0KICAgICAgICB0aGlzLnNlYXJjaF9wcm9kdWN0KCk7DQogICAgICB9DQogICAgfSwNCiAgICBzZWFyY2hfcHJvZHVjdCgpIHsNCiAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lICE9ICIiKSB7DQogICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsNCiAgICAgICAgYXhpb3MNCiAgICAgICAgICAucG9zdCgNCiAgICAgICAgICAgIGFwaV9jYWxscy5wb3J0YWxfcGVybWlzc2lvbnNfdXJsKCksDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsDQogICAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLA0KICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LA0KICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLA0KICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywNCiAgICAgICAgICAgICAgaXNzZWFyY2g6IHRydWUsDQogICAgICAgICAgICAgIGtleTogdGhpcy5zZWFyY2hfbmFtZSwNCiAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsDQogICAgICAgICAgICAgIHBhZ2Vfbm86IDEsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9DQogICAgICAgICAgKQ0KICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YSAhPSAidG9rZW4gaW52YWxpZCIgJiYNCiAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YSAhPSBudWxsICYmDQogICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuTVNHICE9ICJObyBSZXN1bHRzIEZvdW5kIiAmJg0KICAgICAgICAgICAgICByZXNwb25zZS5kYXRhLk1TRyAhPSAiSW50cm5hbCBTZXJ2ZXIgRXJyb3IiDQogICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgdmFyIGxpc3QgPSByZXNwb25zZS5kYXRhLlJvbGVQZXJtaXNzaW9uRGF0YTsNCiAgICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEuUm9sZVBlcm1pc3Npb25EYXRhLmxlbmd0aDsNCiAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnZV9jb3VudDsNCiAgICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gMTsNCiAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7DQogICAgICAgICAgICAgIHRoaXMucm9sZXMgPSBbXTsNCiAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBsaXN0KSB7DQogICAgICAgICAgICAgICAgdmFyIHBlcm1pc3Npb25zID0gbGlzdFtpXS5NZW51LmZpbHRlcigobWVudWxpc3QpID0+IHsNCiAgICAgICAgICAgICAgICAgIGlmIChtZW51bGlzdC5FbmFibGVkICYmICFtZW51bGlzdC5IYXNTdWJNZW51cykgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVudWxpc3QuTWVudUl0ZW07DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgdmFyIHBlcm1fbGlzdCA9IFtdOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGogaW4gcGVybWlzc2lvbnMpIHsNCiAgICAgICAgICAgICAgICAgIHBlcm1fbGlzdC5wdXNoKHBlcm1pc3Npb25zW2pdLk1lbnVJdGVtKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5yb2xlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgIHVzZXJfcm9sZTogbGlzdFtpXS5Sb2xlLA0KICAgICAgICAgICAgICAgICAgdXNlcjogbGlzdFtpXS5Vc2VyVHlwZSwNCiAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zOiBwZXJtX2xpc3QsDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIk5vIFJlc3VsdHMgRm91bmQiKSB7DQogICAgICAgICAgICAgIHRvYXN0ci5lcnJvcih0aGlzLnRsdCgncGVybWlzc2lvbl9ub19yb2xlX2ZvdW5kX21zZycpKTsNCiAgICAgICAgICAgICAgdGhpcy5sb2FkX3Blcm1pc3Npb24oKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIkludHJuYWwgU2VydmVyIEVycm9yIikgew0KICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IodGhpcy50bHQoJ3Blcm1pc3Npb25faW50ZXJuYWxfc2VydmVyX21zZzInKSk7DQogICAgICAgICAgICAgIHRoaXMubG9hZF9wZXJtaXNzaW9uKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goKGUpID0+IHsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fA0KICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8DQogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCdwZXJtaXNzaW9uX2RhdGFfZm9yX3NlYXJjaF9tc2cnKSk7DQogICAgICB9DQogICAgfSwNCiAgICBzZXRwYWdpbmF0aW9uKHBhZ2Vfbm8pIHsNCiAgICAgIHRoaXMucGFnZV9hcnJheSA9IFtdOw0KICAgICAgaWYgKHRoaXMudG90YWxfcGFnZXMgPD0gNykgew0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgew0KICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IDEpIHsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHsNCiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsNCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7DQogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gdGhpcy50b3RhbF9wYWdlcykgew0KICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsNCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsNCiAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMudG90YWxfcGFnZXMgLSA0OyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7DQogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOw0KICAgICAgICB9DQogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPD0gNCkgew0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZ2Vfbm8gKyAzOyBpKyspIHsNCiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsNCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7DQogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPj0gdGhpcy50b3RhbF9wYWdlcyAtIDQpIHsNCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7DQogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7DQogICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gNDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgew0KICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7DQogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7DQogICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gMzsgaSA8PSBwYWdlX25vICsgMzsgaSsrKSB7DQogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsNCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7DQogICAgICB9DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["Permissions.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8hBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Permissions.vue","sourceRoot":"src/portal/Chatbot/Dashboard/User Management","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"spinner\" id=\"spinner\" v-show=\"spinnerOn\"></div>\r\n    <div class=\"dash-cont\">\r\n      <div class=\"container-fluid\">\r\n        <div class=\"card dash-card\">\r\n          <div\r\n            class=\"card-header d-block d-sm-flex flex-wrap justify-content-between\"\r\n          > \r\n            <div class=\"d-sm-flex justify-content-start\">\r\n              <h4 class=\"mb-sm-0 mr-3\">{{tlt('permission_page_title')}}</h4>\r\n              <div class=\"radio my-auto\">\r\n                <label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    v-model=\"filter_user_type\"\r\n                    value=\"Portal\"\r\n                    id=\"filter_portal_box\"\r\n                  />\r\n                  <span class=\"icn\" id=\"filter_portal_user_radio\"></span>\r\n                  {{tlt('permission_page_portal_label')}}\r\n                </label>\r\n                <label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    v-model=\"filter_user_type\"\r\n                    value=\"Bot\"\r\n                    id=\"filter_bot_box\"\r\n                  />\r\n                  <span class=\"icn\"></span> {{tlt('permission_page_bot_label')}}\r\n                </label>\r\n              </div>\r\n            </div>\r\n            <div class=\"card-act d-flex flex-wrap justify-content-end\">\r\n              <!-- <a href=\"#\" class=\"red-btn\" @click=\"delete_selected\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 14 14\">\r\n                  <path\r\n                    id=\"trash-can-outline\"\r\n                    d=\"M8.375,3v.778H4V5.333h.875V15.444A1.661,1.661,0,0,0,6.625,17h8.75a1.661,1.661,0,0,0,1.75-1.556V5.333H18V3.778H13.625V3H8.375M6.625,5.333h8.75V15.444H6.625V5.333m1.75,1.556v7h1.75v-7H8.375m3.5,0v7h1.75v-7Z\"\r\n                    transform=\"translate(-4 -3)\"\r\n                    fill=\"#fff\"\r\n                  ></path>\r\n                </svg>\r\n                Delete\r\n              </a>-->\r\n\r\n              <!-- for search -harsh -->\r\n              <!-- <input\r\n                class=\"form-control search-bar\"\r\n                id=\"search_bar\"\r\n                placeholder=\"Search here\"\r\n                v-model=\"search_name\"\r\n                v-on:keyup=\"callsearch\"\r\n              />\r\n              <a type=\"button\" v-if=\"isVisibleSearchClear\" class=\"btn bg-transparent mt-auto mb-auto py-0\" \r\n                @click=\"clear_search_name\" style=\"margin-left: -40px; z-index: 10;\">\r\n                <img src=\"/img/close-icn.png\" alt />\r\n              </a>\r\n              <a\r\n                href=\"#\"\r\n                class=\"darkblue-btn\"\r\n                @click=\"search_product\"\r\n                id=\"search_btn\"\r\n              >\r\n                <svg\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  xmlns:xlink=\"http://www.w3.org/1999/xlink\"\r\n                  width=\"14\"\r\n                  height=\"14\"\r\n                >\r\n                  <path\r\n                    d=\"M13.809011327100071,12.965505435601472 L9.30910012117823,8.49330664854199 C10.007392079586584,7.596111589605521 10.38512817619458,6.499157170138106 10.38512817619458,5.345374656726532 c0,-1.3810948891881802 -0.5423458634784514,-2.676086605733705 -1.523073527148749,-3.6524965835014083 c-0.9807276636702976,-0.9764099777677033 -2.287209392305289,-1.5136937750578685 -3.6751296371814526,-1.5136937750578685 s-2.6944019735111544,0.5390058607430178 -3.6751296371814526,1.5136937750578685 C0.5293349766245179,2.667565987539975 -0.011278152465820316,3.9642797675383576 -0.011278152465820316,5.345374656726532 c0,1.3793728257353273 0.5423458634784514,2.6778086691865575 1.523073527148749,3.6524965835014083 C2.492523038353222,9.974281217995648 3.7972720326001044,10.51156501528581 5.18692501186438,10.51156501528581 c1.160932040033745,0 2.2629511108717475,-0.37540983272197437 3.165705727077092,-1.0676793407689171 l4.499911205921844,4.470476723606628 a0.1420842198250257,0.14120920313395363 0 0 0 0.20099718902076805,0 l0.7554721932159904,-0.7490976019910955 a0.1420842198250257,0.14120920313395363 0 0 0 0,-0.19975936053095905 zM7.931576282630728,8.073123166045836 C7.196896902072058,8.80155600660269 6.2231001759542055,9.20279679111746 5.18692501186438,9.20279679111746 s-2.0099718902076775,-0.4012407845147706 -2.744651270766347,-1.1296736250716286 C1.709327094927478,7.342968262036121 1.3055999824978375,6.37516860153268 1.3055999824978375,5.345374656726532 s0.4037271124296458,-1.99931566876244 1.1366737586002036,-2.727748509319298 C3.1769531216567026,1.8891933068503817 4.150749847774562,1.4879525223356067 5.18692501186438,1.4879525223356067 s2.0117046245957884,0.3995187210619175 2.744651270766347,1.1296736250716286 S9.06825004123093,4.315580711920385 9.06825004123093,5.345374656726532 s-0.4037271124296458,1.99931566876244 -1.1366737586002036,2.727748509319298 z\"\r\n                    fill=\"#fff\"\r\n                  />\r\n                </svg>\r\n              </a> -->\r\n\r\n              <a\r\n                href=\"#\"\r\n                class=\"darkblue-btn\"\r\n                data-toggle=\"modal\"\r\n                @click=\"role_modal('open')\"\r\n                id=\"add_permissions_btn\"\r\n                v-if = \"isShow_portal_roles == false\"\r\n              >\r\n                <svg\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  width=\"14\"\r\n                  height=\"13.997\"\r\n                  viewBox=\"0 0 14 13.997\"\r\n                >\r\n                  <path\r\n                    id=\"Union_13\"\r\n                    data-name=\"Union 13\"\r\n                    d=\"M-12684,2058v-5h-5a1,1,0,0,1-1-1,1,1,0,0,1,1-1h5v-5a1,1,0,0,1,1-1,1,1,0,0,1,1,1v5h5a1,1,0,0,1,1,1,1,1,0,0,1-1,1h-5v5a1,1,0,0,1-1,1A1,1,0,0,1-12684,2058Z\"\r\n                    transform=\"translate(12690.001 -2045.002)\"\r\n                    fill=\"#fff\"\r\n                  />\r\n                </svg>\r\n                {{tlt('add_permission_btn')}}\r\n              </a>\r\n            </div>\r\n          </div>\r\n          <div class=\"card-body\">\r\n            <div class=\"table-box\">\r\n              <div class=\"table-responsive\">\r\n                <table class=\"table\">\r\n                  <thead>\r\n                    <tr>\r\n                      <!-- <th scope=\"col\">\r\n                        <div class=\"form-check checkbox checkbox-success\">\r\n                          <label class=\"form-check-label\">\r\n                            <input\r\n                              id=\"selectall\"\r\n                              class=\"form-check-input\"\r\n                              @change=\"selected_roles('all')\"\r\n                              type=\"checkbox\"\r\n                              value\r\n                              required\r\n                            />\r\n                            <span class=\"icn\"></span>\r\n                          </label>\r\n                        </div>\r\n                      </th> -->\r\n                      <th scope=\"col\" style=\"width: 7%\">{{tlt('portal_user_action_header')}}</th>\r\n                      <th scope=\"col\">{{tlt('portal_user_role_name_header')}}</th>\r\n                      <th scope=\"col\">{{tlt('portal_user_user_type_header')}}</th>\r\n                      <th scope=\"col\" class=\"w-50\">{{tlt('portal_user_permissions_header')}}</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    <tr v-if=\"page_no == 1 && isShow_portal_roles == true\">\r\n                      <!-- <th scope=\"row\">\r\n                        <div class=\"form-check checkbox checkbox-success\">\r\n                          <label class=\"form-check-label\">\r\n                            <input class=\"form-check-input\" type=\"checkbox\" />\r\n                            <span class=\"icn\"></span>\r\n                          </label>\r\n                        </div>\r\n                      </th> -->\r\n                      <td class=\"action\"></td>\r\n                      <td>{{tlt('portal_user_admin_label')}}</td>\r\n                      <td>{{tlt('portal_user_type_label')}}</td>\r\n                      <td>{{tlt('portal_user_text')}}</td>\r\n                    </tr>\r\n\r\n                    <tr v-for=\"(role, index) in roles\" :key=\"index\">\r\n                      <!-- <th scope=\"row\">\r\n                        <div class=\"form-check checkbox checkbox-success\">\r\n                          <label class=\"form-check-label\">\r\n                            <input\r\n                              class=\"form-check-input\"\r\n                              @change=\"selected_roles(index)\"\r\n                              :id=\"'check_' + index\"\r\n                              type=\"checkbox\"\r\n                            />\r\n                            <span class=\"icn\"></span>\r\n                          </label>\r\n                        </div>\r\n                      </th> -->\r\n                      <td class=\"action\">\r\n                        <a\r\n                          class=\"#\"\r\n                          style=\"cursor: pointer\"\r\n                          data-toggle=\"modal\"\r\n                          @click=\"edit_modal(index)\"\r\n                          data-target=\"#intentmodal\"\r\n                        >\r\n                          <svg\r\n                            xmlns=\"http://www.w3.org/2000/svg\"\r\n                            width=\"15.392\"\r\n                            height=\"15.392\"\r\n                            viewBox=\"0 0 15.392 15.392\"\r\n                          >\r\n                            <path\r\n                              id=\"square-edit-outline\"\r\n                              d=\"M4.71,3A1.7,1.7,0,0,0,3,4.71V16.682a1.71,1.71,0,0,0,1.71,1.71H16.682a1.71,1.71,0,0,0,1.71-1.71V10.7h-1.71v5.986H4.71V4.71H10.7V3H4.71m10.928.855a.591.591,0,0,0-.41.171L14.185,5.061,16.322,7.2l1.043-1.035a.578.578,0,0,0,0-.812L16.04,4.026a.571.571,0,0,0-.4-.171M13.578,5.668l-6.3,6.311v2.138H9.413l6.3-6.311Z\"\r\n                              transform=\"translate(-3 -3)\"\r\n                              fill=\"#9499ae\"\r\n                            />\r\n                          </svg>\r\n                        </a>\r\n                        <!-- <a href=\"#\" class=\"trash\" @click=\"delete_role(index)\">\r\n                          <svg\r\n                            xmlns=\"http://www.w3.org/2000/svg\"\r\n                            width=\"13.682\"\r\n                            height=\"15.392\"\r\n                            viewBox=\"0 0 13.682 15.392\"\r\n                          >\r\n                            <path\r\n                              id=\"trash-can-outline\"\r\n                              d=\"M8.276,3v.855H4v1.71h.855V16.682a1.71,1.71,0,0,0,1.71,1.71h8.551a1.71,1.71,0,0,0,1.71-1.71V5.565h.855V3.855H13.406V3H8.276M6.565,5.565h8.551V16.682H6.565V5.565m1.71,1.71v7.7h1.71v-7.7H8.276m3.42,0v7.7h1.71v-7.7Z\"\r\n                              transform=\"translate(-4 -3)\"\r\n                              fill=\"#f23d3d\"\r\n                            ></path>\r\n                          </svg>\r\n                        </a>-->\r\n                      </td>\r\n                      <td>{{ role.user_role }}</td>\r\n                      <td>{{ role.user }}</td>\r\n                      <td>\r\n                        <span\r\n                          class=\"multiselect__tag\"\r\n                          v-for=\"(permission, index) in role.permissions\"\r\n                          :key=\"index\"\r\n                          >{{ permission }} &nbsp;</span\r\n                        >\r\n                        <span\r\n                          v-show=\"\r\n                            role.permissions.length == 0 &&\r\n                            role.user == 'Portal User'\r\n                          \"\r\n                          >Please enable access of portal menu to this\r\n                          role.</span\r\n                        >\r\n                        <span\r\n                          v-show=\"\r\n                            role.permissions.length == 0 &&\r\n                            role.user == 'Bot User'\r\n                          \"\r\n                          >Please enable the task which will be accessible by\r\n                          this bot user.</span\r\n                        >\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n              <div\r\n                class=\"modal fade dash-modal\"\r\n                id=\"intentmodal\"\r\n                tabindex=\"-1\"\r\n                role=\"dialog\"\r\n                aria-labelledby=\"intentmodeltitle\"\r\n                aria-hidden=\"true\"\r\n                data-keyboard=\"false\"\r\n                data-backdrop=\"static\"\r\n              >\r\n                <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n                  <div class=\"modal-content\">\r\n                    <div class=\"modal-body\">\r\n                      <div class=\"modal-head d-flex align-items-center\">\r\n                        <div class=\"head-icn\">\r\n                          <img src=\"/img/msg-blue.png\" alt />\r\n                        </div>\r\n                        <h3>{{tlt('permission_model_header')}}</h3>\r\n                      </div>\r\n                      <!-- <button\r\n                        type=\"button\"\r\n                        class=\"close\"\r\n                        data-dismiss=\"modal\"\r\n                        @click=\"clear_fields\"\r\n                        aria-label=\"Close\"\r\n                      >\r\n                        <img src=\"/static/img/close-icn.png\" alt>\r\n                      </button>-->\r\n                      <button\r\n                        @click=\"clear_fields\"\r\n                        type=\"button\"\r\n                        class=\"close\"\r\n                        data-dismiss=\"modal\"\r\n                        aria-label=\"Close\"\r\n                      >\r\n                        <img src=\"/img/close-icn.png\" alt />\r\n                      </button>\r\n                      <div class=\"radio\" style=\"margin-left: 25%\">\r\n                        <label\r\n                        :style=\"user_type === 'Portal'? \r\n                          '':'cursor: not-allowed'\">\r\n                          <input\r\n                            type=\"radio\"\r\n                            @change=\"role_modal('toggle')\"\r\n                            v-model=\"user_type\"\r\n                            value=\"Portal\"\r\n                            id=\"portal_box\"\r\n                            :disabled=\"this.user_type_change != true\"\r\n                          />\r\n                          <span class=\"icn\" id=\"portal_user_radio\"\r\n                          :style=\"user_type === 'Portal'? \r\n                          '':'background: rgb(244 244 244); cursor: not-allowed'\"></span>\r\n                          {{tlt('permission_model_portal_user_label')}}\r\n                        </label>\r\n                        <label\r\n                        :style=\"user_type === 'Bot'? \r\n                          '':'cursor: not-allowed'\">\r\n                          <input\r\n                            type=\"radio\"\r\n                            @change=\"role_modal('toggle')\"\r\n                            id=\"bot_box\"\r\n                            v-model=\"user_type\"\r\n                            value=\"Bot\"\r\n                            :disabled=\"this.user_type_change != true\"\r\n                          />\r\n                          <span class=\"icn\"\r\n                          :style=\"user_type === 'Bot'? \r\n                          '':'background: rgb(244 244 244); cursor: not-allowed'\"></span> {{tlt('permission_model_bot_user_label')}}\r\n                        </label>\r\n                      </div>\r\n                      <form @submit.prevent=\"save_role\" id=\"permissions_form\">\r\n                        <div\r\n                          class=\"form-group\"\r\n                          v-if=\"user_type == 'Bot' && bot_roles.length > 0\"\r\n                        >\r\n                          <label>{{tlt('permission_model_role_name_label')}}</label>\r\n                          <!-- <select\r\n                            v-model=\"selected_role\"\r\n                            class=\"form-control\"\r\n                            id=\"select_role_name\"\r\n                          >\r\n                            <option value disabled>Select Role Name</option>\r\n                            <option\r\n                              v-for=\"(role, index) in bot_roles\"\r\n                              :key=\"index\"\r\n                            >\r\n                              {{ role.role }}\r\n                            </option>\r\n                          </select> -->\r\n                          <multiselect\r\n                            v-model=\"selected_role\"\r\n                            :options=\"bot_roles\"\r\n                            id=\"select_role_name\"\r\n                            :searchable=\"true\"\r\n                            :close-on-select=\"true\"\r\n                            :taggable=\"false\"\r\n                            :multiple=\"false\"\r\n                            placeholder=\"Select Role Name\"\r\n                            :max-height=\"200\"\r\n                            :disabled=\"this.select_role_name_disable ==true\"\r\n                          >\r\n                          <!-- <span>{{ selected_role }}</span> -->\r\n                          </multiselect>\r\n                        </div>\r\n                        <div\r\n                          class=\"form-group\"\r\n                          v-if=\"\r\n                            user_type == 'Portal' && portal_roles.length > 0\r\n                          \"\r\n                        >\r\n                          <label>{{tlt('permission_model_portal_role_label')}}</label>\r\n                          <!-- <select\r\n                            v-model=\"selected_role\"\r\n                            class=\"form-control\"\r\n                            id=\"select_role_name\"\r\n                          >\r\n                            <option value disabled>Select Role Name</option>\r\n                            <option\r\n                              v-for=\"(role, index) in portal_roles\"\r\n                              :key=\"index\"\r\n                            >\r\n                              {{ role.role }}\r\n                            </option>\r\n                          </select> -->\r\n                          <multiselect\r\n                            v-model=\"selected_role\"\r\n                            :options=\"portal_roles\"\r\n                            id=\"select_role_name\"\r\n                            :searchable=\"true\"\r\n                            :close-on-select=\"true\"\r\n                            :taggable=\"false\"\r\n                            :multiple=\"false\"\r\n                            placeholder=\"Select Role Name\"\r\n                            :max-height=\"200\"\r\n                            :disabled=\"this.select_role_name_disable ==true\"\r\n                          >\r\n                          <!-- <span>{{ selected_role }}</span> -->\r\n                          </multiselect>\r\n                        </div>\r\n                        <div\r\n                          class=\"form-group\"\r\n                          v-if=\"check_portal_bot_role_length\"\r\n                        >\r\n                          <label>{{ permissions_title }}</label>\r\n                          <multiselect\r\n                            id=\"role_select\"\r\n                            :close-on-select=\"false\"\r\n                            v-if=\"user_type == 'Portal'\"\r\n                            :taggable=\"true\"\r\n                            :multiple=\"true\"\r\n                            :options=\"permissions_list\"\r\n                            placeholder=\"Select Permissions\"\r\n                            group-values=\"menu_list\"\r\n                            group-label=\"title\"\r\n                            :group-select=\"true\"\r\n                            track-by=\"sub_menu\"\r\n                            label=\"sub_menu\"\r\n                            v-model=\"selected_permissions\"\r\n                            @remove=\"remove_selected_permission\"\r\n                          >\r\n                            <template slot=\"option\" slot-scope=\"props\">\r\n                              <span\r\n                                v-show=\"props.option.$groupLabel === undefined\"\r\n                              >\r\n                                <!-- <svg\r\n                                  :style=\"svg_enable(props.option.sub_menu)\"\r\n                                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                                  style=\"fill:#fff;position: relative\"\r\n                                  width=\"24\"\r\n                                  height=\"24\"\r\n                                  viewBox=\"0 0 24 24\"\r\n                                >\r\n                                  <path d=\"M0 0h24v24H0z\" fill=\"#41b883\"></path>\r\n                                  <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"></path>\r\n                                </svg>-->\r\n                                {{ props.option.sub_menu }}\r\n                              </span>\r\n                              <span\r\n                                v-show=\"props.option.sub_menu === undefined\"\r\n                                >{{ props.option.$groupLabel }}</span\r\n                              >\r\n                            </template>\r\n                            <!-- <template\r\n                              slot=\"option\"\r\n                              slot-scope=\"props\"\r\n                            ></template>-->\r\n                          </multiselect>\r\n                          <multiselect\r\n                            :close-on-select=\"false\"\r\n                            v-if=\"user_type == 'Bot'\"\r\n                            :taggable=\"true\"\r\n                            :multiple=\"true\"\r\n                            :options=\"permissions_list\"\r\n                            placeholder=\"Select Permissions\"\r\n                            track-by=\"permissions\"\r\n                            label=\"to_be_displayed\"\r\n                            group-label=\"Type\"\r\n                            group-values=\"Details\"\r\n                            :group-select=\"true\"\r\n                            v-model=\"selected_permissions\"\r\n                          ></multiselect>\r\n                        </div>\r\n                        <div class=\"btn-wrap text-right\">\r\n                          <button\r\n                            type=\"button\"\r\n                            @click=\"clear_fields\"\r\n                            class=\"btn btn-link\"\r\n                            data-dismiss=\"modal\"\r\n                          >\r\n                            {{tlt('permission_page_edit_cancel_btn')}}\r\n                          </button>\r\n                          <button\r\n                            id=\"save_permissions\"\r\n                            type=\"submit\"\r\n                            class=\"darkblue-btn\"\r\n                          >\r\n                            {{tlt('permission_page_edit_save_btn')}}\r\n                          </button>\r\n                        </div>\r\n                      </form>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"pagin-table\" style=\"margin: 0\">\r\n                <nav aria-label=\"Page navigation example\">\r\n                  <ul class=\"pagination justify-content-center\">\r\n                    <li class=\"page-item\">\r\n                      <a\r\n                        class=\"page-link\"\r\n                        href=\"#\"\r\n                        @click=\"page_require(page_no - 1)\"\r\n                      >\r\n                        <svg\r\n                          xmlns=\"http://www.w3.org/2000/svg\"\r\n                          width=\"8.667\"\r\n                          height=\"15.204\"\r\n                          viewBox=\"0 0 8.667 15.204\"\r\n                        >\r\n                          <g\r\n                            id=\"arrow-point-to-left\"\r\n                            transform=\"translate(105.806 15.204) rotate(180)\"\r\n                          >\r\n                            <path\r\n                              id=\"Path_1136\"\r\n                              data-name=\"Path 1136\"\r\n                              d=\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\"\r\n                              transform=\"translate(0 0)\"\r\n                              fill=\"#9499ae\"\r\n                            />\r\n                          </g>\r\n                        </svg>\r\n                      </a>\r\n                    </li>\r\n                    <li\r\n                      :class=\"'page-item ' + pagination_class(pageno)\"\r\n                      v-for=\"pageno in page_array\"\r\n                      :key=\"pageno\"\r\n                    >\r\n                      <a\r\n                        v-if=\"pageno == '...s' || pageno == '...l'\"\r\n                        class=\"page-link\"\r\n                        href=\"#\"\r\n                        @click=\"page_require(pageno)\"\r\n                        >...</a\r\n                      >\r\n                      <a\r\n                        v-if=\"pageno != '...s' && pageno != '...l'\"\r\n                        class=\"page-link\"\r\n                        href=\"#\"\r\n                        @click=\"page_require(pageno)\"\r\n                        >{{ pageno }}</a\r\n                      >\r\n                      <!-- <a class=\"page-link\" href=\"#\" @click=\"page_require(pageno)\">{{pageno}}</a> -->\r\n                    </li>\r\n                    <li class=\"page-item\">\r\n                      <a\r\n                        class=\"page-link\"\r\n                        href=\"#\"\r\n                        @click=\"page_require(page_no + 1)\"\r\n                      >\r\n                        <svg\r\n                          xmlns=\"http://www.w3.org/2000/svg\"\r\n                          width=\"8.667\"\r\n                          height=\"15.204\"\r\n                          viewBox=\"0 0 8.667 15.204\"\r\n                        >\r\n                          <g\r\n                            id=\"arrow-point-to-right\"\r\n                            transform=\"translate(-97.139 0)\"\r\n                          >\r\n                            <path\r\n                              id=\"Path_1136\"\r\n                              data-name=\"Path 1136\"\r\n                              d=\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\"\r\n                              transform=\"translate(0 0)\"\r\n                              fill=\"#9499ae\"\r\n                            />\r\n                          </g>\r\n                        </svg>\r\n                      </a>\r\n                    </li>\r\n                  </ul>\r\n                </nav>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport Multiselect from \"vue-multiselect\";\r\nimport Swal from \"sweetalert2\";\r\nimport { setTimeout } from \"timers\";\r\nimport sidebaritems from \"../Layout/SideBarItem\";\r\nimport api_calls from \"@/portal/api_calls\";\r\n\r\nexport default {\r\n  name: \"permissions\",\r\n  components: {\r\n    Multiselect,\r\n  },\r\n  data() {\r\n    return {\r\n      user: [],\r\n      roles: [],\r\n      page_no: 1,\r\n      per_page: 10,\r\n      selected_role: \"\",\r\n      selected_permissions: [],\r\n      role_list: [],\r\n      complete_role_list: [],\r\n      permissions_list: [],\r\n      portal_permissions_list: [],\r\n      bot_permissions_list: [],\r\n      intentlist: [],\r\n      checked_list: [],\r\n      number_of_rows: null,\r\n      total_pages: null,\r\n      user_type: \"Portal\",\r\n      menu_list_from_api: null,\r\n      spinnerOn: false,\r\n      companyid:\r\n        this.$session.get(\"UserInformation\").role == \"SuperAdmin\"\r\n          ? this.$session.get(\"CompanyId\")\r\n          : this.$session.get(\"UserInformation\").company_id,\r\n      companyname:\r\n        this.$session.get(\"UserInformation\").role == \"SuperAdmin\"\r\n          ? this.$session.get(\"CompanyName\")\r\n          : this.$session.get(\"UserInformation\").company_name,\r\n      user_role: this.$session.get(\"UserInformation\").role,\r\n      //harsh\r\n      page_array: [],\r\n      search_name: \"\",\r\n      portal_roles: [],\r\n      bot_roles: [],\r\n      isShow_portal_roles: true,\r\n      isShow_bot_roles: false,\r\n      isVisibleSearchClear: false,\r\n      select_role_name_disable: false,\r\n      filter_user_type: \"Portal\",\r\n      user_type_change: true, \r\n    };\r\n  },\r\n  computed: {\r\n    permissions_title() {\r\n      if (this.user_type == \"Portal\") {\r\n        return this.tlt('portal_menu_label');\r\n      } else if (this.user_type == \"Bot\") {\r\n        return this.tlt('bot_intent_label');\r\n      }\r\n    },\r\n    check_portal_bot_role_length() {\r\n      if (this.user_type == \"Portal\" && this.portal_roles.length > 0) {\r\n        return true;\r\n      } else if (this.user_type == \"Portal\" && this.portal_roles.length == 0) {\r\n        return false;\r\n      } else if (this.user_type == \"Bot\" && this.bot_roles.length > 0) {\r\n        return true;\r\n      } else if (this.user_type == \"Bot\" && this.bot_roles.length == 0) {\r\n        return false;\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    this.load_permission();\r\n  },\r\n  mounted() {\r\n    var vm = this;\r\n    // console.log(this.page_no);\r\n    $(\"#selectall\").click(function () {\r\n      if ($(this).is(\":checked\")) {\r\n        // $('div:input').prop('checked',true);\r\n        $(\"input:checkbox\").prop(\"checked\", true);\r\n      } else {\r\n        vm.checked_list = [];\r\n        $(\"input:checkbox\").prop(\"checked\", false);\r\n      }\r\n    });\r\n    $(\"#intentmodal\").on(\"hidden.bs.modal\", function (e) {\r\n      vm.clear_fields();\r\n      // vm.user_type = \"Portal\";\r\n      vm.user_type_change = true\r\n      vm.select_role_name_disable = false\r\n    });\r\n    $(\"select .form-control\").on(\"click\", function () {});\r\n  },\r\n  watch:{\r\n        search_name(){\r\n          if (this.search_name === \"\"){\r\n          this.load_permission();\r\n          this.isVisibleSearchClear = false;\r\n          }\r\n          else if (this.search_name !== \"\"){\r\n            this.isVisibleSearchClear = true;\r\n          }\r\n        },\r\n        filter_user_type(){\r\n          if(this.filter_user_type == \"Portal\"){\r\n            this.isShow_portal_roles = true;\r\n            this.isShow_bot_roles = false;\r\n            this.user_type = \"Portal\"\r\n            this.load_permission()\r\n          }else if( this.filter_user_type == \"Bot\"){\r\n            this.isShow_bot_roles = true;\r\n            this.isShow_portal_roles = false;\r\n            this.user_type = \"Bot\"\r\n            this.load_permission();\r\n          }\r\n        },\r\n  },\r\n  methods: {\r\n    clear_search_name(){\r\n      this.search_name = \"\";\r\n    },\r\n    remove_selected_permission(removedOption, id){\r\n      if (removedOption.sub_menu == \"Dashboard\"){\r\n        toastr.warning(this.tlt('permission_cannot_remove_select_msg'));\r\n        this.add_selected_permission(removedOption.sub_menu);\r\n      }\r\n    },\r\n    add_selected_permission(removedOption){\r\n      this.selected_permissions.unshift({\r\n        sub_menu: removedOption,\r\n      })\r\n    },\r\n    load_permission(){\r\n      this.spinnerOn = true;\r\n      this.roles = [];\r\n      this.portal_roles = [];\r\n      this.bot_roles = [];\r\n      this.permissions_list =[];\r\n      this.selected_permissions = [];\r\n      this.intentlist = []\r\n      this.bot_permissions_list = [];\r\n      this.portal_permissions_list = [];\r\n      $(\"input:checkbox\").prop(\"checked\", false);\r\n      if (\r\n        !this.$session.has(\"CompanyId\") &&\r\n        this.$session.get(\"UserInformation\").role == \"SuperAdmin\"\r\n      ) {\r\n        toastr.warning(this.tlt('permission_select_company_name_msg'));\r\n      } else {\r\n        this.companyid = this.$session.get(\"UserInformation\").company_id;\r\n        this.companyname = this.$session.get(\"UserInformation\").company_name;\r\n      }\r\n      if (this.companyname !== undefined) {\r\n        axios\r\n          .post(\r\n            api_calls.role_url(),\r\n            {\r\n              companyid: this.companyid,\r\n              companyname: this.companyname,\r\n              email: this.$session.get(\"UserInformation\").email,\r\n              license_key: this.$session.get(\"UserInformation\").license_key,\r\n              token: this.$session.get(\"UserInformation\").tokens,\r\n              isShow: true,\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            this.number_of_rows = response.data[1].number_of_rows;\r\n            this.total_pages = Math.ceil(this.number_of_rows / this.per_page);\r\n            this.update_list(response.data);\r\n          })\r\n          .catch((e) => {\r\n            if (\r\n              e.response.status === 410 ||\r\n              e.response.status === 440 ||\r\n              e.response.status === 409\r\n            ) {\r\n              this.$root.$emit(\"Session_Expired\", e.response.data);\r\n            }\r\n          });\r\n        axios\r\n          .post(\r\n            api_calls.portal_permissions_url(),\r\n            {\r\n              companyid: this.companyid,\r\n              companyname: this.companyname,\r\n              email: this.$session.get(\"UserInformation\").email,\r\n              license_key: this.$session.get(\"UserInformation\").license_key,\r\n              token: this.$session.get(\"UserInformation\").tokens,\r\n              isDropdown: true,\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            this.complete_role_list = response.data;\r\n            if (response.data[0].Portal.length > 0) {\r\n              for (let i = 0; i < response.data[0].Portal.length; i++) {\r\n                this.portal_roles.push(\r\n                  response.data[0].Portal[i]\r\n                );\r\n              }\r\n            }\r\n            if (response.data[0].Bot.length > 0) {\r\n              for (let i = 0; i < response.data[0].Bot.length; i++) {\r\n                this.bot_roles.push(\r\n                  response.data[0].Bot[i]\r\n                );\r\n              }\r\n            }\r\n          })\r\n          .catch((e) => {\r\n            if (\r\n              e.response.status === 410 ||\r\n              e.response.status === 440 ||\r\n              e.response.status === 409\r\n            ) {\r\n              this.$root.$emit(\"Session_Expired\", e.response.data);\r\n            }\r\n          });\r\n        axios\r\n          .post(\r\n            api_calls.portal_permissions_url(),\r\n            {\r\n              companyid: this.companyid,\r\n              companyname: this.companyname,\r\n              email: this.$session.get(\"UserInformation\").email,\r\n              license_key: this.$session.get(\"UserInformation\").license_key,\r\n              token: this.$session.get(\"UserInformation\").tokens,\r\n              isGetMenu: true,\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            this.menu_list_from_api = response.data.Menu;\r\n            let message = response.data.Menu;\r\n            // console.log(message);\r\n            let menu = {};\r\n            let main_menu_list = message.filter((arr) => (arr.IsMasterMenu == true) && (arr.Enabled == true));\r\n            let main_menu_list_filtered = []\r\n            let sub_menu_list = message.filter((arr) => (arr.HasSubMenus == false) && (arr.Enabled == true) && (arr.IsSubMenu == true));\r\n\r\n            for (let i =0, n = main_menu_list.length; i < n; i += 1) {\r\n              let menuFilter = sidebaritems.filter((sidebar) => {\r\n                  return (\r\n                    sidebar.name === main_menu_list[i].MenuItem && Boolean(sidebar.svg_html)\r\n                  );\r\n                });\r\n              if (menuFilter.length > 0) {\r\n                  main_menu_list_filtered.push(menuFilter[0]);\r\n                  menu[menuFilter[0].name] = {\r\n                    title: menuFilter[0].name,\r\n                    menu_list: []\r\n                  }\r\n                  if (main_menu_list[i].HasSubMenus == false){\r\n                      menu[menuFilter[0].name].menu_list.push({\r\n                        sub_menu: menuFilter[0].name\r\n                      });\r\n                  }\r\n              }\r\n            }\r\n            try {\r\n              for(let i = 0, n = sub_menu_list.length; i < n; i += 1){\r\n                for (var j in sidebaritems) {\r\n                  if (\r\n                    (sidebaritems[j].name === sub_menu_list[i].MenuItem) &&\r\n                  (Boolean(sidebaritems[j].page_path && sidebaritems[j].master_menu === sub_menu_list[i].MasterMenu))\r\n                ) {\r\n                  // console.log(sidebaritems[j].name)\r\n                  let temp_var = {\r\n                    sub_menu: sidebaritems[j].name\r\n                  }\r\n                  menu[sub_menu_list[i].MasterMenu].menu_list.push(temp_var)\r\n                }\r\n\r\n                }\r\n              }\r\n            } catch(e) {\r\n              // console.log(e);\r\n              // debugger;\r\n            }\r\n            menu = Object.values(menu)\r\n            // console.log(menu);\r\n            // menu = [];\r\n            // var title = [];\r\n            // var submenus = [];\r\n            // for (let i = 0, n = response.data.Menu.length; i < n; i += 1) {\r\n            //   if (\r\n            //     response.data.Menu[i].HasSubMenus == false &&\r\n            //     response.data.Menu[i].IsMasterMenu\r\n            //   ) {\r\n            //     for (var j in sidebaritems) {\r\n            //       if (sidebaritems[j].name === response.data.Menu[i].MenuItem) {\r\n            //         title = sidebaritems[j].name;\r\n            //         submenus.push({\r\n            //           sub_menu: sidebaritems[j].name,\r\n            //         });\r\n            //         if (response.data.Menu[i].Enabled) {\r\n            //           this.selected_permissions.push({\r\n            //             sub_menu: sidebaritems[j].name,\r\n            //           });\r\n            //         }\r\n            //       }\r\n            //     }\r\n            //   } else if (\r\n            //     response.data.Menu[i].HasSubMenus == true &&\r\n            //     response.data.Menu[i].IsMasterMenu\r\n            //   ) {\r\n            //     for (var j in sidebaritems) {\r\n            //       if (sidebaritems[j].name === response.data.Menu[i].MenuItem) {\r\n            //         title = sidebaritems[j].name;\r\n            //       }\r\n            //     }\r\n            //   } else if (\r\n            //     response.data.Menu[i].HasSubMenus == false &&\r\n            //     response.data.Menu[i].IsSubMenu\r\n            //   ) {\r\n            //     for (var j in sidebaritems) {\r\n            //       if (sidebaritems[j].name === response.data.Menu[i].MenuItem) {\r\n            //         if (response.data.Menu[i].Enabled) {\r\n            //           this.selected_permissions.push({\r\n            //             sub_menu: sidebaritems[j].name,\r\n            //           });\r\n            //         }\r\n            //         submenus.push({\r\n            //           sub_menu: sidebaritems[j].name,\r\n            //         });\r\n            //       }\r\n            //     }\r\n            //   }\r\n            //   if (i === n - 1) {\r\n            //     menu.push({\r\n            //       title: title,\r\n            //       menu_list: submenus,\r\n            //     });\r\n            //     title = [];\r\n            //     submenus = [];\r\n            //   } else if (\r\n            //     i < n - 1 &&\r\n            //     response.data.Menu[i + 1].HasSubMenus == true &&\r\n            //     response.data.Menu[i + 1].IsMasterMenu\r\n            //   ) {\r\n            //     menu.push({\r\n            //       title: title,\r\n            //       menu_list: submenus,\r\n            //     });\r\n            //     title = [];\r\n            //     submenus = [];\r\n            //   }\r\n            // }\r\n            // console.log(menu);\r\n            this.portal_permissions_list = menu;\r\n          })\r\n          .catch((e) => {\r\n            if (\r\n              e.response.status === 410 ||\r\n              e.response.status === 440 ||\r\n              e.response.status === 409\r\n            ) {\r\n              this.$root.$emit(\"Session_Expired\", e.response.data);\r\n            }\r\n          });\r\n      }\r\n      axios\r\n        .post(\r\n          api_calls.get_task_list(),\r\n          {\r\n            companyid: this.companyid,\r\n            companyname: this.companyname,\r\n            email: this.$session.get(\"UserInformation\").email,\r\n            license_key: this.$session.get(\"UserInformation\").license_key,\r\n            token: this.$session.get(\"UserInformation\").tokens,\r\n            isGetMenu: true,\r\n          },\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n            },\r\n          }\r\n        )\r\n        .then((response) => {\r\n          for (var i in response.data) {\r\n            this.bot_permissions_list.push({\r\n              permissions: response.data[i],\r\n              to_be_displayed: response.data[i],\r\n            });\r\n          }\r\n          for (let i = 0; i < this.bot_permissions_list.length; i++) {\r\n            this.bot_permissions_list[\r\n              i\r\n            ].to_be_displayed = this.bot_permissions_list[i].to_be_displayed\r\n              .replace(/_/g, \" \")\r\n              .toLowerCase()\r\n              .split(\" \")\r\n              .map((s) => s.charAt(0).toUpperCase() + s.substring(1))\r\n              .join(\" \");\r\n            this.bot_permissions_list[\r\n              i\r\n            ].to_be_displayed = this.bot_permissions_list[\r\n              i\r\n            ].to_be_displayed.replace(/Form/g, \"\");\r\n          }\r\n          this.update_bot_roles();\r\n        })\r\n        .catch((e) => {\r\n          if (\r\n            e.response.status === 410 ||\r\n            e.response.status === 440 ||\r\n            e.response.status === 409\r\n          ) {\r\n            this.$root.$emit(\"Session_Expired\", e.response.data);\r\n          }\r\n        });\r\n      if(this.filter_user_type == \"Portal\"){\r\n        axios\r\n          .post(\r\n            api_calls.portal_permissions_url(),\r\n            {\r\n              companyid: this.companyid,\r\n              companyname: this.companyname,\r\n              email: this.$session.get(\"UserInformation\").email,\r\n              license_key: this.$session.get(\"UserInformation\").license_key,\r\n              token: this.$session.get(\"UserInformation\").tokens,\r\n              isShow: this.isShow_portal_roles,\r\n              per_page: this.per_page,\r\n              page_no: this.page_no,\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            this.spinnerOn = false;\r\n            this.roles = [];\r\n            var list = response.data.RolePermissionData;\r\n            for (var i in list) {\r\n              var permissions = list[i].Menu.filter((menulist) => {\r\n                if (menulist.Enabled && !menulist.HasSubMenus) {\r\n                  return menulist.MenuItem;\r\n                }\r\n              });\r\n              var perm_list = [];\r\n              for (var j in permissions) {\r\n                perm_list.push(permissions[j].MenuItem);\r\n              }\r\n              this.roles.push({\r\n                user_role: list[i].Role,\r\n                user: list[i].UserType,\r\n                permissions: perm_list,\r\n              });\r\n            }\r\n            this.total_pages = response.data.pagecount;\r\n            this.setpagination(1);\r\n          })\r\n          .catch((e) => {\r\n            if (\r\n              e.response.status === 410 ||\r\n              e.response.status === 440 ||\r\n              e.response.status === 409\r\n            ) {\r\n              this.$root.$emit(\"Session_Expired\", e.response.data);\r\n            }\r\n          });\r\n      }\r\n      axios\r\n        .post(\r\n          api_calls.show_intent_url(),\r\n          {\r\n            companyid: this.companyid,\r\n            companyname: this.companyname,\r\n            email: this.$session.get(\"UserInformation\").email,\r\n            license_key: this.$session.get(\"UserInformation\").license_key,\r\n            token: this.$session.get(\"UserInformation\").tokens,\r\n            get_intents: true,\r\n            showintent: \"True\",\r\n          },\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n            },\r\n          }\r\n        )\r\n        .then((response) => {\r\n          for (var i in response.data) {\r\n            this.intentlist.push({\r\n              // permissions: response.data[i].replace(this.companyid + \"_\", \"\"),\r\n              // to_be_displayed: response.data[i].replace(this.companyid + \"_\", \"\"),\r\n              permissions: response.data[i],\r\n              to_be_displayed: response.data[i],\r\n            });\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          if (\r\n            e.response.status === 410 ||\r\n            e.response.status === 440 ||\r\n            e.response.status === 409\r\n          ) {\r\n            this.$root.$emit(\"Session_Expired\", e.response.data);\r\n          }\r\n        });\r\n    },\r\n    svg_enable(value) {\r\n      for (var i in this.selected_role) {\r\n        if (this.selected_role[i].sub_menu == value) {\r\n          return;\r\n        } else {\r\n          return \"display:none\";\r\n        }\r\n      }\r\n    },\r\n    selected_roles(index) {\r\n      if (index == \"all\") {\r\n        if (event.target.checked) {\r\n          var temp = this.roles;\r\n          this.checked_list = temp;\r\n        } else if (!event.target.checked) {\r\n          this.checked_list = [];\r\n        }\r\n      } else {\r\n        if (event.target.checked == true) {\r\n          let val_index = this.checked_list.indexOf(this.roles[index]);\r\n          var temp = this.roles[index];\r\n          if (val_index == -1) {\r\n            this.checked_list.push(temp);\r\n          }\r\n        } else if (event.target.checked == false) {\r\n          var selectall = document.querySelector(\"#selectall\");\r\n          if (selectall.checked == true) {\r\n            selectall.checked = false;\r\n          }\r\n          var temp = this.checked_list.filter((roles) => {\r\n            return role.role !== index;\r\n          });\r\n          this.checked_list = temp;\r\n        }\r\n      }\r\n    },\r\n    role_modal(type) {\r\n      event.preventDefault();\r\n      // debugger;\r\n      // if(type == 'toggle'){\r\n      if (this.user_type === null) {\r\n        // toastr.error(\"Please select either of the User Types\");\r\n      } else {\r\n        this.role_list = this.complete_role_list[this.user_type];\r\n      }\r\n      if (this.user_type == \"Portal\") {\r\n        if (this.portal_roles.length > 0) {\r\n          this.role_list = this.complete_role_list[\"Portal\"];\r\n          this.permissions_list = this.portal_permissions_list;\r\n        } else {\r\n          toastr.error(this.tlt('permission_no_roles_portal_type_msg'));\r\n        }\r\n      } else if (this.user_type == \"Bot\") {\r\n        if (this.bot_roles.length > 0) {\r\n          this.role_list = this.complete_role_list[\"Bot\"];\r\n          this.permissions_list = [\r\n            {\r\n              Type: \"Actions\",\r\n              Details: this.bot_permissions_list,\r\n            },\r\n            {\r\n              Type: \"Intents\",\r\n              Details: this.intentlist,\r\n            },\r\n          ];\r\n          this.selected_permissions = \"\";\r\n        } else {\r\n          Swal.fire({\r\n            text: this.tlt('permission_no_roles_bot_type_msg'),\r\n            type: \"warning\",\r\n            showConfirmButton: true,\r\n            timer: 6000,\r\n          });\r\n          // toastr.warning(\"No Roles Added for Bot User Type. Please Add a Role from the 'Roles' Page to continue adding Permissions.\");\r\n        }\r\n      }\r\n      \r\n      if (type == \"open\") {\r\n        this.selected_role = \"\";\r\n        this.selected_permissions = [];\r\n        this.user_type_change = false;\r\n        // if (this.portal_roles.length > 0 || this.bot_roles.length > 0) {\r\n        if (this.bot_roles.length > 0) {\r\n          // this.clear_fields()\r\n          $(\"#intentmodal\").modal(\"show\");\r\n        } else {\r\n          // toastr.error(\r\n          //   \"Please Add a Role from the 'Roles' Page to continue adding Permissions\"\r\n          // );\r\n        }\r\n      }\r\n    },\r\n    delete_selected() {\r\n      event.preventDefault();\r\n      let rolelist = [],\r\n        restrictionlist = [];\r\n      for (var i in this.roles) {\r\n        rolelist.push(this.roles[index].role);\r\n        restrictionlist.push(this.roles[index].permissions);\r\n      }\r\n      this.delete_qns_api(rolelist, restrictionlist);\r\n    },\r\n    delete_role(index) {\r\n      event.preventDefault();\r\n    },\r\n    edit_modal(index) {\r\n      this.user_type_change = false;\r\n      this.select_role_name_disable = true;\r\n      document.querySelector(\"#portal_box\").disabled = true;\r\n      document.querySelector(\"#bot_box\").disabled = true;\r\n      this.selected_role = this.roles[index].user_role;\r\n      // console.log(this.roles[index].user_role);\r\n      this.user_type = this.roles[index].user.replace(\" User\", \"\");\r\n      this.selected_permissions = [];\r\n      if (this.user_type == \"Bot\") {\r\n        // this.permissions_list = this.bot_permissions_list;\r\n        this.permissions_list = [\r\n          {\r\n            Type: \"Actions\",\r\n            Details: this.bot_permissions_list,\r\n          },\r\n          {\r\n            Type: \"Intents\",\r\n            Details: this.intentlist,\r\n          },\r\n        ];\r\n      } else if (this.user_type == \"Portal\") {\r\n        this.permissions_list = this.portal_permissions_list;\r\n      }\r\n      for (var j in this.roles[index].permissions) {\r\n        if (this.user_type == \"Bot\") {\r\n          this.selected_permissions.push({\r\n            permissions: this.roles[index].original_permissions[j],\r\n            to_be_displayed: this.roles[index].permissions[j],\r\n          });\r\n        } else if (this.user_type == \"Portal\") {\r\n          this.selected_permissions.push({\r\n            sub_menu: this.roles[index].permissions[j],\r\n          });\r\n        }\r\n      }\r\n      this.role_list = this.complete_role_list[this.user_type];\r\n    },\r\n    page_require(page) {\r\n      if (page == 0 || page == this.total_pages + 1) {\r\n        event.preventDefault();\r\n      } else {\r\n        if (this.search_name == \"\") {\r\n          if (this.filter_user_type == \"Portal\"){\r\n            if (page == \"...s\") {\r\n              this.page_no = Math.ceil((1 + this.page_no) / 2);\r\n            } else if (page == \"...l\") {\r\n              this.page_no = Math.ceil((this.total_pages + this.page_no) / 2);\r\n            } else {\r\n              this.page_no = page;\r\n            }\r\n            $(\"input:checkbox\").prop(\"checked\", false);\r\n            // this.page_no = page;\r\n            this.spinnerOn = true;\r\n              axios\r\n                .post(\r\n                  api_calls.portal_permissions_url(),\r\n                  {\r\n                    role: this.user_role,\r\n                    companyname: this.companyname,\r\n                    email: this.$session.get(\"UserInformation\").email,\r\n                    companyid: this.companyid,\r\n                    license_key: this.$session.get(\"UserInformation\").license_key,\r\n                    token: this.$session.get(\"UserInformation\").tokens,\r\n                    isShow: this.isShow_portal_roles,\r\n                    page_no: this.page_no,\r\n                    per_page: this.per_page,\r\n                  },\r\n                  {\r\n                    headers: {\r\n                      Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n                    },\r\n                  }\r\n                )\r\n                .then((response) => {\r\n                  this.spinnerOn = false;\r\n                  this.number_of_rows = response.data.RolePermissionData.length;\r\n                  this.total_pages = response.data.pagecount;\r\n                  this.setpagination(this.page_no);\r\n                  var list = response.data.RolePermissionData;\r\n                  this.roles = [];\r\n                  for (var i in list) {\r\n                    var permissions = list[i].Menu.filter((menulist) => {\r\n                      if (menulist.Enabled && !menulist.HasSubMenus) {\r\n                        return menulist.MenuItem;\r\n                      }\r\n                    });\r\n                    var perm_list = [];\r\n                    for (var j in permissions) {\r\n                      perm_list.push(permissions[j].MenuItem);\r\n                    }\r\n                    this.roles.push({\r\n                      user_role: list[i].Role,\r\n                      user: list[i].UserType,\r\n                      permissions: perm_list,\r\n                    });\r\n                  }\r\n                  this.total_pages = response.data.pagecount;\r\n                  this.setpagination(this.page_no);\r\n                })     \r\n              .catch((e) => {\r\n                if (\r\n                  e.response.status === 410 ||\r\n                  e.response.status === 440 ||\r\n                  e.response.status === 409\r\n                ) {\r\n                  this.$root.$emit(\"Session_Expired\", e.response.data);\r\n                }\r\n              });\r\n          } else if (this.filter_user_type == \"Bot\") {\r\n            if (page == \"...s\") {\r\n              this.page_no = Math.ceil((1 + this.page_no) / 2);\r\n            } else if (page == \"...l\") {\r\n              this.page_no = Math.ceil((this.total_pages + this.page_no) / 2);\r\n            } else {\r\n              this.page_no = page;\r\n            }\r\n            axios\r\n              .post(\r\n                api_calls.add_edit_bot_role(),\r\n                {\r\n                  companyid: this.companyid,\r\n                  companyname: this.companyname,\r\n                  email: this.$session.get(\"UserInformation\").email,\r\n                  license_key: this.$session.get(\"UserInformation\").license_key,\r\n                  token: this.$session.get(\"UserInformation\").tokens,\r\n                  isShow: this.isShow_bot_roles,\r\n                  per_page: this.per_page,\r\n                  page_no: this.page_no,\r\n                },\r\n                {\r\n                  headers: {\r\n                    Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n                  },\r\n                }\r\n              )\r\n              .then((response) => {\r\n                this.spinnerOn = false;\r\n                this.total_pages = response.data.pagecount;\r\n                this.setpagination(this.page_no);\r\n                this.roles = [];\r\n                for (var i in response.data.BotRolePermissionData) {\r\n                  // let botRoles = this.bot_roles.map(({ role }) => {\r\n                  //   return role;\r\n                  // });\r\n                  // if (botRoles.includes(i)) {\r\n                  if (this.bot_roles.includes(i)) {\r\n                    this.roles.push({\r\n                      user: \"Bot User\",\r\n                      user_role: `${i}`,\r\n                      input_enable: true,\r\n                      permissions: response.data.BotRolePermissionData[i].map((res) => {\r\n                        return res\r\n                          .replace(/_/g, \" \")\r\n                          .toLowerCase()\r\n                          .split(\" \")\r\n                          .map((s) => s.charAt(0).toUpperCase() + s.substring(1))\r\n                          .join(\" \");\r\n                      }),\r\n                      original_permissions: response.data.BotRolePermissionData[i],\r\n                    });\r\n                  }\r\n                }\r\n                this.total_pages = response.data.pagecount;\r\n                this.setpagination(this.page_no);\r\n              })\r\n              .catch((e) => {\r\n                if (\r\n                  e.response.status === 410 ||\r\n                  e.response.status === 440 ||\r\n                  e.response.status === 409\r\n                ) {\r\n                  this.$root.$emit(\"Session_Expired\", e.response.data);\r\n                }\r\n              });\r\n          }\r\n        } else {\r\n          if (page == \"...s\") {\r\n            this.page_no = Math.ceil((1 + this.page_no) / 2);\r\n          } else if (page == \"...l\") {\r\n            this.page_no = Math.ceil((this.total_pages + this.page_no) / 2);\r\n          } else {\r\n            this.page_no = page;\r\n          }\r\n          this.spinnerOn = true;\r\n          axios\r\n            .post(\r\n              api_calls.portal_permissions_url(),\r\n              {\r\n                companyid: this.$session.get(\"UserInformation\").company_id,\r\n                companyname: this.$session.get(\"UserInformation\").company_name,\r\n                license_key: this.$session.get(\"UserInformation\").license_key,\r\n                email: this.$session.get(\"UserInformation\").email,\r\n                token: this.$session.get(\"UserInformation\").tokens,\r\n                issearch: true,\r\n                key: this.search_name,\r\n                per_page: this.per_page,\r\n                page_no: this.page_no,\r\n              },\r\n              {\r\n                headers: {\r\n                  Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n                },\r\n              }\r\n            )\r\n            .then((response) => {\r\n              this.spinnerOn = false;\r\n              if (\r\n                response.data != \"token invalid\" &&\r\n                response.data != null &&\r\n                response.data.MSG != \"No Results Found\" &&\r\n                response.data.MSG != \"Intrnal Server Error\"\r\n              ) {\r\n                var list = response.data.RolePermissionData;\r\n                this.number_of_rows = response.data.RolePermissionData.length;\r\n                this.total_pages = response.data.page_count;\r\n                this.setpagination(this.page_no);\r\n                this.roles = [];\r\n                for (var i in list) {\r\n                  var permissions = list[i].Menu.filter((menulist) => {\r\n                    if (menulist.Enabled && !menulist.HasSubMenus) {\r\n                      return menulist.MenuItem;\r\n                    }\r\n                  });\r\n                  var perm_list = [];\r\n                  for (var j in permissions) {\r\n                    perm_list.push(permissions[j].MenuItem);\r\n                  }\r\n                  this.roles.push({\r\n                    user_role: list[i].Role,\r\n                    user: list[i].UserType,\r\n                    permissions: perm_list,\r\n                  });\r\n                }\r\n              }\r\n              // else if(response.data.MSG=='No Results Found'){\r\n              //   toastr.error(\"No role found\");\r\n              //   setTimeout(() => {\r\n              //       this.$router.go();\r\n              //     }, 2500);\r\n              // }\r\n              // else if(response.data.MSG=='Intrnal Server Error'){\r\n              //   toastr.error(\"Intrnal Server Error\");\r\n              //   setTimeout(() => {\r\n              //       this.$router.go();\r\n              //     }, 2500);\r\n              // }\r\n            })\r\n            .catch((e) => {\r\n              if (\r\n                e.response.status === 410 ||\r\n                e.response.status === 440 ||\r\n                e.response.status === 409\r\n              ) {\r\n                this.$root.$emit(\"Session_Expired\", e.response.data);\r\n              }\r\n            });\r\n        }\r\n      }\r\n    },\r\n    save_role() {\r\n      if (this.selected_role == \"\" || this.selected_permissions.length == 0) {\r\n      } else if (this.selected_role == \"Admin\") {\r\n        this.clear_fields();\r\n      } else if (this.user_type == \"Portal\") {\r\n        var selected_menu = [];\r\n        for (var i in this.selected_permissions) {\r\n          selected_menu.push(this.selected_permissions[i].sub_menu);\r\n        }\r\n        for (var i in this.menu_list_from_api) {\r\n          if (selected_menu.includes(this.menu_list_from_api[i].MenuItem))\r\n            this.menu_list_from_api[i].Enabled = true;\r\n          else this.menu_list_from_api[i].Enabled = false;\r\n        }\r\n        axios\r\n          .post(\r\n            api_calls.portal_permissions_url(),\r\n            {\r\n              companyid: this.companyid,\r\n              companyname: this.companyname,\r\n              email: this.$session.get(\"UserInformation\").email,\r\n              license_key: this.$session.get(\"UserInformation\").license_key,\r\n              token: this.$session.get(\"UserInformation\").tokens,\r\n              isEdit: true,\r\n              role_name: this.selected_role,\r\n              user_type: this.user_type + \" User\",\r\n              menu: this.menu_list_from_api,\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            if (response.data == \"User Role Edited\") {\r\n              toastr.success(this.tlt('permission_updated_for_login_msg1'));\r\n            }\r\n            $(\"#intentmodal\").modal(\"hide\");\r\n            this.load_permission();\r\n          })\r\n          .catch((e) => {\r\n            if (\r\n              e.response.status === 410 ||\r\n              e.response.status === 440 ||\r\n              e.response.status === 409\r\n            ) {\r\n              this.$root.$emit(\"Session_Expired\", e.response.data);\r\n            }\r\n          });\r\n      } else if (this.user_type == \"Bot\") {\r\n        var selected_menu = [];\r\n        for (var i in this.selected_permissions) {\r\n          selected_menu.push(this.selected_permissions[i].permissions);\r\n        }\r\n        axios\r\n          .post(\r\n            api_calls.add_edit_bot_role(),\r\n            {\r\n              companyid: this.companyid,\r\n              companyname: this.companyname,\r\n              email: this.$session.get(\"UserInformation\").email,\r\n              license_key: this.$session.get(\"UserInformation\").license_key,\r\n              token: this.$session.get(\"UserInformation\").tokens,\r\n              bot_role_name: this.selected_role,\r\n              permission_list: selected_menu,\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            if (response.data == \"Query Executed Successfully\") {\r\n              toastr.success(this.tlt('permission_updated_for_login_msg2'));\r\n              this.load_permission();\r\n            } else if (response.data == \"Internal Server Error\") {\r\n              toastr.error(this.tlt('permission_internal_server_msg'));\r\n            }\r\n            $(\"#intentmodal\").modal(\"hide\");\r\n          })\r\n          .catch((e) => {\r\n            if (\r\n              e.response.status === 410 ||\r\n              e.response.status === 440 ||\r\n              e.response.status === 409\r\n            ) {\r\n              this.$root.$emit(\"Session_Expired\", e.response.data);\r\n            }\r\n          });\r\n      }\r\n    },\r\n    edit_restrictions(index) {\r\n      if (this.roles[index].user != \"\") {\r\n        this.roles[index].input_enable = !this.roles[index].input_enable;\r\n      }\r\n      this.edit = true;\r\n    },\r\n    update_list(response) {\r\n      // this.roles = [];\r\n      var input;\r\n      // console.log(response)\r\n      for (var i in response.restrictionlist) {\r\n        if (response.restrictionlist[i] == \"\") {\r\n          input = true;\r\n        } else {\r\n          input = false;\r\n        }\r\n        this.roles.push({\r\n          user: response.restrictionlist[i],\r\n          role: response.rolelist[i],\r\n          input_enable: input,\r\n        });\r\n      }\r\n    },\r\n    update_bot_roles() {\r\n      if (this.filter_user_type == \"Bot\"){\r\n        axios\r\n          .post(\r\n            api_calls.add_edit_bot_role(),\r\n            {\r\n              companyid: this.companyid,\r\n              companyname: this.companyname,\r\n              email: this.$session.get(\"UserInformation\").email,\r\n              license_key: this.$session.get(\"UserInformation\").license_key,\r\n              token: this.$session.get(\"UserInformation\").tokens,\r\n              isShow: this.isShow_bot_roles,\r\n              per_page: this.per_page,\r\n              page_no: this.page_no,\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            this.spinnerOn = false;\r\n            this.total_pages = response.data.pagecount;\r\n            this.setpagination(this.page_no);\r\n            for (var i in response.data.BotRolePermissionData) {\r\n              // let botRoles = this.bot_roles.map(({ role }) => {\r\n              //   return role;\r\n              // });\r\n              // if (botRoles.includes(i)) {\r\n              if (this.bot_roles.includes(i)) {\r\n                this.roles.push({\r\n                  user: \"Bot User\",\r\n                  user_role: `${i}`,\r\n                  input_enable: true,\r\n                  permissions: response.data.BotRolePermissionData[i].map((res) => {\r\n                    return res\r\n                      .replace(/_/g, \" \")\r\n                      .toLowerCase()\r\n                      .split(\" \")\r\n                      .map((s) => s.charAt(0).toUpperCase() + s.substring(1))\r\n                      .join(\" \");\r\n                  }),\r\n                  original_permissions: response.data.BotRolePermissionData[i],\r\n                });\r\n              }\r\n            }\r\n            this.total_pages = response.data.pagecount;\r\n            this.setpagination(this.page_no);\r\n          })\r\n          .catch((e) => {\r\n            if (\r\n              e.response.status === 410 ||\r\n              e.response.status === 440 ||\r\n              e.response.status === 409\r\n            ) {\r\n              this.$root.$emit(\"Session_Expired\", e.response.data);\r\n            }\r\n          });\r\n      }\r\n    },\r\n    pagination_class(index) {\r\n      if (index == this.page_no) {\r\n        return \" active\";\r\n      } else {\r\n        return \"\";\r\n      }\r\n    },\r\n    clear_fields() {\r\n      document.querySelector(\"#portal_box\").disabled = false;\r\n      document.querySelector(\"#bot_box\").disabled = false;\r\n      this.selected_role = \"\";\r\n      this.selected_permissions = [];\r\n      $(\"#intentmodal\").modal(\"hide\");\r\n    },\r\n    callsearch() {\r\n      if (event.keyCode === 13) {\r\n        this.search_product();\r\n      }\r\n    },\r\n    search_product() {\r\n      if (this.search_name != \"\") {\r\n        this.spinnerOn = true;\r\n        axios\r\n          .post(\r\n            api_calls.portal_permissions_url(),\r\n            {\r\n              companyid: this.$session.get(\"UserInformation\").company_id,\r\n              companyname: this.$session.get(\"UserInformation\").company_name,\r\n              license_key: this.$session.get(\"UserInformation\").license_key,\r\n              email: this.$session.get(\"UserInformation\").email,\r\n              token: this.$session.get(\"UserInformation\").tokens,\r\n              issearch: true,\r\n              key: this.search_name,\r\n              per_page: this.per_page,\r\n              page_no: 1,\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            this.spinnerOn = false;\r\n            if (\r\n              response.data != \"token invalid\" &&\r\n              response.data != null &&\r\n              response.data.MSG != \"No Results Found\" &&\r\n              response.data.MSG != \"Intrnal Server Error\"\r\n            ) {\r\n              var list = response.data.RolePermissionData;\r\n              this.number_of_rows = response.data.RolePermissionData.length;\r\n              this.total_pages = response.data.page_count;\r\n              this.page_no = 1;\r\n              this.setpagination(this.page_no);\r\n              this.roles = [];\r\n              for (var i in list) {\r\n                var permissions = list[i].Menu.filter((menulist) => {\r\n                  if (menulist.Enabled && !menulist.HasSubMenus) {\r\n                    return menulist.MenuItem;\r\n                  }\r\n                });\r\n                var perm_list = [];\r\n                for (var j in permissions) {\r\n                  perm_list.push(permissions[j].MenuItem);\r\n                }\r\n                this.roles.push({\r\n                  user_role: list[i].Role,\r\n                  user: list[i].UserType,\r\n                  permissions: perm_list,\r\n                });\r\n              }\r\n            } else if (response.data.MSG == \"No Results Found\") {\r\n              toastr.error(this.tlt('permission_no_role_found_msg'));\r\n              this.load_permission();\r\n            } else if (response.data.MSG == \"Intrnal Server Error\") {\r\n              toastr.error(this.tlt('permission_internal_server_msg2'));\r\n              this.load_permission();\r\n            }\r\n          })\r\n          .catch((e) => {\r\n            if (\r\n              e.response.status === 410 ||\r\n              e.response.status === 440 ||\r\n              e.response.status === 409\r\n            ) {\r\n              this.$root.$emit(\"Session_Expired\", e.response.data);\r\n            }\r\n          });\r\n      } else {\r\n        toastr.error(this.tlt('permission_data_for_search_msg'));\r\n      }\r\n    },\r\n    setpagination(page_no) {\r\n      this.page_array = [];\r\n      if (this.total_pages <= 7) {\r\n        for (let i = 0; i < this.total_pages; i++) {\r\n          this.page_array.push(i + 1);\r\n        }\r\n      } else if (page_no == 1) {\r\n        for (let i = 0; i < 4; i++) {\r\n          this.page_array.push(i + 1);\r\n        }\r\n        this.page_array.push(\"...l\");\r\n        this.page_array.push(this.total_pages);\r\n      } else if (page_no == this.total_pages) {\r\n        this.page_array.push(1);\r\n        this.page_array.push(\"...s\");\r\n        for (let i = this.total_pages - 4; i < this.total_pages; i++) {\r\n          this.page_array.push(i + 1);\r\n        }\r\n      } else if (page_no <= 4) {\r\n        for (let i = 0; i < page_no + 3; i++) {\r\n          this.page_array.push(i + 1);\r\n        }\r\n        this.page_array.push(\"...l\");\r\n        this.page_array.push(this.total_pages);\r\n      } else if (page_no >= this.total_pages - 4) {\r\n        this.page_array.push(1);\r\n        this.page_array.push(\"...s\");\r\n        for (let i = page_no - 4; i < this.total_pages; i++) {\r\n          this.page_array.push(i + 1);\r\n        }\r\n      } else {\r\n        this.page_array.push(1);\r\n        this.page_array.push(\"...s\");\r\n        for (let i = page_no - 3; i <= page_no + 3; i++) {\r\n          this.page_array.push(i);\r\n        }\r\n        this.page_array.push(\"...l\");\r\n        this.page_array.push(this.total_pages);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style src=\"vue-multiselect/dist/vue-multiselect.min.css\">\r\n</style>\r\n<style scoped>\r\ntd > .multiselect__tag {\r\n  padding: 4px 9px 4px 10px;\r\n}\r\n.multiselect__option[data-select=\"Press enter to select\"] > span {\r\n  margin-left: 10%;\r\n}\r\n/* #select_role_name{\r\n    width: 105%;\r\n    margin-left: -2%;\r\n} */\r\n.radio label {\r\n    margin-top: .3rem !important;\r\n  }\r\n</style>\r\n<style>\r\n.multiselect__option--group {\r\n  background: #273679 !important;\r\n  color: #e7eaec !important;\r\n  text-align: center;\r\n  font-weight: bold;\r\n\r\n}\r\n</style>\r\n\r\n"]}]}