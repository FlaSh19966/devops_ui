{"remainingRequest":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/End User Response/VerifyResponsesUnanswered.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/End User Response/VerifyResponsesUnanswered.vue","mtime":1663910265466},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBzd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IFN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgYXBpX2NhbGxzIGZyb20gIkAvcG9ydGFsL2FwaV9jYWxscyI7CmltcG9ydCB7IHNldFRpbWVvdXQgfSBmcm9tICJ0aW1lcnMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKaW1wb3J0IHsgIGNsb3NlX21vZGFsIH0gZnJvbSAiQC9wb3J0YWwvbWl4aW5zIjsKCgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAndmVyaWZ5X3Jlc3BvbnNlc191bmFuc3dlcmVkJywKICAgIGNvbXBvbmVudHM6IHsKICAgICAgICBNdWx0aXNlbGVjdCwKICAgIH0sCiAgICAgIG1peGluczogW2Nsb3NlX21vZGFsXSwKCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgdW5hbnN3ZXJlZF9saXN0OiBbXSwKICAgICAgICB1c2VyX3JvbGU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlLAogICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgaW50ZW50X2xpc3Q6IFtdLAogICAgICAgIGNoZWNrZWRfbGlzdDogW10sCiAgICAgICAgaW50ZW50bGlzdDogIiIsCiAgICAgICAgcGVyX3BhZ2U6IDE1LAogICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgdG90YWxfcGFnZXM6IDAsCiAgICAgICAgc2hvd19sb2FkZXI6IGZhbHNlLAogICAgICAgIG51bWJlcl9vZl9yb3dzOiBudWxsLAogICAgICAgIHNlYXJjaF9uYW1lOiAiIiwKICAgICAgICBwYWdlX2FycmF5OiBbXSwKICAgICAgICBvbGRfcXVlc3Rpb246ICIiLAogICAgICAgIG9sZF9pbnRlbnQ6ICIiLAogICAgICAgIG5ld19pbnRlbnRfbGlzdDogW10sCiAgICAgICAgb2xkX2RhdGE6IHsgcXVlc3Rpb246IG51bGwsIGludGVudDogbnVsbCB9LAogICAgICAgIHRodW1ic19kb3duX2ljb246IHJlcXVpcmUoIkAvcG9ydGFsL2Fzc2V0cy9pbWcvR3JvdXAgNjEuc3ZnIiksCiAgICAgICAgdGh1bWJzX3VwX2ljb246IHJlcXVpcmUoIkAvcG9ydGFsL2Fzc2V0cy9pbWcvR3JvdXAgNzEuc3ZnIiksCiAgICAgICAgLy8gdmlld19jb21wb25lbnRfbmFtZTogInVuYW5zd2VyZWRfcXVlc3Rpb25zIiwKICAgICAgICB9OwogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgICAkKCIjc2VsZWN0YWxsIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgIGlmICgkKHRoaXMpLmlzKCI6Y2hlY2tlZCIpKSB7CiAgICAgICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIHRydWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZtLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHJvb3QuJG9uKCJhZGRfcXVlc3Rpb25zX3VuYW5zd2VyZWQiLCAoZGF0YSkgPT4gewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsgICAKCSAgICAgICAgdGhpcy5hZGRfcXVlc3Rpb25zKCk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kcm9vdC4kb24oInNlYXJjaF91bmFuc3dlcmVkIiwgKGRhdGEpID0+IHsKICAgICAgICAgICAgdGhpcy5zZWFyY2hfbmFtZSA9IGRhdGE7CiAgICAgICAgICAgIHRoaXMuc2VhcmNoX3F1ZXN0aW9uKCk7CiAgICAgICAgICAgIC8vIHRoaXMuYWRkX3F1ZXN0aW9ucygpOwogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHJvb3QuJG9uKCJkZWxldGVfbXVsdGlwbGVfdW5hbnN3ZXJlZCIsIChkYXRhKSA9PiB7CiAgICAgICAgICAgIHRoaXMuZGVsZXRlX211bHRpcGxlKCk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kcm9vdC4kb24oImxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191bmFuc3dlcmVkIiwgKGRhdGEpID0+IHsKICAgICAgICAgICAgdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgICAgIH0pOwogICAgfSwKICAgIGJlZm9yZURlc3Ryb3koKSB7CiAgICAgICAgdGhpcy4kcm9vdC4kb2ZmKCJhZGRfcXVlc3Rpb25zX3VuYW5zd2VyZWQiKTsKICAgICAgICB0aGlzLiRyb290LiRvZmYoInNlYXJjaF91bmFuc3dlcmVkIik7CiAgICAgICAgdGhpcy4kcm9vdC4kb2ZmKCJkZWxldGVfbXVsdGlwbGVfdW5hbnN3ZXJlZCIpOwogICAgICAgIHRoaXMuJHJvb3QuJG9mZigibG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQiKTsKICAgIH0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQoKTsKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgbG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQoKXsKICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICB0aGlzLmludGVudF9saXN0ID0gW107CiAgICAgICAgdGhpcy5uZXdfaW50ZW50X2xpc3QgPSBbXTsKICAgICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdCA9W107CiAgICAgICAgdGhpcy5zZWFyY2hfbmFtZSA9ICIiOwogICAgICAgIGlmICh0aGlzLnVzZXJfcm9sZSA9PSAiU3VwZXJBZG1pbiIpIHsKICAgICAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpKSB7CiAgICAgICAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlJZCIpOwogICAgICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7CiAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuY29tcGFueW5hbWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGF4aW9zCiAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICBhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgIGlzRGVsZXRlOiAiRmFsc2UiLAogICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgICAgICBpc19nZXRfdXNlcl9yZXNwb25zZTogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSBmYWxzZTsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEUuTVNHX0NPREUpIHsKICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfZGF0YSA9PSB1bmRlZmluZWQgPyAwIDogcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGE7CiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2UgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlOwogICAgICAgICAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdCA9IFtdOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBkYXRhWzBdKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHRlbXBfaW50ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgICAgICAvLyB0ZW1wX2ludCA9IGRhdGFbMl1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpOwogICAgICAgICAgICAgICAgICAgIHRlbXBfaW50ID0gZGF0YVsyXVtpXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb246IGRhdGFbMF1baV0sCiAgICAgICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGRhdGFbMV1baV0sCiAgICAgICAgICAgICAgICAgICAgdXNlcl9yZXNwb25zZTogZGF0YVsyXVtpXSwKICAgICAgICAgICAgICAgICAgICB1c2VyX2ZlZWRiYWNrOiBkYXRhWzNdW2ldLAogICAgICAgICAgICAgICAgICAgIGVkaXQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7ICAgICAgICAgICAgCiAgICAgICAgICAgIH1lbHNlIGlmKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuTk9fREFUQV9BVkFJTEFCTEUuTVNHX0NPREUpewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgIHR5cGU6ICJpbmZvIgogICAgICAgICAgICAgICAgfSk7ICAgIAogICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihlLm1lc3NhZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwKICAgICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICBpc0Ryb3Bkb3duOiAiVHJ1ZSIsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgLy8gZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhWzBdKSB7CiAgICAgICAgICAgIC8vIHRoaXMuaW50ZW50X2xpc3QucHVzaCgKICAgICAgICAgICAgLy8gICAgIHJlc3BvbnNlLmRhdGFbMF1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpCiAgICAgICAgICAgIC8vICk7CiAgICAgICAgICAgIC8vIHRoaXMubmV3X2ludGVudF9saXN0LnB1c2goCiAgICAgICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhWzBdW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKQogICAgICAgICAgICAvLyApOwogICAgICAgICAgICAvLyB9CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IHRoaXMuYXBpX3N0YXR1c19jb2RlLkRBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGEuZGF0YVswXSkgewogICAgICAgICAgICAgICAgdGhpcy5pbnRlbnRfbGlzdC5wdXNoKAogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuZGF0YVswXVtpXQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIHRoaXMubmV3X2ludGVudF9saXN0LnB1c2goCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5kYXRhWzBdW2ldCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgCiAgICAgICAgICAgIH1lbHNlIGlmKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuTk9fREFUQV9BVkFJTEFCTEUuTVNHX0NPREUpewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgIHR5cGU6ICJpbmZvIgogICAgICAgICAgICAgICAgfSk7ICAgIAogICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOyAgICAgICAKICAgICAgICB9LAogICAgICAgIHNldHBhZ2luYXRpb24ocGFnZV9ubykgewogICAgICAgIHRoaXMucGFnZV9hcnJheSA9IFtdOwogICAgICAgIGlmICh0aGlzLnRvdGFsX3BhZ2VzIDw9IDcpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRvdGFsX3BhZ2VzOyBpKyspIHsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IDEpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSB0aGlzLnRvdGFsX3BhZ2VzKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gdGhpcy50b3RhbF9wYWdlcyAtIDQ7IGkgPCB0aGlzLnRvdGFsX3BhZ2VzOyBpKyspIHsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChwYWdlX25vIDw9IDQpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYWdlX25vICsgMzsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPj0gdGhpcy50b3RhbF9wYWdlcyAtIDQpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSBwYWdlX25vIC0gNDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IHBhZ2Vfbm8gLSAzOyBpIDw9IHBhZ2Vfbm8gKyAzOyBpKyspIHsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcGFnZV9yZXF1aXJlKHBhZ2UpIHsKICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICBpZiAocGFnZSA9PSAwIHx8IHBhZ2UgPT0gdGhpcy50b3RhbF9wYWdlcyArIDEpIHsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgICAgIGlmIChwYWdlID09ICIuLi5zIikgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKDEgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFnZSA9PSAiLi4ubCIpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCh0aGlzLnRvdGFsX3BhZ2VzICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09ICIiKSB7CiAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgICBhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgaXNEZWxldGU6ICJGYWxzZSIsCiAgICAgICAgICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICAgICAgICAgIGlzX2dldF91c2VyX3Jlc3BvbnNlOiBmYWxzZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3QgPSBbXTsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IHRoaXMuYXBpX3N0YXR1c19jb2RlLkRBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLmRhdGFbMF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRlbXBfaW50ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKHJlc3BvbnNlLmRhdGEuZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlbXBfaW50ID0gcmVzcG9uc2UuZGF0YVsyXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IHJlc3BvbnNlLmRhdGEuZGF0YVsyXVtpXTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb246IHJlc3BvbnNlLmRhdGEuZGF0YVswXVtpXSwKICAgICAgICAgICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiByZXNwb25zZS5kYXRhLmRhdGFbMV1baV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfcmVzcG9uc2U6IHJlc3BvbnNlLmRhdGEuZGF0YVsyXVtpXSwKICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9mZWVkYmFjazogcmVzcG9uc2UuZGF0YS5kYXRhWzNdW2ldLAogICAgICAgICAgICAgICAgICAgICAgICBlZGl0OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0cGFnaW5hdGlvbih0aGlzLnBhZ2Vfbm8pOwogICAgICAgICAgICAgICAgfWVsc2UgaWYocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSB0aGlzLmFwaV9zdGF0dXNfY29kZS5OT19EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSl7CiAgICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiaW5mbyIKICAgICAgICAgICAgICAgICAgICB9KTsgICAgCiAgICAgICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IHRydWU7CiAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgICAgIGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgICAgIGlzc2VhcmNoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIC8vIHNlYXJjaGJ5OiB0aGlzLnNlYXJjaF9ieSwKICAgICAgICAgICAgICAgICAgICBrZXk6IHRoaXMuc2VhcmNoX25hbWUsCiAgICAgICAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICAgICAgICAgIGlzX2dldF91c2VyX3Jlc3BvbnNlOiBmYWxzZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHBhZ2U7CiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9ICByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZTsKICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLmRhdGFbMF0pIHsKICAgICAgICAgICAgICAgICAgICBsZXQgdGVtcF9pbnQgPSAiIjsKICAgICAgICAgICAgICAgICAgICBpZiAoQm9vbGVhbihkYXRhWzJdW2ldKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyB0ZW1wX2ludCA9IGRhdGFbMl1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpOwogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IGRhdGFbMl1baV07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbjogcmVzcG9uc2UuZGF0YS5kYXRhWzBdW2ldLAogICAgICAgICAgICAgICAgICAgICAgICBpbnRlbnQ6IHRlbXBfaW50LAogICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IHJlc3BvbnNlLmRhdGEuZGF0YVsxXVtpXSwKICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9yZXNwb25zZTogcmVzcG9uc2UuZGF0YS5kYXRhWzJdW2ldLAogICAgICAgICAgICAgICAgICAgICAgICB1c2VyX2ZlZWRiYWNrOiByZXNwb25zZS5kYXRhLmRhdGFbM11baV0sCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKTsKICAgICAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICAgICAgICAvLyB9LCAyNTAwKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191bmFuc3dlcmVkKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBxdWVzdGlvbl9zZWxlY3RlZCh2YWx1ZSkgewogICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNoZWNrZWQpIHsKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PSAiYWxsIikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnVuYW5zd2VyZWRfbGlzdCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdC5wdXNoKHRoaXMudW5hbnN3ZXJlZF9saXN0W2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QucHVzaCh0aGlzLnVuYW5zd2VyZWRfbGlzdFt2YWx1ZV0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKCFldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9ICJhbGwiKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGFsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNzZWxlY3RhbGwiKTsKICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0YWxsLmNoZWNrZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0YWxsLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSB0aGlzLmNoZWNrZWRfbGlzdC5maWx0ZXIoKHF1ZXN0aW9uKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBxdWVzdGlvbiAhPT0gdGhpcy51bmFuc3dlcmVkX2xpc3RbdmFsdWVdOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gdGVtcDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZGVsZXRlX3NpbmdsZShpbmRleCkgewogICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgICAgbGV0IHF1ZXN0aW9ubGlzdCA9IFtdOwogICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCd1bmFuc3dlcmVkX2RlbGV0ZV9zd2FsX21zZycpLAogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ3VuYW5zd2VyZWRfZGVsZXRlX3RoaXNfcXNfbXNnJyksCiAgICAgICAgICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgndW5hbnN3ZXJlZF9kZWxldGVfc3dhbF9jb25maXJtX21zZycpLAogICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQudmFsdWUpOwogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGVsZXRlZCIpOwogICAgICAgICAgICAgICAgcXVlc3Rpb25saXN0LnB1c2godGhpcy51bmFuc3dlcmVkX2xpc3RbaW5kZXhdLnF1ZXN0aW9uKTsKICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlX3F1ZXN0aW9uc19hcGkocXVlc3Rpb25saXN0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBkZWxldGVfbXVsdGlwbGUoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrZWRfbGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgndW5hbnN3ZXJlZF9kZWxldGVfbm9fcXNfc2VsZWN0ZWRfbXNnJyksCiAgICAgICAgICAgICAgICB0ZXh0OiIiLAogICAgICAgICAgICAgICAgdHlwZToiZXJyb3IiLAogICAgICAgICAgICAgICAgdGltZXI6MjAwMCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2hlY2tlZF9saXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGxldCBxdWVzdGlvbmxpc3QgPSBbXTsKICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ3VuYW5zd2VyZWRfZGVsZXRlX3N3YWxfYWxlcnRfbXNnJyksCiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgndW5hbnN3ZXJlZF9kZWxldGVfdGhpc19xc19tdWx0aXBsZV9tc2cnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJxdWVzdGlvbiIsCiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IHRoaXMudGx0KCd1bmFuc3dlcmVkX2RlbGV0ZV9jb25maXJtX3N3YWxfbXNnJyksCiAgICAgICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMuY2hlY2tlZF9saXN0KSB7CiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25saXN0LnB1c2godGhpcy5jaGVja2VkX2xpc3RbaV0ucXVlc3Rpb24pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZV9xdWVzdGlvbnNfYXBpKHF1ZXN0aW9ubGlzdCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZGVsZXRlX3F1ZXN0aW9uc19hcGkocXVlc3Rpb25saXN0KSB7CiAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IHRydWU7CiAgICAgICAgYXhpb3MKICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgIGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgICAgICBxdWVzdGlvbmxpc3Q6IHF1ZXN0aW9ubGlzdCwKICAgICAgICAgICAgICAgIGlzRGVsZXRlOiAiVHJ1ZSIsCiAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSB0aGlzLmFwaV9zdGF0dXNfY29kZS5ERUxFVEVEX1NVQ0NFU1NGVUxMWV8wMDA0Lk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGVsZXRlZCBzdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGEgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhOwogICAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlID09IHVuZGVmaW5lZCA/IDAgOiByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZTsKICAgICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKHRoaXMudGx0KCd1bmFuc3dlcmVkX2RlbGV0ZV9zdWNjZXNzX21zZycpKTsKICAgICAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgLy8gdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAvLyB9LCAxNTAwKTsKICAgICAgICAgICAgICAgIGlmKHF1ZXN0aW9ubGlzdC5sZW5ndGggPT09IHRoaXMudW5hbnN3ZXJlZF9saXN0Lmxlbmd0aCAmJiAKICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPjEpewogICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHRoaXMucGFnZV9ubyAtIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB3aGlsZSh0aGlzLnBhZ2Vfbm8gPiAxICYmIHRoaXMucGFnZV9ubyA+IHRoaXMudG90YWxfcGFnZXMpewogICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHRoaXMucGFnZV9ubyAtIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191bmFuc3dlcmVkKCk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihlLm1lc3NhZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBlZGl0X2l0ZW0oaW5kZXgpIHsKICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3RbaW5kZXhdLmVkaXQgPSAhdGhpcy51bmFuc3dlcmVkX2xpc3RbaW5kZXhdLmVkaXQ7CiAgICAgICAgICAgIHRoaXMub2xkX3F1ZXN0aW9uID0gdGhpcy51bmFuc3dlcmVkX2xpc3RbaW5kZXhdLnF1ZXN0aW9uOwogICAgICAgICAgICAvLyB0aGlzLm9sZF9pbnRlbnQgPSB0aGlzLnVuYW5zd2VyZWRfbGlzdFtpbmRleF0uaW50ZW50OwogICAgICAgICAgICB0aGlzLm9sZF9kYXRhLnF1ZXN0aW9uID0gdGhpcy5vbGRfcXVlc3Rpb247CiAgICAgICAgICAgIC8vIHRoaXMub2xkX2RhdGEuaW50ZW50ID0gdGhpcy5jb21wYW55aWQgKyAiXyIgKyB0aGlzLm9sZF9pbnRlbnQ7CiAgICAgICAgICAgIC8vIHRoaXMucXVlc3Rpb24gPSBxdWVzdGlvbi5xdWVzdGlvbjsKICAgICAgICAgICAgLy8gdGhpcy5pbnRlbnQgPSBxdWVzdGlvbi5pbnRlbnQ7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMub2xkX2RhdGEpOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLm9sZF9xdWVzdGlvbik7CiAgICAgICAgfSwKICAgICAgICBzdWJtaXRfcXVlc3Rpb24oKSB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJzdWJtaXQiKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coInF1ZXN0aW9uIiwgdGhpcy5vbGRfcXVlc3Rpb24pOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiaW50ZW50IiwgdGhpcy5vbGRfaW50ZW50KTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImludGVudCIsIHRoaXMuaXNlZGl0KTsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgaWYgKHRoaXMub2xkX3F1ZXN0aW9uID09ICIiKSB7CiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IodGhpcy50bHQoJ3VuYW5zd2VyZWRfZW50ZXJfYWxsX2ZpZWxkX21zZycpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgICAgICAgICAgYXhpb3MKICAgICAgICAgICAgICAgIC5wb3N0KAogICAgICAgICAgICAgICAgICAgIGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaXNfRWRpdDogIlRydWUiLAogICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiB0aGlzLm9sZF9xdWVzdGlvbiwKICAgICAgICAgICAgICAgICAgICAvLyBpbnRlbnQ6IHRoaXMuY29tcGFueWlkICsgIl8iICsgdGhpcy5vbGRfaW50ZW50LAogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgICAgICBvbGRfcXVlc3Rpb25fZGF0YTogdGhpcy5vbGRfZGF0YSwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuSU5URVJOQUxfU0VSVkVSX0VSUk9SLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCd1bmFuc3dlcmVkX2ludGVydmFsX3NlcnZlcl9tc2cnKSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IHRoaXMuYXBpX3N0YXR1c19jb2RlLkVESVRFRF9TVUNDRVNTRlVMTFlfMDAwNS5NU0dfQ09ERSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCd1bmFuc3dlcmVkX3FzX2VkaXRlZF9zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lcjoyNTAwLAogICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyB9CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgIC8vIGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIlF1ZXN0aW9uIEludGVudCBVcGRhdGVkIikgewogICAgICAgICAgICAgICAgICAgIC8vIFN3YWwoewogICAgICAgICAgICAgICAgICAgIC8vICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRleHQ6ICJZb3VyIHF1ZXN0aW9uIGhhcyBiZWVuIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGltZXI6MjAwMCwKICAgICAgICAgICAgICAgICAgICAvLyB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIC8vICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gfQogICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191bmFuc3dlcmVkKCk7CiAgICAgICAgICAgICAgICAgICAgLy8gfSk7CiAgICAgICAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCd1bmFuc3dlcmVkX2ludGVydmFsX3NlcnZlcl9tc2cxJykpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy5jbG9zZV9tb2RhbCgnYWRkX3F1ZXNuX3NhdmUnKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcGFnaW5hdGlvbl9jbGFzcyhpbmRleCkgewogICAgICAgICAgICBpZiAoaW5kZXggPT0gdGhpcy5wYWdlX25vKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gIiBhY3RpdmUiOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBhZGRfcXVlc3Rpb25zKCkgewogICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgICAgdmFyIHF1ZXN0aW9ubGlzdCA9IFtdOwogICAgICAgICAgICB2YXIgdGVtcF9saXN0ID0gW107CiAgICAgICAgICAgIHZhciBlbXB0eSA9IHRoaXMudW5hbnN3ZXJlZF9saXN0LmZpbHRlcigodW5hbnN3ZXJlZCkgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIHVuYW5zd2VyZWQuaW50ZW50ID09ICIiOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnVuYW5zd2VyZWRfbGlzdCkgewogICAgICAgICAgICAgICAgaWYgKHRoaXMudW5hbnN3ZXJlZF9saXN0W2ldLmludGVudCAhPSAiIikgewogICAgICAgICAgICAgICAgdGVtcF9saXN0LnB1c2goCiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3RbaV0ucXVlc3Rpb24sCiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jb21wYW55aWQgKyAiXyIgKyB0aGlzLnVuYW5zd2VyZWRfbGlzdFtpXS5pbnRlbnQKICAgICAgICAgICAgICAgICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdFtpXS5pbnRlbnQKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBxdWVzdGlvbmxpc3QucHVzaCh0ZW1wX2xpc3QpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGVtcF9saXN0ID0gW107CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHF1ZXN0aW9ubGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGF4aW9zCiAgICAgICAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgICAgICAgICBhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgICAgICBpc0FkZDogIlRydWUiLAogICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uaW50ZW50OiBxdWVzdGlvbmxpc3QsCiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuQURERURfU1VDQ0VTU0ZVTExZXzAwMDIuTVNHX0NPREUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgndW5hbnN3ZXJlZF9hZGRlZF9zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDMwMDAsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgaWYocXVlc3Rpb25saXN0Lmxlbmd0aCA9PT0gdGhpcy51bmFuc3dlcmVkX2xpc3QubGVuZ3RoICYmIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlX25vID4xKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHRoaXMucGFnZV9ubyAtIDE7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgICAgICAgICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IodGhpcy50bHQoJ3VuYW5zd2VyZWRfYWRkX3F1ZXN0aW9uX21zZycpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBzZWFyY2hfcXVlc3Rpb24oKSB7CiAgICAgICAgICAgIC8vIGlmKHRoaXMuc2VhcmNoX2J5IT0nJyl7CiAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lICE9ICIiKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IHRydWU7CiAgICAgICAgICAgICAgICBheGlvcwogICAgICAgICAgICAgICAgLnBvc3QoCiAgICAgICAgICAgICAgICAgICAgYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgICAgICAgIGlzc2VhcmNoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIC8vIHNlYXJjaGJ5OiB0aGlzLnNlYXJjaF9ieSwKICAgICAgICAgICAgICAgICAgICBrZXk6IHRoaXMuc2VhcmNoX25hbWUsCiAgICAgICAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgICAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICAgICAgICAgICAgICBpc19nZXRfdXNlcl9yZXNwb25zZTogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IHRoaXMuYXBpX3N0YXR1c19jb2RlLk5PX0RBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCd1bmFuc3dlcmVkX25vX3FzX2ZvdW5kX21zZycpKTsKICAgICAgICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgLy8gfSwgMjUwMCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2UgIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyX29mX3Jvd3MgPSAgcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlOwogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YS5kYXRhWzBdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0ZW1wX2ludCA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoQm9vbGVhbihkYXRhWzJdW2ldKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGVtcF9pbnQgPSBkYXRhWzJdW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW50ID0gZGF0YVsyXVtpXTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb246IHJlc3BvbnNlLmRhdGEuZGF0YVswXVtpXSwKICAgICAgICAgICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiByZXNwb25zZS5kYXRhLmRhdGFbMV1baV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfcmVzcG9uc2U6IGRhdGFbMl1baV0sCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfZmVlZGJhY2s6IGRhdGFbM11baV0sCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJObyBRdWVzdGlvbnMgRm91bmQiKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gICB0b2FzdHIuZXJyb3IoIk5vIFF1ZXN0aW9uIEZvdW5kIik7CiAgICAgICAgICAgICAgICAgICAgLy8gICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgICAgICAgLy8gICB9LCAyNTAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgICAgICAgICAgICAgICAgIC8vIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IodGhpcy50bHQoJ3VuYW5zd2VyZWRfaW50ZXJuYWxfc2VydmVyX21zZzInKSk7CiAgICAgICAgICAgICAgICAgICAgLy8gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgICAgIC8vICAgfSwgMjUwMCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcih0aGlzLnRsdCgndW5hbnN3ZXJlZF9kYXRhX2Zvcl9zZWFyY2hfbXNnJykpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIH1lbHNlewogICAgICAgICAgICAvLyAgIHRvYXN0ci5lcnJvcigiU2VsZWN0IGhlYWRlciBmb3Igc2VhcmNoaW5nIik7CiAgICAgICAgICAgIC8vIH0KICAgICAgICB9LAogICAgfQp9Cg=="},null]}