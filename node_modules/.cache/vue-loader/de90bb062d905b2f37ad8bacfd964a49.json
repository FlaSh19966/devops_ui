{"remainingRequest":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Templates/SmsTemplates.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Templates/SmsTemplates.vue","mtime":1663910265478},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IFZ1ZUVkaXRvciB9IGZyb20gInZ1ZTItZWRpdG9yIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IFN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgYXBpX2NhbGxzIGZyb20gIkAvcG9ydGFsL2FwaV9jYWxscyI7CmltcG9ydCB7IGZyZWV6ZV9wb3J0YWwsc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsICwgY2xvc2VfbW9kYWwgfSBmcm9tICJAL3BvcnRhbC9taXhpbnMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKaW1wb3J0IFZ1ZVBob25lTnVtYmVySW5wdXQgZnJvbSAndnVlLXBob25lLW51bWJlci1pbnB1dCc7CmltcG9ydCAndnVlLXBob25lLW51bWJlci1pbnB1dC9kaXN0L3Z1ZS1waG9uZS1udW1iZXItaW5wdXQuY3NzJzsKCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlNtc1RlbXBsYXRlUGFnZSIsCiAgY29tcG9uZW50czogewogICAgVnVlRWRpdG9yLAogICAgTXVsdGlzZWxlY3QsCiAgICBWdWVQaG9uZU51bWJlcklucHV0LAogIH0sCiAgbWl4aW5zOiBbZnJlZXplX3BvcnRhbCxzaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwgLCBjbG9zZV9tb2RhbF0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBlbmNpbF9zdmc6CiAgICAgICAgJyA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE1LjU0NiIgaGVpZ2h0PSIxNS40NjEiIHZpZXdCb3g9IjAgMCAxNS41NDYgMTUuNDYxIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDojOWU5ZTllO308L3N0eWxlPjwvZGVmcz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNzQ3Ljg4OCAtMzU2Ljc2OSkiPjxwYXRoIGNsYXNzPSJhIiBkPSJNNzU5LjQxNiwzNTYuNzY5YTIuMzU4LDIuMzU4LDAsMCwxLDEuNzc3LjY2MmMuNTM0LjUxMywxLjA3MiwxLjAyNSwxLjU2NywxLjU3NWEyLjMsMi4zLDAsMCwxLS4wNzEsMy4zMjVjLTIuNzM2LDIuNzYtNS40OTQsNS41LTguMjM4LDguMjUxYTEuMzgxLDEuMzgxLDAsMCwxLS43NTguMjg4Yy0uNzE5LjE3NC0xLjQyOS4zNzktMi4xNDQuNTcyLS45MzIuMjUxLTEuODYyLjUtMi43OTUuNzUxLS42LjE1OC0uOTg5LS4yMTMtLjgzMi0uODA3cS42ODktMi41OTUsMS40MDYtNS4xODJhMS4xNjQsMS4xNjQsMCwwLDEsLjI4OS0uNDg3cTQuMDkxLTQuMTA3LDguMi04LjJBMi4yNjUsMi4yNjUsMCwwLDEsNzU5LjQxNiwzNTYuNzY5Wm0tMS45ODksMi45NTYtNi41NCw2LjUzOCwzLjAyNSwzLjAyNCw2LjUzOC02LjUzN1ptNC4wMjMsMi4xNjVjLjExOC0uMTM1LjIyNS0uMjY5LjM0My0uMzkyYTEuMTM0LDEuMTM0LDAsMCwwLDAtMS43MzRjLS40Ni0uNDY2LS45MjYtLjkyNS0xLjM4OC0xLjM5YTEuMTY2LDEuMTY2LDAsMCwwLS44NjEtLjM2OGMtLjU3OCwwLS44ODEuNC0xLjIxNC43NlptLTEyLjA4NCw4Ljg2MywzLjItLjg2My0yLjMzNy0yLjMzMVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDApIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik04MTMuOTQyLDQyMi42bC0uNzg5LS44LDMuODIxLTMuODE5Ljc4NC44WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTU5LjY0OCAtNTUuOTQ3KSIvPjwvZz48L3N2Zz4nLAogICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICBzcGlubmVyT246IGZhbHNlLAogICAgICB0ZW1wbGF0ZV9uYW1lOiAiIiwKICAgICAgc2F2ZV9zbXM6ICIiLAogICAgICBpc19zbXM6IGZhbHNlLAogICAgICBpc19lbWFpbDogdHJ1ZSwKICAgICAgc2F2ZV9zdWJqZWN0OiAiIiwKICAgICAgaXNfcHVibGlzaF9zbXM6IHRydWUsCiAgICAgIHZlcmlmaWNhdGlvbl9zdGF0dXM6IG51bGwsCiAgICAgIGRlZmF1bHRfdGVtcGxhdGVsaXN0OiBbXSwKICAgICAgdGVtcGxhdGVsaXN0OiBbXSwKICAgICAgY2hlY2tlZF9saXN0OiBbXSwKICAgICAgY3VycmVudF90ZW1wbGF0ZTogW10sCiAgICAgIG9sZF90ZW1wbGF0ZV9uYW1lOiAiIiwKICAgICAgaXNFZGl0VGVtcGxhdGU6IGZhbHNlLAogICAgICBudW1iZXJfb2Zfcm93czogbnVsbCwKICAgICAgdG90YWxfcGFnZXM6IG51bGwsCiAgICAgIHBhZ2Vfbm86IDEsCiAgICAgIHBlcl9wYWdlOiAxMCwKICAgICAgcHJldmlld190ZW1wbGF0ZV9kYXRhOiAiIiwKICAgICAgdGVtcGxhdGVfbmFtZV9hbHJlYWR5X2V4aXN0OiBmYWxzZSwKICAgICAgZWRpdF90ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3Q6IGZhbHNlLAogICAgICBwYWdlX2FycmF5OiBbXSwKICAgICAgc2VuZF9zbXNfYWxsX2N1c3RvbWVyOiB0cnVlLAogICAgICBjdXN0b21lcnNfbGlzdDogW10sCiAgICAgIHNwZWNpZmljX2N1c3RvbWVyX2xpc3Q6IFtdLAogICAgICBkaXNhYmxlX2J0bl9leHBpcmVkOiBmYWxzZSwKICAgICAgLy8gY3VycmVudF9zdGVwOiAxLAogICAgICBjaG9vc2VuX3RlbXBsYXRlOiBudWxsLAogICAgICBpc1Zpc2libGVTZWFyY2hDbGVhcjogZmFsc2UsCiAgICAgIHNlYXJjaF9uYW1lOiAiIiwKICAgICAgYWRkX2N1c3RvbWVyX2NvbnRhY3RfbnVtYmVyOiBudWxsLAogICAgICBhZGRfY3VzdG9tZXJfbmFtZTogbnVsbCwKICAgICAgcGhvbmVOdW1iZXI6IG51bGwsCiAgICAgIGNyZWRpdHNfYmFsYW5jZTogbnVsbAogICAgfTsKICB9LAogIHByb3BzOiB7CiAgICBpc19ub3RpZmljYXRpb25fdGVtcGxhdGU6IEJvb2xlYW4sCiAgfSwKICBjcmVhdGVkKCkgewogICAgaWYgKHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIikgewogICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55SWQiKTsKICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55TmFtZSIpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgc2VhcmNoX25hbWUoKSB7CiAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09PSAiIikgewogICAgICAgIHRoaXMubG9hZF90ZW1wbGF0ZXMoKTsKICAgICAgICB0aGlzLmlzVmlzaWJsZVNlYXJjaENsZWFyID0gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWFyY2hfbmFtZSAhPT0gIiIpIHsKICAgICAgICB0aGlzLmlzVmlzaWJsZVNlYXJjaENsZWFyID0gdHJ1ZTsKICAgICAgfQogICAgfSwKICB9LAogIG1vdW50ZWQoKSB7CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgdGhpcy5mcmVlemVfcG9ydGFsKCk7CiAgICB9LCAyMDAwKTsKICAgICB0aGlzLiRyb290LiRvbigiU21zVGVtcGxhdGVQYWdlRGlzYWJsZWQiLCAoZGF0YSkgPT57CiAgICAgIGlmKGRhdGE9PT10cnVlKXsKICAgICAgICB0aGlzLmRpc2FibGVfYnRuX2V4cGlyZWQgPSB0cnVlOwogICAgICB9CiAgICB9KQogICAgdGhpcy5sb2FkX3RlbXBsYXRlcygpOwogICAgaWYgKHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlID09PSBmYWxzZSl7CiAgICAgIHRoaXMubG9hZF9jdXN0b21lcl9saXN0KCk7CiAgICB9CiAgICB2YXIgdm0gPSB0aGlzOwogICAgJCgiI3NlbGVjdGFsbCIpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICB0aGlzLmlzX3NtcyA9IGZhbHNlOwogICAgICB0aGlzLmlzX2VtYWlsID0gdHJ1ZTsKICAgICAgaWYgKCQodGhpcykuaXMoIjpjaGVja2VkIikpIHsKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2bS5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgbWV0aG9kczogewogICAgYWRkX2N1c3RvbWVyKCkgewogICAgICBpZih0aGlzLnBob25lTnVtYmVyLmlzVmFsaWQgPT0gdHJ1ZSAmJiB0aGlzLmFkZF9jdXN0b21lcl9uYW1lICE9ICIiKSB7CiAgICAgICAgdGhpcy5jdXN0b21lcnNfbGlzdC5wdXNoKAogICAgICAgICAgewogICAgICAgICAgICAncGhvbmUnOiB0aGlzLnBob25lTnVtYmVyLmZvcm1hdHRlZE51bWJlciwKICAgICAgICAgICAgJ2NvdW50cnknOiB0aGlzLnBob25lTnVtYmVyLmNvdW50cnlDb2RlLAogICAgICAgICAgICAnY3VzdG9tZXJfbmFtZSc6IHRoaXMuYWRkX2N1c3RvbWVyX25hbWUKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgdGhpcy5zcGVjaWZpY19jdXN0b21lcl9saXN0LnB1c2goCiAgICAgICAgICB7CiAgICAgICAgICAgICdwaG9uZSc6IHRoaXMucGhvbmVOdW1iZXIuZm9ybWF0dGVkTnVtYmVyLAogICAgICAgICAgICAnY291bnRyeSc6IHRoaXMucGhvbmVOdW1iZXIuY291bnRyeUNvZGUsCiAgICAgICAgICAgICdjdXN0b21lcl9uYW1lJzogdGhpcy5hZGRfY3VzdG9tZXJfbmFtZQogICAgICAgICAgfQogICAgICAgICkKICAgICAgICB0aGlzLmFkZF9jdXN0b21lcl9uYW1lID0gIiI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnc21zX3RlbXBsYXRlX3ZhbGlkX3Bob25lX25vJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNoZWNrX2FkZG9uc19iYWxhbmNlKCkgewogICAgICBheGlvcy5wb3N0KAogICAgICAgIGFwaV9jYWxscy5jaGVja19hZGRvbnNfYmFsYW5jZSgpLAogICAgICAgIHsKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgY2hlY2tfYmFsYW5jZTogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICkKICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PnsKICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuQ0hFQ0tfQkFMQU5DRS5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9jb3VudCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5jcmVkaXRzLnNtc19jb3VudDsKICAgICAgICAgICAgdGhpcy5jcmVkaXRzX2JhbGFuY2UgPQogICAgICAgICAgICAiWW91ciBjdXJyZW50IFNNUyBjcmVkaXRzIGFyZSA8c3Ryb25nPiBmb3IgVVMgcmVnaW9uIDoiICsKICAgICAgICAgICAgdGVtcGxhdGVfY291bnQudXMgKwogICAgICAgICAgICAiIHwgZm9yIE5vbi1VUyByZWdpb246ICIgKwogICAgICAgICAgICB0ZW1wbGF0ZV9jb3VudC5ub25fdXMgKwogICAgICAgICAgICAiPC9zdHJvbmc+IjsKICAgICAgICAgICAgJCgiI2NoZWNrYmFsYW5jZSIpLm1vZGFsKCJzaG93Iik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgY2xlYXJfc2VhcmNoX25hbWUoKSB7CiAgICAgIHRoaXMuc2VhcmNoX25hbWUgPSAiIjsKICAgIH0sCiAgICBjYWxsc2VhcmNoKCkgewogICAgICBpZiAodGhpcy5zZWFyY2hfbmFtZSAhPSAiIil7CiAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgIGF4aW9zCiAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX3NtcygpLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgaXNfc2VhcmNoOiB0cnVlLAogICAgICAgICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSwKICAgICAgICAgICAgICBzZWFyY2hfa2V5OiB0aGlzLnNlYXJjaF9uYW1lCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9CiAgICAgICAgICApCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZWxpc3QgPSBbXTsKICAgICAgICAgICAgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLk5PX1NNU19URU1QTEFURV9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gW107CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlRFTVBMQVRFX1NFQVJDSF9SRVNVTFRfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlbGlzdCA9IHJlc3BvbnNlLmRhdGEuZGF0YS50ZW1wbGF0ZXM7CiAgICAgICAgICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd190ZW1wbGF0ZSgwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGhpcy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhID09IHVuZGVmaW5lZCA/IDAgOiByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfZGF0YTsKICAgICAgICAgICAgICB0aGlzLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2UgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlOwogICAgICAgICAgICAgIHRoaXMuc2V0cGFnaW5hdGlvbih0aGlzLnBhZ2Vfbm8pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBzYXZlX3RlbXBsYXRlKCkgewogICAgICBpZiAodGhpcy50ZW1wbGF0ZV9uYW1lID09ICIiKXsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdzbXNfdGVtcGxhdGVfbmFtZV9ibGFua19tc2cnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSAKICAgICAgaWYodGhpcy5jaG9vc2VuX3RlbXBsYXRlID09IG51bGwpewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogIlBsZWFzZSBzZWxlY3QgdGhlIHRlbXBsYXRlIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZih0aGlzLmNob29zZW5fdGVtcGxhdGUgIT0gbnVsbCl7CiAgICAgICAgdmFyIGNoZWNrID0gZmFsc2U7CiAgICAgICAgZm9yKHZhciBpIGluIHRoaXMuY2hvb3Nlbl90ZW1wbGF0ZS52YXJpYWJsZV9saXN0KSB7CiAgICAgICAgICBpZiAodGhpcy5jaG9vc2VuX3RlbXBsYXRlLnZhcmlhYmxlX2xpc3RbaV0gPT0gIiIpewogICAgICAgICAgICBjaGVjayA9IHRydWUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGNoZWNrKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdzbXNfdGVtcGxhdGVfdmFsdWVzX2Nhbm5vdF9ibGFuaycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSAKICAgICAgaWYgKHRoaXMudGVtcGxhdGVfbmFtZV9hbHJlYWR5X2V4aXN0ID09IHRydWUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgdmFyIHRlbXBsYXRlX2RldGFpbHMgPSB7CiAgICAgICAgICB0ZW1wbGF0ZV9uYW1lOiB0aGlzLnRlbXBsYXRlX25hbWUsCiAgICAgICAgICBwYXJlbnRfdGVtcGxhdGVfaWQ6IHRoaXMuY2hvb3Nlbl90ZW1wbGF0ZS50ZW1wbGF0ZV9pZCwKICAgICAgICAgIHRlbXBsYXRlX2JvZHk6IHRoaXMuY2hvb3Nlbl90ZW1wbGF0ZS50ZW1wbGF0ZV9ib2R5LAogICAgICAgICAgdmFyaWFibGVfbGlzdDogdGhpcy5jaG9vc2VuX3RlbXBsYXRlLnZhcmlhYmxlX2xpc3QsCiAgICAgICAgICB0ZW1wbGF0ZV9leGFtcGxlOiB0aGlzLmNob29zZW5fdGVtcGxhdGUudGVtcGxhdGVfZXhhbXBsZQogICAgICAgIH0KICAgICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX3NtcygpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGlzX3NhdmU6IHRydWUsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICAgIHRlbXBsYXRlX2RldGFpbHM6IHRlbXBsYXRlX2RldGFpbHMKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlNVQ0NFU1NGVUxfREJfUVVFUllfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAkKCIjYWRkdGVtcGxhdGVtb2RlbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgndGVtcGxhdGVfZGF0YV9hZGRlZF9tc2cnKSwKICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5lbXB0eV92YXJpYWJsZSgpOwogICAgICAgICAgICAgIHRoaXMubG9hZF90ZW1wbGF0ZXMoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSBmYWxzZTsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuVU5TVUNDRVNTRlVMX0RCX1FVRVJZLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuY2xvc2VfbW9kYWwoJ3Jlc19uX2ludF9zYXZlJykKICAgIH0sCiAgICBlZGl0X3RlbXBsYXRlX2RldGFpbHMoKSB7CiAgICAgIGlmICghdGhpcy5pc0VkaXRUZW1wbGF0ZSkgewogICAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSBmYWxzZTsKICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgdGhpcy5lZGl0X3RlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgZWRpdF90ZW1wbGF0ZSgpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9uYW1lID09ICIiKXsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdzbXNfZWRpdF90ZW1wbGF0ZV9uYW1lX2JsYW5rX21zZycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IAogICAgICBpZih0aGlzLmN1cnJlbnRfdGVtcGxhdGUgIT0gbnVsbCl7CiAgICAgICAgdmFyIGNoZWNrID0gZmFsc2U7CiAgICAgICAgZm9yKHZhciBpIGluIHRoaXMuY3VycmVudF90ZW1wbGF0ZS52YXJpYWJsZV9saXN0KSB7CiAgICAgICAgICBpZiAodGhpcy5jdXJyZW50X3RlbXBsYXRlLnZhcmlhYmxlX2xpc3RbaV0gPT0gIiIpewogICAgICAgICAgICBjaGVjayA9IHRydWUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGNoZWNrKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdzbXNfZWRpdF90ZW1wbGF0ZV92YWx1ZXNfY2Fubm90X2JsYW5rJyksCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IAogICAgICBpZiAodGhpcy5lZGl0X3RlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9PSB0cnVlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgIHZhciB0ZW1wbGF0ZV9kZXRhaWxzID0gewogICAgICAgICAgdGVtcGxhdGVfbmFtZTogdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX25hbWUsCiAgICAgICAgICBwYXJlbnRfdGVtcGxhdGVfaWQ6IHRoaXMuY3VycmVudF90ZW1wbGF0ZS5wYXJlbnRfdGVtcGxhdGVfaWQsCiAgICAgICAgICB0ZW1wbGF0ZV9pZDogdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX2lkLAogICAgICAgICAgdGVtcGxhdGVfYm9keTogdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX2JvZHksCiAgICAgICAgICB2YXJpYWJsZV9saXN0OiB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudmFyaWFibGVfbGlzdCwKICAgICAgICAgIHRlbXBsYXRlX2V4YW1wbGU6IHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9leGFtcGxlCiAgICAgICAgfQogICAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfc21zKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgdGVtcGxhdGVfZGV0YWlsczogdGVtcGxhdGVfZGV0YWlscywKICAgICAgICAgICAgdGVtcGxhdGVfaWQ6IHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9pZCwKICAgICAgICAgICAgaXNfZWRpdDogdHJ1ZSwKICAgICAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlNVQ0NFU1NGVUxfREJfUVVFUllfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAkKCIjYWRkdGVtcGxhdGVtb2RlbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgndGVtcGxhdGVfZGF0YV9lZGl0X21zZycpLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICB0aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgICAgICAgdGhpcy5sb2FkX3RlbXBsYXRlcygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5VTlNVQ0NFU1NGVUxfREJfUVVFUlkuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KQogICAgICAgICAgICB0aGlzLmlzRWRpdFRlbXBsYXRlID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgLy8gY2hhbmdlX3N0ZXAodmFsKSB7CiAgICAvLyAgIGlmICh2YWwgPT0gMiAmJiBCb29sZWFuKHRoaXMuY2hvb3Nlbl90ZW1wbGF0ZSkgIT0gZmFsc2UpewogICAgLy8gICAgIHRoaXMuY3VycmVudF9zdGVwID0gMgogICAgLy8gICB9ZWxzZSBpZih2YWwgPT0gMSkgewogICAgLy8gICAgIHRoaXMuY3VycmVudF9zdGVwID0gMQogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIFN3YWwoewogICAgLy8gICAgICAgdGV4dDogdGhpcy50bHQoJ3NlbGVjdF90ZW1wbGF0ZV9tc2cnKSwKICAgIC8vICAgICAgIHRvYXN0OiB0cnVlLAogICAgLy8gICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgIC8vICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgIC8vICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgIHRpbWVyOiAyNTAwLAogICAgLy8gICAgIH0pOwogICAgLy8gICB9CiAgICAvLyB9LAogICAgbG9hZF9jdXN0b21lcl9saXN0KCkgewogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfc21zKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgZ2V0X2N1c3RvbWVyc19saXN0OiB0cnVlLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuU1RBVFVTX1NVQ0NFU1NfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgdGhpcy5jdXN0b21lcnNfbGlzdCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5jdXN0b21lcl9saXN0OwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5OT19DVVNUT01FUl9EQVRBX0FWQUlMQUJMRV9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICB0aGlzLmN1c3RvbWVyc19saXN0ID0gW107CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHNlbmRfc21zKCkgewogICAgICBpZighdGhpcy5kaXNhYmxlX2J0bl9leHBpcmVkKXsKICAgICAgICBheGlvcy5wb3N0KAogICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9zbXMoKSwKICAgICAgICB7CiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgdGVtcGxhdGVfaWQ6IHRoaXMuY3VycmVudF90ZW1wbGF0ZS50ZW1wbGF0ZV9pZCwKICAgICAgICAgIHNlbmRfc21zX2FsbF9jdXN0b21lcjogdGhpcy5zZW5kX3Ntc19hbGxfY3VzdG9tZXIsIAogICAgICAgICAgc3BlY2lmaWNfY3VzdG9tZXJzX2xpc3Q6IHRoaXMuc3BlY2lmaWNfY3VzdG9tZXJfbGlzdCwKICAgICAgICAgIHNlbmRfc21zOiB0cnVlCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgfSwKICAgICAgICB9CiAgICAgICkKICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PnsKICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuU01TX1RFTVBMQVRFX05PVF9GT1VORF9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdzZW5kX3Ntc19jcmVkaXQxJyksCiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ25vX2NyZWRpdHNfbGVmdF9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5OT19DVVNUT01FUl9EQVRBX0FWQUlMQUJMRV9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImluZm8iLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlCiAgICAgICAgICB9KQogICAgICAgICAgCiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5OT05fVVNfU01TX0NSRURJVFNfRVhDRUVEU19NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ3NlbmRfc21zX2NyZWRpdDEnKSwKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnbm9fY3JlZGl0c19sZWZ0X21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICB0aW1lcjogNDAwMCwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuU0VORElOR19TTVNfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdzbXNfaXNfc2VudF9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgCiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5VU19TTVNfQ1JFRElUU19FWENFRURTX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA0MDAwLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pCiAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgCiAgICAgIH1lbHNlewogICAgICAgIHRoaXMuc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsKCk7CiAgICAgIH0KICAgICAgICB0aGlzLmNsb3NlX21vZGFsKCdzYXZlX3Ntc19idXR0b24nKQogICAgfSwKICAgIHZhbGlkYXRlX3RlbXBsYXRlX25hbWUoKSB7CiAgICAgIGF4aW9zLnBvc3QoCiAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX3NtcygpLAogICAgICAgIHsKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgICAgIGlzX3RlbXBsYXRlX25hbWVfZXhpc3RzOiB0cnVlLAogICAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSwKICAgICAgICAgIHRlbXBsYXRlX25hbWU6IHRoaXMudGVtcGxhdGVfbmFtZSwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICApCiAgICAgIC50aGVuKChyZXNwb25zZSkgPT57CiAgICAgICAgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlNNU19URU1QTEFURV9OQU1FX0RPRVNfTk9UX0VYSVNUU19NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICB0aGlzLnRlbXBsYXRlX25hbWVfYWxyZWFkeV9leGlzdCA9IGZhbHNlOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVtcGxhdGVfbmFtZV9hZGRfaWQiKS5zdHlsZS5ib3JkZXIgPW51bGw7CiAgICAgICAgICAgIGlmKHRoaXMudGVtcGxhdGVfbmFtZSAhPSAiIil7CiAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRlbXBsYXRlX25hbWVfYWRkX2lkIikuc3R5bGUuYm9yZGVyID0KICAgICAgICAgICAgICAvLyAiMXB4IHNvbGlkIGdyZWVuIjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5TTVNfVEVNUExBVEVfTkFNRV9FWElTVFNfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSB0cnVlOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVtcGxhdGVfbmFtZV9hZGRfaWQiKS5zdHlsZS5ib3JkZXIgPQogICAgICAgICAgICAiMXB4IHNvbGlkIHJlZCI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHZhbGlkYXRlX2VkaXRfdGVtcGxhdGVfbmFtZSgpIHsKICAgICAgYXhpb3MucG9zdCgKICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfc21zKCksCiAgICAgICAgewogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgaXNfdGVtcGxhdGVfbmFtZV9leGlzdHM6IHRydWUsCiAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgdGVtcGxhdGVfbmFtZTogdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX25hbWUsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0KICAgICAgKQogICAgICAudGhlbigocmVzcG9uc2UpID0+ewogICAgICAgIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5TTVNfVEVNUExBVEVfTkFNRV9ET0VTX05PVF9FWElTVFNfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIHRoaXMuZWRpdF90ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSBmYWxzZTsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlZGl0X3RlbXBsYXRlX25hbWVfaWQiKS5zdHlsZS5ib3JkZXIgPW51bGw7CiAgICAgICAgICBpZih0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfbmFtZSAhPSAiIil7CiAgICAgICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlZGl0X3RlbXBsYXRlX25hbWVfaWQiKS5zdHlsZS5ib3JkZXIgPQogICAgICAgICAgICAvLyAiMXB4IHNvbGlkICMwMGYwMDAiOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuU01TX1RFTVBMQVRFX05BTUVfRVhJU1RTX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBpZiAodGhpcy5vbGRfdGVtcGxhdGVfbmFtZSA9PSB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfbmFtZSl7CiAgICAgICAgICAgIHRoaXMuZWRpdF90ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSBmYWxzZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVkaXRfdGVtcGxhdGVfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9bnVsbDsKICAgICAgICAgIH1lbHNlewogICAgICAgICAgICB0aGlzLmVkaXRfdGVtcGxhdGVfbmFtZV9hbHJlYWR5X2V4aXN0ID0gdHJ1ZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVkaXRfdGVtcGxhdGVfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9CiAgICAgICAgICAgICIxcHggc29saWQgcmVkIjsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHByZXZpZXdfdGVtcGxhdGUodmFsKSB7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgaWYgKHZhbCA9PSAib2xkIikgewogICAgICAgIHZhciB0ZW1wbGF0ZV9ib2R5ID0gdGhpcy5jdXJyZW50X3RlbXBsYXRlLnRlbXBsYXRlX2JvZHkKICAgICAgICB2YXIgdmFyaWFibGVzX2xpc3QgPSB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudmFyaWFibGVfbGlzdAogICAgICB9IGVsc2UgaWYgKHZhbCA9PSAibmV3IikgewogICAgICAgIHZhciB0ZW1wbGF0ZV9ib2R5ID0gdGhpcy5jaG9vc2VuX3RlbXBsYXRlLnRlbXBsYXRlX2JvZHkKICAgICAgICB2YXIgdmFyaWFibGVzX2xpc3QgPSB0aGlzLmNob29zZW5fdGVtcGxhdGUudmFyaWFibGVfbGlzdAogICAgICB9CiAgICAgIGF4aW9zCiAgICAgIC5wb3N0KAogICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9zbXMoKSwKICAgICAgICB7CiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSwKICAgICAgICAgIGlzX3ByZXZpZXc6IHRydWUsCiAgICAgICAgICB0ZW1wbGF0ZV9ib2R5OiB0ZW1wbGF0ZV9ib2R5LAogICAgICAgICAgdmFyaWFibGVzX2xpc3Q6IHZhcmlhYmxlc19saXN0CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgfSwKICAgICAgICB9CiAgICAgICkKICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuU1RBVFVTX1NVQ0NFU1NfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIHRoaXMucHJldmlld190ZW1wbGF0ZV9kYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhLmJvZHk7CiAgICAgICAgICBpZih2YWwgPT0gIm9sZCIpewogICAgICAgICAgICAkKCIjcHJldmlld190ZW1wbGF0ZV92aXNpYmxlIikubW9kYWwoInNob3ciKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pCiAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgaWYgKAogICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICkgewogICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHNlbmRfZW1haWxfY29uZmlybV9wcm9tcHRfdGV4dChhbGxfY3VzdG9tZXIpIHsKICAgICAgaWYgKGFsbF9jdXN0b21lcikgewogICAgICAgIHJldHVybiB0aGlzLnRsdCgnc2VuZF9idWxrX21zZycpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLnRsdCgnZW1haWxfdG9fc3BlY2lmaWNfY3VzdG9tZXInKTsKICAgICAgfQogICAgfSwKICAgIHNlbGVjdGVkX3RlbXBsYXRlcyh2YWx1ZSkgewogICAgICBpZih2YWx1ZSA9PSAiYWxsIil7CiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMudGVtcGxhdGVsaXN0KSB7CiAgICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QucHVzaCh0aGlzLnRlbXBsYXRlbGlzdFtpXS50ZW1wbGF0ZV9pZCk7CiAgICAgICAgICB9CiAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoOyBpKyspewogICAgICAgICAgICAkKCIjIitbaV0pLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgICAgICAgJCgiI3NlbGVjdGFsbCIpLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9ZWxzZSBpZiAoIWV2ZW50LnRhcmdldC5jaGVja2VkKXsKICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgfQoKICAgICAgfWVsc2V7CiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdC5wdXNoKHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKCFldmVudC50YXJnZXQuY2hlY2tlZCl7CiAgICAgICAgICB2YXIgc2VsZWN0YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3NlbGVjdGFsbCIpOwogICAgICAgICAgaWYgKHNlbGVjdGFsbC5jaGVja2VkKSB7CiAgICAgICAgICAgIHNlbGVjdGFsbC5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgdGVtcCA9IHRoaXMuY2hlY2tlZF9saXN0LmZpbHRlcigodGVtcGxhdGVzX2lkKSA9PiB7CiAgICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZXNfaWQgIT0gdmFsdWU7CiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gdGVtcDsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVfdGVtcGxhdGUoKSB7CiAgICAgIGlmKHRoaXMuY2hlY2tlZF9saXN0Lmxlbmd0aCA8IDEpewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ3NlbGVjdF9vbmVfdGVtcGxhdGUnKSwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zCiAgICAgICAgLnBvc3QoCiAgICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfc21zKCksCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0aGlzLmlzX25vdGlmaWNhdGlvbl90ZW1wbGF0ZSwKICAgICAgICAgICAgaXNfZGVsZXRlOiB0cnVlLAogICAgICAgICAgICB0ZW1wbGF0ZV9saXN0OiB0aGlzLmNoZWNrZWRfbGlzdAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgICAgICB0aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICAgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlNVQ0NFU1NGVUxfREJfUVVFUllfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgndGVtcGxhdGVfZGVsZXRlZF9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5VTlNVQ0NFU1NGVUxfREJfUVVFUllfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnc21zX2ludGVybmFsX3NlcnZlcicpLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgbG9hZF90ZW1wbGF0ZXMoKSB7CgogICAgICAvLyBHZXQgZGVmYXVsdCB0ZW1wbGF0ZXMKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcwogICAgICAgIC5wb3N0KAogICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX3NtcygpLAogICAgICAgICAgewogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICAgIGlzX2dldF9kZWZhdWx0X3RlbXBsYXRlczogdHJ1ZQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICB9LAogICAgICAgICAgfQogICAgICAgICkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMuZGVmYXVsdF90ZW1wbGF0ZWxpc3QgPSBbXTsKICAgICAgICAgICAgaWYgKHRoaXMuYXBpX3N0YXR1c19jb2RlLlNUQVRVU19TVUNDRVNTX01PREVMUy5NU0dfQ09ERSA9PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICB0aGlzLmRlZmF1bHRfdGVtcGxhdGVsaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhLmRlZmF1bHRfdGVtcGxhdGVzOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5OT19ERUZBVUxUX1NNU19URU1QTEFURV9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgIC8vIEdldCBTYXZlZCBUZW1wbGF0ZXMKICAgICAgYXhpb3MKICAgICAgICAucG9zdCgKICAgICAgICAgIGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9zbXMoKSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueV9uYW1lLAogICAgICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubywKICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gW107CiAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGEgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhOwogICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlID09IHVuZGVmaW5lZCA/IDAgOiByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZTsKICAgICAgICAgIGlmICh0aGlzLmFwaV9zdGF0dXNfY29kZS5OT19TTVNfVEVNUExBVEVfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICB0aGlzLnRlbXBsYXRlbGlzdCA9IFtdOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgaWYodGhpcy5hcGlfc3RhdHVzX2NvZGUuVEVNUExBVEVfU0VBUkNIX1JFU1VMVF9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhLnRlbXBsYXRlczsKICAgICAgICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICB0aGlzLnNob3dfdGVtcGxhdGUoMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KQogICAgICAgICAgfSAKICAgICAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuc2V0cGFnaW5hdGlvbih0aGlzLnBhZ2Vfbm8pOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgcGFnZV9yZXF1aXJlKHBhZ2UpIHsKICAgICAgaWYgKHBhZ2UgPT0gMCB8fCBwYWdlID09IHRoaXMudG90YWxfcGFnZXMgKyAxKSB7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuc2VhcmNoX25hbWUgPT0gIiIpIHsKICAgICAgICAgIGlmIChwYWdlID09ICIuLi5zIikgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKDEgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2UgPT0gIi4uLmwiKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgodGhpcy50b3RhbF9wYWdlcyArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHBhZ2U7CiAgICAgICAgICB9CiAgICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICBheGlvcwogICAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgICBhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfc21zKCksCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICAgIGlzX2dldDogdHJ1ZSwKICAgICAgICAgICAgICAgIGlzX25vdGlmaWNhdGlvbjogdGhpcy5pc19ub3RpZmljYXRpb25fdGVtcGxhdGUsCiAgICAgICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfZGF0YSA9PSB1bmRlZmluZWQgPyAwIDogcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGE7CiAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlID09IHVuZGVmaW5lZCA/IDAgOiByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZTsKICAgICAgICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuTk9fU01TX1RFTVBMQVRFX01PREVMUy5NU0dfQ09ERSA9PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gW107CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfSBlbHNlIGlmKHRoaXMuYXBpX3N0YXR1c19jb2RlLlRFTVBMQVRFX1NFQVJDSF9SRVNVTFRfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZWxpc3QgPSByZXNwb25zZS5kYXRhLmRhdGEudGVtcGxhdGVzOwogICAgICAgICAgICAgICAgaWYgKHRoaXMudGVtcGxhdGVsaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZWxpc3RbMF07CiAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd190ZW1wbGF0ZSgwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICB0aGlzLnNldHBhZ2luYXRpb24odGhpcy5wYWdlX25vKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfWVsc2UgewogICAgICAgICAgaWYgKHBhZ2UgPT0gIi4uLnMiKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgoMSArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICAgIH0gZWxzZSBpZiAocGFnZSA9PSAiLi4ubCIpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCh0aGlzLnRvdGFsX3BhZ2VzICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gcGFnZTsKICAgICAgICAgIH0KICAgICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgICAgIGF4aW9zCiAgICAgICAgICAucG9zdCgKICAgICAgICAgICAgYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX3NtcygpLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55X2lkLAogICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgaXNfc2VhcmNoOiB0cnVlLAogICAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubywKICAgICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRoaXMuaXNfbm90aWZpY2F0aW9uX3RlbXBsYXRlLAogICAgICAgICAgICAgIHNlYXJjaF9rZXk6IHRoaXMuc2VhcmNoX25hbWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0KICAgICAgICAgICkKICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnRlbXBsYXRlbGlzdCA9IFtdOwogICAgICAgICAgICBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuTk9fU01TX1RFTVBMQVRFX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZWxpc3QgPSBbXTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcGlfc3RhdHVzX2NvZGUuVEVNUExBVEVfU0VBUkNIX1JFU1VMVF9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVsaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhLnRlbXBsYXRlczsKICAgICAgICAgICAgICBpZiAodGhpcy50ZW1wbGF0ZWxpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgdGhpcy5zaG93X3RlbXBsYXRlKDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0aGlzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGEgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhOwogICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZSA9PSB1bmRlZmluZWQgPyAwIDogcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2U7CiAgICAgICAgICAgICAgdGhpcy5zZXRwYWdpbmF0aW9uKHRoaXMucGFnZV9ubyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5pc0VkaXRUZW1wbGF0ZSA9IGZhbHNlOwogICAgICAgICAgfSkKICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNldHBhZ2luYXRpb24ocGFnZV9ubykgewogICAgICB0aGlzLnBhZ2VfYXJyYXkgPSBbXTsKICAgICAgaWYgKHRoaXMudG90YWxfcGFnZXMgPD0gNykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gMSkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgfQogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSB0aGlzLnRvdGFsX3BhZ2VzKSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKICAgICAgICBmb3IgKGxldCBpID0gdGhpcy50b3RhbF9wYWdlcyAtIDQ7IGkgPCB0aGlzLnRvdGFsX3BhZ2VzOyBpKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA8PSA0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYWdlX25vICsgMzsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgfQogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA+PSB0aGlzLnRvdGFsX3BhZ2VzIC0gNCkgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CiAgICAgICAgZm9yIChsZXQgaSA9IHBhZ2Vfbm8gLSA0OyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChpICsgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CiAgICAgICAgZm9yIChsZXQgaSA9IHBhZ2Vfbm8gLSAzOyBpIDw9IHBhZ2Vfbm8gKyAzOyBpKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkpOwogICAgICAgIH0KICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9CiAgICB9LAogICAgcGFnaW5hdGlvbl9jbGFzcyhpbmRleCkgewogICAgICBpZiAoaW5kZXggPT0gdGhpcy5wYWdlX25vKSB7CiAgICAgICAgcmV0dXJuICIgYWN0aXZlIjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgIH0sCiAgICBzaG93X3RlbXBsYXRlKGluZGV4KSB7CiAgICAgIHRoaXMuY3VycmVudF90ZW1wbGF0ZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy50ZW1wbGF0ZWxpc3RbaW5kZXhdKSk7CiAgICAgIHRoaXMub2xkX3RlbXBsYXRlX25hbWUgPSB0aGlzLmN1cnJlbnRfdGVtcGxhdGUudGVtcGxhdGVfbmFtZTsKICAgICAgdGhpcy5jdXJyZW50X3RlbXBsYXRlX2luZGV4ID0gaW5kZXg7CiAgICAgIHRoaXMuaXNFZGl0VGVtcGxhdGUgPSBmYWxzZTsKICAgIH0sCiAgICBlbXB0eV92YXJpYWJsZSgpIHsKICAgICAgaWYoIXRoaXMuZGlzYWJsZV9idG5fZXhwaXJlZCkgewogICAgICAgIHRoaXMuY2hvb3Nlbl90ZW1wbGF0ZSA9IG51bGw7CiAgICAgICAgdGhpcy5jdXJyZW50X3N0ZXAgPSAxOwogICAgICAgIHRoaXMuc3BlY2lmaWNfY3VzdG9tZXJfbGlzdCA9IFtdOwogICAgICAgIHRoaXMuc2F2ZV9zbXMgPSAiIjsKICAgICAgICB0aGlzLnRlbXBsYXRlX25hbWUgPSAiIjsKICAgICAgICB0aGlzLm9sZF90ZW1wbGF0ZV9uYW1lID0gIiI7CiAgICAgICAgdGhpcy50ZW1wbGF0ZV9uYW1lX2FscmVhZHlfZXhpc3QgPSBmYWxzZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGVtcGxhdGVfbmFtZV9hZGRfaWQiKS5zdHlsZS5ib3JkZXIgPSBudWxsOwogICAgICB9ZWxzZSB7CiAgICAgICAgdGhpcy5zaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwoKTsKICAgICAgfQogICAgfSwKICAgIGNoZWNrX2N1cnJlbnRfdGVtcGxhdGVfYWN0aXZlKGluZGV4KSB7CiAgICAgIC8vIGNvbnNvbGUudGFibGUoaW5kZXgsIHRoaXMudGVtcGxhdGVsaXN0W2luZGV4XSwgdGhpcy5jdXJyZW50X3RlbXBsYXRlKTsKICAgICAgaWYgKEJvb2xlYW4odGhpcy50ZW1wbGF0ZWxpc3RbaW5kZXhdKSA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybiB0aGlzLnRlbXBsYXRlbGlzdFtpbmRleF0udGVtcGxhdGVfbmFtZSA9PT0KICAgICAgICAgIHRoaXMub2xkX3RlbXBsYXRlX25hbWUKICAgICAgICAgID8gImN1cnJlbnQtYWN0aXZlLXRlbXBsYXRlIgogICAgICAgICAgOiBudWxsOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["SmsTemplates.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAq3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SmsTemplates.vue","sourceRoot":"src/portal/Chatbot/Dashboard/Templates","sourcesContent":["<template>\n  <div class=\"dash-cont\">\n    <div class=\"spinner\" id=\"spinner\" v-show=\"spinnerOn\"></div>\n    <div class=\"container-fluid\">\n      <div class=\"card dash-card\">\n        <div class=\"dash-card card-header d-flex m-0\">\n          <div class=\"card-act col-sm-4 pr-2 pl-0 d-flex\">\n          <input\n              class=\"form-control mr-auto\"\n              style=\"padding: 0px 15px; height: 36px !important;\"\n              id=\"search_bar_id\"\n              :placeholder=\"tlt('search_template')\"\n              v-model.trim=\"search_name\"\n              v-on:keyup=\"callsearch\"\n          />\n          <a\n            type=\"button\"\n            v-if=\"isVisibleSearchClear\"\n            class=\"btn bg-transparent mt-auto mb-auto py-0\"\n            @click=\"clear_search_name\"\n            style=\"margin-left: -40px; z-index: 10\"\n          >\n            <img src=\"/img/close-icn.png\" alt />\n          </a>\n          </div>\n          <div class=\"card-act ml-auto d-flex flex-wrap\">\n            <a\n            id=\"check_balance_btn\"\n            href=\"#\"\n            class=\"darkblue-btn\"\n            data-toggle=\"modal\"\n            @click=\"check_addons_balance\"\n            title=\"Check your SMS credits\"\n          >\n            {{tlt('sms_check_balance_btn')}}\n          </a>\n          <a\n            id=\"send_sms_btn1\"\n            href=\"#\"\n            class=\"darkblue-btn\"\n            title=\"Send SMS\"\n            v-show=\"disable_btn_expired\"\n            @click=\"show_subscription_expired_swal\"\n          >\n            {{tlt('send_sms_expiry_btn')}}\n          </a>\n          <a\n            id=\"send_sms_btn\"\n            href=\"#\"\n            class=\"darkblue-btn\"\n            data-toggle=\"modal\"\n            data-target=\"#sendsms\"\n            title=\"Send SMS\"\n            v-show=\"templatelist.length > 0 && is_notification_template === false && !disable_btn_expired\"\n          >\n            {{tlt('send_sms_btn')}}\n          </a>\n          <a\n            id=\"add_template_btn\"\n            href=\"#\"\n            class=\"darkblue-btn\"\n            v-if=\"disable_btn_expired\"\n            title=\"Add new Template\"\n            @click=\"empty_variable\"\n          >\n            {{tlt('sms_add_template_expiry_btn')}}\n          </a>\n          <a\n            id=\"add_template_btn\"\n            v-else\n            href=\"#\"\n            class=\"darkblue-btn\"\n            data-toggle=\"modal\"\n            data-target=\"#addtemplatemodel\"\n            title=\"Add new Template\"\n            @click=\"empty_variable\"\n          >\n            {{tlt('sms_add_template_btn')}}\n          </a>\n          <a\n            href=\"javascript:void(0)\"\n            class=\"red-btn\"\n            id=\"delete_intent\"\n            @click=\"delete_template\"\n          >\n            {{tlt('sms_delete_btn')}}\n          </a>\n          </div>\n        </div>\n      <div class=\"card-body py-0\" id=\"page\">\n        <div class=\"col-sm-12 d-flex px-0\" v-if=\"templatelist.length > 0\">\n          <div class=\"col-sm-4 pl-0\" style=\"height: 80vh; overflow-y: auto\">\n            <div class=\"table-box\">\n              <div class=\"table-responsive\">\n                <table class=\"table\" style=\"overflow-y: auto\">\n                  <thead>\n                    <!-- <tr> -->\n                    <th scope=\"row\">\n                      <div class=\"form-check checkbox checkbox-success\">\n                        <label class=\"form-check-label\">\n                          <input\n                            class=\"form-check-input\"\n                            id=\"selectall\"\n                            type=\"checkbox\"\n                            @change=\"selected_templates('all')\"\n                          />\n                          <span class=\"icn\"></span>\n                        </label>\n                      </div>\n                    </th>\n                    <th\n                      scope=\"row\"\n                      class=\"text-left\"\n                      style=\"\n                        font: normal normal normal 16px/22px Roboto;\n                        letter-spacing: 0px;\n                        color: #414141;\n                      \"\n                    >\n                      {{tlt('sms_template_header')}}\n                    </th>\n                    <!-- </tr> -->\n                  </thead>\n                  <tbody>\n                    <tr\n                      v-for=\"(template, index) in templatelist\"\n                      :key=\"index\"\n                      :class=\"check_current_template_active(index)\"\n                    >\n                      <td scope=\"row\">\n                        <div class=\"form-check checkbox checkbox-success\">\n                          <label class=\"form-check-label\">\n                            <input\n                              class=\"form-check-input\"\n                              type=\"checkbox\"\n                              :id='index'\n                              @change=\"\n                                selected_templates(template.template_id)\n                              \"\n                            />\n                            <span class=\"icn\"></span>\n                          </label>\n                        </div>\n                      </td>\n                      <td\n                        style=\"cursor: pointer\"\n                        @click=\"show_template(index)\"\n                        :title=\"template.template_name\"\n                      >\n                        <template>\n                          <p style=\"margin-bottom: 0\">\n                            {{ template.template_name }}\n                          </p>\n                        </template>\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"col-sm-8 pr-0\"\n            style=\"overflow-y: auto\"\n            v-if=\"templatelist.length > 0\"\n          >\n            <div style=\"border: 1px solid #dbe2e8\">\n              <div class=\"col-sm-12\">\n                <div style=\"color: #414141\" class=\"\">\n                  <h5 class=\"mb-0 pt-2 d-flex\">\n                    <span class=\"mt-2 mb-0\">{{tlt('sms_template_details_header')}}</span>\n                    <a\n                      class=\"ml-auto mt-2 mb-0\"\n                      href=\"javascript:void(0)\"\n                      title=\"Click Here for Preview\"\n                      style=\"color: rgb(39, 54, 121)\"\n                      @click=\"preview_template('old')\"\n                      data-toggle=\"modal\"\n                    >\n                      <p\n                        class=\"labe1\"\n                        style=\"margin-right: 1rem; font-size: 1.25rem\"\n                      >\n                        {{tlt('sms_preview_btn')}}\n                      </p></a\n                    >\n                    <span\n                      @click=\"edit_template_details\"\n                      v-html=\"pencil_svg\"\n                      class=\"mr-2 mt-2\"\n                      style=\"cursor: pointer\"\n                    ></span>\n                  </h5>\n                </div>\n              </div>\n              <hr style=\"margin-top: 0\" />\n              <div class=\"col-sm-12\" style=\"margin-bottom: 1rem\">\n                <h5>\n                  <p class=\"mt-2 mb-0\" style=\"color: #414141\">\n                    {{tlt('sms_template_name_label')}}\n                  </p>\n                </h5>\n                <div v-if=\"!isEditTemplate\" style=\"padding-left: 20px\">\n                  <p>{{ current_template.template_name }}</p>\n                </div>\n                <div v-else>\n                  <input\n                    id=\"edit_template_name_id\"\n                    type=\"text\"\n                    v-model.trim=\"current_template.template_name\"\n                    v-on:keyup=\"validate_edit_template_name\"                    \n                    class=\"form-control\"\n                    style=\"padding: 0.375rem 0.75rem\"\n                    :placeholder=\"tlt('template_name_label')\"\n                  />\n                  <span\n                    v-show=\"edit_template_name_already_exist\"\n                    style=\"color: red\"\n                    >{{tlt('template_name_exist_msg')}}</span\n                  >\n                </div>\n              </div>\n              <div\n                class=\"col-sm-12\"\n                style=\"margin-bottom: 1rem\"\n              >\n                <h5>\n                  <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_template_body_label')}}</p>\n                </h5>\n                <div style=\"padding-left: 20px\">\n                  <p>{{ current_template.template_body }}</p>\n                </div>\n              </div>\n              <div\n                class=\"col-sm-12\"\n                style=\"margin-bottom: 1rem\"\n              >\n                <h5>\n                  <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_template_example_label')}}</p>\n                </h5>\n                <div style=\"padding-left: 20px\">\n                  <p>{{ current_template.template_example }}</p>\n                </div>\n              </div>\n              <div class=\"col-sm-12\"\n                style=\"margin-bottom: 1rem\">\n                <h5>\n                  <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_template_variable_header')}}</p>\n                </h5>\n                  <table v-if=\"!isEditTemplate\" style=\"width: 100%;\">\n                    <tbody>\n                      <tr style=\"border: 1px solid black;\">\n                      <th class=\"col-sm-4\" style=\"text-align: center; border: 1px solid black;\">\n                        {{tlt('sms_template_variable_label')}}\n                      </th>\n                      <th class=\"col-sm-8\" style=\"text-align: center; border: 1px solid black;\">\n                        {{tlt('sms_template_values_label')}}\n                      </th>\n                      </tr>\n                      <tr\n                        v-for=\"(item, i) in current_template.variable_list\"\n                        :key=\"i\"\n                        style=\"border: 1px solid black;\"\n                      >\n                      <td v-for=\"(value, a) in item\"\n                        :key=\"a\" style=\"border: 1px solid black;\">\n                        {{a}}\n                      </td>\n                      <td v-for=\"(value, b) in item\"\n                          :key=\"b\" style=\"border: 1px solid black;\">\n                        {{current_template.variable_list[i][b]}}\n                      </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                  <table v-else style=\"width: 100%;\">\n                    <tbody>\n                      <tr>\n                      <th class=\"col-sm-4\" style=\"text-align: center;\">\n                        {{tlt('sms_model_variable_label')}}\n                      </th>\n                      <th class=\"col-sm-8\" style=\"text-align: center;\">\n                        {{tlt('sms_model_values_label')}}\n                      </th>\n                      </tr>\n                      <tr\n                        v-for=\"(item, j) in current_template.variable_list\"\n                        :key=\"j\"\n                      >\n                      <td v-for=\"(value, c) in item\"\n                          :key=\"c\">\n                        {{c}}\n                      </td>\n                      <td>\n                        <input class=\"form-control\" \n                          type=\"text\"\n                          v-for=\"(value, d) in item\"\n                          :key=\"d\" \n                          v-model=\"current_template.variable_list[j][d]\" \n                          style=\"\n                            width: 100%;\n                            height: 25px;\n                            margin-left: 10px;\n                            padding: 0px 10px;\n                          \"\n                          :title=\"d == 'customer_name'? 'Customers Name will be picked from customers list while sending SMS':''\"\n                          :disabled=\"d == 'customer_name'\"\n                        >\n                      </td>\n                      </tr>\n                    </tbody>\n                  </table>\n              </div>\n              <div class=\"modal-footer\" v-if=\"isEditTemplate\">\n                <div class=\"dash-modal\">\n                  <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n                    <button\n                      type=\"button\"\n                      class=\"btn btn-link\"\n                      style=\"border-radius: 0\"\n                      data-dismiss=\"modal\"\n                      @click=\"edit_template_details\"\n                    >\n                      {{tlt('sms_model_cancel_btn')}}\n                    </button>\n                    <button\n                      type=\"submit\"\n                      class=\"darkblue-btn\"\n                      id=\"res_n_int_save\"\n                      @click=\"edit_template()\"\n                    >\n                      {{tlt('sms_model_save_btn')}}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"col-sm-12 d-flex px-0 py-5\" v-else-if=\"search_name == ''\">\n          <h4 class=\"mx-auto\">\n            {{tlt('sms_msg_no_template_present')}}\n          </h4>\n        </div>\n        <div class=\"col-sm-12 d-flex px-0 py-5\" v-else-if=\"templatelist.length == 0 && search_name != ''\">\n          <h4 class=\"mx-auto\">\n            {{tlt('sms_msg_no_template_not_found')}}\n          </h4>\n        </div>\n        <div class=\"pagin-table pb-3\" v-if=\"templatelist.length > 0\" style=\"margin-top: 2%\">\n          <nav aria-label=\"Page navigation example\">\n            <ul class=\"pagination justify-content-center\">\n              <li class=\"page-item\">\n                <a\n                  class=\"page-link\"\n                  href=\"#\"\n                  @click=\"page_require(page_no - 1)\"\n                >\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    width=\"8.667\"\n                    height=\"15.204\"\n                    viewBox=\"0 0 8.667 15.204\"\n                  >\n                    <g\n                      id=\"arrow-point-to-left\"\n                      transform=\"translate(105.806 15.204) rotate(180)\"\n                    >\n                      <path\n                        id=\"Path_1136\"\n                        data-name=\"Path 1136\"\n                        d=\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\"\n                        transform=\"translate(0 0)\"\n                        fill=\"#9499ae\"\n                      />\n                    </g>\n                  </svg>\n                </a>\n              </li>\n              <li\n                :class=\"'page-item ' + pagination_class(pageno)\"\n                v-for=\"pageno in page_array\"\n                :key=\"pageno\"\n              >\n                <a\n                  v-if=\"pageno == '...s' || pageno == '...l'\"\n                  class=\"page-link\"\n                  href=\"#\"\n                  @click=\"page_require(pageno)\"\n                  >...</a\n                >\n                <a\n                  v-if=\"pageno != '...s' && pageno != '...l'\"\n                  class=\"page-link\"\n                  href=\"#\"\n                  @click=\"page_require(pageno)\"\n                  >{{ pageno }}</a\n                >\n              </li>\n              <li class=\"page-item\">\n                <a\n                  class=\"page-link\"\n                  href=\"#\"\n                  @click=\"page_require(page_no + 1)\"\n                >\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    width=\"8.667\"\n                    height=\"15.204\"\n                    viewBox=\"0 0 8.667 15.204\"\n                  >\n                    <g\n                      id=\"arrow-point-to-right\"\n                      transform=\"translate(-97.139 0)\"\n                    >\n                      <path\n                        id=\"Path_1136\"\n                        data-name=\"Path 1136\"\n                        d=\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\"\n                        transform=\"translate(0 0)\"\n                        fill=\"#9499ae\"\n                      />\n                    </g>\n                  </svg>\n                </a>\n              </li>\n            </ul>\n          </nav>\n        </div>\n      </div>\n      </div>\n    </div>\n    <div\n      id=\"addtemplatemodel\"\n      class=\"modal fade dash-modal\"\n      role=\"dialog\"\n      data-backdrop=\"static\"\n      data-keyboard=\"false\"\n    >\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-body\">\n            <div class=\"modal-head d-flex align-items-center\">\n              <div class=\"head-icn\">\n                <img src=\"/img/msg-blue.png\" alt />\n              </div>\n              <h3>{{tlt('sms_model_add_template_header')}}</h3>\n              <button\n                type=\"button\"\n                class=\"close\"\n                @click=\"empty_variable\"\n                data-dismiss=\"modal\"\n              >\n                <img src=\"/img/close-icn.png\" alt />\n              </button>\n            </div>\n            <div class=\"form-group\">\n              <h5>\n                <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_model_name_label')}}</p>\n              </h5>\n              <div>\n                <input\n                  id=\"template_name_add_id\"\n                  type=\"text\"\n                  v-model.trim=\"template_name\"\n                  v-on:keyup=\"validate_template_name\"                    \n                  class=\"form-control\"\n                  style=\"padding: 0.375rem 0.75rem\"\n                  :placeholder=\"tlt('template_name_label')\"\n                />\n                <span\n                  v-show=\"template_name_already_exist\"\n                  style=\"color: red\"\n                  >{{tlt('template_name_exist_msg')}}</span\n                >\n              </div>\n            </div>\n            <div class=\"form-group\">\n                <h5>\n                  <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_model_promotional_template_header')}}</p>\n                </h5>\n              <div class=\"container\">\n                <div class=\"row\">\n              <div class=\"col-6\" v-for=\"(template, index) in default_templatelist\"\n                          :key=\"index\">\n                <label style=\"cursor: pointer;\">\n                  <input\n                    v-model=\"choosen_template\"\n                    @change=\"preview_template_data = ''\"\n                    type=\"radio\"\n                    id=\"template_radio_id\"\n                    :value=\"template\"\n                    required\n                  />\n                  <span class=\"icn\" id=\"template_radio_icon_id\"></span>\n                  {{ template.template_name }}\n                </label>\n              </div>\n              </div>\n            </div>\n            <h5>\n              <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_model_template_example_label')}}</p>\n            </h5>\n            <p v-if=\"choosen_template != null\">{{choosen_template.template_example}}</p>\n            <p v-else>{{tlt('sms_model_select_a_template_text')}}</p>\n            </div>\n            <div v-if=\"choosen_template != null\">\n            <div class=\"form-group\">\n              <h5>\n                <p class=\"mt-2 mb-0\" style=\"color: #414141\">Template Body</p>\n              </h5>\n              <div style=\"padding-left: 15px\">\n                <p>{{ choosen_template.template_body }}</p>\n              </div>\n            </div>\n            <div v-if=\"preview_template_data != ''\" class=\"form-group\">\n              <h5>\n                <p class=\"mt-2 mb-0\" style=\"color: #414141\">Template Preview</p>\n              </h5>\n              <div style=\"padding-left: 15px\">\n                <p>{{ preview_template_data }}</p>\n              </div>\n            </div>\n            <div class=\"form-group\">\n              <h5>\n                <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('template_variable_label')}}</p>\n              </h5>\n                 <table>\n                   <tbody>\n                    <tr>\n                    <th style=\"text-align: center;\">\n                      {{tlt('sms_model_variable_label1')}}\n                    </th>\n                    <th style=\"text-align: center;\">\n                      {{tlt('sms_model_values_label1')}}\n                    </th>\n                    </tr>\n                    <tr\n                      v-for=\"(item, k) in choosen_template.variable_list\"\n                      :key=\"k\"\n                    >\n                   \n                    <td v-for=\"(value, e) in item\"\n                    :key=\"e\">\n                      {{e}}:\n                    </td>\n                    <td>\n                      <input class=\"form-control\" \n                         type=\"text\"\n                         @keyup=\"preview_template('new')\"\n                         v-for=\"(value, f) in item\"\n                          :key=\"f\"\n                         v-model=\"choosen_template.variable_list[k][f]\" \n                         style=\"\n                          width: 100%;\n                          height: 25px;\n                          margin-left: 10px;\n                        \"\n                        :title=\"f == 'customer_name'? 'Customers Name will be picked from customers list while sending SMS':''\"\n                        :disabled=\"f == 'customer_name'\"\n                      >\n                    </td>\n                    </tr>\n                   </tbody>\n                 </table>\n            </div>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n              <button\n                type=\"button\"\n                class=\"btn btn-link\"\n                data-dismiss=\"modal\"\n                @click=\"empty_variable\"\n              >\n                {{tlt('sms_model_cancel_btn')}}\n              </button>\n              <!-- <button\n                v-show=\"current_step == 1 && Boolean(choosen_template) != false\"\n                type=\"button\"\n                class=\"darkblue-btn\"\n                @click=\"change_step(2)\"\n              >\n                Next\n              </button>\n              <button\n                v-show=\"current_step == 2\"\n                type=\"button\"\n                class=\"darkblue-btn\"\n                @click=\"change_step(1)\"\n              >\n                Back\n              </button> -->\n              <!-- <button\n                v-show=\"current_step == 2\"\n                type=\"button\"\n                class=\"darkblue-btn\"\n                @click=\"preview_template('new')\"\n              >\n                Preview\n              </button> -->\n              <button\n                type=\"submit\"\n                class=\"darkblue-btn\"\n                id=\"res_n_int_save\"\n                data-dismiss=\"\"\n                @click=\"save_template()\"\n              >\n                {{tlt('sms_model_add_btn')}}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      id=\"sendsms\"\n      class=\"modal fade dash-modal\"\n      role=\"dialog\"\n      data-backdrop=\"static\"\n      data-keyboard=\"false\"\n    >\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-body\">\n            <div class=\"modal-head d-flex align-items-center\">\n              <div class=\"head-icn\">\n                <img src=\"/img/msg-blue.png\" alt />\n              </div>\n              <h3>{{tlt('sms_template_model_send_header')}}</h3>\n              <button\n                type=\"button\"\n                class=\"close\"\n                @click=\"empty_variable\"\n                data-dismiss=\"modal\"\n              >\n                <img src=\"/img/close-icn.png\" alt />\n              </button>\n            </div>\n            <div class=\"form-group\">\n              <h5>\n                <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_template_model_name_label')}}</p>\n              </h5>\n              <div style=\"padding-left: 20px\">\n                <p>{{ current_template.template_name }}</p>\n              </div>\n            </div>\n            <div class=\"form-group\">\n              <div class=\"d-flex\">\n                <h5>\n                  <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_template_model_sendto_label')}}</p>\n                </h5>\n                <span\n                  v-if=\"!send_sms_all_customer\"\n                  style=\"\n                    margin-left: 12px;\n                    margin-top: 10px !important;\n                    color: #0645ad;\n                  \"\n                >\n                  <i\n                    class=\"fa fa-info-circle\"\n                    aria-hidden=\"true\"\n                    style=\"font-size: 16px\"\n                    title=\"you can also specify name while adding new number in this way (+91 9999999999,John Doe), note this would only work in the case where you add new number.\"\n                  >\n                  </i>\n                </span>\n              </div>\n              <div class=\"radio my-auto\" style=\"padding-left: 20px\">\n                <label>\n                  <input\n                    type=\"radio\"\n                    v-model=\"send_sms_all_customer\"\n                    :value=\"true\"\n                    id=\"send_sms_all_customer_true_id\"\n                  />\n                  <span class=\"icn\" id=\"filter_portal_user_radio\"></span>\n                  {{tlt('sms_template_model_all_cust_label')}}\n                </label>\n                <label>\n                  <input\n                    type=\"radio\"\n                    v-model=\"send_sms_all_customer\"\n                    :value=\"false\"\n                    id=\"send_sms_all_customer_false_id\"\n                  />\n                  <span class=\"icn\"></span>\n                  {{tlt('sms_template_model_specific_cust_label')}}\n                </label>\n              </div>\n            </div>\n            <div class=\"form-group\" v-if=\"!send_sms_all_customer\">\n              <label>\n                {{tlt('sms_template_model_add_customer_text')}}\n              </label>\n              <div class=\"d-flex mb-3\">\n                <input \n                  class=\"form-control\"\n                  type=\"text\"\n                  :placeholder=\"tlt('customer_name')\" \n                  v-model=\"add_customer_name\"\n                  style=\"width: 12rem; margin-right: 9px;\"\n                 >\n                <vue-phone-number-input \n                  v-model=\"add_customer_contact_number\" \n                  :no-use-browser-locale=\"true\"\n                  @update=\"phoneNumber = $event\"\n                >\n                </vue-phone-number-input>\n                <button\n                  id=\"alternate_product_name_add_btn\"\n                  class=\"darkblue-btn ml-2\"\n                  @click=\"add_customer\"\n                >\n                  {{tlt('sms_model_add_btn')}}\n                </button>\n              </div>\n              <multiselect\n                v-model=\"specific_customer_list\"\n                :options=\"customers_list\"\n                id=\"specific_customer_list_id\"\n                :searchable=\"true\"\n                :close-on-select=\"false\"\n                :multiple=\"true\"\n                :taggable=\"true\"\n                tag-position=\"top\"\n                tag-placeholder=\"Add this as new email\"\n                :placeholder=\"tlt('customer_numer')\"\n                :max-height=\"400\"\n                label=\"customer_name\"\n                track-by=\"phone\"\n                open-direction=\"below\"\n              >\n                <!-- <span>{{ selected_role }}</span> -->\n              </multiselect>\n            </div>\n            <div class=\"form-group\">\n              <h5>\n                <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_template_model_body_label')}}</p>\n              </h5>\n              <div style=\"padding-left: 20px\">\n                <p>{{ current_template.template_body }}</p>\n              </div>\n            </div>\n            <div class=\"form-group\">\n              <h5>\n                <p class=\"mt-2 mb-0\" style=\"color: #414141\">{{tlt('sms_template_model_variables_header')}}</p>\n              </h5>\n              <table>\n                <tbody>\n                <tr>\n                <th style=\"text-align: center;\">\n                  {{tlt('sms_template_model_variable_label')}}\n                </th>\n                <th style=\"text-align: center;\">\n                  {{tlt('sms_template_model_values_label')}}\n                </th>\n                </tr>\n                <tr\n                  v-for=\"(item, l) in current_template.variable_list\"\n                  :key=\"l\"\n                >\n                <td class=\"col-4\" v-for=\"(value, g) in item\"\n                    :key=\"g\">\n                  {{g}}\n                </td>\n                <td class=\"col-8\">\n                  <input class=\"form-control\" \n                      type=\"text\"\n                      v-for=\"(value, h) in item\"\n                      :key=\"h\" \n                      v-model=\"current_template.variable_list[l][h]\"\n                      style=\"\n                      width: 100%;\n                      height: 25px;\n                      margin-left: 10px;\n                    \"\n                    :title=\"h == 'customer_name'? 'Customers Name will be picked from customers list while sending SMS':''\"\n                    :disabled=\"h == 'customer_name'\"\n                  >\n                </td>\n                </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <div class=\"btn-wrap text-right mt-0 py-0 border-top-0\">\n              <button\n                type=\"button\"\n                class=\"btn btn-link\"\n                data-dismiss=\"modal\"\n                @click=\"empty_variable\"\n              >\n                {{tlt('sms_model_cancel_btn')}}\n              </button>\n              <button\n                type=\"submit\"\n                class=\"darkblue-btn\"\n                id=\"save_sms_button\"\n                @click=\"send_sms()\"\n              >\n                {{tlt('sms_model_send_btn')}}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      class=\"modal fade\"\n      id=\"preview_template_visible\"\n      role=\"dialog\"\n      aria-labelledby=\"preview_template_visible\"\n      aria-hidden=\"true\"\n      style=\"z-index: 2000;\"\n    >\n      <div\n        class=\"modal-dialog modal-dialog-centered modal\"\n        role=\"document\"\n      >\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <i style='font-size:24px; padding-right: 10px; padding-top: 3px;' class='far'>&#xf27a;</i>\n            <h5 class=\"modal-title\">\n              {{tlt('sms_model_preview_header')}} \n            </h5>\n            <button\n              type=\"button\"\n              class=\"close\"\n              data-dismiss=\"modal\"\n              aria-label=\"Close\"\n            >\n              <img src=\"/img/close-icn.png\" alt />\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            <textarea class=\"text-area\" disabled name=\"msg\" v-model=\"preview_template_data\"></textarea>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div\n      class=\"modal fade\"\n      id=\"checkbalance\"\n      role=\"dialog\"\n      aria-labelledby=\"checkbalance\"\n      aria-hidden=\"true\"\n    >\n      <div\n        class=\"modal-dialog modal-dialog-centered modal\"\n        role=\"document\"\n        style=\"max-width: 600px !important\"\n      >\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <!-- <i style='font-size:24px; padding-right: 10px; padding-top: 3px;' class='far'>&#xf27a;</i> -->\n            <h5 class=\"modal-title\">\n              {{tlt('sms_model_add_on_header')}} \n            </h5>\n            <button\n              type=\"button\"\n              class=\"close\"\n              data-dismiss=\"modal\"\n              aria-label=\"Close\"\n            >\n              <img src=\"/img/close-icn.png\" alt />\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            <div>\n            </div>\n            <p v-show=\"credits_balance != null\"\n              v-html=\"credits_balance\"> &nbsp; &nbsp;\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { VueEditor } from \"vue2-editor\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nimport api_calls from \"@/portal/api_calls\";\nimport { freeze_portal,show_subscription_expired_swal , close_modal } from \"@/portal/mixins\";\nimport Multiselect from \"vue-multiselect\";\nimport VuePhoneNumberInput from 'vue-phone-number-input';\nimport 'vue-phone-number-input/dist/vue-phone-number-input.css';\n\n\nexport default {\n  name: \"SmsTemplatePage\",\n  components: {\n    VueEditor,\n    Multiselect,\n    VuePhoneNumberInput,\n  },\n  mixins: [freeze_portal,show_subscription_expired_swal , close_modal],\n  data() {\n    return {\n      pencil_svg:\n        ' <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15.546\" height=\"15.461\" viewBox=\"0 0 15.546 15.461\"><defs><style>.a{fill:#9e9e9e;}</style></defs><g transform=\"translate(-747.888 -356.769)\"><path class=\"a\" d=\"M759.416,356.769a2.358,2.358,0,0,1,1.777.662c.534.513,1.072,1.025,1.567,1.575a2.3,2.3,0,0,1-.071,3.325c-2.736,2.76-5.494,5.5-8.238,8.251a1.381,1.381,0,0,1-.758.288c-.719.174-1.429.379-2.144.572-.932.251-1.862.5-2.795.751-.6.158-.989-.213-.832-.807q.689-2.595,1.406-5.182a1.164,1.164,0,0,1,.289-.487q4.091-4.107,8.2-8.2A2.265,2.265,0,0,1,759.416,356.769Zm-1.989,2.956-6.54,6.538,3.025,3.024,6.538-6.537Zm4.023,2.165c.118-.135.225-.269.343-.392a1.134,1.134,0,0,0,0-1.734c-.46-.466-.926-.925-1.388-1.39a1.166,1.166,0,0,0-.861-.368c-.578,0-.881.4-1.214.76Zm-12.084,8.863,3.2-.863-2.337-2.331Z\" transform=\"translate(0)\"/><path class=\"a\" d=\"M813.942,422.6l-.789-.8,3.821-3.819.784.8Z\" transform=\"translate(-59.648 -55.947)\"/></g></svg>',\n      company_id: this.$session.get(\"UserInformation\").company_id,\n      company_name: this.$session.get(\"UserInformation\").company_name,\n      spinnerOn: false,\n      template_name: \"\",\n      save_sms: \"\",\n      is_sms: false,\n      is_email: true,\n      save_subject: \"\",\n      is_publish_sms: true,\n      verification_status: null,\n      default_templatelist: [],\n      templatelist: [],\n      checked_list: [],\n      current_template: [],\n      old_template_name: \"\",\n      isEditTemplate: false,\n      number_of_rows: null,\n      total_pages: null,\n      page_no: 1,\n      per_page: 10,\n      preview_template_data: \"\",\n      template_name_already_exist: false,\n      edit_template_name_already_exist: false,\n      page_array: [],\n      send_sms_all_customer: true,\n      customers_list: [],\n      specific_customer_list: [],\n      disable_btn_expired: false,\n      // current_step: 1,\n      choosen_template: null,\n      isVisibleSearchClear: false,\n      search_name: \"\",\n      add_customer_contact_number: null,\n      add_customer_name: null,\n      phoneNumber: null,\n      credits_balance: null\n    };\n  },\n  props: {\n    is_notification_template: Boolean,\n  },\n  created() {\n    if (this.$session.get(\"UserInformation\").role == \"SuperAdmin\") {\n      this.companyid = this.$session.get(\"CompanyId\");\n      this.companyname = this.$session.get(\"CompanyName\");\n    } else {\n      this.companyid = this.$session.get(\"UserInformation\").company_id;\n      this.companyname = this.$session.get(\"UserInformation\").company_name;\n    }\n  },\n  watch: {\n    search_name() {\n      if (this.search_name === \"\") {\n        this.load_templates();\n        this.isVisibleSearchClear = false;\n      } else if (this.search_name !== \"\") {\n        this.isVisibleSearchClear = true;\n      }\n    },\n  },\n  mounted() {\n    setTimeout(() => {\n      this.freeze_portal();\n    }, 2000);\n     this.$root.$on(\"SmsTemplatePageDisabled\", (data) =>{\n      if(data===true){\n        this.disable_btn_expired = true;\n      }\n    })\n    this.load_templates();\n    if (this.is_notification_template === false){\n      this.load_customer_list();\n    }\n    var vm = this;\n    $(\"#selectall\").click(function () {\n      this.isEditTemplate = false;\n      this.is_sms = false;\n      this.is_email = true;\n      if ($(this).is(\":checked\")) {\n        $(\"input:checkbox\").prop(\"checked\", true);\n      } else {\n        vm.checked_list = [];\n        $(\"input:checkbox\").prop(\"checked\", false);\n      }\n    });\n  },\n  methods: {\n    add_customer() {\n      if(this.phoneNumber.isValid == true && this.add_customer_name != \"\") {\n        this.customers_list.push(\n          {\n            'phone': this.phoneNumber.formattedNumber,\n            'country': this.phoneNumber.countryCode,\n            'customer_name': this.add_customer_name\n          }\n        )\n        this.specific_customer_list.push(\n          {\n            'phone': this.phoneNumber.formattedNumber,\n            'country': this.phoneNumber.countryCode,\n            'customer_name': this.add_customer_name\n          }\n        )\n        this.add_customer_name = \"\";\n      } else {\n        Swal({\n          text: this.tlt('sms_template_valid_phone_no'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n      }\n    },\n    check_addons_balance() {\n      axios.post(\n        api_calls.check_addons_balance(),\n        {\n          company_name: this.companyname,\n          company_id: this.companyid,\n          check_balance: true\n        },\n        {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n      )\n      .then((response) =>{\n        if (this.api_status_code.CHECK_BALANCE.MSG_CODE === response.data.message.MSG_CODE) {\n            var template_count = response.data.data.credits.sms_count;\n            this.credits_balance =\n            \"Your current SMS credits are <strong> for US region :\" +\n            template_count.us +\n            \" | for Non-US region: \" +\n            template_count.non_us +\n            \"</strong>\";\n            $(\"#checkbalance\").modal(\"show\");\n          } else {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n          }\n        })\n        .catch((e) => {\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    clear_search_name() {\n      this.search_name = \"\";\n    },\n    callsearch() {\n      if (this.search_name != \"\"){\n        this.spinnerOn = true;\n        axios\n          .post(\n            api_calls.template_promotional_sms(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_search: true,\n              page_no: 1,\n              per_page: this.per_page,\n              is_notification: this.is_notification_template,\n              search_key: this.search_name\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            this.templatelist = [];\n            if (this.api_status_code.NO_SMS_TEMPLATE_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n              this.templatelist = [];\n              return;\n            } else if (this.api_status_code.TEMPLATE_SEARCH_RESULT_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n              this.templatelist = response.data.data.templates;\n              if (this.templatelist.length > 0) {\n                this.show_template(0);\n              }\n              this.number_of_rows = response.data.pagination.total_data == undefined ? 0 : response.data.pagination.total_data;\n              this.total_pages = response.data.pagination.total_page == undefined ? 0 : response.data.pagination.total_page;\n              this.setpagination(this.page_no);\n            } else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n          })\n          .catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n      }\n    },\n    save_template() {\n      if (this.template_name == \"\"){\n        Swal({\n          text: this.tlt('sms_template_name_blank_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } \n      if(this.choosen_template == null){\n        Swal({\n          text: \"Please select the template\",\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      }\n      if(this.choosen_template != null){\n        var check = false;\n        for(var i in this.choosen_template.variable_list) {\n          if (this.choosen_template.variable_list[i] == \"\"){\n            check = true\n          }\n        }\n        if (check) {\n          Swal({\n          text: this.tlt('sms_template_values_cannot_blank'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n        }\n      } \n      if (this.template_name_already_exist == true) {\n        return;\n      }\n        this.spinnerOn = true;\n        var template_details = {\n          template_name: this.template_name,\n          parent_template_id: this.choosen_template.template_id,\n          template_body: this.choosen_template.template_body,\n          variable_list: this.choosen_template.variable_list,\n          template_example: this.choosen_template.template_example\n        }\n        axios\n        .post(\n          api_calls.template_promotional_sms(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_save: true,\n            is_notification: this.is_notification_template,\n            template_details: template_details\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (this.api_status_code.SUCCESSFUL_DB_QUERY_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n            $(\"#addtemplatemodel\").modal(\"hide\");\n            Swal({\n              type: \"success\",\n              text: this.tlt('template_data_added_msg'),\n              timer: 2500,\n            }).then((result) => {\n              this.empty_variable();\n              this.load_templates();\n            });\n            this.isEditTemplate = false;\n          } else if (this.api_status_code.UNSUCCESSFUL_DB_QUERY.MSG_CODE == response.data.message.MSG_CODE) {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n            this.isEditTemplate = false;\n            return;\n          } else {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n            this.isEditTemplate = false;\n            return;\n          }\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n          this.close_modal('res_n_int_save')\n    },\n    edit_template_details() {\n      if (!this.isEditTemplate) {\n        this.isEditTemplate = true;\n      } else {\n        this.isEditTemplate = false;\n        this.load_templates();\n        this.edit_template_name_already_exist = false;\n      }\n    },\n    edit_template() {\n      if (this.current_template.template_name == \"\"){\n        Swal({\n          text: this.tlt('sms_edit_template_name_blank_msg'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      } \n      if(this.current_template != null){\n        var check = false;\n        for(var i in this.current_template.variable_list) {\n          if (this.current_template.variable_list[i] == \"\"){\n            check = true\n          }\n        }\n        if (check) {\n          Swal({\n          text: this.tlt('sms_edit_template_values_cannot_blank'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n        }\n      } \n      if (this.edit_template_name_already_exist == true) {\n        return;\n      }\n        this.spinnerOn = true;\n        var template_details = {\n          template_name: this.current_template.template_name,\n          parent_template_id: this.current_template.parent_template_id,\n          template_id: this.current_template.template_id,\n          template_body: this.current_template.template_body,\n          variable_list: this.current_template.variable_list,\n          template_example: this.current_template.template_example\n        }\n        axios\n        .post(\n          api_calls.template_promotional_sms(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            template_details: template_details,\n            template_id: this.current_template.template_id,\n            is_edit: true,\n            is_notification: this.is_notification_template,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (this.api_status_code.SUCCESSFUL_DB_QUERY_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n            $(\"#addtemplatemodel\").modal(\"hide\");\n            Swal({\n              type: \"success\",\n              text: this.tlt('template_data_edit_msg'),\n              timer: 2500,\n            }).then((result) => {\n              this.empty_variable();\n              this.load_templates();\n            });\n            this.isEditTemplate = false;\n          } else if (this.api_status_code.UNSUCCESSFUL_DB_QUERY.MSG_CODE == response.data.message.MSG_CODE) {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n            this.isEditTemplate = false;\n          } else {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n            this.isEditTemplate = false;\n          }\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    // change_step(val) {\n    //   if (val == 2 && Boolean(this.choosen_template) != false){\n    //     this.current_step = 2\n    //   }else if(val == 1) {\n    //     this.current_step = 1\n    //   } else {\n    //     Swal({\n    //       text: this.tlt('select_template_msg'),\n    //       toast: true,\n    //       position: \"top-end\",\n    //       type: \"warning\",\n    //       showConfirmButton: false,\n    //       timer: 2500,\n    //     });\n    //   }\n    // },\n    load_customer_list() {\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.template_promotional_sms(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            get_customers_list: true,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (this.api_status_code.STATUS_SUCCESS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n            this.customers_list = response.data.data.customer_list;\n          } else if (this.api_status_code.NO_CUSTOMER_DATA_AVAILABLE_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n            this.customers_list = [];\n          } else {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n          }\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    send_sms() {\n      if(!this.disable_btn_expired){\n        axios.post(\n        api_calls.template_promotional_sms(),\n        {\n          company_name: this.companyname,\n          company_id: this.companyid,\n          email: this.$session.get(\"UserInformation\").email,\n          license_key: this.$session.get(\"UserInformation\").license_key,\n          token: this.$session.get(\"UserInformation\").tokens,\n          subscription: this.$session.get(\"UserInformation\").subscription,\n          is_notification: this.is_notification_template,\n          template_id: this.current_template.template_id,\n          send_sms_all_customer: this.send_sms_all_customer, \n          specific_customers_list: this.specific_customer_list,\n          send_sms: true\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${this.$session.get(\"at\")}`,\n          },\n        }\n      )\n      .then((response) =>{\n        if (this.api_status_code.SMS_TEMPLATE_NOT_FOUND_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n          Swal({\n              title: this.tlt('send_sms_credit1'),\n              text: this.tlt('no_credits_left_msg'),\n              type: \"warning\",\n              showConfirmButton: false,\n              timer: 2500,\n            });\n            \n        } else if (this.api_status_code.NO_CUSTOMER_DATA_AVAILABLE_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n          Swal({\n            title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"info\",\n              toast: true\n          })\n          \n        } else if (this.api_status_code.NON_US_SMS_CREDITS_EXCEEDS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n            Swal({\n              title: this.tlt('send_sms_credit1'),\n              text: this.tlt('no_credits_left_msg'),\n              type: \"warning\",\n              showConfirmButton: true,\n              timer: 4000,\n            });\n            \n        } else if (this.api_status_code.SENDING_SMS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n            Swal({\n              title: this.tlt('sms_is_sent_msg'),\n              type: \"success\",\n              showConfirmButton: true,\n              timer: 2500,\n            });\n            this.empty_variable();\n        \n        } else if (this.api_status_code.US_SMS_CREDITS_EXCEEDS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              type: \"warning\",\n              showConfirmButton: false,\n              timer: 4000,\n            });\n            \n        } else {\n          Swal({\n            title: response.data.message.MSG_CODE,\n            text: response.data.message.MSG,\n            showCancelButton: false,\n            showConfirmButton: true,\n            type: \"error\"\n          })\n          \n        }\n        })\n        .catch((e) => {\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n\n      \n      }else{\n        this.show_subscription_expired_swal();\n      }\n        this.close_modal('save_sms_button')\n    },\n    validate_template_name() {\n      axios.post(\n        api_calls.template_promotional_sms(),\n        {\n          company_name: this.companyname,\n          company_id: this.companyid,\n          email: this.$session.get(\"UserInformation\").email,\n          license_key: this.$session.get(\"UserInformation\").license_key,\n          token: this.$session.get(\"UserInformation\").tokens,\n          subscription: this.$session.get(\"UserInformation\").subscription,\n          is_template_name_exists: true,\n          is_notification: this.is_notification_template,\n          template_name: this.template_name,\n        },\n        {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n      )\n      .then((response) =>{\n        if (this.api_status_code.SMS_TEMPLATE_NAME_DOES_NOT_EXISTS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n            this.template_name_already_exist = false;\n            document.getElementById(\"template_name_add_id\").style.border =null;\n            if(this.template_name != \"\"){\n              // document.getElementById(\"template_name_add_id\").style.border =\n              // \"1px solid green\";\n            }\n          } else if (this.api_status_code.SMS_TEMPLATE_NAME_EXISTS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n            this.template_name_already_exist = true;\n            document.getElementById(\"template_name_add_id\").style.border =\n            \"1px solid red\";\n          } else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n        })\n        .catch((e) => {\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    validate_edit_template_name() {\n      axios.post(\n        api_calls.template_promotional_sms(),\n        {\n          company_name: this.companyname,\n          company_id: this.companyid,\n          email: this.$session.get(\"UserInformation\").email,\n          license_key: this.$session.get(\"UserInformation\").license_key,\n          token: this.$session.get(\"UserInformation\").tokens,\n          subscription: this.$session.get(\"UserInformation\").subscription,\n          is_template_name_exists: true,\n          is_notification: this.is_notification_template,\n          template_name: this.current_template.template_name,\n        },\n        {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n      )\n      .then((response) =>{\n        if (this.api_status_code.SMS_TEMPLATE_NAME_DOES_NOT_EXISTS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n          this.edit_template_name_already_exist = false;\n          document.getElementById(\"edit_template_name_id\").style.border =null;\n          if(this.current_template.template_name != \"\"){\n            // document.getElementById(\"edit_template_name_id\").style.border =\n            // \"1px solid #00f000\";\n          }\n        } else if (this.api_status_code.SMS_TEMPLATE_NAME_EXISTS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n          if (this.old_template_name == this.current_template.template_name){\n            this.edit_template_name_already_exist = false;\n            document.getElementById(\"edit_template_name_id\").style.border =null;\n          }else{\n            this.edit_template_name_already_exist = true;\n            document.getElementById(\"edit_template_name_id\").style.border =\n            \"1px solid red\";\n          }\n        } else {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n        }\n        })\n        .catch((e) => {\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    preview_template(val) {\n      this.spinnerOn = true;\n      if (val == \"old\") {\n        var template_body = this.current_template.template_body\n        var variables_list = this.current_template.variable_list\n      } else if (val == \"new\") {\n        var template_body = this.choosen_template.template_body\n        var variables_list = this.choosen_template.variable_list\n      }\n      axios\n      .post(\n        api_calls.template_promotional_sms(),\n        {\n          company_id: this.company_id,\n          company_name: this.company_name,\n          is_notification: this.is_notification_template,\n          is_preview: true,\n          template_body: template_body,\n          variables_list: variables_list\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${this.$session.get(\"at\")}`,\n          },\n        }\n      )\n      .then((response) => {\n        this.spinnerOn = false;\n        if (this.api_status_code.STATUS_SUCCESS_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n          this.preview_template_data = response.data.data.body;\n          if(val == \"old\"){\n            $(\"#preview_template_visible\").modal(\"show\");\n          }\n        }\n      })\n      .catch((e) => {\n        this.spinnerOn = false;\n        if (\n          e.response.status === 410 ||\n          e.response.status === 440 ||\n          e.response.status === 409\n        ) {\n          this.$root.$emit(\"Session_Expired\", e.response.data);\n        }\n      });\n    },\n    send_email_confirm_prompt_text(all_customer) {\n      if (all_customer) {\n        return this.tlt('send_bulk_msg');\n      } else {\n        return this.tlt('email_to_specific_customer');\n      }\n    },\n    selected_templates(value) {\n      if(value == \"all\"){\n        if (event.target.checked) {\n          this.checked_list = [];\n            for (var i in this.templatelist) {\n              this.checked_list.push(this.templatelist[i].template_id);\n          }\n          $(\"input:checkbox\").prop(\"checked\", false);\n          for(let i = 0; i < this.checked_list.length; i++){\n            $(\"#\"+[i]).prop(\"checked\", true);\n            $(\"#selectall\").prop(\"checked\", true);\n          }\n        }else if (!event.target.checked){\n          this.checked_list = [];\n          $(\"input:checkbox\").prop(\"checked\", false);\n        }\n\n      }else{\n        if (event.target.checked) {\n          this.checked_list.push(value);\n        } else if (!event.target.checked){\n          var selectall = document.querySelector(\"#selectall\");\n          if (selectall.checked) {\n            selectall.checked = false;\n          }\n          var temp = this.checked_list.filter((templates_id) => {\n            return templates_id != value;\n          });\n          this.checked_list = temp;\n        }\n      }\n    },\n    delete_template() {\n      if(this.checked_list.length < 1){\n        Swal({\n          text: this.tlt('select_one_template'),\n          toast: true,\n          position: \"top-end\",\n          type: \"warning\",\n          showConfirmButton: false,\n          timer: 2500,\n        });\n        return;\n      }\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.template_promotional_sms(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_notification: this.is_notification_template,\n            is_delete: true,\n            template_list: this.checked_list\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          this.load_templates();\n          this.empty_variable();\n          this.checked_list = [];\n          if (this.api_status_code.SUCCESSFUL_DB_QUERY_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n            Swal({\n              text: this.tlt('template_deleted_msg'),\n              type: \"success\",\n              showConfirmButton: false,\n              timer: 2500,\n            });\n            return;\n          } else if (this.api_status_code.UNSUCCESSFUL_DB_QUERY_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n            Swal({\n              text: this.tlt('sms_internal_server'),\n              type: \"error\",\n              showConfirmButton: false,\n              timer: 2500,\n            });\n          } else {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n          }\n          this.isEditTemplate = false;\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    load_templates() {\n\n      // Get default templates\n      this.spinnerOn = true;\n      axios\n        .post(\n          api_calls.template_promotional_sms(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_notification: this.is_notification_template,\n            is_get_default_templates: true\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          if (response.data != null) {\n            this.default_templatelist = [];\n            if (this.api_status_code.STATUS_SUCCESS_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              this.default_templatelist = response.data.data.default_templates;\n              return;\n            } else if (this.api_status_code.NO_DEFAULT_SMS_TEMPLATE_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            } else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n            this.isEditTemplate = false;\n          }\n        })\n        .catch((e) => {\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n\n      // Get Saved Templates\n      axios\n        .post(\n          api_calls.template_promotional_sms(),\n          {\n            company_id: this.company_id,\n            company_name: this.company_name,\n            is_get: true,\n            is_notification: this.is_notification_template,\n            page_no: this.page_no,\n            per_page: this.per_page,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${this.$session.get(\"at\")}`,\n            },\n          }\n        )\n        .then((response) => {\n          this.spinnerOn = false;\n          this.templatelist = [];\n          this.number_of_rows = response.data.pagination.total_data == undefined ? 0 : response.data.pagination.total_data;\n          this.total_pages = response.data.pagination.total_page == undefined ? 0 : response.data.pagination.total_page;\n          if (this.api_status_code.NO_SMS_TEMPLATE_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n            this.templatelist = [];\n            return;\n          } else if(this.api_status_code.TEMPLATE_SEARCH_RESULT_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n            this.templatelist = response.data.data.templates;\n            if (this.templatelist.length > 0) {\n              this.show_template(0);\n            }\n          } else {\n            Swal({\n              title: response.data.message.MSG_CODE,\n              text: response.data.message.MSG,\n              showCancelButton: false,\n              showConfirmButton: false,\n              type: \"error\"\n            })\n          } \n          this.isEditTemplate = false;\n          this.setpagination(this.page_no);\n        })\n        .catch((e) => {\n          this.spinnerOn = false;\n          if (\n            e.response.status === 410 ||\n            e.response.status === 440 ||\n            e.response.status === 409\n          ) {\n            this.$root.$emit(\"Session_Expired\", e.response.data);\n          }\n        });\n    },\n    page_require(page) {\n      if (page == 0 || page == this.total_pages + 1) {\n      } else {\n        if (this.search_name == \"\") {\n          if (page == \"...s\") {\n            this.page_no = Math.ceil((1 + this.page_no) / 2);\n          } else if (page == \"...l\") {\n            this.page_no = Math.ceil((this.total_pages + this.page_no) / 2);\n          } else {\n            this.page_no = page;\n          }\n          $(\"input:checkbox\").prop(\"checked\", false);\n          this.spinnerOn = true;\n          axios\n            .post(\n              api_calls.template_promotional_sms(),\n              {\n                company_id: this.company_id,\n                company_name: this.company_name,\n                is_get: true,\n                is_notification: this.is_notification_template,\n                page_no: this.page_no,\n                per_page: this.per_page,\n              },\n              {\n                headers: {\n                  Authorization: `Bearer ${this.$session.get(\"at\")}`,\n                },\n              }\n            )\n            .then((response) => {\n              this.spinnerOn = false;\n              this.number_of_rows = response.data.pagination.total_data == undefined ? 0 : response.data.pagination.total_data;\n              this.total_pages = response.data.pagination.total_page == undefined ? 0 : response.data.pagination.total_page;\n              if (this.api_status_code.NO_SMS_TEMPLATE_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                this.templatelist = [];\n                return;\n              } else if(this.api_status_code.TEMPLATE_SEARCH_RESULT_MODELS.MSG_CODE == response.data.message.MSG_CODE) {\n                this.templatelist = response.data.data.templates;\n                if (this.templatelist.length > 0) {\n                  this.current_template = this.templatelist[0];\n                  this.show_template(0);\n                }\n              } else {\n                Swal({\n                  title: response.data.message.MSG_CODE,\n                  text: response.data.message.MSG,\n                  showCancelButton: false,\n                  showConfirmButton: false,\n                  type: \"error\"\n                })\n              } \n              this.setpagination(this.page_no);\n            })\n            .catch((e) => {\n              this.spinnerOn = false;\n              if (\n                e.response.status === 410 ||\n                e.response.status === 440 ||\n                e.response.status === 409\n              ) {\n                this.$root.$emit(\"Session_Expired\", e.response.data);\n              }\n            });\n        }else {\n          if (page == \"...s\") {\n            this.page_no = Math.ceil((1 + this.page_no) / 2);\n          } else if (page == \"...l\") {\n            this.page_no = Math.ceil((this.total_pages + this.page_no) / 2);\n          } else {\n            this.page_no = page;\n          }\n          $(\"input:checkbox\").prop(\"checked\", false);\n          axios\n          .post(\n            api_calls.template_promotional_sms(),\n            {\n              company_id: this.company_id,\n              company_name: this.company_name,\n              is_search: true,\n              page_no: this.page_no,\n              per_page: this.per_page,\n              is_notification: this.is_notification_template,\n              search_key: this.search_name\n            },\n            {\n              headers: {\n                Authorization: `Bearer ${this.$session.get(\"at\")}`,\n              },\n            }\n          )\n          .then((response) => {\n            this.spinnerOn = false;\n            this.templatelist = [];\n            if (this.api_status_code.NO_SMS_TEMPLATE_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n              this.templatelist = [];\n              return;\n            } else if (this.api_status_code.TEMPLATE_SEARCH_RESULT_MODELS.MSG_CODE === response.data.message.MSG_CODE) {\n              this.templatelist = response.data.data.templates;\n              if (this.templatelist.length > 0) {\n                this.show_template(0);\n              }\n              this.number_of_rows = response.data.pagination.total_data == undefined ? 0 : response.data.pagination.total_data;\n              this.total_pages = response.data.pagination.total_page == undefined ? 0 : response.data.pagination.total_page;\n              this.setpagination(this.page_no);\n            } else {\n              Swal({\n                title: response.data.message.MSG_CODE,\n                text: response.data.message.MSG,\n                showCancelButton: false,\n                showConfirmButton: false,\n                type: \"error\"\n              })\n            }\n            this.isEditTemplate = false;\n          })\n          .catch((e) => {\n            this.spinnerOn = false;\n            if (\n              e.response.status === 410 ||\n              e.response.status === 440 ||\n              e.response.status === 409\n            ) {\n              this.$root.$emit(\"Session_Expired\", e.response.data);\n            }\n          });\n        }\n      }\n    },\n    setpagination(page_no) {\n      this.page_array = [];\n      if (this.total_pages <= 7) {\n        for (let i = 0; i < this.total_pages; i++) {\n          this.page_array.push(i + 1);\n        }\n      } else if (page_no == 1) {\n        for (let i = 0; i < 4; i++) {\n          this.page_array.push(i + 1);\n        }\n        this.page_array.push(\"...l\");\n        this.page_array.push(this.total_pages);\n      } else if (page_no == this.total_pages) {\n        this.page_array.push(1);\n        this.page_array.push(\"...s\");\n        for (let i = this.total_pages - 4; i < this.total_pages; i++) {\n          this.page_array.push(i + 1);\n        }\n      } else if (page_no <= 4) {\n        for (let i = 0; i < page_no + 3; i++) {\n          this.page_array.push(i + 1);\n        }\n        this.page_array.push(\"...l\");\n        this.page_array.push(this.total_pages);\n      } else if (page_no >= this.total_pages - 4) {\n        this.page_array.push(1);\n        this.page_array.push(\"...s\");\n        for (let i = page_no - 4; i < this.total_pages; i++) {\n          this.page_array.push(i + 1);\n        }\n      } else {\n        this.page_array.push(1);\n        this.page_array.push(\"...s\");\n        for (let i = page_no - 3; i <= page_no + 3; i++) {\n          this.page_array.push(i);\n        }\n        this.page_array.push(\"...l\");\n        this.page_array.push(this.total_pages);\n      }\n    },\n    pagination_class(index) {\n      if (index == this.page_no) {\n        return \" active\";\n      } else {\n        return \"\";\n      }\n    },\n    show_template(index) {\n      this.current_template = JSON.parse(JSON.stringify(this.templatelist[index]));\n      this.old_template_name = this.current_template.template_name;\n      this.current_template_index = index;\n      this.isEditTemplate = false;\n    },\n    empty_variable() {\n      if(!this.disable_btn_expired) {\n        this.choosen_template = null;\n        this.current_step = 1;\n        this.specific_customer_list = [];\n        this.save_sms = \"\";\n        this.template_name = \"\";\n        this.old_template_name = \"\";\n        this.template_name_already_exist = false;\n        document.getElementById(\"template_name_add_id\").style.border = null;\n      }else {\n        this.show_subscription_expired_swal();\n      }\n    },\n    check_current_template_active(index) {\n      // console.table(index, this.templatelist[index], this.current_template);\n      if (Boolean(this.templatelist[index]) === true) {\n        return this.templatelist[index].template_name ===\n          this.old_template_name\n          ? \"current-active-template\"\n          : null;\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.current-active-template {\n  background: rgba(0, 0, 0, 0.1);\n}\n.modal-xl {\n  max-width: 1140px;\n  min-height: 1140px;\n}\n.table-box tbody tr:hover td,\n.table-box tbody tr:hover th {\n  background: #ececec;\n}\n.table th {\n  border-top: none;\n}\n.table-responsive {\n  height: 75vh;\n  overflow-y: auto;\n  border: 1px solid #e3e2e5;\n}\n.table-responsive thead th {\n  top: 0;\n  position: sticky;\n}\n.table-responsive::-webkit-scrollbar {\n  max-height: 10px;\n  width: 7px;\n  height: 7px;\n  border-radius: 10px;\n  overflow-x: hidden;\n}\n.table-responsive::-webkit-scrollbar-track {\n  background: #ffffff;\n  border-radius: 10px;\n}\n.table-responsive::-webkit-scrollbar-thumb {\n  background: #27397b;\n  border-radius: 10px;\n}\n.table-responsive::-webkit-scrollbar-thumb:hover {\n  background: #19295f;\n  border-radius: 10px;\n}\n.text-area {\n  padding: 15px;\n  width: 100%;\n  margin: 5px 0 22px 0;\n  border: none;\n  background: #f1f1f1;\n  resize: none;\n  min-height: 150px;\n}\n.modal {\n  overflow-y: auto;\n}\n\n</style>"]}]}