{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/End User Response/VerifyResponsesUserFeedback.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/End User Response/VerifyResponsesUserFeedback.vue","mtime":1643027096172},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IHN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgU3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7CmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IHsgc2V0VGltZW91dCB9IGZyb20gInRpbWVycyI7CmltcG9ydCBNdWx0aXNlbGVjdCBmcm9tICJ2dWUtbXVsdGlzZWxlY3QiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1ZlcmlmeVJlc3BvbnNlc1VzZXJGZWVkYmFjaycsCiAgY29tcG9uZW50czogewogICAgTXVsdGlzZWxlY3Q6IE11bHRpc2VsZWN0CiAgfSwKICB3YXRjaDogewogICAgc2VsZWN0ZWRfdXNlcl9saXN0OiBmdW5jdGlvbiBzZWxlY3RlZF91c2VyX2xpc3QobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGlmIChuZXdWYWwubGVuZ3RoID09PSAwKSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5zZWxlY3RlZF91c2VyX2xpc3QgPSBbIk5vIl07CiAgICAgICAgfSwgMjAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhZ2Vfbm8gPSAxOwogICAgICAgICQoIiNzZWxlY3RhbGwiKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgIHRoaXMubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2soKTsKICAgICAgfQogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVuYW5zd2VyZWRfbGlzdDogW10sCiAgICAgIHVzZXJfcm9sZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUsCiAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICBpbnRlbnRfbGlzdDogW10sCiAgICAgIGNoZWNrZWRfbGlzdDogW10sCiAgICAgIHVzZXJfbGlzdDogWyJZZXMiLCAiTm8iXSwKICAgICAgc2VsZWN0ZWRfdXNlcl9saXN0OiBbIk5vIl0sCiAgICAgIGludGVudGxpc3Q6ICIiLAogICAgICBwZXJfcGFnZTogMTAsCiAgICAgIHBhZ2Vfbm86IDEsCiAgICAgIHRvdGFsX3BhZ2VzOiAwLAogICAgICBzaG93X2xvYWRlcjogZmFsc2UsCiAgICAgIG51bWJlcl9vZl9yb3dzOiBudWxsLAogICAgICBzZWFyY2hfbmFtZTogIiIsCiAgICAgIHBhZ2VfYXJyYXk6IFtdLAogICAgICBvbGRfcXVlc3Rpb246ICIiLAogICAgICBvbGRfaW50ZW50OiAiIiwKICAgICAgbmV3X2ludGVudF9saXN0OiBbXSwKICAgICAgb2xkX2RhdGE6IHsKICAgICAgICBxdWVzdGlvbjogbnVsbCwKICAgICAgICBpbnRlbnQ6IG51bGwKICAgICAgfSwKICAgICAgdGh1bWJzX2Rvd25faWNvbjogcmVxdWlyZSgiQC9wb3J0YWwvYXNzZXRzL2ltZy9Hcm91cCA2MS5zdmciKSwKICAgICAgdGh1bWJzX3VwX2ljb246IHJlcXVpcmUoIkAvcG9ydGFsL2Fzc2V0cy9pbWcvR3JvdXAgNzEuc3ZnIikgLy8gdmlld19jb21wb25lbnRfbmFtZTogInVuYW5zd2VyZWRfcXVlc3Rpb25zIiwKCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIHZhciB2bSA9IHRoaXM7CiAgICAkKCIjc2VsZWN0YWxsIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICBpZiAoJCh0aGlzKS5pcygiOmNoZWNrZWQiKSkgewogICAgICAgICQoIi5jaGVja2luZyIpLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2bS5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAkKCIuY2hlY2tpbmciKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICB9CiAgICB9KTsKICAgIHRoaXMuJHJvb3QuJG9uKCJhZGRfcXVlc3Rpb25zX3VzZXJfcmVzcG9uc2VzIiwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgX3RoaXMyLmFkZF9xdWVzdGlvbnMoKTsKICAgIH0pOwogICAgdGhpcy4kcm9vdC4kb24oInNlYXJjaF91c2VyX3Jlc3BvbnNlcyIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIF90aGlzMi5zZWFyY2hfbmFtZSA9IGRhdGE7CgogICAgICBfdGhpczIuc2VhcmNoX3F1ZXN0aW9uKCk7CiAgICB9KTsKICAgIHRoaXMuJHJvb3QuJG9uKCJkZWxldGVfbXVsdGlwbGVfdXNlcl9yZXNwb25zZXMiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICBfdGhpczIuZGVsZXRlX211bHRpcGxlKCk7CiAgICB9KTsKICAgIHRoaXMuJHJvb3QuJG9uKCJsb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjayIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIF90aGlzMi5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjaygpOwogICAgfSk7CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy4kcm9vdC4kb2ZmKCJhZGRfcXVlc3Rpb25zX3VzZXJfcmVzcG9uc2VzIik7CiAgICB0aGlzLiRyb290LiRvZmYoInNlYXJjaF91c2VyX3Jlc3BvbnNlcyIpOwogICAgdGhpcy4kcm9vdC4kb2ZmKCJkZWxldGVfbXVsdGlwbGVfdXNlcl9yZXNwb25zZXMiKTsKICAgIHRoaXMuJHJvb3QuJG9mZigibG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2siKTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191c2VyX2ZlZWRiYWNrKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBsb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjazogZnVuY3Rpb24gbG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2soKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3QgPSBbXTsKICAgICAgdGhpcy5pbnRlbnRfbGlzdCA9IFtdOwogICAgICB0aGlzLm5ld19pbnRlbnRfbGlzdCA9IFtdOwogICAgICB0aGlzLnNlYXJjaF9uYW1lID0gIiI7CgogICAgICBpZiAodGhpcy51c2VyX3JvbGUgPT0gIlN1cGVyQWRtaW4iKSB7CiAgICAgICAgaWYgKHRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55SWQiKSkgewogICAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiQ29tcGFueUlkIik7CiAgICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQ7CiAgICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuY29tcGFueW5hbWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgaXNEZWxldGU6ICJGYWxzZSIsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgIGlzX2dldF91c2VyX3Jlc3BvbnNlOiB0cnVlLAogICAgICAgICAgc3RhdHVzOiB0aGlzLnNlbGVjdGVkX3VzZXJfbGlzdAogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXMzLm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YVswXS5sZW5ndGg7CiAgICAgICAgICBfdGhpczMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhWzRdLnBhZ2Vjb3VudDsKICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgIF90aGlzMy51bmFuc3dlcmVkX2xpc3QgPSBbXTsKCiAgICAgICAgICBmb3IgKHZhciBpIGluIGRhdGFbMF0pIHsKICAgICAgICAgICAgdmFyIHRlbXBfaW50ID0gIiI7IC8vIGNvbnNvbGUubG9nKGRhdGFbMl1baV0pOwoKICAgICAgICAgICAgaWYgKEJvb2xlYW4oZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAvLyB0ZW1wX2ludCA9IGRhdGFbMl1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpOwogICAgICAgICAgICAgIHRlbXBfaW50ID0gZGF0YVsyXVtpXTsKICAgICAgICAgICAgfSAvLyBjb25zb2xlLmxvZyh0ZW1wX2ludCk7CgoKICAgICAgICAgICAgX3RoaXMzLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICBxdWVzdGlvbjogZGF0YVswXVtpXSwKICAgICAgICAgICAgICBpbnRlbnQ6IHRlbXBfaW50LAogICAgICAgICAgICAgIG5ld19pbnRlbnQ6ICIiLAogICAgICAgICAgICAgIHNvdXJjZTogZGF0YVsxXVtpXSwKICAgICAgICAgICAgICB1c2VyX3Jlc3BvbnNlOiBkYXRhWzJdW2ldLAogICAgICAgICAgICAgIHVzZXJfZmVlZGJhY2s6IGRhdGFbM11baV0sCiAgICAgICAgICAgICAgZWRpdDogZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgX3RoaXMzLnNldHBhZ2luYXRpb24oX3RoaXMzLnBhZ2Vfbm8pOwoKICAgICAgICAgIF90aGlzMy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXMzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKGUubWVzc2FnZSk7CiAgICAgICAgICB9CgogICAgICAgICAgX3RoaXMzLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICBpc0Ryb3Bkb3duOiAiVHJ1ZSIsCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAvLyBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGFbMF0pIHsKICAgICAgICAvLyB0aGlzLmludGVudF9saXN0LnB1c2goCiAgICAgICAgLy8gICAgIHJlc3BvbnNlLmRhdGFbMF1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpCiAgICAgICAgLy8gKTsKICAgICAgICAvLyB0aGlzLm5ld19pbnRlbnRfbGlzdC5wdXNoKAogICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhWzBdW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKQogICAgICAgIC8vICk7CiAgICAgICAgLy8gfQogICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YVswXSkgewogICAgICAgICAgX3RoaXMzLmludGVudF9saXN0LnB1c2gocmVzcG9uc2UuZGF0YVswXVtpXSk7CgogICAgICAgICAgX3RoaXMzLm5ld19pbnRlbnRfbGlzdC5wdXNoKHJlc3BvbnNlLmRhdGFbMF1baV0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzMy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHNldHBhZ2luYXRpb246IGZ1bmN0aW9uIHNldHBhZ2luYXRpb24ocGFnZV9ubykgewogICAgICB0aGlzLnBhZ2VfYXJyYXkgPSBbXTsKCiAgICAgIGlmICh0aGlzLnRvdGFsX3BhZ2VzIDw9IDcpIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IDEpIHsKICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgNDsgX2krKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2kgKyAxKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSB0aGlzLnRvdGFsX3BhZ2VzKSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKCiAgICAgICAgZm9yICh2YXIgX2kyID0gdGhpcy50b3RhbF9wYWdlcyAtIDQ7IF9pMiA8IHRoaXMudG90YWxfcGFnZXM7IF9pMisrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTIgKyAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA8PSA0KSB7CiAgICAgICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgcGFnZV9ubyArIDM7IF9pMysrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTMgKyAxKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA+PSB0aGlzLnRvdGFsX3BhZ2VzIC0gNCkgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CgogICAgICAgIGZvciAodmFyIF9pNCA9IHBhZ2Vfbm8gLSA0OyBfaTQgPCB0aGlzLnRvdGFsX3BhZ2VzOyBfaTQrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2k0ICsgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CgogICAgICAgIGZvciAodmFyIF9pNSA9IHBhZ2Vfbm8gLSAzOyBfaTUgPD0gcGFnZV9ubyArIDM7IF9pNSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTUpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfQogICAgfSwKICAgIHBhZ2VfcmVxdWlyZTogZnVuY3Rpb24gcGFnZV9yZXF1aXJlKHBhZ2UpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CgogICAgICBpZiAocGFnZSA9PSAwIHx8IHBhZ2UgPT0gdGhpcy50b3RhbF9wYWdlcyArIDEpIHt9IGVsc2UgewogICAgICAgICQoIi5jaGVja2luZyIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgJCgiI3NlbGVjdGFsbCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CgogICAgICAgIGlmIChwYWdlID09ICIuLi5zIikgewogICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCgxICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgIH0gZWxzZSBpZiAocGFnZSA9PSAiLi4ubCIpIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgodGhpcy50b3RhbF9wYWdlcyArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5wYWdlX25vID0gcGFnZTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09ICIiKSB7CiAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICBpc0RlbGV0ZTogIkZhbHNlIiwKICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgaXNfZ2V0X3VzZXJfcmVzcG9uc2U6IHRydWUsCiAgICAgICAgICAgIHN0YXR1czogdGhpcy5zZWxlY3RlZF91c2VyX2xpc3QKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIF90aGlzNC5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICBfdGhpczQudW5hbnN3ZXJlZF9saXN0ID0gW107CgogICAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGFbMF0pIHsKICAgICAgICAgICAgICB2YXIgdGVtcF9pbnQgPSAiIjsKCiAgICAgICAgICAgICAgaWYgKEJvb2xlYW4ocmVzcG9uc2UuZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgIC8vIHRlbXBfaW50ID0gcmVzcG9uc2UuZGF0YVsyXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIik7CiAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IHJlc3BvbnNlLmRhdGFbMl1baV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczQudW5hbnN3ZXJlZF9saXN0LnB1c2goewogICAgICAgICAgICAgICAgcXVlc3Rpb246IHJlc3BvbnNlLmRhdGFbMF1baV0sCiAgICAgICAgICAgICAgICBpbnRlbnQ6IHRlbXBfaW50LAogICAgICAgICAgICAgICAgc291cmNlOiByZXNwb25zZS5kYXRhWzFdW2ldLAogICAgICAgICAgICAgICAgdXNlcl9yZXNwb25zZTogcmVzcG9uc2UuZGF0YVsyXVtpXSwKICAgICAgICAgICAgICAgIHVzZXJfZmVlZGJhY2s6IHJlc3BvbnNlLmRhdGFbM11baV0sCiAgICAgICAgICAgICAgICBlZGl0OiBmYWxzZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczQuc2V0cGFnaW5hdGlvbihfdGhpczQucGFnZV9ubyk7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICBfdGhpczQuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgaXNzZWFyY2g6IHRydWUsCiAgICAgICAgICAgIC8vIHNlYXJjaGJ5OiB0aGlzLnNlYXJjaF9ieSwKICAgICAgICAgICAga2V5OiB0aGlzLnNlYXJjaF9uYW1lLAogICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICBpc19nZXRfdXNlcl9yZXNwb25zZTogdHJ1ZSwKICAgICAgICAgICAgc3RhdHVzOiB0aGlzLnNlbGVjdGVkX3VzZXJfbGlzdAogICAgICAgICAgfSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXM0LnNob3dfbG9hZGVyID0gZmFsc2U7CgogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YVs0XS5wYWdlY291bnQgIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgX3RoaXM0LnBhZ2Vfbm8gPSBwYWdlOwogICAgICAgICAgICAgIF90aGlzNC51bmFuc3dlcmVkX2xpc3QgPSBbXTsKICAgICAgICAgICAgICBfdGhpczQubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhWzBdLmxlbmd0aDsKICAgICAgICAgICAgICBfdGhpczQudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhWzRdLnBhZ2Vjb3VudDsKICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YVswXSkgewogICAgICAgICAgICAgICAgdmFyIHRlbXBfaW50ID0gIiI7CgogICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgICAgLy8gdGVtcF9pbnQgPSBkYXRhWzJdW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKTsKICAgICAgICAgICAgICAgICAgdGVtcF9pbnQgPSBkYXRhWzJdW2ldOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzNC51bmFuc3dlcmVkX2xpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiByZXNwb25zZS5kYXRhWzBdW2ldLAogICAgICAgICAgICAgICAgICBpbnRlbnQ6IHRlbXBfaW50LAogICAgICAgICAgICAgICAgICBzb3VyY2U6IHJlc3BvbnNlLmRhdGFbMV1baV0sCiAgICAgICAgICAgICAgICAgIHVzZXJfcmVzcG9uc2U6IHJlc3BvbnNlLmRhdGFbMl1baV0sCiAgICAgICAgICAgICAgICAgIHVzZXJfZmVlZGJhY2s6IHJlc3BvbnNlLmRhdGFbM11baV0sCiAgICAgICAgICAgICAgICAgIGVkaXQ6IGZhbHNlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF90aGlzNC5zZXRwYWdpbmF0aW9uKF90aGlzNC5wYWdlX25vKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludGVybmFsIFNlcnZlciBFcnJvciIpOyAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICAvLyB9LCAyNTAwKTsKCiAgICAgICAgICAgICAgX3RoaXM0LmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191c2VyX2ZlZWRiYWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICAgIF90aGlzNC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcXVlc3Rpb25fc2VsZWN0ZWQ6IGZ1bmN0aW9uIHF1ZXN0aW9uX3NlbGVjdGVkKHZhbHVlKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgaWYgKHZhbHVlID09ICJhbGwiKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwoKICAgICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy51bmFuc3dlcmVkX2xpc3QpIHsKICAgICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QucHVzaCh0aGlzLnVuYW5zd2VyZWRfbGlzdFtpXSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0LnB1c2godGhpcy51bmFuc3dlcmVkX2xpc3RbdmFsdWVdKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIWV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgaWYgKHZhbHVlICE9ICJhbGwiKSB7CiAgICAgICAgICB2YXIgc2VsZWN0YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3NlbGVjdGFsbCIpOwoKICAgICAgICAgIGlmIChzZWxlY3RhbGwuY2hlY2tlZCkgewogICAgICAgICAgICBzZWxlY3RhbGwuY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB0ZW1wID0gdGhpcy5jaGVja2VkX2xpc3QuZmlsdGVyKGZ1bmN0aW9uIChxdWVzdGlvbikgewogICAgICAgICAgICByZXR1cm4gcXVlc3Rpb24gIT09IF90aGlzNS51bmFuc3dlcmVkX2xpc3RbdmFsdWVdOwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRlbXA7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZGVsZXRlX3NpbmdsZTogZnVuY3Rpb24gZGVsZXRlX3NpbmdsZShpbmRleCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHZhciBxdWVzdGlvbmxpc3QgPSBbXTsKICAgICAgU3dhbC5maXJlKHsKICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgIHRleHQ6ICIgWW91IHdhbnQgdG8gRGVsZXRlIHRoaXMgUXVlc3Rpb24/IiwKICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgQ29uZmlybSEiCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3VsdC52YWx1ZSk7CiAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgLy8gY29uc29sZS5sb2coImRlbGV0ZWQiKTsKICAgICAgICAgIHF1ZXN0aW9ubGlzdC5wdXNoKF90aGlzNi51bmFuc3dlcmVkX2xpc3RbaW5kZXhdLnF1ZXN0aW9uKTsKCiAgICAgICAgICBfdGhpczYuZGVsZXRlX3F1ZXN0aW9uc19hcGkocXVlc3Rpb25saXN0KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGRlbGV0ZV9tdWx0aXBsZTogZnVuY3Rpb24gZGVsZXRlX211bHRpcGxlKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmNoZWNrZWRfbGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogIk5vIHF1ZXN0aW9uIHNlbGVjdGVkISIsCiAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHRoaXMuY2hlY2tlZF9saXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgcXVlc3Rpb25saXN0ID0gW107CiAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgICB0ZXh0OiAiIFlvdSB3YW50IHRvIERlbGV0ZSB0aGlzIFF1ZXN0aW9ucz8iLAogICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgQ29uZmlybSEiCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gX3RoaXM3LmNoZWNrZWRfbGlzdCkgewogICAgICAgICAgICAgIHF1ZXN0aW9ubGlzdC5wdXNoKF90aGlzNy5jaGVja2VkX2xpc3RbaV0ucXVlc3Rpb24pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczcuZGVsZXRlX3F1ZXN0aW9uc19hcGkocXVlc3Rpb25saXN0KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGRlbGV0ZV9xdWVzdGlvbnNfYXBpOiBmdW5jdGlvbiBkZWxldGVfcXVlc3Rpb25zX2FwaShxdWVzdGlvbmxpc3QpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksIHsKICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIHF1ZXN0aW9ubGlzdDogcXVlc3Rpb25saXN0LAogICAgICAgIGlzRGVsZXRlOiAiVHJ1ZSIsCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczguc2hvd19sb2FkZXIgPSBmYWxzZTsKCiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIkRlbGV0ZWQgU3VjY2Vzc2Z1bGx5IikgewogICAgICAgICAgLy8gY29uc29sZS5sb2coImRlbGV0ZWQgc3VjY2Vzc2Z1bGx5Iik7CiAgICAgICAgICBfdGhpczguY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgICBfdGhpczgubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhWzJdLm51bWJlcl9vZl9yb3dzOwogICAgICAgICAgX3RoaXM4LnRvdGFsX3BhZ2VzID0gTWF0aC5jZWlsKF90aGlzOC5udW1iZXJfb2Zfcm93cyAvIF90aGlzOC5wZXJfcGFnZSk7CiAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiRGVsZXRlZCBTdWNjZXNzZnVsbHkiKTsgLy8gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgIC8vIH0sIDE1MDApOwoKICAgICAgICAgIGlmIChxdWVzdGlvbmxpc3QubGVuZ3RoID09PSBfdGhpczgudW5hbnN3ZXJlZF9saXN0Lmxlbmd0aCAmJiBfdGhpczgucGFnZV9ubyA+IDEpIHsKICAgICAgICAgICAgX3RoaXM4LnBhZ2Vfbm8gPSBfdGhpczgucGFnZV9ubyAtIDE7CiAgICAgICAgICB9CgogICAgICAgICAgd2hpbGUgKF90aGlzOC5wYWdlX25vID4gMSAmJiBfdGhpczgucGFnZV9ubyA+IF90aGlzOC50b3RhbF9wYWdlcykgewogICAgICAgICAgICBfdGhpczgucGFnZV9ubyA9IF90aGlzOC5wYWdlX25vIC0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczgubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2soKTsKICAgICAgICB9CgogICAgICAgIF90aGlzOC5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXM4LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0b2FzdHIuZXJyb3IoZS5tZXNzYWdlKTsKICAgICAgICB9CgogICAgICAgIF90aGlzOC5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICBlZGl0X2l0ZW06IGZ1bmN0aW9uIGVkaXRfaXRlbShpbmRleCkgewogICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdFtpbmRleF0uZWRpdCA9ICF0aGlzLnVuYW5zd2VyZWRfbGlzdFtpbmRleF0uZWRpdDsKICAgICAgdGhpcy5vbGRfcXVlc3Rpb24gPSB0aGlzLnVuYW5zd2VyZWRfbGlzdFtpbmRleF0ucXVlc3Rpb247IC8vIHRoaXMub2xkX2ludGVudCA9IHRoaXMudW5hbnN3ZXJlZF9saXN0W2luZGV4XS5pbnRlbnQ7CgogICAgICB0aGlzLm9sZF9kYXRhLnF1ZXN0aW9uID0gdGhpcy5vbGRfcXVlc3Rpb247IC8vIHRoaXMub2xkX2RhdGEuaW50ZW50ID0gdGhpcy5jb21wYW55aWQgKyAiXyIgKyB0aGlzLm9sZF9pbnRlbnQ7CiAgICAgIC8vIHRoaXMucXVlc3Rpb24gPSBxdWVzdGlvbi5xdWVzdGlvbjsKICAgICAgLy8gdGhpcy5pbnRlbnQgPSBxdWVzdGlvbi5pbnRlbnQ7CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMub2xkX2RhdGEpOwogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLm9sZF9xdWVzdGlvbik7CiAgICB9LAogICAgc3VibWl0X3F1ZXN0aW9uOiBmdW5jdGlvbiBzdWJtaXRfcXVlc3Rpb24oKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgLy8gY29uc29sZS5sb2coInN1Ym1pdCIpOwogICAgICAvLyBjb25zb2xlLmxvZygicXVlc3Rpb24iLCB0aGlzLm9sZF9xdWVzdGlvbik7CiAgICAgIC8vIGNvbnNvbGUubG9nKCJpbnRlbnQiLCB0aGlzLm9sZF9pbnRlbnQpOwogICAgICAvLyBjb25zb2xlLmxvZygiaW50ZW50IiwgdGhpcy5pc2VkaXQpOwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgaWYgKHRoaXMub2xkX3F1ZXN0aW9uID09ICIiKSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgYWxsIHRoZSBmaWVsZHMuIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJCgiI2V4YW1wbGVNb2RhbENlbnRlciIpLm1vZGFsKCdoaWRlJyk7CiAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksIHsKICAgICAgICAgIGlzX0VkaXQ6ICJUcnVlIiwKICAgICAgICAgIHF1ZXN0aW9uOiB0aGlzLm9sZF9xdWVzdGlvbiwKICAgICAgICAgIC8vIGludGVudDogdGhpcy5jb21wYW55aWQgKyAiXyIgKyB0aGlzLm9sZF9pbnRlbnQsCiAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICBvbGRfcXVlc3Rpb25fZGF0YTogdGhpcy5vbGRfZGF0YSwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24KICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzOS5zaG93X2xvYWRlciA9IGZhbHNlOwoKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIkVkaXRlZCBTdWNjZXNzZnVsbHkiKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0ZXh0OiAiWW91ciBxdWVzdGlvbiBoYXMgYmVlbiBlZGl0ZWQgc3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAvLyBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgICAgLy8gLy8gdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICAgIF90aGlzOS5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjaygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gLy8gZWxzZSBpZiAocmVzcG9uc2UuZGF0YSA9PSAiUXVlc3Rpb24gSW50ZW50IFVwZGF0ZWQiKSB7CiAgICAgICAgICAvLyBTd2FsKHsKICAgICAgICAgIC8vICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAvLyAgICAgdGV4dDogIllvdXIgcXVlc3Rpb24gaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgLy8gICAgIHRpbWVyOjIwMDAsCiAgICAgICAgICAvLyB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgIC8vICAgICAvLyBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAvLyAgICAgLy8gdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAvLyAgICAgLy8gfQogICAgICAgICAgLy8gICAgIHRoaXMubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2soKTsKICAgICAgICAgIC8vIH0pOwogICAgICAgICAgLy8gfQoKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzOS4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBwYWdpbmF0aW9uX2NsYXNzOiBmdW5jdGlvbiBwYWdpbmF0aW9uX2NsYXNzKGluZGV4KSB7CiAgICAgIGlmIChpbmRleCA9PSB0aGlzLnBhZ2Vfbm8pIHsKICAgICAgICByZXR1cm4gIiBhY3RpdmUiOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgfSwKICAgIGFkZF9xdWVzdGlvbnM6IGZ1bmN0aW9uIGFkZF9xdWVzdGlvbnMoKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICB2YXIgcXVlc3Rpb25saXN0ID0gW107CiAgICAgIHZhciB0ZW1wX2xpc3QgPSBbXTsKICAgICAgdmFyIGVtcHR5ID0gdGhpcy51bmFuc3dlcmVkX2xpc3QuZmlsdGVyKGZ1bmN0aW9uICh1bmFuc3dlcmVkKSB7CiAgICAgICAgcmV0dXJuIHVuYW5zd2VyZWQubmV3X2ludGVudCA9PSAiIjsKICAgICAgfSk7CgogICAgICBmb3IgKHZhciBpIGluIHRoaXMudW5hbnN3ZXJlZF9saXN0KSB7CiAgICAgICAgaWYgKHRoaXMudW5hbnN3ZXJlZF9saXN0W2ldLm5ld19pbnRlbnQgIT0gIiIpIHsKICAgICAgICAgIHRlbXBfbGlzdC5wdXNoKHRoaXMudW5hbnN3ZXJlZF9saXN0W2ldLnF1ZXN0aW9uLCAvLyB0aGlzLmNvbXBhbnlpZCArICJfIiArIHRoaXMudW5hbnN3ZXJlZF9saXN0W2ldLm5ld19pbnRlbnQKICAgICAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0W2ldLm5ld19pbnRlbnQpOwogICAgICAgICAgcXVlc3Rpb25saXN0LnB1c2godGVtcF9saXN0KTsKICAgICAgICB9CgogICAgICAgIHRlbXBfbGlzdCA9IFtdOwogICAgICB9CgogICAgICBpZiAocXVlc3Rpb25saXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwgewogICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgaXNBZGQ6ICJUcnVlIiwKICAgICAgICAgIHF1ZXN0aW9uaW50ZW50OiBxdWVzdGlvbmxpc3QsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczEwLnNob3dfbG9hZGVyID0gZmFsc2U7CgogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIkFkZGVkIFN1Y2Nlc3NmdWxseSIpIHsKICAgICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogIkFkZGVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIHRpbWVyOiAyMDAwCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHF1ZXN0aW9ubGlzdC5sZW5ndGggPT09IF90aGlzMTAudW5hbnN3ZXJlZF9saXN0Lmxlbmd0aCAmJiBfdGhpczEwLnBhZ2Vfbm8gPiAxKSB7CiAgICAgICAgICAgICAgX3RoaXMxMC5wYWdlX25vID0gX3RoaXMxMC5wYWdlX25vIC0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX3RoaXMxMC5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdXNlcl9mZWVkYmFjaygpOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBfdGhpczEwLnNob3dfbG9hZGVyID0gZmFsc2U7CgogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzMTAuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCJObyBxdWVzdGlvbiB0byBhZGQuIFBsZWFzZSBhZGQgc29tZSBxdWVzdGlvbnMuIik7CiAgICAgIH0KCiAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSBmYWxzZTsKICAgIH0sCiAgICBzZWFyY2hfcXVlc3Rpb246IGZ1bmN0aW9uIHNlYXJjaF9xdWVzdGlvbigpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgLy8gaWYodGhpcy5zZWFyY2hfYnkhPScnKXsKICAgICAgLy8gY29uc29sZS5sb2coImhleSIpOwogICAgICBpZiAodGhpcy5zZWFyY2hfbmFtZSAhPSAiIikgewogICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgaXNzZWFyY2g6IHRydWUsCiAgICAgICAgICAvLyBzZWFyY2hieTogdGhpcy5zZWFyY2hfYnksCiAgICAgICAgICBrZXk6IHRoaXMuc2VhcmNoX25hbWUsCiAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgICBpc19nZXRfdXNlcl9yZXNwb25zZTogdHJ1ZSwKICAgICAgICAgIHN0YXR1czogdGhpcy5zZWxlY3RlZF91c2VyX2xpc3QKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzMTEuc2hvd19sb2FkZXIgPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIk5vIFF1ZXN0aW9ucyBGb3VuZCIpIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJObyBRdWVzdGlvbiBGb3VuZCIpOyAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgLy8gICAgIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAvLyB9LCAyNTAwKTsKCiAgICAgICAgICAgIF90aGlzMTEubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2soKTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YVs0XS5wYWdlY291bnQgIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIF90aGlzMTEucGFnZV9ubyA9IDE7CiAgICAgICAgICAgIF90aGlzMTEudW5hbnN3ZXJlZF9saXN0ID0gW107CiAgICAgICAgICAgIF90aGlzMTEubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhWzBdLmxlbmd0aDsKICAgICAgICAgICAgX3RoaXMxMS50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGFbNF0ucGFnZWNvdW50OwogICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGFbMF0pIHsKICAgICAgICAgICAgICB2YXIgdGVtcF9pbnQgPSAiIjsKCiAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgIC8vIHRlbXBfaW50ID0gZGF0YVsyXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIik7CiAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IGRhdGFbMl1baV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczExLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiBkYXRhWzBdW2ldLAogICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgIHNvdXJjZTogZGF0YVsxXVtpXSwKICAgICAgICAgICAgICAgIHVzZXJfcmVzcG9uc2U6IGRhdGFbMl1baV0sCiAgICAgICAgICAgICAgICB1c2VyX2ZlZWRiYWNrOiBkYXRhWzNdW2ldLAogICAgICAgICAgICAgICAgZWRpdDogZmFsc2UKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSAvLyBjb25zb2xlLmxvZyh0aGlzLnVuYW5zd2VyZWRfbGlzdCk7CgoKICAgICAgICAgICAgX3RoaXMxMS5zZXRwYWdpbmF0aW9uKF90aGlzMTEucGFnZV9ubyk7CiAgICAgICAgICB9IC8vIGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJObyBRdWVzdGlvbnMgRm91bmQiKSB7CiAgICAgICAgICAvLyAgIHRvYXN0ci5lcnJvcigiTm8gUXVlc3Rpb24gRm91bmQiKTsKICAgICAgICAgIC8vICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAvLyAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAvLyAgIH0sIDI1MDApOwogICAgICAgICAgLy8gfQogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKTsgLy8gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgLy8gICAgIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgIC8vICAgfSwgMjUwMCk7CgogICAgICAgICAgICAgIF90aGlzMTEubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VzZXJfZmVlZGJhY2soKTsKICAgICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKCiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXMxMS4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0b2FzdHIuZXJyb3IoIkVudGVyIHByb3BlciBkYXRhIGZvciBzZWFyY2hpbmciKTsKICAgICAgfSAvLyB9ZWxzZXsKICAgICAgLy8gICB0b2FzdHIuZXJyb3IoIlNlbGVjdCBoZWFkZXIgZm9yIHNlYXJjaGluZyIpOwogICAgICAvLyB9CgogICAgfQogIH0KfTs="},null]}