{"remainingRequest":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js!/home/vimalesh/Learning/devops_ui/node_modules/eslint-loader/index.js??ref--13-0!/home/vimalesh/Learning/devops_ui/src/portal/assets/js/shopify.min.js","dependencies":[{"path":"/home/vimalesh/Learning/devops_ui/src/portal/assets/js/shopify.min.js","mtime":1643027096288},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmV2ZXJ5Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZnJvbSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluZGV4LW9mIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29tZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LWJ1ZmZlci5jb25zdHJ1Y3RvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIudG8tZml4ZWQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZnJlZXplIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LW5hbWVzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1wcm90b3R5cGUtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuY29uc3RydWN0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuZW5kcy13aXRoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0iKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1hcnJheSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmNvcHktd2l0aGluIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZXZlcnkiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWxsIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsdGVyIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtaW5kZXgiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mb3ItZWFjaCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluY2x1ZGVzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmpvaW4iKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5sYXN0LWluZGV4LW9mIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubWFwIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLXJpZ2h0Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmV2ZXJzZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNldCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNsaWNlIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29tZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvcnQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zdWJhcnJheSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLWxvY2FsZS1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwiKTsKCnZhciBfdHlwZW9mMiA9IHJlcXVpcmUoIi9ob21lL3ZpbWFsZXNoL0xlYXJuaW5nL2Rldm9wc191aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy90eXBlb2YiKTsKCnZhciBTaG9waWZ5QnV5ID0gZnVuY3Rpb24gKCkgewogICJ1c2Ugc3RyaWN0IjsKCiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgITEsIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gITAsICJ2YWx1ZSIgaW4gZGVzY3JpcHRvciAmJiAoZGVzY3JpcHRvci53cml0YWJsZSA9ICEwKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogICAgcmV0dXJuIHByb3RvUHJvcHMgJiYgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKSwgc3RhdGljUHJvcHMgJiYgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKSwgQ29uc3RydWN0b3I7CiAgfQoKICBmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgICByZXR1cm4ga2V5IGluIG9iaiA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6ICEwLAogICAgICBjb25maWd1cmFibGU6ICEwLAogICAgICB3cml0YWJsZTogITAKICAgIH0pIDogb2JqW2tleV0gPSB2YWx1ZSwgb2JqOwogIH0KCiAgZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICAgIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpLCBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzcywgc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsKICB9CgogIGZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgewogICAgaWYgKHZvaWQgMCA9PT0gc2VsZikgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICAgIHJldHVybiBzZWxmOwogIH0KCiAgZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOwogIH0KCiAgZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogICAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKICB9CgogIGZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgICB9CgogICAgICByZXR1cm4gYXJyMjsKICAgIH0KICB9CgogIGZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7CiAgfQoKICBmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICAgIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8ICJbb2JqZWN0IEFyZ3VtZW50c10iID09PSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwogIH0KCiAgZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgewogICAgdmFyIF9hcnIgPSBbXSwKICAgICAgICBfbiA9ICEwLAogICAgICAgIF9kID0gITEsCiAgICAgICAgX2UgPSB2b2lkIDA7CgogICAgdHJ5IHsKICAgICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSkgJiYgKF9hcnIucHVzaChfcy52YWx1ZSksICFpIHx8IF9hcnIubGVuZ3RoICE9PSBpKTsgX24gPSAhMCkgewogICAgICAgIDsKICAgICAgfQogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIF9kID0gITAsIF9lID0gZXJyOwogICAgfSBmaW5hbGx5IHsKICAgICAgdHJ5IHsKICAgICAgICBfbiB8fCBudWxsID09IF9pLnJldHVybiB8fCBfaS5yZXR1cm4oKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIF9hcnI7CiAgfQoKICBmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwogIH0KCiAgZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKICB9CgogIHZhciBfdHlwZW9mID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPyBmdW5jdGlvbiAob2JqKSB7CiAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICB9IDogZnVuY3Rpb24gKG9iaikgewogICAgcmV0dXJuIG9iaiAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogIH0sCiAgICAgIGNsYXNzQ2FsbENoZWNrJDEgPSBmdW5jdGlvbiBjbGFzc0NhbGxDaGVjayQxKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogICAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0sCiAgICAgIGNyZWF0ZUNsYXNzJDEgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8ICExLCBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIGRlc2NyaXB0b3IgJiYgKGRlc2NyaXB0b3Iud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgICAgIHJldHVybiBwcm90b1Byb3BzICYmIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKSwgc3RhdGljUHJvcHMgJiYgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpLCBDb25zdHJ1Y3RvcjsKICAgIH07CiAgfSgpLAogICAgICBpbmhlcml0cyQxID0gZnVuY3Rpb24gaW5oZXJpdHMkMShzdWJDbGFzcywgc3VwZXJDbGFzcykgewogICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIHN1cGVyQ2xhc3MgJiYgbnVsbCAhPT0gc3VwZXJDbGFzcykgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiICsgX3R5cGVvZjIoc3VwZXJDbGFzcykpOwogICAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICAgIGVudW1lcmFibGU6ICExLAogICAgICAgIHdyaXRhYmxlOiAhMCwKICAgICAgICBjb25maWd1cmFibGU6ICEwCiAgICAgIH0KICAgIH0pLCBzdXBlckNsYXNzICYmIChPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzcyk7CiAgfSwKICAgICAgcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiQxID0gZnVuY3Rpb24gcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiQxKHNlbGYsIGNhbGwpIHsKICAgIGlmICghc2VsZikgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICAgIHJldHVybiAhY2FsbCB8fCAib2JqZWN0IiAhPSBfdHlwZW9mMihjYWxsKSAmJiAiZnVuY3Rpb24iICE9IHR5cGVvZiBjYWxsID8gc2VsZiA6IGNhbGw7CiAgfTsKCiAgZnVuY3Rpb24gam9pbigpIHsKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBmaWVsZHMgPSBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgZmllbGRzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIHJldHVybiBmaWVsZHMuam9pbigiICIpOwogIH0KCiAgZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHsKICAgIHJldHVybiBCb29sZWFuKHZhbHVlKSAmJiAiW29iamVjdCBPYmplY3RdIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlLnZhbHVlT2YoKSk7CiAgfQoKICBmdW5jdGlvbiBkZWVwRnJlZXplQ29weUV4Y2VwdChwcmVkaWNhdGUsIHN0cnVjdHVyZSkgewogICAgcmV0dXJuIHByZWRpY2F0ZShzdHJ1Y3R1cmUpID8gc3RydWN0dXJlIDogaXNPYmplY3Qoc3RydWN0dXJlKSA/IE9iamVjdC5mcmVlemUoT2JqZWN0LmtleXMoc3RydWN0dXJlKS5yZWR1Y2UoZnVuY3Rpb24gKGNvcHksIGtleSkgewogICAgICByZXR1cm4gY29weVtrZXldID0gZGVlcEZyZWV6ZUNvcHlFeGNlcHQocHJlZGljYXRlLCBzdHJ1Y3R1cmVba2V5XSksIGNvcHk7CiAgICB9LCB7fSkpIDogQXJyYXkuaXNBcnJheShzdHJ1Y3R1cmUpID8gT2JqZWN0LmZyZWV6ZShzdHJ1Y3R1cmUubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiBkZWVwRnJlZXplQ29weUV4Y2VwdChwcmVkaWNhdGUsIGl0ZW0pOwogICAgfSkpIDogc3RydWN0dXJlOwogIH0KCiAgZnVuY3Rpb24gc2NoZW1hRm9yVHlwZSh0eXBlQnVuZGxlLCB0eXBlTmFtZSkgewogICAgdmFyIHR5cGVTY2hlbWEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1syXSA/IGFyZ3VtZW50c1syXSA6IG51bGwsCiAgICAgICAgdHlwZSA9IHR5cGVCdW5kbGUudHlwZXNbdHlwZU5hbWVdOwogICAgaWYgKHR5cGUpIHJldHVybiB0eXBlOwogICAgaWYgKHR5cGVTY2hlbWEgJiYgIklOVEVSRkFDRSIgPT09IHR5cGVTY2hlbWEua2luZCkgcmV0dXJuIHR5cGVTY2hlbWE7CiAgICB0aHJvdyBuZXcgRXJyb3IoIk5vIHR5cGUgb2YgIiArIHR5cGVOYW1lICsgIiBmb3VuZCBpbiBzY2hlbWEiKTsKICB9CgogIHZhciBjbGFzc0NhbGxDaGVjayA9IGZ1bmN0aW9uIGNsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogICAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0sCiAgICAgIGNyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCAhMSwgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiBkZXNjcmlwdG9yICYmIChkZXNjcmlwdG9yLndyaXRhYmxlID0gITApLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogICAgICByZXR1cm4gcHJvdG9Qcm9wcyAmJiBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyksIHN0YXRpY1Byb3BzICYmIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKSwgQ29uc3RydWN0b3I7CiAgICB9OwogIH0oKSwKICAgICAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsKICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07CgogICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7CiAgICAgICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSAmJiAodGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGFyZ2V0OwogIH0sCiAgICAgIGluaGVyaXRzID0gZnVuY3Rpb24gaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiBzdXBlckNsYXNzICYmIG51bGwgIT09IHN1cGVyQ2xhc3MpIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArICh2b2lkIDAgPT09IHN1cGVyQ2xhc3MgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yoc3VwZXJDbGFzcykpKTsKICAgIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgICBjb25zdHJ1Y3RvcjogewogICAgICAgIHZhbHVlOiBzdWJDbGFzcywKICAgICAgICBlbnVtZXJhYmxlOiAhMSwKICAgICAgICB3cml0YWJsZTogITAsCiAgICAgICAgY29uZmlndXJhYmxlOiAhMAogICAgICB9CiAgICB9KSwgc3VwZXJDbGFzcyAmJiAoT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3MpOwogIH0sCiAgICAgIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gPSBmdW5jdGlvbiBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICAgIGlmICghc2VsZikgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICAgIHJldHVybiAhY2FsbCB8fCAib2JqZWN0IiAhPT0gKHZvaWQgMCA9PT0gY2FsbCA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihjYWxsKSkgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgY2FsbCA/IHNlbGYgOiBjYWxsOwogIH0sCiAgICAgIHNsaWNlZFRvQXJyYXkgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBzbGljZUl0ZXJhdG9yKGFyciwgaSkgewogICAgICB2YXIgX2FyciA9IFtdLAogICAgICAgICAgX24gPSAhMCwKICAgICAgICAgIF9kID0gITEsCiAgICAgICAgICBfZSA9IHZvaWQgMDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSkgJiYgKF9hcnIucHVzaChfcy52YWx1ZSksICFpIHx8IF9hcnIubGVuZ3RoICE9PSBpKTsgX24gPSAhMCkgewogICAgICAgICAgOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2QgPSAhMCwgX2UgPSBlcnI7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICFfbiAmJiBfaS5yZXR1cm4gJiYgX2kucmV0dXJuKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gX2FycjsKICAgIH0KCiAgICByZXR1cm4gZnVuY3Rpb24gKGFyciwgaSkgewogICAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwogICAgICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSByZXR1cm4gc2xpY2VJdGVyYXRvcihhcnIsIGkpOwogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7CiAgICB9OwogIH0oKSwKICAgICAgdG9Db25zdW1hYmxlQXJyYXkgPSBmdW5jdGlvbiB0b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICAgIH0KCiAgICAgIHJldHVybiBhcnIyOwogICAgfQoKICAgIHJldHVybiBBcnJheS5mcm9tKGFycik7CiAgfSwKICAgICAgVmFyaWFibGVEZWZpbml0aW9uID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gVmFyaWFibGVEZWZpbml0aW9uKG5hbWUsIHR5cGUsIGRlZmF1bHRWYWx1ZSkgewogICAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBWYXJpYWJsZURlZmluaXRpb24pLCB0aGlzLm5hbWUgPSBuYW1lLCB0aGlzLnR5cGUgPSB0eXBlLCB0aGlzLmRlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZSwgT2JqZWN0LmZyZWV6ZSh0aGlzKTsKICAgIH0KCiAgICByZXR1cm4gY3JlYXRlQ2xhc3MoVmFyaWFibGVEZWZpbml0aW9uLCBbewogICAgICBrZXk6ICJ0b0lucHV0VmFsdWVTdHJpbmciLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdG9JbnB1dFZhbHVlU3RyaW5nKCkgewogICAgICAgIHJldHVybiAiJCIgKyB0aGlzLm5hbWU7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidG9TdHJpbmciLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZVN0cmluZyA9IHRoaXMuZGVmYXVsdFZhbHVlID8gIiA9ICIgKyBmb3JtYXRJbnB1dFZhbHVlKHRoaXMuZGVmYXVsdFZhbHVlKSA6ICIiOwogICAgICAgIHJldHVybiAiJCIgKyB0aGlzLm5hbWUgKyAiOiIgKyB0aGlzLnR5cGUgKyBkZWZhdWx0VmFsdWVTdHJpbmc7CiAgICAgIH0KICAgIH1dKSwgVmFyaWFibGVEZWZpbml0aW9uOwogIH0oKTsKCiAgZnVuY3Rpb24gaXNWYXJpYWJsZSh2YWx1ZSkgewogICAgcmV0dXJuIFZhcmlhYmxlRGVmaW5pdGlvbi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZih2YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiB2YXJpYWJsZShuYW1lLCB0eXBlLCBkZWZhdWx0VmFsdWUpIHsKICAgIHJldHVybiBuZXcgVmFyaWFibGVEZWZpbml0aW9uKG5hbWUsIHR5cGUsIGRlZmF1bHRWYWx1ZSk7CiAgfQoKICB2YXIgRW51bSA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIEVudW0oa2V5KSB7CiAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIEVudW0pLCB0aGlzLmtleSA9IGtleTsKICAgIH0KCiAgICByZXR1cm4gY3JlYXRlQ2xhc3MoRW51bSwgW3sKICAgICAga2V5OiAidG9TdHJpbmciLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMua2V5OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInZhbHVlT2YiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWVPZigpIHsKICAgICAgICByZXR1cm4gdGhpcy5rZXkudmFsdWVPZigpOwogICAgICB9CiAgICB9XSksIEVudW07CiAgfSgpLAogICAgICBlbnVtRnVuY3Rpb24gPSBmdW5jdGlvbiBlbnVtRnVuY3Rpb24oa2V5KSB7CiAgICByZXR1cm4gbmV3IEVudW0oa2V5KTsKICB9LAogICAgICBTY2FsYXIgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBTY2FsYXIodmFsdWUpIHsKICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgU2NhbGFyKSwgdGhpcy52YWx1ZSA9IHZhbHVlOwogICAgfQoKICAgIHJldHVybiBjcmVhdGVDbGFzcyhTY2FsYXIsIFt7CiAgICAgIGtleTogInRvU3RyaW5nIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogICAgICAgIHJldHVybiB0aGlzLnZhbHVlLnRvU3RyaW5nKCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidmFsdWVPZiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZU9mKCkgewogICAgICAgIHJldHVybiB0aGlzLnZhbHVlLnZhbHVlT2YoKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ1bndyYXBwZWQiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHsKICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKICAgICAgfQogICAgfV0pLCBTY2FsYXI7CiAgfSgpOwoKICBmdW5jdGlvbiBmb3JtYXRJbnB1dFZhbHVlKHZhbHVlKSB7CiAgICByZXR1cm4gVmFyaWFibGVEZWZpbml0aW9uLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHZhbHVlKSA/IHZhbHVlLnRvSW5wdXRWYWx1ZVN0cmluZygpIDogRW51bS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZih2YWx1ZSkgPyBTdHJpbmcodmFsdWUpIDogU2NhbGFyLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHZhbHVlKSA/IEpTT04uc3RyaW5naWZ5KHZhbHVlLnZhbHVlT2YoKSkgOiBBcnJheS5pc0FycmF5KHZhbHVlKSA/ICJbIiArIGpvaW4uYXBwbHkodm9pZCAwLCB0b0NvbnN1bWFibGVBcnJheSh2YWx1ZS5tYXAoZm9ybWF0SW5wdXRWYWx1ZSkpKSArICJdIiA6IGlzT2JqZWN0KHZhbHVlKSA/IGZvcm1hdE9iamVjdCh2YWx1ZSwgInsiLCAifSIpIDogSlNPTi5zdHJpbmdpZnkodmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gZm9ybWF0T2JqZWN0KHZhbHVlKSB7CiAgICB2YXIgb3BlbkNoYXIgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1sxXSA/IGFyZ3VtZW50c1sxXSA6ICIiLAogICAgICAgIGNsb3NlQ2hhciA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzJdID8gYXJndW1lbnRzWzJdIDogIiIsCiAgICAgICAgYXJnUGFpcnMgPSBPYmplY3Qua2V5cyh2YWx1ZSkubWFwKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgcmV0dXJuIGtleSArICI6ICIgKyBmb3JtYXRJbnB1dFZhbHVlKHZhbHVlW2tleV0pOwogICAgfSk7CiAgICByZXR1cm4gIiIgKyBvcGVuQ2hhciArIGpvaW4uYXBwbHkodm9pZCAwLCB0b0NvbnN1bWFibGVBcnJheShhcmdQYWlycykpICsgY2xvc2VDaGFyOwogIH0KCiAgZnVuY3Rpb24gZm9ybWF0QXJncyhhcmdzKSB7CiAgICByZXR1cm4gT2JqZWN0LmtleXMoYXJncykubGVuZ3RoID8gIiAoIiArIGZvcm1hdE9iamVjdChhcmdzKSArICIpIiA6ICIiOwogIH0KCiAgZnVuY3Rpb24gZm9ybWF0RGlyZWN0aXZlcyhkaXJlY3RpdmVzKSB7CiAgICBpZiAoIU9iamVjdC5rZXlzKGRpcmVjdGl2ZXMpLmxlbmd0aCkgcmV0dXJuICIiOwogICAgdmFyIGRpcmVjdGl2ZVN0cmluZ3MgPSBPYmplY3Qua2V5cyhkaXJlY3RpdmVzKS5tYXAoZnVuY3Rpb24gKGtleSkgewogICAgICB2YXIgZGlyZWN0aXZlQXJncyA9IGRpcmVjdGl2ZXNba2V5XSwKICAgICAgICAgIGFyZzsKICAgICAgcmV0dXJuICJAIiArIGtleSArIChkaXJlY3RpdmVBcmdzICYmIE9iamVjdC5rZXlzKGRpcmVjdGl2ZUFyZ3MpLmxlbmd0aCA/ICIoIiArIGZvcm1hdE9iamVjdChkaXJlY3RpdmVBcmdzKSArICIpIiA6ICIiKTsKICAgIH0pOwogICAgcmV0dXJuICIgIiArIGpvaW4uYXBwbHkodm9pZCAwLCB0b0NvbnN1bWFibGVBcnJheShkaXJlY3RpdmVTdHJpbmdzKSk7CiAgfQoKICB2YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fSwKICAgICAgUHJvZmlsZXJfdHJhY2tUeXBlRGVwZW5kZW5jeSwKICAgICAgUHJvZmlsZXJfdHJhY2tGaWVsZERlcGVuZGVuY3ksCiAgICAgIHRyYWNrVHlwZURlcGVuZGVuY3kgPSBub29wLAogICAgICB0cmFja0ZpZWxkRGVwZW5kZW5jeSA9IG5vb3A7CgogIGZ1bmN0aW9uIHBhcnNlRmllbGRDcmVhdGlvbkFyZ3MoY3JlYXRpb25BcmdzKSB7CiAgICB2YXIgY2FsbGJhY2sgPSBub29wLAogICAgICAgIG9wdGlvbnMgPSB7fSwKICAgICAgICBzZWxlY3Rpb25TZXQgPSBudWxsOwogICAgaWYgKDIgPT09IGNyZWF0aW9uQXJncy5sZW5ndGgpIHsKICAgICAgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGNyZWF0aW9uQXJnc1sxXSkgewogICAgICAgIHZhciBfY3JlYXRpb25BcmdzID0gc2xpY2VkVG9BcnJheShjcmVhdGlvbkFyZ3MsIDIpOwoKICAgICAgICBvcHRpb25zID0gX2NyZWF0aW9uQXJnc1swXSwgY2FsbGJhY2sgPSBfY3JlYXRpb25BcmdzWzFdOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBfY3JlYXRpb25BcmdzMiA9IHNsaWNlZFRvQXJyYXkoY3JlYXRpb25BcmdzLCAyKTsKCiAgICAgICAgb3B0aW9ucyA9IF9jcmVhdGlvbkFyZ3MyWzBdLCBzZWxlY3Rpb25TZXQgPSBfY3JlYXRpb25BcmdzMlsxXTsKICAgICAgfQogICAgfSBlbHNlIDEgPT09IGNyZWF0aW9uQXJncy5sZW5ndGggJiYgKFNlbGVjdGlvblNldC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihjcmVhdGlvbkFyZ3NbMF0pID8gc2VsZWN0aW9uU2V0ID0gY3JlYXRpb25BcmdzWzBdIDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgY3JlYXRpb25BcmdzWzBdID8gY2FsbGJhY2sgPSBjcmVhdGlvbkFyZ3NbMF0gOiBvcHRpb25zID0gY3JlYXRpb25BcmdzWzBdKTsKICAgIHJldHVybiB7CiAgICAgIG9wdGlvbnM6IG9wdGlvbnMsCiAgICAgIHNlbGVjdGlvblNldDogc2VsZWN0aW9uU2V0LAogICAgICBjYWxsYmFjazogY2FsbGJhY2sKICAgIH07CiAgfQoKICB2YXIgZW1wdHlBcmdzID0gT2JqZWN0LmZyZWV6ZSh7fSksCiAgICAgIGVtcHR5RGlyZWN0aXZlcyA9IE9iamVjdC5mcmVlemUoe30pLAogICAgICBGaWVsZCA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIEZpZWxkKG5hbWUsIG9wdGlvbnMsIHNlbGVjdGlvblNldCkgewogICAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBGaWVsZCksIHRoaXMubmFtZSA9IG5hbWUsIHRoaXMuYWxpYXMgPSBvcHRpb25zLmFsaWFzIHx8IG51bGwsIHRoaXMucmVzcG9uc2VLZXkgPSB0aGlzLmFsaWFzIHx8IHRoaXMubmFtZSwgdGhpcy5hcmdzID0gb3B0aW9ucy5hcmdzID8gZGVlcEZyZWV6ZUNvcHlFeGNlcHQoaXNWYXJpYWJsZSwgb3B0aW9ucy5hcmdzKSA6IGVtcHR5QXJncywgdGhpcy5kaXJlY3RpdmVzID0gb3B0aW9ucy5kaXJlY3RpdmVzID8gZGVlcEZyZWV6ZUNvcHlFeGNlcHQoaXNWYXJpYWJsZSwgb3B0aW9ucy5kaXJlY3RpdmVzKSA6IGVtcHR5RGlyZWN0aXZlcywgdGhpcy5zZWxlY3Rpb25TZXQgPSBzZWxlY3Rpb25TZXQsIE9iamVjdC5mcmVlemUodGhpcyk7CiAgICB9CgogICAgcmV0dXJuIGNyZWF0ZUNsYXNzKEZpZWxkLCBbewogICAgICBrZXk6ICJ0b1N0cmluZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHsKICAgICAgICB2YXIgYWxpYXNQcmVmaXg7CiAgICAgICAgcmV0dXJuICIiICsgKHRoaXMuYWxpYXMgPyB0aGlzLmFsaWFzICsgIjogIiA6ICIiKSArIHRoaXMubmFtZSArIGZvcm1hdEFyZ3ModGhpcy5hcmdzKSArIGZvcm1hdERpcmVjdGl2ZXModGhpcy5kaXJlY3RpdmVzKSArIHRoaXMuc2VsZWN0aW9uU2V0OwogICAgICB9CiAgICB9XSksIEZpZWxkOwogIH0oKSwKICAgICAgU3ByZWFkID0gZnVuY3Rpb24gU3ByZWFkKCkgewogICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgU3ByZWFkKTsKICB9LAogICAgICBJbmxpbmVGcmFnbWVudCA9IGZ1bmN0aW9uIChfU3ByZWFkKSB7CiAgICBmdW5jdGlvbiBJbmxpbmVGcmFnbWVudCh0eXBlTmFtZSwgc2VsZWN0aW9uU2V0KSB7CiAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIElubGluZUZyYWdtZW50KTsKCiAgICAgIHZhciBfdGhpcyA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKElubGluZUZyYWdtZW50Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoSW5saW5lRnJhZ21lbnQpKS5jYWxsKHRoaXMpKTsKCiAgICAgIHJldHVybiBfdGhpcy50eXBlTmFtZSA9IHR5cGVOYW1lLCBfdGhpcy5zZWxlY3Rpb25TZXQgPSBzZWxlY3Rpb25TZXQsIE9iamVjdC5mcmVlemUoX3RoaXMpLCBfdGhpczsKICAgIH0KCiAgICByZXR1cm4gaW5oZXJpdHMoSW5saW5lRnJhZ21lbnQsIF9TcHJlYWQpLCBjcmVhdGVDbGFzcyhJbmxpbmVGcmFnbWVudCwgW3sKICAgICAga2V5OiAidG9TdHJpbmciLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICIuLi4gb24gIiArIHRoaXMudHlwZU5hbWUgKyB0aGlzLnNlbGVjdGlvblNldDsKICAgICAgfQogICAgfV0pLCBJbmxpbmVGcmFnbWVudDsKICB9KFNwcmVhZCksCiAgICAgIEZyYWdtZW50U3ByZWFkID0gZnVuY3Rpb24gKF9TcHJlYWQyKSB7CiAgICBmdW5jdGlvbiBGcmFnbWVudFNwcmVhZChmcmFnbWVudERlZmluaXRpb24pIHsKICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgRnJhZ21lbnRTcHJlYWQpOwoKICAgICAgdmFyIF90aGlzMiA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEZyYWdtZW50U3ByZWFkLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoRnJhZ21lbnRTcHJlYWQpKS5jYWxsKHRoaXMpKTsKCiAgICAgIHJldHVybiBfdGhpczIubmFtZSA9IGZyYWdtZW50RGVmaW5pdGlvbi5uYW1lLCBfdGhpczIuc2VsZWN0aW9uU2V0ID0gZnJhZ21lbnREZWZpbml0aW9uLnNlbGVjdGlvblNldCwgT2JqZWN0LmZyZWV6ZShfdGhpczIpLCBfdGhpczI7CiAgICB9CgogICAgcmV0dXJuIGluaGVyaXRzKEZyYWdtZW50U3ByZWFkLCBfU3ByZWFkMiksIGNyZWF0ZUNsYXNzKEZyYWdtZW50U3ByZWFkLCBbewogICAgICBrZXk6ICJ0b1N0cmluZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHsKICAgICAgICByZXR1cm4gIi4uLiIgKyB0aGlzLm5hbWU7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidG9EZWZpbml0aW9uIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvRGVmaW5pdGlvbigpIHsKICAgICAgICByZXR1cm4gbmV3IEZyYWdtZW50RGVmaW5pdGlvbih0aGlzLm5hbWUsIHRoaXMuc2VsZWN0aW9uU2V0LnR5cGVTY2hlbWEubmFtZSwgdGhpcy5zZWxlY3Rpb25TZXQpOwogICAgICB9CiAgICB9XSksIEZyYWdtZW50U3ByZWFkOwogIH0oU3ByZWFkKSwKICAgICAgRnJhZ21lbnREZWZpbml0aW9uID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gRnJhZ21lbnREZWZpbml0aW9uKG5hbWUsIHR5cGVOYW1lLCBzZWxlY3Rpb25TZXQpIHsKICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgRnJhZ21lbnREZWZpbml0aW9uKSwgdGhpcy5uYW1lID0gbmFtZSwgdGhpcy50eXBlTmFtZSA9IHR5cGVOYW1lLCB0aGlzLnNlbGVjdGlvblNldCA9IHNlbGVjdGlvblNldCwgdGhpcy5zcHJlYWQgPSBuZXcgRnJhZ21lbnRTcHJlYWQodGhpcyksIE9iamVjdC5mcmVlemUodGhpcyk7CiAgICB9CgogICAgcmV0dXJuIGNyZWF0ZUNsYXNzKEZyYWdtZW50RGVmaW5pdGlvbiwgW3sKICAgICAga2V5OiAidG9TdHJpbmciLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuICJmcmFnbWVudCAiICsgdGhpcy5uYW1lICsgIiBvbiAiICsgdGhpcy50eXBlTmFtZSArICIgIiArIHRoaXMuc2VsZWN0aW9uU2V0OwogICAgICB9CiAgICB9XSksIEZyYWdtZW50RGVmaW5pdGlvbjsKICB9KCk7CgogIGZ1bmN0aW9uIHNlbGVjdGlvbnNIYXZlSWRGaWVsZChzZWxlY3Rpb25zKSB7CiAgICByZXR1cm4gc2VsZWN0aW9ucy5zb21lKGZ1bmN0aW9uIChmaWVsZE9yRnJhZ21lbnQpIHsKICAgICAgcmV0dXJuIEZpZWxkLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGZpZWxkT3JGcmFnbWVudCkgPyAiaWQiID09PSBmaWVsZE9yRnJhZ21lbnQubmFtZSA6ICEoIVNwcmVhZC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihmaWVsZE9yRnJhZ21lbnQpIHx8ICFmaWVsZE9yRnJhZ21lbnQuc2VsZWN0aW9uU2V0LnR5cGVTY2hlbWEuaW1wbGVtZW50c05vZGUpICYmIHNlbGVjdGlvbnNIYXZlSWRGaWVsZChmaWVsZE9yRnJhZ21lbnQuc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnMpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBzZWxlY3Rpb25zSGF2ZVR5cGVuYW1lRmllbGQoc2VsZWN0aW9ucykgewogICAgcmV0dXJuIHNlbGVjdGlvbnMuc29tZShmdW5jdGlvbiAoZmllbGRPckZyYWdtZW50KSB7CiAgICAgIHJldHVybiBGaWVsZC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihmaWVsZE9yRnJhZ21lbnQpID8gIl9fdHlwZW5hbWUiID09PSBmaWVsZE9yRnJhZ21lbnQubmFtZSA6ICEoIVNwcmVhZC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihmaWVsZE9yRnJhZ21lbnQpIHx8ICFmaWVsZE9yRnJhZ21lbnQuc2VsZWN0aW9uU2V0LnR5cGVTY2hlbWEuaW1wbGVtZW50c05vZGUpICYmIHNlbGVjdGlvbnNIYXZlVHlwZW5hbWVGaWVsZChmaWVsZE9yRnJhZ21lbnQuc2VsZWN0aW9uU2V0LnNlbGVjdGlvbnMpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBpbmRleFNlbGVjdGlvbnNCeVJlc3BvbnNlS2V5KHNlbGVjdGlvbnMpIHsKICAgIGZ1bmN0aW9uIGFzc2lnbk9yUHVzaChvYmosIGtleSwgdmFsdWUpIHsKICAgICAgQXJyYXkuaXNBcnJheShvYmpba2V5XSkgPyBvYmpba2V5XS5wdXNoKHZhbHVlKSA6IG9ialtrZXldID0gW3ZhbHVlXTsKICAgIH0KCiAgICB2YXIgdW5mcm96ZW5PYmplY3QgPSBzZWxlY3Rpb25zLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBzZWxlY3Rpb24pIHsKICAgICAgdmFyIHJlc3BvbnNlS2V5czsKICAgICAgc2VsZWN0aW9uLnJlc3BvbnNlS2V5ID8gYXNzaWduT3JQdXNoKGFjYywgc2VsZWN0aW9uLnJlc3BvbnNlS2V5LCBzZWxlY3Rpb24pIDogT2JqZWN0LmtleXMoc2VsZWN0aW9uLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zQnlSZXNwb25zZUtleSkuZm9yRWFjaChmdW5jdGlvbiAocmVzcG9uc2VLZXkpIHsKICAgICAgICBhc3NpZ25PclB1c2goYWNjLCByZXNwb25zZUtleSwgc2VsZWN0aW9uKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBhY2M7CiAgICB9LCB7fSk7CiAgICByZXR1cm4gT2JqZWN0LmtleXModW5mcm96ZW5PYmplY3QpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICBPYmplY3QuZnJlZXplKHVuZnJvemVuT2JqZWN0W2tleV0pOwogICAgfSksIE9iamVjdC5mcmVlemUodW5mcm96ZW5PYmplY3QpOwogIH0KCiAgdmFyIFNlbGVjdGlvblNldCA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFNlbGVjdGlvblNldCh0eXBlQnVuZGxlLCB0eXBlLCBidWlsZGVyRnVuY3Rpb24pIHsKICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgU2VsZWN0aW9uU2V0KSwgdGhpcy50eXBlU2NoZW1hID0gInN0cmluZyIgPT0gdHlwZW9mIHR5cGUgPyBzY2hlbWFGb3JUeXBlKHR5cGVCdW5kbGUsIHR5cGUpIDogdHlwZSwgdHJhY2tUeXBlRGVwZW5kZW5jeSh0aGlzLnR5cGVTY2hlbWEubmFtZSksIHRoaXMudHlwZUJ1bmRsZSA9IHR5cGVCdW5kbGUsIHRoaXMuc2VsZWN0aW9ucyA9IFtdLCBidWlsZGVyRnVuY3Rpb24gJiYgYnVpbGRlckZ1bmN0aW9uKG5ldyBTZWxlY3Rpb25TZXRCdWlsZGVyKHRoaXMudHlwZUJ1bmRsZSwgdGhpcy50eXBlU2NoZW1hLCB0aGlzLnNlbGVjdGlvbnMpKSwgKHRoaXMudHlwZVNjaGVtYS5pbXBsZW1lbnRzTm9kZSB8fCAiTm9kZSIgPT09IHRoaXMudHlwZVNjaGVtYS5uYW1lKSAmJiAoc2VsZWN0aW9uc0hhdmVJZEZpZWxkKHRoaXMuc2VsZWN0aW9ucykgfHwgdGhpcy5zZWxlY3Rpb25zLnVuc2hpZnQobmV3IEZpZWxkKCJpZCIsIHt9LCBuZXcgU2VsZWN0aW9uU2V0KHR5cGVCdW5kbGUsICJJRCIpKSkpLCAiSU5URVJGQUNFIiA9PT0gdGhpcy50eXBlU2NoZW1hLmtpbmQgJiYgKHNlbGVjdGlvbnNIYXZlVHlwZW5hbWVGaWVsZCh0aGlzLnNlbGVjdGlvbnMpIHx8IHRoaXMuc2VsZWN0aW9ucy51bnNoaWZ0KG5ldyBGaWVsZCgiX190eXBlbmFtZSIsIHt9LCBuZXcgU2VsZWN0aW9uU2V0KHR5cGVCdW5kbGUsICJTdHJpbmciKSkpKSwgdGhpcy5zZWxlY3Rpb25zQnlSZXNwb25zZUtleSA9IGluZGV4U2VsZWN0aW9uc0J5UmVzcG9uc2VLZXkodGhpcy5zZWxlY3Rpb25zKSwgT2JqZWN0LmZyZWV6ZSh0aGlzLnNlbGVjdGlvbnMpLCBPYmplY3QuZnJlZXplKHRoaXMpOwogICAgfQoKICAgIHJldHVybiBjcmVhdGVDbGFzcyhTZWxlY3Rpb25TZXQsIFt7CiAgICAgIGtleTogInRvU3RyaW5nIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogICAgICAgIHJldHVybiAiU0NBTEFSIiA9PT0gdGhpcy50eXBlU2NoZW1hLmtpbmQgfHwgIkVOVU0iID09PSB0aGlzLnR5cGVTY2hlbWEua2luZCA/ICIiIDogIiB7ICIgKyBqb2luKHRoaXMuc2VsZWN0aW9ucykgKyAiIH0iOwogICAgICB9CiAgICB9XSksIFNlbGVjdGlvblNldDsKICB9KCksCiAgICAgIFNlbGVjdGlvblNldEJ1aWxkZXIgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBTZWxlY3Rpb25TZXRCdWlsZGVyKHR5cGVCdW5kbGUsIHR5cGVTY2hlbWEsIHNlbGVjdGlvbnMpIHsKICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgU2VsZWN0aW9uU2V0QnVpbGRlciksIHRoaXMudHlwZUJ1bmRsZSA9IHR5cGVCdW5kbGUsIHRoaXMudHlwZVNjaGVtYSA9IHR5cGVTY2hlbWEsIHRoaXMuc2VsZWN0aW9ucyA9IHNlbGVjdGlvbnM7CiAgICB9CgogICAgcmV0dXJuIGNyZWF0ZUNsYXNzKFNlbGVjdGlvblNldEJ1aWxkZXIsIFt7CiAgICAgIGtleTogImhhc1NlbGVjdGlvbldpdGhSZXNwb25zZUtleSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYXNTZWxlY3Rpb25XaXRoUmVzcG9uc2VLZXkocmVzcG9uc2VLZXkpIHsKICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25zLnNvbWUoZnVuY3Rpb24gKGZpZWxkKSB7CiAgICAgICAgICByZXR1cm4gZmllbGQucmVzcG9uc2VLZXkgPT09IHJlc3BvbnNlS2V5OwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImFkZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQoc2VsZWN0aW9uT3JGaWVsZE5hbWUpIHsKICAgICAgICB2YXIgc2VsZWN0aW9uID0gdm9pZCAwOwoKICAgICAgICBpZiAoIltvYmplY3QgU3RyaW5nXSIgPT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChzZWxlY3Rpb25PckZpZWxkTmFtZSkpIHsKICAgICAgICAgIHRyYWNrRmllbGREZXBlbmRlbmN5KHRoaXMudHlwZVNjaGVtYS5uYW1lLCBzZWxlY3Rpb25PckZpZWxkTmFtZSk7CgogICAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlc3QgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgICAgIHJlc3RbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldOwogICAgICAgICAgfQoKICAgICAgICAgIHNlbGVjdGlvbiA9IHRoaXMuZmllbGQuYXBwbHkodGhpcywgW3NlbGVjdGlvbk9yRmllbGROYW1lXS5jb25jYXQocmVzdCkpOwogICAgICAgIH0gZWxzZSBGaWVsZC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihzZWxlY3Rpb25PckZpZWxkTmFtZSkgJiYgdHJhY2tGaWVsZERlcGVuZGVuY3kodGhpcy50eXBlU2NoZW1hLm5hbWUsIHNlbGVjdGlvbk9yRmllbGROYW1lLm5hbWUpLCBzZWxlY3Rpb24gPSBzZWxlY3Rpb25PckZpZWxkTmFtZTsKCiAgICAgICAgaWYgKHNlbGVjdGlvbi5yZXNwb25zZUtleSAmJiB0aGlzLmhhc1NlbGVjdGlvbldpdGhSZXNwb25zZUtleShzZWxlY3Rpb24ucmVzcG9uc2VLZXkpKSB0aHJvdyBuZXcgRXJyb3IoIlRoZSBmaWVsZCBuYW1lIG9yIGFsaWFzICciICsgc2VsZWN0aW9uLnJlc3BvbnNlS2V5ICsgIicgaGFzIGFscmVhZHkgYmVlbiBhZGRlZC4iKTsKICAgICAgICB0aGlzLnNlbGVjdGlvbnMucHVzaChzZWxlY3Rpb24pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZpZWxkIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpZWxkKG5hbWUpIHsKICAgICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGNyZWF0aW9uQXJncyA9IEFycmF5KF9sZW4yID4gMSA/IF9sZW4yIC0gMSA6IDApLCBfa2V5MiA9IDE7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHsKICAgICAgICAgIGNyZWF0aW9uQXJnc1tfa2V5MiAtIDFdID0gYXJndW1lbnRzW19rZXkyXTsKICAgICAgICB9CgogICAgICAgIHZhciBwYXJzZWRBcmdzID0gcGFyc2VGaWVsZENyZWF0aW9uQXJncyhjcmVhdGlvbkFyZ3MpLAogICAgICAgICAgICBvcHRpb25zID0gcGFyc2VkQXJncy5vcHRpb25zLAogICAgICAgICAgICBjYWxsYmFjayA9IHBhcnNlZEFyZ3MuY2FsbGJhY2ssCiAgICAgICAgICAgIHNlbGVjdGlvblNldCA9IHBhcnNlZEFyZ3Muc2VsZWN0aW9uU2V0OwoKICAgICAgICBpZiAoIXNlbGVjdGlvblNldCkgewogICAgICAgICAgaWYgKCF0aGlzLnR5cGVTY2hlbWEuZmllbGRCYXNlVHlwZXNbbmFtZV0pIHRocm93IG5ldyBFcnJvcignTm8gZmllbGQgb2YgbmFtZSAiJyArIG5hbWUgKyAnIiBmb3VuZCBvbiB0eXBlICInICsgdGhpcy50eXBlU2NoZW1hLm5hbWUgKyAnIiBpbiBzY2hlbWEnKTsKICAgICAgICAgIHZhciBmaWVsZEJhc2VUeXBlID0gc2NoZW1hRm9yVHlwZSh0aGlzLnR5cGVCdW5kbGUsIHRoaXMudHlwZVNjaGVtYS5maWVsZEJhc2VUeXBlc1tuYW1lXSk7CiAgICAgICAgICBzZWxlY3Rpb25TZXQgPSBuZXcgU2VsZWN0aW9uU2V0KHRoaXMudHlwZUJ1bmRsZSwgZmllbGRCYXNlVHlwZSwgY2FsbGJhY2spOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZChuYW1lLCBvcHRpb25zLCBzZWxlY3Rpb25TZXQpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImlubGluZUZyYWdtZW50T24iLAogICAgICB2YWx1ZTogZnVuY3Rpb24gaW5saW5lRnJhZ21lbnRPbih0eXBlTmFtZSkgewogICAgICAgIHZhciBidWlsZGVyRnVuY3Rpb25PclNlbGVjdGlvblNldCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdID8gYXJndW1lbnRzWzFdIDogbm9vcCwKICAgICAgICAgICAgc2VsZWN0aW9uU2V0ID0gdm9pZCAwOwogICAgICAgIHJldHVybiBzZWxlY3Rpb25TZXQgPSBTZWxlY3Rpb25TZXQucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYnVpbGRlckZ1bmN0aW9uT3JTZWxlY3Rpb25TZXQpID8gYnVpbGRlckZ1bmN0aW9uT3JTZWxlY3Rpb25TZXQgOiBuZXcgU2VsZWN0aW9uU2V0KHRoaXMudHlwZUJ1bmRsZSwgc2NoZW1hRm9yVHlwZSh0aGlzLnR5cGVCdW5kbGUsIHR5cGVOYW1lKSwgYnVpbGRlckZ1bmN0aW9uT3JTZWxlY3Rpb25TZXQpLCBuZXcgSW5saW5lRnJhZ21lbnQodHlwZU5hbWUsIHNlbGVjdGlvblNldCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiYWRkRmllbGQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkRmllbGQobmFtZSkgewogICAgICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgY3JlYXRpb25BcmdzID0gQXJyYXkoX2xlbjMgPiAxID8gX2xlbjMgLSAxIDogMCksIF9rZXkzID0gMTsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykgewogICAgICAgICAgY3JlYXRpb25BcmdzW19rZXkzIC0gMV0gPSBhcmd1bWVudHNbX2tleTNdOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5hZGQuYXBwbHkodGhpcywgW25hbWVdLmNvbmNhdChjcmVhdGlvbkFyZ3MpKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJhZGRDb25uZWN0aW9uIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENvbm5lY3Rpb24obmFtZSkgewogICAgICAgIGZvciAodmFyIF9sZW40ID0gYXJndW1lbnRzLmxlbmd0aCwgY3JlYXRpb25BcmdzID0gQXJyYXkoX2xlbjQgPiAxID8gX2xlbjQgLSAxIDogMCksIF9rZXk0ID0gMTsgX2tleTQgPCBfbGVuNDsgX2tleTQrKykgewogICAgICAgICAgY3JlYXRpb25BcmdzW19rZXk0IC0gMV0gPSBhcmd1bWVudHNbX2tleTRdOwogICAgICAgIH0KCiAgICAgICAgdmFyIF9wYXJzZUZpZWxkQ3JlYXRpb25BciA9IHBhcnNlRmllbGRDcmVhdGlvbkFyZ3MoY3JlYXRpb25BcmdzKSwKICAgICAgICAgICAgb3B0aW9ucyA9IF9wYXJzZUZpZWxkQ3JlYXRpb25Bci5vcHRpb25zLAogICAgICAgICAgICBjYWxsYmFjayA9IF9wYXJzZUZpZWxkQ3JlYXRpb25Bci5jYWxsYmFjaywKICAgICAgICAgICAgc2VsZWN0aW9uU2V0ID0gX3BhcnNlRmllbGRDcmVhdGlvbkFyLnNlbGVjdGlvblNldDsKCiAgICAgICAgdGhpcy5hZGQobmFtZSwgb3B0aW9ucywgZnVuY3Rpb24gKGNvbm5lY3Rpb24pIHsKICAgICAgICAgIGNvbm5lY3Rpb24uYWRkKCJwYWdlSW5mbyIsIHt9LCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgICAgfSksIGNvbm5lY3Rpb24uYWRkKCJlZGdlcyIsIHt9LCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkRmllbGQoIm5vZGUiLCB7fSwgc2VsZWN0aW9uU2V0IHx8IGNhbGxiYWNrKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImFkZElubGluZUZyYWdtZW50T24iLAogICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkSW5saW5lRnJhZ21lbnRPbih0eXBlTmFtZSkgewogICAgICAgIHZhciBmaWVsZFR5cGVDYiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdID8gYXJndW1lbnRzWzFdIDogbm9vcDsKICAgICAgICB0aGlzLmFkZCh0aGlzLmlubGluZUZyYWdtZW50T24odHlwZU5hbWUsIGZpZWxkVHlwZUNiKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiYWRkRnJhZ21lbnQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkRnJhZ21lbnQoZnJhZ21lbnRTcHJlYWQpIHsKICAgICAgICB0aGlzLmFkZChmcmFnbWVudFNwcmVhZCk7CiAgICAgIH0KICAgIH1dKSwgU2VsZWN0aW9uU2V0QnVpbGRlcjsKICB9KCk7CgogIGZ1bmN0aW9uIHBhcnNlQXJncyhhcmdzKSB7CiAgICB2YXIgbmFtZSA9IHZvaWQgMCwKICAgICAgICB2YXJpYWJsZXMgPSB2b2lkIDAsCiAgICAgICAgc2VsZWN0aW9uU2V0Q2FsbGJhY2sgPSB2b2lkIDA7CgogICAgaWYgKDMgPT09IGFyZ3MubGVuZ3RoKSB7CiAgICAgIHZhciBfYXJncyA9IHNsaWNlZFRvQXJyYXkoYXJncywgMyk7CgogICAgICBuYW1lID0gX2FyZ3NbMF0sIHZhcmlhYmxlcyA9IF9hcmdzWzFdLCBzZWxlY3Rpb25TZXRDYWxsYmFjayA9IF9hcmdzWzJdOwogICAgfSBlbHNlIDIgPT09IGFyZ3MubGVuZ3RoID8gKCJbb2JqZWN0IFN0cmluZ10iID09PSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJnc1swXSkgPyAobmFtZSA9IGFyZ3NbMF0sIHZhcmlhYmxlcyA9IG51bGwpIDogQXJyYXkuaXNBcnJheShhcmdzWzBdKSAmJiAodmFyaWFibGVzID0gYXJnc1swXSwgbmFtZSA9IG51bGwpLCBzZWxlY3Rpb25TZXRDYWxsYmFjayA9IGFyZ3NbMV0pIDogKHNlbGVjdGlvblNldENhbGxiYWNrID0gYXJnc1swXSwgbmFtZSA9IG51bGwpOwoKICAgIHJldHVybiB7CiAgICAgIG5hbWU6IG5hbWUsCiAgICAgIHZhcmlhYmxlczogdmFyaWFibGVzLAogICAgICBzZWxlY3Rpb25TZXRDYWxsYmFjazogc2VsZWN0aW9uU2V0Q2FsbGJhY2sKICAgIH07CiAgfQoKICB2YXIgVmFyaWFibGVEZWZpbml0aW9ucyA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFZhcmlhYmxlRGVmaW5pdGlvbnModmFyaWFibGVEZWZpbml0aW9ucykgewogICAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBWYXJpYWJsZURlZmluaXRpb25zKSwgdGhpcy52YXJpYWJsZURlZmluaXRpb25zID0gdmFyaWFibGVEZWZpbml0aW9ucyA/IFtdLmNvbmNhdCh0b0NvbnN1bWFibGVBcnJheSh2YXJpYWJsZURlZmluaXRpb25zKSkgOiBbXSwgT2JqZWN0LmZyZWV6ZSh0aGlzLnZhcmlhYmxlRGVmaW5pdGlvbnMpLCBPYmplY3QuZnJlZXplKHRoaXMpOwogICAgfQoKICAgIHJldHVybiBjcmVhdGVDbGFzcyhWYXJpYWJsZURlZmluaXRpb25zLCBbewogICAgICBrZXk6ICJ0b1N0cmluZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHsKICAgICAgICByZXR1cm4gMCA9PT0gdGhpcy52YXJpYWJsZURlZmluaXRpb25zLmxlbmd0aCA/ICIiIDogIiAoIiArIGpvaW4odGhpcy52YXJpYWJsZURlZmluaXRpb25zKSArICIpICI7CiAgICAgIH0KICAgIH1dKSwgVmFyaWFibGVEZWZpbml0aW9uczsKICB9KCksCiAgICAgIE9wZXJhdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIE9wZXJhdGlvbih0eXBlQnVuZGxlLCBvcGVyYXRpb25UeXBlKSB7CiAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIE9wZXJhdGlvbik7CgogICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4gPiAyID8gX2xlbiAtIDIgOiAwKSwgX2tleSA9IDI7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgICBhcmdzW19rZXkgLSAyXSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgfQoKICAgICAgdmFyIF9wYXJzZUFyZ3MgPSBwYXJzZUFyZ3MoYXJncyksCiAgICAgICAgICBuYW1lID0gX3BhcnNlQXJncy5uYW1lLAogICAgICAgICAgdmFyaWFibGVzID0gX3BhcnNlQXJncy52YXJpYWJsZXMsCiAgICAgICAgICBzZWxlY3Rpb25TZXRDYWxsYmFjayA9IF9wYXJzZUFyZ3Muc2VsZWN0aW9uU2V0Q2FsbGJhY2s7CgogICAgICB0aGlzLnR5cGVCdW5kbGUgPSB0eXBlQnVuZGxlLCB0aGlzLm5hbWUgPSBuYW1lLCB0aGlzLnZhcmlhYmxlRGVmaW5pdGlvbnMgPSBuZXcgVmFyaWFibGVEZWZpbml0aW9ucyh2YXJpYWJsZXMpLCB0aGlzLm9wZXJhdGlvblR5cGUgPSBvcGVyYXRpb25UeXBlLCAicXVlcnkiID09PSBvcGVyYXRpb25UeXBlID8gKHRoaXMuc2VsZWN0aW9uU2V0ID0gbmV3IFNlbGVjdGlvblNldCh0eXBlQnVuZGxlLCB0eXBlQnVuZGxlLnF1ZXJ5VHlwZSwgc2VsZWN0aW9uU2V0Q2FsbGJhY2spLCB0aGlzLnR5cGVTY2hlbWEgPSBzY2hlbWFGb3JUeXBlKHR5cGVCdW5kbGUsIHR5cGVCdW5kbGUucXVlcnlUeXBlKSkgOiAodGhpcy5zZWxlY3Rpb25TZXQgPSBuZXcgU2VsZWN0aW9uU2V0KHR5cGVCdW5kbGUsIHR5cGVCdW5kbGUubXV0YXRpb25UeXBlLCBzZWxlY3Rpb25TZXRDYWxsYmFjayksIHRoaXMudHlwZVNjaGVtYSA9IHNjaGVtYUZvclR5cGUodHlwZUJ1bmRsZSwgdHlwZUJ1bmRsZS5tdXRhdGlvblR5cGUpKSwgT2JqZWN0LmZyZWV6ZSh0aGlzKTsKICAgIH0KCiAgICByZXR1cm4gY3JlYXRlQ2xhc3MoT3BlcmF0aW9uLCBbewogICAgICBrZXk6ICJ0b1N0cmluZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHsKICAgICAgICB2YXIgbmFtZVN0cmluZyA9IHRoaXMubmFtZSA/ICIgIiArIHRoaXMubmFtZSA6ICIiOwogICAgICAgIHJldHVybiAiIiArIHRoaXMub3BlcmF0aW9uVHlwZSArIG5hbWVTdHJpbmcgKyB0aGlzLnZhcmlhYmxlRGVmaW5pdGlvbnMgKyB0aGlzLnNlbGVjdGlvblNldDsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJpc0Fub255bW91cyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkgewogICAgICAgIHJldHVybiAhdGhpcy5uYW1lOwogICAgICB9CiAgICB9XSksIE9wZXJhdGlvbjsKICB9KCksCiAgICAgIFF1ZXJ5ID0gZnVuY3Rpb24gKF9PcGVyYXRpb24pIHsKICAgIGZ1bmN0aW9uIFF1ZXJ5KHR5cGVCdW5kbGUpIHsKICAgICAgdmFyIF9yZWY7CgogICAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBRdWVyeSk7CgogICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9yZWYgPSBRdWVyeS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFF1ZXJ5KSkuY2FsbC5hcHBseShfcmVmLCBbdGhpcywgdHlwZUJ1bmRsZSwgInF1ZXJ5Il0uY29uY2F0KGFyZ3MpKSk7CiAgICB9CgogICAgcmV0dXJuIGluaGVyaXRzKFF1ZXJ5LCBfT3BlcmF0aW9uKSwgUXVlcnk7CiAgfShPcGVyYXRpb24pLAogICAgICBNdXRhdGlvbiA9IGZ1bmN0aW9uIChfT3BlcmF0aW9uKSB7CiAgICBmdW5jdGlvbiBNdXRhdGlvbih0eXBlQnVuZGxlKSB7CiAgICAgIHZhciBfcmVmOwoKICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgTXV0YXRpb24pOwoKICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07CiAgICAgIH0KCiAgICAgIHJldHVybiBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChfcmVmID0gTXV0YXRpb24uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNdXRhdGlvbikpLmNhbGwuYXBwbHkoX3JlZiwgW3RoaXMsIHR5cGVCdW5kbGUsICJtdXRhdGlvbiJdLmNvbmNhdChhcmdzKSkpOwogICAgfQoKICAgIHJldHVybiBpbmhlcml0cyhNdXRhdGlvbiwgX09wZXJhdGlvbiksIE11dGF0aW9uOwogIH0oT3BlcmF0aW9uKTsKCiAgZnVuY3Rpb24gaXNBbm9ueW1vdXMob3BlcmF0aW9uKSB7CiAgICByZXR1cm4gb3BlcmF0aW9uLmlzQW5vbnltb3VzOwogIH0KCiAgZnVuY3Rpb24gaGFzQW5vbnltb3VzT3BlcmF0aW9ucyhvcGVyYXRpb25zKSB7CiAgICByZXR1cm4gb3BlcmF0aW9ucy5zb21lKGlzQW5vbnltb3VzKTsKICB9CgogIGZ1bmN0aW9uIGhhc0R1cGxpY2F0ZU9wZXJhdGlvbk5hbWVzKG9wZXJhdGlvbnMpIHsKICAgIHZhciBuYW1lcyA9IG9wZXJhdGlvbnMubWFwKGZ1bmN0aW9uIChvcGVyYXRpb24pIHsKICAgICAgcmV0dXJuIG9wZXJhdGlvbi5uYW1lOwogICAgfSk7CiAgICByZXR1cm4gbmFtZXMucmVkdWNlKGZ1bmN0aW9uIChoYXNEdXBsaWNhdGVzLCBuYW1lLCBpbmRleCkgewogICAgICByZXR1cm4gaGFzRHVwbGljYXRlcyB8fCBuYW1lcy5pbmRleE9mKG5hbWUpICE9PSBpbmRleDsKICAgIH0sICExKTsKICB9CgogIGZ1bmN0aW9uIGV4dHJhY3RPcGVyYXRpb24odHlwZUJ1bmRsZSwgb3BlcmF0aW9uVHlwZSkgewogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuID4gMiA/IF9sZW4gLSAyIDogMCksIF9rZXkgPSAyOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGFyZ3NbX2tleSAtIDJdID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIHJldHVybiBPcGVyYXRpb24ucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYXJnc1swXSkgPyBhcmdzWzBdIDogInF1ZXJ5IiA9PT0gb3BlcmF0aW9uVHlwZSA/IG5ldyAoRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQuYXBwbHkoUXVlcnksIFtudWxsXS5jb25jYXQoW3R5cGVCdW5kbGVdLCBhcmdzKSkpKCkgOiBuZXcgKEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmFwcGx5KE11dGF0aW9uLCBbbnVsbF0uY29uY2F0KFt0eXBlQnVuZGxlXSwgYXJncykpKSgpOwogIH0KCiAgZnVuY3Rpb24gaXNJbnZhbGlkT3BlcmF0aW9uQ29tYmluYXRpb24ob3BlcmF0aW9ucykgewogICAgcmV0dXJuIDEgIT09IG9wZXJhdGlvbnMubGVuZ3RoICYmIChoYXNBbm9ueW1vdXNPcGVyYXRpb25zKG9wZXJhdGlvbnMpIHx8IGhhc0R1cGxpY2F0ZU9wZXJhdGlvbk5hbWVzKG9wZXJhdGlvbnMpKTsKICB9CgogIGZ1bmN0aW9uIGZyYWdtZW50TmFtZUlzTm90VW5pcXVlKGV4aXN0aW5nRGVmaW5pdGlvbnMsIG5hbWUpIHsKICAgIHJldHVybiBleGlzdGluZ0RlZmluaXRpb25zLnNvbWUoZnVuY3Rpb24gKGRlZmluaXRpb24pIHsKICAgICAgcmV0dXJuIGRlZmluaXRpb24ubmFtZSA9PT0gbmFtZTsKICAgIH0pOwogIH0KCiAgdmFyIERvY3VtZW50ID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gRG9jdW1lbnQodHlwZUJ1bmRsZSkgewogICAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBEb2N1bWVudCksIHRoaXMudHlwZUJ1bmRsZSA9IHR5cGVCdW5kbGUsIHRoaXMuZGVmaW5pdGlvbnMgPSBbXTsKICAgIH0KCiAgICByZXR1cm4gY3JlYXRlQ2xhc3MoRG9jdW1lbnQsIFt7CiAgICAgIGtleTogInRvU3RyaW5nIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogICAgICAgIHJldHVybiBqb2luKHRoaXMuZGVmaW5pdGlvbnMpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImFkZE9wZXJhdGlvbiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRPcGVyYXRpb24ob3BlcmF0aW9uVHlwZSkgewogICAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4yID4gMSA/IF9sZW4yIC0gMSA6IDApLCBfa2V5MiA9IDE7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHsKICAgICAgICAgIGFyZ3NbX2tleTIgLSAxXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgICAgICAgfQoKICAgICAgICB2YXIgb3BlcmF0aW9uID0gZXh0cmFjdE9wZXJhdGlvbi5hcHBseSh2b2lkIDAsIFt0aGlzLnR5cGVCdW5kbGUsIG9wZXJhdGlvblR5cGVdLmNvbmNhdChhcmdzKSk7CiAgICAgICAgaWYgKGlzSW52YWxpZE9wZXJhdGlvbkNvbWJpbmF0aW9uKHRoaXMub3BlcmF0aW9ucy5jb25jYXQob3BlcmF0aW9uKSkpIHRocm93IG5ldyBFcnJvcigiQWxsIG9wZXJhdGlvbnMgbXVzdCBiZSB1bmlxdWVseSBuYW1lZCBvbiBhIG11bHRpLW9wZXJhdGlvbiBkb2N1bWVudCIpOwogICAgICAgIHRoaXMuZGVmaW5pdGlvbnMucHVzaChvcGVyYXRpb24pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImFkZFF1ZXJ5IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFF1ZXJ5KCkgewogICAgICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4zKSwgX2tleTMgPSAwOyBfa2V5MyA8IF9sZW4zOyBfa2V5MysrKSB7CiAgICAgICAgICBhcmdzW19rZXkzXSA9IGFyZ3VtZW50c1tfa2V5M107CiAgICAgICAgfQoKICAgICAgICB0aGlzLmFkZE9wZXJhdGlvbi5hcHBseSh0aGlzLCBbInF1ZXJ5Il0uY29uY2F0KGFyZ3MpKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJhZGRNdXRhdGlvbiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRNdXRhdGlvbigpIHsKICAgICAgICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuNCksIF9rZXk0ID0gMDsgX2tleTQgPCBfbGVuNDsgX2tleTQrKykgewogICAgICAgICAgYXJnc1tfa2V5NF0gPSBhcmd1bWVudHNbX2tleTRdOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5hZGRPcGVyYXRpb24uYXBwbHkodGhpcywgWyJtdXRhdGlvbiJdLmNvbmNhdChhcmdzKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZGVmaW5lRnJhZ21lbnQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZGVmaW5lRnJhZ21lbnQobmFtZSwgb25UeXBlLCBidWlsZGVyRnVuY3Rpb24pIHsKICAgICAgICBpZiAoZnJhZ21lbnROYW1lSXNOb3RVbmlxdWUodGhpcy5mcmFnbWVudERlZmluaXRpb25zLCBuYW1lKSkgdGhyb3cgbmV3IEVycm9yKCJBbGwgZnJhZ21lbnRzIG11c3QgYmUgdW5pcXVlbHkgbmFtZWQgb24gYSBtdWx0aS1mcmFnbWVudCBkb2N1bWVudCIpOwogICAgICAgIHZhciBzZWxlY3Rpb25TZXQgPSBuZXcgU2VsZWN0aW9uU2V0KHRoaXMudHlwZUJ1bmRsZSwgb25UeXBlLCBidWlsZGVyRnVuY3Rpb24pLAogICAgICAgICAgICBmcmFnbWVudCA9IG5ldyBGcmFnbWVudERlZmluaXRpb24obmFtZSwgb25UeXBlLCBzZWxlY3Rpb25TZXQpOwogICAgICAgIHJldHVybiB0aGlzLmRlZmluaXRpb25zLnB1c2goZnJhZ21lbnQpLCBmcmFnbWVudC5zcHJlYWQ7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAib3BlcmF0aW9ucyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkgewogICAgICAgIHJldHVybiB0aGlzLmRlZmluaXRpb25zLmZpbHRlcihmdW5jdGlvbiAoZGVmaW5pdGlvbikgewogICAgICAgICAgcmV0dXJuIE9wZXJhdGlvbi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihkZWZpbml0aW9uKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJmcmFnbWVudERlZmluaXRpb25zIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZGVmaW5pdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChkZWZpbml0aW9uKSB7CiAgICAgICAgICByZXR1cm4gRnJhZ21lbnREZWZpbml0aW9uLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGRlZmluaXRpb24pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9XSksIERvY3VtZW50OwogIH0oKSwKICAgICAgR3JhcGhNb2RlbCA9IGZ1bmN0aW9uIEdyYXBoTW9kZWwoYXR0cnMpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgR3JhcGhNb2RlbCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYXR0cnMiLCB7CiAgICAgIHZhbHVlOiBhdHRycywKICAgICAgZW51bWVyYWJsZTogITEKICAgIH0pLCBPYmplY3Qua2V5cyh0aGlzLmF0dHJzKS5maWx0ZXIoZnVuY3Rpb24gKGtleSkgewogICAgICByZXR1cm4gIShrZXkgaW4gX3RoaXMpOwogICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgIHZhciBkZXNjcmlwdG9yID0gdm9pZCAwOwogICAgICBkZXNjcmlwdG9yID0gbnVsbCA9PT0gYXR0cnNba2V5XSA/IHsKICAgICAgICBlbnVtZXJhYmxlOiAhMCwKICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgfSA6IHsKICAgICAgICBlbnVtZXJhYmxlOiAhMCwKICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJzW2tleV0udmFsdWVPZigpOwogICAgICAgIH0KICAgICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KF90aGlzLCBrZXksIGRlc2NyaXB0b3IpOwogICAgfSk7CiAgfSwKICAgICAgQ2xhc3NSZWdpc3RyeSA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIENsYXNzUmVnaXN0cnkoKSB7CiAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIENsYXNzUmVnaXN0cnkpLCB0aGlzLmNsYXNzU3RvcmUgPSB7fTsKICAgIH0KCiAgICByZXR1cm4gY3JlYXRlQ2xhc3MoQ2xhc3NSZWdpc3RyeSwgW3sKICAgICAga2V5OiAicmVnaXN0ZXJDbGFzc0ZvclR5cGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJDbGFzc0ZvclR5cGUoY29uc3RydWN0b3IsIHR5cGUpIHsKICAgICAgICB0aGlzLmNsYXNzU3RvcmVbdHlwZV0gPSBjb25zdHJ1Y3RvcjsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ1bnJlZ2lzdGVyQ2xhc3NGb3JUeXBlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVucmVnaXN0ZXJDbGFzc0ZvclR5cGUodHlwZSkgewogICAgICAgIGRlbGV0ZSB0aGlzLmNsYXNzU3RvcmVbdHlwZV07CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiY2xhc3NGb3JUeXBlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsYXNzRm9yVHlwZSh0eXBlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3NTdG9yZVt0eXBlXSB8fCBHcmFwaE1vZGVsOwogICAgICB9CiAgICB9XSksIENsYXNzUmVnaXN0cnk7CiAgfSgpOwoKICBmdW5jdGlvbiBpc1ZhbHVlKGFyZykgewogICAgcmV0dXJuICJbb2JqZWN0IE51bGxdIiAhPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZykgJiYgIltvYmplY3QgVW5kZWZpbmVkXSIgIT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmcpOwogIH0KCiAgZnVuY3Rpb24gaXNOb2RlQ29udGV4dChjb250ZXh0KSB7CiAgICByZXR1cm4gY29udGV4dC5zZWxlY3Rpb24uc2VsZWN0aW9uU2V0LnR5cGVTY2hlbWEuaW1wbGVtZW50c05vZGU7CiAgfQoKICBmdW5jdGlvbiBpc0Nvbm5lY3Rpb24oY29udGV4dCkgewogICAgcmV0dXJuIGNvbnRleHQuc2VsZWN0aW9uLnNlbGVjdGlvblNldC50eXBlU2NoZW1hLm5hbWUuZW5kc1dpdGgoIkNvbm5lY3Rpb24iKTsKICB9CgogIGZ1bmN0aW9uIG5lYXJlc3ROb2RlKGNvbnRleHQpIHsKICAgIHJldHVybiBudWxsID09IGNvbnRleHQgPyBudWxsIDogaXNOb2RlQ29udGV4dChjb250ZXh0KSA/IGNvbnRleHQgOiBuZWFyZXN0Tm9kZShjb250ZXh0LnBhcmVudCk7CiAgfQoKICBmdW5jdGlvbiBjb250ZXh0c0Zyb21Sb290KGNvbnRleHQpIHsKICAgIHJldHVybiBjb250ZXh0LnBhcmVudCA/IGNvbnRleHRzRnJvbVJvb3QoY29udGV4dC5wYXJlbnQpLmNvbmNhdChjb250ZXh0KSA6IFtjb250ZXh0XTsKICB9CgogIGZ1bmN0aW9uIGNvbnRleHRzRnJvbU5lYXJlc3ROb2RlKGNvbnRleHQpIHsKICAgIHJldHVybiBjb250ZXh0LnNlbGVjdGlvbi5zZWxlY3Rpb25TZXQudHlwZVNjaGVtYS5pbXBsZW1lbnRzTm9kZSA/IFtjb250ZXh0XSA6IGNvbnRleHRzRnJvbU5lYXJlc3ROb2RlKGNvbnRleHQucGFyZW50KS5jb25jYXQoY29udGV4dCk7CiAgfQoKICBmdW5jdGlvbiBpbml0aWFsaXplRG9jdW1lbnRBbmRWYXJzKGN1cnJlbnRDb250ZXh0LCBjb250ZXh0Q2hhaW4pIHsKICAgIHZhciBsYXN0SW5DaGFpbiA9IGNvbnRleHRDaGFpbltjb250ZXh0Q2hhaW4ubGVuZ3RoIC0gMV0sCiAgICAgICAgZmlyc3QgPSBsYXN0SW5DaGFpbi5zZWxlY3Rpb24uYXJncy5maXJzdCwKICAgICAgICB2YXJpYWJsZURlZmluaXRpb25zID0gT2JqZWN0LmtleXMobGFzdEluQ2hhaW4uc2VsZWN0aW9uLmFyZ3MpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7CiAgICAgIHJldHVybiBpc1ZhcmlhYmxlKGxhc3RJbkNoYWluLnNlbGVjdGlvbi5hcmdzW2tleV0pOwogICAgfSkubWFwKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgcmV0dXJuIGxhc3RJbkNoYWluLnNlbGVjdGlvbi5hcmdzW2tleV07CiAgICB9KSwKICAgICAgICBmaXJzdFZhciA9IHZhcmlhYmxlRGVmaW5pdGlvbnMuZmluZChmdW5jdGlvbiAoZGVmaW5pdGlvbikgewogICAgICByZXR1cm4gImZpcnN0IiA9PT0gZGVmaW5pdGlvbi5uYW1lOwogICAgfSksCiAgICAgICAgZG9jdW1lbnQ7CiAgICByZXR1cm4gZmlyc3RWYXIgfHwgKGlzVmFyaWFibGUoZmlyc3QpID8gZmlyc3RWYXIgPSBmaXJzdCA6IChmaXJzdFZhciA9IHZhcmlhYmxlKCJmaXJzdCIsICJJbnQiLCBmaXJzdCksIHZhcmlhYmxlRGVmaW5pdGlvbnMucHVzaChmaXJzdFZhcikpKSwgW25ldyBEb2N1bWVudChjdXJyZW50Q29udGV4dC5zZWxlY3Rpb24uc2VsZWN0aW9uU2V0LnR5cGVCdW5kbGUpLCB2YXJpYWJsZURlZmluaXRpb25zLCBmaXJzdFZhcl07CiAgfQoKICBmdW5jdGlvbiBhZGROZXh0RmllbGRUbyhjdXJyZW50U2VsZWN0aW9uLCBjb250ZXh0Q2hhaW4sIHBhdGgsIGN1cnNvcikgewogICAgdmFyIG5leHRDb250ZXh0ID0gY29udGV4dENoYWluLnNoaWZ0KCk7CiAgICBpZiAocGF0aC5wdXNoKG5leHRDb250ZXh0LnNlbGVjdGlvbi5yZXNwb25zZUtleSksIGNvbnRleHRDaGFpbi5sZW5ndGgpIGN1cnJlbnRTZWxlY3Rpb24uYWRkKG5leHRDb250ZXh0LnNlbGVjdGlvbi5uYW1lLCB7CiAgICAgIGFsaWFzOiBuZXh0Q29udGV4dC5zZWxlY3Rpb24uYWxpYXMsCiAgICAgIGFyZ3M6IG5leHRDb250ZXh0LnNlbGVjdGlvbi5hcmdzCiAgICB9LCBmdW5jdGlvbiAobmV3U2VsZWN0aW9uKSB7CiAgICAgIGFkZE5leHRGaWVsZFRvKG5ld1NlbGVjdGlvbiwgY29udGV4dENoYWluLCBwYXRoLCBjdXJzb3IpOwogICAgfSk7ZWxzZSB7CiAgICAgIHZhciBlZGdlc0ZpZWxkLAogICAgICAgICAgbm9kZUZpZWxkID0gbmV4dENvbnRleHQuc2VsZWN0aW9uLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zLmZpbmQoZnVuY3Rpb24gKGZpZWxkKSB7CiAgICAgICAgcmV0dXJuICJlZGdlcyIgPT09IGZpZWxkLm5hbWU7CiAgICAgIH0pLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zLmZpbmQoZnVuY3Rpb24gKGZpZWxkKSB7CiAgICAgICAgcmV0dXJuICJub2RlIiA9PT0gZmllbGQubmFtZTsKICAgICAgfSksCiAgICAgICAgICBmaXJzdCA9IHZvaWQgMDsKICAgICAgZmlyc3QgPSBpc1ZhcmlhYmxlKG5leHRDb250ZXh0LnNlbGVjdGlvbi5hcmdzLmZpcnN0KSA/IG5leHRDb250ZXh0LnNlbGVjdGlvbi5hcmdzLmZpcnN0IDogdmFyaWFibGUoImZpcnN0IiwgIkludCIsIG5leHRDb250ZXh0LnNlbGVjdGlvbi5hcmdzLmZpcnN0KTsKICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgYWxpYXM6IG5leHRDb250ZXh0LnNlbGVjdGlvbi5hbGlhcywKICAgICAgICBhcmdzOiBPYmplY3QuYXNzaWduKHt9LCBuZXh0Q29udGV4dC5zZWxlY3Rpb24uYXJncywgewogICAgICAgICAgYWZ0ZXI6IGN1cnNvciwKICAgICAgICAgIGZpcnN0OiBmaXJzdAogICAgICAgIH0pCiAgICAgIH07CiAgICAgIGN1cnJlbnRTZWxlY3Rpb24uYWRkQ29ubmVjdGlvbihuZXh0Q29udGV4dC5zZWxlY3Rpb24ubmFtZSwgb3B0aW9ucywgbm9kZUZpZWxkLnNlbGVjdGlvblNldCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb2xsZWN0RnJhZ21lbnRzKHNlbGVjdGlvbnMpIHsKICAgIHJldHVybiBzZWxlY3Rpb25zLnJlZHVjZShmdW5jdGlvbiAoZnJhZ21lbnREZWZpbml0aW9ucywgZmllbGQpIHsKICAgICAgcmV0dXJuIEZyYWdtZW50U3ByZWFkLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGZpZWxkKSAmJiBmcmFnbWVudERlZmluaXRpb25zLnB1c2goZmllbGQudG9EZWZpbml0aW9uKCkpLCBmcmFnbWVudERlZmluaXRpb25zLnB1c2guYXBwbHkoZnJhZ21lbnREZWZpbml0aW9ucywgdG9Db25zdW1hYmxlQXJyYXkoY29sbGVjdEZyYWdtZW50cyhmaWVsZC5zZWxlY3Rpb25TZXQuc2VsZWN0aW9ucykpKSwgZnJhZ21lbnREZWZpbml0aW9uczsKICAgIH0sIFtdKTsKICB9CgogIGZ1bmN0aW9uIG5leHRQYWdlUXVlcnlBbmRQYXRoKGNvbnRleHQsIGN1cnNvcikgewogICAgdmFyIG5lYXJlc3ROb2RlQ29udGV4dCA9IG5lYXJlc3ROb2RlKGNvbnRleHQpOwogICAgcmV0dXJuIG5lYXJlc3ROb2RlQ29udGV4dCA/IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9kb2N1bWVudCRkZWZpbml0aW9ucywKICAgICAgICAgIHBhdGggPSBbXSwKICAgICAgICAgIG5vZGVUeXBlID0gbmVhcmVzdE5vZGVDb250ZXh0LnNlbGVjdGlvbi5zZWxlY3Rpb25TZXQudHlwZVNjaGVtYSwKICAgICAgICAgIG5vZGVJZCA9IG5lYXJlc3ROb2RlQ29udGV4dC5yZXNwb25zZURhdGEuaWQsCiAgICAgICAgICBjb250ZXh0Q2hhaW4gPSBjb250ZXh0c0Zyb21OZWFyZXN0Tm9kZShjb250ZXh0KSwKICAgICAgICAgIF9pbml0aWFsaXplRG9jdW1lbnRBbiA9IGluaXRpYWxpemVEb2N1bWVudEFuZFZhcnMoY29udGV4dCwgY29udGV4dENoYWluKSwKICAgICAgICAgIF9pbml0aWFsaXplRG9jdW1lbnRBbjIgPSBzbGljZWRUb0FycmF5KF9pbml0aWFsaXplRG9jdW1lbnRBbiwgMiksCiAgICAgICAgICBkb2N1bWVudCA9IF9pbml0aWFsaXplRG9jdW1lbnRBbjJbMF0sCiAgICAgICAgICB2YXJpYWJsZURlZmluaXRpb25zID0gX2luaXRpYWxpemVEb2N1bWVudEFuMlsxXTsKCiAgICAgIGRvY3VtZW50LmFkZFF1ZXJ5KHZhcmlhYmxlRGVmaW5pdGlvbnMsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgICAgcGF0aC5wdXNoKCJub2RlIiksIHJvb3QuYWRkKCJub2RlIiwgewogICAgICAgICAgYXJnczogewogICAgICAgICAgICBpZDogbm9kZUlkCiAgICAgICAgICB9CiAgICAgICAgfSwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgIG5vZGUuYWRkSW5saW5lRnJhZ21lbnRPbihub2RlVHlwZS5uYW1lLCBmdW5jdGlvbiAoZnJhZ21lbnQpIHsKICAgICAgICAgICAgYWRkTmV4dEZpZWxkVG8oZnJhZ21lbnQsIGNvbnRleHRDaGFpbi5zbGljZSgxKSwgcGF0aCwgY3Vyc29yKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdmFyIGZyYWdtZW50cyA9IGNvbGxlY3RGcmFnbWVudHMoZG9jdW1lbnQub3BlcmF0aW9uc1swXS5zZWxlY3Rpb25TZXQuc2VsZWN0aW9ucyk7CiAgICAgIHJldHVybiAoX2RvY3VtZW50JGRlZmluaXRpb25zID0gZG9jdW1lbnQuZGVmaW5pdGlvbnMpLnVuc2hpZnQuYXBwbHkoX2RvY3VtZW50JGRlZmluaXRpb25zLCB0b0NvbnN1bWFibGVBcnJheShmcmFnbWVudHMpKSwgW2RvY3VtZW50LCBwYXRoXTsKICAgIH0gOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZG9jdW1lbnQkZGVmaW5pdGlvbnMyLAogICAgICAgICAgcGF0aCA9IFtdLAogICAgICAgICAgY29udGV4dENoYWluID0gY29udGV4dHNGcm9tUm9vdChjb250ZXh0KSwKICAgICAgICAgIF9pbml0aWFsaXplRG9jdW1lbnRBbjMgPSBpbml0aWFsaXplRG9jdW1lbnRBbmRWYXJzKGNvbnRleHQsIGNvbnRleHRDaGFpbiksCiAgICAgICAgICBfaW5pdGlhbGl6ZURvY3VtZW50QW40ID0gc2xpY2VkVG9BcnJheShfaW5pdGlhbGl6ZURvY3VtZW50QW4zLCAyKSwKICAgICAgICAgIGRvY3VtZW50ID0gX2luaXRpYWxpemVEb2N1bWVudEFuNFswXSwKICAgICAgICAgIHZhcmlhYmxlRGVmaW5pdGlvbnMgPSBfaW5pdGlhbGl6ZURvY3VtZW50QW40WzFdOwoKICAgICAgZG9jdW1lbnQuYWRkUXVlcnkodmFyaWFibGVEZWZpbml0aW9ucywgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgICBhZGROZXh0RmllbGRUbyhyb290LCBjb250ZXh0Q2hhaW4uc2xpY2UoMSksIHBhdGgsIGN1cnNvcik7CiAgICAgIH0pOwogICAgICB2YXIgZnJhZ21lbnRzID0gY29sbGVjdEZyYWdtZW50cyhkb2N1bWVudC5vcGVyYXRpb25zWzBdLnNlbGVjdGlvblNldC5zZWxlY3Rpb25zKTsKICAgICAgcmV0dXJuIChfZG9jdW1lbnQkZGVmaW5pdGlvbnMyID0gZG9jdW1lbnQuZGVmaW5pdGlvbnMpLnVuc2hpZnQuYXBwbHkoX2RvY3VtZW50JGRlZmluaXRpb25zMiwgdG9Db25zdW1hYmxlQXJyYXkoZnJhZ21lbnRzKSksIFtkb2N1bWVudCwgcGF0aF07CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gaGFzTmV4dFBhZ2UkMShjb25uZWN0aW9uLCBlZGdlKSB7CiAgICByZXR1cm4gZWRnZSAhPT0gY29ubmVjdGlvbi5lZGdlc1tjb25uZWN0aW9uLmVkZ2VzLmxlbmd0aCAtIDFdID8gbmV3IFNjYWxhcighMCkgOiBjb25uZWN0aW9uLnBhZ2VJbmZvLmhhc05leHRQYWdlOwogIH0KCiAgZnVuY3Rpb24gaGFzUHJldmlvdXNQYWdlKGNvbm5lY3Rpb24sIGVkZ2UpIHsKICAgIHJldHVybiBlZGdlICE9PSBjb25uZWN0aW9uLmVkZ2VzWzBdID8gbmV3IFNjYWxhcighMCkgOiBjb25uZWN0aW9uLnBhZ2VJbmZvLmhhc1ByZXZpb3VzUGFnZTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZm9ybUNvbm5lY3Rpb25zKHZhcmlhYmxlVmFsdWVzKSB7CiAgICByZXR1cm4gZnVuY3Rpb24gKGNvbnRleHQsIHZhbHVlKSB7CiAgICAgIGlmIChpc0Nvbm5lY3Rpb24oY29udGV4dCkpIHsKICAgICAgICBpZiAoISh2YWx1ZS5wYWdlSW5mbyAmJiB2YWx1ZS5wYWdlSW5mby5oYXNPd25Qcm9wZXJ0eSgiaGFzTmV4dFBhZ2UiKSAmJiB2YWx1ZS5wYWdlSW5mby5oYXNPd25Qcm9wZXJ0eSgiaGFzUHJldmlvdXNQYWdlIikpKSB0aHJvdyBuZXcgRXJyb3IoJ0Nvbm5lY3Rpb25zIG11c3QgaW5jbHVkZSB0aGUgc2VsZWN0aW9ucyAicGFnZUluZm8geyBoYXNOZXh0UGFnZSwgaGFzUHJldmlvdXNQYWdlIH0iLicpOwogICAgICAgIHJldHVybiB2YWx1ZS5lZGdlcy5tYXAoZnVuY3Rpb24gKGVkZ2UpIHsKICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGVkZ2Uubm9kZSwgewogICAgICAgICAgICBuZXh0UGFnZVF1ZXJ5QW5kUGF0aDogbmV4dFBhZ2VRdWVyeUFuZFBhdGgoY29udGV4dCwgZWRnZS5jdXJzb3IpLAogICAgICAgICAgICBoYXNOZXh0UGFnZTogaGFzTmV4dFBhZ2UkMSh2YWx1ZSwgZWRnZSksCiAgICAgICAgICAgIGhhc1ByZXZpb3VzUGFnZTogaGFzUHJldmlvdXNQYWdlKHZhbHVlLCBlZGdlKSwKICAgICAgICAgICAgdmFyaWFibGVWYWx1ZXM6IHZhcmlhYmxlVmFsdWVzCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfTsKICB9CgogIHZhciBEZWNvZGluZ0NvbnRleHQgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBEZWNvZGluZ0NvbnRleHQoc2VsZWN0aW9uLCByZXNwb25zZURhdGEpIHsKICAgICAgdmFyIHBhcmVudCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzJdID8gYXJndW1lbnRzWzJdIDogbnVsbDsKICAgICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgRGVjb2RpbmdDb250ZXh0KSwgdGhpcy5zZWxlY3Rpb24gPSBzZWxlY3Rpb24sIHRoaXMucmVzcG9uc2VEYXRhID0gcmVzcG9uc2VEYXRhLCB0aGlzLnBhcmVudCA9IHBhcmVudCwgT2JqZWN0LmZyZWV6ZSh0aGlzKTsKICAgIH0KCiAgICByZXR1cm4gY3JlYXRlQ2xhc3MoRGVjb2RpbmdDb250ZXh0LCBbewogICAgICBrZXk6ICJjb250ZXh0Rm9yT2JqZWN0UHJvcGVydHkiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gY29udGV4dEZvck9iamVjdFByb3BlcnR5KHJlc3BvbnNlS2V5KSB7CiAgICAgICAgdmFyIG5lc3RlZFNlbGVjdGlvbnMgPSB0aGlzLnNlbGVjdGlvbi5zZWxlY3Rpb25TZXQuc2VsZWN0aW9uc0J5UmVzcG9uc2VLZXlbcmVzcG9uc2VLZXldLAogICAgICAgICAgICBuZXh0U2VsZWN0aW9uID0gbmVzdGVkU2VsZWN0aW9ucyAmJiBuZXN0ZWRTZWxlY3Rpb25zWzBdLAogICAgICAgICAgICBuZXh0Q29udGV4dCA9IHZvaWQgMDsKICAgICAgICBpZiAobmV4dENvbnRleHQgPSBTcHJlYWQucHJvdG90eXBlLmlzUHJvdG90eXBlT2YobmV4dFNlbGVjdGlvbikgPyBuZXcgRGVjb2RpbmdDb250ZXh0KG5leHRTZWxlY3Rpb24sIHRoaXMucmVzcG9uc2VEYXRhLCB0aGlzLnBhcmVudCkgOiBuZXcgRGVjb2RpbmdDb250ZXh0KG5leHRTZWxlY3Rpb24sIHRoaXMucmVzcG9uc2VEYXRhW3Jlc3BvbnNlS2V5XSwgdGhpcyksICFuZXh0U2VsZWN0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1VuZXhwZWN0ZWQgcmVzcG9uc2Uga2V5ICInICsgcmVzcG9uc2VLZXkgKyAnIiwgbm90IGZvdW5kIGluIHNlbGVjdGlvbiBzZXQ6ICcgKyB0aGlzLnNlbGVjdGlvbi5zZWxlY3Rpb25TZXQpOwogICAgICAgIHJldHVybiBGaWVsZC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihuZXh0U2VsZWN0aW9uKSA/IG5leHRDb250ZXh0IDogbmV4dENvbnRleHQuY29udGV4dEZvck9iamVjdFByb3BlcnR5KHJlc3BvbnNlS2V5KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjb250ZXh0Rm9yQXJyYXlJdGVtIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnRleHRGb3JBcnJheUl0ZW0oaXRlbSkgewogICAgICAgIHJldHVybiBuZXcgRGVjb2RpbmdDb250ZXh0KHRoaXMuc2VsZWN0aW9uLCBpdGVtLCB0aGlzLnBhcmVudCk7CiAgICAgIH0KICAgIH1dKSwgRGVjb2RpbmdDb250ZXh0OwogIH0oKTsKCiAgZnVuY3Rpb24gZGVjb2RlQXJyYXlJdGVtcyhjb250ZXh0LCB0cmFuc2Zvcm1lcnMpIHsKICAgIHJldHVybiBjb250ZXh0LnJlc3BvbnNlRGF0YS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgcmV0dXJuIGRlY29kZUNvbnRleHQoY29udGV4dC5jb250ZXh0Rm9yQXJyYXlJdGVtKGl0ZW0pLCB0cmFuc2Zvcm1lcnMpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVPYmplY3RWYWx1ZXMoY29udGV4dCwgdHJhbnNmb3JtZXJzKSB7CiAgICByZXR1cm4gT2JqZWN0LmtleXMoY29udGV4dC5yZXNwb25zZURhdGEpLnJlZHVjZShmdW5jdGlvbiAoYWNjLCByZXNwb25zZUtleSkgewogICAgICByZXR1cm4gYWNjW3Jlc3BvbnNlS2V5XSA9IGRlY29kZUNvbnRleHQoY29udGV4dC5jb250ZXh0Rm9yT2JqZWN0UHJvcGVydHkocmVzcG9uc2VLZXkpLCB0cmFuc2Zvcm1lcnMpLCBhY2M7CiAgICB9LCB7fSk7CiAgfQoKICBmdW5jdGlvbiBydW5UcmFuc2Zvcm1lcnModHJhbnNmb3JtZXJzLCBjb250ZXh0LCB2YWx1ZSkgewogICAgcmV0dXJuIHRyYW5zZm9ybWVycy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgdHJhbnNmb3JtZXIpIHsKICAgICAgcmV0dXJuIHRyYW5zZm9ybWVyKGNvbnRleHQsIGFjYyk7CiAgICB9LCB2YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVDb250ZXh0KGNvbnRleHQsIHRyYW5zZm9ybWVycykgewogICAgdmFyIHZhbHVlID0gY29udGV4dC5yZXNwb25zZURhdGE7CiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA9IGRlY29kZUFycmF5SXRlbXMoY29udGV4dCwgdHJhbnNmb3JtZXJzKSA6IGlzT2JqZWN0KHZhbHVlKSAmJiAodmFsdWUgPSBkZWNvZGVPYmplY3RWYWx1ZXMoY29udGV4dCwgdHJhbnNmb3JtZXJzKSksIHJ1blRyYW5zZm9ybWVycyh0cmFuc2Zvcm1lcnMsIGNvbnRleHQsIHZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGdlbmVyYXRlUmVmZXRjaFF1ZXJpZXMoY29udGV4dCwgdmFsdWUpIHsKICAgIHJldHVybiBpc1ZhbHVlKHZhbHVlKSAmJiBpc05vZGVDb250ZXh0KGNvbnRleHQpICYmICh2YWx1ZS5yZWZldGNoUXVlcnkgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBuZXcgUXVlcnkoY29udGV4dC5zZWxlY3Rpb24uc2VsZWN0aW9uU2V0LnR5cGVCdW5kbGUsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgICAgcm9vdC5hZGQoIm5vZGUiLCB7CiAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgIGlkOiBjb250ZXh0LnJlc3BvbnNlRGF0YS5pZAogICAgICAgICAgfQogICAgICAgIH0sIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICBub2RlLmFkZElubGluZUZyYWdtZW50T24oY29udGV4dC5zZWxlY3Rpb24uc2VsZWN0aW9uU2V0LnR5cGVTY2hlbWEubmFtZSwgY29udGV4dC5zZWxlY3Rpb24uc2VsZWN0aW9uU2V0KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgdmFsdWU7CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zvcm1Qb2pvc1RvQ2xhc3Nlc1dpdGhSZWdpc3RyeShjbGFzc1JlZ2lzdHJ5KSB7CiAgICByZXR1cm4gZnVuY3Rpb24gdHJhbnNmb3JtUG9qb3NUb0NsYXNzZXMoY29udGV4dCwgdmFsdWUpIHsKICAgICAgdmFyIEtsYXNzOwogICAgICByZXR1cm4gaXNPYmplY3QodmFsdWUpID8gbmV3IChjbGFzc1JlZ2lzdHJ5LmNsYXNzRm9yVHlwZShjb250ZXh0LnNlbGVjdGlvbi5zZWxlY3Rpb25TZXQudHlwZVNjaGVtYS5uYW1lKSkodmFsdWUpIDogdmFsdWU7CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gdHJhbnNmb3JtU2NhbGFycyhjb250ZXh0LCB2YWx1ZSkgewogICAgaWYgKGlzVmFsdWUodmFsdWUpKSB7CiAgICAgIGlmICgiU0NBTEFSIiA9PT0gY29udGV4dC5zZWxlY3Rpb24uc2VsZWN0aW9uU2V0LnR5cGVTY2hlbWEua2luZCkgcmV0dXJuIG5ldyBTY2FsYXIodmFsdWUpOwogICAgICBpZiAoIkVOVU0iID09PSBjb250ZXh0LnNlbGVjdGlvbi5zZWxlY3Rpb25TZXQudHlwZVNjaGVtYS5raW5kKSByZXR1cm4gbmV3IEVudW0odmFsdWUpOwogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9CgogIGZ1bmN0aW9uIHJlY29yZFR5cGVJbmZvcm1hdGlvbihjb250ZXh0LCB2YWx1ZSkgewogICAgdmFyIF9jb250ZXh0JHNlbGVjdGlvbiRzZSA9IGNvbnRleHQuc2VsZWN0aW9uLnNlbGVjdGlvblNldCwKICAgICAgICB0eXBlQnVuZGxlID0gX2NvbnRleHQkc2VsZWN0aW9uJHNlLnR5cGVCdW5kbGUsCiAgICAgICAgdHlwZVNjaGVtYSA9IF9jb250ZXh0JHNlbGVjdGlvbiRzZS50eXBlU2NoZW1hOwogICAgcmV0dXJuIGlzVmFsdWUodmFsdWUpICYmICh2YWx1ZS5fX3R5cGVuYW1lID8gdmFsdWUudHlwZSA9IHNjaGVtYUZvclR5cGUodHlwZUJ1bmRsZSwgdmFsdWUuX190eXBlbmFtZSwgdHlwZVNjaGVtYSkgOiB2YWx1ZS50eXBlID0gdHlwZVNjaGVtYSksIHZhbHVlOwogIH0KCiAgZnVuY3Rpb24gZGVmYXVsdFRyYW5zZm9ybWVycyhfcmVmKSB7CiAgICB2YXIgX3JlZiRjbGFzc1JlZ2lzdHJ5ID0gX3JlZi5jbGFzc1JlZ2lzdHJ5LAogICAgICAgIGNsYXNzUmVnaXN0cnkgPSB2b2lkIDAgPT09IF9yZWYkY2xhc3NSZWdpc3RyeSA/IG5ldyBDbGFzc1JlZ2lzdHJ5KCkgOiBfcmVmJGNsYXNzUmVnaXN0cnksCiAgICAgICAgdmFyaWFibGVWYWx1ZXM7CiAgICByZXR1cm4gW3RyYW5zZm9ybVNjYWxhcnMsIGdlbmVyYXRlUmVmZXRjaFF1ZXJpZXMsIHRyYW5zZm9ybUNvbm5lY3Rpb25zKF9yZWYudmFyaWFibGVWYWx1ZXMpLCByZWNvcmRUeXBlSW5mb3JtYXRpb24sIHRyYW5zZm9ybVBvam9zVG9DbGFzc2VzV2l0aFJlZ2lzdHJ5KGNsYXNzUmVnaXN0cnkpXTsKICB9CgogIGZ1bmN0aW9uIGRlY29kZShzZWxlY3Rpb24sIHJlc3BvbnNlRGF0YSkgewogICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1syXSA/IGFyZ3VtZW50c1syXSA6IHt9LAogICAgICAgIHRyYW5zZm9ybWVycyA9IG9wdGlvbnMudHJhbnNmb3JtZXJzIHx8IGRlZmF1bHRUcmFuc2Zvcm1lcnMob3B0aW9ucyksCiAgICAgICAgY29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoc2VsZWN0aW9uLCByZXNwb25zZURhdGEpOwogICAgcmV0dXJuIGRlY29kZUNvbnRleHQoY29udGV4dCwgdHJhbnNmb3JtZXJzKTsKICB9CgogIGZ1bmN0aW9uIGh0dHBGZXRjaGVyKHVybCkgewogICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1sxXSA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgcmV0dXJuIGZ1bmN0aW9uIGZldGNoZXIoZ3JhcGhRTFBhcmFtcywgaGVhZGVycykgewogICAgICByZXR1cm4gZmV0Y2godXJsLCBfZXh0ZW5kcyh7CiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZ3JhcGhRTFBhcmFtcyksCiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgbW9kZTogImNvcnMiCiAgICAgIH0sIG9wdGlvbnMsIHsKICAgICAgICBoZWFkZXJzOiBfZXh0ZW5kcyh7CiAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgQWNjZXB0OiAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICB9LCBvcHRpb25zLmhlYWRlcnMsIGhlYWRlcnMpCiAgICAgIH0pKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBjb250ZW50VHlwZTsKICAgICAgICByZXR1cm4gcmVzcG9uc2UuaGVhZGVycy5nZXQoImNvbnRlbnQtdHlwZSIpLmluZGV4T2YoImFwcGxpY2F0aW9uL2pzb24iKSA+IC0xID8gcmVzcG9uc2UuanNvbigpIDogcmVzcG9uc2UudGV4dCgpLnRoZW4oZnVuY3Rpb24gKHRleHQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHRleHQ6IHRleHQKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfTsKICB9CgogIGZ1bmN0aW9uIGhhc05leHRQYWdlKHBhZ2luYXRlZE1vZGVscykgewogICAgcmV0dXJuIHBhZ2luYXRlZE1vZGVscyAmJiBwYWdpbmF0ZWRNb2RlbHMubGVuZ3RoICYmIHBhZ2luYXRlZE1vZGVsc1twYWdpbmF0ZWRNb2RlbHMubGVuZ3RoIC0gMV0uaGFzTmV4dFBhZ2U7CiAgfQoKICB2YXIgQ2xpZW50JDIgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBDbGllbnQodHlwZUJ1bmRsZSwgX3JlZikgewogICAgICB2YXIgdXJsID0gX3JlZi51cmwsCiAgICAgICAgICBmZXRjaGVyT3B0aW9ucyA9IF9yZWYuZmV0Y2hlck9wdGlvbnMsCiAgICAgICAgICBmZXRjaGVyID0gX3JlZi5mZXRjaGVyLAogICAgICAgICAgX3JlZiRyZWdpc3RyeSA9IF9yZWYucmVnaXN0cnksCiAgICAgICAgICByZWdpc3RyeSA9IHZvaWQgMCA9PT0gX3JlZiRyZWdpc3RyeSA/IG5ldyBDbGFzc1JlZ2lzdHJ5KCkgOiBfcmVmJHJlZ2lzdHJ5OwogICAgICBpZiAoY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2xpZW50KSwgdGhpcy50eXBlQnVuZGxlID0gdHlwZUJ1bmRsZSwgdGhpcy5jbGFzc1JlZ2lzdHJ5ID0gcmVnaXN0cnksIHVybCAmJiBmZXRjaGVyKSB0aHJvdyBuZXcgRXJyb3IoIkFyZ3VtZW50cyBub3Qgc3VwcG9ydGVkOiBzdXBwbHkgZWl0aGVyIGB1cmxgIGFuZCBvcHRpb25hbCBgZmV0Y2hlck9wdGlvbnNgIE9SIHVzZSBhIGBmZXRjaGVyYCBmdW5jdGlvbiBmb3IgZnVydGhlciBjdXN0b21pemF0aW9uLiIpOwogICAgICBpZiAodXJsKSB0aGlzLmZldGNoZXIgPSBodHRwRmV0Y2hlcih1cmwsIGZldGNoZXJPcHRpb25zKTtlbHNlIHsKICAgICAgICBpZiAoIWZldGNoZXIpIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBhcmd1bWVudHM6IG9uZSBvZiBgdXJsYCBvciBgZmV0Y2hlcmAgaXMgbmVlZGVkLiIpOwogICAgICAgIGlmIChmZXRjaGVyT3B0aW9ucykgdGhyb3cgbmV3IEVycm9yKCJBcmd1bWVudHMgbm90IHN1cHBvcnRlZDogd2hlbiBzcGVjaWZ5aW5nIHlvdXIgb3duIGBmZXRjaGVyYCwgc2V0IG9wdGlvbnMgdGhyb3VnaCBpdCBhbmQgbm90IHdpdGggYGZldGNoZXJPcHRpb25zYCIpOwogICAgICAgIHRoaXMuZmV0Y2hlciA9IGZldGNoZXI7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gY3JlYXRlQ2xhc3MoQ2xpZW50LCBbewogICAgICBrZXk6ICJkb2N1bWVudCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkb2N1bWVudCgpIHsKICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KHRoaXMudHlwZUJ1bmRsZSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAicXVlcnkiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcXVlcnkoKSB7CiAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3IChGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5hcHBseShRdWVyeSwgW251bGxdLmNvbmNhdChbdGhpcy50eXBlQnVuZGxlXSwgYXJncykpKSgpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm11dGF0aW9uIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIG11dGF0aW9uKCkgewogICAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7CiAgICAgICAgICBhcmdzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3IChGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5hcHBseShNdXRhdGlvbiwgW251bGxdLmNvbmNhdChbdGhpcy50eXBlQnVuZGxlXSwgYXJncykpKSgpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInNlbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZChyZXF1ZXN0KSB7CiAgICAgICAgdmFyIHZhcmlhYmxlVmFsdWVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMV0gPyBhcmd1bWVudHNbMV0gOiBudWxsLAogICAgICAgICAgICBfdGhpcyA9IHRoaXMsCiAgICAgICAgICAgIG90aGVyUHJvcGVydGllcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzJdID8gYXJndW1lbnRzWzJdIDogbnVsbCwKICAgICAgICAgICAgaGVhZGVycyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzNdID8gYXJndW1lbnRzWzNdIDogbnVsbCwKICAgICAgICAgICAgb3BlcmF0aW9uT3JEb2N1bWVudCA9IHZvaWQgMCwKICAgICAgICAgICAgZ3JhcGhRTFBhcmFtcyA9IHsKICAgICAgICAgIHF1ZXJ5OiAob3BlcmF0aW9uT3JEb2N1bWVudCA9IEZ1bmN0aW9uLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHJlcXVlc3QpID8gcmVxdWVzdCh0aGlzKSA6IHJlcXVlc3QpLnRvU3RyaW5nKCkKICAgICAgICB9OwoKICAgICAgICB2YXJpYWJsZVZhbHVlcyAmJiAoZ3JhcGhRTFBhcmFtcy52YXJpYWJsZXMgPSB2YXJpYWJsZVZhbHVlcyksIE9iamVjdC5hc3NpZ24oZ3JhcGhRTFBhcmFtcywgb3RoZXJQcm9wZXJ0aWVzKTsKICAgICAgICB2YXIgb3BlcmF0aW9uID0gdm9pZCAwOwogICAgICAgIGlmIChPcGVyYXRpb24ucHJvdG90eXBlLmlzUHJvdG90eXBlT2Yob3BlcmF0aW9uT3JEb2N1bWVudCkpIG9wZXJhdGlvbiA9IG9wZXJhdGlvbk9yRG9jdW1lbnQ7ZWxzZSB7CiAgICAgICAgICB2YXIgZG9jdW1lbnQgPSBvcGVyYXRpb25PckRvY3VtZW50OwogICAgICAgICAgaWYgKDEgPT09IGRvY3VtZW50Lm9wZXJhdGlvbnMubGVuZ3RoKSBvcGVyYXRpb24gPSBkb2N1bWVudC5vcGVyYXRpb25zWzBdO2Vsc2UgewogICAgICAgICAgICBpZiAoIW90aGVyUHJvcGVydGllcy5vcGVyYXRpb25OYW1lKSB0aHJvdyBuZXcgRXJyb3IoIlxuICAgICAgICAgIEEgZG9jdW1lbnQgbXVzdCBjb250YWluIGV4YWN0bHkgb25lIG9wZXJhdGlvbiwgb3IgYW4gb3BlcmF0aW9uTmFtZVxuICAgICAgICAgIG11c3QgYmUgc3BlY2lmaWVkLiBFeGFtcGxlOlxuXG4gICAgICAgICAgICBjbGllbnQuc2VuZChkb2N1bWVudCwgbnVsbCwge29wZXJhdGlvbk5hbWU6ICdteUZhbmN5UXVlcnknfSk7XG4gICAgICAgICIpOwogICAgICAgICAgICBvcGVyYXRpb24gPSBkb2N1bWVudC5vcGVyYXRpb25zLmZpbmQoZnVuY3Rpb24gKGRvY3VtZW50T3BlcmF0aW9uKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50T3BlcmF0aW9uLm5hbWUgPT09IG90aGVyUHJvcGVydGllcy5vcGVyYXRpb25OYW1lOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hlcihncmFwaFFMUGFyYW1zLCBoZWFkZXJzKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEgJiYgKHJlc3BvbnNlLm1vZGVsID0gZGVjb2RlKG9wZXJhdGlvbiwgcmVzcG9uc2UuZGF0YSwgewogICAgICAgICAgICBjbGFzc1JlZ2lzdHJ5OiBfdGhpcy5jbGFzc1JlZ2lzdHJ5LAogICAgICAgICAgICB2YXJpYWJsZVZhbHVlczogdmFyaWFibGVWYWx1ZXMKICAgICAgICAgIH0pKSwgcmVzcG9uc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZmV0Y2hOZXh0UGFnZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaE5leHRQYWdlKG5vZGVPck5vZGVzLCBvcHRpb25zKSB7CiAgICAgICAgdmFyIG5vZGUgPSB2b2lkIDAsCiAgICAgICAgICAgIF9ub2RlJG5leHRQYWdlUXVlcnlBbiA9IChub2RlID0gQXJyYXkuaXNBcnJheShub2RlT3JOb2RlcykgPyBub2RlT3JOb2Rlc1tub2RlT3JOb2Rlcy5sZW5ndGggLSAxXSA6IG5vZGVPck5vZGVzKS5uZXh0UGFnZVF1ZXJ5QW5kUGF0aCgpLAogICAgICAgICAgICBfbm9kZSRuZXh0UGFnZVF1ZXJ5QW4yID0gc2xpY2VkVG9BcnJheShfbm9kZSRuZXh0UGFnZVF1ZXJ5QW4sIDIpLAogICAgICAgICAgICBxdWVyeSA9IF9ub2RlJG5leHRQYWdlUXVlcnlBbjJbMF0sCiAgICAgICAgICAgIHBhdGggPSBfbm9kZSRuZXh0UGFnZVF1ZXJ5QW4yWzFdLAogICAgICAgICAgICB2YXJpYWJsZVZhbHVlcyA9IHZvaWQgMDsKCiAgICAgICAgcmV0dXJuIChub2RlLnZhcmlhYmxlVmFsdWVzIHx8IG9wdGlvbnMpICYmICh2YXJpYWJsZVZhbHVlcyA9IE9iamVjdC5hc3NpZ24oe30sIG5vZGUudmFyaWFibGVWYWx1ZXMsIG9wdGlvbnMpKSwgdGhpcy5zZW5kKHF1ZXJ5LCB2YXJpYWJsZVZhbHVlcykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHJldHVybiByZXNwb25zZS5tb2RlbCA9IHBhdGgucmVkdWNlKGZ1bmN0aW9uIChvYmplY3QsIGtleSkgewogICAgICAgICAgICByZXR1cm4gb2JqZWN0W2tleV07CiAgICAgICAgICB9LCByZXNwb25zZS5tb2RlbCksIHJlc3BvbnNlOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZldGNoQWxsUGFnZXMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2hBbGxQYWdlcyhwYWdpbmF0ZWRNb2RlbHMsIF9yZWYyKSB7CiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXMsCiAgICAgICAgICAgIHBhZ2VTaXplID0gX3JlZjIucGFnZVNpemU7CgogICAgICAgIHJldHVybiBoYXNOZXh0UGFnZShwYWdpbmF0ZWRNb2RlbHMpID8gdGhpcy5mZXRjaE5leHRQYWdlKHBhZ2luYXRlZE1vZGVscywgewogICAgICAgICAgZmlyc3Q6IHBhZ2VTaXplCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoX3JlZjMpIHsKICAgICAgICAgIHZhciBtb2RlbCA9IF9yZWYzLm1vZGVsLAogICAgICAgICAgICAgIHBhZ2VzID0gcGFnaW5hdGVkTW9kZWxzLmNvbmNhdChtb2RlbCk7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLmZldGNoQWxsUGFnZXMocGFnZXMsIHsKICAgICAgICAgICAgcGFnZVNpemU6IHBhZ2VTaXplCiAgICAgICAgICB9KTsKICAgICAgICB9KSA6IFByb21pc2UucmVzb2x2ZShwYWdpbmF0ZWRNb2RlbHMpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInJlZmV0Y2giLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcmVmZXRjaChub2RlVHlwZSkgewogICAgICAgIGlmICghbm9kZVR5cGUpIHRocm93IG5ldyBFcnJvcigiJ2NsaWVudCNyZWZldGNoJyBtdXN0IGJlIGNhbGxlZCB3aXRoIGEgbm9uLW51bGwgaW5zdGFuY2Ugb2YgYSBOb2RlLiIpOwogICAgICAgIGlmICghbm9kZVR5cGUudHlwZS5pbXBsZW1lbnRzTm9kZSkgdGhyb3cgbmV3IEVycm9yKCInY2xpZW50I3JlZmV0Y2gnIG11c3QgYmUgY2FsbGVkIHdpdGggYSB0eXBlIHRoYXQgaW1wbGVtZW50cyBOb2RlLiBSZWNlaXZlZCAiICsgbm9kZVR5cGUudHlwZS5uYW1lICsgIi4iKTsKICAgICAgICByZXR1cm4gdGhpcy5zZW5kKG5vZGVUeXBlLnJlZmV0Y2hRdWVyeSgpKS50aGVuKGZ1bmN0aW9uIChfcmVmNCkgewogICAgICAgICAgdmFyIG1vZGVsOwogICAgICAgICAgcmV0dXJuIF9yZWY0Lm1vZGVsLm5vZGU7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidmFyaWFibGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmFyaWFibGUkJDEobmFtZSwgdHlwZSwgZGVmYXVsdFZhbHVlKSB7CiAgICAgICAgcmV0dXJuIHZhcmlhYmxlKG5hbWUsIHR5cGUsIGRlZmF1bHRWYWx1ZSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZW51bSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZW51bShrZXkpIHsKICAgICAgICByZXR1cm4gZW51bUZ1bmN0aW9uKGtleSk7CiAgICAgIH0KICAgIH1dKSwgQ2xpZW50OwogIH0oKSwKICAgICAgQ29uZmlnID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gQ29uZmlnKGF0dHJzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjbGFzc0NhbGxDaGVjayQxKHRoaXMsIENvbmZpZyksIE9iamVjdC5rZXlzKHRoaXMuZGVwcmVjYXRlZFByb3BlcnRpZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIGF0dHJzLmhhc093blByb3BlcnR5KGtleSkgJiYgKGNvbnNvbGUud2FybigiW1Nob3BpZnlCdXldIENvbmZpZyBwcm9wZXJ0eSAiICsga2V5ICsgIiBpcyBkZXByZWNhdGVkIGFzIG9mIHYxLjAsIHBsZWFzZSB1c2UgIiArIF90aGlzLmRlcHJlY2F0ZWRQcm9wZXJ0aWVzW2tleV0gKyAiIGluc3RlYWQuIiksIGF0dHJzW190aGlzLmRlcHJlY2F0ZWRQcm9wZXJ0aWVzW2tleV1dID0gYXR0cnNba2V5XSk7CiAgICAgIH0pLCB0aGlzLnJlcXVpcmVkUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBpZiAoIWF0dHJzLmhhc093blByb3BlcnR5KGtleSkpIHRocm93IG5ldyBFcnJvcigibmV3IENvbmZpZygpIHJlcXVpcmVzIHRoZSBvcHRpb24gJyIgKyBrZXkgKyAiJyIpOwogICAgICAgIF90aGlzW2tleV0gPSBhdHRyc1trZXldOwogICAgICB9KSwgYXR0cnMuaGFzT3duUHJvcGVydHkoImFwaVZlcnNpb24iKSA/IHRoaXMuYXBpVmVyc2lvbiA9IGF0dHJzLmFwaVZlcnNpb24gOiB0aGlzLmFwaVZlcnNpb24gPSAiMjAyMC0wNyIsIGF0dHJzLmhhc093blByb3BlcnR5KCJzb3VyY2UiKSAmJiAodGhpcy5zb3VyY2UgPSBhdHRycy5zb3VyY2UpLCBhdHRycy5oYXNPd25Qcm9wZXJ0eSgibGFuZ3VhZ2UiKSAmJiAodGhpcy5sYW5ndWFnZSA9IGF0dHJzLmxhbmd1YWdlKTsKICAgIH0KCiAgICByZXR1cm4gY3JlYXRlQ2xhc3MkMShDb25maWcsIFt7CiAgICAgIGtleTogInJlcXVpcmVkUHJvcGVydGllcyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkgewogICAgICAgIHJldHVybiBbInN0b3JlZnJvbnRBY2Nlc3NUb2tlbiIsICJkb21haW4iXTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJkZXByZWNhdGVkUHJvcGVydGllcyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBhY2Nlc3NUb2tlbjogInN0b3JlZnJvbnRBY2Nlc3NUb2tlbiIsCiAgICAgICAgICBhcGlLZXk6ICJzdG9yZWZyb250QWNjZXNzVG9rZW4iCiAgICAgICAgfTsKICAgICAgfQogICAgfV0pLCBDb25maWc7CiAgfSgpLAogICAgICBSZXNvdXJjZSA9IGZ1bmN0aW9uIFJlc291cmNlKGNsaWVudCkgewogICAgY2xhc3NDYWxsQ2hlY2skMSh0aGlzLCBSZXNvdXJjZSksIHRoaXMuZ3JhcGhRTENsaWVudCA9IGNsaWVudDsKICB9LAogICAgICBkZWZhdWx0RXJyb3JzID0gW3sKICAgIG1lc3NhZ2U6ICJhbiB1bmtub3duIGVycm9yIGhhcyBvY2N1cnJlZC4iCiAgfV07CgogIGZ1bmN0aW9uIGRlZmF1bHRSZXNvbHZlcihwYXRoKSB7CiAgICB2YXIga2V5cyA9IHBhdGguc3BsaXQoIi4iKTsKICAgIHJldHVybiBmdW5jdGlvbiAoX3JlZikgewogICAgICB2YXIgbW9kZWwgPSBfcmVmLm1vZGVsLAogICAgICAgICAgZXJyb3JzID0gX3JlZi5lcnJvcnM7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgICByZXNvbHZlKGtleXMucmVkdWNlKGZ1bmN0aW9uIChyZWYsIGtleSkgewogICAgICAgICAgICByZXR1cm4gcmVmW2tleV07CiAgICAgICAgICB9LCBtb2RlbCkpOwogICAgICAgIH0gY2F0Y2ggKF8pIHsKICAgICAgICAgIHJlamVjdChlcnJvcnMgfHwgZGVmYXVsdEVycm9ycyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgfQoKICBmdW5jdGlvbiBmZXRjaFJlc291cmNlc0ZvclByb2R1Y3RzKHByb2R1Y3RPclByb2R1Y3QsIGNsaWVudCkgewogICAgdmFyIHByb2R1Y3RzID0gW10uY29uY2F0KHByb2R1Y3RPclByb2R1Y3QpOwogICAgcmV0dXJuIFByb21pc2UuYWxsKHByb2R1Y3RzLnJlZHVjZShmdW5jdGlvbiAocHJvbWlzZUFjYywgcHJvZHVjdCkgewogICAgICByZXR1cm4gbnVsbCA9PT0gcHJvZHVjdCA/IHByb21pc2VBY2MgOiAocHJvbWlzZUFjYy5wdXNoKGNsaWVudC5mZXRjaEFsbFBhZ2VzKHByb2R1Y3QuaW1hZ2VzLCB7CiAgICAgICAgcGFnZVNpemU6IDI1MAogICAgICB9KS50aGVuKGZ1bmN0aW9uIChpbWFnZXMpIHsKICAgICAgICBwcm9kdWN0LmF0dHJzLmltYWdlcyA9IGltYWdlczsKICAgICAgfSkpLCBwcm9taXNlQWNjLnB1c2goY2xpZW50LmZldGNoQWxsUGFnZXMocHJvZHVjdC52YXJpYW50cywgewogICAgICAgIHBhZ2VTaXplOiAyNTAKICAgICAgfSkudGhlbihmdW5jdGlvbiAodmFyaWFudHMpIHsKICAgICAgICBwcm9kdWN0LmF0dHJzLnZhcmlhbnRzID0gdmFyaWFudHM7CiAgICAgIH0pKSwgcHJvbWlzZUFjYyk7CiAgICB9LCBbXSkpOwogIH0KCiAgZnVuY3Rpb24gcGFnaW5hdGVQcm9kdWN0Q29ubmVjdGlvbnNBbmRSZXNvbHZlKGNsaWVudCkgewogICAgcmV0dXJuIGZ1bmN0aW9uIChwcm9kdWN0cykgewogICAgICByZXR1cm4gZmV0Y2hSZXNvdXJjZXNGb3JQcm9kdWN0cyhwcm9kdWN0cywgY2xpZW50KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gcHJvZHVjdHM7CiAgICAgIH0pOwogICAgfTsKICB9CgogIGZ1bmN0aW9uIHBhZ2luYXRlQ29sbGVjdGlvbnNQcm9kdWN0Q29ubmVjdGlvbnNBbmRSZXNvbHZlKGNsaWVudCkgewogICAgcmV0dXJuIGZ1bmN0aW9uIChjb2xsZWN0aW9uT3JDb2xsZWN0aW9ucykgewogICAgICB2YXIgY29sbGVjdGlvbnMgPSBbXS5jb25jYXQoY29sbGVjdGlvbk9yQ29sbGVjdGlvbnMpOwogICAgICByZXR1cm4gUHJvbWlzZS5hbGwoY29sbGVjdGlvbnMucmVkdWNlKGZ1bmN0aW9uIChwcm9taXNlQWNjLCBjb2xsZWN0aW9uKSB7CiAgICAgICAgcmV0dXJuIHByb21pc2VBY2MuY29uY2F0KGZldGNoUmVzb3VyY2VzRm9yUHJvZHVjdHMoY29sbGVjdGlvbi5wcm9kdWN0cywgY2xpZW50KSk7CiAgICAgIH0sIFtdKSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb25PckNvbGxlY3Rpb25zOwogICAgICB9KTsKICAgIH07CiAgfQoKICB2YXIgcHJvZHVjdEhlbHBlcnMgPSB7CiAgICB2YXJpYW50Rm9yT3B0aW9uczogZnVuY3Rpb24gdmFyaWFudEZvck9wdGlvbnMocHJvZHVjdCwgb3B0aW9ucykgewogICAgICByZXR1cm4gcHJvZHVjdC52YXJpYW50cy5maW5kKGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgcmV0dXJuIHZhcmlhbnQuc2VsZWN0ZWRPcHRpb25zLmV2ZXJ5KGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbikgewogICAgICAgICAgcmV0dXJuIG9wdGlvbnNbc2VsZWN0ZWRPcHRpb24ubmFtZV0gPT09IHNlbGVjdGVkT3B0aW9uLnZhbHVlLnZhbHVlT2YoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gcXVlcnkoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBfX2RlZmF1bHRPcGVyYXRpb25fXzoge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmlkID0gY2xpZW50LnZhcmlhYmxlKCJpZCIsICJJRCEiKSwgc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJ0aXRsZSIpLCByb290LmFkZCgicHJpY2UiKSwgcm9vdC5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50UHJpY2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByZXNlbnRtZW50UHJpY2VzKSB7CiAgICAgICAgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBwcmVzZW50bWVudFByaWNlcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgicHJpY2UiLCBmdW5jdGlvbiAocHJpY2UpIHsKICAgICAgICAgICAgICBwcmljZS5hZGQoImFtb3VudCIpLCBwcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImNvbXBhcmVBdFByaWNlIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlKSB7CiAgICAgICAgICAgICAgY29tcGFyZUF0UHJpY2UuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWlnaHQiKSwgcm9vdC5hZGQoImF2YWlsYWJsZUZvclNhbGUiLCB7CiAgICAgICAgYWxpYXM6ICJhdmFpbGFibGUiCiAgICAgIH0pLCByb290LmFkZCgic2t1IiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2VWMiIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZVYyKSB7CiAgICAgICAgY29tcGFyZUF0UHJpY2VWMi5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2UiLCBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgICAgICBpbWFnZS5hZGQoImlkIiksIGltYWdlLmFkZCgib3JpZ2luYWxTcmMiLCB7CiAgICAgICAgICBhbGlhczogInNyYyIKICAgICAgICB9KSwgaW1hZ2UuYWRkKCJhbHRUZXh0Iik7CiAgICAgIH0pLCByb290LmFkZCgic2VsZWN0ZWRPcHRpb25zIiwgZnVuY3Rpb24gKHNlbGVjdGVkT3B0aW9ucykgewogICAgICAgIHNlbGVjdGVkT3B0aW9ucy5hZGQoIm5hbWUiKSwgc2VsZWN0ZWRPcHRpb25zLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2UiLCBmdW5jdGlvbiAodW5pdFByaWNlKSB7CiAgICAgICAgdW5pdFByaWNlLmFkZCgiYW1vdW50IiksIHVuaXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZU1lYXN1cmVtZW50IiwgZnVuY3Rpb24gKHVuaXRQcmljZU1lYXN1cmVtZW50KSB7CiAgICAgICAgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJtZWFzdXJlZFR5cGUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVZhbHVlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVZhbHVlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuUHJvZHVjdEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlByb2R1Y3RGcmFnbWVudCIsICJQcm9kdWN0IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiksIHJvb3QuYWRkKCJjcmVhdGVkQXQiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgiZGVzY3JpcHRpb25IdG1sIiksIHJvb3QuYWRkKCJkZXNjcmlwdGlvbiIpLCByb290LmFkZCgiaGFuZGxlIiksIHJvb3QuYWRkKCJwcm9kdWN0VHlwZSIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInZlbmRvciIpLCByb290LmFkZCgicHVibGlzaGVkQXQiKSwgcm9vdC5hZGQoIm9ubGluZVN0b3JlVXJsIiksIHJvb3QuYWRkKCJvcHRpb25zIiwgZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgICAgICBvcHRpb25zLmFkZCgibmFtZSIpLCBvcHRpb25zLmFkZCgidmFsdWVzIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChpbWFnZXMpIHsKICAgICAgICBpbWFnZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBpbWFnZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoImlkIiksIG5vZGUuYWRkKCJzcmMiKSwgbm9kZS5hZGQoImFsdFRleHQiKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoInZhcmlhbnRzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uICh2YXJpYW50cykgewogICAgICAgIHZhcmlhbnRzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgdmFyaWFudHMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQuYWRkUXVlcnkoW3ZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5pZF0sIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJub2RlIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGlkOiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uaWQKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkMShjbGllbnQpIHsKICAgIHZhciBkb2N1bWVudCA9IGNsaWVudC5kb2N1bWVudCgpLAogICAgICAgIHNwcmVhZHMgPSB7fSwKICAgICAgICB2YXJpYWJsZXMgPSB7CiAgICAgIF9fZGVmYXVsdE9wZXJhdGlvbl9fOiB7fQogICAgfTsKICAgIHJldHVybiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uaWRzID0gY2xpZW50LnZhcmlhYmxlKCJpZHMiLCAiW0lEIV0hIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uSHRtbCIpLCByb290LmFkZCgiZGVzY3JpcHRpb24iKSwgcm9vdC5hZGQoImhhbmRsZSIpLCByb290LmFkZCgicHJvZHVjdFR5cGUiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJ2ZW5kb3IiKSwgcm9vdC5hZGQoInB1Ymxpc2hlZEF0IiksIHJvb3QuYWRkKCJvbmxpbmVTdG9yZVVybCIpLCByb290LmFkZCgib3B0aW9ucyIsIGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICAgICAgb3B0aW9ucy5hZGQoIm5hbWUiKSwgb3B0aW9ucy5hZGQoInZhbHVlcyIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoaW1hZ2VzKSB7CiAgICAgICAgaW1hZ2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgaW1hZ2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgic3JjIiksIG5vZGUuYWRkKCJhbHRUZXh0Iik7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ2YXJpYW50cyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAodmFyaWFudHMpIHsKICAgICAgICB2YXJpYW50cy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHZhcmlhbnRzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZFF1ZXJ5KFt2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uaWRzXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoIm5vZGVzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGlkczogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmlkcwogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKG5vZGVzKSB7CiAgICAgICAgbm9kZXMuYWRkRnJhZ21lbnQoc3ByZWFkcy5Qcm9kdWN0RnJhZ21lbnQpOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudDsKICB9CgogIGZ1bmN0aW9uIHF1ZXJ5JDIoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBfX2RlZmF1bHRPcGVyYXRpb25fXzoge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmZpcnN0ID0gY2xpZW50LnZhcmlhYmxlKCJmaXJzdCIsICJJbnQhIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5xdWVyeSA9IGNsaWVudC52YXJpYWJsZSgicXVlcnkiLCAiU3RyaW5nIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5zb3J0S2V5ID0gY2xpZW50LnZhcmlhYmxlKCJzb3J0S2V5IiwgIlByb2R1Y3RTb3J0S2V5cyIpLCB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ucmV2ZXJzZSA9IGNsaWVudC52YXJpYWJsZSgicmV2ZXJzZSIsICJCb29sZWFuIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uSHRtbCIpLCByb290LmFkZCgiZGVzY3JpcHRpb24iKSwgcm9vdC5hZGQoImhhbmRsZSIpLCByb290LmFkZCgicHJvZHVjdFR5cGUiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJ2ZW5kb3IiKSwgcm9vdC5hZGQoInB1Ymxpc2hlZEF0IiksIHJvb3QuYWRkKCJvbmxpbmVTdG9yZVVybCIpLCByb290LmFkZCgib3B0aW9ucyIsIGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICAgICAgb3B0aW9ucy5hZGQoIm5hbWUiKSwgb3B0aW9ucy5hZGQoInZhbHVlcyIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoaW1hZ2VzKSB7CiAgICAgICAgaW1hZ2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgaW1hZ2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgic3JjIiksIG5vZGUuYWRkKCJhbHRUZXh0Iik7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ2YXJpYW50cyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAodmFyaWFudHMpIHsKICAgICAgICB2YXJpYW50cy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHZhcmlhbnRzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZFF1ZXJ5KFt2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uZmlyc3QsIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5xdWVyeSwgdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnNvcnRLZXksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5yZXZlcnNlXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoInByb2R1Y3RzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uZmlyc3QsCiAgICAgICAgICBxdWVyeTogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnF1ZXJ5LAogICAgICAgICAgc29ydEtleTogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnNvcnRLZXksCiAgICAgICAgICByZXZlcnNlOiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ucmV2ZXJzZQogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByb2R1Y3RzKSB7CiAgICAgICAgcHJvZHVjdHMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBwcm9kdWN0cy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoImN1cnNvciIpLCBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudDsKICB9CgogIGZ1bmN0aW9uIHF1ZXJ5JDMoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBfX2RlZmF1bHRPcGVyYXRpb25fXzoge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmhhbmRsZSA9IGNsaWVudC52YXJpYWJsZSgiaGFuZGxlIiwgIlN0cmluZyEiKSwgc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJ0aXRsZSIpLCByb290LmFkZCgicHJpY2UiKSwgcm9vdC5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50UHJpY2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByZXNlbnRtZW50UHJpY2VzKSB7CiAgICAgICAgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBwcmVzZW50bWVudFByaWNlcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgicHJpY2UiLCBmdW5jdGlvbiAocHJpY2UpIHsKICAgICAgICAgICAgICBwcmljZS5hZGQoImFtb3VudCIpLCBwcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImNvbXBhcmVBdFByaWNlIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlKSB7CiAgICAgICAgICAgICAgY29tcGFyZUF0UHJpY2UuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWlnaHQiKSwgcm9vdC5hZGQoImF2YWlsYWJsZUZvclNhbGUiLCB7CiAgICAgICAgYWxpYXM6ICJhdmFpbGFibGUiCiAgICAgIH0pLCByb290LmFkZCgic2t1IiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2VWMiIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZVYyKSB7CiAgICAgICAgY29tcGFyZUF0UHJpY2VWMi5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2UiLCBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgICAgICBpbWFnZS5hZGQoImlkIiksIGltYWdlLmFkZCgib3JpZ2luYWxTcmMiLCB7CiAgICAgICAgICBhbGlhczogInNyYyIKICAgICAgICB9KSwgaW1hZ2UuYWRkKCJhbHRUZXh0Iik7CiAgICAgIH0pLCByb290LmFkZCgic2VsZWN0ZWRPcHRpb25zIiwgZnVuY3Rpb24gKHNlbGVjdGVkT3B0aW9ucykgewogICAgICAgIHNlbGVjdGVkT3B0aW9ucy5hZGQoIm5hbWUiKSwgc2VsZWN0ZWRPcHRpb25zLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2UiLCBmdW5jdGlvbiAodW5pdFByaWNlKSB7CiAgICAgICAgdW5pdFByaWNlLmFkZCgiYW1vdW50IiksIHVuaXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZU1lYXN1cmVtZW50IiwgZnVuY3Rpb24gKHVuaXRQcmljZU1lYXN1cmVtZW50KSB7CiAgICAgICAgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJtZWFzdXJlZFR5cGUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVZhbHVlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVZhbHVlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuUHJvZHVjdEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlByb2R1Y3RGcmFnbWVudCIsICJQcm9kdWN0IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiksIHJvb3QuYWRkKCJjcmVhdGVkQXQiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgiZGVzY3JpcHRpb25IdG1sIiksIHJvb3QuYWRkKCJkZXNjcmlwdGlvbiIpLCByb290LmFkZCgiaGFuZGxlIiksIHJvb3QuYWRkKCJwcm9kdWN0VHlwZSIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInZlbmRvciIpLCByb290LmFkZCgicHVibGlzaGVkQXQiKSwgcm9vdC5hZGQoIm9ubGluZVN0b3JlVXJsIiksIHJvb3QuYWRkKCJvcHRpb25zIiwgZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgICAgICBvcHRpb25zLmFkZCgibmFtZSIpLCBvcHRpb25zLmFkZCgidmFsdWVzIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChpbWFnZXMpIHsKICAgICAgICBpbWFnZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBpbWFnZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoImlkIiksIG5vZGUuYWRkKCJzcmMiKSwgbm9kZS5hZGQoImFsdFRleHQiKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoInZhcmlhbnRzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uICh2YXJpYW50cykgewogICAgICAgIHZhcmlhbnRzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgdmFyaWFudHMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQuYWRkUXVlcnkoW3ZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5oYW5kbGVdLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgicHJvZHVjdEJ5SGFuZGxlIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGhhbmRsZTogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmhhbmRsZQogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByb2R1Y3RCeUhhbmRsZSkgewogICAgICAgIHByb2R1Y3RCeUhhbmRsZS5hZGRGcmFnbWVudChzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgdmFyIFByb2R1Y3RSZXNvdXJjZSA9IGZ1bmN0aW9uIChfUmVzb3VyY2UpIHsKICAgIGZ1bmN0aW9uIFByb2R1Y3RSZXNvdXJjZSgpIHsKICAgICAgcmV0dXJuIGNsYXNzQ2FsbENoZWNrJDEodGhpcywgUHJvZHVjdFJlc291cmNlKSwgcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiQxKHRoaXMsIChQcm9kdWN0UmVzb3VyY2UuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihQcm9kdWN0UmVzb3VyY2UpKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTsKICAgIH0KCiAgICByZXR1cm4gaW5oZXJpdHMkMShQcm9kdWN0UmVzb3VyY2UsIF9SZXNvdXJjZSksIGNyZWF0ZUNsYXNzJDEoUHJvZHVjdFJlc291cmNlLCBbewogICAgICBrZXk6ICJmZXRjaEFsbCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaEFsbCgpIHsKICAgICAgICB2YXIgZmlyc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1swXSA/IGFyZ3VtZW50c1swXSA6IDIwOwogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQyLCB7CiAgICAgICAgICBmaXJzdDogZmlyc3QKICAgICAgICB9KS50aGVuKGRlZmF1bHRSZXNvbHZlcigicHJvZHVjdHMiKSkudGhlbihwYWdpbmF0ZVByb2R1Y3RDb25uZWN0aW9uc0FuZFJlc29sdmUodGhpcy5ncmFwaFFMQ2xpZW50KSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZmV0Y2giLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2goaWQpIHsKICAgICAgICByZXR1cm4gdGhpcy5ncmFwaFFMQ2xpZW50LnNlbmQocXVlcnksIHsKICAgICAgICAgIGlkOiBpZAogICAgICAgIH0pLnRoZW4oZGVmYXVsdFJlc29sdmVyKCJub2RlIikpLnRoZW4ocGFnaW5hdGVQcm9kdWN0Q29ubmVjdGlvbnNBbmRSZXNvbHZlKHRoaXMuZ3JhcGhRTENsaWVudCkpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZldGNoTXVsdGlwbGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2hNdWx0aXBsZShpZHMpIHsKICAgICAgICByZXR1cm4gdGhpcy5ncmFwaFFMQ2xpZW50LnNlbmQocXVlcnkkMSwgewogICAgICAgICAgaWRzOiBpZHMKICAgICAgICB9KS50aGVuKGRlZmF1bHRSZXNvbHZlcigibm9kZXMiKSkudGhlbihwYWdpbmF0ZVByb2R1Y3RDb25uZWN0aW9uc0FuZFJlc29sdmUodGhpcy5ncmFwaFFMQ2xpZW50KSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZmV0Y2hCeUhhbmRsZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaEJ5SGFuZGxlKGhhbmRsZSkgewogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQzLCB7CiAgICAgICAgICBoYW5kbGU6IGhhbmRsZQogICAgICAgIH0pLnRoZW4oZGVmYXVsdFJlc29sdmVyKCJwcm9kdWN0QnlIYW5kbGUiKSkudGhlbihwYWdpbmF0ZVByb2R1Y3RDb25uZWN0aW9uc0FuZFJlc29sdmUodGhpcy5ncmFwaFFMQ2xpZW50KSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZmV0Y2hRdWVyeSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaFF1ZXJ5KCkgewogICAgICAgIHZhciBfcmVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMF0gPyBhcmd1bWVudHNbMF0gOiB7fSwKICAgICAgICAgICAgX3JlZiRmaXJzdCA9IF9yZWYuZmlyc3QsCiAgICAgICAgICAgIGZpcnN0ID0gdm9pZCAwID09PSBfcmVmJGZpcnN0ID8gMjAgOiBfcmVmJGZpcnN0LAogICAgICAgICAgICBfcmVmJHNvcnRLZXkgPSBfcmVmLnNvcnRLZXksCiAgICAgICAgICAgIHNvcnRLZXkgPSB2b2lkIDAgPT09IF9yZWYkc29ydEtleSA/ICJJRCIgOiBfcmVmJHNvcnRLZXksCiAgICAgICAgICAgIHF1ZXJ5JCQxID0gX3JlZi5xdWVyeSwKICAgICAgICAgICAgcmV2ZXJzZSA9IF9yZWYucmV2ZXJzZTsKCiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5zZW5kKHF1ZXJ5JDIsIHsKICAgICAgICAgIGZpcnN0OiBmaXJzdCwKICAgICAgICAgIHNvcnRLZXk6IHNvcnRLZXksCiAgICAgICAgICBxdWVyeTogcXVlcnkkJDEsCiAgICAgICAgICByZXZlcnNlOiByZXZlcnNlCiAgICAgICAgfSkudGhlbihkZWZhdWx0UmVzb2x2ZXIoInByb2R1Y3RzIikpLnRoZW4ocGFnaW5hdGVQcm9kdWN0Q29ubmVjdGlvbnNBbmRSZXNvbHZlKHRoaXMuZ3JhcGhRTENsaWVudCkpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImhlbHBlcnMiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHsKICAgICAgICByZXR1cm4gcHJvZHVjdEhlbHBlcnM7CiAgICAgIH0KICAgIH1dKSwgUHJvZHVjdFJlc291cmNlOwogIH0oUmVzb3VyY2UpOwoKICBmdW5jdGlvbiBxdWVyeSQ0KGNsaWVudCkgewogICAgdmFyIGRvY3VtZW50ID0gY2xpZW50LmRvY3VtZW50KCksCiAgICAgICAgc3ByZWFkcyA9IHt9LAogICAgICAgIHZhcmlhYmxlcyA9IHsKICAgICAgX19kZWZhdWx0T3BlcmF0aW9uX186IHt9CiAgICB9OwogICAgcmV0dXJuIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5pZCA9IGNsaWVudC52YXJpYWJsZSgiaWQiLCAiSUQhIiksIHNwcmVhZHMuQ29sbGVjdGlvbkZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNvbGxlY3Rpb25GcmFnbWVudCIsICJDb2xsZWN0aW9uIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJoYW5kbGUiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uIiksIHJvb3QuYWRkKCJkZXNjcmlwdGlvbkh0bWwiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudC5hZGRRdWVyeShbdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmlkXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoIm5vZGUiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgaWQ6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5pZAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuQ29sbGVjdGlvbkZyYWdtZW50KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBxdWVyeSQ1KGNsaWVudCkgewogICAgdmFyIGRvY3VtZW50ID0gY2xpZW50LmRvY3VtZW50KCksCiAgICAgICAgc3ByZWFkcyA9IHt9LAogICAgICAgIHZhcmlhYmxlcyA9IHsKICAgICAgX19kZWZhdWx0T3BlcmF0aW9uX186IHt9CiAgICB9OwogICAgcmV0dXJuIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5pZCA9IGNsaWVudC52YXJpYWJsZSgiaWQiLCAiSUQhIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5wcm9kdWN0c0ZpcnN0ID0gY2xpZW50LnZhcmlhYmxlKCJwcm9kdWN0c0ZpcnN0IiwgIkludCEiKSwgc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJ0aXRsZSIpLCByb290LmFkZCgicHJpY2UiKSwgcm9vdC5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50UHJpY2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByZXNlbnRtZW50UHJpY2VzKSB7CiAgICAgICAgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBwcmVzZW50bWVudFByaWNlcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgicHJpY2UiLCBmdW5jdGlvbiAocHJpY2UpIHsKICAgICAgICAgICAgICBwcmljZS5hZGQoImFtb3VudCIpLCBwcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImNvbXBhcmVBdFByaWNlIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlKSB7CiAgICAgICAgICAgICAgY29tcGFyZUF0UHJpY2UuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWlnaHQiKSwgcm9vdC5hZGQoImF2YWlsYWJsZUZvclNhbGUiLCB7CiAgICAgICAgYWxpYXM6ICJhdmFpbGFibGUiCiAgICAgIH0pLCByb290LmFkZCgic2t1IiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2VWMiIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZVYyKSB7CiAgICAgICAgY29tcGFyZUF0UHJpY2VWMi5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2UiLCBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgICAgICBpbWFnZS5hZGQoImlkIiksIGltYWdlLmFkZCgib3JpZ2luYWxTcmMiLCB7CiAgICAgICAgICBhbGlhczogInNyYyIKICAgICAgICB9KSwgaW1hZ2UuYWRkKCJhbHRUZXh0Iik7CiAgICAgIH0pLCByb290LmFkZCgic2VsZWN0ZWRPcHRpb25zIiwgZnVuY3Rpb24gKHNlbGVjdGVkT3B0aW9ucykgewogICAgICAgIHNlbGVjdGVkT3B0aW9ucy5hZGQoIm5hbWUiKSwgc2VsZWN0ZWRPcHRpb25zLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2UiLCBmdW5jdGlvbiAodW5pdFByaWNlKSB7CiAgICAgICAgdW5pdFByaWNlLmFkZCgiYW1vdW50IiksIHVuaXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZU1lYXN1cmVtZW50IiwgZnVuY3Rpb24gKHVuaXRQcmljZU1lYXN1cmVtZW50KSB7CiAgICAgICAgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJtZWFzdXJlZFR5cGUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVZhbHVlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVZhbHVlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQ29sbGVjdGlvbkZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNvbGxlY3Rpb25GcmFnbWVudCIsICJDb2xsZWN0aW9uIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJoYW5kbGUiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uIiksIHJvb3QuYWRkKCJkZXNjcmlwdGlvbkh0bWwiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uSHRtbCIpLCByb290LmFkZCgiZGVzY3JpcHRpb24iKSwgcm9vdC5hZGQoImhhbmRsZSIpLCByb290LmFkZCgicHJvZHVjdFR5cGUiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJ2ZW5kb3IiKSwgcm9vdC5hZGQoInB1Ymxpc2hlZEF0IiksIHJvb3QuYWRkKCJvbmxpbmVTdG9yZVVybCIpLCByb290LmFkZCgib3B0aW9ucyIsIGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICAgICAgb3B0aW9ucy5hZGQoIm5hbWUiKSwgb3B0aW9ucy5hZGQoInZhbHVlcyIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoaW1hZ2VzKSB7CiAgICAgICAgaW1hZ2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgaW1hZ2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgic3JjIiksIG5vZGUuYWRkKCJhbHRUZXh0Iik7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ2YXJpYW50cyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAodmFyaWFudHMpIHsKICAgICAgICB2YXJpYW50cy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHZhcmlhbnRzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZFF1ZXJ5KFt2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uaWQsIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5wcm9kdWN0c0ZpcnN0XSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoIm5vZGUiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgaWQ6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5pZAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuQ29sbGVjdGlvbkZyYWdtZW50KSwgbm9kZS5hZGRJbmxpbmVGcmFnbWVudE9uKCJDb2xsZWN0aW9uIiwgZnVuY3Rpb24gKENvbGxlY3Rpb24pIHsKICAgICAgICAgIENvbGxlY3Rpb24uYWRkKCJwcm9kdWN0cyIsIHsKICAgICAgICAgICAgYXJnczogewogICAgICAgICAgICAgIGZpcnN0OiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ucHJvZHVjdHNGaXJzdAogICAgICAgICAgICB9CiAgICAgICAgICB9LCBmdW5jdGlvbiAocHJvZHVjdHMpIHsKICAgICAgICAgICAgcHJvZHVjdHMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICAgICAgfSksIHByb2R1Y3RzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgICAgICBlZGdlcy5hZGQoImN1cnNvciIpLCBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkNihjbGllbnQpIHsKICAgIHZhciBkb2N1bWVudCA9IGNsaWVudC5kb2N1bWVudCgpLAogICAgICAgIHNwcmVhZHMgPSB7fSwKICAgICAgICB2YXJpYWJsZXMgPSB7CiAgICAgIF9fZGVmYXVsdE9wZXJhdGlvbl9fOiB7fQogICAgfTsKICAgIHJldHVybiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uZmlyc3QgPSBjbGllbnQudmFyaWFibGUoImZpcnN0IiwgIkludCEiKSwgdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnF1ZXJ5ID0gY2xpZW50LnZhcmlhYmxlKCJxdWVyeSIsICJTdHJpbmciKSwgdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnNvcnRLZXkgPSBjbGllbnQudmFyaWFibGUoInNvcnRLZXkiLCAiQ29sbGVjdGlvblNvcnRLZXlzIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5yZXZlcnNlID0gY2xpZW50LnZhcmlhYmxlKCJyZXZlcnNlIiwgIkJvb2xlYW4iKSwgc3ByZWFkcy5Db2xsZWN0aW9uRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQ29sbGVjdGlvbkZyYWdtZW50IiwgIkNvbGxlY3Rpb24iLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImhhbmRsZSIpLCByb290LmFkZCgiZGVzY3JpcHRpb24iKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uSHRtbCIpLCByb290LmFkZCgidXBkYXRlZEF0IiksIHJvb3QuYWRkKCJ0aXRsZSIpLCByb290LmFkZCgiaW1hZ2UiLCBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgICAgICBpbWFnZS5hZGQoImlkIiksIGltYWdlLmFkZCgib3JpZ2luYWxTcmMiLCB7CiAgICAgICAgICBhbGlhczogInNyYyIKICAgICAgICB9KSwgaW1hZ2UuYWRkKCJhbHRUZXh0Iik7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZFF1ZXJ5KFt2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uZmlyc3QsIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5xdWVyeSwgdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnNvcnRLZXksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5yZXZlcnNlXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImNvbGxlY3Rpb25zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uZmlyc3QsCiAgICAgICAgICBxdWVyeTogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnF1ZXJ5LAogICAgICAgICAgc29ydEtleTogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnNvcnRLZXksCiAgICAgICAgICByZXZlcnNlOiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ucmV2ZXJzZQogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGNvbGxlY3Rpb25zKSB7CiAgICAgICAgY29sbGVjdGlvbnMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBjb2xsZWN0aW9ucy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoImN1cnNvciIpLCBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuQ29sbGVjdGlvbkZyYWdtZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudDsKICB9CgogIGZ1bmN0aW9uIHF1ZXJ5JDcoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBfX2RlZmF1bHRPcGVyYXRpb25fXzoge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmZpcnN0ID0gY2xpZW50LnZhcmlhYmxlKCJmaXJzdCIsICJJbnQhIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5xdWVyeSA9IGNsaWVudC52YXJpYWJsZSgicXVlcnkiLCAiU3RyaW5nIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5zb3J0S2V5ID0gY2xpZW50LnZhcmlhYmxlKCJzb3J0S2V5IiwgIkNvbGxlY3Rpb25Tb3J0S2V5cyIpLCB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ucmV2ZXJzZSA9IGNsaWVudC52YXJpYWJsZSgicmV2ZXJzZSIsICJCb29sZWFuIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5wcm9kdWN0c0ZpcnN0ID0gY2xpZW50LnZhcmlhYmxlKCJwcm9kdWN0c0ZpcnN0IiwgIkludCEiKSwgc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJ0aXRsZSIpLCByb290LmFkZCgicHJpY2UiKSwgcm9vdC5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50UHJpY2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByZXNlbnRtZW50UHJpY2VzKSB7CiAgICAgICAgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBwcmVzZW50bWVudFByaWNlcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgicHJpY2UiLCBmdW5jdGlvbiAocHJpY2UpIHsKICAgICAgICAgICAgICBwcmljZS5hZGQoImFtb3VudCIpLCBwcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImNvbXBhcmVBdFByaWNlIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlKSB7CiAgICAgICAgICAgICAgY29tcGFyZUF0UHJpY2UuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWlnaHQiKSwgcm9vdC5hZGQoImF2YWlsYWJsZUZvclNhbGUiLCB7CiAgICAgICAgYWxpYXM6ICJhdmFpbGFibGUiCiAgICAgIH0pLCByb290LmFkZCgic2t1IiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2VWMiIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZVYyKSB7CiAgICAgICAgY29tcGFyZUF0UHJpY2VWMi5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2UiLCBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgICAgICBpbWFnZS5hZGQoImlkIiksIGltYWdlLmFkZCgib3JpZ2luYWxTcmMiLCB7CiAgICAgICAgICBhbGlhczogInNyYyIKICAgICAgICB9KSwgaW1hZ2UuYWRkKCJhbHRUZXh0Iik7CiAgICAgIH0pLCByb290LmFkZCgic2VsZWN0ZWRPcHRpb25zIiwgZnVuY3Rpb24gKHNlbGVjdGVkT3B0aW9ucykgewogICAgICAgIHNlbGVjdGVkT3B0aW9ucy5hZGQoIm5hbWUiKSwgc2VsZWN0ZWRPcHRpb25zLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2UiLCBmdW5jdGlvbiAodW5pdFByaWNlKSB7CiAgICAgICAgdW5pdFByaWNlLmFkZCgiYW1vdW50IiksIHVuaXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZU1lYXN1cmVtZW50IiwgZnVuY3Rpb24gKHVuaXRQcmljZU1lYXN1cmVtZW50KSB7CiAgICAgICAgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJtZWFzdXJlZFR5cGUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVZhbHVlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVZhbHVlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQ29sbGVjdGlvbkZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNvbGxlY3Rpb25GcmFnbWVudCIsICJDb2xsZWN0aW9uIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJoYW5kbGUiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uIiksIHJvb3QuYWRkKCJkZXNjcmlwdGlvbkh0bWwiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uSHRtbCIpLCByb290LmFkZCgiZGVzY3JpcHRpb24iKSwgcm9vdC5hZGQoImhhbmRsZSIpLCByb290LmFkZCgicHJvZHVjdFR5cGUiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJ2ZW5kb3IiKSwgcm9vdC5hZGQoInB1Ymxpc2hlZEF0IiksIHJvb3QuYWRkKCJvbmxpbmVTdG9yZVVybCIpLCByb290LmFkZCgib3B0aW9ucyIsIGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICAgICAgb3B0aW9ucy5hZGQoIm5hbWUiKSwgb3B0aW9ucy5hZGQoInZhbHVlcyIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoaW1hZ2VzKSB7CiAgICAgICAgaW1hZ2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgaW1hZ2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgic3JjIiksIG5vZGUuYWRkKCJhbHRUZXh0Iik7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ2YXJpYW50cyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAodmFyaWFudHMpIHsKICAgICAgICB2YXJpYW50cy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHZhcmlhbnRzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZFF1ZXJ5KFt2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uZmlyc3QsIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5xdWVyeSwgdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnNvcnRLZXksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5yZXZlcnNlLCB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ucHJvZHVjdHNGaXJzdF0sIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJjb2xsZWN0aW9ucyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmZpcnN0LAogICAgICAgICAgcXVlcnk6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5xdWVyeSwKICAgICAgICAgIHNvcnRLZXk6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5zb3J0S2V5LAogICAgICAgICAgcmV2ZXJzZTogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnJldmVyc2UKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChjb2xsZWN0aW9ucykgewogICAgICAgIGNvbGxlY3Rpb25zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgY29sbGVjdGlvbnMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLkNvbGxlY3Rpb25GcmFnbWVudCksIG5vZGUuYWRkKCJwcm9kdWN0cyIsIHsKICAgICAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgICAgICBmaXJzdDogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLnByb2R1Y3RzRmlyc3QKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChwcm9kdWN0cykgewogICAgICAgICAgICAgIHByb2R1Y3RzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICAgICAgICB9KSwgcHJvZHVjdHMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBxdWVyeSQ4KGNsaWVudCkgewogICAgdmFyIGRvY3VtZW50ID0gY2xpZW50LmRvY3VtZW50KCksCiAgICAgICAgc3ByZWFkcyA9IHt9LAogICAgICAgIHZhcmlhYmxlcyA9IHsKICAgICAgX19kZWZhdWx0T3BlcmF0aW9uX186IHt9CiAgICB9OwogICAgcmV0dXJuIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5oYW5kbGUgPSBjbGllbnQudmFyaWFibGUoImhhbmRsZSIsICJTdHJpbmchIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uSHRtbCIpLCByb290LmFkZCgiZGVzY3JpcHRpb24iKSwgcm9vdC5hZGQoImhhbmRsZSIpLCByb290LmFkZCgicHJvZHVjdFR5cGUiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJ2ZW5kb3IiKSwgcm9vdC5hZGQoInB1Ymxpc2hlZEF0IiksIHJvb3QuYWRkKCJvbmxpbmVTdG9yZVVybCIpLCByb290LmFkZCgib3B0aW9ucyIsIGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICAgICAgb3B0aW9ucy5hZGQoIm5hbWUiKSwgb3B0aW9ucy5hZGQoInZhbHVlcyIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoaW1hZ2VzKSB7CiAgICAgICAgaW1hZ2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgaW1hZ2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgic3JjIiksIG5vZGUuYWRkKCJhbHRUZXh0Iik7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ2YXJpYW50cyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAodmFyaWFudHMpIHsKICAgICAgICB2YXJpYW50cy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHZhcmlhbnRzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQ29sbGVjdGlvbkZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNvbGxlY3Rpb25GcmFnbWVudCIsICJDb2xsZWN0aW9uIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJoYW5kbGUiKSwgcm9vdC5hZGQoImRlc2NyaXB0aW9uIiksIHJvb3QuYWRkKCJkZXNjcmlwdGlvbkh0bWwiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkNvbGxlY3Rpb25zUHJvZHVjdHNGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDb2xsZWN0aW9uc1Byb2R1Y3RzRnJhZ21lbnQiLCAiQ29sbGVjdGlvbiIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJwcm9kdWN0cyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcm9kdWN0cykgewogICAgICAgIHByb2R1Y3RzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJvZHVjdHMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLlByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQuYWRkUXVlcnkoW3ZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5oYW5kbGVdLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiY29sbGVjdGlvbkJ5SGFuZGxlIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGhhbmRsZTogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmhhbmRsZQogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGNvbGxlY3Rpb25CeUhhbmRsZSkgewogICAgICAgIGNvbGxlY3Rpb25CeUhhbmRsZS5hZGRGcmFnbWVudChzcHJlYWRzLkNvbGxlY3Rpb25GcmFnbWVudCksIGNvbGxlY3Rpb25CeUhhbmRsZS5hZGRGcmFnbWVudChzcHJlYWRzLkNvbGxlY3Rpb25zUHJvZHVjdHNGcmFnbWVudCk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgdmFyIENvbGxlY3Rpb25SZXNvdXJjZSA9IGZ1bmN0aW9uIChfUmVzb3VyY2UpIHsKICAgIGZ1bmN0aW9uIENvbGxlY3Rpb25SZXNvdXJjZSgpIHsKICAgICAgcmV0dXJuIGNsYXNzQ2FsbENoZWNrJDEodGhpcywgQ29sbGVjdGlvblJlc291cmNlKSwgcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiQxKHRoaXMsIChDb2xsZWN0aW9uUmVzb3VyY2UuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihDb2xsZWN0aW9uUmVzb3VyY2UpKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTsKICAgIH0KCiAgICByZXR1cm4gaW5oZXJpdHMkMShDb2xsZWN0aW9uUmVzb3VyY2UsIF9SZXNvdXJjZSksIGNyZWF0ZUNsYXNzJDEoQ29sbGVjdGlvblJlc291cmNlLCBbewogICAgICBrZXk6ICJmZXRjaEFsbCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaEFsbCgpIHsKICAgICAgICB2YXIgZmlyc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1swXSA/IGFyZ3VtZW50c1swXSA6IDIwOwogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQ2LCB7CiAgICAgICAgICBmaXJzdDogZmlyc3QKICAgICAgICB9KS50aGVuKGRlZmF1bHRSZXNvbHZlcigiY29sbGVjdGlvbnMiKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZmV0Y2hBbGxXaXRoUHJvZHVjdHMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2hBbGxXaXRoUHJvZHVjdHMoKSB7CiAgICAgICAgdmFyIF9yZWYgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1swXSA/IGFyZ3VtZW50c1swXSA6IHt9LAogICAgICAgICAgICBfcmVmJGZpcnN0ID0gX3JlZi5maXJzdCwKICAgICAgICAgICAgZmlyc3QgPSB2b2lkIDAgPT09IF9yZWYkZmlyc3QgPyAyMCA6IF9yZWYkZmlyc3QsCiAgICAgICAgICAgIF9yZWYkcHJvZHVjdHNGaXJzdCA9IF9yZWYucHJvZHVjdHNGaXJzdCwKICAgICAgICAgICAgcHJvZHVjdHNGaXJzdCA9IHZvaWQgMCA9PT0gX3JlZiRwcm9kdWN0c0ZpcnN0ID8gMjAgOiBfcmVmJHByb2R1Y3RzRmlyc3Q7CgogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQ3LCB7CiAgICAgICAgICBmaXJzdDogZmlyc3QsCiAgICAgICAgICBwcm9kdWN0c0ZpcnN0OiBwcm9kdWN0c0ZpcnN0CiAgICAgICAgfSkudGhlbihkZWZhdWx0UmVzb2x2ZXIoImNvbGxlY3Rpb25zIikpLnRoZW4ocGFnaW5hdGVDb2xsZWN0aW9uc1Byb2R1Y3RDb25uZWN0aW9uc0FuZFJlc29sdmUodGhpcy5ncmFwaFFMQ2xpZW50KSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZmV0Y2giLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2goaWQpIHsKICAgICAgICByZXR1cm4gdGhpcy5ncmFwaFFMQ2xpZW50LnNlbmQocXVlcnkkNCwgewogICAgICAgICAgaWQ6IGlkCiAgICAgICAgfSkudGhlbihkZWZhdWx0UmVzb2x2ZXIoIm5vZGUiKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZmV0Y2hXaXRoUHJvZHVjdHMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2hXaXRoUHJvZHVjdHMoaWQpIHsKICAgICAgICB2YXIgX3JlZjIgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1sxXSA/IGFyZ3VtZW50c1sxXSA6IHt9LAogICAgICAgICAgICBfcmVmMiRwcm9kdWN0c0ZpcnN0ID0gX3JlZjIucHJvZHVjdHNGaXJzdCwKICAgICAgICAgICAgcHJvZHVjdHNGaXJzdCA9IHZvaWQgMCA9PT0gX3JlZjIkcHJvZHVjdHNGaXJzdCA/IDIwIDogX3JlZjIkcHJvZHVjdHNGaXJzdDsKCiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5zZW5kKHF1ZXJ5JDUsIHsKICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgIHByb2R1Y3RzRmlyc3Q6IHByb2R1Y3RzRmlyc3QKICAgICAgICB9KS50aGVuKGRlZmF1bHRSZXNvbHZlcigibm9kZSIpKS50aGVuKHBhZ2luYXRlQ29sbGVjdGlvbnNQcm9kdWN0Q29ubmVjdGlvbnNBbmRSZXNvbHZlKHRoaXMuZ3JhcGhRTENsaWVudCkpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZldGNoQnlIYW5kbGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2hCeUhhbmRsZShoYW5kbGUpIHsKICAgICAgICByZXR1cm4gdGhpcy5ncmFwaFFMQ2xpZW50LnNlbmQocXVlcnkkOCwgewogICAgICAgICAgaGFuZGxlOiBoYW5kbGUKICAgICAgICB9KS50aGVuKGRlZmF1bHRSZXNvbHZlcigiY29sbGVjdGlvbkJ5SGFuZGxlIikpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZldGNoUXVlcnkiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2hRdWVyeSgpIHsKICAgICAgICB2YXIgX3JlZjMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1swXSA/IGFyZ3VtZW50c1swXSA6IHt9LAogICAgICAgICAgICBfcmVmMyRmaXJzdCA9IF9yZWYzLmZpcnN0LAogICAgICAgICAgICBmaXJzdCA9IHZvaWQgMCA9PT0gX3JlZjMkZmlyc3QgPyAyMCA6IF9yZWYzJGZpcnN0LAogICAgICAgICAgICBfcmVmMyRzb3J0S2V5ID0gX3JlZjMuc29ydEtleSwKICAgICAgICAgICAgc29ydEtleSA9IHZvaWQgMCA9PT0gX3JlZjMkc29ydEtleSA/ICJJRCIgOiBfcmVmMyRzb3J0S2V5LAogICAgICAgICAgICBxdWVyeSA9IF9yZWYzLnF1ZXJ5LAogICAgICAgICAgICByZXZlcnNlID0gX3JlZjMucmV2ZXJzZTsKCiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5zZW5kKHF1ZXJ5JDYsIHsKICAgICAgICAgIGZpcnN0OiBmaXJzdCwKICAgICAgICAgIHNvcnRLZXk6IHNvcnRLZXksCiAgICAgICAgICBxdWVyeTogcXVlcnksCiAgICAgICAgICByZXZlcnNlOiByZXZlcnNlCiAgICAgICAgfSkudGhlbihkZWZhdWx0UmVzb2x2ZXIoImNvbGxlY3Rpb25zIikpOwogICAgICB9CiAgICB9XSksIENvbGxlY3Rpb25SZXNvdXJjZTsKICB9KFJlc291cmNlKTsKCiAgZnVuY3Rpb24gcXVlcnkkOShjbGllbnQpIHsKICAgIHZhciBkb2N1bWVudCA9IGNsaWVudC5kb2N1bWVudCgpOwogICAgcmV0dXJuIGRvY3VtZW50LmFkZFF1ZXJ5KGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJzaG9wIiwgZnVuY3Rpb24gKHNob3ApIHsKICAgICAgICBzaG9wLmFkZCgiY3VycmVuY3lDb2RlIiksIHNob3AuYWRkKCJwYXltZW50U2V0dGluZ3MiLCBmdW5jdGlvbiAocGF5bWVudFNldHRpbmdzKSB7CiAgICAgICAgICBwYXltZW50U2V0dGluZ3MuYWRkKCJlbmFibGVkUHJlc2VudG1lbnRDdXJyZW5jaWVzIik7CiAgICAgICAgfSksIHNob3AuYWRkKCJkZXNjcmlwdGlvbiIpLCBzaG9wLmFkZCgibW9uZXlGb3JtYXQiKSwgc2hvcC5hZGQoIm5hbWUiKSwgc2hvcC5hZGQoInByaW1hcnlEb21haW4iLCBmdW5jdGlvbiAocHJpbWFyeURvbWFpbikgewogICAgICAgICAgcHJpbWFyeURvbWFpbi5hZGQoImhvc3QiKSwgcHJpbWFyeURvbWFpbi5hZGQoInNzbEVuYWJsZWQiKSwgcHJpbWFyeURvbWFpbi5hZGQoInVybCIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudDsKICB9CgogIGZ1bmN0aW9uIHF1ZXJ5JDEwKGNsaWVudCkgewogICAgdmFyIGRvY3VtZW50ID0gY2xpZW50LmRvY3VtZW50KCksCiAgICAgICAgc3ByZWFkcyA9IHt9OwogICAgcmV0dXJuIHNwcmVhZHMuUG9saWN5RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiUG9saWN5RnJhZ21lbnQiLCAiU2hvcFBvbGljeSIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInVybCIpLCByb290LmFkZCgiYm9keSIpOwogICAgfSksIGRvY3VtZW50LmFkZFF1ZXJ5KGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJzaG9wIiwgZnVuY3Rpb24gKHNob3ApIHsKICAgICAgICBzaG9wLmFkZCgicHJpdmFjeVBvbGljeSIsIGZ1bmN0aW9uIChwcml2YWN5UG9saWN5KSB7CiAgICAgICAgICBwcml2YWN5UG9saWN5LmFkZEZyYWdtZW50KHNwcmVhZHMuUG9saWN5RnJhZ21lbnQpOwogICAgICAgIH0pLCBzaG9wLmFkZCgidGVybXNPZlNlcnZpY2UiLCBmdW5jdGlvbiAodGVybXNPZlNlcnZpY2UpIHsKICAgICAgICAgIHRlcm1zT2ZTZXJ2aWNlLmFkZEZyYWdtZW50KHNwcmVhZHMuUG9saWN5RnJhZ21lbnQpOwogICAgICAgIH0pLCBzaG9wLmFkZCgicmVmdW5kUG9saWN5IiwgZnVuY3Rpb24gKHJlZnVuZFBvbGljeSkgewogICAgICAgICAgcmVmdW5kUG9saWN5LmFkZEZyYWdtZW50KHNwcmVhZHMuUG9saWN5RnJhZ21lbnQpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudDsKICB9CgogIHZhciBTaG9wUmVzb3VyY2UgPSBmdW5jdGlvbiAoX1Jlc291cmNlKSB7CiAgICBmdW5jdGlvbiBTaG9wUmVzb3VyY2UoKSB7CiAgICAgIHJldHVybiBjbGFzc0NhbGxDaGVjayQxKHRoaXMsIFNob3BSZXNvdXJjZSksIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4kMSh0aGlzLCAoU2hvcFJlc291cmNlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU2hvcFJlc291cmNlKSkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgICB9CgogICAgcmV0dXJuIGluaGVyaXRzJDEoU2hvcFJlc291cmNlLCBfUmVzb3VyY2UpLCBjcmVhdGVDbGFzcyQxKFNob3BSZXNvdXJjZSwgW3sKICAgICAga2V5OiAiZmV0Y2hJbmZvIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZldGNoSW5mbygpIHsKICAgICAgICByZXR1cm4gdGhpcy5ncmFwaFFMQ2xpZW50LnNlbmQocXVlcnkkOSkudGhlbihkZWZhdWx0UmVzb2x2ZXIoInNob3AiKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZmV0Y2hQb2xpY2llcyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBmZXRjaFBvbGljaWVzKCkgewogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQxMCkudGhlbihkZWZhdWx0UmVzb2x2ZXIoInNob3AiKSk7CiAgICAgIH0KICAgIH1dKSwgU2hvcFJlc291cmNlOwogIH0oUmVzb3VyY2UpOwoKICBmdW5jdGlvbiBoYW5kbGVDaGVja291dE11dGF0aW9uKG11dGF0aW9uUm9vdEtleSwgY2xpZW50KSB7CiAgICByZXR1cm4gZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgdmFyIF9yZWYkZGF0YSA9IF9yZWYuZGF0YSwKICAgICAgICAgIGRhdGEgPSB2b2lkIDAgPT09IF9yZWYkZGF0YSA/IHt9IDogX3JlZiRkYXRhLAogICAgICAgICAgZXJyb3JzID0gX3JlZi5lcnJvcnMsCiAgICAgICAgICBfcmVmJG1vZGVsID0gX3JlZi5tb2RlbCwKICAgICAgICAgIG1vZGVsID0gdm9pZCAwID09PSBfcmVmJG1vZGVsID8ge30gOiBfcmVmJG1vZGVsLAogICAgICAgICAgcm9vdERhdGEgPSBkYXRhW211dGF0aW9uUm9vdEtleV0sCiAgICAgICAgICByb290TW9kZWwgPSBtb2RlbFttdXRhdGlvblJvb3RLZXldOwogICAgICByZXR1cm4gcm9vdERhdGEgJiYgcm9vdERhdGEuY2hlY2tvdXQgPyBjbGllbnQuZmV0Y2hBbGxQYWdlcyhyb290TW9kZWwuY2hlY2tvdXQubGluZUl0ZW1zLCB7CiAgICAgICAgcGFnZVNpemU6IDI1MAogICAgICB9KS50aGVuKGZ1bmN0aW9uIChsaW5lSXRlbXMpIHsKICAgICAgICByZXR1cm4gcm9vdE1vZGVsLmNoZWNrb3V0LmF0dHJzLmxpbmVJdGVtcyA9IGxpbmVJdGVtcywgcm9vdE1vZGVsLmNoZWNrb3V0LmVycm9ycyA9IGVycm9ycywgcm9vdE1vZGVsLmNoZWNrb3V0LnVzZXJFcnJvcnMgPSByb290TW9kZWwudXNlckVycm9ycywgcm9vdE1vZGVsLmNoZWNrb3V0OwogICAgICB9KSA6IGVycm9ycyAmJiBlcnJvcnMubGVuZ3RoID8gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KGVycm9ycykpKSA6IHJvb3REYXRhICYmIHJvb3REYXRhLmNoZWNrb3V0VXNlckVycm9ycyAmJiByb290RGF0YS5jaGVja291dFVzZXJFcnJvcnMubGVuZ3RoID8gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KHJvb3REYXRhLmNoZWNrb3V0VXNlckVycm9ycykpKSA6IHJvb3REYXRhICYmIHJvb3REYXRhLnVzZXJFcnJvcnMgJiYgcm9vdERhdGEudXNlckVycm9ycy5sZW5ndGggPyBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkocm9vdERhdGEudXNlckVycm9ycykpKSA6IFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiVGhlICIgKyBtdXRhdGlvblJvb3RLZXkgKyAiIG11dGF0aW9uIGZhaWxlZCBkdWUgdG8gYW4gdW5rbm93biBlcnJvci4iKSk7CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkMTEoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBfX2RlZmF1bHRPcGVyYXRpb25fXzoge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmlkID0gY2xpZW50LnZhcmlhYmxlKCJpZCIsICJJRCEiKSwgc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJ0aXRsZSIpLCByb290LmFkZCgicHJpY2UiKSwgcm9vdC5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50UHJpY2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByZXNlbnRtZW50UHJpY2VzKSB7CiAgICAgICAgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBwcmVzZW50bWVudFByaWNlcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgicHJpY2UiLCBmdW5jdGlvbiAocHJpY2UpIHsKICAgICAgICAgICAgICBwcmljZS5hZGQoImFtb3VudCIpLCBwcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImNvbXBhcmVBdFByaWNlIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlKSB7CiAgICAgICAgICAgICAgY29tcGFyZUF0UHJpY2UuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWlnaHQiKSwgcm9vdC5hZGQoImF2YWlsYWJsZUZvclNhbGUiLCB7CiAgICAgICAgYWxpYXM6ICJhdmFpbGFibGUiCiAgICAgIH0pLCByb290LmFkZCgic2t1IiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2VWMiIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZVYyKSB7CiAgICAgICAgY29tcGFyZUF0UHJpY2VWMi5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2UiLCBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgICAgICBpbWFnZS5hZGQoImlkIiksIGltYWdlLmFkZCgib3JpZ2luYWxTcmMiLCB7CiAgICAgICAgICBhbGlhczogInNyYyIKICAgICAgICB9KSwgaW1hZ2UuYWRkKCJhbHRUZXh0Iik7CiAgICAgIH0pLCByb290LmFkZCgic2VsZWN0ZWRPcHRpb25zIiwgZnVuY3Rpb24gKHNlbGVjdGVkT3B0aW9ucykgewogICAgICAgIHNlbGVjdGVkT3B0aW9ucy5hZGQoIm5hbWUiKSwgc2VsZWN0ZWRPcHRpb25zLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2UiLCBmdW5jdGlvbiAodW5pdFByaWNlKSB7CiAgICAgICAgdW5pdFByaWNlLmFkZCgiYW1vdW50IiksIHVuaXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZU1lYXN1cmVtZW50IiwgZnVuY3Rpb24gKHVuaXRQcmljZU1lYXN1cmVtZW50KSB7CiAgICAgICAgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJtZWFzdXJlZFR5cGUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVZhbHVlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVZhbHVlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCIsICJEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoInRhcmdldFNlbGVjdGlvbiIpLCByb290LmFkZCgiYWxsb2NhdGlvbk1ldGhvZCIpLCByb290LmFkZCgidGFyZ2V0VHlwZSIpLCByb290LmFkZCgidmFsdWUiLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICB2YWx1ZS5hZGRJbmxpbmVGcmFnbWVudE9uKCJNb25leVYyIiwgZnVuY3Rpb24gKE1vbmV5VjIpIHsKICAgICAgICAgIE1vbmV5VjIuYWRkKCJhbW91bnQiKSwgTW9uZXlWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCB2YWx1ZS5hZGRJbmxpbmVGcmFnbWVudE9uKCJQcmljaW5nUGVyY2VudGFnZVZhbHVlIiwgZnVuY3Rpb24gKFByaWNpbmdQZXJjZW50YWdlVmFsdWUpIHsKICAgICAgICAgIFByaWNpbmdQZXJjZW50YWdlVmFsdWUuYWRkKCJwZXJjZW50YWdlIik7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIk1hbnVhbERpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJ0aXRsZSIpLCBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiRGlzY291bnRDb2RlQXBwbGljYXRpb24iLCBmdW5jdGlvbiAoRGlzY291bnRDb2RlQXBwbGljYXRpb24pIHsKICAgICAgICBEaXNjb3VudENvZGVBcHBsaWNhdGlvbi5hZGQoImNvZGUiKSwgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJhcHBsaWNhYmxlIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIlNjcmlwdERpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJkZXNjcmlwdGlvbiIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKEF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5BcHBsaWVkR2lmdENhcmRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJBcHBsaWVkR2lmdENhcmRGcmFnbWVudCIsICJBcHBsaWVkR2lmdENhcmQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiYW1vdW50VXNlZFYyIiwgZnVuY3Rpb24gKGFtb3VudFVzZWRWMikgewogICAgICAgIGFtb3VudFVzZWRWMi5hZGQoImFtb3VudCIpLCBhbW91bnRVc2VkVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJiYWxhbmNlVjIiLCBmdW5jdGlvbiAoYmFsYW5jZVYyKSB7CiAgICAgICAgYmFsYW5jZVYyLmFkZCgiYW1vdW50IiksIGJhbGFuY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50QW1vdW50VXNlZCIsIGZ1bmN0aW9uIChwcmVzZW50bWVudEFtb3VudFVzZWQpIHsKICAgICAgICBwcmVzZW50bWVudEFtb3VudFVzZWQuYWRkKCJhbW91bnQiKSwgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImxhc3RDaGFyYWN0ZXJzIik7CiAgICB9KSwgc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJWYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQpLCByb290LmFkZCgicHJvZHVjdCIsIGZ1bmN0aW9uIChwcm9kdWN0KSB7CiAgICAgICAgcHJvZHVjdC5hZGQoImlkIiksIHByb2R1Y3QuYWRkKCJoYW5kbGUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIk1haWxpbmdBZGRyZXNzRnJhZ21lbnQiLCAiTWFpbGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImFkZHJlc3MxIiksIHJvb3QuYWRkKCJhZGRyZXNzMiIpLCByb290LmFkZCgiY2l0eSIpLCByb290LmFkZCgiY29tcGFueSIpLCByb290LmFkZCgiY291bnRyeSIpLCByb290LmFkZCgiZmlyc3ROYW1lIiksIHJvb3QuYWRkKCJmb3JtYXR0ZWQiKSwgcm9vdC5hZGQoImxhc3ROYW1lIiksIHJvb3QuYWRkKCJsYXRpdHVkZSIpLCByb290LmFkZCgibG9uZ2l0dWRlIiksIHJvb3QuYWRkKCJwaG9uZSIpLCByb290LmFkZCgicHJvdmluY2UiKSwgcm9vdC5hZGQoInppcCIpLCByb290LmFkZCgibmFtZSIpLCByb290LmFkZCgiY291bnRyeUNvZGVWMiIsIHsKICAgICAgICBhbGlhczogImNvdW50cnlDb2RlIgogICAgICB9KSwgcm9vdC5hZGQoInByb3ZpbmNlQ29kZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dEZyYWdtZW50IiwgIkNoZWNrb3V0IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJyZWFkeSIpLCByb290LmFkZCgicmVxdWlyZXNTaGlwcGluZyIpLCByb290LmFkZCgibm90ZSIpLCByb290LmFkZCgicGF5bWVudER1ZSIpLCByb290LmFkZCgicGF5bWVudER1ZVYyIiwgZnVuY3Rpb24gKHBheW1lbnREdWVWMikgewogICAgICAgIHBheW1lbnREdWVWMi5hZGQoImFtb3VudCIpLCBwYXltZW50RHVlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWJVcmwiKSwgcm9vdC5hZGQoIm9yZGVyU3RhdHVzVXJsIiksIHJvb3QuYWRkKCJ0YXhFeGVtcHQiKSwgcm9vdC5hZGQoInRheGVzSW5jbHVkZWQiKSwgcm9vdC5hZGQoImN1cnJlbmN5Q29kZSIpLCByb290LmFkZCgidG90YWxUYXgiKSwgcm9vdC5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgIHRvdGFsVGF4VjIuYWRkKCJhbW91bnQiKSwgdG90YWxUYXhWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtc1N1YnRvdGFsUHJpY2UiLCBmdW5jdGlvbiAobGluZUl0ZW1zU3VidG90YWxQcmljZSkgewogICAgICAgIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYWRkKCJhbW91bnQiKSwgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2UiKSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICBzdWJ0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgc3VidG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidG90YWxQcmljZSIpLCByb290LmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjb21wbGV0ZWRBdCIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImVtYWlsIiksIHJvb3QuYWRkKCJkaXNjb3VudEFwcGxpY2F0aW9ucyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9ucykgewogICAgICAgIGRpc2NvdW50QXBwbGljYXRpb25zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJhcHBsaWVkR2lmdENhcmRzIiwgZnVuY3Rpb24gKGFwcGxpZWRHaWZ0Q2FyZHMpIHsKICAgICAgICBhcHBsaWVkR2lmdENhcmRzLmFkZEZyYWdtZW50KHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChzaGlwcGluZ0FkZHJlc3MpIHsKICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgfSksIHJvb3QuYWRkKCJzaGlwcGluZ0xpbmUiLCBmdW5jdGlvbiAoc2hpcHBpbmdMaW5lKSB7CiAgICAgICAgc2hpcHBpbmdMaW5lLmFkZCgiaGFuZGxlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHNoaXBwaW5nTGluZS5hZGQoInRpdGxlIik7CiAgICAgIH0pLCByb290LmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJvcmRlciIsIGZ1bmN0aW9uIChvcmRlcikgewogICAgICAgIG9yZGVyLmFkZCgiaWQiKSwgb3JkZXIuYWRkKCJwcm9jZXNzZWRBdCIpLCBvcmRlci5hZGQoIm9yZGVyTnVtYmVyIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2UiKSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFNoaXBwaW5nUHJpY2VWMikgewogICAgICAgICAgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFRheCIpLCBvcmRlci5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJjdXJyZW5jeUNvZGUiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkIiksIG9yZGVyLmFkZCgidG90YWxSZWZ1bmRlZFYyIiwgZnVuY3Rpb24gKHRvdGFsUmVmdW5kZWRWMikgewogICAgICAgICAgdG90YWxSZWZ1bmRlZFYyLmFkZCgiYW1vdW50IiksIHRvdGFsUmVmdW5kZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1c3RvbWVyVXJsIiksIG9yZGVyLmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgICAgc2hpcHBpbmdBZGRyZXNzLmFkZEZyYWdtZW50KHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCk7CiAgICAgICAgfSksIG9yZGVyLmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgICAgYXJnczogewogICAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgICB9CiAgICAgICAgfSwgZnVuY3Rpb24gKGxpbmVJdGVtcykgewogICAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgICAgfSksIGxpbmVJdGVtcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgICAgbm9kZS5hZGQoInRpdGxlIiksIG5vZGUuYWRkKCJ2YXJpYW50IiwgZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgicXVhbnRpdHkiKSwgbm9kZS5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiZGlzY291bnRBbGxvY2F0aW9ucyIsIGZ1bmN0aW9uIChkaXNjb3VudEFsbG9jYXRpb25zKSB7CiAgICAgICAgICAgICAgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImFsbG9jYXRlZEFtb3VudCIsIGZ1bmN0aW9uIChhbGxvY2F0ZWRBbW91bnQpIHsKICAgICAgICAgICAgICAgIGFsbG9jYXRlZEFtb3VudC5hZGQoImFtb3VudCIpLCBhbGxvY2F0ZWRBbW91bnQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgICB9KSwgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoZGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgICAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbi5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZFF1ZXJ5KFt2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uaWRdLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgibm9kZSIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBpZDogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmlkCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgIG5vZGUuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dEZyYWdtZW50KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBxdWVyeSQxMihjbGllbnQpIHsKICAgIHZhciBkb2N1bWVudCA9IGNsaWVudC5kb2N1bWVudCgpLAogICAgICAgIHNwcmVhZHMgPSB7fSwKICAgICAgICB2YXJpYWJsZXMgPSB7CiAgICAgIF9fZGVmYXVsdE9wZXJhdGlvbl9fOiB7fQogICAgfTsKICAgIHJldHVybiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uaW5wdXQgPSBjbGllbnQudmFyaWFibGUoImlucHV0IiwgIkNoZWNrb3V0Q3JlYXRlSW5wdXQhIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJEaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQiLCAiRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJ0YXJnZXRTZWxlY3Rpb24iKSwgcm9vdC5hZGQoImFsbG9jYXRpb25NZXRob2QiKSwgcm9vdC5hZGQoInRhcmdldFR5cGUiKSwgcm9vdC5hZGQoInZhbHVlIiwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiTW9uZXlWMiIsIGZ1bmN0aW9uIChNb25leVYyKSB7CiAgICAgICAgICBNb25leVYyLmFkZCgiYW1vdW50IiksIE1vbmV5VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSIsIGZ1bmN0aW9uIChQcmljaW5nUGVyY2VudGFnZVZhbHVlKSB7CiAgICAgICAgICBQcmljaW5nUGVyY2VudGFnZVZhbHVlLmFkZCgicGVyY2VudGFnZSIpOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKSwgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkRpc2NvdW50Q29kZUFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKERpc2NvdW50Q29kZUFwcGxpY2F0aW9uKSB7CiAgICAgICAgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJjb2RlIiksIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiYXBwbGljYWJsZSIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQiLCAiQXBwbGllZEdpZnRDYXJkIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImFtb3VudFVzZWRWMiIsIGZ1bmN0aW9uIChhbW91bnRVc2VkVjIpIHsKICAgICAgICBhbW91bnRVc2VkVjIuYWRkKCJhbW91bnQiKSwgYW1vdW50VXNlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiYmFsYW5jZVYyIiwgZnVuY3Rpb24gKGJhbGFuY2VWMikgewogICAgICAgIGJhbGFuY2VWMi5hZGQoImFtb3VudCIpLCBiYWxhbmNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudEFtb3VudFVzZWQiLCBmdW5jdGlvbiAocHJlc2VudG1lbnRBbW91bnRVc2VkKSB7CiAgICAgICAgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiYW1vdW50IiksIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJsYXN0Q2hhcmFjdGVycyIpOwogICAgfSksIHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudEZyYWdtZW50KSwgcm9vdC5hZGQoInByb2R1Y3QiLCBmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgIHByb2R1Y3QuYWRkKCJpZCIpLCBwcm9kdWN0LmFkZCgiaGFuZGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuVXNlckVycm9yRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVXNlckVycm9yRnJhZ21lbnQiLCAiVXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQiLCAiQ2hlY2tvdXRVc2VyRXJyb3IiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiZmllbGQiKSwgcm9vdC5hZGQoIm1lc3NhZ2UiKSwgcm9vdC5hZGQoImNvZGUiKTsKICAgIH0pLCBzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiTWFpbGluZ0FkZHJlc3NGcmFnbWVudCIsICJNYWlsaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYWRkcmVzczEiKSwgcm9vdC5hZGQoImFkZHJlc3MyIiksIHJvb3QuYWRkKCJjaXR5IiksIHJvb3QuYWRkKCJjb21wYW55IiksIHJvb3QuYWRkKCJjb3VudHJ5IiksIHJvb3QuYWRkKCJmaXJzdE5hbWUiKSwgcm9vdC5hZGQoImZvcm1hdHRlZCIpLCByb290LmFkZCgibGFzdE5hbWUiKSwgcm9vdC5hZGQoImxhdGl0dWRlIiksIHJvb3QuYWRkKCJsb25naXR1ZGUiKSwgcm9vdC5hZGQoInBob25lIiksIHJvb3QuYWRkKCJwcm92aW5jZSIpLCByb290LmFkZCgiemlwIiksIHJvb3QuYWRkKCJuYW1lIiksIHJvb3QuYWRkKCJjb3VudHJ5Q29kZVYyIiwgewogICAgICAgIGFsaWFzOiAiY291bnRyeUNvZGUiCiAgICAgIH0pLCByb290LmFkZCgicHJvdmluY2VDb2RlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0RnJhZ21lbnQiLCAiQ2hlY2tvdXQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInJlYWR5IiksIHJvb3QuYWRkKCJyZXF1aXJlc1NoaXBwaW5nIiksIHJvb3QuYWRkKCJub3RlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlVjIiLCBmdW5jdGlvbiAocGF5bWVudER1ZVYyKSB7CiAgICAgICAgcGF5bWVudER1ZVYyLmFkZCgiYW1vdW50IiksIHBheW1lbnREdWVWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIndlYlVybCIpLCByb290LmFkZCgib3JkZXJTdGF0dXNVcmwiKSwgcm9vdC5hZGQoInRheEV4ZW1wdCIpLCByb290LmFkZCgidGF4ZXNJbmNsdWRlZCIpLCByb290LmFkZCgiY3VycmVuY3lDb2RlIiksIHJvb3QuYWRkKCJ0b3RhbFRheCIpLCByb290LmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zU3VidG90YWxQcmljZSIsIGZ1bmN0aW9uIChsaW5lSXRlbXNTdWJ0b3RhbFByaWNlKSB7CiAgICAgICAgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImFtb3VudCIpLCBsaW5lSXRlbXNTdWJ0b3RhbFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgic3VidG90YWxQcmljZSIpLCByb290LmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ0b3RhbFByaWNlIiksIHJvb3QuYWRkKCJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxQcmljZVYyKSB7CiAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImNvbXBsZXRlZEF0IiksIHJvb3QuYWRkKCJjcmVhdGVkQXQiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgiZW1haWwiKSwgcm9vdC5hZGQoImRpc2NvdW50QXBwbGljYXRpb25zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAxMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGRpc2NvdW50QXBwbGljYXRpb25zKSB7CiAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBkaXNjb3VudEFwcGxpY2F0aW9ucy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImFwcGxpZWRHaWZ0Q2FyZHMiLCBmdW5jdGlvbiAoYXBwbGllZEdpZnRDYXJkcykgewogICAgICAgIGFwcGxpZWRHaWZ0Q2FyZHMuYWRkRnJhZ21lbnQoc3ByZWFkcy5BcHBsaWVkR2lmdENhcmRGcmFnbWVudCk7CiAgICAgIH0pLCByb290LmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgIHNoaXBwaW5nQWRkcmVzcy5hZGRGcmFnbWVudChzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nTGluZSIsIGZ1bmN0aW9uIChzaGlwcGluZ0xpbmUpIHsKICAgICAgICBzaGlwcGluZ0xpbmUuYWRkKCJoYW5kbGUiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2UiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgc2hpcHBpbmdMaW5lLmFkZCgidGl0bGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIm9yZGVyIiwgZnVuY3Rpb24gKG9yZGVyKSB7CiAgICAgICAgb3JkZXIuYWRkKCJpZCIpLCBvcmRlci5hZGQoInByb2Nlc3NlZEF0IiksIG9yZGVyLmFkZCgib3JkZXJOdW1iZXIiKSwgb3JkZXIuYWRkKCJzdWJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgICAgc3VidG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHN1YnRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsU2hpcHBpbmdQcmljZVYyKSB7CiAgICAgICAgICB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsVGF4IiksIG9yZGVyLmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgICB0b3RhbFRheFYyLmFkZCgiYW1vdW50IiksIHRvdGFsVGF4VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1cnJlbmN5Q29kZSIpLCBvcmRlci5hZGQoInRvdGFsUmVmdW5kZWQiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkVjIiLCBmdW5jdGlvbiAodG90YWxSZWZ1bmRlZFYyKSB7CiAgICAgICAgICB0b3RhbFJlZnVuZGVkVjIuYWRkKCJhbW91bnQiKSwgdG90YWxSZWZ1bmRlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgiY3VzdG9tZXJVcmwiKSwgb3JkZXIuYWRkKCJzaGlwcGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAoc2hpcHBpbmdBZGRyZXNzKSB7CiAgICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJsaW5lSXRlbXMiLCB7CiAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICAgIH0KICAgICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgICB9KSwgbm9kZS5hZGQoInF1YW50aXR5IiksIG5vZGUuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChsaW5lSXRlbXMpIHsKICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBsaW5lSXRlbXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoImlkIiksIG5vZGUuYWRkKCJ0aXRsZSIpLCBub2RlLmFkZCgidmFyaWFudCIsIGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJkaXNjb3VudEFsbG9jYXRpb25zIiwgZnVuY3Rpb24gKGRpc2NvdW50QWxsb2NhdGlvbnMpIHsKICAgICAgICAgICAgICBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiYWxsb2NhdGVkQW1vdW50IiwgZnVuY3Rpb24gKGFsbG9jYXRlZEFtb3VudCkgewogICAgICAgICAgICAgICAgYWxsb2NhdGVkQW1vdW50LmFkZCgiYW1vdW50IiksIGFsbG9jYXRlZEFtb3VudC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICAgIH0pLCBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiZGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgICAgICAgICBkaXNjb3VudEFwcGxpY2F0aW9uLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQuYWRkTXV0YXRpb24oW3ZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5pbnB1dF0sIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJjaGVja291dENyZWF0ZSIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBpbnB1dDogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmlucHV0CiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoY2hlY2tvdXRDcmVhdGUpIHsKICAgICAgICBjaGVja291dENyZWF0ZS5hZGQoInVzZXJFcnJvcnMiLCBmdW5jdGlvbiAodXNlckVycm9ycykgewogICAgICAgICAgdXNlckVycm9ycy5hZGRGcmFnbWVudChzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXRDcmVhdGUuYWRkKCJjaGVja291dFVzZXJFcnJvcnMiLCBmdW5jdGlvbiAoY2hlY2tvdXRVc2VyRXJyb3JzKSB7CiAgICAgICAgICBjaGVja291dFVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXRDcmVhdGUuYWRkKCJjaGVja291dCIsIGZ1bmN0aW9uIChjaGVja291dCkgewogICAgICAgICAgY2hlY2tvdXQuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dEZyYWdtZW50KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBxdWVyeSQxMyhjbGllbnQpIHsKICAgIHZhciBkb2N1bWVudCA9IGNsaWVudC5kb2N1bWVudCgpLAogICAgICAgIHNwcmVhZHMgPSB7fSwKICAgICAgICB2YXJpYWJsZXMgPSB7CiAgICAgIF9fZGVmYXVsdE9wZXJhdGlvbl9fOiB7fQogICAgfTsKICAgIHJldHVybiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uY2hlY2tvdXRJZCA9IGNsaWVudC52YXJpYWJsZSgiY2hlY2tvdXRJZCIsICJJRCEiKSwgdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmxpbmVJdGVtcyA9IGNsaWVudC52YXJpYWJsZSgibGluZUl0ZW1zIiwgIltDaGVja291dExpbmVJdGVtSW5wdXQhXSEiKSwgc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJ0aXRsZSIpLCByb290LmFkZCgicHJpY2UiKSwgcm9vdC5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50UHJpY2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByZXNlbnRtZW50UHJpY2VzKSB7CiAgICAgICAgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBwcmVzZW50bWVudFByaWNlcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgicHJpY2UiLCBmdW5jdGlvbiAocHJpY2UpIHsKICAgICAgICAgICAgICBwcmljZS5hZGQoImFtb3VudCIpLCBwcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImNvbXBhcmVBdFByaWNlIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlKSB7CiAgICAgICAgICAgICAgY29tcGFyZUF0UHJpY2UuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWlnaHQiKSwgcm9vdC5hZGQoImF2YWlsYWJsZUZvclNhbGUiLCB7CiAgICAgICAgYWxpYXM6ICJhdmFpbGFibGUiCiAgICAgIH0pLCByb290LmFkZCgic2t1IiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2VWMiIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZVYyKSB7CiAgICAgICAgY29tcGFyZUF0UHJpY2VWMi5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2UiLCBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgICAgICBpbWFnZS5hZGQoImlkIiksIGltYWdlLmFkZCgib3JpZ2luYWxTcmMiLCB7CiAgICAgICAgICBhbGlhczogInNyYyIKICAgICAgICB9KSwgaW1hZ2UuYWRkKCJhbHRUZXh0Iik7CiAgICAgIH0pLCByb290LmFkZCgic2VsZWN0ZWRPcHRpb25zIiwgZnVuY3Rpb24gKHNlbGVjdGVkT3B0aW9ucykgewogICAgICAgIHNlbGVjdGVkT3B0aW9ucy5hZGQoIm5hbWUiKSwgc2VsZWN0ZWRPcHRpb25zLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2UiLCBmdW5jdGlvbiAodW5pdFByaWNlKSB7CiAgICAgICAgdW5pdFByaWNlLmFkZCgiYW1vdW50IiksIHVuaXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZU1lYXN1cmVtZW50IiwgZnVuY3Rpb24gKHVuaXRQcmljZU1lYXN1cmVtZW50KSB7CiAgICAgICAgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJtZWFzdXJlZFR5cGUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVZhbHVlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVZhbHVlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCIsICJEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoInRhcmdldFNlbGVjdGlvbiIpLCByb290LmFkZCgiYWxsb2NhdGlvbk1ldGhvZCIpLCByb290LmFkZCgidGFyZ2V0VHlwZSIpLCByb290LmFkZCgidmFsdWUiLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICB2YWx1ZS5hZGRJbmxpbmVGcmFnbWVudE9uKCJNb25leVYyIiwgZnVuY3Rpb24gKE1vbmV5VjIpIHsKICAgICAgICAgIE1vbmV5VjIuYWRkKCJhbW91bnQiKSwgTW9uZXlWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCB2YWx1ZS5hZGRJbmxpbmVGcmFnbWVudE9uKCJQcmljaW5nUGVyY2VudGFnZVZhbHVlIiwgZnVuY3Rpb24gKFByaWNpbmdQZXJjZW50YWdlVmFsdWUpIHsKICAgICAgICAgIFByaWNpbmdQZXJjZW50YWdlVmFsdWUuYWRkKCJwZXJjZW50YWdlIik7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIk1hbnVhbERpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJ0aXRsZSIpLCBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiRGlzY291bnRDb2RlQXBwbGljYXRpb24iLCBmdW5jdGlvbiAoRGlzY291bnRDb2RlQXBwbGljYXRpb24pIHsKICAgICAgICBEaXNjb3VudENvZGVBcHBsaWNhdGlvbi5hZGQoImNvZGUiKSwgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJhcHBsaWNhYmxlIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIlNjcmlwdERpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJkZXNjcmlwdGlvbiIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKEF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5BcHBsaWVkR2lmdENhcmRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJBcHBsaWVkR2lmdENhcmRGcmFnbWVudCIsICJBcHBsaWVkR2lmdENhcmQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiYW1vdW50VXNlZFYyIiwgZnVuY3Rpb24gKGFtb3VudFVzZWRWMikgewogICAgICAgIGFtb3VudFVzZWRWMi5hZGQoImFtb3VudCIpLCBhbW91bnRVc2VkVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJiYWxhbmNlVjIiLCBmdW5jdGlvbiAoYmFsYW5jZVYyKSB7CiAgICAgICAgYmFsYW5jZVYyLmFkZCgiYW1vdW50IiksIGJhbGFuY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50QW1vdW50VXNlZCIsIGZ1bmN0aW9uIChwcmVzZW50bWVudEFtb3VudFVzZWQpIHsKICAgICAgICBwcmVzZW50bWVudEFtb3VudFVzZWQuYWRkKCJhbW91bnQiKSwgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImxhc3RDaGFyYWN0ZXJzIik7CiAgICB9KSwgc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJWYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQpLCByb290LmFkZCgicHJvZHVjdCIsIGZ1bmN0aW9uIChwcm9kdWN0KSB7CiAgICAgICAgcHJvZHVjdC5hZGQoImlkIiksIHByb2R1Y3QuYWRkKCJoYW5kbGUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5Vc2VyRXJyb3JGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJVc2VyRXJyb3JGcmFnbWVudCIsICJVc2VyRXJyb3IiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiZmllbGQiKSwgcm9vdC5hZGQoIm1lc3NhZ2UiKTsKICAgIH0pLCBzcHJlYWRzLkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCIsICJDaGVja291dFVzZXJFcnJvciIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJmaWVsZCIpLCByb290LmFkZCgibWVzc2FnZSIpLCByb290LmFkZCgiY29kZSIpOwogICAgfSksIHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJNYWlsaW5nQWRkcmVzc0ZyYWdtZW50IiwgIk1haWxpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJhZGRyZXNzMSIpLCByb290LmFkZCgiYWRkcmVzczIiKSwgcm9vdC5hZGQoImNpdHkiKSwgcm9vdC5hZGQoImNvbXBhbnkiKSwgcm9vdC5hZGQoImNvdW50cnkiKSwgcm9vdC5hZGQoImZpcnN0TmFtZSIpLCByb290LmFkZCgiZm9ybWF0dGVkIiksIHJvb3QuYWRkKCJsYXN0TmFtZSIpLCByb290LmFkZCgibGF0aXR1ZGUiKSwgcm9vdC5hZGQoImxvbmdpdHVkZSIpLCByb290LmFkZCgicGhvbmUiKSwgcm9vdC5hZGQoInByb3ZpbmNlIiksIHJvb3QuYWRkKCJ6aXAiKSwgcm9vdC5hZGQoIm5hbWUiKSwgcm9vdC5hZGQoImNvdW50cnlDb2RlVjIiLCB7CiAgICAgICAgYWxpYXM6ICJjb3VudHJ5Q29kZSIKICAgICAgfSksIHJvb3QuYWRkKCJwcm92aW5jZUNvZGUiKTsKICAgIH0pLCBzcHJlYWRzLkNoZWNrb3V0RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQ2hlY2tvdXRGcmFnbWVudCIsICJDaGVja291dCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgicmVhZHkiKSwgcm9vdC5hZGQoInJlcXVpcmVzU2hpcHBpbmciKSwgcm9vdC5hZGQoIm5vdGUiKSwgcm9vdC5hZGQoInBheW1lbnREdWUiKSwgcm9vdC5hZGQoInBheW1lbnREdWVWMiIsIGZ1bmN0aW9uIChwYXltZW50RHVlVjIpIHsKICAgICAgICBwYXltZW50RHVlVjIuYWRkKCJhbW91bnQiKSwgcGF5bWVudER1ZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgid2ViVXJsIiksIHJvb3QuYWRkKCJvcmRlclN0YXR1c1VybCIpLCByb290LmFkZCgidGF4RXhlbXB0IiksIHJvb3QuYWRkKCJ0YXhlc0luY2x1ZGVkIiksIHJvb3QuYWRkKCJjdXJyZW5jeUNvZGUiKSwgcm9vdC5hZGQoInRvdGFsVGF4IiksIHJvb3QuYWRkKCJ0b3RhbFRheFYyIiwgZnVuY3Rpb24gKHRvdGFsVGF4VjIpIHsKICAgICAgICB0b3RhbFRheFYyLmFkZCgiYW1vdW50IiksIHRvdGFsVGF4VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJsaW5lSXRlbXNTdWJ0b3RhbFByaWNlIiwgZnVuY3Rpb24gKGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UpIHsKICAgICAgICBsaW5lSXRlbXNTdWJ0b3RhbFByaWNlLmFkZCgiYW1vdW50IiksIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJzdWJ0b3RhbFByaWNlIiksIHJvb3QuYWRkKCJzdWJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAoc3VidG90YWxQcmljZVYyKSB7CiAgICAgICAgc3VidG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHN1YnRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInRvdGFsUHJpY2UiKSwgcm9vdC5hZGQoInRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFByaWNlVjIpIHsKICAgICAgICB0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiY29tcGxldGVkQXQiKSwgcm9vdC5hZGQoImNyZWF0ZWRBdCIpLCByb290LmFkZCgidXBkYXRlZEF0IiksIHJvb3QuYWRkKCJlbWFpbCIpLCByb290LmFkZCgiZGlzY291bnRBcHBsaWNhdGlvbnMiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZmlyc3Q6IDEwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoZGlzY291bnRBcHBsaWNhdGlvbnMpIHsKICAgICAgICBkaXNjb3VudEFwcGxpY2F0aW9ucy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIGRpc2NvdW50QXBwbGljYXRpb25zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkRnJhZ21lbnQoc3ByZWFkcy5EaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgiYXBwbGllZEdpZnRDYXJkcyIsIGZ1bmN0aW9uIChhcHBsaWVkR2lmdENhcmRzKSB7CiAgICAgICAgYXBwbGllZEdpZnRDYXJkcy5hZGRGcmFnbWVudChzcHJlYWRzLkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50KTsKICAgICAgfSksIHJvb3QuYWRkKCJzaGlwcGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAoc2hpcHBpbmdBZGRyZXNzKSB7CiAgICAgICAgc2hpcHBpbmdBZGRyZXNzLmFkZEZyYWdtZW50KHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCk7CiAgICAgIH0pLCByb290LmFkZCgic2hpcHBpbmdMaW5lIiwgZnVuY3Rpb24gKHNoaXBwaW5nTGluZSkgewogICAgICAgIHNoaXBwaW5nTGluZS5hZGQoImhhbmRsZSIpLCBzaGlwcGluZ0xpbmUuYWRkKCJwcmljZSIpLCBzaGlwcGluZ0xpbmUuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBzaGlwcGluZ0xpbmUuYWRkKCJ0aXRsZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgib3JkZXIiLCBmdW5jdGlvbiAob3JkZXIpIHsKICAgICAgICBvcmRlci5hZGQoImlkIiksIG9yZGVyLmFkZCgicHJvY2Vzc2VkQXQiKSwgb3JkZXIuYWRkKCJvcmRlck51bWJlciIpLCBvcmRlci5hZGQoInN1YnRvdGFsUHJpY2UiKSwgb3JkZXIuYWRkKCJzdWJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAoc3VidG90YWxQcmljZVYyKSB7CiAgICAgICAgICBzdWJ0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgc3VidG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxTaGlwcGluZ1ByaWNlIiksIG9yZGVyLmFkZCgidG90YWxTaGlwcGluZ1ByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxTaGlwcGluZ1ByaWNlVjIpIHsKICAgICAgICAgIHRvdGFsU2hpcHBpbmdQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsU2hpcHBpbmdQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxUYXgiKSwgb3JkZXIuYWRkKCJ0b3RhbFRheFYyIiwgZnVuY3Rpb24gKHRvdGFsVGF4VjIpIHsKICAgICAgICAgIHRvdGFsVGF4VjIuYWRkKCJhbW91bnQiKSwgdG90YWxUYXhWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsUHJpY2UiKSwgb3JkZXIuYWRkKCJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxQcmljZVYyKSB7CiAgICAgICAgICB0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgiY3VycmVuY3lDb2RlIiksIG9yZGVyLmFkZCgidG90YWxSZWZ1bmRlZCIpLCBvcmRlci5hZGQoInRvdGFsUmVmdW5kZWRWMiIsIGZ1bmN0aW9uICh0b3RhbFJlZnVuZGVkVjIpIHsKICAgICAgICAgIHRvdGFsUmVmdW5kZWRWMi5hZGQoImFtb3VudCIpLCB0b3RhbFJlZnVuZGVkVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJjdXN0b21lclVybCIpLCBvcmRlci5hZGQoInNoaXBwaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChzaGlwcGluZ0FkZHJlc3MpIHsKICAgICAgICAgIHNoaXBwaW5nQWRkcmVzcy5hZGRGcmFnbWVudChzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImxpbmVJdGVtcyIsIHsKICAgICAgICAgIGFyZ3M6IHsKICAgICAgICAgICAgZmlyc3Q6IDI1MAogICAgICAgICAgfQogICAgICAgIH0sIGZ1bmN0aW9uIChsaW5lSXRlbXMpIHsKICAgICAgICAgIGxpbmVJdGVtcy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICAgIH0pLCBsaW5lSXRlbXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgICBlZGdlcy5hZGQoImN1cnNvciIpLCBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICAgIG5vZGUuYWRkKCJ0aXRsZSIpLCBub2RlLmFkZCgidmFyaWFudCIsIGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgICAgICAgICB2YXJpYW50LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQpOwogICAgICAgICAgICAgIH0pLCBub2RlLmFkZCgicXVhbnRpdHkiKSwgbm9kZS5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgICAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJsaW5lSXRlbXMiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZmlyc3Q6IDI1MAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGxpbmVJdGVtcykgewogICAgICAgIGxpbmVJdGVtcy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIGxpbmVJdGVtcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoImN1cnNvciIpLCBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgiaWQiKSwgbm9kZS5hZGQoInRpdGxlIiksIG5vZGUuYWRkKCJ2YXJpYW50IiwgZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgICAgICB2YXJpYW50LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoInF1YW50aXR5IiksIG5vZGUuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImRpc2NvdW50QWxsb2NhdGlvbnMiLCBmdW5jdGlvbiAoZGlzY291bnRBbGxvY2F0aW9ucykgewogICAgICAgICAgICAgIGRpc2NvdW50QWxsb2NhdGlvbnMuYWRkKCJhbGxvY2F0ZWRBbW91bnQiLCBmdW5jdGlvbiAoYWxsb2NhdGVkQW1vdW50KSB7CiAgICAgICAgICAgICAgICBhbGxvY2F0ZWRBbW91bnQuYWRkKCJhbW91bnQiKSwgYWxsb2NhdGVkQW1vdW50LmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgICAgfSksIGRpc2NvdW50QWxsb2NhdGlvbnMuYWRkKCJkaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKGRpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICAgICAgICAgIGRpc2NvdW50QXBwbGljYXRpb24uYWRkRnJhZ21lbnQoc3ByZWFkcy5EaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudC5hZGRNdXRhdGlvbihbdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmNoZWNrb3V0SWQsIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5saW5lSXRlbXNdLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiY2hlY2tvdXRMaW5lSXRlbXNBZGQiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgY2hlY2tvdXRJZDogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmNoZWNrb3V0SWQsCiAgICAgICAgICBsaW5lSXRlbXM6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5saW5lSXRlbXMKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChjaGVja291dExpbmVJdGVtc0FkZCkgewogICAgICAgIGNoZWNrb3V0TGluZUl0ZW1zQWRkLmFkZCgidXNlckVycm9ycyIsIGZ1bmN0aW9uICh1c2VyRXJyb3JzKSB7CiAgICAgICAgICB1c2VyRXJyb3JzLmFkZEZyYWdtZW50KHNwcmVhZHMuVXNlckVycm9yRnJhZ21lbnQpOwogICAgICAgIH0pLCBjaGVja291dExpbmVJdGVtc0FkZC5hZGQoImNoZWNrb3V0VXNlckVycm9ycyIsIGZ1bmN0aW9uIChjaGVja291dFVzZXJFcnJvcnMpIHsKICAgICAgICAgIGNoZWNrb3V0VXNlckVycm9ycy5hZGRGcmFnbWVudChzcHJlYWRzLkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQpOwogICAgICAgIH0pLCBjaGVja291dExpbmVJdGVtc0FkZC5hZGQoImNoZWNrb3V0IiwgZnVuY3Rpb24gKGNoZWNrb3V0KSB7CiAgICAgICAgICBjaGVja291dC5hZGRGcmFnbWVudChzcHJlYWRzLkNoZWNrb3V0RnJhZ21lbnQpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudDsKICB9CgogIGZ1bmN0aW9uIHF1ZXJ5JDE0KGNsaWVudCkgewogICAgdmFyIGRvY3VtZW50ID0gY2xpZW50LmRvY3VtZW50KCksCiAgICAgICAgc3ByZWFkcyA9IHt9LAogICAgICAgIHZhcmlhYmxlcyA9IHsKICAgICAgX19kZWZhdWx0T3BlcmF0aW9uX186IHt9CiAgICB9OwogICAgcmV0dXJuIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5jaGVja291dElkID0gY2xpZW50LnZhcmlhYmxlKCJjaGVja291dElkIiwgIklEISIpLCB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ubGluZUl0ZW1JZHMgPSBjbGllbnQudmFyaWFibGUoImxpbmVJdGVtSWRzIiwgIltJRCFdISIpLCBzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJWYXJpYW50RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJwcmljZSIpLCByb290LmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgicHJlc2VudG1lbnRQcmljZXMiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZmlyc3Q6IDIwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAocHJlc2VudG1lbnRQcmljZXMpIHsKICAgICAgICBwcmVzZW50bWVudFByaWNlcy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHByZXNlbnRtZW50UHJpY2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJwcmljZSIsIGZ1bmN0aW9uIChwcmljZSkgewogICAgICAgICAgICAgIHByaWNlLmFkZCgiYW1vdW50IiksIHByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiY29tcGFyZUF0UHJpY2UiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2UpIHsKICAgICAgICAgICAgICBjb21wYXJlQXRQcmljZS5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoIndlaWdodCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIsIHsKICAgICAgICBhbGlhczogImF2YWlsYWJsZSIKICAgICAgfSksIHJvb3QuYWRkKCJza3UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlIiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZVYyIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlVjIpIHsKICAgICAgICBjb21wYXJlQXRQcmljZVYyLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJpbWFnZSIsIGZ1bmN0aW9uIChpbWFnZSkgewogICAgICAgIGltYWdlLmFkZCgiaWQiKSwgaW1hZ2UuYWRkKCJvcmlnaW5hbFNyYyIsIHsKICAgICAgICAgIGFsaWFzOiAic3JjIgogICAgICAgIH0pLCBpbWFnZS5hZGQoImFsdFRleHQiKTsKICAgICAgfSksIHJvb3QuYWRkKCJzZWxlY3RlZE9wdGlvbnMiLCBmdW5jdGlvbiAoc2VsZWN0ZWRPcHRpb25zKSB7CiAgICAgICAgc2VsZWN0ZWRPcHRpb25zLmFkZCgibmFtZSIpLCBzZWxlY3RlZE9wdGlvbnMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZSIsIGZ1bmN0aW9uICh1bml0UHJpY2UpIHsKICAgICAgICB1bml0UHJpY2UuYWRkKCJhbW91bnQiKSwgdW5pdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlTWVhc3VyZW1lbnQiLCBmdW5jdGlvbiAodW5pdFByaWNlTWVhc3VyZW1lbnQpIHsKICAgICAgICB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoIm1lYXN1cmVkVHlwZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInF1YW50aXR5VW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInF1YW50aXR5VmFsdWUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVmFsdWUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5EaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50IiwgIkRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgidGFyZ2V0U2VsZWN0aW9uIiksIHJvb3QuYWRkKCJhbGxvY2F0aW9uTWV0aG9kIiksIHJvb3QuYWRkKCJ0YXJnZXRUeXBlIiksIHJvb3QuYWRkKCJ2YWx1ZSIsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHZhbHVlLmFkZElubGluZUZyYWdtZW50T24oIk1vbmV5VjIiLCBmdW5jdGlvbiAoTW9uZXlWMikgewogICAgICAgICAgTW9uZXlWMi5hZGQoImFtb3VudCIpLCBNb25leVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHZhbHVlLmFkZElubGluZUZyYWdtZW50T24oIlByaWNpbmdQZXJjZW50YWdlVmFsdWUiLCBmdW5jdGlvbiAoUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSkgewogICAgICAgICAgUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZS5hZGQoInBlcmNlbnRhZ2UiKTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIiksIE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJkZXNjcmlwdGlvbiIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJEaXNjb3VudENvZGVBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChEaXNjb3VudENvZGVBcHBsaWNhdGlvbikgewogICAgICAgIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiY29kZSIpLCBEaXNjb3VudENvZGVBcHBsaWNhdGlvbi5hZGQoImFwcGxpY2FibGUiKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIEF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24uYWRkKCJ0aXRsZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50IiwgIkFwcGxpZWRHaWZ0Q2FyZCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJhbW91bnRVc2VkVjIiLCBmdW5jdGlvbiAoYW1vdW50VXNlZFYyKSB7CiAgICAgICAgYW1vdW50VXNlZFYyLmFkZCgiYW1vdW50IiksIGFtb3VudFVzZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImJhbGFuY2VWMiIsIGZ1bmN0aW9uIChiYWxhbmNlVjIpIHsKICAgICAgICBiYWxhbmNlVjIuYWRkKCJhbW91bnQiKSwgYmFsYW5jZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgicHJlc2VudG1lbnRBbW91bnRVc2VkIiwgZnVuY3Rpb24gKHByZXNlbnRtZW50QW1vdW50VXNlZCkgewogICAgICAgIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImFtb3VudCIpLCBwcmVzZW50bWVudEFtb3VudFVzZWQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgibGFzdENoYXJhY3RlcnMiKTsKICAgIH0pLCBzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCksIHJvb3QuYWRkKCJwcm9kdWN0IiwgZnVuY3Rpb24gKHByb2R1Y3QpIHsKICAgICAgICBwcm9kdWN0LmFkZCgiaWQiKSwgcHJvZHVjdC5hZGQoImhhbmRsZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlVzZXJFcnJvckZyYWdtZW50IiwgIlVzZXJFcnJvciIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJmaWVsZCIpLCByb290LmFkZCgibWVzc2FnZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dFVzZXJFcnJvckZyYWdtZW50IiwgIkNoZWNrb3V0VXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIiksIHJvb3QuYWRkKCJjb2RlIik7CiAgICB9KSwgc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIk1haWxpbmdBZGRyZXNzRnJhZ21lbnQiLCAiTWFpbGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImFkZHJlc3MxIiksIHJvb3QuYWRkKCJhZGRyZXNzMiIpLCByb290LmFkZCgiY2l0eSIpLCByb290LmFkZCgiY29tcGFueSIpLCByb290LmFkZCgiY291bnRyeSIpLCByb290LmFkZCgiZmlyc3ROYW1lIiksIHJvb3QuYWRkKCJmb3JtYXR0ZWQiKSwgcm9vdC5hZGQoImxhc3ROYW1lIiksIHJvb3QuYWRkKCJsYXRpdHVkZSIpLCByb290LmFkZCgibG9uZ2l0dWRlIiksIHJvb3QuYWRkKCJwaG9uZSIpLCByb290LmFkZCgicHJvdmluY2UiKSwgcm9vdC5hZGQoInppcCIpLCByb290LmFkZCgibmFtZSIpLCByb290LmFkZCgiY291bnRyeUNvZGVWMiIsIHsKICAgICAgICBhbGlhczogImNvdW50cnlDb2RlIgogICAgICB9KSwgcm9vdC5hZGQoInByb3ZpbmNlQ29kZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dEZyYWdtZW50IiwgIkNoZWNrb3V0IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJyZWFkeSIpLCByb290LmFkZCgicmVxdWlyZXNTaGlwcGluZyIpLCByb290LmFkZCgibm90ZSIpLCByb290LmFkZCgicGF5bWVudER1ZSIpLCByb290LmFkZCgicGF5bWVudER1ZVYyIiwgZnVuY3Rpb24gKHBheW1lbnREdWVWMikgewogICAgICAgIHBheW1lbnREdWVWMi5hZGQoImFtb3VudCIpLCBwYXltZW50RHVlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWJVcmwiKSwgcm9vdC5hZGQoIm9yZGVyU3RhdHVzVXJsIiksIHJvb3QuYWRkKCJ0YXhFeGVtcHQiKSwgcm9vdC5hZGQoInRheGVzSW5jbHVkZWQiKSwgcm9vdC5hZGQoImN1cnJlbmN5Q29kZSIpLCByb290LmFkZCgidG90YWxUYXgiKSwgcm9vdC5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgIHRvdGFsVGF4VjIuYWRkKCJhbW91bnQiKSwgdG90YWxUYXhWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtc1N1YnRvdGFsUHJpY2UiLCBmdW5jdGlvbiAobGluZUl0ZW1zU3VidG90YWxQcmljZSkgewogICAgICAgIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYWRkKCJhbW91bnQiKSwgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2UiKSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICBzdWJ0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgc3VidG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidG90YWxQcmljZSIpLCByb290LmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjb21wbGV0ZWRBdCIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImVtYWlsIiksIHJvb3QuYWRkKCJkaXNjb3VudEFwcGxpY2F0aW9ucyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9ucykgewogICAgICAgIGRpc2NvdW50QXBwbGljYXRpb25zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJhcHBsaWVkR2lmdENhcmRzIiwgZnVuY3Rpb24gKGFwcGxpZWRHaWZ0Q2FyZHMpIHsKICAgICAgICBhcHBsaWVkR2lmdENhcmRzLmFkZEZyYWdtZW50KHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChzaGlwcGluZ0FkZHJlc3MpIHsKICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgfSksIHJvb3QuYWRkKCJzaGlwcGluZ0xpbmUiLCBmdW5jdGlvbiAoc2hpcHBpbmdMaW5lKSB7CiAgICAgICAgc2hpcHBpbmdMaW5lLmFkZCgiaGFuZGxlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHNoaXBwaW5nTGluZS5hZGQoInRpdGxlIik7CiAgICAgIH0pLCByb290LmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJvcmRlciIsIGZ1bmN0aW9uIChvcmRlcikgewogICAgICAgIG9yZGVyLmFkZCgiaWQiKSwgb3JkZXIuYWRkKCJwcm9jZXNzZWRBdCIpLCBvcmRlci5hZGQoIm9yZGVyTnVtYmVyIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2UiKSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFNoaXBwaW5nUHJpY2VWMikgewogICAgICAgICAgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFRheCIpLCBvcmRlci5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJjdXJyZW5jeUNvZGUiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkIiksIG9yZGVyLmFkZCgidG90YWxSZWZ1bmRlZFYyIiwgZnVuY3Rpb24gKHRvdGFsUmVmdW5kZWRWMikgewogICAgICAgICAgdG90YWxSZWZ1bmRlZFYyLmFkZCgiYW1vdW50IiksIHRvdGFsUmVmdW5kZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1c3RvbWVyVXJsIiksIG9yZGVyLmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgICAgc2hpcHBpbmdBZGRyZXNzLmFkZEZyYWdtZW50KHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCk7CiAgICAgICAgfSksIG9yZGVyLmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgICAgYXJnczogewogICAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgICB9CiAgICAgICAgfSwgZnVuY3Rpb24gKGxpbmVJdGVtcykgewogICAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgICAgfSksIGxpbmVJdGVtcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgICAgbm9kZS5hZGQoInRpdGxlIiksIG5vZGUuYWRkKCJ2YXJpYW50IiwgZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgicXVhbnRpdHkiKSwgbm9kZS5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiZGlzY291bnRBbGxvY2F0aW9ucyIsIGZ1bmN0aW9uIChkaXNjb3VudEFsbG9jYXRpb25zKSB7CiAgICAgICAgICAgICAgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImFsbG9jYXRlZEFtb3VudCIsIGZ1bmN0aW9uIChhbGxvY2F0ZWRBbW91bnQpIHsKICAgICAgICAgICAgICAgIGFsbG9jYXRlZEFtb3VudC5hZGQoImFtb3VudCIpLCBhbGxvY2F0ZWRBbW91bnQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgICB9KSwgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoZGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgICAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbi5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZE11dGF0aW9uKFt2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uY2hlY2tvdXRJZCwgdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmxpbmVJdGVtSWRzXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImNoZWNrb3V0TGluZUl0ZW1zUmVtb3ZlIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGNoZWNrb3V0SWQ6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5jaGVja291dElkLAogICAgICAgICAgbGluZUl0ZW1JZHM6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5saW5lSXRlbUlkcwogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGNoZWNrb3V0TGluZUl0ZW1zUmVtb3ZlKSB7CiAgICAgICAgY2hlY2tvdXRMaW5lSXRlbXNSZW1vdmUuYWRkKCJ1c2VyRXJyb3JzIiwgZnVuY3Rpb24gKHVzZXJFcnJvcnMpIHsKICAgICAgICAgIHVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5Vc2VyRXJyb3JGcmFnbWVudCk7CiAgICAgICAgfSksIGNoZWNrb3V0TGluZUl0ZW1zUmVtb3ZlLmFkZCgiY2hlY2tvdXRVc2VyRXJyb3JzIiwgZnVuY3Rpb24gKGNoZWNrb3V0VXNlckVycm9ycykgewogICAgICAgICAgY2hlY2tvdXRVc2VyRXJyb3JzLmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCk7CiAgICAgICAgfSksIGNoZWNrb3V0TGluZUl0ZW1zUmVtb3ZlLmFkZCgiY2hlY2tvdXQiLCBmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICAgIGNoZWNrb3V0LmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkMTUoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBfX2RlZmF1bHRPcGVyYXRpb25fXzoge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmNoZWNrb3V0SWQgPSBjbGllbnQudmFyaWFibGUoImNoZWNrb3V0SWQiLCAiSUQhIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5saW5lSXRlbXMgPSBjbGllbnQudmFyaWFibGUoImxpbmVJdGVtcyIsICJbQ2hlY2tvdXRMaW5lSXRlbUlucHV0IV0hIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJEaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQiLCAiRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJ0YXJnZXRTZWxlY3Rpb24iKSwgcm9vdC5hZGQoImFsbG9jYXRpb25NZXRob2QiKSwgcm9vdC5hZGQoInRhcmdldFR5cGUiKSwgcm9vdC5hZGQoInZhbHVlIiwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiTW9uZXlWMiIsIGZ1bmN0aW9uIChNb25leVYyKSB7CiAgICAgICAgICBNb25leVYyLmFkZCgiYW1vdW50IiksIE1vbmV5VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSIsIGZ1bmN0aW9uIChQcmljaW5nUGVyY2VudGFnZVZhbHVlKSB7CiAgICAgICAgICBQcmljaW5nUGVyY2VudGFnZVZhbHVlLmFkZCgicGVyY2VudGFnZSIpOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKSwgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkRpc2NvdW50Q29kZUFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKERpc2NvdW50Q29kZUFwcGxpY2F0aW9uKSB7CiAgICAgICAgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJjb2RlIiksIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiYXBwbGljYWJsZSIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQiLCAiQXBwbGllZEdpZnRDYXJkIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImFtb3VudFVzZWRWMiIsIGZ1bmN0aW9uIChhbW91bnRVc2VkVjIpIHsKICAgICAgICBhbW91bnRVc2VkVjIuYWRkKCJhbW91bnQiKSwgYW1vdW50VXNlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiYmFsYW5jZVYyIiwgZnVuY3Rpb24gKGJhbGFuY2VWMikgewogICAgICAgIGJhbGFuY2VWMi5hZGQoImFtb3VudCIpLCBiYWxhbmNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudEFtb3VudFVzZWQiLCBmdW5jdGlvbiAocHJlc2VudG1lbnRBbW91bnRVc2VkKSB7CiAgICAgICAgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiYW1vdW50IiksIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJsYXN0Q2hhcmFjdGVycyIpOwogICAgfSksIHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudEZyYWdtZW50KSwgcm9vdC5hZGQoInByb2R1Y3QiLCBmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgIHByb2R1Y3QuYWRkKCJpZCIpLCBwcm9kdWN0LmFkZCgiaGFuZGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dFVzZXJFcnJvckZyYWdtZW50IiwgIkNoZWNrb3V0VXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIiksIHJvb3QuYWRkKCJjb2RlIik7CiAgICB9KSwgc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIk1haWxpbmdBZGRyZXNzRnJhZ21lbnQiLCAiTWFpbGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImFkZHJlc3MxIiksIHJvb3QuYWRkKCJhZGRyZXNzMiIpLCByb290LmFkZCgiY2l0eSIpLCByb290LmFkZCgiY29tcGFueSIpLCByb290LmFkZCgiY291bnRyeSIpLCByb290LmFkZCgiZmlyc3ROYW1lIiksIHJvb3QuYWRkKCJmb3JtYXR0ZWQiKSwgcm9vdC5hZGQoImxhc3ROYW1lIiksIHJvb3QuYWRkKCJsYXRpdHVkZSIpLCByb290LmFkZCgibG9uZ2l0dWRlIiksIHJvb3QuYWRkKCJwaG9uZSIpLCByb290LmFkZCgicHJvdmluY2UiKSwgcm9vdC5hZGQoInppcCIpLCByb290LmFkZCgibmFtZSIpLCByb290LmFkZCgiY291bnRyeUNvZGVWMiIsIHsKICAgICAgICBhbGlhczogImNvdW50cnlDb2RlIgogICAgICB9KSwgcm9vdC5hZGQoInByb3ZpbmNlQ29kZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dEZyYWdtZW50IiwgIkNoZWNrb3V0IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJyZWFkeSIpLCByb290LmFkZCgicmVxdWlyZXNTaGlwcGluZyIpLCByb290LmFkZCgibm90ZSIpLCByb290LmFkZCgicGF5bWVudER1ZSIpLCByb290LmFkZCgicGF5bWVudER1ZVYyIiwgZnVuY3Rpb24gKHBheW1lbnREdWVWMikgewogICAgICAgIHBheW1lbnREdWVWMi5hZGQoImFtb3VudCIpLCBwYXltZW50RHVlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWJVcmwiKSwgcm9vdC5hZGQoIm9yZGVyU3RhdHVzVXJsIiksIHJvb3QuYWRkKCJ0YXhFeGVtcHQiKSwgcm9vdC5hZGQoInRheGVzSW5jbHVkZWQiKSwgcm9vdC5hZGQoImN1cnJlbmN5Q29kZSIpLCByb290LmFkZCgidG90YWxUYXgiKSwgcm9vdC5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgIHRvdGFsVGF4VjIuYWRkKCJhbW91bnQiKSwgdG90YWxUYXhWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtc1N1YnRvdGFsUHJpY2UiLCBmdW5jdGlvbiAobGluZUl0ZW1zU3VidG90YWxQcmljZSkgewogICAgICAgIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYWRkKCJhbW91bnQiKSwgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2UiKSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICBzdWJ0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgc3VidG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidG90YWxQcmljZSIpLCByb290LmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjb21wbGV0ZWRBdCIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImVtYWlsIiksIHJvb3QuYWRkKCJkaXNjb3VudEFwcGxpY2F0aW9ucyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9ucykgewogICAgICAgIGRpc2NvdW50QXBwbGljYXRpb25zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJhcHBsaWVkR2lmdENhcmRzIiwgZnVuY3Rpb24gKGFwcGxpZWRHaWZ0Q2FyZHMpIHsKICAgICAgICBhcHBsaWVkR2lmdENhcmRzLmFkZEZyYWdtZW50KHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChzaGlwcGluZ0FkZHJlc3MpIHsKICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgfSksIHJvb3QuYWRkKCJzaGlwcGluZ0xpbmUiLCBmdW5jdGlvbiAoc2hpcHBpbmdMaW5lKSB7CiAgICAgICAgc2hpcHBpbmdMaW5lLmFkZCgiaGFuZGxlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHNoaXBwaW5nTGluZS5hZGQoInRpdGxlIik7CiAgICAgIH0pLCByb290LmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJvcmRlciIsIGZ1bmN0aW9uIChvcmRlcikgewogICAgICAgIG9yZGVyLmFkZCgiaWQiKSwgb3JkZXIuYWRkKCJwcm9jZXNzZWRBdCIpLCBvcmRlci5hZGQoIm9yZGVyTnVtYmVyIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2UiKSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFNoaXBwaW5nUHJpY2VWMikgewogICAgICAgICAgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFRheCIpLCBvcmRlci5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJjdXJyZW5jeUNvZGUiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkIiksIG9yZGVyLmFkZCgidG90YWxSZWZ1bmRlZFYyIiwgZnVuY3Rpb24gKHRvdGFsUmVmdW5kZWRWMikgewogICAgICAgICAgdG90YWxSZWZ1bmRlZFYyLmFkZCgiYW1vdW50IiksIHRvdGFsUmVmdW5kZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1c3RvbWVyVXJsIiksIG9yZGVyLmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgICAgc2hpcHBpbmdBZGRyZXNzLmFkZEZyYWdtZW50KHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCk7CiAgICAgICAgfSksIG9yZGVyLmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgICAgYXJnczogewogICAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgICB9CiAgICAgICAgfSwgZnVuY3Rpb24gKGxpbmVJdGVtcykgewogICAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgICAgfSksIGxpbmVJdGVtcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgICAgbm9kZS5hZGQoInRpdGxlIiksIG5vZGUuYWRkKCJ2YXJpYW50IiwgZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgicXVhbnRpdHkiKSwgbm9kZS5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiZGlzY291bnRBbGxvY2F0aW9ucyIsIGZ1bmN0aW9uIChkaXNjb3VudEFsbG9jYXRpb25zKSB7CiAgICAgICAgICAgICAgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImFsbG9jYXRlZEFtb3VudCIsIGZ1bmN0aW9uIChhbGxvY2F0ZWRBbW91bnQpIHsKICAgICAgICAgICAgICAgIGFsbG9jYXRlZEFtb3VudC5hZGQoImFtb3VudCIpLCBhbGxvY2F0ZWRBbW91bnQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgICB9KSwgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoZGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgICAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbi5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZE11dGF0aW9uKFt2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18uY2hlY2tvdXRJZCwgdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmxpbmVJdGVtc10sIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJjaGVja291dExpbmVJdGVtc1JlcGxhY2UiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgY2hlY2tvdXRJZDogdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmNoZWNrb3V0SWQsCiAgICAgICAgICBsaW5lSXRlbXM6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5saW5lSXRlbXMKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChjaGVja291dExpbmVJdGVtc1JlcGxhY2UpIHsKICAgICAgICBjaGVja291dExpbmVJdGVtc1JlcGxhY2UuYWRkKCJ1c2VyRXJyb3JzIiwgZnVuY3Rpb24gKHVzZXJFcnJvcnMpIHsKICAgICAgICAgIHVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXRMaW5lSXRlbXNSZXBsYWNlLmFkZCgiY2hlY2tvdXQiLCBmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICAgIGNoZWNrb3V0LmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkMTYoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBfX2RlZmF1bHRPcGVyYXRpb25fXzoge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLl9fZGVmYXVsdE9wZXJhdGlvbl9fLmNoZWNrb3V0SWQgPSBjbGllbnQudmFyaWFibGUoImNoZWNrb3V0SWQiLCAiSUQhIiksIHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5saW5lSXRlbXMgPSBjbGllbnQudmFyaWFibGUoImxpbmVJdGVtcyIsICJbQ2hlY2tvdXRMaW5lSXRlbVVwZGF0ZUlucHV0IV0hIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJEaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQiLCAiRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJ0YXJnZXRTZWxlY3Rpb24iKSwgcm9vdC5hZGQoImFsbG9jYXRpb25NZXRob2QiKSwgcm9vdC5hZGQoInRhcmdldFR5cGUiKSwgcm9vdC5hZGQoInZhbHVlIiwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiTW9uZXlWMiIsIGZ1bmN0aW9uIChNb25leVYyKSB7CiAgICAgICAgICBNb25leVYyLmFkZCgiYW1vdW50IiksIE1vbmV5VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSIsIGZ1bmN0aW9uIChQcmljaW5nUGVyY2VudGFnZVZhbHVlKSB7CiAgICAgICAgICBQcmljaW5nUGVyY2VudGFnZVZhbHVlLmFkZCgicGVyY2VudGFnZSIpOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKSwgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkRpc2NvdW50Q29kZUFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKERpc2NvdW50Q29kZUFwcGxpY2F0aW9uKSB7CiAgICAgICAgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJjb2RlIiksIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiYXBwbGljYWJsZSIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQiLCAiQXBwbGllZEdpZnRDYXJkIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImFtb3VudFVzZWRWMiIsIGZ1bmN0aW9uIChhbW91bnRVc2VkVjIpIHsKICAgICAgICBhbW91bnRVc2VkVjIuYWRkKCJhbW91bnQiKSwgYW1vdW50VXNlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiYmFsYW5jZVYyIiwgZnVuY3Rpb24gKGJhbGFuY2VWMikgewogICAgICAgIGJhbGFuY2VWMi5hZGQoImFtb3VudCIpLCBiYWxhbmNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudEFtb3VudFVzZWQiLCBmdW5jdGlvbiAocHJlc2VudG1lbnRBbW91bnRVc2VkKSB7CiAgICAgICAgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiYW1vdW50IiksIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJsYXN0Q2hhcmFjdGVycyIpOwogICAgfSksIHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudEZyYWdtZW50KSwgcm9vdC5hZGQoInByb2R1Y3QiLCBmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgIHByb2R1Y3QuYWRkKCJpZCIpLCBwcm9kdWN0LmFkZCgiaGFuZGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuVXNlckVycm9yRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVXNlckVycm9yRnJhZ21lbnQiLCAiVXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQiLCAiQ2hlY2tvdXRVc2VyRXJyb3IiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiZmllbGQiKSwgcm9vdC5hZGQoIm1lc3NhZ2UiKSwgcm9vdC5hZGQoImNvZGUiKTsKICAgIH0pLCBzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiTWFpbGluZ0FkZHJlc3NGcmFnbWVudCIsICJNYWlsaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYWRkcmVzczEiKSwgcm9vdC5hZGQoImFkZHJlc3MyIiksIHJvb3QuYWRkKCJjaXR5IiksIHJvb3QuYWRkKCJjb21wYW55IiksIHJvb3QuYWRkKCJjb3VudHJ5IiksIHJvb3QuYWRkKCJmaXJzdE5hbWUiKSwgcm9vdC5hZGQoImZvcm1hdHRlZCIpLCByb290LmFkZCgibGFzdE5hbWUiKSwgcm9vdC5hZGQoImxhdGl0dWRlIiksIHJvb3QuYWRkKCJsb25naXR1ZGUiKSwgcm9vdC5hZGQoInBob25lIiksIHJvb3QuYWRkKCJwcm92aW5jZSIpLCByb290LmFkZCgiemlwIiksIHJvb3QuYWRkKCJuYW1lIiksIHJvb3QuYWRkKCJjb3VudHJ5Q29kZVYyIiwgewogICAgICAgIGFsaWFzOiAiY291bnRyeUNvZGUiCiAgICAgIH0pLCByb290LmFkZCgicHJvdmluY2VDb2RlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0RnJhZ21lbnQiLCAiQ2hlY2tvdXQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInJlYWR5IiksIHJvb3QuYWRkKCJyZXF1aXJlc1NoaXBwaW5nIiksIHJvb3QuYWRkKCJub3RlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlVjIiLCBmdW5jdGlvbiAocGF5bWVudER1ZVYyKSB7CiAgICAgICAgcGF5bWVudER1ZVYyLmFkZCgiYW1vdW50IiksIHBheW1lbnREdWVWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIndlYlVybCIpLCByb290LmFkZCgib3JkZXJTdGF0dXNVcmwiKSwgcm9vdC5hZGQoInRheEV4ZW1wdCIpLCByb290LmFkZCgidGF4ZXNJbmNsdWRlZCIpLCByb290LmFkZCgiY3VycmVuY3lDb2RlIiksIHJvb3QuYWRkKCJ0b3RhbFRheCIpLCByb290LmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zU3VidG90YWxQcmljZSIsIGZ1bmN0aW9uIChsaW5lSXRlbXNTdWJ0b3RhbFByaWNlKSB7CiAgICAgICAgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImFtb3VudCIpLCBsaW5lSXRlbXNTdWJ0b3RhbFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgic3VidG90YWxQcmljZSIpLCByb290LmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ0b3RhbFByaWNlIiksIHJvb3QuYWRkKCJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxQcmljZVYyKSB7CiAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImNvbXBsZXRlZEF0IiksIHJvb3QuYWRkKCJjcmVhdGVkQXQiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgiZW1haWwiKSwgcm9vdC5hZGQoImRpc2NvdW50QXBwbGljYXRpb25zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAxMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGRpc2NvdW50QXBwbGljYXRpb25zKSB7CiAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBkaXNjb3VudEFwcGxpY2F0aW9ucy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImFwcGxpZWRHaWZ0Q2FyZHMiLCBmdW5jdGlvbiAoYXBwbGllZEdpZnRDYXJkcykgewogICAgICAgIGFwcGxpZWRHaWZ0Q2FyZHMuYWRkRnJhZ21lbnQoc3ByZWFkcy5BcHBsaWVkR2lmdENhcmRGcmFnbWVudCk7CiAgICAgIH0pLCByb290LmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgIHNoaXBwaW5nQWRkcmVzcy5hZGRGcmFnbWVudChzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nTGluZSIsIGZ1bmN0aW9uIChzaGlwcGluZ0xpbmUpIHsKICAgICAgICBzaGlwcGluZ0xpbmUuYWRkKCJoYW5kbGUiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2UiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgc2hpcHBpbmdMaW5lLmFkZCgidGl0bGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIm9yZGVyIiwgZnVuY3Rpb24gKG9yZGVyKSB7CiAgICAgICAgb3JkZXIuYWRkKCJpZCIpLCBvcmRlci5hZGQoInByb2Nlc3NlZEF0IiksIG9yZGVyLmFkZCgib3JkZXJOdW1iZXIiKSwgb3JkZXIuYWRkKCJzdWJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgICAgc3VidG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHN1YnRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsU2hpcHBpbmdQcmljZVYyKSB7CiAgICAgICAgICB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsVGF4IiksIG9yZGVyLmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgICB0b3RhbFRheFYyLmFkZCgiYW1vdW50IiksIHRvdGFsVGF4VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1cnJlbmN5Q29kZSIpLCBvcmRlci5hZGQoInRvdGFsUmVmdW5kZWQiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkVjIiLCBmdW5jdGlvbiAodG90YWxSZWZ1bmRlZFYyKSB7CiAgICAgICAgICB0b3RhbFJlZnVuZGVkVjIuYWRkKCJhbW91bnQiKSwgdG90YWxSZWZ1bmRlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgiY3VzdG9tZXJVcmwiKSwgb3JkZXIuYWRkKCJzaGlwcGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAoc2hpcHBpbmdBZGRyZXNzKSB7CiAgICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJsaW5lSXRlbXMiLCB7CiAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICAgIH0KICAgICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgICB9KSwgbm9kZS5hZGQoInF1YW50aXR5IiksIG5vZGUuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChsaW5lSXRlbXMpIHsKICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBsaW5lSXRlbXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoImlkIiksIG5vZGUuYWRkKCJ0aXRsZSIpLCBub2RlLmFkZCgidmFyaWFudCIsIGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJkaXNjb3VudEFsbG9jYXRpb25zIiwgZnVuY3Rpb24gKGRpc2NvdW50QWxsb2NhdGlvbnMpIHsKICAgICAgICAgICAgICBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiYWxsb2NhdGVkQW1vdW50IiwgZnVuY3Rpb24gKGFsbG9jYXRlZEFtb3VudCkgewogICAgICAgICAgICAgICAgYWxsb2NhdGVkQW1vdW50LmFkZCgiYW1vdW50IiksIGFsbG9jYXRlZEFtb3VudC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICAgIH0pLCBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiZGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgICAgICAgICBkaXNjb3VudEFwcGxpY2F0aW9uLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQuYWRkTXV0YXRpb24oW3ZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5jaGVja291dElkLCB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ubGluZUl0ZW1zXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImNoZWNrb3V0TGluZUl0ZW1zVXBkYXRlIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGNoZWNrb3V0SWQ6IHZhcmlhYmxlcy5fX2RlZmF1bHRPcGVyYXRpb25fXy5jaGVja291dElkLAogICAgICAgICAgbGluZUl0ZW1zOiB2YXJpYWJsZXMuX19kZWZhdWx0T3BlcmF0aW9uX18ubGluZUl0ZW1zCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoY2hlY2tvdXRMaW5lSXRlbXNVcGRhdGUpIHsKICAgICAgICBjaGVja291dExpbmVJdGVtc1VwZGF0ZS5hZGQoInVzZXJFcnJvcnMiLCBmdW5jdGlvbiAodXNlckVycm9ycykgewogICAgICAgICAgdXNlckVycm9ycy5hZGRGcmFnbWVudChzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXRMaW5lSXRlbXNVcGRhdGUuYWRkKCJjaGVja291dFVzZXJFcnJvcnMiLCBmdW5jdGlvbiAoY2hlY2tvdXRVc2VyRXJyb3JzKSB7CiAgICAgICAgICBjaGVja291dFVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXRMaW5lSXRlbXNVcGRhdGUuYWRkKCJjaGVja291dCIsIGZ1bmN0aW9uIChjaGVja291dCkgewogICAgICAgICAgY2hlY2tvdXQuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dEZyYWdtZW50KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBxdWVyeSQxNyhjbGllbnQpIHsKICAgIHZhciBkb2N1bWVudCA9IGNsaWVudC5kb2N1bWVudCgpLAogICAgICAgIHNwcmVhZHMgPSB7fSwKICAgICAgICB2YXJpYWJsZXMgPSB7CiAgICAgIGNoZWNrb3V0QXR0cmlidXRlc1VwZGF0ZVYyOiB7fQogICAgfTsKICAgIHJldHVybiB2YXJpYWJsZXMuY2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlVjIuY2hlY2tvdXRJZCA9IGNsaWVudC52YXJpYWJsZSgiY2hlY2tvdXRJZCIsICJJRCEiKSwgdmFyaWFibGVzLmNoZWNrb3V0QXR0cmlidXRlc1VwZGF0ZVYyLmlucHV0ID0gY2xpZW50LnZhcmlhYmxlKCJpbnB1dCIsICJDaGVja291dEF0dHJpYnV0ZXNVcGRhdGVWMklucHV0ISIpLCBzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJWYXJpYW50RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJwcmljZSIpLCByb290LmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgicHJlc2VudG1lbnRQcmljZXMiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZmlyc3Q6IDIwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAocHJlc2VudG1lbnRQcmljZXMpIHsKICAgICAgICBwcmVzZW50bWVudFByaWNlcy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHByZXNlbnRtZW50UHJpY2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJwcmljZSIsIGZ1bmN0aW9uIChwcmljZSkgewogICAgICAgICAgICAgIHByaWNlLmFkZCgiYW1vdW50IiksIHByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiY29tcGFyZUF0UHJpY2UiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2UpIHsKICAgICAgICAgICAgICBjb21wYXJlQXRQcmljZS5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoIndlaWdodCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIsIHsKICAgICAgICBhbGlhczogImF2YWlsYWJsZSIKICAgICAgfSksIHJvb3QuYWRkKCJza3UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlIiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZVYyIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlVjIpIHsKICAgICAgICBjb21wYXJlQXRQcmljZVYyLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJpbWFnZSIsIGZ1bmN0aW9uIChpbWFnZSkgewogICAgICAgIGltYWdlLmFkZCgiaWQiKSwgaW1hZ2UuYWRkKCJvcmlnaW5hbFNyYyIsIHsKICAgICAgICAgIGFsaWFzOiAic3JjIgogICAgICAgIH0pLCBpbWFnZS5hZGQoImFsdFRleHQiKTsKICAgICAgfSksIHJvb3QuYWRkKCJzZWxlY3RlZE9wdGlvbnMiLCBmdW5jdGlvbiAoc2VsZWN0ZWRPcHRpb25zKSB7CiAgICAgICAgc2VsZWN0ZWRPcHRpb25zLmFkZCgibmFtZSIpLCBzZWxlY3RlZE9wdGlvbnMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZSIsIGZ1bmN0aW9uICh1bml0UHJpY2UpIHsKICAgICAgICB1bml0UHJpY2UuYWRkKCJhbW91bnQiKSwgdW5pdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlTWVhc3VyZW1lbnQiLCBmdW5jdGlvbiAodW5pdFByaWNlTWVhc3VyZW1lbnQpIHsKICAgICAgICB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoIm1lYXN1cmVkVHlwZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInF1YW50aXR5VW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInF1YW50aXR5VmFsdWUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVmFsdWUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5EaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50IiwgIkRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgidGFyZ2V0U2VsZWN0aW9uIiksIHJvb3QuYWRkKCJhbGxvY2F0aW9uTWV0aG9kIiksIHJvb3QuYWRkKCJ0YXJnZXRUeXBlIiksIHJvb3QuYWRkKCJ2YWx1ZSIsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHZhbHVlLmFkZElubGluZUZyYWdtZW50T24oIk1vbmV5VjIiLCBmdW5jdGlvbiAoTW9uZXlWMikgewogICAgICAgICAgTW9uZXlWMi5hZGQoImFtb3VudCIpLCBNb25leVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHZhbHVlLmFkZElubGluZUZyYWdtZW50T24oIlByaWNpbmdQZXJjZW50YWdlVmFsdWUiLCBmdW5jdGlvbiAoUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSkgewogICAgICAgICAgUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZS5hZGQoInBlcmNlbnRhZ2UiKTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIiksIE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJkZXNjcmlwdGlvbiIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJEaXNjb3VudENvZGVBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChEaXNjb3VudENvZGVBcHBsaWNhdGlvbikgewogICAgICAgIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiY29kZSIpLCBEaXNjb3VudENvZGVBcHBsaWNhdGlvbi5hZGQoImFwcGxpY2FibGUiKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIEF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24uYWRkKCJ0aXRsZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50IiwgIkFwcGxpZWRHaWZ0Q2FyZCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJhbW91bnRVc2VkVjIiLCBmdW5jdGlvbiAoYW1vdW50VXNlZFYyKSB7CiAgICAgICAgYW1vdW50VXNlZFYyLmFkZCgiYW1vdW50IiksIGFtb3VudFVzZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImJhbGFuY2VWMiIsIGZ1bmN0aW9uIChiYWxhbmNlVjIpIHsKICAgICAgICBiYWxhbmNlVjIuYWRkKCJhbW91bnQiKSwgYmFsYW5jZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgicHJlc2VudG1lbnRBbW91bnRVc2VkIiwgZnVuY3Rpb24gKHByZXNlbnRtZW50QW1vdW50VXNlZCkgewogICAgICAgIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImFtb3VudCIpLCBwcmVzZW50bWVudEFtb3VudFVzZWQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgibGFzdENoYXJhY3RlcnMiKTsKICAgIH0pLCBzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCksIHJvb3QuYWRkKCJwcm9kdWN0IiwgZnVuY3Rpb24gKHByb2R1Y3QpIHsKICAgICAgICBwcm9kdWN0LmFkZCgiaWQiKSwgcHJvZHVjdC5hZGQoImhhbmRsZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlVzZXJFcnJvckZyYWdtZW50IiwgIlVzZXJFcnJvciIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJmaWVsZCIpLCByb290LmFkZCgibWVzc2FnZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dFVzZXJFcnJvckZyYWdtZW50IiwgIkNoZWNrb3V0VXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIiksIHJvb3QuYWRkKCJjb2RlIik7CiAgICB9KSwgc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIk1haWxpbmdBZGRyZXNzRnJhZ21lbnQiLCAiTWFpbGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImFkZHJlc3MxIiksIHJvb3QuYWRkKCJhZGRyZXNzMiIpLCByb290LmFkZCgiY2l0eSIpLCByb290LmFkZCgiY29tcGFueSIpLCByb290LmFkZCgiY291bnRyeSIpLCByb290LmFkZCgiZmlyc3ROYW1lIiksIHJvb3QuYWRkKCJmb3JtYXR0ZWQiKSwgcm9vdC5hZGQoImxhc3ROYW1lIiksIHJvb3QuYWRkKCJsYXRpdHVkZSIpLCByb290LmFkZCgibG9uZ2l0dWRlIiksIHJvb3QuYWRkKCJwaG9uZSIpLCByb290LmFkZCgicHJvdmluY2UiKSwgcm9vdC5hZGQoInppcCIpLCByb290LmFkZCgibmFtZSIpLCByb290LmFkZCgiY291bnRyeUNvZGVWMiIsIHsKICAgICAgICBhbGlhczogImNvdW50cnlDb2RlIgogICAgICB9KSwgcm9vdC5hZGQoInByb3ZpbmNlQ29kZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dEZyYWdtZW50IiwgIkNoZWNrb3V0IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJyZWFkeSIpLCByb290LmFkZCgicmVxdWlyZXNTaGlwcGluZyIpLCByb290LmFkZCgibm90ZSIpLCByb290LmFkZCgicGF5bWVudER1ZSIpLCByb290LmFkZCgicGF5bWVudER1ZVYyIiwgZnVuY3Rpb24gKHBheW1lbnREdWVWMikgewogICAgICAgIHBheW1lbnREdWVWMi5hZGQoImFtb3VudCIpLCBwYXltZW50RHVlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWJVcmwiKSwgcm9vdC5hZGQoIm9yZGVyU3RhdHVzVXJsIiksIHJvb3QuYWRkKCJ0YXhFeGVtcHQiKSwgcm9vdC5hZGQoInRheGVzSW5jbHVkZWQiKSwgcm9vdC5hZGQoImN1cnJlbmN5Q29kZSIpLCByb290LmFkZCgidG90YWxUYXgiKSwgcm9vdC5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgIHRvdGFsVGF4VjIuYWRkKCJhbW91bnQiKSwgdG90YWxUYXhWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtc1N1YnRvdGFsUHJpY2UiLCBmdW5jdGlvbiAobGluZUl0ZW1zU3VidG90YWxQcmljZSkgewogICAgICAgIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYWRkKCJhbW91bnQiKSwgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2UiKSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICBzdWJ0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgc3VidG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidG90YWxQcmljZSIpLCByb290LmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjb21wbGV0ZWRBdCIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImVtYWlsIiksIHJvb3QuYWRkKCJkaXNjb3VudEFwcGxpY2F0aW9ucyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9ucykgewogICAgICAgIGRpc2NvdW50QXBwbGljYXRpb25zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJhcHBsaWVkR2lmdENhcmRzIiwgZnVuY3Rpb24gKGFwcGxpZWRHaWZ0Q2FyZHMpIHsKICAgICAgICBhcHBsaWVkR2lmdENhcmRzLmFkZEZyYWdtZW50KHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChzaGlwcGluZ0FkZHJlc3MpIHsKICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgfSksIHJvb3QuYWRkKCJzaGlwcGluZ0xpbmUiLCBmdW5jdGlvbiAoc2hpcHBpbmdMaW5lKSB7CiAgICAgICAgc2hpcHBpbmdMaW5lLmFkZCgiaGFuZGxlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHNoaXBwaW5nTGluZS5hZGQoInRpdGxlIik7CiAgICAgIH0pLCByb290LmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJvcmRlciIsIGZ1bmN0aW9uIChvcmRlcikgewogICAgICAgIG9yZGVyLmFkZCgiaWQiKSwgb3JkZXIuYWRkKCJwcm9jZXNzZWRBdCIpLCBvcmRlci5hZGQoIm9yZGVyTnVtYmVyIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2UiKSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFNoaXBwaW5nUHJpY2VWMikgewogICAgICAgICAgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFRheCIpLCBvcmRlci5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJjdXJyZW5jeUNvZGUiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkIiksIG9yZGVyLmFkZCgidG90YWxSZWZ1bmRlZFYyIiwgZnVuY3Rpb24gKHRvdGFsUmVmdW5kZWRWMikgewogICAgICAgICAgdG90YWxSZWZ1bmRlZFYyLmFkZCgiYW1vdW50IiksIHRvdGFsUmVmdW5kZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1c3RvbWVyVXJsIiksIG9yZGVyLmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgICAgc2hpcHBpbmdBZGRyZXNzLmFkZEZyYWdtZW50KHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCk7CiAgICAgICAgfSksIG9yZGVyLmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgICAgYXJnczogewogICAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgICB9CiAgICAgICAgfSwgZnVuY3Rpb24gKGxpbmVJdGVtcykgewogICAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgICAgfSksIGxpbmVJdGVtcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgICAgbm9kZS5hZGQoInRpdGxlIiksIG5vZGUuYWRkKCJ2YXJpYW50IiwgZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgicXVhbnRpdHkiKSwgbm9kZS5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiZGlzY291bnRBbGxvY2F0aW9ucyIsIGZ1bmN0aW9uIChkaXNjb3VudEFsbG9jYXRpb25zKSB7CiAgICAgICAgICAgICAgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImFsbG9jYXRlZEFtb3VudCIsIGZ1bmN0aW9uIChhbGxvY2F0ZWRBbW91bnQpIHsKICAgICAgICAgICAgICAgIGFsbG9jYXRlZEFtb3VudC5hZGQoImFtb3VudCIpLCBhbGxvY2F0ZWRBbW91bnQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgICB9KSwgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoZGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgICAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbi5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZE11dGF0aW9uKCJjaGVja291dEF0dHJpYnV0ZXNVcGRhdGVWMiIsIFt2YXJpYWJsZXMuY2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlVjIuY2hlY2tvdXRJZCwgdmFyaWFibGVzLmNoZWNrb3V0QXR0cmlidXRlc1VwZGF0ZVYyLmlucHV0XSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImNoZWNrb3V0QXR0cmlidXRlc1VwZGF0ZVYyIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGNoZWNrb3V0SWQ6IHZhcmlhYmxlcy5jaGVja291dEF0dHJpYnV0ZXNVcGRhdGVWMi5jaGVja291dElkLAogICAgICAgICAgaW5wdXQ6IHZhcmlhYmxlcy5jaGVja291dEF0dHJpYnV0ZXNVcGRhdGVWMi5pbnB1dAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGNoZWNrb3V0QXR0cmlidXRlc1VwZGF0ZVYyKSB7CiAgICAgICAgY2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlVjIuYWRkKCJ1c2VyRXJyb3JzIiwgZnVuY3Rpb24gKHVzZXJFcnJvcnMpIHsKICAgICAgICAgIHVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5Vc2VyRXJyb3JGcmFnbWVudCk7CiAgICAgICAgfSksIGNoZWNrb3V0QXR0cmlidXRlc1VwZGF0ZVYyLmFkZCgiY2hlY2tvdXRVc2VyRXJyb3JzIiwgZnVuY3Rpb24gKGNoZWNrb3V0VXNlckVycm9ycykgewogICAgICAgICAgY2hlY2tvdXRVc2VyRXJyb3JzLmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCk7CiAgICAgICAgfSksIGNoZWNrb3V0QXR0cmlidXRlc1VwZGF0ZVYyLmFkZCgiY2hlY2tvdXQiLCBmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICAgIGNoZWNrb3V0LmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkMTgoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBjaGVja291dERpc2NvdW50Q29kZUFwcGx5VjI6IHt9CiAgICB9OwogICAgcmV0dXJuIHZhcmlhYmxlcy5jaGVja291dERpc2NvdW50Q29kZUFwcGx5VjIuZGlzY291bnRDb2RlID0gY2xpZW50LnZhcmlhYmxlKCJkaXNjb3VudENvZGUiLCAiU3RyaW5nISIpLCB2YXJpYWJsZXMuY2hlY2tvdXREaXNjb3VudENvZGVBcHBseVYyLmNoZWNrb3V0SWQgPSBjbGllbnQudmFyaWFibGUoImNoZWNrb3V0SWQiLCAiSUQhIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJEaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQiLCAiRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJ0YXJnZXRTZWxlY3Rpb24iKSwgcm9vdC5hZGQoImFsbG9jYXRpb25NZXRob2QiKSwgcm9vdC5hZGQoInRhcmdldFR5cGUiKSwgcm9vdC5hZGQoInZhbHVlIiwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiTW9uZXlWMiIsIGZ1bmN0aW9uIChNb25leVYyKSB7CiAgICAgICAgICBNb25leVYyLmFkZCgiYW1vdW50IiksIE1vbmV5VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSIsIGZ1bmN0aW9uIChQcmljaW5nUGVyY2VudGFnZVZhbHVlKSB7CiAgICAgICAgICBQcmljaW5nUGVyY2VudGFnZVZhbHVlLmFkZCgicGVyY2VudGFnZSIpOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKSwgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkRpc2NvdW50Q29kZUFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKERpc2NvdW50Q29kZUFwcGxpY2F0aW9uKSB7CiAgICAgICAgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJjb2RlIiksIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiYXBwbGljYWJsZSIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQiLCAiQXBwbGllZEdpZnRDYXJkIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImFtb3VudFVzZWRWMiIsIGZ1bmN0aW9uIChhbW91bnRVc2VkVjIpIHsKICAgICAgICBhbW91bnRVc2VkVjIuYWRkKCJhbW91bnQiKSwgYW1vdW50VXNlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiYmFsYW5jZVYyIiwgZnVuY3Rpb24gKGJhbGFuY2VWMikgewogICAgICAgIGJhbGFuY2VWMi5hZGQoImFtb3VudCIpLCBiYWxhbmNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudEFtb3VudFVzZWQiLCBmdW5jdGlvbiAocHJlc2VudG1lbnRBbW91bnRVc2VkKSB7CiAgICAgICAgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiYW1vdW50IiksIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJsYXN0Q2hhcmFjdGVycyIpOwogICAgfSksIHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudEZyYWdtZW50KSwgcm9vdC5hZGQoInByb2R1Y3QiLCBmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgIHByb2R1Y3QuYWRkKCJpZCIpLCBwcm9kdWN0LmFkZCgiaGFuZGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuVXNlckVycm9yRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVXNlckVycm9yRnJhZ21lbnQiLCAiVXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQiLCAiQ2hlY2tvdXRVc2VyRXJyb3IiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiZmllbGQiKSwgcm9vdC5hZGQoIm1lc3NhZ2UiKSwgcm9vdC5hZGQoImNvZGUiKTsKICAgIH0pLCBzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiTWFpbGluZ0FkZHJlc3NGcmFnbWVudCIsICJNYWlsaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYWRkcmVzczEiKSwgcm9vdC5hZGQoImFkZHJlc3MyIiksIHJvb3QuYWRkKCJjaXR5IiksIHJvb3QuYWRkKCJjb21wYW55IiksIHJvb3QuYWRkKCJjb3VudHJ5IiksIHJvb3QuYWRkKCJmaXJzdE5hbWUiKSwgcm9vdC5hZGQoImZvcm1hdHRlZCIpLCByb290LmFkZCgibGFzdE5hbWUiKSwgcm9vdC5hZGQoImxhdGl0dWRlIiksIHJvb3QuYWRkKCJsb25naXR1ZGUiKSwgcm9vdC5hZGQoInBob25lIiksIHJvb3QuYWRkKCJwcm92aW5jZSIpLCByb290LmFkZCgiemlwIiksIHJvb3QuYWRkKCJuYW1lIiksIHJvb3QuYWRkKCJjb3VudHJ5Q29kZVYyIiwgewogICAgICAgIGFsaWFzOiAiY291bnRyeUNvZGUiCiAgICAgIH0pLCByb290LmFkZCgicHJvdmluY2VDb2RlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0RnJhZ21lbnQiLCAiQ2hlY2tvdXQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInJlYWR5IiksIHJvb3QuYWRkKCJyZXF1aXJlc1NoaXBwaW5nIiksIHJvb3QuYWRkKCJub3RlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlVjIiLCBmdW5jdGlvbiAocGF5bWVudER1ZVYyKSB7CiAgICAgICAgcGF5bWVudER1ZVYyLmFkZCgiYW1vdW50IiksIHBheW1lbnREdWVWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIndlYlVybCIpLCByb290LmFkZCgib3JkZXJTdGF0dXNVcmwiKSwgcm9vdC5hZGQoInRheEV4ZW1wdCIpLCByb290LmFkZCgidGF4ZXNJbmNsdWRlZCIpLCByb290LmFkZCgiY3VycmVuY3lDb2RlIiksIHJvb3QuYWRkKCJ0b3RhbFRheCIpLCByb290LmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zU3VidG90YWxQcmljZSIsIGZ1bmN0aW9uIChsaW5lSXRlbXNTdWJ0b3RhbFByaWNlKSB7CiAgICAgICAgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImFtb3VudCIpLCBsaW5lSXRlbXNTdWJ0b3RhbFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgic3VidG90YWxQcmljZSIpLCByb290LmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ0b3RhbFByaWNlIiksIHJvb3QuYWRkKCJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxQcmljZVYyKSB7CiAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImNvbXBsZXRlZEF0IiksIHJvb3QuYWRkKCJjcmVhdGVkQXQiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgiZW1haWwiKSwgcm9vdC5hZGQoImRpc2NvdW50QXBwbGljYXRpb25zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAxMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGRpc2NvdW50QXBwbGljYXRpb25zKSB7CiAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBkaXNjb3VudEFwcGxpY2F0aW9ucy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImFwcGxpZWRHaWZ0Q2FyZHMiLCBmdW5jdGlvbiAoYXBwbGllZEdpZnRDYXJkcykgewogICAgICAgIGFwcGxpZWRHaWZ0Q2FyZHMuYWRkRnJhZ21lbnQoc3ByZWFkcy5BcHBsaWVkR2lmdENhcmRGcmFnbWVudCk7CiAgICAgIH0pLCByb290LmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgIHNoaXBwaW5nQWRkcmVzcy5hZGRGcmFnbWVudChzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nTGluZSIsIGZ1bmN0aW9uIChzaGlwcGluZ0xpbmUpIHsKICAgICAgICBzaGlwcGluZ0xpbmUuYWRkKCJoYW5kbGUiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2UiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgc2hpcHBpbmdMaW5lLmFkZCgidGl0bGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIm9yZGVyIiwgZnVuY3Rpb24gKG9yZGVyKSB7CiAgICAgICAgb3JkZXIuYWRkKCJpZCIpLCBvcmRlci5hZGQoInByb2Nlc3NlZEF0IiksIG9yZGVyLmFkZCgib3JkZXJOdW1iZXIiKSwgb3JkZXIuYWRkKCJzdWJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgICAgc3VidG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHN1YnRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsU2hpcHBpbmdQcmljZVYyKSB7CiAgICAgICAgICB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsVGF4IiksIG9yZGVyLmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgICB0b3RhbFRheFYyLmFkZCgiYW1vdW50IiksIHRvdGFsVGF4VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1cnJlbmN5Q29kZSIpLCBvcmRlci5hZGQoInRvdGFsUmVmdW5kZWQiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkVjIiLCBmdW5jdGlvbiAodG90YWxSZWZ1bmRlZFYyKSB7CiAgICAgICAgICB0b3RhbFJlZnVuZGVkVjIuYWRkKCJhbW91bnQiKSwgdG90YWxSZWZ1bmRlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgiY3VzdG9tZXJVcmwiKSwgb3JkZXIuYWRkKCJzaGlwcGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAoc2hpcHBpbmdBZGRyZXNzKSB7CiAgICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJsaW5lSXRlbXMiLCB7CiAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICAgIH0KICAgICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgICB9KSwgbm9kZS5hZGQoInF1YW50aXR5IiksIG5vZGUuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChsaW5lSXRlbXMpIHsKICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBsaW5lSXRlbXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoImlkIiksIG5vZGUuYWRkKCJ0aXRsZSIpLCBub2RlLmFkZCgidmFyaWFudCIsIGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJkaXNjb3VudEFsbG9jYXRpb25zIiwgZnVuY3Rpb24gKGRpc2NvdW50QWxsb2NhdGlvbnMpIHsKICAgICAgICAgICAgICBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiYWxsb2NhdGVkQW1vdW50IiwgZnVuY3Rpb24gKGFsbG9jYXRlZEFtb3VudCkgewogICAgICAgICAgICAgICAgYWxsb2NhdGVkQW1vdW50LmFkZCgiYW1vdW50IiksIGFsbG9jYXRlZEFtb3VudC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICAgIH0pLCBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiZGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgICAgICAgICBkaXNjb3VudEFwcGxpY2F0aW9uLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQuYWRkTXV0YXRpb24oImNoZWNrb3V0RGlzY291bnRDb2RlQXBwbHlWMiIsIFt2YXJpYWJsZXMuY2hlY2tvdXREaXNjb3VudENvZGVBcHBseVYyLmRpc2NvdW50Q29kZSwgdmFyaWFibGVzLmNoZWNrb3V0RGlzY291bnRDb2RlQXBwbHlWMi5jaGVja291dElkXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImNoZWNrb3V0RGlzY291bnRDb2RlQXBwbHlWMiIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBkaXNjb3VudENvZGU6IHZhcmlhYmxlcy5jaGVja291dERpc2NvdW50Q29kZUFwcGx5VjIuZGlzY291bnRDb2RlLAogICAgICAgICAgY2hlY2tvdXRJZDogdmFyaWFibGVzLmNoZWNrb3V0RGlzY291bnRDb2RlQXBwbHlWMi5jaGVja291dElkCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoY2hlY2tvdXREaXNjb3VudENvZGVBcHBseVYyKSB7CiAgICAgICAgY2hlY2tvdXREaXNjb3VudENvZGVBcHBseVYyLmFkZCgidXNlckVycm9ycyIsIGZ1bmN0aW9uICh1c2VyRXJyb3JzKSB7CiAgICAgICAgICB1c2VyRXJyb3JzLmFkZEZyYWdtZW50KHNwcmVhZHMuVXNlckVycm9yRnJhZ21lbnQpOwogICAgICAgIH0pLCBjaGVja291dERpc2NvdW50Q29kZUFwcGx5VjIuYWRkKCJjaGVja291dFVzZXJFcnJvcnMiLCBmdW5jdGlvbiAoY2hlY2tvdXRVc2VyRXJyb3JzKSB7CiAgICAgICAgICBjaGVja291dFVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXREaXNjb3VudENvZGVBcHBseVYyLmFkZCgiY2hlY2tvdXQiLCBmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICAgIGNoZWNrb3V0LmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkMTkoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBjaGVja291dERpc2NvdW50Q29kZVJlbW92ZToge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLmNoZWNrb3V0RGlzY291bnRDb2RlUmVtb3ZlLmNoZWNrb3V0SWQgPSBjbGllbnQudmFyaWFibGUoImNoZWNrb3V0SWQiLCAiSUQhIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJEaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQiLCAiRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJ0YXJnZXRTZWxlY3Rpb24iKSwgcm9vdC5hZGQoImFsbG9jYXRpb25NZXRob2QiKSwgcm9vdC5hZGQoInRhcmdldFR5cGUiKSwgcm9vdC5hZGQoInZhbHVlIiwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiTW9uZXlWMiIsIGZ1bmN0aW9uIChNb25leVYyKSB7CiAgICAgICAgICBNb25leVYyLmFkZCgiYW1vdW50IiksIE1vbmV5VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSIsIGZ1bmN0aW9uIChQcmljaW5nUGVyY2VudGFnZVZhbHVlKSB7CiAgICAgICAgICBQcmljaW5nUGVyY2VudGFnZVZhbHVlLmFkZCgicGVyY2VudGFnZSIpOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKSwgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkRpc2NvdW50Q29kZUFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKERpc2NvdW50Q29kZUFwcGxpY2F0aW9uKSB7CiAgICAgICAgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJjb2RlIiksIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiYXBwbGljYWJsZSIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQiLCAiQXBwbGllZEdpZnRDYXJkIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImFtb3VudFVzZWRWMiIsIGZ1bmN0aW9uIChhbW91bnRVc2VkVjIpIHsKICAgICAgICBhbW91bnRVc2VkVjIuYWRkKCJhbW91bnQiKSwgYW1vdW50VXNlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiYmFsYW5jZVYyIiwgZnVuY3Rpb24gKGJhbGFuY2VWMikgewogICAgICAgIGJhbGFuY2VWMi5hZGQoImFtb3VudCIpLCBiYWxhbmNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudEFtb3VudFVzZWQiLCBmdW5jdGlvbiAocHJlc2VudG1lbnRBbW91bnRVc2VkKSB7CiAgICAgICAgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiYW1vdW50IiksIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJsYXN0Q2hhcmFjdGVycyIpOwogICAgfSksIHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudEZyYWdtZW50KSwgcm9vdC5hZGQoInByb2R1Y3QiLCBmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgIHByb2R1Y3QuYWRkKCJpZCIpLCBwcm9kdWN0LmFkZCgiaGFuZGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuVXNlckVycm9yRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVXNlckVycm9yRnJhZ21lbnQiLCAiVXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQiLCAiQ2hlY2tvdXRVc2VyRXJyb3IiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiZmllbGQiKSwgcm9vdC5hZGQoIm1lc3NhZ2UiKSwgcm9vdC5hZGQoImNvZGUiKTsKICAgIH0pLCBzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiTWFpbGluZ0FkZHJlc3NGcmFnbWVudCIsICJNYWlsaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYWRkcmVzczEiKSwgcm9vdC5hZGQoImFkZHJlc3MyIiksIHJvb3QuYWRkKCJjaXR5IiksIHJvb3QuYWRkKCJjb21wYW55IiksIHJvb3QuYWRkKCJjb3VudHJ5IiksIHJvb3QuYWRkKCJmaXJzdE5hbWUiKSwgcm9vdC5hZGQoImZvcm1hdHRlZCIpLCByb290LmFkZCgibGFzdE5hbWUiKSwgcm9vdC5hZGQoImxhdGl0dWRlIiksIHJvb3QuYWRkKCJsb25naXR1ZGUiKSwgcm9vdC5hZGQoInBob25lIiksIHJvb3QuYWRkKCJwcm92aW5jZSIpLCByb290LmFkZCgiemlwIiksIHJvb3QuYWRkKCJuYW1lIiksIHJvb3QuYWRkKCJjb3VudHJ5Q29kZVYyIiwgewogICAgICAgIGFsaWFzOiAiY291bnRyeUNvZGUiCiAgICAgIH0pLCByb290LmFkZCgicHJvdmluY2VDb2RlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0RnJhZ21lbnQiLCAiQ2hlY2tvdXQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInJlYWR5IiksIHJvb3QuYWRkKCJyZXF1aXJlc1NoaXBwaW5nIiksIHJvb3QuYWRkKCJub3RlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlVjIiLCBmdW5jdGlvbiAocGF5bWVudER1ZVYyKSB7CiAgICAgICAgcGF5bWVudER1ZVYyLmFkZCgiYW1vdW50IiksIHBheW1lbnREdWVWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIndlYlVybCIpLCByb290LmFkZCgib3JkZXJTdGF0dXNVcmwiKSwgcm9vdC5hZGQoInRheEV4ZW1wdCIpLCByb290LmFkZCgidGF4ZXNJbmNsdWRlZCIpLCByb290LmFkZCgiY3VycmVuY3lDb2RlIiksIHJvb3QuYWRkKCJ0b3RhbFRheCIpLCByb290LmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zU3VidG90YWxQcmljZSIsIGZ1bmN0aW9uIChsaW5lSXRlbXNTdWJ0b3RhbFByaWNlKSB7CiAgICAgICAgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImFtb3VudCIpLCBsaW5lSXRlbXNTdWJ0b3RhbFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgic3VidG90YWxQcmljZSIpLCByb290LmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ0b3RhbFByaWNlIiksIHJvb3QuYWRkKCJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxQcmljZVYyKSB7CiAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImNvbXBsZXRlZEF0IiksIHJvb3QuYWRkKCJjcmVhdGVkQXQiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgiZW1haWwiKSwgcm9vdC5hZGQoImRpc2NvdW50QXBwbGljYXRpb25zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAxMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGRpc2NvdW50QXBwbGljYXRpb25zKSB7CiAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBkaXNjb3VudEFwcGxpY2F0aW9ucy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImFwcGxpZWRHaWZ0Q2FyZHMiLCBmdW5jdGlvbiAoYXBwbGllZEdpZnRDYXJkcykgewogICAgICAgIGFwcGxpZWRHaWZ0Q2FyZHMuYWRkRnJhZ21lbnQoc3ByZWFkcy5BcHBsaWVkR2lmdENhcmRGcmFnbWVudCk7CiAgICAgIH0pLCByb290LmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgIHNoaXBwaW5nQWRkcmVzcy5hZGRGcmFnbWVudChzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nTGluZSIsIGZ1bmN0aW9uIChzaGlwcGluZ0xpbmUpIHsKICAgICAgICBzaGlwcGluZ0xpbmUuYWRkKCJoYW5kbGUiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2UiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgc2hpcHBpbmdMaW5lLmFkZCgidGl0bGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIm9yZGVyIiwgZnVuY3Rpb24gKG9yZGVyKSB7CiAgICAgICAgb3JkZXIuYWRkKCJpZCIpLCBvcmRlci5hZGQoInByb2Nlc3NlZEF0IiksIG9yZGVyLmFkZCgib3JkZXJOdW1iZXIiKSwgb3JkZXIuYWRkKCJzdWJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgICAgc3VidG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHN1YnRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsU2hpcHBpbmdQcmljZVYyKSB7CiAgICAgICAgICB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsVGF4IiksIG9yZGVyLmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgICB0b3RhbFRheFYyLmFkZCgiYW1vdW50IiksIHRvdGFsVGF4VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1cnJlbmN5Q29kZSIpLCBvcmRlci5hZGQoInRvdGFsUmVmdW5kZWQiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkVjIiLCBmdW5jdGlvbiAodG90YWxSZWZ1bmRlZFYyKSB7CiAgICAgICAgICB0b3RhbFJlZnVuZGVkVjIuYWRkKCJhbW91bnQiKSwgdG90YWxSZWZ1bmRlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgiY3VzdG9tZXJVcmwiKSwgb3JkZXIuYWRkKCJzaGlwcGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAoc2hpcHBpbmdBZGRyZXNzKSB7CiAgICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJsaW5lSXRlbXMiLCB7CiAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICAgIH0KICAgICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgICB9KSwgbm9kZS5hZGQoInF1YW50aXR5IiksIG5vZGUuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChsaW5lSXRlbXMpIHsKICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBsaW5lSXRlbXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoImlkIiksIG5vZGUuYWRkKCJ0aXRsZSIpLCBub2RlLmFkZCgidmFyaWFudCIsIGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJkaXNjb3VudEFsbG9jYXRpb25zIiwgZnVuY3Rpb24gKGRpc2NvdW50QWxsb2NhdGlvbnMpIHsKICAgICAgICAgICAgICBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiYWxsb2NhdGVkQW1vdW50IiwgZnVuY3Rpb24gKGFsbG9jYXRlZEFtb3VudCkgewogICAgICAgICAgICAgICAgYWxsb2NhdGVkQW1vdW50LmFkZCgiYW1vdW50IiksIGFsbG9jYXRlZEFtb3VudC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICAgIH0pLCBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiZGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgICAgICAgICBkaXNjb3VudEFwcGxpY2F0aW9uLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQuYWRkTXV0YXRpb24oImNoZWNrb3V0RGlzY291bnRDb2RlUmVtb3ZlIiwgW3ZhcmlhYmxlcy5jaGVja291dERpc2NvdW50Q29kZVJlbW92ZS5jaGVja291dElkXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImNoZWNrb3V0RGlzY291bnRDb2RlUmVtb3ZlIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGNoZWNrb3V0SWQ6IHZhcmlhYmxlcy5jaGVja291dERpc2NvdW50Q29kZVJlbW92ZS5jaGVja291dElkCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoY2hlY2tvdXREaXNjb3VudENvZGVSZW1vdmUpIHsKICAgICAgICBjaGVja291dERpc2NvdW50Q29kZVJlbW92ZS5hZGQoInVzZXJFcnJvcnMiLCBmdW5jdGlvbiAodXNlckVycm9ycykgewogICAgICAgICAgdXNlckVycm9ycy5hZGRGcmFnbWVudChzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXREaXNjb3VudENvZGVSZW1vdmUuYWRkKCJjaGVja291dFVzZXJFcnJvcnMiLCBmdW5jdGlvbiAoY2hlY2tvdXRVc2VyRXJyb3JzKSB7CiAgICAgICAgICBjaGVja291dFVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXREaXNjb3VudENvZGVSZW1vdmUuYWRkKCJjaGVja291dCIsIGZ1bmN0aW9uIChjaGVja291dCkgewogICAgICAgICAgY2hlY2tvdXQuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dEZyYWdtZW50KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBxdWVyeSQyMChjbGllbnQpIHsKICAgIHZhciBkb2N1bWVudCA9IGNsaWVudC5kb2N1bWVudCgpLAogICAgICAgIHNwcmVhZHMgPSB7fSwKICAgICAgICB2YXJpYWJsZXMgPSB7CiAgICAgIGNoZWNrb3V0R2lmdENhcmRzQXBwZW5kOiB7fQogICAgfTsKICAgIHJldHVybiB2YXJpYWJsZXMuY2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmQuZ2lmdENhcmRDb2RlcyA9IGNsaWVudC52YXJpYWJsZSgiZ2lmdENhcmRDb2RlcyIsICJbU3RyaW5nIV0hIiksIHZhcmlhYmxlcy5jaGVja291dEdpZnRDYXJkc0FwcGVuZC5jaGVja291dElkID0gY2xpZW50LnZhcmlhYmxlKCJjaGVja291dElkIiwgIklEISIpLCBzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJWYXJpYW50RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJwcmljZSIpLCByb290LmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgicHJlc2VudG1lbnRQcmljZXMiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZmlyc3Q6IDIwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAocHJlc2VudG1lbnRQcmljZXMpIHsKICAgICAgICBwcmVzZW50bWVudFByaWNlcy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHByZXNlbnRtZW50UHJpY2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJwcmljZSIsIGZ1bmN0aW9uIChwcmljZSkgewogICAgICAgICAgICAgIHByaWNlLmFkZCgiYW1vdW50IiksIHByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiY29tcGFyZUF0UHJpY2UiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2UpIHsKICAgICAgICAgICAgICBjb21wYXJlQXRQcmljZS5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoIndlaWdodCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIsIHsKICAgICAgICBhbGlhczogImF2YWlsYWJsZSIKICAgICAgfSksIHJvb3QuYWRkKCJza3UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlIiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZVYyIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlVjIpIHsKICAgICAgICBjb21wYXJlQXRQcmljZVYyLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJpbWFnZSIsIGZ1bmN0aW9uIChpbWFnZSkgewogICAgICAgIGltYWdlLmFkZCgiaWQiKSwgaW1hZ2UuYWRkKCJvcmlnaW5hbFNyYyIsIHsKICAgICAgICAgIGFsaWFzOiAic3JjIgogICAgICAgIH0pLCBpbWFnZS5hZGQoImFsdFRleHQiKTsKICAgICAgfSksIHJvb3QuYWRkKCJzZWxlY3RlZE9wdGlvbnMiLCBmdW5jdGlvbiAoc2VsZWN0ZWRPcHRpb25zKSB7CiAgICAgICAgc2VsZWN0ZWRPcHRpb25zLmFkZCgibmFtZSIpLCBzZWxlY3RlZE9wdGlvbnMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZSIsIGZ1bmN0aW9uICh1bml0UHJpY2UpIHsKICAgICAgICB1bml0UHJpY2UuYWRkKCJhbW91bnQiKSwgdW5pdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlTWVhc3VyZW1lbnQiLCBmdW5jdGlvbiAodW5pdFByaWNlTWVhc3VyZW1lbnQpIHsKICAgICAgICB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoIm1lYXN1cmVkVHlwZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInF1YW50aXR5VW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInF1YW50aXR5VmFsdWUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVmFsdWUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5EaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50IiwgIkRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgidGFyZ2V0U2VsZWN0aW9uIiksIHJvb3QuYWRkKCJhbGxvY2F0aW9uTWV0aG9kIiksIHJvb3QuYWRkKCJ0YXJnZXRUeXBlIiksIHJvb3QuYWRkKCJ2YWx1ZSIsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHZhbHVlLmFkZElubGluZUZyYWdtZW50T24oIk1vbmV5VjIiLCBmdW5jdGlvbiAoTW9uZXlWMikgewogICAgICAgICAgTW9uZXlWMi5hZGQoImFtb3VudCIpLCBNb25leVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHZhbHVlLmFkZElubGluZUZyYWdtZW50T24oIlByaWNpbmdQZXJjZW50YWdlVmFsdWUiLCBmdW5jdGlvbiAoUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSkgewogICAgICAgICAgUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZS5hZGQoInBlcmNlbnRhZ2UiKTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIiksIE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJkZXNjcmlwdGlvbiIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJEaXNjb3VudENvZGVBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChEaXNjb3VudENvZGVBcHBsaWNhdGlvbikgewogICAgICAgIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiY29kZSIpLCBEaXNjb3VudENvZGVBcHBsaWNhdGlvbi5hZGQoImFwcGxpY2FibGUiKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIEF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24uYWRkKCJ0aXRsZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50IiwgIkFwcGxpZWRHaWZ0Q2FyZCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJhbW91bnRVc2VkVjIiLCBmdW5jdGlvbiAoYW1vdW50VXNlZFYyKSB7CiAgICAgICAgYW1vdW50VXNlZFYyLmFkZCgiYW1vdW50IiksIGFtb3VudFVzZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImJhbGFuY2VWMiIsIGZ1bmN0aW9uIChiYWxhbmNlVjIpIHsKICAgICAgICBiYWxhbmNlVjIuYWRkKCJhbW91bnQiKSwgYmFsYW5jZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgicHJlc2VudG1lbnRBbW91bnRVc2VkIiwgZnVuY3Rpb24gKHByZXNlbnRtZW50QW1vdW50VXNlZCkgewogICAgICAgIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImFtb3VudCIpLCBwcmVzZW50bWVudEFtb3VudFVzZWQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgibGFzdENoYXJhY3RlcnMiKTsKICAgIH0pLCBzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCksIHJvb3QuYWRkKCJwcm9kdWN0IiwgZnVuY3Rpb24gKHByb2R1Y3QpIHsKICAgICAgICBwcm9kdWN0LmFkZCgiaWQiKSwgcHJvZHVjdC5hZGQoImhhbmRsZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlVzZXJFcnJvckZyYWdtZW50IiwgIlVzZXJFcnJvciIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJmaWVsZCIpLCByb290LmFkZCgibWVzc2FnZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dFVzZXJFcnJvckZyYWdtZW50IiwgIkNoZWNrb3V0VXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIiksIHJvb3QuYWRkKCJjb2RlIik7CiAgICB9KSwgc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIk1haWxpbmdBZGRyZXNzRnJhZ21lbnQiLCAiTWFpbGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImFkZHJlc3MxIiksIHJvb3QuYWRkKCJhZGRyZXNzMiIpLCByb290LmFkZCgiY2l0eSIpLCByb290LmFkZCgiY29tcGFueSIpLCByb290LmFkZCgiY291bnRyeSIpLCByb290LmFkZCgiZmlyc3ROYW1lIiksIHJvb3QuYWRkKCJmb3JtYXR0ZWQiKSwgcm9vdC5hZGQoImxhc3ROYW1lIiksIHJvb3QuYWRkKCJsYXRpdHVkZSIpLCByb290LmFkZCgibG9uZ2l0dWRlIiksIHJvb3QuYWRkKCJwaG9uZSIpLCByb290LmFkZCgicHJvdmluY2UiKSwgcm9vdC5hZGQoInppcCIpLCByb290LmFkZCgibmFtZSIpLCByb290LmFkZCgiY291bnRyeUNvZGVWMiIsIHsKICAgICAgICBhbGlhczogImNvdW50cnlDb2RlIgogICAgICB9KSwgcm9vdC5hZGQoInByb3ZpbmNlQ29kZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dEZyYWdtZW50IiwgIkNoZWNrb3V0IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJyZWFkeSIpLCByb290LmFkZCgicmVxdWlyZXNTaGlwcGluZyIpLCByb290LmFkZCgibm90ZSIpLCByb290LmFkZCgicGF5bWVudER1ZSIpLCByb290LmFkZCgicGF5bWVudER1ZVYyIiwgZnVuY3Rpb24gKHBheW1lbnREdWVWMikgewogICAgICAgIHBheW1lbnREdWVWMi5hZGQoImFtb3VudCIpLCBwYXltZW50RHVlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWJVcmwiKSwgcm9vdC5hZGQoIm9yZGVyU3RhdHVzVXJsIiksIHJvb3QuYWRkKCJ0YXhFeGVtcHQiKSwgcm9vdC5hZGQoInRheGVzSW5jbHVkZWQiKSwgcm9vdC5hZGQoImN1cnJlbmN5Q29kZSIpLCByb290LmFkZCgidG90YWxUYXgiKSwgcm9vdC5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgIHRvdGFsVGF4VjIuYWRkKCJhbW91bnQiKSwgdG90YWxUYXhWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtc1N1YnRvdGFsUHJpY2UiLCBmdW5jdGlvbiAobGluZUl0ZW1zU3VidG90YWxQcmljZSkgewogICAgICAgIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYWRkKCJhbW91bnQiKSwgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2UiKSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICBzdWJ0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgc3VidG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidG90YWxQcmljZSIpLCByb290LmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjb21wbGV0ZWRBdCIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImVtYWlsIiksIHJvb3QuYWRkKCJkaXNjb3VudEFwcGxpY2F0aW9ucyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9ucykgewogICAgICAgIGRpc2NvdW50QXBwbGljYXRpb25zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJhcHBsaWVkR2lmdENhcmRzIiwgZnVuY3Rpb24gKGFwcGxpZWRHaWZ0Q2FyZHMpIHsKICAgICAgICBhcHBsaWVkR2lmdENhcmRzLmFkZEZyYWdtZW50KHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChzaGlwcGluZ0FkZHJlc3MpIHsKICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgfSksIHJvb3QuYWRkKCJzaGlwcGluZ0xpbmUiLCBmdW5jdGlvbiAoc2hpcHBpbmdMaW5lKSB7CiAgICAgICAgc2hpcHBpbmdMaW5lLmFkZCgiaGFuZGxlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHNoaXBwaW5nTGluZS5hZGQoInRpdGxlIik7CiAgICAgIH0pLCByb290LmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJvcmRlciIsIGZ1bmN0aW9uIChvcmRlcikgewogICAgICAgIG9yZGVyLmFkZCgiaWQiKSwgb3JkZXIuYWRkKCJwcm9jZXNzZWRBdCIpLCBvcmRlci5hZGQoIm9yZGVyTnVtYmVyIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2UiKSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFNoaXBwaW5nUHJpY2VWMikgewogICAgICAgICAgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFRheCIpLCBvcmRlci5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJjdXJyZW5jeUNvZGUiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkIiksIG9yZGVyLmFkZCgidG90YWxSZWZ1bmRlZFYyIiwgZnVuY3Rpb24gKHRvdGFsUmVmdW5kZWRWMikgewogICAgICAgICAgdG90YWxSZWZ1bmRlZFYyLmFkZCgiYW1vdW50IiksIHRvdGFsUmVmdW5kZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1c3RvbWVyVXJsIiksIG9yZGVyLmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgICAgc2hpcHBpbmdBZGRyZXNzLmFkZEZyYWdtZW50KHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCk7CiAgICAgICAgfSksIG9yZGVyLmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgICAgYXJnczogewogICAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgICB9CiAgICAgICAgfSwgZnVuY3Rpb24gKGxpbmVJdGVtcykgewogICAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgICAgfSksIGxpbmVJdGVtcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgICAgbm9kZS5hZGQoInRpdGxlIiksIG5vZGUuYWRkKCJ2YXJpYW50IiwgZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgicXVhbnRpdHkiKSwgbm9kZS5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiZGlzY291bnRBbGxvY2F0aW9ucyIsIGZ1bmN0aW9uIChkaXNjb3VudEFsbG9jYXRpb25zKSB7CiAgICAgICAgICAgICAgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImFsbG9jYXRlZEFtb3VudCIsIGZ1bmN0aW9uIChhbGxvY2F0ZWRBbW91bnQpIHsKICAgICAgICAgICAgICAgIGFsbG9jYXRlZEFtb3VudC5hZGQoImFtb3VudCIpLCBhbGxvY2F0ZWRBbW91bnQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgICB9KSwgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoZGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgICAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbi5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZE11dGF0aW9uKCJjaGVja291dEdpZnRDYXJkc0FwcGVuZCIsIFt2YXJpYWJsZXMuY2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmQuZ2lmdENhcmRDb2RlcywgdmFyaWFibGVzLmNoZWNrb3V0R2lmdENhcmRzQXBwZW5kLmNoZWNrb3V0SWRdLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiY2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmQiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZ2lmdENhcmRDb2RlczogdmFyaWFibGVzLmNoZWNrb3V0R2lmdENhcmRzQXBwZW5kLmdpZnRDYXJkQ29kZXMsCiAgICAgICAgICBjaGVja291dElkOiB2YXJpYWJsZXMuY2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmQuY2hlY2tvdXRJZAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGNoZWNrb3V0R2lmdENhcmRzQXBwZW5kKSB7CiAgICAgICAgY2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmQuYWRkKCJ1c2VyRXJyb3JzIiwgZnVuY3Rpb24gKHVzZXJFcnJvcnMpIHsKICAgICAgICAgIHVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5Vc2VyRXJyb3JGcmFnbWVudCk7CiAgICAgICAgfSksIGNoZWNrb3V0R2lmdENhcmRzQXBwZW5kLmFkZCgiY2hlY2tvdXRVc2VyRXJyb3JzIiwgZnVuY3Rpb24gKGNoZWNrb3V0VXNlckVycm9ycykgewogICAgICAgICAgY2hlY2tvdXRVc2VyRXJyb3JzLmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCk7CiAgICAgICAgfSksIGNoZWNrb3V0R2lmdENhcmRzQXBwZW5kLmFkZCgiY2hlY2tvdXQiLCBmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICAgIGNoZWNrb3V0LmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkMjEoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBjaGVja291dEdpZnRDYXJkUmVtb3ZlVjI6IHt9CiAgICB9OwogICAgcmV0dXJuIHZhcmlhYmxlcy5jaGVja291dEdpZnRDYXJkUmVtb3ZlVjIuYXBwbGllZEdpZnRDYXJkSWQgPSBjbGllbnQudmFyaWFibGUoImFwcGxpZWRHaWZ0Q2FyZElkIiwgIklEISIpLCB2YXJpYWJsZXMuY2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyLmNoZWNrb3V0SWQgPSBjbGllbnQudmFyaWFibGUoImNoZWNrb3V0SWQiLCAiSUQhIiksIHNwcmVhZHMuVmFyaWFudEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgidGl0bGUiKSwgcm9vdC5hZGQoInByaWNlIiksIHJvb3QuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudFByaWNlcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChwcmVzZW50bWVudFByaWNlcykgewogICAgICAgIHByZXNlbnRtZW50UHJpY2VzLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoInByaWNlIiwgZnVuY3Rpb24gKHByaWNlKSB7CiAgICAgICAgICAgICAgcHJpY2UuYWRkKCJhbW91bnQiKSwgcHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJjb21wYXJlQXRQcmljZSIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZSkgewogICAgICAgICAgICAgIGNvbXBhcmVBdFByaWNlLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgid2VpZ2h0IiksIHJvb3QuYWRkKCJhdmFpbGFibGVGb3JTYWxlIiwgewogICAgICAgIGFsaWFzOiAiYXZhaWxhYmxlIgogICAgICB9KSwgcm9vdC5hZGQoInNrdSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlVjIiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2VWMikgewogICAgICAgIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImltYWdlIiwgZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgaW1hZ2UuYWRkKCJpZCIpLCBpbWFnZS5hZGQoIm9yaWdpbmFsU3JjIiwgewogICAgICAgICAgYWxpYXM6ICJzcmMiCiAgICAgICAgfSksIGltYWdlLmFkZCgiYWx0VGV4dCIpOwogICAgICB9KSwgcm9vdC5hZGQoInNlbGVjdGVkT3B0aW9ucyIsIGZ1bmN0aW9uIChzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICBzZWxlY3RlZE9wdGlvbnMuYWRkKCJuYW1lIiksIHNlbGVjdGVkT3B0aW9ucy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlIiwgZnVuY3Rpb24gKHVuaXRQcmljZSkgewogICAgICAgIHVuaXRQcmljZS5hZGQoImFtb3VudCIpLCB1bml0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2VNZWFzdXJlbWVudCIsIGZ1bmN0aW9uICh1bml0UHJpY2VNZWFzdXJlbWVudCkgewogICAgICAgIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgibWVhc3VyZWRUeXBlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicXVhbnRpdHlWYWx1ZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VWYWx1ZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJEaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQiLCAiRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJ0YXJnZXRTZWxlY3Rpb24iKSwgcm9vdC5hZGQoImFsbG9jYXRpb25NZXRob2QiKSwgcm9vdC5hZGQoInRhcmdldFR5cGUiKSwgcm9vdC5hZGQoInZhbHVlIiwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiTW9uZXlWMiIsIGZ1bmN0aW9uIChNb25leVYyKSB7CiAgICAgICAgICBNb25leVYyLmFkZCgiYW1vdW50IiksIE1vbmV5VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgdmFsdWUuYWRkSW5saW5lRnJhZ21lbnRPbigiUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSIsIGZ1bmN0aW9uIChQcmljaW5nUGVyY2VudGFnZVZhbHVlKSB7CiAgICAgICAgICBQcmljaW5nUGVyY2VudGFnZVZhbHVlLmFkZCgicGVyY2VudGFnZSIpOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKSwgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkRpc2NvdW50Q29kZUFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKERpc2NvdW50Q29kZUFwcGxpY2F0aW9uKSB7CiAgICAgICAgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJjb2RlIiksIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiYXBwbGljYWJsZSIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQiLCAiQXBwbGllZEdpZnRDYXJkIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImFtb3VudFVzZWRWMiIsIGZ1bmN0aW9uIChhbW91bnRVc2VkVjIpIHsKICAgICAgICBhbW91bnRVc2VkVjIuYWRkKCJhbW91bnQiKSwgYW1vdW50VXNlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiYmFsYW5jZVYyIiwgZnVuY3Rpb24gKGJhbGFuY2VWMikgewogICAgICAgIGJhbGFuY2VWMi5hZGQoImFtb3VudCIpLCBiYWxhbmNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJwcmVzZW50bWVudEFtb3VudFVzZWQiLCBmdW5jdGlvbiAocHJlc2VudG1lbnRBbW91bnRVc2VkKSB7CiAgICAgICAgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiYW1vdW50IiksIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJsYXN0Q2hhcmFjdGVycyIpOwogICAgfSksIHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudEZyYWdtZW50KSwgcm9vdC5hZGQoInByb2R1Y3QiLCBmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgIHByb2R1Y3QuYWRkKCJpZCIpLCBwcm9kdWN0LmFkZCgiaGFuZGxlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuVXNlckVycm9yRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVXNlckVycm9yRnJhZ21lbnQiLCAiVXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQiLCAiQ2hlY2tvdXRVc2VyRXJyb3IiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiZmllbGQiKSwgcm9vdC5hZGQoIm1lc3NhZ2UiKSwgcm9vdC5hZGQoImNvZGUiKTsKICAgIH0pLCBzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiTWFpbGluZ0FkZHJlc3NGcmFnbWVudCIsICJNYWlsaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgiYWRkcmVzczEiKSwgcm9vdC5hZGQoImFkZHJlc3MyIiksIHJvb3QuYWRkKCJjaXR5IiksIHJvb3QuYWRkKCJjb21wYW55IiksIHJvb3QuYWRkKCJjb3VudHJ5IiksIHJvb3QuYWRkKCJmaXJzdE5hbWUiKSwgcm9vdC5hZGQoImZvcm1hdHRlZCIpLCByb290LmFkZCgibGFzdE5hbWUiKSwgcm9vdC5hZGQoImxhdGl0dWRlIiksIHJvb3QuYWRkKCJsb25naXR1ZGUiKSwgcm9vdC5hZGQoInBob25lIiksIHJvb3QuYWRkKCJwcm92aW5jZSIpLCByb290LmFkZCgiemlwIiksIHJvb3QuYWRkKCJuYW1lIiksIHJvb3QuYWRkKCJjb3VudHJ5Q29kZVYyIiwgewogICAgICAgIGFsaWFzOiAiY291bnRyeUNvZGUiCiAgICAgIH0pLCByb290LmFkZCgicHJvdmluY2VDb2RlIik7CiAgICB9KSwgc3ByZWFkcy5DaGVja291dEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkNoZWNrb3V0RnJhZ21lbnQiLCAiQ2hlY2tvdXQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInJlYWR5IiksIHJvb3QuYWRkKCJyZXF1aXJlc1NoaXBwaW5nIiksIHJvb3QuYWRkKCJub3RlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlIiksIHJvb3QuYWRkKCJwYXltZW50RHVlVjIiLCBmdW5jdGlvbiAocGF5bWVudER1ZVYyKSB7CiAgICAgICAgcGF5bWVudER1ZVYyLmFkZCgiYW1vdW50IiksIHBheW1lbnREdWVWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIndlYlVybCIpLCByb290LmFkZCgib3JkZXJTdGF0dXNVcmwiKSwgcm9vdC5hZGQoInRheEV4ZW1wdCIpLCByb290LmFkZCgidGF4ZXNJbmNsdWRlZCIpLCByb290LmFkZCgiY3VycmVuY3lDb2RlIiksIHJvb3QuYWRkKCJ0b3RhbFRheCIpLCByb290LmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zU3VidG90YWxQcmljZSIsIGZ1bmN0aW9uIChsaW5lSXRlbXNTdWJ0b3RhbFByaWNlKSB7CiAgICAgICAgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImFtb3VudCIpLCBsaW5lSXRlbXNTdWJ0b3RhbFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgic3VidG90YWxQcmljZSIpLCByb290LmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ0b3RhbFByaWNlIiksIHJvb3QuYWRkKCJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxQcmljZVYyKSB7CiAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImNvbXBsZXRlZEF0IiksIHJvb3QuYWRkKCJjcmVhdGVkQXQiKSwgcm9vdC5hZGQoInVwZGF0ZWRBdCIpLCByb290LmFkZCgiZW1haWwiKSwgcm9vdC5hZGQoImRpc2NvdW50QXBwbGljYXRpb25zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAxMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGRpc2NvdW50QXBwbGljYXRpb25zKSB7CiAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBkaXNjb3VudEFwcGxpY2F0aW9ucy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImFwcGxpZWRHaWZ0Q2FyZHMiLCBmdW5jdGlvbiAoYXBwbGllZEdpZnRDYXJkcykgewogICAgICAgIGFwcGxpZWRHaWZ0Q2FyZHMuYWRkRnJhZ21lbnQoc3ByZWFkcy5BcHBsaWVkR2lmdENhcmRGcmFnbWVudCk7CiAgICAgIH0pLCByb290LmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgIHNoaXBwaW5nQWRkcmVzcy5hZGRGcmFnbWVudChzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nTGluZSIsIGZ1bmN0aW9uIChzaGlwcGluZ0xpbmUpIHsKICAgICAgICBzaGlwcGluZ0xpbmUuYWRkKCJoYW5kbGUiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2UiKSwgc2hpcHBpbmdMaW5lLmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgICBwcmljZVYyLmFkZCgiYW1vdW50IiksIHByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgc2hpcHBpbmdMaW5lLmFkZCgidGl0bGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoIm9yZGVyIiwgZnVuY3Rpb24gKG9yZGVyKSB7CiAgICAgICAgb3JkZXIuYWRkKCJpZCIpLCBvcmRlci5hZGQoInByb2Nlc3NlZEF0IiksIG9yZGVyLmFkZCgib3JkZXJOdW1iZXIiKSwgb3JkZXIuYWRkKCJzdWJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHN1YnRvdGFsUHJpY2VWMikgewogICAgICAgICAgc3VidG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHN1YnRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsU2hpcHBpbmdQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsU2hpcHBpbmdQcmljZVYyKSB7CiAgICAgICAgICB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFNoaXBwaW5nUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsVGF4IiksIG9yZGVyLmFkZCgidG90YWxUYXhWMiIsIGZ1bmN0aW9uICh0b3RhbFRheFYyKSB7CiAgICAgICAgICB0b3RhbFRheFYyLmFkZCgiYW1vdW50IiksIHRvdGFsVGF4VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFByaWNlIiksIG9yZGVyLmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgICAgdG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1cnJlbmN5Q29kZSIpLCBvcmRlci5hZGQoInRvdGFsUmVmdW5kZWQiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkVjIiLCBmdW5jdGlvbiAodG90YWxSZWZ1bmRlZFYyKSB7CiAgICAgICAgICB0b3RhbFJlZnVuZGVkVjIuYWRkKCJhbW91bnQiKSwgdG90YWxSZWZ1bmRlZFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgiY3VzdG9tZXJVcmwiKSwgb3JkZXIuYWRkKCJzaGlwcGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAoc2hpcHBpbmdBZGRyZXNzKSB7CiAgICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJsaW5lSXRlbXMiLCB7CiAgICAgICAgICBhcmdzOiB7CiAgICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICAgIH0KICAgICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgICBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgICB9KSwgbm9kZS5hZGQoInF1YW50aXR5IiksIG5vZGUuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyNTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChsaW5lSXRlbXMpIHsKICAgICAgICBsaW5lSXRlbXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBsaW5lSXRlbXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJjdXJzb3IiKSwgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGQoImlkIiksIG5vZGUuYWRkKCJ0aXRsZSIpLCBub2RlLmFkZCgidmFyaWFudCIsIGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgICAgICAgdmFyaWFudC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50KTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJkaXNjb3VudEFsbG9jYXRpb25zIiwgZnVuY3Rpb24gKGRpc2NvdW50QWxsb2NhdGlvbnMpIHsKICAgICAgICAgICAgICBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiYWxsb2NhdGVkQW1vdW50IiwgZnVuY3Rpb24gKGFsbG9jYXRlZEFtb3VudCkgewogICAgICAgICAgICAgICAgYWxsb2NhdGVkQW1vdW50LmFkZCgiYW1vdW50IiksIGFsbG9jYXRlZEFtb3VudC5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICAgIH0pLCBkaXNjb3VudEFsbG9jYXRpb25zLmFkZCgiZGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgICAgICAgICBkaXNjb3VudEFwcGxpY2F0aW9uLmFkZEZyYWdtZW50KHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KSwgZG9jdW1lbnQuYWRkTXV0YXRpb24oImNoZWNrb3V0R2lmdENhcmRSZW1vdmVWMiIsIFt2YXJpYWJsZXMuY2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyLmFwcGxpZWRHaWZ0Q2FyZElkLCB2YXJpYWJsZXMuY2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyLmNoZWNrb3V0SWRdLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiY2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGFwcGxpZWRHaWZ0Q2FyZElkOiB2YXJpYWJsZXMuY2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyLmFwcGxpZWRHaWZ0Q2FyZElkLAogICAgICAgICAgY2hlY2tvdXRJZDogdmFyaWFibGVzLmNoZWNrb3V0R2lmdENhcmRSZW1vdmVWMi5jaGVja291dElkCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoY2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyKSB7CiAgICAgICAgY2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyLmFkZCgidXNlckVycm9ycyIsIGZ1bmN0aW9uICh1c2VyRXJyb3JzKSB7CiAgICAgICAgICB1c2VyRXJyb3JzLmFkZEZyYWdtZW50KHNwcmVhZHMuVXNlckVycm9yRnJhZ21lbnQpOwogICAgICAgIH0pLCBjaGVja291dEdpZnRDYXJkUmVtb3ZlVjIuYWRkKCJjaGVja291dFVzZXJFcnJvcnMiLCBmdW5jdGlvbiAoY2hlY2tvdXRVc2VyRXJyb3JzKSB7CiAgICAgICAgICBjaGVja291dFVzZXJFcnJvcnMuYWRkRnJhZ21lbnQoc3ByZWFkcy5DaGVja291dFVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyLmFkZCgiY2hlY2tvdXQiLCBmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICAgIGNoZWNrb3V0LmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gcXVlcnkkMjIoY2xpZW50KSB7CiAgICB2YXIgZG9jdW1lbnQgPSBjbGllbnQuZG9jdW1lbnQoKSwKICAgICAgICBzcHJlYWRzID0ge30sCiAgICAgICAgdmFyaWFibGVzID0gewogICAgICBjaGVja291dEVtYWlsVXBkYXRlVjI6IHt9CiAgICB9OwogICAgcmV0dXJuIHZhcmlhYmxlcy5jaGVja291dEVtYWlsVXBkYXRlVjIuY2hlY2tvdXRJZCA9IGNsaWVudC52YXJpYWJsZSgiY2hlY2tvdXRJZCIsICJJRCEiKSwgdmFyaWFibGVzLmNoZWNrb3V0RW1haWxVcGRhdGVWMi5lbWFpbCA9IGNsaWVudC52YXJpYWJsZSgiZW1haWwiLCAiU3RyaW5nISIpLCBzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJWYXJpYW50RnJhZ21lbnQiLCAiUHJvZHVjdFZhcmlhbnQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoInRpdGxlIiksIHJvb3QuYWRkKCJwcmljZSIpLCByb290LmFkZCgicHJpY2VWMiIsIGZ1bmN0aW9uIChwcmljZVYyKSB7CiAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgicHJlc2VudG1lbnRQcmljZXMiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZmlyc3Q6IDIwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAocHJlc2VudG1lbnRQcmljZXMpIHsKICAgICAgICBwcmVzZW50bWVudFByaWNlcy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIHByZXNlbnRtZW50UHJpY2VzLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJwcmljZSIsIGZ1bmN0aW9uIChwcmljZSkgewogICAgICAgICAgICAgIHByaWNlLmFkZCgiYW1vdW50IiksIHByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiY29tcGFyZUF0UHJpY2UiLCBmdW5jdGlvbiAoY29tcGFyZUF0UHJpY2UpIHsKICAgICAgICAgICAgICBjb21wYXJlQXRQcmljZS5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoIndlaWdodCIpLCByb290LmFkZCgiYXZhaWxhYmxlRm9yU2FsZSIsIHsKICAgICAgICBhbGlhczogImF2YWlsYWJsZSIKICAgICAgfSksIHJvb3QuYWRkKCJza3UiKSwgcm9vdC5hZGQoImNvbXBhcmVBdFByaWNlIiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZVYyIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlVjIpIHsKICAgICAgICBjb21wYXJlQXRQcmljZVYyLmFkZCgiYW1vdW50IiksIGNvbXBhcmVBdFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJpbWFnZSIsIGZ1bmN0aW9uIChpbWFnZSkgewogICAgICAgIGltYWdlLmFkZCgiaWQiKSwgaW1hZ2UuYWRkKCJvcmlnaW5hbFNyYyIsIHsKICAgICAgICAgIGFsaWFzOiAic3JjIgogICAgICAgIH0pLCBpbWFnZS5hZGQoImFsdFRleHQiKTsKICAgICAgfSksIHJvb3QuYWRkKCJzZWxlY3RlZE9wdGlvbnMiLCBmdW5jdGlvbiAoc2VsZWN0ZWRPcHRpb25zKSB7CiAgICAgICAgc2VsZWN0ZWRPcHRpb25zLmFkZCgibmFtZSIpLCBzZWxlY3RlZE9wdGlvbnMuYWRkKCJ2YWx1ZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZSIsIGZ1bmN0aW9uICh1bml0UHJpY2UpIHsKICAgICAgICB1bml0UHJpY2UuYWRkKCJhbW91bnQiKSwgdW5pdFByaWNlLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidW5pdFByaWNlTWVhc3VyZW1lbnQiLCBmdW5jdGlvbiAodW5pdFByaWNlTWVhc3VyZW1lbnQpIHsKICAgICAgICB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoIm1lYXN1cmVkVHlwZSIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInF1YW50aXR5VW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInF1YW50aXR5VmFsdWUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJyZWZlcmVuY2VVbml0IiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVmFsdWUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5EaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50IiwgIkRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgidGFyZ2V0U2VsZWN0aW9uIiksIHJvb3QuYWRkKCJhbGxvY2F0aW9uTWV0aG9kIiksIHJvb3QuYWRkKCJ0YXJnZXRUeXBlIiksIHJvb3QuYWRkKCJ2YWx1ZSIsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHZhbHVlLmFkZElubGluZUZyYWdtZW50T24oIk1vbmV5VjIiLCBmdW5jdGlvbiAoTW9uZXlWMikgewogICAgICAgICAgTW9uZXlWMi5hZGQoImFtb3VudCIpLCBNb25leVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHZhbHVlLmFkZElubGluZUZyYWdtZW50T24oIlByaWNpbmdQZXJjZW50YWdlVmFsdWUiLCBmdW5jdGlvbiAoUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSkgewogICAgICAgICAgUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZS5hZGQoInBlcmNlbnRhZ2UiKTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbi5hZGQoInRpdGxlIiksIE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJkZXNjcmlwdGlvbiIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJEaXNjb3VudENvZGVBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChEaXNjb3VudENvZGVBcHBsaWNhdGlvbikgewogICAgICAgIERpc2NvdW50Q29kZUFwcGxpY2F0aW9uLmFkZCgiY29kZSIpLCBEaXNjb3VudENvZGVBcHBsaWNhdGlvbi5hZGQoImFwcGxpY2FibGUiKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbiIsIGZ1bmN0aW9uIChTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uKSB7CiAgICAgICAgU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbi5hZGQoImRlc2NyaXB0aW9uIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIkF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIEF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24uYWRkKCJ0aXRsZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50IiwgIkFwcGxpZWRHaWZ0Q2FyZCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJhbW91bnRVc2VkVjIiLCBmdW5jdGlvbiAoYW1vdW50VXNlZFYyKSB7CiAgICAgICAgYW1vdW50VXNlZFYyLmFkZCgiYW1vdW50IiksIGFtb3VudFVzZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImJhbGFuY2VWMiIsIGZ1bmN0aW9uIChiYWxhbmNlVjIpIHsKICAgICAgICBiYWxhbmNlVjIuYWRkKCJhbW91bnQiKSwgYmFsYW5jZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgicHJlc2VudG1lbnRBbW91bnRVc2VkIiwgZnVuY3Rpb24gKHByZXNlbnRtZW50QW1vdW50VXNlZCkgewogICAgICAgIHByZXNlbnRtZW50QW1vdW50VXNlZC5hZGQoImFtb3VudCIpLCBwcmVzZW50bWVudEFtb3VudFVzZWQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgibGFzdENoYXJhY3RlcnMiKTsKICAgIH0pLCBzcHJlYWRzLlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlZhcmlhbnRXaXRoUHJvZHVjdEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGRGcmFnbWVudChzcHJlYWRzLlZhcmlhbnRGcmFnbWVudCksIHJvb3QuYWRkKCJwcm9kdWN0IiwgZnVuY3Rpb24gKHByb2R1Y3QpIHsKICAgICAgICBwcm9kdWN0LmFkZCgiaWQiKSwgcHJvZHVjdC5hZGQoImhhbmRsZSIpOwogICAgICB9KTsKICAgIH0pLCBzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIlVzZXJFcnJvckZyYWdtZW50IiwgIlVzZXJFcnJvciIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJmaWVsZCIpLCByb290LmFkZCgibWVzc2FnZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dFVzZXJFcnJvckZyYWdtZW50IiwgIkNoZWNrb3V0VXNlckVycm9yIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImZpZWxkIiksIHJvb3QuYWRkKCJtZXNzYWdlIiksIHJvb3QuYWRkKCJjb2RlIik7CiAgICB9KSwgc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIk1haWxpbmdBZGRyZXNzRnJhZ21lbnQiLCAiTWFpbGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImFkZHJlc3MxIiksIHJvb3QuYWRkKCJhZGRyZXNzMiIpLCByb290LmFkZCgiY2l0eSIpLCByb290LmFkZCgiY29tcGFueSIpLCByb290LmFkZCgiY291bnRyeSIpLCByb290LmFkZCgiZmlyc3ROYW1lIiksIHJvb3QuYWRkKCJmb3JtYXR0ZWQiKSwgcm9vdC5hZGQoImxhc3ROYW1lIiksIHJvb3QuYWRkKCJsYXRpdHVkZSIpLCByb290LmFkZCgibG9uZ2l0dWRlIiksIHJvb3QuYWRkKCJwaG9uZSIpLCByb290LmFkZCgicHJvdmluY2UiKSwgcm9vdC5hZGQoInppcCIpLCByb290LmFkZCgibmFtZSIpLCByb290LmFkZCgiY291bnRyeUNvZGVWMiIsIHsKICAgICAgICBhbGlhczogImNvdW50cnlDb2RlIgogICAgICB9KSwgcm9vdC5hZGQoInByb3ZpbmNlQ29kZSIpOwogICAgfSksIHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJDaGVja291dEZyYWdtZW50IiwgIkNoZWNrb3V0IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJyZWFkeSIpLCByb290LmFkZCgicmVxdWlyZXNTaGlwcGluZyIpLCByb290LmFkZCgibm90ZSIpLCByb290LmFkZCgicGF5bWVudER1ZSIpLCByb290LmFkZCgicGF5bWVudER1ZVYyIiwgZnVuY3Rpb24gKHBheW1lbnREdWVWMikgewogICAgICAgIHBheW1lbnREdWVWMi5hZGQoImFtb3VudCIpLCBwYXltZW50RHVlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWJVcmwiKSwgcm9vdC5hZGQoIm9yZGVyU3RhdHVzVXJsIiksIHJvb3QuYWRkKCJ0YXhFeGVtcHQiKSwgcm9vdC5hZGQoInRheGVzSW5jbHVkZWQiKSwgcm9vdC5hZGQoImN1cnJlbmN5Q29kZSIpLCByb290LmFkZCgidG90YWxUYXgiKSwgcm9vdC5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgIHRvdGFsVGF4VjIuYWRkKCJhbW91bnQiKSwgdG90YWxUYXhWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtc1N1YnRvdGFsUHJpY2UiLCBmdW5jdGlvbiAobGluZUl0ZW1zU3VidG90YWxQcmljZSkgewogICAgICAgIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYWRkKCJhbW91bnQiKSwgbGluZUl0ZW1zU3VidG90YWxQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2UiKSwgcm9vdC5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICBzdWJ0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgc3VidG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgidG90YWxQcmljZSIpLCByb290LmFkZCgidG90YWxQcmljZVYyIiwgZnVuY3Rpb24gKHRvdGFsUHJpY2VWMikgewogICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJjb21wbGV0ZWRBdCIpLCByb290LmFkZCgiY3JlYXRlZEF0IiksIHJvb3QuYWRkKCJ1cGRhdGVkQXQiKSwgcm9vdC5hZGQoImVtYWlsIiksIHJvb3QuYWRkKCJkaXNjb3VudEFwcGxpY2F0aW9ucyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMTAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChkaXNjb3VudEFwcGxpY2F0aW9ucykgewogICAgICAgIGRpc2NvdW50QXBwbGljYXRpb25zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgZGlzY291bnRBcHBsaWNhdGlvbnMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgZWRnZXMuYWRkKCJub2RlIiwgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgbm9kZS5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJhcHBsaWVkR2lmdENhcmRzIiwgZnVuY3Rpb24gKGFwcGxpZWRHaWZ0Q2FyZHMpIHsKICAgICAgICBhcHBsaWVkR2lmdENhcmRzLmFkZEZyYWdtZW50KHNwcmVhZHMuQXBwbGllZEdpZnRDYXJkRnJhZ21lbnQpOwogICAgICB9KSwgcm9vdC5hZGQoInNoaXBwaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChzaGlwcGluZ0FkZHJlc3MpIHsKICAgICAgICBzaGlwcGluZ0FkZHJlc3MuYWRkRnJhZ21lbnQoc3ByZWFkcy5NYWlsaW5nQWRkcmVzc0ZyYWdtZW50KTsKICAgICAgfSksIHJvb3QuYWRkKCJzaGlwcGluZ0xpbmUiLCBmdW5jdGlvbiAoc2hpcHBpbmdMaW5lKSB7CiAgICAgICAgc2hpcHBpbmdMaW5lLmFkZCgiaGFuZGxlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlIiksIHNoaXBwaW5nTGluZS5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgICAgcHJpY2VWMi5hZGQoImFtb3VudCIpLCBwcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIHNoaXBwaW5nTGluZS5hZGQoInRpdGxlIik7CiAgICAgIH0pLCByb290LmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJvcmRlciIsIGZ1bmN0aW9uIChvcmRlcikgewogICAgICAgIG9yZGVyLmFkZCgiaWQiKSwgb3JkZXIuYWRkKCJwcm9jZXNzZWRBdCIpLCBvcmRlci5hZGQoIm9yZGVyTnVtYmVyIiksIG9yZGVyLmFkZCgic3VidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInN1YnRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uIChzdWJ0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHN1YnRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCBzdWJ0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2UiKSwgb3JkZXIuYWRkKCJ0b3RhbFNoaXBwaW5nUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFNoaXBwaW5nUHJpY2VWMikgewogICAgICAgICAgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxTaGlwcGluZ1ByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJ0b3RhbFRheCIpLCBvcmRlci5hZGQoInRvdGFsVGF4VjIiLCBmdW5jdGlvbiAodG90YWxUYXhWMikgewogICAgICAgICAgdG90YWxUYXhWMi5hZGQoImFtb3VudCIpLCB0b3RhbFRheFYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxQcmljZSIpLCBvcmRlci5hZGQoInRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFByaWNlVjIpIHsKICAgICAgICAgIHRvdGFsUHJpY2VWMi5hZGQoImFtb3VudCIpLCB0b3RhbFByaWNlVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJjdXJyZW5jeUNvZGUiKSwgb3JkZXIuYWRkKCJ0b3RhbFJlZnVuZGVkIiksIG9yZGVyLmFkZCgidG90YWxSZWZ1bmRlZFYyIiwgZnVuY3Rpb24gKHRvdGFsUmVmdW5kZWRWMikgewogICAgICAgICAgdG90YWxSZWZ1bmRlZFYyLmFkZCgiYW1vdW50IiksIHRvdGFsUmVmdW5kZWRWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImN1c3RvbWVyVXJsIiksIG9yZGVyLmFkZCgic2hpcHBpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHNoaXBwaW5nQWRkcmVzcykgewogICAgICAgICAgc2hpcHBpbmdBZGRyZXNzLmFkZEZyYWdtZW50KHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCk7CiAgICAgICAgfSksIG9yZGVyLmFkZCgibGluZUl0ZW1zIiwgewogICAgICAgICAgYXJnczogewogICAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgICB9CiAgICAgICAgfSwgZnVuY3Rpb24gKGxpbmVJdGVtcykgewogICAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgICAgfSksIGxpbmVJdGVtcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgICAgbm9kZS5hZGQoInRpdGxlIiksIG5vZGUuYWRkKCJ2YXJpYW50IiwgZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgICAgfSksIG5vZGUuYWRkKCJxdWFudGl0eSIpLCBub2RlLmFkZCgiY3VzdG9tQXR0cmlidXRlcyIsIGZ1bmN0aW9uIChjdXN0b21BdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KSwgcm9vdC5hZGQoImxpbmVJdGVtcyIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBmaXJzdDogMjUwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgbGluZUl0ZW1zLmFkZCgicGFnZUluZm8iLCBmdW5jdGlvbiAocGFnZUluZm8pIHsKICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICB9KSwgbGluZUl0ZW1zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgiY3Vyc29yIiksIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkKCJpZCIpLCBub2RlLmFkZCgidGl0bGUiKSwgbm9kZS5hZGQoInZhcmlhbnQiLCBmdW5jdGlvbiAodmFyaWFudCkgewogICAgICAgICAgICAgIHZhcmlhbnQuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCk7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgicXVhbnRpdHkiKSwgbm9kZS5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgICAgICAgIH0pLCBub2RlLmFkZCgiZGlzY291bnRBbGxvY2F0aW9ucyIsIGZ1bmN0aW9uIChkaXNjb3VudEFsbG9jYXRpb25zKSB7CiAgICAgICAgICAgICAgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImFsbG9jYXRlZEFtb3VudCIsIGZ1bmN0aW9uIChhbGxvY2F0ZWRBbW91bnQpIHsKICAgICAgICAgICAgICAgIGFsbG9jYXRlZEFtb3VudC5hZGQoImFtb3VudCIpLCBhbGxvY2F0ZWRBbW91bnQuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgICB9KSwgZGlzY291bnRBbGxvY2F0aW9ucy5hZGQoImRpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoZGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgICAgICAgICAgZGlzY291bnRBcHBsaWNhdGlvbi5hZGRGcmFnbWVudChzcHJlYWRzLkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50LmFkZE11dGF0aW9uKCJjaGVja291dEVtYWlsVXBkYXRlVjIiLCBbdmFyaWFibGVzLmNoZWNrb3V0RW1haWxVcGRhdGVWMi5jaGVja291dElkLCB2YXJpYWJsZXMuY2hlY2tvdXRFbWFpbFVwZGF0ZVYyLmVtYWlsXSwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImNoZWNrb3V0RW1haWxVcGRhdGVWMiIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBjaGVja291dElkOiB2YXJpYWJsZXMuY2hlY2tvdXRFbWFpbFVwZGF0ZVYyLmNoZWNrb3V0SWQsCiAgICAgICAgICBlbWFpbDogdmFyaWFibGVzLmNoZWNrb3V0RW1haWxVcGRhdGVWMi5lbWFpbAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGNoZWNrb3V0RW1haWxVcGRhdGVWMikgewogICAgICAgIGNoZWNrb3V0RW1haWxVcGRhdGVWMi5hZGQoInVzZXJFcnJvcnMiLCBmdW5jdGlvbiAodXNlckVycm9ycykgewogICAgICAgICAgdXNlckVycm9ycy5hZGRGcmFnbWVudChzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXRFbWFpbFVwZGF0ZVYyLmFkZCgiY2hlY2tvdXRVc2VyRXJyb3JzIiwgZnVuY3Rpb24gKGNoZWNrb3V0VXNlckVycm9ycykgewogICAgICAgICAgY2hlY2tvdXRVc2VyRXJyb3JzLmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCk7CiAgICAgICAgfSksIGNoZWNrb3V0RW1haWxVcGRhdGVWMi5hZGQoImNoZWNrb3V0IiwgZnVuY3Rpb24gKGNoZWNrb3V0KSB7CiAgICAgICAgICBjaGVja291dC5hZGRGcmFnbWVudChzcHJlYWRzLkNoZWNrb3V0RnJhZ21lbnQpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudDsKICB9CgogIGZ1bmN0aW9uIHF1ZXJ5JDIzKGNsaWVudCkgewogICAgdmFyIGRvY3VtZW50ID0gY2xpZW50LmRvY3VtZW50KCksCiAgICAgICAgc3ByZWFkcyA9IHt9LAogICAgICAgIHZhcmlhYmxlcyA9IHsKICAgICAgY2hlY2tvdXRTaGlwcGluZ0FkZHJlc3NVcGRhdGVWMjoge30KICAgIH07CiAgICByZXR1cm4gdmFyaWFibGVzLmNoZWNrb3V0U2hpcHBpbmdBZGRyZXNzVXBkYXRlVjIuc2hpcHBpbmdBZGRyZXNzID0gY2xpZW50LnZhcmlhYmxlKCJzaGlwcGluZ0FkZHJlc3MiLCAiTWFpbGluZ0FkZHJlc3NJbnB1dCEiKSwgdmFyaWFibGVzLmNoZWNrb3V0U2hpcHBpbmdBZGRyZXNzVXBkYXRlVjIuY2hlY2tvdXRJZCA9IGNsaWVudC52YXJpYWJsZSgiY2hlY2tvdXRJZCIsICJJRCEiKSwgc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiVmFyaWFudEZyYWdtZW50IiwgIlByb2R1Y3RWYXJpYW50IiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJ0aXRsZSIpLCByb290LmFkZCgicHJpY2UiKSwgcm9vdC5hZGQoInByaWNlVjIiLCBmdW5jdGlvbiAocHJpY2VWMikgewogICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50UHJpY2VzIiwgewogICAgICAgIGFyZ3M6IHsKICAgICAgICAgIGZpcnN0OiAyMAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKHByZXNlbnRtZW50UHJpY2VzKSB7CiAgICAgICAgcHJlc2VudG1lbnRQcmljZXMuYWRkKCJwYWdlSW5mbyIsIGZ1bmN0aW9uIChwYWdlSW5mbykgewogICAgICAgICAgcGFnZUluZm8uYWRkKCJoYXNOZXh0UGFnZSIpLCBwYWdlSW5mby5hZGQoImhhc1ByZXZpb3VzUGFnZSIpOwogICAgICAgIH0pLCBwcmVzZW50bWVudFByaWNlcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgicHJpY2UiLCBmdW5jdGlvbiAocHJpY2UpIHsKICAgICAgICAgICAgICBwcmljZS5hZGQoImFtb3VudCIpLCBwcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImNvbXBhcmVBdFByaWNlIiwgZnVuY3Rpb24gKGNvbXBhcmVBdFByaWNlKSB7CiAgICAgICAgICAgICAgY29tcGFyZUF0UHJpY2UuYWRkKCJhbW91bnQiKSwgY29tcGFyZUF0UHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJ3ZWlnaHQiKSwgcm9vdC5hZGQoImF2YWlsYWJsZUZvclNhbGUiLCB7CiAgICAgICAgYWxpYXM6ICJhdmFpbGFibGUiCiAgICAgIH0pLCByb290LmFkZCgic2t1IiksIHJvb3QuYWRkKCJjb21wYXJlQXRQcmljZSIpLCByb290LmFkZCgiY29tcGFyZUF0UHJpY2VWMiIsIGZ1bmN0aW9uIChjb21wYXJlQXRQcmljZVYyKSB7CiAgICAgICAgY29tcGFyZUF0UHJpY2VWMi5hZGQoImFtb3VudCIpLCBjb21wYXJlQXRQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaW1hZ2UiLCBmdW5jdGlvbiAoaW1hZ2UpIHsKICAgICAgICBpbWFnZS5hZGQoImlkIiksIGltYWdlLmFkZCgib3JpZ2luYWxTcmMiLCB7CiAgICAgICAgICBhbGlhczogInNyYyIKICAgICAgICB9KSwgaW1hZ2UuYWRkKCJhbHRUZXh0Iik7CiAgICAgIH0pLCByb290LmFkZCgic2VsZWN0ZWRPcHRpb25zIiwgZnVuY3Rpb24gKHNlbGVjdGVkT3B0aW9ucykgewogICAgICAgIHNlbGVjdGVkT3B0aW9ucy5hZGQoIm5hbWUiKSwgc2VsZWN0ZWRPcHRpb25zLmFkZCgidmFsdWUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJ1bml0UHJpY2UiLCBmdW5jdGlvbiAodW5pdFByaWNlKSB7CiAgICAgICAgdW5pdFByaWNlLmFkZCgiYW1vdW50IiksIHVuaXRQcmljZS5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInVuaXRQcmljZU1lYXN1cmVtZW50IiwgZnVuY3Rpb24gKHVuaXRQcmljZU1lYXN1cmVtZW50KSB7CiAgICAgICAgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJtZWFzdXJlZFR5cGUiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVVuaXQiKSwgdW5pdFByaWNlTWVhc3VyZW1lbnQuYWRkKCJxdWFudGl0eVZhbHVlIiksIHVuaXRQcmljZU1lYXN1cmVtZW50LmFkZCgicmVmZXJlbmNlVW5pdCIpLCB1bml0UHJpY2VNZWFzdXJlbWVudC5hZGQoInJlZmVyZW5jZVZhbHVlIik7CiAgICAgIH0pOwogICAgfSksIHNwcmVhZHMuRGlzY291bnRBcHBsaWNhdGlvbkZyYWdtZW50ID0gZG9jdW1lbnQuZGVmaW5lRnJhZ21lbnQoIkRpc2NvdW50QXBwbGljYXRpb25GcmFnbWVudCIsICJEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoInRhcmdldFNlbGVjdGlvbiIpLCByb290LmFkZCgiYWxsb2NhdGlvbk1ldGhvZCIpLCByb290LmFkZCgidGFyZ2V0VHlwZSIpLCByb290LmFkZCgidmFsdWUiLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICB2YWx1ZS5hZGRJbmxpbmVGcmFnbWVudE9uKCJNb25leVYyIiwgZnVuY3Rpb24gKE1vbmV5VjIpIHsKICAgICAgICAgIE1vbmV5VjIuYWRkKCJhbW91bnQiKSwgTW9uZXlWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCB2YWx1ZS5hZGRJbmxpbmVGcmFnbWVudE9uKCJQcmljaW5nUGVyY2VudGFnZVZhbHVlIiwgZnVuY3Rpb24gKFByaWNpbmdQZXJjZW50YWdlVmFsdWUpIHsKICAgICAgICAgIFByaWNpbmdQZXJjZW50YWdlVmFsdWUuYWRkKCJwZXJjZW50YWdlIik7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIk1hbnVhbERpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJ0aXRsZSIpLCBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgiZGVzY3JpcHRpb24iKTsKICAgICAgfSksIHJvb3QuYWRkSW5saW5lRnJhZ21lbnRPbigiRGlzY291bnRDb2RlQXBwbGljYXRpb24iLCBmdW5jdGlvbiAoRGlzY291bnRDb2RlQXBwbGljYXRpb24pIHsKICAgICAgICBEaXNjb3VudENvZGVBcHBsaWNhdGlvbi5hZGQoImNvZGUiKSwgRGlzY291bnRDb2RlQXBwbGljYXRpb24uYWRkKCJhcHBsaWNhYmxlIik7CiAgICAgIH0pLCByb290LmFkZElubGluZUZyYWdtZW50T24oIlNjcmlwdERpc2NvdW50QXBwbGljYXRpb24iLCBmdW5jdGlvbiAoU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbikgewogICAgICAgIFNjcmlwdERpc2NvdW50QXBwbGljYXRpb24uYWRkKCJkZXNjcmlwdGlvbiIpOwogICAgICB9KSwgcm9vdC5hZGRJbmxpbmVGcmFnbWVudE9uKCJBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKEF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICBBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uLmFkZCgidGl0bGUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5BcHBsaWVkR2lmdENhcmRGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJBcHBsaWVkR2lmdENhcmRGcmFnbWVudCIsICJBcHBsaWVkR2lmdENhcmQiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiYW1vdW50VXNlZFYyIiwgZnVuY3Rpb24gKGFtb3VudFVzZWRWMikgewogICAgICAgIGFtb3VudFVzZWRWMi5hZGQoImFtb3VudCIpLCBhbW91bnRVc2VkVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJiYWxhbmNlVjIiLCBmdW5jdGlvbiAoYmFsYW5jZVYyKSB7CiAgICAgICAgYmFsYW5jZVYyLmFkZCgiYW1vdW50IiksIGJhbGFuY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInByZXNlbnRtZW50QW1vdW50VXNlZCIsIGZ1bmN0aW9uIChwcmVzZW50bWVudEFtb3VudFVzZWQpIHsKICAgICAgICBwcmVzZW50bWVudEFtb3VudFVzZWQuYWRkKCJhbW91bnQiKSwgcHJlc2VudG1lbnRBbW91bnRVc2VkLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiaWQiKSwgcm9vdC5hZGQoImxhc3RDaGFyYWN0ZXJzIik7CiAgICB9KSwgc3ByZWFkcy5WYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJWYXJpYW50V2l0aFByb2R1Y3RGcmFnbWVudCIsICJQcm9kdWN0VmFyaWFudCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkRnJhZ21lbnQoc3ByZWFkcy5WYXJpYW50RnJhZ21lbnQpLCByb290LmFkZCgicHJvZHVjdCIsIGZ1bmN0aW9uIChwcm9kdWN0KSB7CiAgICAgICAgcHJvZHVjdC5hZGQoImlkIiksIHByb2R1Y3QuYWRkKCJoYW5kbGUiKTsKICAgICAgfSk7CiAgICB9KSwgc3ByZWFkcy5Vc2VyRXJyb3JGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJVc2VyRXJyb3JGcmFnbWVudCIsICJVc2VyRXJyb3IiLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiZmllbGQiKSwgcm9vdC5hZGQoIm1lc3NhZ2UiKTsKICAgIH0pLCBzcHJlYWRzLkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQ2hlY2tvdXRVc2VyRXJyb3JGcmFnbWVudCIsICJDaGVja291dFVzZXJFcnJvciIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJmaWVsZCIpLCByb290LmFkZCgibWVzc2FnZSIpLCByb290LmFkZCgiY29kZSIpOwogICAgfSksIHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCA9IGRvY3VtZW50LmRlZmluZUZyYWdtZW50KCJNYWlsaW5nQWRkcmVzc0ZyYWdtZW50IiwgIk1haWxpbmdBZGRyZXNzIiwgZnVuY3Rpb24gKHJvb3QpIHsKICAgICAgcm9vdC5hZGQoImlkIiksIHJvb3QuYWRkKCJhZGRyZXNzMSIpLCByb290LmFkZCgiYWRkcmVzczIiKSwgcm9vdC5hZGQoImNpdHkiKSwgcm9vdC5hZGQoImNvbXBhbnkiKSwgcm9vdC5hZGQoImNvdW50cnkiKSwgcm9vdC5hZGQoImZpcnN0TmFtZSIpLCByb290LmFkZCgiZm9ybWF0dGVkIiksIHJvb3QuYWRkKCJsYXN0TmFtZSIpLCByb290LmFkZCgibGF0aXR1ZGUiKSwgcm9vdC5hZGQoImxvbmdpdHVkZSIpLCByb290LmFkZCgicGhvbmUiKSwgcm9vdC5hZGQoInByb3ZpbmNlIiksIHJvb3QuYWRkKCJ6aXAiKSwgcm9vdC5hZGQoIm5hbWUiKSwgcm9vdC5hZGQoImNvdW50cnlDb2RlVjIiLCB7CiAgICAgICAgYWxpYXM6ICJjb3VudHJ5Q29kZSIKICAgICAgfSksIHJvb3QuYWRkKCJwcm92aW5jZUNvZGUiKTsKICAgIH0pLCBzcHJlYWRzLkNoZWNrb3V0RnJhZ21lbnQgPSBkb2N1bWVudC5kZWZpbmVGcmFnbWVudCgiQ2hlY2tvdXRGcmFnbWVudCIsICJDaGVja291dCIsIGZ1bmN0aW9uIChyb290KSB7CiAgICAgIHJvb3QuYWRkKCJpZCIpLCByb290LmFkZCgicmVhZHkiKSwgcm9vdC5hZGQoInJlcXVpcmVzU2hpcHBpbmciKSwgcm9vdC5hZGQoIm5vdGUiKSwgcm9vdC5hZGQoInBheW1lbnREdWUiKSwgcm9vdC5hZGQoInBheW1lbnREdWVWMiIsIGZ1bmN0aW9uIChwYXltZW50RHVlVjIpIHsKICAgICAgICBwYXltZW50RHVlVjIuYWRkKCJhbW91bnQiKSwgcGF5bWVudER1ZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgid2ViVXJsIiksIHJvb3QuYWRkKCJvcmRlclN0YXR1c1VybCIpLCByb290LmFkZCgidGF4RXhlbXB0IiksIHJvb3QuYWRkKCJ0YXhlc0luY2x1ZGVkIiksIHJvb3QuYWRkKCJjdXJyZW5jeUNvZGUiKSwgcm9vdC5hZGQoInRvdGFsVGF4IiksIHJvb3QuYWRkKCJ0b3RhbFRheFYyIiwgZnVuY3Rpb24gKHRvdGFsVGF4VjIpIHsKICAgICAgICB0b3RhbFRheFYyLmFkZCgiYW1vdW50IiksIHRvdGFsVGF4VjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJsaW5lSXRlbXNTdWJ0b3RhbFByaWNlIiwgZnVuY3Rpb24gKGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UpIHsKICAgICAgICBsaW5lSXRlbXNTdWJ0b3RhbFByaWNlLmFkZCgiYW1vdW50IiksIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgfSksIHJvb3QuYWRkKCJzdWJ0b3RhbFByaWNlIiksIHJvb3QuYWRkKCJzdWJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAoc3VidG90YWxQcmljZVYyKSB7CiAgICAgICAgc3VidG90YWxQcmljZVYyLmFkZCgiYW1vdW50IiksIHN1YnRvdGFsUHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICB9KSwgcm9vdC5hZGQoInRvdGFsUHJpY2UiKSwgcm9vdC5hZGQoInRvdGFsUHJpY2VWMiIsIGZ1bmN0aW9uICh0b3RhbFByaWNlVjIpIHsKICAgICAgICB0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgIH0pLCByb290LmFkZCgiY29tcGxldGVkQXQiKSwgcm9vdC5hZGQoImNyZWF0ZWRBdCIpLCByb290LmFkZCgidXBkYXRlZEF0IiksIHJvb3QuYWRkKCJlbWFpbCIpLCByb290LmFkZCgiZGlzY291bnRBcHBsaWNhdGlvbnMiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZmlyc3Q6IDEwCiAgICAgICAgfQogICAgICB9LCBmdW5jdGlvbiAoZGlzY291bnRBcHBsaWNhdGlvbnMpIHsKICAgICAgICBkaXNjb3VudEFwcGxpY2F0aW9ucy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIGRpc2NvdW50QXBwbGljYXRpb25zLmFkZCgiZWRnZXMiLCBmdW5jdGlvbiAoZWRnZXMpIHsKICAgICAgICAgIGVkZ2VzLmFkZCgibm9kZSIsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIG5vZGUuYWRkRnJhZ21lbnQoc3ByZWFkcy5EaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLCByb290LmFkZCgiYXBwbGllZEdpZnRDYXJkcyIsIGZ1bmN0aW9uIChhcHBsaWVkR2lmdENhcmRzKSB7CiAgICAgICAgYXBwbGllZEdpZnRDYXJkcy5hZGRGcmFnbWVudChzcHJlYWRzLkFwcGxpZWRHaWZ0Q2FyZEZyYWdtZW50KTsKICAgICAgfSksIHJvb3QuYWRkKCJzaGlwcGluZ0FkZHJlc3MiLCBmdW5jdGlvbiAoc2hpcHBpbmdBZGRyZXNzKSB7CiAgICAgICAgc2hpcHBpbmdBZGRyZXNzLmFkZEZyYWdtZW50KHNwcmVhZHMuTWFpbGluZ0FkZHJlc3NGcmFnbWVudCk7CiAgICAgIH0pLCByb290LmFkZCgic2hpcHBpbmdMaW5lIiwgZnVuY3Rpb24gKHNoaXBwaW5nTGluZSkgewogICAgICAgIHNoaXBwaW5nTGluZS5hZGQoImhhbmRsZSIpLCBzaGlwcGluZ0xpbmUuYWRkKCJwcmljZSIpLCBzaGlwcGluZ0xpbmUuYWRkKCJwcmljZVYyIiwgZnVuY3Rpb24gKHByaWNlVjIpIHsKICAgICAgICAgIHByaWNlVjIuYWRkKCJhbW91bnQiKSwgcHJpY2VWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBzaGlwcGluZ0xpbmUuYWRkKCJ0aXRsZSIpOwogICAgICB9KSwgcm9vdC5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJrZXkiKSwgY3VzdG9tQXR0cmlidXRlcy5hZGQoInZhbHVlIik7CiAgICAgIH0pLCByb290LmFkZCgib3JkZXIiLCBmdW5jdGlvbiAob3JkZXIpIHsKICAgICAgICBvcmRlci5hZGQoImlkIiksIG9yZGVyLmFkZCgicHJvY2Vzc2VkQXQiKSwgb3JkZXIuYWRkKCJvcmRlck51bWJlciIpLCBvcmRlci5hZGQoInN1YnRvdGFsUHJpY2UiKSwgb3JkZXIuYWRkKCJzdWJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAoc3VidG90YWxQcmljZVYyKSB7CiAgICAgICAgICBzdWJ0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgc3VidG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxTaGlwcGluZ1ByaWNlIiksIG9yZGVyLmFkZCgidG90YWxTaGlwcGluZ1ByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxTaGlwcGluZ1ByaWNlVjIpIHsKICAgICAgICAgIHRvdGFsU2hpcHBpbmdQcmljZVYyLmFkZCgiYW1vdW50IiksIHRvdGFsU2hpcHBpbmdQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgidG90YWxUYXgiKSwgb3JkZXIuYWRkKCJ0b3RhbFRheFYyIiwgZnVuY3Rpb24gKHRvdGFsVGF4VjIpIHsKICAgICAgICAgIHRvdGFsVGF4VjIuYWRkKCJhbW91bnQiKSwgdG90YWxUYXhWMi5hZGQoImN1cnJlbmN5Q29kZSIpOwogICAgICAgIH0pLCBvcmRlci5hZGQoInRvdGFsUHJpY2UiKSwgb3JkZXIuYWRkKCJ0b3RhbFByaWNlVjIiLCBmdW5jdGlvbiAodG90YWxQcmljZVYyKSB7CiAgICAgICAgICB0b3RhbFByaWNlVjIuYWRkKCJhbW91bnQiKSwgdG90YWxQcmljZVYyLmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgfSksIG9yZGVyLmFkZCgiY3VycmVuY3lDb2RlIiksIG9yZGVyLmFkZCgidG90YWxSZWZ1bmRlZCIpLCBvcmRlci5hZGQoInRvdGFsUmVmdW5kZWRWMiIsIGZ1bmN0aW9uICh0b3RhbFJlZnVuZGVkVjIpIHsKICAgICAgICAgIHRvdGFsUmVmdW5kZWRWMi5hZGQoImFtb3VudCIpLCB0b3RhbFJlZnVuZGVkVjIuYWRkKCJjdXJyZW5jeUNvZGUiKTsKICAgICAgICB9KSwgb3JkZXIuYWRkKCJjdXN0b21lclVybCIpLCBvcmRlci5hZGQoInNoaXBwaW5nQWRkcmVzcyIsIGZ1bmN0aW9uIChzaGlwcGluZ0FkZHJlc3MpIHsKICAgICAgICAgIHNoaXBwaW5nQWRkcmVzcy5hZGRGcmFnbWVudChzcHJlYWRzLk1haWxpbmdBZGRyZXNzRnJhZ21lbnQpOwogICAgICAgIH0pLCBvcmRlci5hZGQoImxpbmVJdGVtcyIsIHsKICAgICAgICAgIGFyZ3M6IHsKICAgICAgICAgICAgZmlyc3Q6IDI1MAogICAgICAgICAgfQogICAgICAgIH0sIGZ1bmN0aW9uIChsaW5lSXRlbXMpIHsKICAgICAgICAgIGxpbmVJdGVtcy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICAgIHBhZ2VJbmZvLmFkZCgiaGFzTmV4dFBhZ2UiKSwgcGFnZUluZm8uYWRkKCJoYXNQcmV2aW91c1BhZ2UiKTsKICAgICAgICAgIH0pLCBsaW5lSXRlbXMuYWRkKCJlZGdlcyIsIGZ1bmN0aW9uIChlZGdlcykgewogICAgICAgICAgICBlZGdlcy5hZGQoImN1cnNvciIpLCBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICAgIG5vZGUuYWRkKCJ0aXRsZSIpLCBub2RlLmFkZCgidmFyaWFudCIsIGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgICAgICAgICB2YXJpYW50LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQpOwogICAgICAgICAgICAgIH0pLCBub2RlLmFkZCgicXVhbnRpdHkiKSwgbm9kZS5hZGQoImN1c3RvbUF0dHJpYnV0ZXMiLCBmdW5jdGlvbiAoY3VzdG9tQXR0cmlidXRlcykgewogICAgICAgICAgICAgICAgY3VzdG9tQXR0cmlidXRlcy5hZGQoImtleSIpLCBjdXN0b21BdHRyaWJ1dGVzLmFkZCgidmFsdWUiKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSksIHJvb3QuYWRkKCJsaW5lSXRlbXMiLCB7CiAgICAgICAgYXJnczogewogICAgICAgICAgZmlyc3Q6IDI1MAogICAgICAgIH0KICAgICAgfSwgZnVuY3Rpb24gKGxpbmVJdGVtcykgewogICAgICAgIGxpbmVJdGVtcy5hZGQoInBhZ2VJbmZvIiwgZnVuY3Rpb24gKHBhZ2VJbmZvKSB7CiAgICAgICAgICBwYWdlSW5mby5hZGQoImhhc05leHRQYWdlIiksIHBhZ2VJbmZvLmFkZCgiaGFzUHJldmlvdXNQYWdlIik7CiAgICAgICAgfSksIGxpbmVJdGVtcy5hZGQoImVkZ2VzIiwgZnVuY3Rpb24gKGVkZ2VzKSB7CiAgICAgICAgICBlZGdlcy5hZGQoImN1cnNvciIpLCBlZGdlcy5hZGQoIm5vZGUiLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICBub2RlLmFkZCgiaWQiKSwgbm9kZS5hZGQoInRpdGxlIiksIG5vZGUuYWRkKCJ2YXJpYW50IiwgZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgICAgICB2YXJpYW50LmFkZEZyYWdtZW50KHNwcmVhZHMuVmFyaWFudFdpdGhQcm9kdWN0RnJhZ21lbnQpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoInF1YW50aXR5IiksIG5vZGUuYWRkKCJjdXN0b21BdHRyaWJ1dGVzIiwgZnVuY3Rpb24gKGN1c3RvbUF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICBjdXN0b21BdHRyaWJ1dGVzLmFkZCgia2V5IiksIGN1c3RvbUF0dHJpYnV0ZXMuYWRkKCJ2YWx1ZSIpOwogICAgICAgICAgICB9KSwgbm9kZS5hZGQoImRpc2NvdW50QWxsb2NhdGlvbnMiLCBmdW5jdGlvbiAoZGlzY291bnRBbGxvY2F0aW9ucykgewogICAgICAgICAgICAgIGRpc2NvdW50QWxsb2NhdGlvbnMuYWRkKCJhbGxvY2F0ZWRBbW91bnQiLCBmdW5jdGlvbiAoYWxsb2NhdGVkQW1vdW50KSB7CiAgICAgICAgICAgICAgICBhbGxvY2F0ZWRBbW91bnQuYWRkKCJhbW91bnQiKSwgYWxsb2NhdGVkQW1vdW50LmFkZCgiY3VycmVuY3lDb2RlIik7CiAgICAgICAgICAgICAgfSksIGRpc2NvdW50QWxsb2NhdGlvbnMuYWRkKCJkaXNjb3VudEFwcGxpY2F0aW9uIiwgZnVuY3Rpb24gKGRpc2NvdW50QXBwbGljYXRpb24pIHsKICAgICAgICAgICAgICAgIGRpc2NvdW50QXBwbGljYXRpb24uYWRkRnJhZ21lbnQoc3ByZWFkcy5EaXNjb3VudEFwcGxpY2F0aW9uRnJhZ21lbnQpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pLCBkb2N1bWVudC5hZGRNdXRhdGlvbigiY2hlY2tvdXRTaGlwcGluZ0FkZHJlc3NVcGRhdGVWMiIsIFt2YXJpYWJsZXMuY2hlY2tvdXRTaGlwcGluZ0FkZHJlc3NVcGRhdGVWMi5zaGlwcGluZ0FkZHJlc3MsIHZhcmlhYmxlcy5jaGVja291dFNoaXBwaW5nQWRkcmVzc1VwZGF0ZVYyLmNoZWNrb3V0SWRdLCBmdW5jdGlvbiAocm9vdCkgewogICAgICByb290LmFkZCgiY2hlY2tvdXRTaGlwcGluZ0FkZHJlc3NVcGRhdGVWMiIsIHsKICAgICAgICBhcmdzOiB7CiAgICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHZhcmlhYmxlcy5jaGVja291dFNoaXBwaW5nQWRkcmVzc1VwZGF0ZVYyLnNoaXBwaW5nQWRkcmVzcywKICAgICAgICAgIGNoZWNrb3V0SWQ6IHZhcmlhYmxlcy5jaGVja291dFNoaXBwaW5nQWRkcmVzc1VwZGF0ZVYyLmNoZWNrb3V0SWQKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChjaGVja291dFNoaXBwaW5nQWRkcmVzc1VwZGF0ZVYyKSB7CiAgICAgICAgY2hlY2tvdXRTaGlwcGluZ0FkZHJlc3NVcGRhdGVWMi5hZGQoInVzZXJFcnJvcnMiLCBmdW5jdGlvbiAodXNlckVycm9ycykgewogICAgICAgICAgdXNlckVycm9ycy5hZGRGcmFnbWVudChzcHJlYWRzLlVzZXJFcnJvckZyYWdtZW50KTsKICAgICAgICB9KSwgY2hlY2tvdXRTaGlwcGluZ0FkZHJlc3NVcGRhdGVWMi5hZGQoImNoZWNrb3V0VXNlckVycm9ycyIsIGZ1bmN0aW9uIChjaGVja291dFVzZXJFcnJvcnMpIHsKICAgICAgICAgIGNoZWNrb3V0VXNlckVycm9ycy5hZGRGcmFnbWVudChzcHJlYWRzLkNoZWNrb3V0VXNlckVycm9yRnJhZ21lbnQpOwogICAgICAgIH0pLCBjaGVja291dFNoaXBwaW5nQWRkcmVzc1VwZGF0ZVYyLmFkZCgiY2hlY2tvdXQiLCBmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICAgIGNoZWNrb3V0LmFkZEZyYWdtZW50KHNwcmVhZHMuQ2hlY2tvdXRGcmFnbWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSksIGRvY3VtZW50OwogIH0KCiAgdmFyIENoZWNrb3V0UmVzb3VyY2UgPSBmdW5jdGlvbiAoX1Jlc291cmNlKSB7CiAgICBmdW5jdGlvbiBDaGVja291dFJlc291cmNlKCkgewogICAgICByZXR1cm4gY2xhc3NDYWxsQ2hlY2skMSh0aGlzLCBDaGVja291dFJlc291cmNlKSwgcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiQxKHRoaXMsIChDaGVja291dFJlc291cmNlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoQ2hlY2tvdXRSZXNvdXJjZSkpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogICAgfQoKICAgIHJldHVybiBpbmhlcml0cyQxKENoZWNrb3V0UmVzb3VyY2UsIF9SZXNvdXJjZSksIGNyZWF0ZUNsYXNzJDEoQ2hlY2tvdXRSZXNvdXJjZSwgW3sKICAgICAga2V5OiAiZmV0Y2giLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZmV0Y2goaWQpIHsKICAgICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5zZW5kKHF1ZXJ5JDExLCB7CiAgICAgICAgICBpZDogaWQKICAgICAgICB9KS50aGVuKGRlZmF1bHRSZXNvbHZlcigibm9kZSIpKS50aGVuKGZ1bmN0aW9uIChjaGVja291dCkgewogICAgICAgICAgcmV0dXJuIGNoZWNrb3V0ID8gX3RoaXMyLmdyYXBoUUxDbGllbnQuZmV0Y2hBbGxQYWdlcyhjaGVja291dC5saW5lSXRlbXMsIHsKICAgICAgICAgICAgcGFnZVNpemU6IDI1MAogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAobGluZUl0ZW1zKSB7CiAgICAgICAgICAgIHJldHVybiBjaGVja291dC5hdHRycy5saW5lSXRlbXMgPSBsaW5lSXRlbXMsIGNoZWNrb3V0OwogICAgICAgICAgfSkgOiBudWxsOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNyZWF0ZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUoKSB7CiAgICAgICAgdmFyIGlucHV0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMF0gPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgICAgICByZXR1cm4gdGhpcy5ncmFwaFFMQ2xpZW50LnNlbmQocXVlcnkkMTIsIHsKICAgICAgICAgIGlucHV0OiBpbnB1dAogICAgICAgIH0pLnRoZW4oaGFuZGxlQ2hlY2tvdXRNdXRhdGlvbigiY2hlY2tvdXRDcmVhdGUiLCB0aGlzLmdyYXBoUUxDbGllbnQpKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ1cGRhdGVBdHRyaWJ1dGVzIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUF0dHJpYnV0ZXMoY2hlY2tvdXRJZCkgewogICAgICAgIHZhciBpbnB1dCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5zZW5kKHF1ZXJ5JDE3LCB7CiAgICAgICAgICBjaGVja291dElkOiBjaGVja291dElkLAogICAgICAgICAgaW5wdXQ6IGlucHV0CiAgICAgICAgfSkudGhlbihoYW5kbGVDaGVja291dE11dGF0aW9uKCJjaGVja291dEF0dHJpYnV0ZXNVcGRhdGVWMiIsIHRoaXMuZ3JhcGhRTENsaWVudCkpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInVwZGF0ZUVtYWlsIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUVtYWlsKGNoZWNrb3V0SWQsIGVtYWlsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5zZW5kKHF1ZXJ5JDIyLCB7CiAgICAgICAgICBjaGVja291dElkOiBjaGVja291dElkLAogICAgICAgICAgZW1haWw6IGVtYWlsCiAgICAgICAgfSkudGhlbihoYW5kbGVDaGVja291dE11dGF0aW9uKCJjaGVja291dEVtYWlsVXBkYXRlVjIiLCB0aGlzLmdyYXBoUUxDbGllbnQpKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJhZGRMaW5lSXRlbXMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTGluZUl0ZW1zKGNoZWNrb3V0SWQsIGxpbmVJdGVtcykgewogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQxMywgewogICAgICAgICAgY2hlY2tvdXRJZDogY2hlY2tvdXRJZCwKICAgICAgICAgIGxpbmVJdGVtczogbGluZUl0ZW1zCiAgICAgICAgfSkudGhlbihoYW5kbGVDaGVja291dE11dGF0aW9uKCJjaGVja291dExpbmVJdGVtc0FkZCIsIHRoaXMuZ3JhcGhRTENsaWVudCkpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImFkZERpc2NvdW50IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZERpc2NvdW50KGNoZWNrb3V0SWQsIGRpc2NvdW50Q29kZSkgewogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQxOCwgewogICAgICAgICAgY2hlY2tvdXRJZDogY2hlY2tvdXRJZCwKICAgICAgICAgIGRpc2NvdW50Q29kZTogZGlzY291bnRDb2RlCiAgICAgICAgfSkudGhlbihoYW5kbGVDaGVja291dE11dGF0aW9uKCJjaGVja291dERpc2NvdW50Q29kZUFwcGx5VjIiLCB0aGlzLmdyYXBoUUxDbGllbnQpKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJyZW1vdmVEaXNjb3VudCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVEaXNjb3VudChjaGVja291dElkKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5zZW5kKHF1ZXJ5JDE5LCB7CiAgICAgICAgICBjaGVja291dElkOiBjaGVja291dElkCiAgICAgICAgfSkudGhlbihoYW5kbGVDaGVja291dE11dGF0aW9uKCJjaGVja291dERpc2NvdW50Q29kZVJlbW92ZSIsIHRoaXMuZ3JhcGhRTENsaWVudCkpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImFkZEdpZnRDYXJkcyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRHaWZ0Q2FyZHMoY2hlY2tvdXRJZCwgZ2lmdENhcmRDb2RlcykgewogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQyMCwgewogICAgICAgICAgY2hlY2tvdXRJZDogY2hlY2tvdXRJZCwKICAgICAgICAgIGdpZnRDYXJkQ29kZXM6IGdpZnRDYXJkQ29kZXMKICAgICAgICB9KS50aGVuKGhhbmRsZUNoZWNrb3V0TXV0YXRpb24oImNoZWNrb3V0R2lmdENhcmRzQXBwZW5kIiwgdGhpcy5ncmFwaFFMQ2xpZW50KSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAicmVtb3ZlR2lmdENhcmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlR2lmdENhcmQoY2hlY2tvdXRJZCwgYXBwbGllZEdpZnRDYXJkSWQpIHsKICAgICAgICByZXR1cm4gdGhpcy5ncmFwaFFMQ2xpZW50LnNlbmQocXVlcnkkMjEsIHsKICAgICAgICAgIGNoZWNrb3V0SWQ6IGNoZWNrb3V0SWQsCiAgICAgICAgICBhcHBsaWVkR2lmdENhcmRJZDogYXBwbGllZEdpZnRDYXJkSWQKICAgICAgICB9KS50aGVuKGhhbmRsZUNoZWNrb3V0TXV0YXRpb24oImNoZWNrb3V0R2lmdENhcmRSZW1vdmVWMiIsIHRoaXMuZ3JhcGhRTENsaWVudCkpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInJlbW92ZUxpbmVJdGVtcyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVMaW5lSXRlbXMoY2hlY2tvdXRJZCwgbGluZUl0ZW1JZHMpIHsKICAgICAgICByZXR1cm4gdGhpcy5ncmFwaFFMQ2xpZW50LnNlbmQocXVlcnkkMTQsIHsKICAgICAgICAgIGNoZWNrb3V0SWQ6IGNoZWNrb3V0SWQsCiAgICAgICAgICBsaW5lSXRlbUlkczogbGluZUl0ZW1JZHMKICAgICAgICB9KS50aGVuKGhhbmRsZUNoZWNrb3V0TXV0YXRpb24oImNoZWNrb3V0TGluZUl0ZW1zUmVtb3ZlIiwgdGhpcy5ncmFwaFFMQ2xpZW50KSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAicmVwbGFjZUxpbmVJdGVtcyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiByZXBsYWNlTGluZUl0ZW1zKGNoZWNrb3V0SWQsIGxpbmVJdGVtcykgewogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQxNSwgewogICAgICAgICAgY2hlY2tvdXRJZDogY2hlY2tvdXRJZCwKICAgICAgICAgIGxpbmVJdGVtczogbGluZUl0ZW1zCiAgICAgICAgfSkudGhlbihoYW5kbGVDaGVja291dE11dGF0aW9uKCJjaGVja291dExpbmVJdGVtc1JlcGxhY2UiLCB0aGlzLmdyYXBoUUxDbGllbnQpKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ1cGRhdGVMaW5lSXRlbXMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTGluZUl0ZW1zKGNoZWNrb3V0SWQsIGxpbmVJdGVtcykgewogICAgICAgIHJldHVybiB0aGlzLmdyYXBoUUxDbGllbnQuc2VuZChxdWVyeSQxNiwgewogICAgICAgICAgY2hlY2tvdXRJZDogY2hlY2tvdXRJZCwKICAgICAgICAgIGxpbmVJdGVtczogbGluZUl0ZW1zCiAgICAgICAgfSkudGhlbihoYW5kbGVDaGVja291dE11dGF0aW9uKCJjaGVja291dExpbmVJdGVtc1VwZGF0ZSIsIHRoaXMuZ3JhcGhRTENsaWVudCkpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInVwZGF0ZVNoaXBwaW5nQWRkcmVzcyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVTaGlwcGluZ0FkZHJlc3MoY2hlY2tvdXRJZCwgc2hpcHBpbmdBZGRyZXNzKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5zZW5kKHF1ZXJ5JDIzLCB7CiAgICAgICAgICBjaGVja291dElkOiBjaGVja291dElkLAogICAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiBzaGlwcGluZ0FkZHJlc3MKICAgICAgICB9KS50aGVuKGhhbmRsZUNoZWNrb3V0TXV0YXRpb24oImNoZWNrb3V0U2hpcHBpbmdBZGRyZXNzVXBkYXRlVjIiLCB0aGlzLmdyYXBoUUxDbGllbnQpKTsKICAgICAgfQogICAgfV0pLCBDaGVja291dFJlc291cmNlOwogIH0oUmVzb3VyY2UpLAogICAgICBpbWFnZUhlbHBlcnMgPSB7CiAgICBpbWFnZUZvclNpemU6IGZ1bmN0aW9uIGltYWdlRm9yU2l6ZShpbWFnZSwgX3JlZikgewogICAgICB2YXIgbWF4V2lkdGggPSBfcmVmLm1heFdpZHRoLAogICAgICAgICAgbWF4SGVpZ2h0ID0gX3JlZi5tYXhIZWlnaHQsCiAgICAgICAgICBzcGxpdFVybCA9IGltYWdlLnNyYy5zcGxpdCgiPyIpLAogICAgICAgICAgbm90UXVlcnkgPSBzcGxpdFVybFswXSwKICAgICAgICAgIHF1ZXJ5ID0gc3BsaXRVcmxbMV0gPyAiPyIgKyBzcGxpdFVybFsxXSA6ICIiLAogICAgICAgICAgaW1hZ2VUb2tlbnMgPSBub3RRdWVyeS5zcGxpdCgiLiIpLAogICAgICAgICAgaW1hZ2VQYXRoSW5kZXggPSBpbWFnZVRva2Vucy5sZW5ndGggLSAyOwogICAgICByZXR1cm4gaW1hZ2VUb2tlbnNbaW1hZ2VQYXRoSW5kZXhdID0gaW1hZ2VUb2tlbnNbaW1hZ2VQYXRoSW5kZXhdICsgIl8iICsgbWF4V2lkdGggKyAieCIgKyBtYXhIZWlnaHQsICIiICsgaW1hZ2VUb2tlbnMuam9pbigiLiIpICsgcXVlcnk7CiAgICB9CiAgfSwKICAgICAgSW1hZ2VSZXNvdXJjZSA9IGZ1bmN0aW9uIChfUmVzb3VyY2UpIHsKICAgIGZ1bmN0aW9uIEltYWdlUmVzb3VyY2UoKSB7CiAgICAgIHJldHVybiBjbGFzc0NhbGxDaGVjayQxKHRoaXMsIEltYWdlUmVzb3VyY2UpLCBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuJDEodGhpcywgKEltYWdlUmVzb3VyY2UuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihJbWFnZVJlc291cmNlKSkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgICB9CgogICAgcmV0dXJuIGluaGVyaXRzJDEoSW1hZ2VSZXNvdXJjZSwgX1Jlc291cmNlKSwgY3JlYXRlQ2xhc3MkMShJbWFnZVJlc291cmNlLCBbewogICAgICBrZXk6ICJoZWxwZXJzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7CiAgICAgICAgcmV0dXJuIGltYWdlSGVscGVyczsKICAgICAgfQogICAgfV0pLCBJbWFnZVJlc291cmNlOwogIH0oUmVzb3VyY2UpLAogICAgICB2ZXJzaW9uID0gIjIuMTEuMCIsCiAgICAgIEFwcGxpZWRHaWZ0Q2FyZCA9IHsKICAgIG5hbWU6ICJBcHBsaWVkR2lmdENhcmQiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBhbW91bnRVc2VkVjI6ICJNb25leVYyIiwKICAgICAgYmFsYW5jZVYyOiAiTW9uZXlWMiIsCiAgICAgIGlkOiAiSUQiLAogICAgICBsYXN0Q2hhcmFjdGVyczogIlN0cmluZyIsCiAgICAgIHByZXNlbnRtZW50QW1vdW50VXNlZDogIk1vbmV5VjIiCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICEwCiAgfSwKICAgICAgQXR0cmlidXRlID0gewogICAgbmFtZTogIkF0dHJpYnV0ZSIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGtleTogIlN0cmluZyIsCiAgICAgIHZhbHVlOiAiU3RyaW5nIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIEF1dG9tYXRpY0Rpc2NvdW50QXBwbGljYXRpb24gPSB7CiAgICBuYW1lOiAiQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbiIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIHRpdGxlOiAiU3RyaW5nIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIEJvb2xlYW4kMSA9IHsKICAgIG5hbWU6ICJCb29sZWFuIiwKICAgIGtpbmQ6ICJTQ0FMQVIiCiAgfSwKICAgICAgQ2hlY2tvdXQgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXQiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBhcHBsaWVkR2lmdENhcmRzOiAiQXBwbGllZEdpZnRDYXJkIiwKICAgICAgY29tcGxldGVkQXQ6ICJEYXRlVGltZSIsCiAgICAgIGNyZWF0ZWRBdDogIkRhdGVUaW1lIiwKICAgICAgY3VycmVuY3lDb2RlOiAiQ3VycmVuY3lDb2RlIiwKICAgICAgY3VzdG9tQXR0cmlidXRlczogIkF0dHJpYnV0ZSIsCiAgICAgIGRpc2NvdW50QXBwbGljYXRpb25zOiAiRGlzY291bnRBcHBsaWNhdGlvbkNvbm5lY3Rpb24iLAogICAgICBlbWFpbDogIlN0cmluZyIsCiAgICAgIGlkOiAiSUQiLAogICAgICBsaW5lSXRlbXM6ICJDaGVja291dExpbmVJdGVtQ29ubmVjdGlvbiIsCiAgICAgIGxpbmVJdGVtc1N1YnRvdGFsUHJpY2U6ICJNb25leVYyIiwKICAgICAgbm90ZTogIlN0cmluZyIsCiAgICAgIG9yZGVyOiAiT3JkZXIiLAogICAgICBvcmRlclN0YXR1c1VybDogIlVSTCIsCiAgICAgIHBheW1lbnREdWU6ICJNb25leSIsCiAgICAgIHBheW1lbnREdWVWMjogIk1vbmV5VjIiLAogICAgICByZWFkeTogIkJvb2xlYW4iLAogICAgICByZXF1aXJlc1NoaXBwaW5nOiAiQm9vbGVhbiIsCiAgICAgIHNoaXBwaW5nQWRkcmVzczogIk1haWxpbmdBZGRyZXNzIiwKICAgICAgc2hpcHBpbmdMaW5lOiAiU2hpcHBpbmdSYXRlIiwKICAgICAgc3VidG90YWxQcmljZTogIk1vbmV5IiwKICAgICAgc3VidG90YWxQcmljZVYyOiAiTW9uZXlWMiIsCiAgICAgIHRheEV4ZW1wdDogIkJvb2xlYW4iLAogICAgICB0YXhlc0luY2x1ZGVkOiAiQm9vbGVhbiIsCiAgICAgIHRvdGFsUHJpY2U6ICJNb25leSIsCiAgICAgIHRvdGFsUHJpY2VWMjogIk1vbmV5VjIiLAogICAgICB0b3RhbFRheDogIk1vbmV5IiwKICAgICAgdG90YWxUYXhWMjogIk1vbmV5VjIiLAogICAgICB1cGRhdGVkQXQ6ICJEYXRlVGltZSIsCiAgICAgIHdlYlVybDogIlVSTCIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITAKICB9LAogICAgICBDaGVja291dEF0dHJpYnV0ZXNVcGRhdGVWMlBheWxvYWQgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlVjJQYXlsb2FkIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXQ6ICJDaGVja291dCIsCiAgICAgIGNoZWNrb3V0VXNlckVycm9yczogIkNoZWNrb3V0VXNlckVycm9yIiwKICAgICAgdXNlckVycm9yczogIlVzZXJFcnJvciIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDaGVja291dENyZWF0ZVBheWxvYWQgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXRDcmVhdGVQYXlsb2FkIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXQ6ICJDaGVja291dCIsCiAgICAgIGNoZWNrb3V0VXNlckVycm9yczogIkNoZWNrb3V0VXNlckVycm9yIiwKICAgICAgdXNlckVycm9yczogIlVzZXJFcnJvciIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDaGVja291dERpc2NvdW50Q29kZUFwcGx5VjJQYXlsb2FkID0gewogICAgbmFtZTogIkNoZWNrb3V0RGlzY291bnRDb2RlQXBwbHlWMlBheWxvYWQiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBjaGVja291dDogIkNoZWNrb3V0IiwKICAgICAgY2hlY2tvdXRVc2VyRXJyb3JzOiAiQ2hlY2tvdXRVc2VyRXJyb3IiLAogICAgICB1c2VyRXJyb3JzOiAiVXNlckVycm9yIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIENoZWNrb3V0RGlzY291bnRDb2RlUmVtb3ZlUGF5bG9hZCA9IHsKICAgIG5hbWU6ICJDaGVja291dERpc2NvdW50Q29kZVJlbW92ZVBheWxvYWQiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBjaGVja291dDogIkNoZWNrb3V0IiwKICAgICAgY2hlY2tvdXRVc2VyRXJyb3JzOiAiQ2hlY2tvdXRVc2VyRXJyb3IiLAogICAgICB1c2VyRXJyb3JzOiAiVXNlckVycm9yIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIENoZWNrb3V0RW1haWxVcGRhdGVWMlBheWxvYWQgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXRFbWFpbFVwZGF0ZVYyUGF5bG9hZCIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGNoZWNrb3V0OiAiQ2hlY2tvdXQiLAogICAgICBjaGVja291dFVzZXJFcnJvcnM6ICJDaGVja291dFVzZXJFcnJvciIsCiAgICAgIHVzZXJFcnJvcnM6ICJVc2VyRXJyb3IiCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgQ2hlY2tvdXRFcnJvckNvZGUgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXRFcnJvckNvZGUiLAogICAga2luZDogIkVOVU0iCiAgfSwKICAgICAgQ2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyUGF5bG9hZCA9IHsKICAgIG5hbWU6ICJDaGVja291dEdpZnRDYXJkUmVtb3ZlVjJQYXlsb2FkIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXQ6ICJDaGVja291dCIsCiAgICAgIGNoZWNrb3V0VXNlckVycm9yczogIkNoZWNrb3V0VXNlckVycm9yIiwKICAgICAgdXNlckVycm9yczogIlVzZXJFcnJvciIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDaGVja291dEdpZnRDYXJkc0FwcGVuZFBheWxvYWQgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmRQYXlsb2FkIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXQ6ICJDaGVja291dCIsCiAgICAgIGNoZWNrb3V0VXNlckVycm9yczogIkNoZWNrb3V0VXNlckVycm9yIiwKICAgICAgdXNlckVycm9yczogIlVzZXJFcnJvciIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDaGVja291dExpbmVJdGVtID0gewogICAgbmFtZTogIkNoZWNrb3V0TGluZUl0ZW0iLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBjdXN0b21BdHRyaWJ1dGVzOiAiQXR0cmlidXRlIiwKICAgICAgZGlzY291bnRBbGxvY2F0aW9uczogIkRpc2NvdW50QWxsb2NhdGlvbiIsCiAgICAgIGlkOiAiSUQiLAogICAgICBxdWFudGl0eTogIkludCIsCiAgICAgIHRpdGxlOiAiU3RyaW5nIiwKICAgICAgdmFyaWFudDogIlByb2R1Y3RWYXJpYW50IgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMAogIH0sCiAgICAgIENoZWNrb3V0TGluZUl0ZW1Db25uZWN0aW9uID0gewogICAgbmFtZTogIkNoZWNrb3V0TGluZUl0ZW1Db25uZWN0aW9uIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgZWRnZXM6ICJDaGVja291dExpbmVJdGVtRWRnZSIsCiAgICAgIHBhZ2VJbmZvOiAiUGFnZUluZm8iCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgQ2hlY2tvdXRMaW5lSXRlbUVkZ2UgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXRMaW5lSXRlbUVkZ2UiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBjdXJzb3I6ICJTdHJpbmciLAogICAgICBub2RlOiAiQ2hlY2tvdXRMaW5lSXRlbSIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDaGVja291dExpbmVJdGVtc0FkZFBheWxvYWQgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXRMaW5lSXRlbXNBZGRQYXlsb2FkIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXQ6ICJDaGVja291dCIsCiAgICAgIGNoZWNrb3V0VXNlckVycm9yczogIkNoZWNrb3V0VXNlckVycm9yIiwKICAgICAgdXNlckVycm9yczogIlVzZXJFcnJvciIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDaGVja291dExpbmVJdGVtc1JlbW92ZVBheWxvYWQgPSB7CiAgICBuYW1lOiAiQ2hlY2tvdXRMaW5lSXRlbXNSZW1vdmVQYXlsb2FkIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXQ6ICJDaGVja291dCIsCiAgICAgIGNoZWNrb3V0VXNlckVycm9yczogIkNoZWNrb3V0VXNlckVycm9yIiwKICAgICAgdXNlckVycm9yczogIlVzZXJFcnJvciIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDaGVja291dExpbmVJdGVtc1JlcGxhY2VQYXlsb2FkID0gewogICAgbmFtZTogIkNoZWNrb3V0TGluZUl0ZW1zUmVwbGFjZVBheWxvYWQiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBjaGVja291dDogIkNoZWNrb3V0IiwKICAgICAgdXNlckVycm9yczogIkNoZWNrb3V0VXNlckVycm9yIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIENoZWNrb3V0TGluZUl0ZW1zVXBkYXRlUGF5bG9hZCA9IHsKICAgIG5hbWU6ICJDaGVja291dExpbmVJdGVtc1VwZGF0ZVBheWxvYWQiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBjaGVja291dDogIkNoZWNrb3V0IiwKICAgICAgY2hlY2tvdXRVc2VyRXJyb3JzOiAiQ2hlY2tvdXRVc2VyRXJyb3IiLAogICAgICB1c2VyRXJyb3JzOiAiVXNlckVycm9yIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIENoZWNrb3V0U2hpcHBpbmdBZGRyZXNzVXBkYXRlVjJQYXlsb2FkID0gewogICAgbmFtZTogIkNoZWNrb3V0U2hpcHBpbmdBZGRyZXNzVXBkYXRlVjJQYXlsb2FkIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXQ6ICJDaGVja291dCIsCiAgICAgIGNoZWNrb3V0VXNlckVycm9yczogIkNoZWNrb3V0VXNlckVycm9yIiwKICAgICAgdXNlckVycm9yczogIlVzZXJFcnJvciIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDaGVja291dFVzZXJFcnJvciA9IHsKICAgIG5hbWU6ICJDaGVja291dFVzZXJFcnJvciIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGNvZGU6ICJDaGVja291dEVycm9yQ29kZSIsCiAgICAgIGZpZWxkOiAiU3RyaW5nIiwKICAgICAgbWVzc2FnZTogIlN0cmluZyIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDb2xsZWN0aW9uID0gewogICAgbmFtZTogIkNvbGxlY3Rpb24iLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBkZXNjcmlwdGlvbjogIlN0cmluZyIsCiAgICAgIGRlc2NyaXB0aW9uSHRtbDogIkhUTUwiLAogICAgICBoYW5kbGU6ICJTdHJpbmciLAogICAgICBpZDogIklEIiwKICAgICAgaW1hZ2U6ICJJbWFnZSIsCiAgICAgIHByb2R1Y3RzOiAiUHJvZHVjdENvbm5lY3Rpb24iLAogICAgICB0aXRsZTogIlN0cmluZyIsCiAgICAgIHVwZGF0ZWRBdDogIkRhdGVUaW1lIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMAogIH0sCiAgICAgIENvbGxlY3Rpb25Db25uZWN0aW9uID0gewogICAgbmFtZTogIkNvbGxlY3Rpb25Db25uZWN0aW9uIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgZWRnZXM6ICJDb2xsZWN0aW9uRWRnZSIsCiAgICAgIHBhZ2VJbmZvOiAiUGFnZUluZm8iCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgQ29sbGVjdGlvbkVkZ2UgPSB7CiAgICBuYW1lOiAiQ29sbGVjdGlvbkVkZ2UiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBjdXJzb3I6ICJTdHJpbmciLAogICAgICBub2RlOiAiQ29sbGVjdGlvbiIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBDb3VudHJ5Q29kZSA9IHsKICAgIG5hbWU6ICJDb3VudHJ5Q29kZSIsCiAgICBraW5kOiAiRU5VTSIKICB9LAogICAgICBDdXJyZW5jeUNvZGUgPSB7CiAgICBuYW1lOiAiQ3VycmVuY3lDb2RlIiwKICAgIGtpbmQ6ICJFTlVNIgogIH0sCiAgICAgIERhdGVUaW1lID0gewogICAgbmFtZTogIkRhdGVUaW1lIiwKICAgIGtpbmQ6ICJTQ0FMQVIiCiAgfSwKICAgICAgRGVjaW1hbCA9IHsKICAgIG5hbWU6ICJEZWNpbWFsIiwKICAgIGtpbmQ6ICJTQ0FMQVIiCiAgfSwKICAgICAgRGlzY291bnRBbGxvY2F0aW9uID0gewogICAgbmFtZTogIkRpc2NvdW50QWxsb2NhdGlvbiIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGFsbG9jYXRlZEFtb3VudDogIk1vbmV5VjIiLAogICAgICBkaXNjb3VudEFwcGxpY2F0aW9uOiAiRGlzY291bnRBcHBsaWNhdGlvbiIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBEaXNjb3VudEFwcGxpY2F0aW9uID0gewogICAgbmFtZTogIkRpc2NvdW50QXBwbGljYXRpb24iLAogICAga2luZDogIklOVEVSRkFDRSIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBhbGxvY2F0aW9uTWV0aG9kOiAiRGlzY291bnRBcHBsaWNhdGlvbkFsbG9jYXRpb25NZXRob2QiLAogICAgICB0YXJnZXRTZWxlY3Rpb246ICJEaXNjb3VudEFwcGxpY2F0aW9uVGFyZ2V0U2VsZWN0aW9uIiwKICAgICAgdGFyZ2V0VHlwZTogIkRpc2NvdW50QXBwbGljYXRpb25UYXJnZXRUeXBlIiwKICAgICAgdmFsdWU6ICJQcmljaW5nVmFsdWUiCiAgICB9LAogICAgcG9zc2libGVUeXBlczogWyJBdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uIiwgIkRpc2NvdW50Q29kZUFwcGxpY2F0aW9uIiwgIk1hbnVhbERpc2NvdW50QXBwbGljYXRpb24iLCAiU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbiJdCiAgfSwKICAgICAgRGlzY291bnRBcHBsaWNhdGlvbkFsbG9jYXRpb25NZXRob2QgPSB7CiAgICBuYW1lOiAiRGlzY291bnRBcHBsaWNhdGlvbkFsbG9jYXRpb25NZXRob2QiLAogICAga2luZDogIkVOVU0iCiAgfSwKICAgICAgRGlzY291bnRBcHBsaWNhdGlvbkNvbm5lY3Rpb24gPSB7CiAgICBuYW1lOiAiRGlzY291bnRBcHBsaWNhdGlvbkNvbm5lY3Rpb24iLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBlZGdlczogIkRpc2NvdW50QXBwbGljYXRpb25FZGdlIiwKICAgICAgcGFnZUluZm86ICJQYWdlSW5mbyIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBEaXNjb3VudEFwcGxpY2F0aW9uRWRnZSA9IHsKICAgIG5hbWU6ICJEaXNjb3VudEFwcGxpY2F0aW9uRWRnZSIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIG5vZGU6ICJEaXNjb3VudEFwcGxpY2F0aW9uIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIERpc2NvdW50QXBwbGljYXRpb25UYXJnZXRTZWxlY3Rpb24gPSB7CiAgICBuYW1lOiAiRGlzY291bnRBcHBsaWNhdGlvblRhcmdldFNlbGVjdGlvbiIsCiAgICBraW5kOiAiRU5VTSIKICB9LAogICAgICBEaXNjb3VudEFwcGxpY2F0aW9uVGFyZ2V0VHlwZSA9IHsKICAgIG5hbWU6ICJEaXNjb3VudEFwcGxpY2F0aW9uVGFyZ2V0VHlwZSIsCiAgICBraW5kOiAiRU5VTSIKICB9LAogICAgICBEaXNjb3VudENvZGVBcHBsaWNhdGlvbiA9IHsKICAgIG5hbWU6ICJEaXNjb3VudENvZGVBcHBsaWNhdGlvbiIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGFwcGxpY2FibGU6ICJCb29sZWFuIiwKICAgICAgY29kZTogIlN0cmluZyIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBEb21haW4gPSB7CiAgICBuYW1lOiAiRG9tYWluIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgaG9zdDogIlN0cmluZyIsCiAgICAgIHNzbEVuYWJsZWQ6ICJCb29sZWFuIiwKICAgICAgdXJsOiAiVVJMIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIEZsb2F0ID0gewogICAgbmFtZTogIkZsb2F0IiwKICAgIGtpbmQ6ICJTQ0FMQVIiCiAgfSwKICAgICAgSFRNTCA9IHsKICAgIG5hbWU6ICJIVE1MIiwKICAgIGtpbmQ6ICJTQ0FMQVIiCiAgfSwKICAgICAgSUQgPSB7CiAgICBuYW1lOiAiSUQiLAogICAga2luZDogIlNDQUxBUiIKICB9LAogICAgICBJbWFnZSA9IHsKICAgIG5hbWU6ICJJbWFnZSIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGFsdFRleHQ6ICJTdHJpbmciLAogICAgICBpZDogIklEIiwKICAgICAgb3JpZ2luYWxTcmM6ICJVUkwiLAogICAgICBzcmM6ICJVUkwiCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgSW1hZ2VDb25uZWN0aW9uID0gewogICAgbmFtZTogIkltYWdlQ29ubmVjdGlvbiIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGVkZ2VzOiAiSW1hZ2VFZGdlIiwKICAgICAgcGFnZUluZm86ICJQYWdlSW5mbyIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBJbWFnZUVkZ2UgPSB7CiAgICBuYW1lOiAiSW1hZ2VFZGdlIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY3Vyc29yOiAiU3RyaW5nIiwKICAgICAgbm9kZTogIkltYWdlIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIEludCA9IHsKICAgIG5hbWU6ICJJbnQiLAogICAga2luZDogIlNDQUxBUiIKICB9LAogICAgICBNYWlsaW5nQWRkcmVzcyA9IHsKICAgIG5hbWU6ICJNYWlsaW5nQWRkcmVzcyIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGFkZHJlc3MxOiAiU3RyaW5nIiwKICAgICAgYWRkcmVzczI6ICJTdHJpbmciLAogICAgICBjaXR5OiAiU3RyaW5nIiwKICAgICAgY29tcGFueTogIlN0cmluZyIsCiAgICAgIGNvdW50cnk6ICJTdHJpbmciLAogICAgICBjb3VudHJ5Q29kZVYyOiAiQ291bnRyeUNvZGUiLAogICAgICBmaXJzdE5hbWU6ICJTdHJpbmciLAogICAgICBmb3JtYXR0ZWQ6ICJTdHJpbmciLAogICAgICBpZDogIklEIiwKICAgICAgbGFzdE5hbWU6ICJTdHJpbmciLAogICAgICBsYXRpdHVkZTogIkZsb2F0IiwKICAgICAgbG9uZ2l0dWRlOiAiRmxvYXQiLAogICAgICBuYW1lOiAiU3RyaW5nIiwKICAgICAgcGhvbmU6ICJTdHJpbmciLAogICAgICBwcm92aW5jZTogIlN0cmluZyIsCiAgICAgIHByb3ZpbmNlQ29kZTogIlN0cmluZyIsCiAgICAgIHppcDogIlN0cmluZyIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITAKICB9LAogICAgICBNYW51YWxEaXNjb3VudEFwcGxpY2F0aW9uID0gewogICAgbmFtZTogIk1hbnVhbERpc2NvdW50QXBwbGljYXRpb24iLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBkZXNjcmlwdGlvbjogIlN0cmluZyIsCiAgICAgIHRpdGxlOiAiU3RyaW5nIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIE1vbmV5ID0gewogICAgbmFtZTogIk1vbmV5IiwKICAgIGtpbmQ6ICJTQ0FMQVIiCiAgfSwKICAgICAgTW9uZXlWMiA9IHsKICAgIG5hbWU6ICJNb25leVYyIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgYW1vdW50OiAiRGVjaW1hbCIsCiAgICAgIGN1cnJlbmN5Q29kZTogIkN1cnJlbmN5Q29kZSIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBNdXRhdGlvbiQxID0gewogICAgbmFtZTogIk11dGF0aW9uIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlVjI6ICJDaGVja291dEF0dHJpYnV0ZXNVcGRhdGVWMlBheWxvYWQiLAogICAgICBjaGVja291dENyZWF0ZTogIkNoZWNrb3V0Q3JlYXRlUGF5bG9hZCIsCiAgICAgIGNoZWNrb3V0RGlzY291bnRDb2RlQXBwbHlWMjogIkNoZWNrb3V0RGlzY291bnRDb2RlQXBwbHlWMlBheWxvYWQiLAogICAgICBjaGVja291dERpc2NvdW50Q29kZVJlbW92ZTogIkNoZWNrb3V0RGlzY291bnRDb2RlUmVtb3ZlUGF5bG9hZCIsCiAgICAgIGNoZWNrb3V0RW1haWxVcGRhdGVWMjogIkNoZWNrb3V0RW1haWxVcGRhdGVWMlBheWxvYWQiLAogICAgICBjaGVja291dEdpZnRDYXJkUmVtb3ZlVjI6ICJDaGVja291dEdpZnRDYXJkUmVtb3ZlVjJQYXlsb2FkIiwKICAgICAgY2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmQ6ICJDaGVja291dEdpZnRDYXJkc0FwcGVuZFBheWxvYWQiLAogICAgICBjaGVja291dExpbmVJdGVtc0FkZDogIkNoZWNrb3V0TGluZUl0ZW1zQWRkUGF5bG9hZCIsCiAgICAgIGNoZWNrb3V0TGluZUl0ZW1zUmVtb3ZlOiAiQ2hlY2tvdXRMaW5lSXRlbXNSZW1vdmVQYXlsb2FkIiwKICAgICAgY2hlY2tvdXRMaW5lSXRlbXNSZXBsYWNlOiAiQ2hlY2tvdXRMaW5lSXRlbXNSZXBsYWNlUGF5bG9hZCIsCiAgICAgIGNoZWNrb3V0TGluZUl0ZW1zVXBkYXRlOiAiQ2hlY2tvdXRMaW5lSXRlbXNVcGRhdGVQYXlsb2FkIiwKICAgICAgY2hlY2tvdXRTaGlwcGluZ0FkZHJlc3NVcGRhdGVWMjogIkNoZWNrb3V0U2hpcHBpbmdBZGRyZXNzVXBkYXRlVjJQYXlsb2FkIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMSwKICAgIHJlbGF5SW5wdXRPYmplY3RCYXNlVHlwZXM6IHsKICAgICAgY2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlOiAiQ2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlSW5wdXQiLAogICAgICBjaGVja291dEF0dHJpYnV0ZXNVcGRhdGVWMjogIkNoZWNrb3V0QXR0cmlidXRlc1VwZGF0ZVYySW5wdXQiLAogICAgICBjaGVja291dENyZWF0ZTogIkNoZWNrb3V0Q3JlYXRlSW5wdXQiLAogICAgICBjdXN0b21lckFjY2Vzc1Rva2VuQ3JlYXRlOiAiQ3VzdG9tZXJBY2Nlc3NUb2tlbkNyZWF0ZUlucHV0IiwKICAgICAgY3VzdG9tZXJBY3RpdmF0ZTogIkN1c3RvbWVyQWN0aXZhdGVJbnB1dCIsCiAgICAgIGN1c3RvbWVyQ3JlYXRlOiAiQ3VzdG9tZXJDcmVhdGVJbnB1dCIsCiAgICAgIGN1c3RvbWVyUmVzZXQ6ICJDdXN0b21lclJlc2V0SW5wdXQiCiAgICB9CiAgfSwKICAgICAgTm9kZSA9IHsKICAgIG5hbWU6ICJOb2RlIiwKICAgIGtpbmQ6ICJJTlRFUkZBQ0UiLAogICAgZmllbGRCYXNlVHlwZXM6IHt9LAogICAgcG9zc2libGVUeXBlczogWyJBcHBsaWVkR2lmdENhcmQiLCAiQXJ0aWNsZSIsICJCbG9nIiwgIkNoZWNrb3V0IiwgIkNoZWNrb3V0TGluZUl0ZW0iLCAiQ29sbGVjdGlvbiIsICJDb21tZW50IiwgIkV4dGVybmFsVmlkZW8iLCAiTWFpbGluZ0FkZHJlc3MiLCAiTWVkaWFJbWFnZSIsICJNZXRhZmllbGQiLCAiTW9kZWwzZCIsICJPcmRlciIsICJQYWdlIiwgIlBheW1lbnQiLCAiUHJvZHVjdCIsICJQcm9kdWN0T3B0aW9uIiwgIlByb2R1Y3RWYXJpYW50IiwgIlNob3BQb2xpY3kiLCAiVmlkZW8iXQogIH0sCiAgICAgIE9yZGVyID0gewogICAgbmFtZTogIk9yZGVyIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY3VycmVuY3lDb2RlOiAiQ3VycmVuY3lDb2RlIiwKICAgICAgY3VzdG9tZXJVcmw6ICJVUkwiLAogICAgICBpZDogIklEIiwKICAgICAgbGluZUl0ZW1zOiAiT3JkZXJMaW5lSXRlbUNvbm5lY3Rpb24iLAogICAgICBvcmRlck51bWJlcjogIkludCIsCiAgICAgIHByb2Nlc3NlZEF0OiAiRGF0ZVRpbWUiLAogICAgICBzaGlwcGluZ0FkZHJlc3M6ICJNYWlsaW5nQWRkcmVzcyIsCiAgICAgIHN1YnRvdGFsUHJpY2U6ICJNb25leSIsCiAgICAgIHN1YnRvdGFsUHJpY2VWMjogIk1vbmV5VjIiLAogICAgICB0b3RhbFByaWNlOiAiTW9uZXkiLAogICAgICB0b3RhbFByaWNlVjI6ICJNb25leVYyIiwKICAgICAgdG90YWxSZWZ1bmRlZDogIk1vbmV5IiwKICAgICAgdG90YWxSZWZ1bmRlZFYyOiAiTW9uZXlWMiIsCiAgICAgIHRvdGFsU2hpcHBpbmdQcmljZTogIk1vbmV5IiwKICAgICAgdG90YWxTaGlwcGluZ1ByaWNlVjI6ICJNb25leVYyIiwKICAgICAgdG90YWxUYXg6ICJNb25leSIsCiAgICAgIHRvdGFsVGF4VjI6ICJNb25leVYyIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMAogIH0sCiAgICAgIE9yZGVyTGluZUl0ZW0gPSB7CiAgICBuYW1lOiAiT3JkZXJMaW5lSXRlbSIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGN1c3RvbUF0dHJpYnV0ZXM6ICJBdHRyaWJ1dGUiLAogICAgICBxdWFudGl0eTogIkludCIsCiAgICAgIHRpdGxlOiAiU3RyaW5nIiwKICAgICAgdmFyaWFudDogIlByb2R1Y3RWYXJpYW50IgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIE9yZGVyTGluZUl0ZW1Db25uZWN0aW9uID0gewogICAgbmFtZTogIk9yZGVyTGluZUl0ZW1Db25uZWN0aW9uIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgZWRnZXM6ICJPcmRlckxpbmVJdGVtRWRnZSIsCiAgICAgIHBhZ2VJbmZvOiAiUGFnZUluZm8iCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgT3JkZXJMaW5lSXRlbUVkZ2UgPSB7CiAgICBuYW1lOiAiT3JkZXJMaW5lSXRlbUVkZ2UiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBjdXJzb3I6ICJTdHJpbmciLAogICAgICBub2RlOiAiT3JkZXJMaW5lSXRlbSIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBQYWdlSW5mbyA9IHsKICAgIG5hbWU6ICJQYWdlSW5mbyIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGhhc05leHRQYWdlOiAiQm9vbGVhbiIsCiAgICAgIGhhc1ByZXZpb3VzUGFnZTogIkJvb2xlYW4iCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgUGF5bWVudFNldHRpbmdzID0gewogICAgbmFtZTogIlBheW1lbnRTZXR0aW5ncyIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGVuYWJsZWRQcmVzZW50bWVudEN1cnJlbmNpZXM6ICJDdXJyZW5jeUNvZGUiCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSA9IHsKICAgIG5hbWU6ICJQcmljaW5nUGVyY2VudGFnZVZhbHVlIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgcGVyY2VudGFnZTogIkZsb2F0IgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIFByaWNpbmdWYWx1ZSA9IHsKICAgIG5hbWU6ICJQcmljaW5nVmFsdWUiLAogICAga2luZDogIlVOSU9OIgogIH0sCiAgICAgIFByb2R1Y3QgPSB7CiAgICBuYW1lOiAiUHJvZHVjdCIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGF2YWlsYWJsZUZvclNhbGU6ICJCb29sZWFuIiwKICAgICAgY3JlYXRlZEF0OiAiRGF0ZVRpbWUiLAogICAgICBkZXNjcmlwdGlvbjogIlN0cmluZyIsCiAgICAgIGRlc2NyaXB0aW9uSHRtbDogIkhUTUwiLAogICAgICBoYW5kbGU6ICJTdHJpbmciLAogICAgICBpZDogIklEIiwKICAgICAgaW1hZ2VzOiAiSW1hZ2VDb25uZWN0aW9uIiwKICAgICAgb25saW5lU3RvcmVVcmw6ICJVUkwiLAogICAgICBvcHRpb25zOiAiUHJvZHVjdE9wdGlvbiIsCiAgICAgIHByb2R1Y3RUeXBlOiAiU3RyaW5nIiwKICAgICAgcHVibGlzaGVkQXQ6ICJEYXRlVGltZSIsCiAgICAgIHRpdGxlOiAiU3RyaW5nIiwKICAgICAgdXBkYXRlZEF0OiAiRGF0ZVRpbWUiLAogICAgICB2YXJpYW50czogIlByb2R1Y3RWYXJpYW50Q29ubmVjdGlvbiIsCiAgICAgIHZlbmRvcjogIlN0cmluZyIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITAKICB9LAogICAgICBQcm9kdWN0Q29ubmVjdGlvbiA9IHsKICAgIG5hbWU6ICJQcm9kdWN0Q29ubmVjdGlvbiIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGVkZ2VzOiAiUHJvZHVjdEVkZ2UiLAogICAgICBwYWdlSW5mbzogIlBhZ2VJbmZvIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIFByb2R1Y3RFZGdlID0gewogICAgbmFtZTogIlByb2R1Y3RFZGdlIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY3Vyc29yOiAiU3RyaW5nIiwKICAgICAgbm9kZTogIlByb2R1Y3QiCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgUHJvZHVjdE9wdGlvbiA9IHsKICAgIG5hbWU6ICJQcm9kdWN0T3B0aW9uIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgbmFtZTogIlN0cmluZyIsCiAgICAgIHZhbHVlczogIlN0cmluZyIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITAKICB9LAogICAgICBQcm9kdWN0VmFyaWFudCA9IHsKICAgIG5hbWU6ICJQcm9kdWN0VmFyaWFudCIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGF2YWlsYWJsZUZvclNhbGU6ICJCb29sZWFuIiwKICAgICAgY29tcGFyZUF0UHJpY2U6ICJNb25leSIsCiAgICAgIGNvbXBhcmVBdFByaWNlVjI6ICJNb25leVYyIiwKICAgICAgaWQ6ICJJRCIsCiAgICAgIGltYWdlOiAiSW1hZ2UiLAogICAgICBwcmVzZW50bWVudFByaWNlczogIlByb2R1Y3RWYXJpYW50UHJpY2VQYWlyQ29ubmVjdGlvbiIsCiAgICAgIHByaWNlOiAiTW9uZXkiLAogICAgICBwcmljZVYyOiAiTW9uZXlWMiIsCiAgICAgIHByb2R1Y3Q6ICJQcm9kdWN0IiwKICAgICAgc2VsZWN0ZWRPcHRpb25zOiAiU2VsZWN0ZWRPcHRpb24iLAogICAgICBza3U6ICJTdHJpbmciLAogICAgICB0aXRsZTogIlN0cmluZyIsCiAgICAgIHVuaXRQcmljZTogIk1vbmV5VjIiLAogICAgICB1bml0UHJpY2VNZWFzdXJlbWVudDogIlVuaXRQcmljZU1lYXN1cmVtZW50IiwKICAgICAgd2VpZ2h0OiAiRmxvYXQiCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICEwCiAgfSwKICAgICAgUHJvZHVjdFZhcmlhbnRDb25uZWN0aW9uID0gewogICAgbmFtZTogIlByb2R1Y3RWYXJpYW50Q29ubmVjdGlvbiIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGVkZ2VzOiAiUHJvZHVjdFZhcmlhbnRFZGdlIiwKICAgICAgcGFnZUluZm86ICJQYWdlSW5mbyIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBQcm9kdWN0VmFyaWFudEVkZ2UgPSB7CiAgICBuYW1lOiAiUHJvZHVjdFZhcmlhbnRFZGdlIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY3Vyc29yOiAiU3RyaW5nIiwKICAgICAgbm9kZTogIlByb2R1Y3RWYXJpYW50IgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIFByb2R1Y3RWYXJpYW50UHJpY2VQYWlyID0gewogICAgbmFtZTogIlByb2R1Y3RWYXJpYW50UHJpY2VQYWlyIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY29tcGFyZUF0UHJpY2U6ICJNb25leVYyIiwKICAgICAgcHJpY2U6ICJNb25leVYyIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIFByb2R1Y3RWYXJpYW50UHJpY2VQYWlyQ29ubmVjdGlvbiA9IHsKICAgIG5hbWU6ICJQcm9kdWN0VmFyaWFudFByaWNlUGFpckNvbm5lY3Rpb24iLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBlZGdlczogIlByb2R1Y3RWYXJpYW50UHJpY2VQYWlyRWRnZSIsCiAgICAgIHBhZ2VJbmZvOiAiUGFnZUluZm8iCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgUHJvZHVjdFZhcmlhbnRQcmljZVBhaXJFZGdlID0gewogICAgbmFtZTogIlByb2R1Y3RWYXJpYW50UHJpY2VQYWlyRWRnZSIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIG5vZGU6ICJQcm9kdWN0VmFyaWFudFByaWNlUGFpciIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBRdWVyeVJvb3QgPSB7CiAgICBuYW1lOiAiUXVlcnlSb290IiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgY29sbGVjdGlvbkJ5SGFuZGxlOiAiQ29sbGVjdGlvbiIsCiAgICAgIGNvbGxlY3Rpb25zOiAiQ29sbGVjdGlvbkNvbm5lY3Rpb24iLAogICAgICBub2RlOiAiTm9kZSIsCiAgICAgIG5vZGVzOiAiTm9kZSIsCiAgICAgIHByb2R1Y3RCeUhhbmRsZTogIlByb2R1Y3QiLAogICAgICBwcm9kdWN0czogIlByb2R1Y3RDb25uZWN0aW9uIiwKICAgICAgc2hvcDogIlNob3AiCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbiA9IHsKICAgIG5hbWU6ICJTY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgZGVzY3JpcHRpb246ICJTdHJpbmciCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgU2VsZWN0ZWRPcHRpb24gPSB7CiAgICBuYW1lOiAiU2VsZWN0ZWRPcHRpb24iLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBuYW1lOiAiU3RyaW5nIiwKICAgICAgdmFsdWU6ICJTdHJpbmciCiAgICB9LAogICAgaW1wbGVtZW50c05vZGU6ICExCiAgfSwKICAgICAgU2hpcHBpbmdSYXRlID0gewogICAgbmFtZTogIlNoaXBwaW5nUmF0ZSIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGhhbmRsZTogIlN0cmluZyIsCiAgICAgIHByaWNlOiAiTW9uZXkiLAogICAgICBwcmljZVYyOiAiTW9uZXlWMiIsCiAgICAgIHRpdGxlOiAiU3RyaW5nIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIFNob3AgPSB7CiAgICBuYW1lOiAiU2hvcCIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIGN1cnJlbmN5Q29kZTogIkN1cnJlbmN5Q29kZSIsCiAgICAgIGRlc2NyaXB0aW9uOiAiU3RyaW5nIiwKICAgICAgbW9uZXlGb3JtYXQ6ICJTdHJpbmciLAogICAgICBuYW1lOiAiU3RyaW5nIiwKICAgICAgcGF5bWVudFNldHRpbmdzOiAiUGF5bWVudFNldHRpbmdzIiwKICAgICAgcHJpbWFyeURvbWFpbjogIkRvbWFpbiIsCiAgICAgIHByaXZhY3lQb2xpY3k6ICJTaG9wUG9saWN5IiwKICAgICAgcmVmdW5kUG9saWN5OiAiU2hvcFBvbGljeSIsCiAgICAgIHRlcm1zT2ZTZXJ2aWNlOiAiU2hvcFBvbGljeSIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBTaG9wUG9saWN5ID0gewogICAgbmFtZTogIlNob3BQb2xpY3kiLAogICAga2luZDogIk9CSkVDVCIsCiAgICBmaWVsZEJhc2VUeXBlczogewogICAgICBib2R5OiAiU3RyaW5nIiwKICAgICAgaWQ6ICJJRCIsCiAgICAgIHRpdGxlOiAiU3RyaW5nIiwKICAgICAgdXJsOiAiVVJMIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMAogIH0sCiAgICAgIFN0cmluZyQxID0gewogICAgbmFtZTogIlN0cmluZyIsCiAgICBraW5kOiAiU0NBTEFSIgogIH0sCiAgICAgIFVSTCA9IHsKICAgIG5hbWU6ICJVUkwiLAogICAga2luZDogIlNDQUxBUiIKICB9LAogICAgICBVbml0UHJpY2VNZWFzdXJlbWVudCA9IHsKICAgIG5hbWU6ICJVbml0UHJpY2VNZWFzdXJlbWVudCIsCiAgICBraW5kOiAiT0JKRUNUIiwKICAgIGZpZWxkQmFzZVR5cGVzOiB7CiAgICAgIG1lYXN1cmVkVHlwZTogIlVuaXRQcmljZU1lYXN1cmVtZW50TWVhc3VyZWRUeXBlIiwKICAgICAgcXVhbnRpdHlVbml0OiAiVW5pdFByaWNlTWVhc3VyZW1lbnRNZWFzdXJlZFVuaXQiLAogICAgICBxdWFudGl0eVZhbHVlOiAiRmxvYXQiLAogICAgICByZWZlcmVuY2VVbml0OiAiVW5pdFByaWNlTWVhc3VyZW1lbnRNZWFzdXJlZFVuaXQiLAogICAgICByZWZlcmVuY2VWYWx1ZTogIkludCIKICAgIH0sCiAgICBpbXBsZW1lbnRzTm9kZTogITEKICB9LAogICAgICBVbml0UHJpY2VNZWFzdXJlbWVudE1lYXN1cmVkVHlwZSA9IHsKICAgIG5hbWU6ICJVbml0UHJpY2VNZWFzdXJlbWVudE1lYXN1cmVkVHlwZSIsCiAgICBraW5kOiAiRU5VTSIKICB9LAogICAgICBVbml0UHJpY2VNZWFzdXJlbWVudE1lYXN1cmVkVW5pdCA9IHsKICAgIG5hbWU6ICJVbml0UHJpY2VNZWFzdXJlbWVudE1lYXN1cmVkVW5pdCIsCiAgICBraW5kOiAiRU5VTSIKICB9LAogICAgICBVc2VyRXJyb3IgPSB7CiAgICBuYW1lOiAiVXNlckVycm9yIiwKICAgIGtpbmQ6ICJPQkpFQ1QiLAogICAgZmllbGRCYXNlVHlwZXM6IHsKICAgICAgZmllbGQ6ICJTdHJpbmciLAogICAgICBtZXNzYWdlOiAiU3RyaW5nIgogICAgfSwKICAgIGltcGxlbWVudHNOb2RlOiAhMQogIH0sCiAgICAgIFR5cGVzID0gewogICAgdHlwZXM6IHt9CiAgfTsKCiAgZnVuY3Rpb24gcmVjdXJzaXZlbHlGcmVlemVPYmplY3Qoc3RydWN0dXJlKSB7CiAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoc3RydWN0dXJlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgdmFyIHZhbHVlID0gc3RydWN0dXJlW2tleV07CiAgICAgIHZhbHVlICYmICJvYmplY3QiID09PSAodm9pZCAwID09PSB2YWx1ZSA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZih2YWx1ZSkpICYmIHJlY3Vyc2l2ZWx5RnJlZXplT2JqZWN0KHZhbHVlKTsKICAgIH0pLCBPYmplY3QuZnJlZXplKHN0cnVjdHVyZSksIHN0cnVjdHVyZTsKICB9CgogIFR5cGVzLnR5cGVzLkFwcGxpZWRHaWZ0Q2FyZCA9IEFwcGxpZWRHaWZ0Q2FyZCwgVHlwZXMudHlwZXMuQXR0cmlidXRlID0gQXR0cmlidXRlLCBUeXBlcy50eXBlcy5BdXRvbWF0aWNEaXNjb3VudEFwcGxpY2F0aW9uID0gQXV0b21hdGljRGlzY291bnRBcHBsaWNhdGlvbiwgVHlwZXMudHlwZXMuQm9vbGVhbiA9IEJvb2xlYW4kMSwgVHlwZXMudHlwZXMuQ2hlY2tvdXQgPSBDaGVja291dCwgVHlwZXMudHlwZXMuQ2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlVjJQYXlsb2FkID0gQ2hlY2tvdXRBdHRyaWJ1dGVzVXBkYXRlVjJQYXlsb2FkLCBUeXBlcy50eXBlcy5DaGVja291dENyZWF0ZVBheWxvYWQgPSBDaGVja291dENyZWF0ZVBheWxvYWQsIFR5cGVzLnR5cGVzLkNoZWNrb3V0RGlzY291bnRDb2RlQXBwbHlWMlBheWxvYWQgPSBDaGVja291dERpc2NvdW50Q29kZUFwcGx5VjJQYXlsb2FkLCBUeXBlcy50eXBlcy5DaGVja291dERpc2NvdW50Q29kZVJlbW92ZVBheWxvYWQgPSBDaGVja291dERpc2NvdW50Q29kZVJlbW92ZVBheWxvYWQsIFR5cGVzLnR5cGVzLkNoZWNrb3V0RW1haWxVcGRhdGVWMlBheWxvYWQgPSBDaGVja291dEVtYWlsVXBkYXRlVjJQYXlsb2FkLCBUeXBlcy50eXBlcy5DaGVja291dEVycm9yQ29kZSA9IENoZWNrb3V0RXJyb3JDb2RlLCBUeXBlcy50eXBlcy5DaGVja291dEdpZnRDYXJkUmVtb3ZlVjJQYXlsb2FkID0gQ2hlY2tvdXRHaWZ0Q2FyZFJlbW92ZVYyUGF5bG9hZCwgVHlwZXMudHlwZXMuQ2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmRQYXlsb2FkID0gQ2hlY2tvdXRHaWZ0Q2FyZHNBcHBlbmRQYXlsb2FkLCBUeXBlcy50eXBlcy5DaGVja291dExpbmVJdGVtID0gQ2hlY2tvdXRMaW5lSXRlbSwgVHlwZXMudHlwZXMuQ2hlY2tvdXRMaW5lSXRlbUNvbm5lY3Rpb24gPSBDaGVja291dExpbmVJdGVtQ29ubmVjdGlvbiwgVHlwZXMudHlwZXMuQ2hlY2tvdXRMaW5lSXRlbUVkZ2UgPSBDaGVja291dExpbmVJdGVtRWRnZSwgVHlwZXMudHlwZXMuQ2hlY2tvdXRMaW5lSXRlbXNBZGRQYXlsb2FkID0gQ2hlY2tvdXRMaW5lSXRlbXNBZGRQYXlsb2FkLCBUeXBlcy50eXBlcy5DaGVja291dExpbmVJdGVtc1JlbW92ZVBheWxvYWQgPSBDaGVja291dExpbmVJdGVtc1JlbW92ZVBheWxvYWQsIFR5cGVzLnR5cGVzLkNoZWNrb3V0TGluZUl0ZW1zUmVwbGFjZVBheWxvYWQgPSBDaGVja291dExpbmVJdGVtc1JlcGxhY2VQYXlsb2FkLCBUeXBlcy50eXBlcy5DaGVja291dExpbmVJdGVtc1VwZGF0ZVBheWxvYWQgPSBDaGVja291dExpbmVJdGVtc1VwZGF0ZVBheWxvYWQsIFR5cGVzLnR5cGVzLkNoZWNrb3V0U2hpcHBpbmdBZGRyZXNzVXBkYXRlVjJQYXlsb2FkID0gQ2hlY2tvdXRTaGlwcGluZ0FkZHJlc3NVcGRhdGVWMlBheWxvYWQsIFR5cGVzLnR5cGVzLkNoZWNrb3V0VXNlckVycm9yID0gQ2hlY2tvdXRVc2VyRXJyb3IsIFR5cGVzLnR5cGVzLkNvbGxlY3Rpb24gPSBDb2xsZWN0aW9uLCBUeXBlcy50eXBlcy5Db2xsZWN0aW9uQ29ubmVjdGlvbiA9IENvbGxlY3Rpb25Db25uZWN0aW9uLCBUeXBlcy50eXBlcy5Db2xsZWN0aW9uRWRnZSA9IENvbGxlY3Rpb25FZGdlLCBUeXBlcy50eXBlcy5Db3VudHJ5Q29kZSA9IENvdW50cnlDb2RlLCBUeXBlcy50eXBlcy5DdXJyZW5jeUNvZGUgPSBDdXJyZW5jeUNvZGUsIFR5cGVzLnR5cGVzLkRhdGVUaW1lID0gRGF0ZVRpbWUsIFR5cGVzLnR5cGVzLkRlY2ltYWwgPSBEZWNpbWFsLCBUeXBlcy50eXBlcy5EaXNjb3VudEFsbG9jYXRpb24gPSBEaXNjb3VudEFsbG9jYXRpb24sIFR5cGVzLnR5cGVzLkRpc2NvdW50QXBwbGljYXRpb24gPSBEaXNjb3VudEFwcGxpY2F0aW9uLCBUeXBlcy50eXBlcy5EaXNjb3VudEFwcGxpY2F0aW9uQWxsb2NhdGlvbk1ldGhvZCA9IERpc2NvdW50QXBwbGljYXRpb25BbGxvY2F0aW9uTWV0aG9kLCBUeXBlcy50eXBlcy5EaXNjb3VudEFwcGxpY2F0aW9uQ29ubmVjdGlvbiA9IERpc2NvdW50QXBwbGljYXRpb25Db25uZWN0aW9uLCBUeXBlcy50eXBlcy5EaXNjb3VudEFwcGxpY2F0aW9uRWRnZSA9IERpc2NvdW50QXBwbGljYXRpb25FZGdlLCBUeXBlcy50eXBlcy5EaXNjb3VudEFwcGxpY2F0aW9uVGFyZ2V0U2VsZWN0aW9uID0gRGlzY291bnRBcHBsaWNhdGlvblRhcmdldFNlbGVjdGlvbiwgVHlwZXMudHlwZXMuRGlzY291bnRBcHBsaWNhdGlvblRhcmdldFR5cGUgPSBEaXNjb3VudEFwcGxpY2F0aW9uVGFyZ2V0VHlwZSwgVHlwZXMudHlwZXMuRGlzY291bnRDb2RlQXBwbGljYXRpb24gPSBEaXNjb3VudENvZGVBcHBsaWNhdGlvbiwgVHlwZXMudHlwZXMuRG9tYWluID0gRG9tYWluLCBUeXBlcy50eXBlcy5GbG9hdCA9IEZsb2F0LCBUeXBlcy50eXBlcy5IVE1MID0gSFRNTCwgVHlwZXMudHlwZXMuSUQgPSBJRCwgVHlwZXMudHlwZXMuSW1hZ2UgPSBJbWFnZSwgVHlwZXMudHlwZXMuSW1hZ2VDb25uZWN0aW9uID0gSW1hZ2VDb25uZWN0aW9uLCBUeXBlcy50eXBlcy5JbWFnZUVkZ2UgPSBJbWFnZUVkZ2UsIFR5cGVzLnR5cGVzLkludCA9IEludCwgVHlwZXMudHlwZXMuTWFpbGluZ0FkZHJlc3MgPSBNYWlsaW5nQWRkcmVzcywgVHlwZXMudHlwZXMuTWFudWFsRGlzY291bnRBcHBsaWNhdGlvbiA9IE1hbnVhbERpc2NvdW50QXBwbGljYXRpb24sIFR5cGVzLnR5cGVzLk1vbmV5ID0gTW9uZXksIFR5cGVzLnR5cGVzLk1vbmV5VjIgPSBNb25leVYyLCBUeXBlcy50eXBlcy5NdXRhdGlvbiA9IE11dGF0aW9uJDEsIFR5cGVzLnR5cGVzLk5vZGUgPSBOb2RlLCBUeXBlcy50eXBlcy5PcmRlciA9IE9yZGVyLCBUeXBlcy50eXBlcy5PcmRlckxpbmVJdGVtID0gT3JkZXJMaW5lSXRlbSwgVHlwZXMudHlwZXMuT3JkZXJMaW5lSXRlbUNvbm5lY3Rpb24gPSBPcmRlckxpbmVJdGVtQ29ubmVjdGlvbiwgVHlwZXMudHlwZXMuT3JkZXJMaW5lSXRlbUVkZ2UgPSBPcmRlckxpbmVJdGVtRWRnZSwgVHlwZXMudHlwZXMuUGFnZUluZm8gPSBQYWdlSW5mbywgVHlwZXMudHlwZXMuUGF5bWVudFNldHRpbmdzID0gUGF5bWVudFNldHRpbmdzLCBUeXBlcy50eXBlcy5QcmljaW5nUGVyY2VudGFnZVZhbHVlID0gUHJpY2luZ1BlcmNlbnRhZ2VWYWx1ZSwgVHlwZXMudHlwZXMuUHJpY2luZ1ZhbHVlID0gUHJpY2luZ1ZhbHVlLCBUeXBlcy50eXBlcy5Qcm9kdWN0ID0gUHJvZHVjdCwgVHlwZXMudHlwZXMuUHJvZHVjdENvbm5lY3Rpb24gPSBQcm9kdWN0Q29ubmVjdGlvbiwgVHlwZXMudHlwZXMuUHJvZHVjdEVkZ2UgPSBQcm9kdWN0RWRnZSwgVHlwZXMudHlwZXMuUHJvZHVjdE9wdGlvbiA9IFByb2R1Y3RPcHRpb24sIFR5cGVzLnR5cGVzLlByb2R1Y3RWYXJpYW50ID0gUHJvZHVjdFZhcmlhbnQsIFR5cGVzLnR5cGVzLlByb2R1Y3RWYXJpYW50Q29ubmVjdGlvbiA9IFByb2R1Y3RWYXJpYW50Q29ubmVjdGlvbiwgVHlwZXMudHlwZXMuUHJvZHVjdFZhcmlhbnRFZGdlID0gUHJvZHVjdFZhcmlhbnRFZGdlLCBUeXBlcy50eXBlcy5Qcm9kdWN0VmFyaWFudFByaWNlUGFpciA9IFByb2R1Y3RWYXJpYW50UHJpY2VQYWlyLCBUeXBlcy50eXBlcy5Qcm9kdWN0VmFyaWFudFByaWNlUGFpckNvbm5lY3Rpb24gPSBQcm9kdWN0VmFyaWFudFByaWNlUGFpckNvbm5lY3Rpb24sIFR5cGVzLnR5cGVzLlByb2R1Y3RWYXJpYW50UHJpY2VQYWlyRWRnZSA9IFByb2R1Y3RWYXJpYW50UHJpY2VQYWlyRWRnZSwgVHlwZXMudHlwZXMuUXVlcnlSb290ID0gUXVlcnlSb290LCBUeXBlcy50eXBlcy5TY3JpcHREaXNjb3VudEFwcGxpY2F0aW9uID0gU2NyaXB0RGlzY291bnRBcHBsaWNhdGlvbiwgVHlwZXMudHlwZXMuU2VsZWN0ZWRPcHRpb24gPSBTZWxlY3RlZE9wdGlvbiwgVHlwZXMudHlwZXMuU2hpcHBpbmdSYXRlID0gU2hpcHBpbmdSYXRlLCBUeXBlcy50eXBlcy5TaG9wID0gU2hvcCwgVHlwZXMudHlwZXMuU2hvcFBvbGljeSA9IFNob3BQb2xpY3ksIFR5cGVzLnR5cGVzLlN0cmluZyA9IFN0cmluZyQxLCBUeXBlcy50eXBlcy5VUkwgPSBVUkwsIFR5cGVzLnR5cGVzLlVuaXRQcmljZU1lYXN1cmVtZW50ID0gVW5pdFByaWNlTWVhc3VyZW1lbnQsIFR5cGVzLnR5cGVzLlVuaXRQcmljZU1lYXN1cmVtZW50TWVhc3VyZWRUeXBlID0gVW5pdFByaWNlTWVhc3VyZW1lbnRNZWFzdXJlZFR5cGUsIFR5cGVzLnR5cGVzLlVuaXRQcmljZU1lYXN1cmVtZW50TWVhc3VyZWRVbml0ID0gVW5pdFByaWNlTWVhc3VyZW1lbnRNZWFzdXJlZFVuaXQsIFR5cGVzLnR5cGVzLlVzZXJFcnJvciA9IFVzZXJFcnJvciwgVHlwZXMucXVlcnlUeXBlID0gIlF1ZXJ5Um9vdCIsIFR5cGVzLm11dGF0aW9uVHlwZSA9ICJNdXRhdGlvbiIsIFR5cGVzLnN1YnNjcmlwdGlvblR5cGUgPSBudWxsOwoKICB2YXIgdHlwZXMgPSByZWN1cnNpdmVseUZyZWV6ZU9iamVjdChUeXBlcyksCiAgICAgIENsaWVudCwKICAgICAgc2hvcGlmeUJ1eSA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIENsaWVudChjb25maWcpIHsKICAgICAgdmFyIEdyYXBoUUxDbGllbnRDbGFzcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdID8gYXJndW1lbnRzWzFdIDogQ2xpZW50JDIsCiAgICAgICAgICBmZXRjaEZ1bmN0aW9uID0gYXJndW1lbnRzWzJdOwogICAgICBjbGFzc0NhbGxDaGVjayQxKHRoaXMsIENsaWVudCk7CiAgICAgIHZhciB1cmwgPSAiaHR0cHM6Ly8iICsgY29uZmlnLmRvbWFpbiArICIvYXBpLyIgKyBjb25maWcuYXBpVmVyc2lvbiArICIvZ3JhcGhxbCIsCiAgICAgICAgICBoZWFkZXJzID0gewogICAgICAgICJYLVNESy1WYXJpYW50IjogImphdmFzY3JpcHQiLAogICAgICAgICJYLVNESy1WZXJzaW9uIjogdmVyc2lvbiwKICAgICAgICAiWC1TaG9waWZ5LVN0b3JlZnJvbnQtQWNjZXNzLVRva2VuIjogY29uZmlnLnN0b3JlZnJvbnRBY2Nlc3NUb2tlbgogICAgICB9OwogICAgICBjb25maWcuc291cmNlICYmIChoZWFkZXJzWyJYLVNESy1WYXJpYW50LVNvdXJjZSJdID0gY29uZmlnLnNvdXJjZSk7CiAgICAgIHZhciBsYW5ndWFnZUhlYWRlciA9IGNvbmZpZy5sYW5ndWFnZSA/IGNvbmZpZy5sYW5ndWFnZSA6ICIqIjsKICAgICAgaGVhZGVyc1siQWNjZXB0LUxhbmd1YWdlIl0gPSBsYW5ndWFnZUhlYWRlciwgZmV0Y2hGdW5jdGlvbiA/IChoZWFkZXJzWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIiwgaGVhZGVycy5BY2NlcHQgPSAiYXBwbGljYXRpb24vanNvbiIsIHRoaXMuZ3JhcGhRTENsaWVudCA9IG5ldyBHcmFwaFFMQ2xpZW50Q2xhc3ModHlwZXMsIHsKICAgICAgICBmZXRjaGVyOiBmdW5jdGlvbiBmZXRjaGVyKGdyYXBoUUxQYXJhbXMpIHsKICAgICAgICAgIHJldHVybiBmZXRjaEZ1bmN0aW9uKHVybCwgewogICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShncmFwaFFMUGFyYW1zKSwKICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgIG1vZGU6ICJjb3JzIiwKICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycwogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkpIDogdGhpcy5ncmFwaFFMQ2xpZW50ID0gbmV3IEdyYXBoUUxDbGllbnRDbGFzcyh0eXBlcywgewogICAgICAgIHVybDogdXJsLAogICAgICAgIGZldGNoZXJPcHRpb25zOiB7CiAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzCiAgICAgICAgfQogICAgICB9KSwgdGhpcy5wcm9kdWN0ID0gbmV3IFByb2R1Y3RSZXNvdXJjZSh0aGlzLmdyYXBoUUxDbGllbnQpLCB0aGlzLmNvbGxlY3Rpb24gPSBuZXcgQ29sbGVjdGlvblJlc291cmNlKHRoaXMuZ3JhcGhRTENsaWVudCksIHRoaXMuc2hvcCA9IG5ldyBTaG9wUmVzb3VyY2UodGhpcy5ncmFwaFFMQ2xpZW50KSwgdGhpcy5jaGVja291dCA9IG5ldyBDaGVja291dFJlc291cmNlKHRoaXMuZ3JhcGhRTENsaWVudCksIHRoaXMuaW1hZ2UgPSBuZXcgSW1hZ2VSZXNvdXJjZSh0aGlzLmdyYXBoUUxDbGllbnQpOwogICAgfQoKICAgIHJldHVybiBjcmVhdGVDbGFzcyQxKENsaWVudCwgbnVsbCwgW3sKICAgICAga2V5OiAiYnVpbGRDbGllbnQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRDbGllbnQoY29uZmlnLCBmZXRjaEZ1bmN0aW9uKSB7CiAgICAgICAgdmFyIG5ld0NvbmZpZyA9IG5ldyBDb25maWcoY29uZmlnKSwKICAgICAgICAgICAgY2xpZW50ID0gbmV3IENsaWVudChuZXdDb25maWcsIENsaWVudCQyLCBmZXRjaEZ1bmN0aW9uKTsKICAgICAgICByZXR1cm4gY2xpZW50LmNvbmZpZyA9IG5ld0NvbmZpZywgY2xpZW50OwogICAgICB9CiAgICB9XSksIGNyZWF0ZUNsYXNzJDEoQ2xpZW50LCBbewogICAgICBrZXk6ICJmZXRjaE5leHRQYWdlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZldGNoTmV4dFBhZ2UobW9kZWxzKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhRTENsaWVudC5mZXRjaE5leHRQYWdlKG1vZGVscyk7CiAgICAgIH0KICAgIH1dKSwgQ2xpZW50OwogIH0oKTsKCiAgZnVuY3Rpb24gbWVyZ2UodGFyZ2V0KSB7CiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgc291cmNlcyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIHNvdXJjZXNbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIHJldHVybiBzb3VyY2VzLmZvckVhY2goZnVuY3Rpb24gKHNvdXJjZSkgewogICAgICBzb3VyY2UgJiYgT2JqZWN0LmtleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAiW29iamVjdCBPYmplY3RdIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHNvdXJjZVtrZXldKSA/IHRhcmdldFtrZXldID0gbWVyZ2UodGFyZ2V0W2tleV0gfHwge30sIHNvdXJjZVtrZXldKSA6IHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgICAgIH0pOwogICAgfSksIHRhcmdldDsKICB9CgogIGZ1bmN0aW9uIGlzRnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gISEob2JqICYmIG9iai5jb25zdHJ1Y3RvciAmJiBvYmouY2FsbCAmJiBvYmouYXBwbHkpOwogIH0KCiAgdmFyIHF1YW50aXR5VGVtcGxhdGUgPSAnPGRpdiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdC5xdWFudGl0eX19IHt7ZGF0YS5xdWFudGl0eUNsYXNzfX0iIGRhdGEtZWxlbWVudD0icHJvZHVjdC5xdWFudGl0eSI+XG4gICAgICAgICAgICB7eyNkYXRhLmNvbnRlbnRzLnF1YW50aXR5RGVjcmVtZW50fX1cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdC5xdWFudGl0eUJ1dHRvbn19IHt7ZGF0YS5jbGFzc2VzLnByb2R1Y3QucXVhbnRpdHlEZWNyZW1lbnR9fSIgdHlwZT0iYnV0dG9uIiBkYXRhLWVsZW1lbnQ9InByb2R1Y3QucXVhbnRpdHlEZWNyZW1lbnQiPjxzcGFuPi08L3NwYW4+PHNwYW4gY2xhc3M9InZpc3VhbGx5aGlkZGVuIj5EZWNyZW1lbnQ8L3NwYW4+PC9idXR0b24+XG4gICAgICAgICAgICB7ey9kYXRhLmNvbnRlbnRzLnF1YW50aXR5RGVjcmVtZW50fX1cbiAgICAgICAgICAgIHt7I2RhdGEuY29udGVudHMucXVhbnRpdHlJbnB1dH19XG4gICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdC5xdWFudGl0eUlucHV0fX0iIHR5cGU9Im51bWJlciIgbWluPSIwIiBhcmlhLWxhYmVsPSJRdWFudGl0eSIgdmFsdWU9Int7ZGF0YS5zZWxlY3RlZFF1YW50aXR5fX0iIGRhdGEtZWxlbWVudD0icHJvZHVjdC5xdWFudGl0eUlucHV0Ij5cbiAgICAgICAgICAgIHt7L2RhdGEuY29udGVudHMucXVhbnRpdHlJbnB1dH19XG4gICAgICAgICAgICB7eyNkYXRhLmNvbnRlbnRzLnF1YW50aXR5SW5jcmVtZW50fX1cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdC5xdWFudGl0eUJ1dHRvbn19IHt7ZGF0YS5jbGFzc2VzLnByb2R1Y3QucXVhbnRpdHlJbmNyZW1lbnR9fSIgdHlwZT0iYnV0dG9uIiBkYXRhLWVsZW1lbnQ9InByb2R1Y3QucXVhbnRpdHlJbmNyZW1lbnQiPjxzcGFuPis8L3NwYW4+PHNwYW4gY2xhc3M9InZpc3VhbGx5aGlkZGVuIj5JbmNyZW1lbnQ8L3NwYW4+PC9idXR0b24+XG4gICAgICAgICAgICB7ey9kYXRhLmNvbnRlbnRzLnF1YW50aXR5SW5jcmVtZW50fX1cbiAgICAgICAgICAgPC9kaXY+JywKICAgICAgYnV0dG9uVGVtcGxhdGUgPSAnPGRpdiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdC5idXR0b25XcmFwcGVyfX0iIGRhdGEtZWxlbWVudD0icHJvZHVjdC5idXR0b25XcmFwcGVyIj48YnV0dG9uIHt7I2RhdGEuYnV0dG9uRGlzYWJsZWR9fWRpc2FibGVke3svZGF0YS5idXR0b25EaXNhYmxlZH19IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0LmJ1dHRvbn19IHt7ZGF0YS5idXR0b25DbGFzc319IiBkYXRhLWVsZW1lbnQ9InByb2R1Y3QuYnV0dG9uIj57e2RhdGEuYnV0dG9uVGV4dH19PC9idXR0b24+PC9kaXY+JywKICAgICAgcHJvZHVjdFRlbXBsYXRlID0gewogICAgaW1nOiAne3sjZGF0YS5jdXJyZW50SW1hZ2Uuc3JjTGFyZ2V9fTxkaXYgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLnByb2R1Y3QuaW1nV3JhcHBlcn19IiBkYXRhLWVsZW1lbnQ9InByb2R1Y3QuaW1nV3JhcHBlciI+PGltZyBhbHQ9Int7ZGF0YS5jdXJyZW50SW1hZ2UuYWx0VGV4dH19IiBkYXRhLWVsZW1lbnQ9InByb2R1Y3QuaW1nIiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdC5pbWd9fSIgc3JjPSJ7e2RhdGEuY3VycmVudEltYWdlLnNyY0xhcmdlfX0iIC8+PC9kaXY+e3svZGF0YS5jdXJyZW50SW1hZ2Uuc3JjTGFyZ2V9fScsCiAgICBpbWdXaXRoQ2Fyb3VzZWw6ICc8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0LmltZ1dyYXBwZXJ9fSIgZGF0YS1lbGVtZW50PSJwcm9kdWN0LmltYWdlV3JhcHBlciI+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWFpbi1pbWFnZS13cmFwcGVyIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iY2Fyb3VzZWwtYnV0dG9uIGNhcm91c2VsLWJ1dHRvbi0tcHJldmlvdXMiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICBMZWZ0XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgY2xhc3M9ImNhcm91c2VsLWJ1dHRvbi1hcnJvdyIgc3JjPSIvL3Nka3Muc2hvcGlmeWNkbi5jb20vYnV5LWJ1dHRvbi9sYXRlc3QvYXJyb3cuc3ZnIiBhbHQ9IkNhcm91c2VsIEFycm93Ii8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLnByb2R1Y3QuaW1nfX0iIGFsdD0ie3tkYXRhLmN1cnJlbnRJbWFnZS5hbHRUZXh0fX0iIHNyYz0ie3tkYXRhLmN1cnJlbnRJbWFnZS5zcmN9fSIgZGF0YS1lbGVtZW50PSJwcm9kdWN0LmltZyIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iY2Fyb3VzZWwtYnV0dG9uIGNhcm91c2VsLWJ1dHRvbi0tbmV4dCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFJpZ2h0XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgY2xhc3M9ImNhcm91c2VsLWJ1dHRvbi1hcnJvdyIgc3JjPSIvL3Nka3Muc2hvcGlmeWNkbi5jb20vYnV5LWJ1dHRvbi9sYXRlc3QvYXJyb3cuc3ZnIiBhbHQ9IkNhcm91c2VsIEFycm93Ii8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0LmNhcm91c2VsfX0iPlxuICAgICAgICAgICAgICAgICAgICAgICAge3sjZGF0YS5jYXJvdXNlbEltYWdlc319XG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBkYXRhLWVsZW1lbnQ9InByb2R1Y3QuY2Fyb3VzZWxpdGVtIiBhcmlhLWxhYmVsPSJ7e2FsdFRleHR9fSIgaHJlZj0ie3tzcmN9fSIgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLnByb2R1Y3QuY2Fyb3VzZWxJdGVtfX0ge3sjaXNTZWxlY3RlZH19IHt7ZGF0YS5jbGFzc2VzLnByb2R1Y3QuY2Fyb3VzZWxJdGVtU2VsZWN0ZWR9fSB7ey9pc1NlbGVjdGVkfX0iIGRhdGEtaW1hZ2UtaWQ9Int7aWR9fSIgc3R5bGU9ImJhY2tncm91bmQtaW1hZ2U6IHVybCh7e2Nhcm91c2VsU3JjfX0pIj48L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICB7ey9kYXRhLmNhcm91c2VsSW1hZ2VzfX1cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+JywKICAgIHRpdGxlOiAnPGgxIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0LnRpdGxlfX0iIGRhdGEtZWxlbWVudD0icHJvZHVjdC50aXRsZSI+e3tkYXRhLnRpdGxlfX08L2gxPicsCiAgICB2YXJpYW50VGl0bGU6ICd7eyNkYXRhLmhhc1ZhcmlhbnRzfX08aDIgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLnByb2R1Y3QudmFyaWFudFRpdGxlfX0iIGRhdGEtZWxlbWVudD0icHJvZHVjdC52YXJpYW50VGl0bGUiPnt7ZGF0YS5zZWxlY3RlZFZhcmlhbnQudGl0bGV9fTwvaDI+e3svZGF0YS5oYXNWYXJpYW50c319JywKICAgIG9wdGlvbnM6ICd7eyNkYXRhLmhhc1ZhcmlhbnRzfX08ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0Lm9wdGlvbnN9fSIgZGF0YS1lbGVtZW50PSJwcm9kdWN0Lm9wdGlvbnMiPnt7e2RhdGEub3B0aW9uc0h0bWx9fX08L2Rpdj57ey9kYXRhLmhhc1ZhcmlhbnRzfX0nLAogICAgcHJpY2U6ICc8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0LnByaWNlc319IiBkYXRhLWVsZW1lbnQ9InByb2R1Y3QucHJpY2VzIj5cbiAgICAgICAgICAgIHt7I2RhdGEuc2VsZWN0ZWRWYXJpYW50fX1cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0LnByaWNlfX0ge3tkYXRhLnByaWNlQ2xhc3N9fSIgZGF0YS1lbGVtZW50PSJwcm9kdWN0LnByaWNlIj57e2RhdGEuZm9ybWF0dGVkUHJpY2V9fTwvc3Bhbj5cbiAgICAgICAgICAgIHt7I2RhdGEuc2VsZWN0ZWRWYXJpYW50LmNvbXBhcmVBdFByaWNlfX08c3BhbiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdC5jb21wYXJlQXR9fSIgZGF0YS1lbGVtZW50PSJwcm9kdWN0LmNvbXBhcmVBdCI+e3tkYXRhLmZvcm1hdHRlZENvbXBhcmVBdFByaWNlfX08L3NwYW4+e3svZGF0YS5zZWxlY3RlZFZhcmlhbnQuY29tcGFyZUF0UHJpY2V9fVxuICAgICAgICAgICAge3sjZGF0YS5zaG93VW5pdFByaWNlfX1cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLnByb2R1Y3QudW5pdFByaWNlfX0iIGRhdGEtZWxlbWVudD0icHJvZHVjdC51bml0UHJpY2UiPlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idmlzdWFsbHloaWRkZW4iPnt7ZGF0YS50ZXh0LnVuaXRQcmljZUFjY2Vzc2liaWxpdHlMYWJlbH19PC9zcGFuPlxuICAgICAgICAgICAgICB7e2RhdGEuZm9ybWF0dGVkVW5pdFByaWNlfX08c3BhbiBhcmlhLWhpZGRlbj0idHJ1ZSI+Lzwvc3Bhbj48c3BhbiBjbGFzcz0idmlzdWFsbHloaWRkZW4iPiZuYnNwO3t7ZGF0YS50ZXh0LnVuaXRQcmljZUFjY2Vzc2liaWxpdHlTZXBhcmF0b3J9fSZuYnNwOzwvc3Bhbj57e2RhdGEuZm9ybWF0dGVkVW5pdFByaWNlQmFzZVVuaXR9fVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7ey9kYXRhLnNob3dVbml0UHJpY2V9fVxuICAgICAgICAgICAge3svZGF0YS5zZWxlY3RlZFZhcmlhbnR9fVxuICAgICAgICAgIDwvZGl2PicsCiAgICBkZXNjcmlwdGlvbjogJzxkaXYgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLnByb2R1Y3QuZGVzY3JpcHRpb259fSIgZGF0YS1lbGVtZW50PSJwcm9kdWN0LmRlc2NyaXB0aW9uIj57e3tkYXRhLmRlc2NyaXB0aW9uSHRtbH19fTwvZGl2PicsCiAgICBidXR0b246IGJ1dHRvblRlbXBsYXRlLAogICAgcXVhbnRpdHk6IHF1YW50aXR5VGVtcGxhdGUsCiAgICBidXR0b25XaXRoUXVhbnRpdHk6ICc8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0LmJ1dHRvbldpdGhRdWFudGl0eX19IiBkYXRhLWVsZW1lbnQ9InByb2R1Y3QuYnV0dG9uV2l0aFF1YW50aXR5Ij4nLmNvbmNhdChxdWFudGl0eVRlbXBsYXRlKS5jb25jYXQoYnV0dG9uVGVtcGxhdGUsICI8L2Rpdj4iKQogIH0sCiAgICAgIGNhcnRUZW1wbGF0ZXMsCiAgICAgIG9wdGlvblRlbXBsYXRlcywKICAgICAgdG9nZ2xlVGVtcGxhdGVzLAogICAgICBsaW5lSXRlbVRlbXBsYXRlcywKICAgICAgbW9kYWxUZW1wbGF0ZXMsCiAgICAgIGRlZmF1bHRzID0gewogICAgcHJvZHVjdDogewogICAgICBpZnJhbWU6ICEwLAogICAgICBidXR0b25EZXN0aW5hdGlvbjogImNhcnQiLAogICAgICBpc0J1dHRvbjogITEsCiAgICAgIGxheW91dDogInZlcnRpY2FsIiwKICAgICAgbWFuaWZlc3Q6IFsicHJvZHVjdCIsICJvcHRpb24iXSwKICAgICAgd2lkdGg6ICIyODBweCIsCiAgICAgIG9yZGVyOiBbImltZyIsICJpbWdXaXRoQ2Fyb3VzZWwiLCAidGl0bGUiLCAidmFyaWFudFRpdGxlIiwgInByaWNlIiwgIm9wdGlvbnMiLCAicXVhbnRpdHkiLCAiYnV0dG9uIiwgImJ1dHRvbldpdGhRdWFudGl0eSIsICJkZXNjcmlwdGlvbiJdLAogICAgICBjb250ZW50czogewogICAgICAgIGltZzogITAsCiAgICAgICAgaW1nV2l0aENhcm91c2VsOiAhMSwKICAgICAgICB0aXRsZTogITAsCiAgICAgICAgdmFyaWFudFRpdGxlOiAhMSwKICAgICAgICBwcmljZTogITAsCiAgICAgICAgdW5pdFByaWNlOiAhMCwKICAgICAgICBvcHRpb25zOiAhMCwKICAgICAgICBxdWFudGl0eTogITEsCiAgICAgICAgcXVhbnRpdHlJbmNyZW1lbnQ6ICExLAogICAgICAgIHF1YW50aXR5RGVjcmVtZW50OiAhMSwKICAgICAgICBxdWFudGl0eUlucHV0OiAhMCwKICAgICAgICBidXR0b246ICEwLAogICAgICAgIGJ1dHRvbldpdGhRdWFudGl0eTogITEsCiAgICAgICAgZGVzY3JpcHRpb246ICExCiAgICAgIH0sCiAgICAgIHRlbXBsYXRlczogcHJvZHVjdFRlbXBsYXRlLAogICAgICBjbGFzc2VzOiB7CiAgICAgICAgd3JhcHBlcjogInNob3BpZnktYnV5X19wcm9kdWN0LXdyYXBwZXIiLAogICAgICAgIHByb2R1Y3Q6ICJzaG9waWZ5LWJ1eV9fcHJvZHVjdCIsCiAgICAgICAgaW1nOiAic2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtaW1nIiwKICAgICAgICBpbWdXcmFwcGVyOiAic2hvcGlmeS1idXlfX3Byb2R1Y3QtaW1nLXdyYXBwZXIiLAogICAgICAgIGNhcm91c2VsOiAic2hvcGlmeS1idXlfX2Nhcm91c2VsIiwKICAgICAgICBjYXJvdXNlbE5leHQ6ICJjYXJvdXNlbC1idXR0b24tLW5leHQiLAogICAgICAgIGNhcm91c2VsUHJldmlvdXM6ICJjYXJvdXNlbC1idXR0b24tLXByZXZpb3VzIiwKICAgICAgICBjYXJvdXNlbEl0ZW06ICJzaG9waWZ5LWJ1eV9fY2Fyb3VzZWwtaXRlbSIsCiAgICAgICAgY2Fyb3VzZWxJdGVtU2VsZWN0ZWQ6ICJzaG9waWZ5LWJ1eV9fY2Fyb3VzZWwtaXRlbS0tc2VsZWN0ZWQiLAogICAgICAgIGJsb2NrQnV0dG9uOiAic2hvcGlmeS1idXlfX2J0bi0tcGFyZW50IiwKICAgICAgICBidXR0b246ICJzaG9waWZ5LWJ1eV9fYnRuIiwKICAgICAgICBidXR0b25XcmFwcGVyOiAic2hvcGlmeS1idXlfX2J0bi13cmFwcGVyIiwKICAgICAgICB0aXRsZTogInNob3BpZnktYnV5X19wcm9kdWN0X190aXRsZSIsCiAgICAgICAgcHJpY2VzOiAic2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ByaWNlIiwKICAgICAgICBwcmljZTogInNob3BpZnktYnV5X19wcm9kdWN0X19hY3R1YWwtcHJpY2UiLAogICAgICAgIGNvbXBhcmVBdDogInNob3BpZnktYnV5X19wcm9kdWN0X19jb21wYXJlLXByaWNlIiwKICAgICAgICB1bml0UHJpY2U6ICJzaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdW5pdC1wcmljZSIsCiAgICAgICAgbG93ZXJlZFByaWNlOiAic2hvcGlmeS1idXlfX3ByaWNlLS1sb3dlcmVkIiwKICAgICAgICB2YXJpYW50VGl0bGU6ICJzaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC10aXRsZSIsCiAgICAgICAgZGVzY3JpcHRpb246ICJzaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiIsCiAgICAgICAgb3B0aW9uczogInNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXNlbGVjdG9ycyIsCiAgICAgICAgZGlzYWJsZWQ6ICJzaG9waWZ5LWJ1eV9fYnRuLWRpc2FibGVkIiwKICAgICAgICBidXR0b25CZXNpZGVRdHk6ICJzaG9waWZ5LWJ1eV9fYmVzaWRlLXF1YW50aXR5IiwKICAgICAgICBxdWFudGl0eTogInNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIiLAogICAgICAgIHF1YW50aXR5SW5wdXQ6ICJzaG9waWZ5LWJ1eV9fcXVhbnRpdHkiLAogICAgICAgIHF1YW50aXR5QnV0dG9uOiAic2hvcGlmeS1idXlfX2J0bi0tc2VhbWxlc3MiLAogICAgICAgIHF1YW50aXR5SW5jcmVtZW50OiAic2hvcGlmeS1idXlfX3F1YW50aXR5LWluY3JlbWVudCIsCiAgICAgICAgcXVhbnRpdHlEZWNyZW1lbnQ6ICJzaG9waWZ5LWJ1eV9fcXVhbnRpdHktZGVjcmVtZW50IiwKICAgICAgICBidXR0b25XaXRoUXVhbnRpdHk6ICJzaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSIsCiAgICAgICAgcXVhbnRpdHlXaXRoQnV0dG9uczogInNob3BpZnktYnV5X19xdWFudGl0eS13aXRoLWJ0bnMiLAogICAgICAgIHZlcnRpY2FsOiAic2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCIsCiAgICAgICAgaG9yaXpvbnRhbDogInNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCIKICAgICAgfSwKICAgICAgdGV4dDogewogICAgICAgIGJ1dHRvbjogIkFERCBUTyBDQVJUIiwKICAgICAgICBvdXRPZlN0b2NrOiAiT3V0IG9mIHN0b2NrIiwKICAgICAgICB1bmF2YWlsYWJsZTogIlVuYXZhaWxhYmxlIiwKICAgICAgICB1bml0UHJpY2VBY2Nlc3NpYmlsaXR5TGFiZWw6ICJVbml0IHByaWNlIiwKICAgICAgICB1bml0UHJpY2VBY2Nlc3NpYmlsaXR5U2VwYXJhdG9yOiAicGVyIgogICAgICB9CiAgICB9LAogICAgbW9kYWxQcm9kdWN0OiB7CiAgICAgIGlmcmFtZTogITEsCiAgICAgIGxheW91dDogImhvcml6b250YWwiLAogICAgICBjb250ZW50czogewogICAgICAgIGltZzogITAsCiAgICAgICAgaW1nV2l0aENhcm91c2VsOiAhMSwKICAgICAgICB0aXRsZTogITAsCiAgICAgICAgdmFyaWFudFRpdGxlOiAhMSwKICAgICAgICBwcmljZTogITAsCiAgICAgICAgdW5pdFByaWNlOiAhMCwKICAgICAgICBvcHRpb25zOiAhMCwKICAgICAgICBidXR0b246ICEwLAogICAgICAgIGJ1dHRvbldpdGhRdWFudGl0eTogITEsCiAgICAgICAgcXVhbnRpdHk6ICExLAogICAgICAgIHF1YW50aXR5SW5jcmVtZW50OiAhMSwKICAgICAgICBxdWFudGl0eURlY3JlbWVudDogITEsCiAgICAgICAgZGVzY3JpcHRpb246ICEwCiAgICAgIH0sCiAgICAgIG9yZGVyOiBbImltZyIsICJpbWdXaXRoQ2Fyb3VzZWwiLCAidGl0bGUiLCAidmFyaWFudFRpdGxlIiwgInByaWNlIiwgIm9wdGlvbnMiLCAiYnV0dG9uV2l0aFF1YW50aXR5IiwgImJ1dHRvbiIsICJkZXNjcmlwdGlvbiJdLAogICAgICBjbGFzc2VzOiB7CiAgICAgICAgd3JhcHBlcjogInNob3BpZnktYnV5X19tb2RhbC1wcm9kdWN0LXdyYXBwZXIiLAogICAgICAgIGhhc0ltYWdlOiAiaGFzLWltYWdlIgogICAgICB9LAogICAgICBidXR0b25EZXN0aW5hdGlvbjogImNhcnQiLAogICAgICB0ZXh0OiB7CiAgICAgICAgYnV0dG9uOiAiQUREIFRPIENBUlQiCiAgICAgIH0KICAgIH0sCiAgICBtb2RhbDogewogICAgICBpZnJhbWU6ICEwLAogICAgICBtYW5pZmVzdDogWyJtb2RhbCIsICJwcm9kdWN0IiwgIm9wdGlvbiJdLAogICAgICBjbGFzc2VzOiB7CiAgICAgICAgb3ZlcmxheTogInNob3BpZnktYnV5X19tb2RhbC1vdmVybGF5IiwKICAgICAgICBtb2RhbDogInNob3BpZnktYnV5X19tb2RhbCIsCiAgICAgICAgY29udGVudHM6ICJzaG9waWZ5LWJ1eV9fbW9kYWwtY29udGVudHMiLAogICAgICAgIGNsb3NlOiAic2hvcGlmeS1idXlfX2J0bi0tY2xvc2UiLAogICAgICAgIHdyYXBwZXI6ICJzaG9waWZ5LWJ1eV9fbW9kYWwtd3JhcHBlciIsCiAgICAgICAgcHJvZHVjdDogInNob3BpZnktYnV5X19wcm9kdWN0LW1vZGFsIiwKICAgICAgICBpbWc6ICJzaG9waWZ5LWJ1eV9fbW9kYWwtaW1nIiwKICAgICAgICBpbWdXaXRoQ2Fyb3VzZWw6ICJzaG9waWZ5LWJ1eV9fbW9kYWwtaW1nIiwKICAgICAgICBmb290ZXI6ICJzaG9waWZ5LWJ1eV9fbW9kYWwtZm9vdGVyIiwKICAgICAgICBmb290ZXJXaXRoSW1nOiAic2hvcGlmeS1idXlfX21vZGFsLWZvb3Rlci0taGFzLWltZyIsCiAgICAgICAgaW1nV2l0aEltZzogInNob3BpZnktYnV5X19tb2RhbC1pbWctLWhhcy1pbWciLAogICAgICAgIGNvbnRlbnRzV2l0aEltZzogInNob3BpZnktYnV5X19tb2RhbC1jb250ZW50cy0taGFzLWltZyIsCiAgICAgICAgc2Nyb2xsQ29udGVudHM6ICJzaG9waWZ5LWJ1eV9fbW9kYWwtc2Nyb2xsLWNvbnRlbnRzIgogICAgICB9LAogICAgICBjb250ZW50czogewogICAgICAgIGNvbnRlbnRzOiAhMAogICAgICB9LAogICAgICBvcmRlcjogWyJjb250ZW50cyJdLAogICAgICB0ZW1wbGF0ZXM6IHsKICAgICAgICBjb250ZW50czogJ1xuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5tb2RhbC5jbG9zZX19IiBkYXRhLWVsZW1lbnQ9Im1vZGFsLmNsb3NlIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBhcmlhLXJvbGU9ImhpZGRlbiI+JnRpbWVzOzwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idmlzdWFsbHloaWRkZW4iPkNsb3NlPC9zcGFuPlxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICcKICAgICAgfQogICAgfSwKICAgIHByb2R1Y3RTZXQ6IHsKICAgICAgaWZyYW1lOiAhMCwKICAgICAgbWFuaWZlc3Q6IFsicHJvZHVjdCIsICJvcHRpb24iLCAicHJvZHVjdFNldCJdLAogICAgICBjb250ZW50czogewogICAgICAgIHRpdGxlOiAhMSwKICAgICAgICBwcm9kdWN0czogITAsCiAgICAgICAgcGFnaW5hdGlvbjogITAKICAgICAgfSwKICAgICAgb3JkZXI6IFsidGl0bGUiLCAicHJvZHVjdHMiLCAicGFnaW5hdGlvbiJdLAogICAgICB0ZW1wbGF0ZXM6IHsKICAgICAgICB0aXRsZTogJzxoMiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdFNldC50aXRsZX19Ij57e2RhdGEuY29sbGVjdGlvbi5hdHRycy50aXRsZX19PC9oMj4nLAogICAgICAgIHByb2R1Y3RzOiAnPGRpdiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMucHJvZHVjdFNldC5wcm9kdWN0c319Ij48L2Rpdj4nLAogICAgICAgIHBhZ2luYXRpb246ICc8YnV0dG9uIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5wcm9kdWN0U2V0LnBhZ2luYXRpb25CdXR0b259fSB7e2RhdGEubmV4dEJ1dHRvbkNsYXNzfX0iPnt7ZGF0YS50ZXh0Lm5leHRQYWdlQnV0dG9ufX08L2J1dHRvbj4nCiAgICAgIH0sCiAgICAgIGNsYXNzZXM6IHsKICAgICAgICB3cmFwcGVyOiAic2hvcGlmeS1idXlfX2NvbGxlY3Rpb24td3JhcHBlciIsCiAgICAgICAgcHJvZHVjdFNldDogInNob3BpZnktYnV5X19jb2xsZWN0aW9uIiwKICAgICAgICB0aXRsZTogInNob3BpZnktYnV5X19jb2xsZWN0aW9uX190aXRsZSIsCiAgICAgICAgY29sbGVjdGlvbjogInNob3BpZnktYnV5X19jb2xsZWN0aW9uIiwKICAgICAgICBwcm9kdWN0czogInNob3BpZnktYnV5X19jb2xsZWN0aW9uLXByb2R1Y3RzIiwKICAgICAgICBwcm9kdWN0OiAic2hvcGlmeS1idXlfX2NvbGxlY3Rpb24tcHJvZHVjdCIsCiAgICAgICAgcGFnaW5hdGlvbkJ1dHRvbjogInNob3BpZnktYnV5X19jb2xsZWN0aW9uLXBhZ2luYXRpb24tYnV0dG9uIHNob3BpZnktYnV5X19idG4iCiAgICAgIH0sCiAgICAgIHRleHQ6IHsKICAgICAgICBuZXh0UGFnZUJ1dHRvbjogIk5leHQgcGFnZSIKICAgICAgfQogICAgfSwKICAgIG9wdGlvbjogewogICAgICB0ZW1wbGF0ZXM6IHsKICAgICAgICBvcHRpb246ICc8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5vcHRpb24ub3B0aW9ufX0iIGRhdGEtZWxlbWVudD0ib3B0aW9uLm9wdGlvbiI+XG4gICAgPGxhYmVsIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5vcHRpb24ubGFiZWx9fSB7eyNkYXRhLm9ubHlPcHRpb259fXt7ZGF0YS5jbGFzc2VzLm9wdGlvbi5oaWRkZW5MYWJlbH19e3svZGF0YS5vbmx5T3B0aW9ufX0iIGRhdGEtZWxlbWVudD0ib3B0aW9uLmxhYmVsIj57e2RhdGEubmFtZX19PC9sYWJlbD5cbiAgICAgIDxkaXYgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLm9wdGlvbi53cmFwcGVyfX0iIGRhdGEtZWxlbWVudD0ib3B0aW9uLndyYXBwZXIiPlxuICAgICAgPHNlbGVjdCBjbGFzcz0ie3tkYXRhLmNsYXNzZXMub3B0aW9uLnNlbGVjdH19IiBuYW1lPSJ7e2RhdGEubmFtZX19IiBkYXRhLWVsZW1lbnQ9Im9wdGlvbi5zZWxlY3QiPlxuICAgICAgICB7eyNkYXRhLnZhbHVlc319XG4gICAgICAgICAgPG9wdGlvbiB7eyNzZWxlY3RlZH19c2VsZWN0ZWR7ey9zZWxlY3RlZH19IHZhbHVlPSJ7e25hbWV9fSI+e3tuYW1lfX08L29wdGlvbj5cbiAgICAgICAge3svZGF0YS52YWx1ZXN9fVxuICAgICAgPC9zZWxlY3Q+XG4gICAgICA8c3ZnIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5vcHRpb24uc2VsZWN0SWNvbn19IiBkYXRhLWVsZW1lbnQ9Im9wdGlvbi5zZWxlY3RJY29uIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0yMSA1LjE3NmwtOS4wODYgOS4zNTNMMyA1LjE3Ni42ODYgNy42NDcgMTIgMTkuMzgyIDIzLjMxNCA3LjY0NyAyMSA1LjE3NnoiPjwvcGF0aD48L3N2Zz5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+JwogICAgICB9LAogICAgICBjb250ZW50czogewogICAgICAgIG9wdGlvbjogITAKICAgICAgfSwKICAgICAgb3JkZXI6IFsib3B0aW9uIl0sCiAgICAgIGNsYXNzZXM6IHsKICAgICAgICBvcHRpb246ICJzaG9waWZ5LWJ1eV9fb3B0aW9uLXNlbGVjdCIsCiAgICAgICAgd3JhcHBlcjogInNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0LXdyYXBwZXIiLAogICAgICAgIHNlbGVjdDogInNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0X19zZWxlY3QiLAogICAgICAgIGxhYmVsOiAic2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3RfX2xhYmVsIiwKICAgICAgICBvcHRpb25EaXNhYmxlZDogInNob3BpZnktYnV5X19vcHRpb24tLWRpc2FibGVkIiwKICAgICAgICBvcHRpb25TZWxlY3RlZDogInNob3BpZnktYnV5X19vcHRpb24tLXNlbGVjdGVkIiwKICAgICAgICBzZWxlY3RJY29uOiAic2hvcGlmeS1idXlfX3NlbGVjdC1pY29uIiwKICAgICAgICBoaWRkZW5MYWJlbDogInZpc3VhbGx5aGlkZGVuIgogICAgICB9CiAgICB9LAogICAgY2FydDogewogICAgICBpZnJhbWU6ICEwLAogICAgICB0ZW1wbGF0ZXM6IHsKICAgICAgICB0aXRsZTogJzxkaXYgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLmNhcnQuaGVhZGVyfX0iIGRhdGEtZWxlbWVudD0iY2FydC5oZWFkZXIiPlxuICAgICAgICAgICAgPGgyIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5jYXJ0LnRpdGxlfX0iIGRhdGEtZWxlbWVudD0iY2FydC50aXRsZSI+e3tkYXRhLnRleHQudGl0bGV9fTwvaDI+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5jYXJ0LmNsb3NlfX0iIGRhdGEtZWxlbWVudD0iY2FydC5jbG9zZSI+XG4gICAgICAgICAgICAgIDxzcGFuIGFyaWEtcm9sZT0iaGlkZGVuIj4mdGltZXM7PC9zcGFuPlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idmlzdWFsbHloaWRkZW4iPkNsb3NlPC9zcGFuPlxuICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PicsCiAgICAgICAgbGluZUl0ZW1zOiAnPGRpdiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMuY2FydC5jYXJ0U2Nyb2xsfX17eyNkYXRhLmNvbnRlbnRzLm5vdGV9fSB7e2RhdGEuY2xhc3Nlcy5jYXJ0LmNhcnRTY3JvbGxXaXRoQ2FydE5vdGV9fXt7L2RhdGEuY29udGVudHMubm90ZX19e3sjZGF0YS5kaXNjb3VudHN9fSB7e2RhdGEuY2xhc3Nlcy5jYXJ0LmNhcnRTY3JvbGxXaXRoRGlzY291bnRzfX17ey9kYXRhLmRpc2NvdW50c319IiBkYXRhLWVsZW1lbnQ9ImNhcnQuY2FydFNjcm9sbCI+XG4gICAgICAgICAgICAgICAge3sjZGF0YS5pc0VtcHR5fX08cCBjbGFzcz0ie3tkYXRhLmNsYXNzZXMuY2FydC5lbXB0eX19IHt7ZGF0YS5jbGFzc2VzLmNhcnQuZW1wdHlDYXJ0fX0iIGRhdGEtZWxlbWVudD0iY2FydC5lbXB0eSI+e3tkYXRhLnRleHQuZW1wdHl9fTwvcD57ey9kYXRhLmlzRW1wdHl9fVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLmNhcnQubGluZUl0ZW1zfX0iIGRhdGEtZWxlbWVudD0iY2FydC5saW5lSXRlbXMiPnt7e2RhdGEubGluZUl0ZW1zSHRtbH19fTwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj4nLAogICAgICAgIGZvb3RlcjogJ3t7XmRhdGEuaXNFbXB0eX19XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5jYXJ0LmZvb3Rlcn19IiBkYXRhLWVsZW1lbnQ9ImNhcnQuZm9vdGVyIj5cbiAgICAgICAgICAgICAge3sjZGF0YS5kaXNjb3VudHN9fVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLmNhcnQuZGlzY291bnR9fSIgZGF0YS1lbGVtZW50PSJjYXJ0LmRpc2NvdW50Ij5cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5jYXJ0LmRpc2NvdW50VGV4dH19IiBkYXRhLWVsZW1lbnQ9ImNhcnQuZGlzY291bnRUZXh0Ij5cbiAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAxMiIgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLmNhcnQuZGlzY291bnRJY29ufX0iIGRhdGEtZWxlbWVudD0iY2FydC5kaXNjb3VudEljb24iIGFyaWEtaGlkZGVuPSJ0cnVlIj5cbiAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTAuMDAxIDIuOTk4NTZDOS44MDMyNyAyLjk5ODU2IDkuNjEwMDIgMi45Mzk5NCA5LjQ0NTY1IDIuODMwMTFDOS4yODEyOCAyLjcyMDI5IDkuMTUzMTcgMi41NjQxOCA5LjA3NzUyIDIuMzgxNTVDOS4wMDE4NyAyLjE5ODkxIDguOTgyMDcgMS45OTc5NCA5LjAyMDY0IDEuODA0MDVDOS4wNTkyMSAxLjYxMDE2IDkuMTU0NCAxLjQzMjA3IDkuMjk0MTkgMS4yOTIyOEM5LjQzMzk3IDEuMTUyNSA5LjYxMjA3IDEuMDU3MyA5LjgwNTk2IDEuMDE4NzRDOS45OTk4NCAwLjk4MDE3MSAxMC4yMDA4IDAuOTk5OTY1IDEwLjM4MzQgMS4wNzU2MkMxMC41NjYxIDEuMTUxMjcgMTAuNzIyMiAxLjI3OTM4IDEwLjgzMiAxLjQ0Mzc1QzEwLjk0MTggMS42MDgxMiAxMS4wMDA1IDEuODAxMzYgMTEuMDAwNSAxLjk5OTA1QzExLjAwMDUgMi4yNjQxNCAxMC44OTUyIDIuNTE4MzcgMTAuNzA3NyAyLjcwNTgxQzEwLjUyMDMgMi44OTMyNiAxMC4yNjYgMi45OTg1NiAxMC4wMDEgMi45OTg1NlpNMTAuMDAxIDEuNjcwNjJlLTA1SDcuMDAyNEM2Ljg3MDg2IC0wLjAwMDc0MzgxOCA2Ljc0MDQ2IDAuMDI0NDY5IDYuNjE4NjggMC4wNzQyMDk1QzYuNDk2OTEgMC4xMjM5NSA2LjM4NjE0IDAuMTk3MjQgNi4yOTI3NSAwLjI4OTg3NkwwLjI5NTY1NSA2LjI4Njk3QzAuMjAxOTcyIDYuMzc5ODkgMC4xMjc2MTQgNi40OTA0NCAwLjA3Njg2OTcgNi42MTIyNEMwLjAyNjEyNTYgNi43MzQwNCAwIDYuODY0NjggMCA2Ljk5NjYzQzAgNy4xMjg1NyAwLjAyNjEyNTYgNy4yNTkyMiAwLjA3Njg2OTcgNy4zODEwMkMwLjEyNzYxNCA3LjUwMjgyIDAuMjAxOTcyIDcuNjEzMzYgMC4yOTU2NTUgNy43MDYyOEw0LjI5MzcyIDExLjcwNDNDNC4zODY2NCAxMS43OTggNC40OTcxOCAxMS44NzI0IDQuNjE4OTggMTEuOTIzMUM0Ljc0MDc4IDExLjk3MzkgNC44NzE0MyAxMiA1LjAwMzM3IDEyQzUuMTM1MzIgMTIgNS4yNjU5NiAxMS45NzM5IDUuMzg3NzYgMTEuOTIzMUM1LjUwOTU2IDExLjg3MjQgNS42MjAxMSAxMS43OTggNS43MTMwMyAxMS43MDQzQzUuOTAyOTQgMTEuNTA0NCAxMS41MTAyIDUuODk3MTYgMTEuNzEwMSA1LjcwNzI1QzExLjgwMjggNS42MTM4NiAxMS44NzYgNS41MDMwOSAxMS45MjU4IDUuMzgxMzJDMTEuOTc1NSA1LjI1OTU0IDEyLjAwMDcgNS4xMjkxNCAxMiA0Ljk5NzU5VjEuOTk5MDVDMTIgMS40Njg4NyAxMS43ODk0IDAuOTYwNDEgMTEuNDE0NSAwLjU4NTUxOUMxMS4wMzk2IDAuMjEwNjI4IDEwLjUzMTEgMS42NzA2MmUtMDUgMTAuMDAxIDEuNjcwNjJlLTA1WiIgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ2aXN1YWxseWhpZGRlbiI+RGlzY291bnQ6PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICB7e3RleHR9fVxuICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Int7ZGF0YS5jbGFzc2VzLmNhcnQuZGlzY291bnRBbW91bnR9fSIgZGF0YS1lbGVtZW50PSJjYXJ0LmRpc2NvdW50QW1vdW50Ij57e2Ftb3VudH19PC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB7ey9kYXRhLmRpc2NvdW50c319XG4gICAgICAgICAgICAgIDxwIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5jYXJ0LnN1YnRvdGFsVGV4dH19IiBkYXRhLWVsZW1lbnQ9ImNhcnQudG90YWwiPnt7ZGF0YS50ZXh0LnRvdGFsfX08L3A+XG4gICAgICAgICAgICAgIDxwIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5jYXJ0LnN1YnRvdGFsfX0iIGRhdGEtZWxlbWVudD0iY2FydC5zdWJ0b3RhbCI+e3tkYXRhLmZvcm1hdHRlZFRvdGFsfX08L3A+XG4gICAgICAgICAgICAgIHt7I2RhdGEuY29udGVudHMubm90ZX19XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMuY2FydC5ub3RlfX0iIGRhdGEtZWxlbWVudD0iY2FydC5ub3RlIj5cbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5jYXJ0Lm5vdGVEZXNjcmlwdGlvbn19IiBkYXRhLWVsZW1lbnQ9ImNhcnQubm90ZURlc2NyaXB0aW9uIj57e2RhdGEudGV4dC5ub3RlRGVzY3JpcHRpb259fTwvcD5cbiAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz0ie3tkYXRhLmNsYXNzZXMuY2FydC5ub3RlVGV4dEFyZWF9fSIgZGF0YS1lbGVtZW50PSJjYXJ0Lm5vdGVUZXh0QXJlYSIgcm93cz0iMyIvPnt7ZGF0YS5jYXJ0Tm90ZX19PC90ZXh0YXJlYT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAge3svZGF0YS5jb250ZW50cy5ub3RlfX1cbiAgICAgICAgICAgICAgPHAgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLmNhcnQubm90aWNlfX0iIGRhdGEtZWxlbWVudD0iY2FydC5ub3RpY2UiPnt7ZGF0YS50ZXh0Lm5vdGljZX19PC9wPlxuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5jYXJ0LmJ1dHRvbn19IiB0eXBlPSJidXR0b24iIGRhdGEtZWxlbWVudD0iY2FydC5idXR0b24iPnt7ZGF0YS50ZXh0LmJ1dHRvbn19PC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAge3svZGF0YS5pc0VtcHR5fX0nCiAgICAgIH0sCiAgICAgIHN0YXJ0T3BlbjogITEsCiAgICAgIHBvcHVwOiAhMSwKICAgICAgbWFuaWZlc3Q6IFsiY2FydCIsICJsaW5lSXRlbSIsICJ0b2dnbGUiXSwKICAgICAgY29udGVudHM6IHsKICAgICAgICB0aXRsZTogITAsCiAgICAgICAgbGluZUl0ZW1zOiAhMCwKICAgICAgICBmb290ZXI6ICEwLAogICAgICAgIG5vdGU6ICExLAogICAgICAgIGRpc2NvdW50czogITAKICAgICAgfSwKICAgICAgb3JkZXI6IFsidGl0bGUiLCAibGluZUl0ZW1zIiwgImZvb3RlciJdLAogICAgICBjbGFzc2VzOiB7CiAgICAgICAgd3JhcHBlcjogInNob3BpZnktYnV5X19jYXJ0LXdyYXBwZXIiLAogICAgICAgIGNhcnQ6ICJzaG9waWZ5LWJ1eV9fY2FydCIsCiAgICAgICAgaGVhZGVyOiAic2hvcGlmeS1idXlfX2NhcnRfX2hlYWRlciIsCiAgICAgICAgdGl0bGU6ICJzaG9waWZ5LWJ1eV9fY2FydF9fdGl0bGUiLAogICAgICAgIGxpbmVJdGVtczogInNob3BpZnktYnV5X19jYXJ0LWl0ZW1zIiwKICAgICAgICBmb290ZXI6ICJzaG9waWZ5LWJ1eV9fY2FydC1ib3R0b20iLAogICAgICAgIGRpc2NvdW50OiAic2hvcGlmeS1idXlfX2NhcnRfX2Rpc2NvdW50IiwKICAgICAgICBkaXNjb3VudFRleHQ6ICJzaG9waWZ5LWJ1eV9fY2FydF9fZGlzY291bnRfX3RleHQiLAogICAgICAgIGRpc2NvdW50SWNvbjogInNob3BpZnktYnV5X19jYXJ0X19kaXNjb3VudF9fdGV4dF9faWNvbiIsCiAgICAgICAgZGlzY291bnRBbW91bnQ6ICJzaG9waWZ5LWJ1eV9fY2FydF9fZGlzY291bnRfX2Ftb3VudCIsCiAgICAgICAgc3VidG90YWxUZXh0OiAic2hvcGlmeS1idXlfX2NhcnRfX3N1YnRvdGFsX190ZXh0IiwKICAgICAgICBzdWJ0b3RhbDogInNob3BpZnktYnV5X19jYXJ0X19zdWJ0b3RhbF9fcHJpY2UiLAogICAgICAgIG5vdGljZTogInNob3BpZnktYnV5X19jYXJ0X19ub3RpY2UiLAogICAgICAgIGN1cnJlbmN5OiAic2hvcGlmeS1idXlfX2NhcnRfX2N1cnJlbmN5IiwKICAgICAgICBidXR0b246ICJzaG9waWZ5LWJ1eV9fYnRuIHNob3BpZnktYnV5X19idG4tLWNhcnQtY2hlY2tvdXQiLAogICAgICAgIGNsb3NlOiAic2hvcGlmeS1idXlfX2J0bi0tY2xvc2UiLAogICAgICAgIGNhcnRTY3JvbGw6ICJzaG9waWZ5LWJ1eV9fY2FydC1zY3JvbGwiLAogICAgICAgIGNhcnRTY3JvbGxXaXRoRGlzY291bnRzOiAic2hvcGlmeS1idXlfX2NhcnQtc2Nyb2xsLS1kaXNjb3VudHMiLAogICAgICAgIGNhcnRTY3JvbGxXaXRoQ2FydE5vdGU6ICJzaG9waWZ5LWJ1eV9fY2FydC1zY3JvbGwtLWNhcnQtbm90ZSIsCiAgICAgICAgZW1wdHk6ICJzaG9waWZ5LWJ1eV9fY2FydC1lbXB0eS10ZXh0IiwKICAgICAgICBub3RlOiAic2hvcGlmeS1idXlfX2NhcnRfX25vdGUiLAogICAgICAgIG5vdGVEZXNjcmlwdGlvbjogInNob3BpZnktYnV5X19jYXJ0X19ub3RlX19kZXNjcmlwdGlvbiIsCiAgICAgICAgbm90ZVRleHRBcmVhOiAic2hvcGlmeS1idXlfX2NhcnRfX25vdGVfX3RleHQtYXJlYSIKICAgICAgfSwKICAgICAgdGV4dDogewogICAgICAgIHRpdGxlOiAiQ2FydCIsCiAgICAgICAgZW1wdHk6ICJZb3VyIGNhcnQgaXMgZW1wdHkuIiwKICAgICAgICBidXR0b246ICJDSEVDS09VVCIsCiAgICAgICAgdG90YWw6ICJTVUJUT1RBTCIsCiAgICAgICAgY3VycmVuY3k6ICJDQUQiLAogICAgICAgIG5vdGljZTogIlNoaXBwaW5nIGFuZCBkaXNjb3VudCBjb2RlcyBhcmUgYWRkZWQgYXQgY2hlY2tvdXQuIiwKICAgICAgICBub3RlRGVzY3JpcHRpb246ICJTcGVjaWFsIGluc3RydWN0aW9ucyBmb3Igc2VsbGVyIgogICAgICB9CiAgICB9LAogICAgbGluZUl0ZW06IHsKICAgICAgdGVtcGxhdGVzOiB7CiAgICAgICAgaW1hZ2U6ICc8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5saW5lSXRlbS5pbWFnZX19IiBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTogdXJsKHt7ZGF0YS5saW5lSXRlbUltYWdlfX0pIiBkYXRhLWVsZW1lbnQ9ImxpbmVJdGVtLmltYWdlIj48L2Rpdj4nLAogICAgICAgIHZhcmlhbnRUaXRsZTogJzxkaXYgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLmxpbmVJdGVtLnZhcmlhbnRUaXRsZX19IiBkYXRhLWVsZW1lbnQ9ImxpbmVJdGVtLnZhcmlhbnRUaXRsZSI+e3tkYXRhLnZhcmlhbnRUaXRsZX19PC9kaXY+JywKICAgICAgICB0aXRsZTogJzxzcGFuIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5saW5lSXRlbS5pdGVtVGl0bGV9fSIgZGF0YS1lbGVtZW50PSJsaW5lSXRlbS5pdGVtVGl0bGUiPnt7ZGF0YS50aXRsZX19PC9zcGFuPicsCiAgICAgICAgcHJpY2U6ICc8c3BhbiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMubGluZUl0ZW0ucHJpY2V9fSIgZGF0YS1lbGVtZW50PSJsaW5lSXRlbS5wcmljZSI+e3tkYXRhLmZvcm1hdHRlZFByaWNlfX08L3NwYW4+JywKICAgICAgICBwcmljZVdpdGhEaXNjb3VudHM6ICc8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5saW5lSXRlbS5wcmljZVdpdGhEaXNjb3VudHN9fSIgZGF0YS1lbGVtZW50PSJsaW5lSXRlbS5wcmljZSI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7eyNkYXRhLmZvcm1hdHRlZEZ1bGxQcmljZX19XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ2aXN1YWxseWhpZGRlbiI+UmVndWxhciBwcmljZTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRlbCBjbGFzcz0ie3tkYXRhLmNsYXNzZXMubGluZUl0ZW0uZnVsbFByaWNlfX0iIGRhdGEtZWxlbWVudD0ibGluZUl0ZW0uZnVsbFByaWNlIj57e2RhdGEuZm9ybWF0dGVkRnVsbFByaWNlfX08L2RlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InZpc3VhbGx5aGlkZGVuIj5TYWxlIHByaWNlPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAge3svZGF0YS5mb3JtYXR0ZWRGdWxsUHJpY2V9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMubGluZUl0ZW0ucHJpY2V9fSIgZGF0YS1lbGVtZW50PSJsaW5lSXRlbS5wcmljZSI+e3tkYXRhLmZvcm1hdHRlZEFjdHVhbFByaWNlfX08L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt7I2RhdGEuZGlzY291bnRzfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMubGluZUl0ZW0uZGlzY291bnR9fSIgZGF0YS1lbGVtZW50PSJsaW5lSXRlbS5kaXNjb3VudCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMiAxMiIgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLmxpbmVJdGVtLmRpc2NvdW50SWNvbn19IiBkYXRhLWVsZW1lbnQ9ImxpbmVJdGVtLmRpc2NvdW50SWNvbiIgYXJpYS1oaWRkZW49InRydWUiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEwLjAwMSAyLjk5ODU2QzkuODAzMjcgMi45OTg1NiA5LjYxMDAyIDIuOTM5OTQgOS40NDU2NSAyLjgzMDExQzkuMjgxMjggMi43MjAyOSA5LjE1MzE3IDIuNTY0MTggOS4wNzc1MiAyLjM4MTU1QzkuMDAxODcgMi4xOTg5MSA4Ljk4MjA3IDEuOTk3OTQgOS4wMjA2NCAxLjgwNDA1QzkuMDU5MjEgMS42MTAxNiA5LjE1NDQgMS40MzIwNyA5LjI5NDE5IDEuMjkyMjhDOS40MzM5NyAxLjE1MjUgOS42MTIwNyAxLjA1NzMgOS44MDU5NiAxLjAxODc0QzkuOTk5ODQgMC45ODAxNzEgMTAuMjAwOCAwLjk5OTk2NSAxMC4zODM0IDEuMDc1NjJDMTAuNTY2MSAxLjE1MTI3IDEwLjcyMjIgMS4yNzkzOCAxMC44MzIgMS40NDM3NUMxMC45NDE4IDEuNjA4MTIgMTEuMDAwNSAxLjgwMTM2IDExLjAwMDUgMS45OTkwNUMxMS4wMDA1IDIuMjY0MTQgMTAuODk1MiAyLjUxODM3IDEwLjcwNzcgMi43MDU4MUMxMC41MjAzIDIuODkzMjYgMTAuMjY2IDIuOTk4NTYgMTAuMDAxIDIuOTk4NTZaTTEwLjAwMSAxLjY3MDYyZS0wNUg3LjAwMjRDNi44NzA4NiAtMC4wMDA3NDM4MTggNi43NDA0NiAwLjAyNDQ2OSA2LjYxODY4IDAuMDc0MjA5NUM2LjQ5NjkxIDAuMTIzOTUgNi4zODYxNCAwLjE5NzI0IDYuMjkyNzUgMC4yODk4NzZMMC4yOTU2NTUgNi4yODY5N0MwLjIwMTk3MiA2LjM3OTg5IDAuMTI3NjE0IDYuNDkwNDQgMC4wNzY4Njk3IDYuNjEyMjRDMC4wMjYxMjU2IDYuNzM0MDQgMCA2Ljg2NDY4IDAgNi45OTY2M0MwIDcuMTI4NTcgMC4wMjYxMjU2IDcuMjU5MjIgMC4wNzY4Njk3IDcuMzgxMDJDMC4xMjc2MTQgNy41MDI4MiAwLjIwMTk3MiA3LjYxMzM2IDAuMjk1NjU1IDcuNzA2MjhMNC4yOTM3MiAxMS43MDQzQzQuMzg2NjQgMTEuNzk4IDQuNDk3MTggMTEuODcyNCA0LjYxODk4IDExLjkyMzFDNC43NDA3OCAxMS45NzM5IDQuODcxNDMgMTIgNS4wMDMzNyAxMkM1LjEzNTMyIDEyIDUuMjY1OTYgMTEuOTczOSA1LjM4Nzc2IDExLjkyMzFDNS41MDk1NiAxMS44NzI0IDUuNjIwMTEgMTEuNzk4IDUuNzEzMDMgMTEuNzA0M0M1LjkwMjk0IDExLjUwNDQgMTEuNTEwMiA1Ljg5NzE2IDExLjcxMDEgNS43MDcyNUMxMS44MDI4IDUuNjEzODYgMTEuODc2IDUuNTAzMDkgMTEuOTI1OCA1LjM4MTMyQzExLjk3NTUgNS4yNTk1NCAxMi4wMDA3IDUuMTI5MTQgMTIgNC45OTc1OVYxLjk5OTA1QzEyIDEuNDY4ODcgMTEuNzg5NCAwLjk2MDQxIDExLjQxNDUgMC41ODU1MTlDMTEuMDM5NiAwLjIxMDYyOCAxMC41MzExIDEuNjcwNjJlLTA1IDEwLjAwMSAxLjY3MDYyZS0wNVoiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InZpc3VhbGx5aGlkZGVuIj5EaXNjb3VudDo8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3tkaXNjb3VudH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAge3svZGF0YS5kaXNjb3VudHN9fVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PicsCiAgICAgICAgcXVhbnRpdHk6ICc8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5saW5lSXRlbS5xdWFudGl0eX19IiBkYXRhLWVsZW1lbnQ9ImxpbmVJdGVtLnF1YW50aXR5Ij5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ie3tkYXRhLmNsYXNzZXMubGluZUl0ZW0ucXVhbnRpdHlCdXR0b259fSB7e2RhdGEuY2xhc3Nlcy5saW5lSXRlbS5xdWFudGl0eURlY3JlbWVudH19IiB0eXBlPSJidXR0b24iIGRhdGEtbGluZS1pdGVtLWlkPSJ7e2RhdGEuaWR9fSIgZGF0YS1lbGVtZW50PSJsaW5lSXRlbS5xdWFudGl0eURlY3JlbWVudCI+XG4gICAgICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZD0iTTQgN2g4djJINHoiLz48L3N2Zz48c3BhbiBjbGFzcz0idmlzdWFsbHloaWRkZW4iPkRlY3JlbWVudDwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz0ie3tkYXRhLmNsYXNzZXMubGluZUl0ZW0ucXVhbnRpdHlJbnB1dH19IiB0eXBlPSJudW1iZXIiIG1pbj0iMCIgYXJpYS1sYWJlbD0iUXVhbnRpdHkiIGRhdGEtbGluZS1pdGVtLWlkPSJ7e2RhdGEuaWR9fSIgdmFsdWU9Int7ZGF0YS5xdWFudGl0eX19IiBkYXRhLWVsZW1lbnQ9ImxpbmVJdGVtLnF1YW50aXR5SW5wdXQiPlxuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy5saW5lSXRlbS5xdWFudGl0eUJ1dHRvbn19IHt7ZGF0YS5jbGFzc2VzLmxpbmVJdGVtLnF1YW50aXR5SW5jcmVtZW50fX0iIHR5cGU9ImJ1dHRvbiIgZGF0YS1saW5lLWl0ZW0taWQ9Int7ZGF0YS5pZH19IiBkYXRhLWVsZW1lbnQ9ImxpbmVJdGVtLnF1YW50aXR5SW5jcmVtZW50Ij5cbiAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDE2IDE2Ij48cGF0aCBkPSJNMTIgN0g5VjRIN3YzSDR2MmgzdjNoMlY5aDN6Ii8+PC9zdmc+PHNwYW4gY2xhc3M9InZpc3VhbGx5aGlkZGVuIj5JbmNyZW1lbnQ8L3NwYW4+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+JwogICAgICB9LAogICAgICBjb250ZW50czogewogICAgICAgIGltYWdlOiAhMCwKICAgICAgICB2YXJpYW50VGl0bGU6ICEwLAogICAgICAgIHRpdGxlOiAhMCwKICAgICAgICBwcmljZTogITEsCiAgICAgICAgcHJpY2VXaXRoRGlzY291bnRzOiAhMCwKICAgICAgICBxdWFudGl0eTogITAsCiAgICAgICAgcXVhbnRpdHlJbmNyZW1lbnQ6ICEwLAogICAgICAgIHF1YW50aXR5RGVjcmVtZW50OiAhMCwKICAgICAgICBxdWFudGl0eUlucHV0OiAhMAogICAgICB9LAogICAgICBvcmRlcjogWyJpbWFnZSIsICJ0aXRsZSIsICJ2YXJpYW50VGl0bGUiLCAicHJpY2UiLCAicHJpY2VXaXRoRGlzY291bnRzIiwgInF1YW50aXR5Il0sCiAgICAgIGNsYXNzZXM6IHsKICAgICAgICBsaW5lSXRlbTogInNob3BpZnktYnV5X19jYXJ0LWl0ZW0iLAogICAgICAgIGltYWdlOiAic2hvcGlmeS1idXlfX2NhcnQtaXRlbV9faW1hZ2UiLAogICAgICAgIHZhcmlhbnRUaXRsZTogInNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3ZhcmlhbnQtdGl0bGUiLAogICAgICAgIGl0ZW1UaXRsZTogInNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3RpdGxlIiwKICAgICAgICBwcmljZTogInNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3ByaWNlIiwKICAgICAgICBwcmljZVdpdGhEaXNjb3VudHM6ICJzaG9waWZ5LWJ1eV9fY2FydC1pdGVtX19wcmljZS1hbmQtZGlzY291bnRzIiwKICAgICAgICBmdWxsUHJpY2U6ICJzaG9waWZ5LWJ1eV9fY2FydC1pdGVtX19mdWxsLXByaWNlIiwKICAgICAgICBkaXNjb3VudDogInNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX2Rpc2NvdW50IiwKICAgICAgICBkaXNjb3VudEljb246ICJzaG9waWZ5LWJ1eV9fY2FydC1pdGVtX19kaXNjb3VudF9faWNvbiIsCiAgICAgICAgcXVhbnRpdHk6ICJzaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyIGNsZWFyZml4IiwKICAgICAgICBxdWFudGl0eUlucHV0OiAic2hvcGlmeS1idXlfX3F1YW50aXR5IHNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3F1YW50aXR5LWlucHV0IiwKICAgICAgICBxdWFudGl0eUJ1dHRvbjogInNob3BpZnktYnV5X19idG4tLXNlYW1sZXNzIiwKICAgICAgICBxdWFudGl0eUluY3JlbWVudDogInNob3BpZnktYnV5X19xdWFudGl0eS1pbmNyZW1lbnQiLAogICAgICAgIHF1YW50aXR5RGVjcmVtZW50OiAic2hvcGlmeS1idXlfX3F1YW50aXR5LWRlY3JlbWVudCIKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZTogewogICAgICB0ZW1wbGF0ZXM6IHsKICAgICAgICB0aXRsZTogJzxoNSBjbGFzcz0ie3tkYXRhLmNsYXNzZXMudG9nZ2xlLnRpdGxlfX0iIGRhdGEtZWxlbWVudD0idG9nZ2xlLnRpdGxlIj57e2RhdGEudGV4dC50aXRsZX19PC9oNT4nLAogICAgICAgIGljb246ICc8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgY2xhc3M9Int7ZGF0YS5jbGFzc2VzLnRvZ2dsZS5pY29ufX0iIGRhdGEtZWxlbWVudD0idG9nZ2xlLmljb24iIHZpZXdCb3g9IjAgMCAyNSAyNSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjUgMjUiPjxnIGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy50b2dnbGUuaWNvblBhdGh9fSI+PHBhdGggZD0iTTI0LjYgMy42Yy0uMy0uNC0uOC0uNi0xLjMtLjZoLTE4LjRsLS4xLS41Yy0uMy0xLjUtMS43LTEuNS0yLjUtMS41aC0xLjNjLS42IDAtMSAuNC0xIDFzLjQgMSAxIDFoMS44bDMgMTMuNmMuMiAxLjIgMS4zIDIuNCAyLjUgMi40aDEyLjdjLjYgMCAxLS40IDEtMXMtLjQtMS0xLTFoLTEyLjdjLS4yIDAtLjUtLjQtLjYtLjhsLS4yLTEuMmgxMi42YzEuMyAwIDIuMy0xLjQgMi41LTIuNGwyLjQtNy40di0uMmMuMS0uNS0uMS0xLS40LTEuNHptLTQgOC41di4yYy0uMS4zLS40LjgtLjUuOGgtMTNsLTEuOC04LjFoMTcuNmwtMi4zIDcuMXoiLz48Y2lyY2xlIGN4PSI5IiBjeT0iMjIiIHI9IjIiLz48Y2lyY2xlIGN4PSIxOSIgY3k9IjIyIiByPSIyIi8+PC9nPjwvc3ZnPicsCiAgICAgICAgY291bnQ6ICc8ZGl2IGNsYXNzPSJ7e2RhdGEuY2xhc3Nlcy50b2dnbGUuY291bnR9fSIgZGF0YS1lbGVtZW50PSJ0b2dnbGUuY291bnQiPnt7ZGF0YS5jb3VudH19PC9kaXY+JwogICAgICB9LAogICAgICBtYW5pZmVzdDogWyJ0b2dnbGUiXSwKICAgICAgaWZyYW1lOiAhMCwKICAgICAgc3RpY2t5OiAhMCwKICAgICAgY29udGVudHM6IHsKICAgICAgICBjb3VudDogITAsCiAgICAgICAgaWNvbjogITAsCiAgICAgICAgdGl0bGU6ICExCiAgICAgIH0sCiAgICAgIG9yZGVyOiBbImNvdW50IiwgImljb24iLCAidGl0bGUiXSwKICAgICAgY2xhc3NlczogewogICAgICAgIHdyYXBwZXI6ICJzaG9waWZ5LWJ1eV9fY2FydC10b2dnbGUtd3JhcHBlciIsCiAgICAgICAgdG9nZ2xlOiAic2hvcGlmeS1idXlfX2NhcnQtdG9nZ2xlIiwKICAgICAgICB0aXRsZTogInNob3BpZnktYnV5X19jYXJ0LXRvZ2dsZV9fdGl0bGUiLAogICAgICAgIGNvdW50OiAic2hvcGlmeS1idXlfX2NhcnQtdG9nZ2xlX19jb3VudCIsCiAgICAgICAgaWNvbjogInNob3BpZnktYnV5X19pY29uLWNhcnQgc2hvcGlmeS1idXlfX2ljb24tY2FydC0tc2lkZSIsCiAgICAgICAgaWNvblBhdGg6ICJzaG9waWZ5LWJ1eV9faWNvbi1jYXJ0X19ncm91cCIKICAgICAgfSwKICAgICAgdGV4dDogewogICAgICAgIHRpdGxlOiAiY2FydCIKICAgICAgfQogICAgfSwKICAgIHdpbmRvdzogewogICAgICBoZWlnaHQ6IDYwMCwKICAgICAgd2lkdGg6IDQwMCwKICAgICAgdG9vbGJhcjogMCwKICAgICAgc2Nyb2xsYmFyczogMSwKICAgICAgc3RhdHVzOiAwLAogICAgICByZXNpemFibGU6IDEsCiAgICAgIGNlbnRlcjogMCwKICAgICAgY3JlYXRlbmV3OiAxLAogICAgICBsb2NhdGlvbjogMCwKICAgICAgbWVudWJhcjogMCwKICAgICAgb25VbmxvYWQ6IG51bGwsCiAgICAgIHRpdGxlYmFyOiAieWVzIgogICAgfQogIH07CgogIGZ1bmN0aW9uIHdyYXBDb25zb2xlKGxvZ0NvbW1hbmQpIHsKICAgIHZhciBsb2dNZXRob2QgPSBmdW5jdGlvbiBsb2dNZXRob2QoKSB7CiAgICAgIHZhciBob3N0Q29uc29sZSA9IHdpbmRvdy5jb25zb2xlLAogICAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpLmpvaW4oIiAiKTsKICAgICAgaG9zdENvbnNvbGUgJiYgaG9zdENvbnNvbGVbbG9nQ29tbWFuZF0oYXJncyk7CiAgICB9OwoKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgICAgYXJncy51bnNoaWZ0KCJbU0hPUElGWS1CVVktVUldOiAiKSwgbG9nTWV0aG9kLmFwcGx5KHZvaWQgMCwgX3RvQ29uc3VtYWJsZUFycmF5KGFyZ3MpKTsKICAgIH07CiAgfQoKICB2YXIgbG9nZ2VyID0gewogICAgZGVidWc6IHdyYXBDb25zb2xlKCJkZWJ1ZyIpLAogICAgaW5mbzogd3JhcENvbnNvbGUoImluZm8iKSwKICAgIHdhcm46IHdyYXBDb25zb2xlKCJ3YXJuIiksCiAgICBlcnJvcjogd3JhcENvbnNvbGUoImVycm9yIiksCiAgICBsb2c6IHdyYXBDb25zb2xlKCJsb2ciKQogIH07CgogIGZ1bmN0aW9uIGlzQXJyYXkoYXJnKSB7CiAgICByZXR1cm4gIltvYmplY3QgQXJyYXldIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZyk7CiAgfQoKICBmdW5jdGlvbiBsb2dOb3RGb3VuZChjb21wb25lbnQpIHsKICAgIHZhciBlcnJJbmZvID0gIiI7CiAgICBjb21wb25lbnQuaWQgPyBlcnJJbmZvID0gaXNBcnJheShjb21wb25lbnQuaWQpID8gImZvciBpZHMgIi5jb25jYXQoY29tcG9uZW50LmlkLmpvaW4oIiwgIiksICIuIikgOiAiZm9yIGlkICIuY29uY2F0KGNvbXBvbmVudC5pZCwgIi4iKSA6IGNvbXBvbmVudC5oYW5kbGUgJiYgKGVyckluZm8gPSAnZm9yIGhhbmRsZSAiJy5jb25jYXQoY29tcG9uZW50LmhhbmRsZSwgJyIuJykpOwogICAgdmFyIG1lc3NhZ2UgPSAiTm90IEZvdW5kOiAiLmNvbmNhdChjb21wb25lbnQudHlwZUtleSwgIiBub3QgZm91bmQgIikuY29uY2F0KGVyckluZm8pOwogICAgbG9nZ2VyLndhcm4obWVzc2FnZSk7CiAgfQoKICB2YXIgZGVmYXVsdE1vbmV5Rm9ybWF0ID0gIiR7e2Ftb3VudH19IiwKICAgICAgcmFuZ2U7CgogIGZ1bmN0aW9uIG1vcnBoQXR0cnMoZnJvbU5vZGUsIHRvTm9kZSkgewogICAgdmFyIGF0dHJzID0gdG9Ob2RlLmF0dHJpYnV0ZXMsCiAgICAgICAgaSwKICAgICAgICBhdHRyLAogICAgICAgIGF0dHJOYW1lLAogICAgICAgIGF0dHJOYW1lc3BhY2VVUkksCiAgICAgICAgYXR0clZhbHVlLAogICAgICAgIGZyb21WYWx1ZTsKCiAgICBmb3IgKGkgPSBhdHRycy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgewogICAgICBhdHRyTmFtZSA9IChhdHRyID0gYXR0cnNbaV0pLm5hbWUsIGF0dHJOYW1lc3BhY2VVUkkgPSBhdHRyLm5hbWVzcGFjZVVSSSwgYXR0clZhbHVlID0gYXR0ci52YWx1ZSwgYXR0ck5hbWVzcGFjZVVSSSA/IChhdHRyTmFtZSA9IGF0dHIubG9jYWxOYW1lIHx8IGF0dHJOYW1lLCAoZnJvbVZhbHVlID0gZnJvbU5vZGUuZ2V0QXR0cmlidXRlTlMoYXR0ck5hbWVzcGFjZVVSSSwgYXR0ck5hbWUpKSAhPT0gYXR0clZhbHVlICYmIGZyb21Ob2RlLnNldEF0dHJpYnV0ZU5TKGF0dHJOYW1lc3BhY2VVUkksIGF0dHJOYW1lLCBhdHRyVmFsdWUpKSA6IChmcm9tVmFsdWUgPSBmcm9tTm9kZS5nZXRBdHRyaWJ1dGUoYXR0ck5hbWUpKSAhPT0gYXR0clZhbHVlICYmIGZyb21Ob2RlLnNldEF0dHJpYnV0ZShhdHRyTmFtZSwgYXR0clZhbHVlKTsKICAgIH0KCiAgICBmb3IgKGkgPSAoYXR0cnMgPSBmcm9tTm9kZS5hdHRyaWJ1dGVzKS5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgewogICAgICAhMSAhPT0gKGF0dHIgPSBhdHRyc1tpXSkuc3BlY2lmaWVkICYmIChhdHRyTmFtZSA9IGF0dHIubmFtZSwgKGF0dHJOYW1lc3BhY2VVUkkgPSBhdHRyLm5hbWVzcGFjZVVSSSkgPyAoYXR0ck5hbWUgPSBhdHRyLmxvY2FsTmFtZSB8fCBhdHRyTmFtZSwgdG9Ob2RlLmhhc0F0dHJpYnV0ZU5TKGF0dHJOYW1lc3BhY2VVUkksIGF0dHJOYW1lKSB8fCBmcm9tTm9kZS5yZW1vdmVBdHRyaWJ1dGVOUyhhdHRyTmFtZXNwYWNlVVJJLCBhdHRyTmFtZSkpIDogdG9Ob2RlLmhhc0F0dHJpYnV0ZShhdHRyTmFtZSkgfHwgZnJvbU5vZGUucmVtb3ZlQXR0cmlidXRlKGF0dHJOYW1lKSk7CiAgICB9CiAgfQoKICB2YXIgTlNfWEhUTUwgPSAiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIsCiAgICAgIGRvYyA9ICJ1bmRlZmluZWQiID09IHR5cGVvZiBkb2N1bWVudCA/IHZvaWQgMCA6IGRvY3VtZW50LAogICAgICBIQVNfVEVNUExBVEVfU1VQUE9SVCA9ICEhZG9jICYmICJjb250ZW50IiBpbiBkb2MuY3JlYXRlRWxlbWVudCgidGVtcGxhdGUiKSwKICAgICAgSEFTX1JBTkdFX1NVUFBPUlQgPSAhIWRvYyAmJiBkb2MuY3JlYXRlUmFuZ2UgJiYgImNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudCIgaW4gZG9jLmNyZWF0ZVJhbmdlKCk7CgogIGZ1bmN0aW9uIGNyZWF0ZUZyYWdtZW50RnJvbVRlbXBsYXRlKHN0cikgewogICAgdmFyIHRlbXBsYXRlID0gZG9jLmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICByZXR1cm4gdGVtcGxhdGUuaW5uZXJIVE1MID0gc3RyLCB0ZW1wbGF0ZS5jb250ZW50LmNoaWxkTm9kZXNbMF07CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVGcmFnbWVudEZyb21SYW5nZShzdHIpIHsKICAgIHZhciBmcmFnbWVudDsKICAgIHJldHVybiByYW5nZSB8fCAocmFuZ2UgPSBkb2MuY3JlYXRlUmFuZ2UoKSkuc2VsZWN0Tm9kZShkb2MuYm9keSksIHJhbmdlLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudChzdHIpLmNoaWxkTm9kZXNbMF07CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVGcmFnbWVudEZyb21XcmFwKHN0cikgewogICAgdmFyIGZyYWdtZW50ID0gZG9jLmNyZWF0ZUVsZW1lbnQoImJvZHkiKTsKICAgIHJldHVybiBmcmFnbWVudC5pbm5lckhUTUwgPSBzdHIsIGZyYWdtZW50LmNoaWxkTm9kZXNbMF07CiAgfQoKICBmdW5jdGlvbiB0b0VsZW1lbnQoc3RyKSB7CiAgICByZXR1cm4gSEFTX1RFTVBMQVRFX1NVUFBPUlQgPyBjcmVhdGVGcmFnbWVudEZyb21UZW1wbGF0ZShzdHIpIDogSEFTX1JBTkdFX1NVUFBPUlQgPyBjcmVhdGVGcmFnbWVudEZyb21SYW5nZShzdHIpIDogY3JlYXRlRnJhZ21lbnRGcm9tV3JhcChzdHIpOwogIH0KCiAgZnVuY3Rpb24gY29tcGFyZU5vZGVOYW1lcyhmcm9tRWwsIHRvRWwpIHsKICAgIHZhciBmcm9tTm9kZU5hbWUgPSBmcm9tRWwubm9kZU5hbWUsCiAgICAgICAgdG9Ob2RlTmFtZSA9IHRvRWwubm9kZU5hbWU7CiAgICByZXR1cm4gZnJvbU5vZGVOYW1lID09PSB0b05vZGVOYW1lIHx8ICEhKHRvRWwuYWN0dWFsaXplICYmIGZyb21Ob2RlTmFtZS5jaGFyQ29kZUF0KDApIDwgOTEgJiYgdG9Ob2RlTmFtZS5jaGFyQ29kZUF0KDApID4gOTApICYmIGZyb21Ob2RlTmFtZSA9PT0gdG9Ob2RlTmFtZS50b1VwcGVyQ2FzZSgpOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlRWxlbWVudE5TKG5hbWUsIG5hbWVzcGFjZVVSSSkgewogICAgcmV0dXJuIG5hbWVzcGFjZVVSSSAmJiBuYW1lc3BhY2VVUkkgIT09IE5TX1hIVE1MID8gZG9jLmNyZWF0ZUVsZW1lbnROUyhuYW1lc3BhY2VVUkksIG5hbWUpIDogZG9jLmNyZWF0ZUVsZW1lbnQobmFtZSk7CiAgfQoKICBmdW5jdGlvbiBtb3ZlQ2hpbGRyZW4oZnJvbUVsLCB0b0VsKSB7CiAgICBmb3IgKHZhciBjdXJDaGlsZCA9IGZyb21FbC5maXJzdENoaWxkOyBjdXJDaGlsZDspIHsKICAgICAgdmFyIG5leHRDaGlsZCA9IGN1ckNoaWxkLm5leHRTaWJsaW5nOwogICAgICB0b0VsLmFwcGVuZENoaWxkKGN1ckNoaWxkKSwgY3VyQ2hpbGQgPSBuZXh0Q2hpbGQ7CiAgICB9CgogICAgcmV0dXJuIHRvRWw7CiAgfQoKICBmdW5jdGlvbiBzeW5jQm9vbGVhbkF0dHJQcm9wKGZyb21FbCwgdG9FbCwgbmFtZSkgewogICAgZnJvbUVsW25hbWVdICE9PSB0b0VsW25hbWVdICYmIChmcm9tRWxbbmFtZV0gPSB0b0VsW25hbWVdLCBmcm9tRWxbbmFtZV0gPyBmcm9tRWwuc2V0QXR0cmlidXRlKG5hbWUsICIiKSA6IGZyb21FbC5yZW1vdmVBdHRyaWJ1dGUobmFtZSkpOwogIH0KCiAgdmFyIHNwZWNpYWxFbEhhbmRsZXJzID0gewogICAgT1BUSU9OOiBmdW5jdGlvbiBPUFRJT04oZnJvbUVsLCB0b0VsKSB7CiAgICAgIHZhciBwYXJlbnROb2RlID0gZnJvbUVsLnBhcmVudE5vZGU7CgogICAgICBpZiAocGFyZW50Tm9kZSkgewogICAgICAgIHZhciBwYXJlbnROYW1lID0gcGFyZW50Tm9kZS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpOwogICAgICAgICJPUFRHUk9VUCIgPT09IHBhcmVudE5hbWUgJiYgKHBhcmVudE5hbWUgPSAocGFyZW50Tm9kZSA9IHBhcmVudE5vZGUucGFyZW50Tm9kZSkgJiYgcGFyZW50Tm9kZS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpKSwgIlNFTEVDVCIgIT09IHBhcmVudE5hbWUgfHwgcGFyZW50Tm9kZS5oYXNBdHRyaWJ1dGUoIm11bHRpcGxlIikgfHwgKGZyb21FbC5oYXNBdHRyaWJ1dGUoInNlbGVjdGVkIikgJiYgIXRvRWwuc2VsZWN0ZWQgJiYgKGZyb21FbC5zZXRBdHRyaWJ1dGUoInNlbGVjdGVkIiwgInNlbGVjdGVkIiksIGZyb21FbC5yZW1vdmVBdHRyaWJ1dGUoInNlbGVjdGVkIikpLCBwYXJlbnROb2RlLnNlbGVjdGVkSW5kZXggPSAtMSk7CiAgICAgIH0KCiAgICAgIHN5bmNCb29sZWFuQXR0clByb3AoZnJvbUVsLCB0b0VsLCAic2VsZWN0ZWQiKTsKICAgIH0sCiAgICBJTlBVVDogZnVuY3Rpb24gSU5QVVQoZnJvbUVsLCB0b0VsKSB7CiAgICAgIHN5bmNCb29sZWFuQXR0clByb3AoZnJvbUVsLCB0b0VsLCAiY2hlY2tlZCIpLCBzeW5jQm9vbGVhbkF0dHJQcm9wKGZyb21FbCwgdG9FbCwgImRpc2FibGVkIiksIGZyb21FbC52YWx1ZSAhPT0gdG9FbC52YWx1ZSAmJiAoZnJvbUVsLnZhbHVlID0gdG9FbC52YWx1ZSksIHRvRWwuaGFzQXR0cmlidXRlKCJ2YWx1ZSIpIHx8IGZyb21FbC5yZW1vdmVBdHRyaWJ1dGUoInZhbHVlIik7CiAgICB9LAogICAgVEVYVEFSRUE6IGZ1bmN0aW9uIFRFWFRBUkVBKGZyb21FbCwgdG9FbCkgewogICAgICB2YXIgbmV3VmFsdWUgPSB0b0VsLnZhbHVlOwogICAgICBmcm9tRWwudmFsdWUgIT09IG5ld1ZhbHVlICYmIChmcm9tRWwudmFsdWUgPSBuZXdWYWx1ZSk7CiAgICAgIHZhciBmaXJzdENoaWxkID0gZnJvbUVsLmZpcnN0Q2hpbGQ7CgogICAgICBpZiAoZmlyc3RDaGlsZCkgewogICAgICAgIHZhciBvbGRWYWx1ZSA9IGZpcnN0Q2hpbGQubm9kZVZhbHVlOwogICAgICAgIGlmIChvbGRWYWx1ZSA9PSBuZXdWYWx1ZSB8fCAhbmV3VmFsdWUgJiYgb2xkVmFsdWUgPT0gZnJvbUVsLnBsYWNlaG9sZGVyKSByZXR1cm47CiAgICAgICAgZmlyc3RDaGlsZC5ub2RlVmFsdWUgPSBuZXdWYWx1ZTsKICAgICAgfQogICAgfSwKICAgIFNFTEVDVDogZnVuY3Rpb24gU0VMRUNUKGZyb21FbCwgdG9FbCkgewogICAgICBpZiAoIXRvRWwuaGFzQXR0cmlidXRlKCJtdWx0aXBsZSIpKSB7CiAgICAgICAgZm9yICh2YXIgc2VsZWN0ZWRJbmRleCA9IC0xLCBpID0gMCwgY3VyQ2hpbGQgPSBmcm9tRWwuZmlyc3RDaGlsZCwgb3B0Z3JvdXAsIG5vZGVOYW1lOyBjdXJDaGlsZDspIHsKICAgICAgICAgIGlmICgiT1BUR1JPVVAiID09PSAobm9kZU5hbWUgPSBjdXJDaGlsZC5ub2RlTmFtZSAmJiBjdXJDaGlsZC5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpKSkgY3VyQ2hpbGQgPSAob3B0Z3JvdXAgPSBjdXJDaGlsZCkuZmlyc3RDaGlsZDtlbHNlIHsKICAgICAgICAgICAgaWYgKCJPUFRJT04iID09PSBub2RlTmFtZSkgewogICAgICAgICAgICAgIGlmIChjdXJDaGlsZC5oYXNBdHRyaWJ1dGUoInNlbGVjdGVkIikpIHsKICAgICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXggPSBpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpKys7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICEoY3VyQ2hpbGQgPSBjdXJDaGlsZC5uZXh0U2libGluZykgJiYgb3B0Z3JvdXAgJiYgKGN1ckNoaWxkID0gb3B0Z3JvdXAubmV4dFNpYmxpbmcsIG9wdGdyb3VwID0gbnVsbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmcm9tRWwuc2VsZWN0ZWRJbmRleCA9IHNlbGVjdGVkSW5kZXg7CiAgICAgIH0KICAgIH0KICB9LAogICAgICBFTEVNRU5UX05PREUgPSAxLAogICAgICBET0NVTUVOVF9GUkFHTUVOVF9OT0RFID0gMTEsCiAgICAgIFRFWFRfTk9ERSA9IDMsCiAgICAgIENPTU1FTlRfTk9ERSA9IDg7CgogIGZ1bmN0aW9uIG5vb3AkMSgpIHt9CgogIGZ1bmN0aW9uIGRlZmF1bHRHZXROb2RlS2V5KG5vZGUpIHsKICAgIHJldHVybiBub2RlLmlkOwogIH0KCiAgZnVuY3Rpb24gbW9ycGhkb21GYWN0b3J5KG1vcnBoQXR0cnMpIHsKICAgIHJldHVybiBmdW5jdGlvbiBtb3JwaGRvbShmcm9tTm9kZSwgdG9Ob2RlLCBvcHRpb25zKSB7CiAgICAgIGlmIChvcHRpb25zIHx8IChvcHRpb25zID0ge30pLCAic3RyaW5nIiA9PSB0eXBlb2YgdG9Ob2RlKSBpZiAoIiNkb2N1bWVudCIgPT09IGZyb21Ob2RlLm5vZGVOYW1lIHx8ICJIVE1MIiA9PT0gZnJvbU5vZGUubm9kZU5hbWUpIHsKICAgICAgICB2YXIgdG9Ob2RlSHRtbCA9IHRvTm9kZTsKICAgICAgICAodG9Ob2RlID0gZG9jLmNyZWF0ZUVsZW1lbnQoImh0bWwiKSkuaW5uZXJIVE1MID0gdG9Ob2RlSHRtbDsKICAgICAgfSBlbHNlIHRvTm9kZSA9IHRvRWxlbWVudCh0b05vZGUpOwogICAgICB2YXIgZ2V0Tm9kZUtleSA9IG9wdGlvbnMuZ2V0Tm9kZUtleSB8fCBkZWZhdWx0R2V0Tm9kZUtleSwKICAgICAgICAgIG9uQmVmb3JlTm9kZUFkZGVkID0gb3B0aW9ucy5vbkJlZm9yZU5vZGVBZGRlZCB8fCBub29wJDEsCiAgICAgICAgICBvbk5vZGVBZGRlZCA9IG9wdGlvbnMub25Ob2RlQWRkZWQgfHwgbm9vcCQxLAogICAgICAgICAgb25CZWZvcmVFbFVwZGF0ZWQgPSBvcHRpb25zLm9uQmVmb3JlRWxVcGRhdGVkIHx8IG5vb3AkMSwKICAgICAgICAgIG9uRWxVcGRhdGVkID0gb3B0aW9ucy5vbkVsVXBkYXRlZCB8fCBub29wJDEsCiAgICAgICAgICBvbkJlZm9yZU5vZGVEaXNjYXJkZWQgPSBvcHRpb25zLm9uQmVmb3JlTm9kZURpc2NhcmRlZCB8fCBub29wJDEsCiAgICAgICAgICBvbk5vZGVEaXNjYXJkZWQgPSBvcHRpb25zLm9uTm9kZURpc2NhcmRlZCB8fCBub29wJDEsCiAgICAgICAgICBvbkJlZm9yZUVsQ2hpbGRyZW5VcGRhdGVkID0gb3B0aW9ucy5vbkJlZm9yZUVsQ2hpbGRyZW5VcGRhdGVkIHx8IG5vb3AkMSwKICAgICAgICAgIGNoaWxkcmVuT25seSA9ICEwID09PSBvcHRpb25zLmNoaWxkcmVuT25seSwKICAgICAgICAgIGZyb21Ob2Rlc0xvb2t1cCA9IHt9LAogICAgICAgICAga2V5ZWRSZW1vdmFsTGlzdDsKCiAgICAgIGZ1bmN0aW9uIGFkZEtleWVkUmVtb3ZhbChrZXkpIHsKICAgICAgICBrZXllZFJlbW92YWxMaXN0ID8ga2V5ZWRSZW1vdmFsTGlzdC5wdXNoKGtleSkgOiBrZXllZFJlbW92YWxMaXN0ID0gW2tleV07CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHdhbGtEaXNjYXJkZWRDaGlsZE5vZGVzKG5vZGUsIHNraXBLZXllZE5vZGVzKSB7CiAgICAgICAgaWYgKDEgPT09IG5vZGUubm9kZVR5cGUpIGZvciAodmFyIGN1ckNoaWxkID0gbm9kZS5maXJzdENoaWxkOyBjdXJDaGlsZDspIHsKICAgICAgICAgIHZhciBrZXkgPSB2b2lkIDA7CiAgICAgICAgICBza2lwS2V5ZWROb2RlcyAmJiAoa2V5ID0gZ2V0Tm9kZUtleShjdXJDaGlsZCkpID8gYWRkS2V5ZWRSZW1vdmFsKGtleSkgOiAob25Ob2RlRGlzY2FyZGVkKGN1ckNoaWxkKSwgY3VyQ2hpbGQuZmlyc3RDaGlsZCAmJiB3YWxrRGlzY2FyZGVkQ2hpbGROb2RlcyhjdXJDaGlsZCwgc2tpcEtleWVkTm9kZXMpKSwgY3VyQ2hpbGQgPSBjdXJDaGlsZC5uZXh0U2libGluZzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHJlbW92ZU5vZGUobm9kZSwgcGFyZW50Tm9kZSwgc2tpcEtleWVkTm9kZXMpIHsKICAgICAgICAhMSAhPT0gb25CZWZvcmVOb2RlRGlzY2FyZGVkKG5vZGUpICYmIChwYXJlbnROb2RlICYmIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSksIG9uTm9kZURpc2NhcmRlZChub2RlKSwgd2Fsa0Rpc2NhcmRlZENoaWxkTm9kZXMobm9kZSwgc2tpcEtleWVkTm9kZXMpKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gaW5kZXhUcmVlKG5vZGUpIHsKICAgICAgICBpZiAoMSA9PT0gbm9kZS5ub2RlVHlwZSB8fCAxMSA9PT0gbm9kZS5ub2RlVHlwZSkgZm9yICh2YXIgY3VyQ2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7IGN1ckNoaWxkOykgewogICAgICAgICAgdmFyIGtleSA9IGdldE5vZGVLZXkoY3VyQ2hpbGQpOwogICAgICAgICAga2V5ICYmIChmcm9tTm9kZXNMb29rdXBba2V5XSA9IGN1ckNoaWxkKSwgaW5kZXhUcmVlKGN1ckNoaWxkKSwgY3VyQ2hpbGQgPSBjdXJDaGlsZC5uZXh0U2libGluZzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGhhbmRsZU5vZGVBZGRlZChlbCkgewogICAgICAgIG9uTm9kZUFkZGVkKGVsKTsKCiAgICAgICAgZm9yICh2YXIgY3VyQ2hpbGQgPSBlbC5maXJzdENoaWxkOyBjdXJDaGlsZDspIHsKICAgICAgICAgIHZhciBuZXh0U2libGluZyA9IGN1ckNoaWxkLm5leHRTaWJsaW5nLAogICAgICAgICAgICAgIGtleSA9IGdldE5vZGVLZXkoY3VyQ2hpbGQpOwoKICAgICAgICAgIGlmIChrZXkpIHsKICAgICAgICAgICAgdmFyIHVubWF0Y2hlZEZyb21FbCA9IGZyb21Ob2Rlc0xvb2t1cFtrZXldOwogICAgICAgICAgICB1bm1hdGNoZWRGcm9tRWwgJiYgY29tcGFyZU5vZGVOYW1lcyhjdXJDaGlsZCwgdW5tYXRjaGVkRnJvbUVsKSAmJiAoY3VyQ2hpbGQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodW5tYXRjaGVkRnJvbUVsLCBjdXJDaGlsZCksIG1vcnBoRWwodW5tYXRjaGVkRnJvbUVsLCBjdXJDaGlsZCkpOwogICAgICAgICAgfQoKICAgICAgICAgIGhhbmRsZU5vZGVBZGRlZChjdXJDaGlsZCksIGN1ckNoaWxkID0gbmV4dFNpYmxpbmc7CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBjbGVhbnVwRnJvbUVsKGZyb21FbCwgY3VyRnJvbU5vZGVDaGlsZCwgY3VyRnJvbU5vZGVLZXkpIHsKICAgICAgICBmb3IgKDsgY3VyRnJvbU5vZGVDaGlsZDspIHsKICAgICAgICAgIHZhciBmcm9tTmV4dFNpYmxpbmcgPSBjdXJGcm9tTm9kZUNoaWxkLm5leHRTaWJsaW5nOwogICAgICAgICAgKGN1ckZyb21Ob2RlS2V5ID0gZ2V0Tm9kZUtleShjdXJGcm9tTm9kZUNoaWxkKSkgPyBhZGRLZXllZFJlbW92YWwoY3VyRnJvbU5vZGVLZXkpIDogcmVtb3ZlTm9kZShjdXJGcm9tTm9kZUNoaWxkLCBmcm9tRWwsICEwKSwgY3VyRnJvbU5vZGVDaGlsZCA9IGZyb21OZXh0U2libGluZzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIG1vcnBoRWwoZnJvbUVsLCB0b0VsLCBjaGlsZHJlbk9ubHkpIHsKICAgICAgICB2YXIgdG9FbEtleSA9IGdldE5vZGVLZXkodG9FbCk7CgogICAgICAgIGlmICh0b0VsS2V5ICYmIGRlbGV0ZSBmcm9tTm9kZXNMb29rdXBbdG9FbEtleV0sICF0b05vZGUuaXNTYW1lTm9kZSB8fCAhdG9Ob2RlLmlzU2FtZU5vZGUoZnJvbU5vZGUpKSB7CiAgICAgICAgICBpZiAoIWNoaWxkcmVuT25seSkgewogICAgICAgICAgICBpZiAoITEgPT09IG9uQmVmb3JlRWxVcGRhdGVkKGZyb21FbCwgdG9FbCkpIHJldHVybjsKICAgICAgICAgICAgaWYgKG1vcnBoQXR0cnMoZnJvbUVsLCB0b0VsKSwgb25FbFVwZGF0ZWQoZnJvbUVsKSwgITEgPT09IG9uQmVmb3JlRWxDaGlsZHJlblVwZGF0ZWQoZnJvbUVsLCB0b0VsKSkgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgICJURVhUQVJFQSIgIT09IGZyb21FbC5ub2RlTmFtZSA/IG1vcnBoQ2hpbGRyZW4oZnJvbUVsLCB0b0VsKSA6IHNwZWNpYWxFbEhhbmRsZXJzLlRFWFRBUkVBKGZyb21FbCwgdG9FbCk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBtb3JwaENoaWxkcmVuKGZyb21FbCwgdG9FbCkgewogICAgICAgIHZhciBjdXJUb05vZGVDaGlsZCA9IHRvRWwuZmlyc3RDaGlsZCwKICAgICAgICAgICAgY3VyRnJvbU5vZGVDaGlsZCA9IGZyb21FbC5maXJzdENoaWxkLAogICAgICAgICAgICBjdXJUb05vZGVLZXksCiAgICAgICAgICAgIGN1ckZyb21Ob2RlS2V5LAogICAgICAgICAgICBmcm9tTmV4dFNpYmxpbmcsCiAgICAgICAgICAgIHRvTmV4dFNpYmxpbmcsCiAgICAgICAgICAgIG1hdGNoaW5nRnJvbUVsOwoKICAgICAgICBvdXRlcjogZm9yICg7IGN1clRvTm9kZUNoaWxkOykgewogICAgICAgICAgZm9yICh0b05leHRTaWJsaW5nID0gY3VyVG9Ob2RlQ2hpbGQubmV4dFNpYmxpbmcsIGN1clRvTm9kZUtleSA9IGdldE5vZGVLZXkoY3VyVG9Ob2RlQ2hpbGQpOyBjdXJGcm9tTm9kZUNoaWxkOykgewogICAgICAgICAgICBpZiAoZnJvbU5leHRTaWJsaW5nID0gY3VyRnJvbU5vZGVDaGlsZC5uZXh0U2libGluZywgY3VyVG9Ob2RlQ2hpbGQuaXNTYW1lTm9kZSAmJiBjdXJUb05vZGVDaGlsZC5pc1NhbWVOb2RlKGN1ckZyb21Ob2RlQ2hpbGQpKSB7CiAgICAgICAgICAgICAgY3VyVG9Ob2RlQ2hpbGQgPSB0b05leHRTaWJsaW5nLCBjdXJGcm9tTm9kZUNoaWxkID0gZnJvbU5leHRTaWJsaW5nOwogICAgICAgICAgICAgIGNvbnRpbnVlIG91dGVyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjdXJGcm9tTm9kZUtleSA9IGdldE5vZGVLZXkoY3VyRnJvbU5vZGVDaGlsZCk7CiAgICAgICAgICAgIHZhciBjdXJGcm9tTm9kZVR5cGUgPSBjdXJGcm9tTm9kZUNoaWxkLm5vZGVUeXBlLAogICAgICAgICAgICAgICAgaXNDb21wYXRpYmxlID0gdm9pZCAwOwoKICAgICAgICAgICAgaWYgKGN1ckZyb21Ob2RlVHlwZSA9PT0gY3VyVG9Ob2RlQ2hpbGQubm9kZVR5cGUgJiYgKDEgPT09IGN1ckZyb21Ob2RlVHlwZSA/IChjdXJUb05vZGVLZXkgPyBjdXJUb05vZGVLZXkgIT09IGN1ckZyb21Ob2RlS2V5ICYmICgobWF0Y2hpbmdGcm9tRWwgPSBmcm9tTm9kZXNMb29rdXBbY3VyVG9Ob2RlS2V5XSkgPyBmcm9tTmV4dFNpYmxpbmcgPT09IG1hdGNoaW5nRnJvbUVsID8gaXNDb21wYXRpYmxlID0gITEgOiAoZnJvbUVsLmluc2VydEJlZm9yZShtYXRjaGluZ0Zyb21FbCwgY3VyRnJvbU5vZGVDaGlsZCksIGN1ckZyb21Ob2RlS2V5ID8gYWRkS2V5ZWRSZW1vdmFsKGN1ckZyb21Ob2RlS2V5KSA6IHJlbW92ZU5vZGUoY3VyRnJvbU5vZGVDaGlsZCwgZnJvbUVsLCAhMCksIGN1ckZyb21Ob2RlQ2hpbGQgPSBtYXRjaGluZ0Zyb21FbCkgOiBpc0NvbXBhdGlibGUgPSAhMSkgOiBjdXJGcm9tTm9kZUtleSAmJiAoaXNDb21wYXRpYmxlID0gITEpLCAoaXNDb21wYXRpYmxlID0gITEgIT09IGlzQ29tcGF0aWJsZSAmJiBjb21wYXJlTm9kZU5hbWVzKGN1ckZyb21Ob2RlQ2hpbGQsIGN1clRvTm9kZUNoaWxkKSkgJiYgbW9ycGhFbChjdXJGcm9tTm9kZUNoaWxkLCBjdXJUb05vZGVDaGlsZCkpIDogMyAhPT0gY3VyRnJvbU5vZGVUeXBlICYmIDggIT0gY3VyRnJvbU5vZGVUeXBlIHx8IChpc0NvbXBhdGlibGUgPSAhMCwgY3VyRnJvbU5vZGVDaGlsZC5ub2RlVmFsdWUgIT09IGN1clRvTm9kZUNoaWxkLm5vZGVWYWx1ZSAmJiAoY3VyRnJvbU5vZGVDaGlsZC5ub2RlVmFsdWUgPSBjdXJUb05vZGVDaGlsZC5ub2RlVmFsdWUpKSksIGlzQ29tcGF0aWJsZSkgewogICAgICAgICAgICAgIGN1clRvTm9kZUNoaWxkID0gdG9OZXh0U2libGluZywgY3VyRnJvbU5vZGVDaGlsZCA9IGZyb21OZXh0U2libGluZzsKICAgICAgICAgICAgICBjb250aW51ZSBvdXRlcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY3VyRnJvbU5vZGVLZXkgPyBhZGRLZXllZFJlbW92YWwoY3VyRnJvbU5vZGVLZXkpIDogcmVtb3ZlTm9kZShjdXJGcm9tTm9kZUNoaWxkLCBmcm9tRWwsICEwKSwgY3VyRnJvbU5vZGVDaGlsZCA9IGZyb21OZXh0U2libGluZzsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY3VyVG9Ob2RlS2V5ICYmIChtYXRjaGluZ0Zyb21FbCA9IGZyb21Ob2Rlc0xvb2t1cFtjdXJUb05vZGVLZXldKSAmJiBjb21wYXJlTm9kZU5hbWVzKG1hdGNoaW5nRnJvbUVsLCBjdXJUb05vZGVDaGlsZCkpIGZyb21FbC5hcHBlbmRDaGlsZChtYXRjaGluZ0Zyb21FbCksIG1vcnBoRWwobWF0Y2hpbmdGcm9tRWwsIGN1clRvTm9kZUNoaWxkKTtlbHNlIHsKICAgICAgICAgICAgdmFyIG9uQmVmb3JlTm9kZUFkZGVkUmVzdWx0ID0gb25CZWZvcmVOb2RlQWRkZWQoY3VyVG9Ob2RlQ2hpbGQpOwogICAgICAgICAgICAhMSAhPT0gb25CZWZvcmVOb2RlQWRkZWRSZXN1bHQgJiYgKG9uQmVmb3JlTm9kZUFkZGVkUmVzdWx0ICYmIChjdXJUb05vZGVDaGlsZCA9IG9uQmVmb3JlTm9kZUFkZGVkUmVzdWx0KSwgY3VyVG9Ob2RlQ2hpbGQuYWN0dWFsaXplICYmIChjdXJUb05vZGVDaGlsZCA9IGN1clRvTm9kZUNoaWxkLmFjdHVhbGl6ZShmcm9tRWwub3duZXJEb2N1bWVudCB8fCBkb2MpKSwgZnJvbUVsLmFwcGVuZENoaWxkKGN1clRvTm9kZUNoaWxkKSwgaGFuZGxlTm9kZUFkZGVkKGN1clRvTm9kZUNoaWxkKSk7CiAgICAgICAgICB9CiAgICAgICAgICBjdXJUb05vZGVDaGlsZCA9IHRvTmV4dFNpYmxpbmcsIGN1ckZyb21Ob2RlQ2hpbGQgPSBmcm9tTmV4dFNpYmxpbmc7CiAgICAgICAgfQoKICAgICAgICBjbGVhbnVwRnJvbUVsKGZyb21FbCwgY3VyRnJvbU5vZGVDaGlsZCwgY3VyRnJvbU5vZGVLZXkpOwogICAgICAgIHZhciBzcGVjaWFsRWxIYW5kbGVyID0gc3BlY2lhbEVsSGFuZGxlcnNbZnJvbUVsLm5vZGVOYW1lXTsKICAgICAgICBzcGVjaWFsRWxIYW5kbGVyICYmIHNwZWNpYWxFbEhhbmRsZXIoZnJvbUVsLCB0b0VsKTsKICAgICAgfQoKICAgICAgaW5kZXhUcmVlKGZyb21Ob2RlKTsKICAgICAgdmFyIG1vcnBoZWROb2RlID0gZnJvbU5vZGUsCiAgICAgICAgICBtb3JwaGVkTm9kZVR5cGUgPSBtb3JwaGVkTm9kZS5ub2RlVHlwZSwKICAgICAgICAgIHRvTm9kZVR5cGUgPSB0b05vZGUubm9kZVR5cGU7CiAgICAgIGlmICghY2hpbGRyZW5Pbmx5KSBpZiAoMSA9PT0gbW9ycGhlZE5vZGVUeXBlKSAxID09PSB0b05vZGVUeXBlID8gY29tcGFyZU5vZGVOYW1lcyhmcm9tTm9kZSwgdG9Ob2RlKSB8fCAob25Ob2RlRGlzY2FyZGVkKGZyb21Ob2RlKSwgbW9ycGhlZE5vZGUgPSBtb3ZlQ2hpbGRyZW4oZnJvbU5vZGUsIGNyZWF0ZUVsZW1lbnROUyh0b05vZGUubm9kZU5hbWUsIHRvTm9kZS5uYW1lc3BhY2VVUkkpKSkgOiBtb3JwaGVkTm9kZSA9IHRvTm9kZTtlbHNlIGlmICgzID09PSBtb3JwaGVkTm9kZVR5cGUgfHwgOCA9PT0gbW9ycGhlZE5vZGVUeXBlKSB7CiAgICAgICAgaWYgKHRvTm9kZVR5cGUgPT09IG1vcnBoZWROb2RlVHlwZSkgcmV0dXJuIG1vcnBoZWROb2RlLm5vZGVWYWx1ZSAhPT0gdG9Ob2RlLm5vZGVWYWx1ZSAmJiAobW9ycGhlZE5vZGUubm9kZVZhbHVlID0gdG9Ob2RlLm5vZGVWYWx1ZSksIG1vcnBoZWROb2RlOwogICAgICAgIG1vcnBoZWROb2RlID0gdG9Ob2RlOwogICAgICB9CiAgICAgIGlmIChtb3JwaGVkTm9kZSA9PT0gdG9Ob2RlKSBvbk5vZGVEaXNjYXJkZWQoZnJvbU5vZGUpO2Vsc2UgaWYgKG1vcnBoRWwobW9ycGhlZE5vZGUsIHRvTm9kZSwgY2hpbGRyZW5Pbmx5KSwga2V5ZWRSZW1vdmFsTGlzdCkgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGtleWVkUmVtb3ZhbExpc3QubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICB2YXIgZWxUb1JlbW92ZSA9IGZyb21Ob2Rlc0xvb2t1cFtrZXllZFJlbW92YWxMaXN0W2ldXTsKICAgICAgICBlbFRvUmVtb3ZlICYmIHJlbW92ZU5vZGUoZWxUb1JlbW92ZSwgZWxUb1JlbW92ZS5wYXJlbnROb2RlLCAhMSk7CiAgICAgIH0KICAgICAgcmV0dXJuICFjaGlsZHJlbk9ubHkgJiYgbW9ycGhlZE5vZGUgIT09IGZyb21Ob2RlICYmIGZyb21Ob2RlLnBhcmVudE5vZGUgJiYgKG1vcnBoZWROb2RlLmFjdHVhbGl6ZSAmJiAobW9ycGhlZE5vZGUgPSBtb3JwaGVkTm9kZS5hY3R1YWxpemUoZnJvbU5vZGUub3duZXJEb2N1bWVudCB8fCBkb2MpKSwgZnJvbU5vZGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobW9ycGhlZE5vZGUsIGZyb21Ob2RlKSksIG1vcnBoZWROb2RlOwogICAgfTsKICB9CgogIHZhciBtb3JwaGRvbSA9IG1vcnBoZG9tRmFjdG9yeShtb3JwaEF0dHJzKSwKICAgICAgY29tbW9uanNHbG9iYWwgPSAidW5kZWZpbmVkIiAhPSB0eXBlb2YgZ2xvYmFsVGhpcyA/IGdsb2JhbFRoaXMgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIGdsb2JhbCA/IGdsb2JhbCA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBzZWxmID8gc2VsZiA6IHt9OwoKICBmdW5jdGlvbiBjcmVhdGVDb21tb25qc01vZHVsZShmbiwgbW9kdWxlKSB7CiAgICByZXR1cm4gZm4obW9kdWxlID0gewogICAgICBleHBvcnRzOiB7fQogICAgfSwgbW9kdWxlLmV4cG9ydHMpLCBtb2R1bGUuZXhwb3J0czsKICB9CgogIHZhciBtdXN0YWNoZSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHsKICAgIC8qIQogICAgICAgICAqIG11c3RhY2hlLmpzIC0gTG9naWMtbGVzcyB7e211c3RhY2hlfX0gdGVtcGxhdGVzIHdpdGggSmF2YVNjcmlwdAogICAgICAgICAqIGh0dHA6Ly9naXRodWIuY29tL2phbmwvbXVzdGFjaGUuanMKICAgICAgICAgKi8KICAgICFmdW5jdGlvbiBkZWZpbmVNdXN0YWNoZShnbG9iYWwsIGZhY3RvcnkpIHsKICAgICAgZXhwb3J0cyAmJiAic3RyaW5nIiAhPSB0eXBlb2YgZXhwb3J0cy5ub2RlTmFtZSA/IGZhY3RvcnkoZXhwb3J0cykgOiAoZ2xvYmFsLk11c3RhY2hlID0ge30sIGZhY3RvcnkoZ2xvYmFsLk11c3RhY2hlKSk7CiAgICB9KGNvbW1vbmpzR2xvYmFsLCBmdW5jdGlvbiBtdXN0YWNoZUZhY3RvcnkobXVzdGFjaGUpIHsKICAgICAgdmFyIG9iamVjdFRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywKICAgICAgICAgIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIGlzQXJyYXlQb2x5ZmlsbChvYmplY3QpIHsKICAgICAgICByZXR1cm4gIltvYmplY3QgQXJyYXldIiA9PT0gb2JqZWN0VG9TdHJpbmcuY2FsbChvYmplY3QpOwogICAgICB9OwoKICAgICAgZnVuY3Rpb24gaXNGdW5jdGlvbihvYmplY3QpIHsKICAgICAgICByZXR1cm4gImZ1bmN0aW9uIiA9PSB0eXBlb2Ygb2JqZWN0OwogICAgICB9CgogICAgICBmdW5jdGlvbiB0eXBlU3RyKG9iaikgewogICAgICAgIHJldHVybiBpc0FycmF5KG9iaikgPyAiYXJyYXkiIDogX3R5cGVvZjIob2JqKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZXNjYXBlUmVnRXhwKHN0cmluZykgewogICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvW1wtXFtcXXt9KCkqKz8uLFxcXF4kfCNcc10vZywgIlxcJCYiKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gaGFzUHJvcGVydHkob2JqLCBwcm9wTmFtZSkgewogICAgICAgIHJldHVybiBudWxsICE9IG9iaiAmJiAib2JqZWN0IiA9PSBfdHlwZW9mMihvYmopICYmIHByb3BOYW1lIGluIG9iajsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gcHJpbWl0aXZlSGFzT3duUHJvcGVydHkocHJpbWl0aXZlLCBwcm9wTmFtZSkgewogICAgICAgIHJldHVybiBudWxsICE9IHByaW1pdGl2ZSAmJiAib2JqZWN0IiAhPSBfdHlwZW9mMihwcmltaXRpdmUpICYmIHByaW1pdGl2ZS5oYXNPd25Qcm9wZXJ0eSAmJiBwcmltaXRpdmUuaGFzT3duUHJvcGVydHkocHJvcE5hbWUpOwogICAgICB9CgogICAgICB2YXIgcmVnRXhwVGVzdCA9IFJlZ0V4cC5wcm90b3R5cGUudGVzdDsKCiAgICAgIGZ1bmN0aW9uIHRlc3RSZWdFeHAocmUsIHN0cmluZykgewogICAgICAgIHJldHVybiByZWdFeHBUZXN0LmNhbGwocmUsIHN0cmluZyk7CiAgICAgIH0KCiAgICAgIHZhciBub25TcGFjZVJlID0gL1xTLzsKCiAgICAgIGZ1bmN0aW9uIGlzV2hpdGVzcGFjZShzdHJpbmcpIHsKICAgICAgICByZXR1cm4gIXRlc3RSZWdFeHAobm9uU3BhY2VSZSwgc3RyaW5nKTsKICAgICAgfQoKICAgICAgdmFyIGVudGl0eU1hcCA9IHsKICAgICAgICAiJiI6ICImYW1wOyIsCiAgICAgICAgIjwiOiAiJmx0OyIsCiAgICAgICAgIj4iOiAiJmd0OyIsCiAgICAgICAgJyInOiAiJnF1b3Q7IiwKICAgICAgICAiJyI6ICImIzM5OyIsCiAgICAgICAgIi8iOiAiJiN4MkY7IiwKICAgICAgICAiYCI6ICImI3g2MDsiLAogICAgICAgICI9IjogIiYjeDNEOyIKICAgICAgfTsKCiAgICAgIGZ1bmN0aW9uIGVzY2FwZUh0bWwoc3RyaW5nKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZyhzdHJpbmcpLnJlcGxhY2UoL1smPD4iJ2A9XC9dL2csIGZ1bmN0aW9uIGZyb21FbnRpdHlNYXAocykgewogICAgICAgICAgcmV0dXJuIGVudGl0eU1hcFtzXTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIHdoaXRlUmUgPSAvXHMqLywKICAgICAgICAgIHNwYWNlUmUgPSAvXHMrLywKICAgICAgICAgIGVxdWFsc1JlID0gL1xzKj0vLAogICAgICAgICAgY3VybHlSZSA9IC9ccypcfS8sCiAgICAgICAgICB0YWdSZSA9IC8jfFxefFwvfD58XHt8Jnw9fCEvOwoKICAgICAgZnVuY3Rpb24gcGFyc2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgdGFncykgewogICAgICAgIGlmICghdGVtcGxhdGUpIHJldHVybiBbXTsKICAgICAgICB2YXIgc2VjdGlvbnMgPSBbXSwKICAgICAgICAgICAgdG9rZW5zID0gW10sCiAgICAgICAgICAgIHNwYWNlcyA9IFtdLAogICAgICAgICAgICBoYXNUYWcgPSAhMSwKICAgICAgICAgICAgbm9uU3BhY2UgPSAhMSwKICAgICAgICAgICAgb3BlbmluZ1RhZ1JlLAogICAgICAgICAgICBjbG9zaW5nVGFnUmUsCiAgICAgICAgICAgIGNsb3NpbmdDdXJseVJlOwoKICAgICAgICBmdW5jdGlvbiBzdHJpcFNwYWNlKCkgewogICAgICAgICAgaWYgKGhhc1RhZyAmJiAhbm9uU3BhY2UpIGZvciAoOyBzcGFjZXMubGVuZ3RoOykgewogICAgICAgICAgICBkZWxldGUgdG9rZW5zW3NwYWNlcy5wb3AoKV07CiAgICAgICAgICB9IGVsc2Ugc3BhY2VzID0gW107CiAgICAgICAgICBoYXNUYWcgPSAhMSwgbm9uU3BhY2UgPSAhMTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGNvbXBpbGVUYWdzKHRhZ3NUb0NvbXBpbGUpIHsKICAgICAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgdGFnc1RvQ29tcGlsZSAmJiAodGFnc1RvQ29tcGlsZSA9IHRhZ3NUb0NvbXBpbGUuc3BsaXQoc3BhY2VSZSwgMikpLCAhaXNBcnJheSh0YWdzVG9Db21waWxlKSB8fCAyICE9PSB0YWdzVG9Db21waWxlLmxlbmd0aCkgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHRhZ3M6ICIgKyB0YWdzVG9Db21waWxlKTsKICAgICAgICAgIG9wZW5pbmdUYWdSZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXhwKHRhZ3NUb0NvbXBpbGVbMF0pICsgIlxccyoiKSwgY2xvc2luZ1RhZ1JlID0gbmV3IFJlZ0V4cCgiXFxzKiIgKyBlc2NhcGVSZWdFeHAodGFnc1RvQ29tcGlsZVsxXSkpLCBjbG9zaW5nQ3VybHlSZSA9IG5ldyBSZWdFeHAoIlxccyoiICsgZXNjYXBlUmVnRXhwKCJ9IiArIHRhZ3NUb0NvbXBpbGVbMV0pKTsKICAgICAgICB9CgogICAgICAgIGNvbXBpbGVUYWdzKHRhZ3MgfHwgbXVzdGFjaGUudGFncyk7CgogICAgICAgIGZvciAodmFyIHNjYW5uZXIgPSBuZXcgU2Nhbm5lcih0ZW1wbGF0ZSksIHN0YXJ0LCB0eXBlLCB2YWx1ZSwgY2hyLCB0b2tlbiwgb3BlblNlY3Rpb247ICFzY2FubmVyLmVvcygpOykgewogICAgICAgICAgaWYgKHN0YXJ0ID0gc2Nhbm5lci5wb3MsIHZhbHVlID0gc2Nhbm5lci5zY2FuVW50aWwob3BlbmluZ1RhZ1JlKSkgZm9yICh2YXIgaSA9IDAsIHZhbHVlTGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBpIDwgdmFsdWVMZW5ndGg7ICsraSkgewogICAgICAgICAgICBpc1doaXRlc3BhY2UoY2hyID0gdmFsdWUuY2hhckF0KGkpKSA/IHNwYWNlcy5wdXNoKHRva2Vucy5sZW5ndGgpIDogbm9uU3BhY2UgPSAhMCwgdG9rZW5zLnB1c2goWyJ0ZXh0IiwgY2hyLCBzdGFydCwgc3RhcnQgKyAxXSksIHN0YXJ0ICs9IDEsICJcbiIgPT09IGNociAmJiBzdHJpcFNwYWNlKCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXNjYW5uZXIuc2NhbihvcGVuaW5nVGFnUmUpKSBicmVhazsKICAgICAgICAgIGlmIChoYXNUYWcgPSAhMCwgdHlwZSA9IHNjYW5uZXIuc2Nhbih0YWdSZSkgfHwgIm5hbWUiLCBzY2FubmVyLnNjYW4od2hpdGVSZSksICI9IiA9PT0gdHlwZSA/ICh2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKGVxdWFsc1JlKSwgc2Nhbm5lci5zY2FuKGVxdWFsc1JlKSwgc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ1RhZ1JlKSkgOiAieyIgPT09IHR5cGUgPyAodmFsdWUgPSBzY2FubmVyLnNjYW5VbnRpbChjbG9zaW5nQ3VybHlSZSksIHNjYW5uZXIuc2NhbihjdXJseVJlKSwgc2Nhbm5lci5zY2FuVW50aWwoY2xvc2luZ1RhZ1JlKSwgdHlwZSA9ICImIikgOiB2YWx1ZSA9IHNjYW5uZXIuc2NhblVudGlsKGNsb3NpbmdUYWdSZSksICFzY2FubmVyLnNjYW4oY2xvc2luZ1RhZ1JlKSkgdGhyb3cgbmV3IEVycm9yKCJVbmNsb3NlZCB0YWcgYXQgIiArIHNjYW5uZXIucG9zKTsKICAgICAgICAgIGlmICh0b2tlbiA9IFt0eXBlLCB2YWx1ZSwgc3RhcnQsIHNjYW5uZXIucG9zXSwgdG9rZW5zLnB1c2godG9rZW4pLCAiIyIgPT09IHR5cGUgfHwgIl4iID09PSB0eXBlKSBzZWN0aW9ucy5wdXNoKHRva2VuKTtlbHNlIGlmICgiLyIgPT09IHR5cGUpIHsKICAgICAgICAgICAgaWYgKCEob3BlblNlY3Rpb24gPSBzZWN0aW9ucy5wb3AoKSkpIHRocm93IG5ldyBFcnJvcignVW5vcGVuZWQgc2VjdGlvbiAiJyArIHZhbHVlICsgJyIgYXQgJyArIHN0YXJ0KTsKICAgICAgICAgICAgaWYgKG9wZW5TZWN0aW9uWzFdICE9PSB2YWx1ZSkgdGhyb3cgbmV3IEVycm9yKCdVbmNsb3NlZCBzZWN0aW9uICInICsgb3BlblNlY3Rpb25bMV0gKyAnIiBhdCAnICsgc3RhcnQpOwogICAgICAgICAgfSBlbHNlICJuYW1lIiA9PT0gdHlwZSB8fCAieyIgPT09IHR5cGUgfHwgIiYiID09PSB0eXBlID8gbm9uU3BhY2UgPSAhMCA6ICI9IiA9PT0gdHlwZSAmJiBjb21waWxlVGFncyh2YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAob3BlblNlY3Rpb24gPSBzZWN0aW9ucy5wb3AoKSkgdGhyb3cgbmV3IEVycm9yKCdVbmNsb3NlZCBzZWN0aW9uICInICsgb3BlblNlY3Rpb25bMV0gKyAnIiBhdCAnICsgc2Nhbm5lci5wb3MpOwogICAgICAgIHJldHVybiBuZXN0VG9rZW5zKHNxdWFzaFRva2Vucyh0b2tlbnMpKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gc3F1YXNoVG9rZW5zKHRva2VucykgewogICAgICAgIGZvciAodmFyIHNxdWFzaGVkVG9rZW5zID0gW10sIHRva2VuLCBsYXN0VG9rZW4sIGkgPSAwLCBudW1Ub2tlbnMgPSB0b2tlbnMubGVuZ3RoOyBpIDwgbnVtVG9rZW5zOyArK2kpIHsKICAgICAgICAgICh0b2tlbiA9IHRva2Vuc1tpXSkgJiYgKCJ0ZXh0IiA9PT0gdG9rZW5bMF0gJiYgbGFzdFRva2VuICYmICJ0ZXh0IiA9PT0gbGFzdFRva2VuWzBdID8gKGxhc3RUb2tlblsxXSArPSB0b2tlblsxXSwgbGFzdFRva2VuWzNdID0gdG9rZW5bM10pIDogKHNxdWFzaGVkVG9rZW5zLnB1c2godG9rZW4pLCBsYXN0VG9rZW4gPSB0b2tlbikpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHNxdWFzaGVkVG9rZW5zOwogICAgICB9CgogICAgICBmdW5jdGlvbiBuZXN0VG9rZW5zKHRva2VucykgewogICAgICAgIGZvciAodmFyIG5lc3RlZFRva2VucyA9IFtdLCBjb2xsZWN0b3IgPSBuZXN0ZWRUb2tlbnMsIHNlY3Rpb25zID0gW10sIHRva2VuLCBzZWN0aW9uLCBpID0gMCwgbnVtVG9rZW5zID0gdG9rZW5zLmxlbmd0aDsgaSA8IG51bVRva2VuczsgKytpKSB7CiAgICAgICAgICBzd2l0Y2ggKCh0b2tlbiA9IHRva2Vuc1tpXSlbMF0pIHsKICAgICAgICAgICAgY2FzZSAiIyI6CiAgICAgICAgICAgIGNhc2UgIl4iOgogICAgICAgICAgICAgIGNvbGxlY3Rvci5wdXNoKHRva2VuKSwgc2VjdGlvbnMucHVzaCh0b2tlbiksIGNvbGxlY3RvciA9IHRva2VuWzRdID0gW107CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICIvIjoKICAgICAgICAgICAgICAoc2VjdGlvbiA9IHNlY3Rpb25zLnBvcCgpKVs1XSA9IHRva2VuWzJdLCBjb2xsZWN0b3IgPSBzZWN0aW9ucy5sZW5ndGggPiAwID8gc2VjdGlvbnNbc2VjdGlvbnMubGVuZ3RoIC0gMV1bNF0gOiBuZXN0ZWRUb2tlbnM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIGNvbGxlY3Rvci5wdXNoKHRva2VuKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBuZXN0ZWRUb2tlbnM7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIFNjYW5uZXIoc3RyaW5nKSB7CiAgICAgICAgdGhpcy5zdHJpbmcgPSBzdHJpbmcsIHRoaXMudGFpbCA9IHN0cmluZywgdGhpcy5wb3MgPSAwOwogICAgICB9CgogICAgICBmdW5jdGlvbiBDb250ZXh0KHZpZXcsIHBhcmVudENvbnRleHQpIHsKICAgICAgICB0aGlzLnZpZXcgPSB2aWV3LCB0aGlzLmNhY2hlID0gewogICAgICAgICAgIi4iOiB0aGlzLnZpZXcKICAgICAgICB9LCB0aGlzLnBhcmVudCA9IHBhcmVudENvbnRleHQ7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIFdyaXRlcigpIHsKICAgICAgICB0aGlzLmNhY2hlID0ge307CiAgICAgIH0KCiAgICAgIFNjYW5uZXIucHJvdG90eXBlLmVvcyA9IGZ1bmN0aW9uIGVvcygpIHsKICAgICAgICByZXR1cm4gIiIgPT09IHRoaXMudGFpbDsKICAgICAgfSwgU2Nhbm5lci5wcm90b3R5cGUuc2NhbiA9IGZ1bmN0aW9uIHNjYW4ocmUpIHsKICAgICAgICB2YXIgbWF0Y2ggPSB0aGlzLnRhaWwubWF0Y2gocmUpOwogICAgICAgIGlmICghbWF0Y2ggfHwgMCAhPT0gbWF0Y2guaW5kZXgpIHJldHVybiAiIjsKICAgICAgICB2YXIgc3RyaW5nID0gbWF0Y2hbMF07CiAgICAgICAgcmV0dXJuIHRoaXMudGFpbCA9IHRoaXMudGFpbC5zdWJzdHJpbmcoc3RyaW5nLmxlbmd0aCksIHRoaXMucG9zICs9IHN0cmluZy5sZW5ndGgsIHN0cmluZzsKICAgICAgfSwgU2Nhbm5lci5wcm90b3R5cGUuc2NhblVudGlsID0gZnVuY3Rpb24gc2NhblVudGlsKHJlKSB7CiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy50YWlsLnNlYXJjaChyZSksCiAgICAgICAgICAgIG1hdGNoOwoKICAgICAgICBzd2l0Y2ggKGluZGV4KSB7CiAgICAgICAgICBjYXNlIC0xOgogICAgICAgICAgICBtYXRjaCA9IHRoaXMudGFpbCwgdGhpcy50YWlsID0gIiI7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgbWF0Y2ggPSAiIjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgbWF0Y2ggPSB0aGlzLnRhaWwuc3Vic3RyaW5nKDAsIGluZGV4KSwgdGhpcy50YWlsID0gdGhpcy50YWlsLnN1YnN0cmluZyhpbmRleCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpcy5wb3MgKz0gbWF0Y2gubGVuZ3RoLCBtYXRjaDsKICAgICAgfSwgQ29udGV4dC5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIHB1c2godmlldykgewogICAgICAgIHJldHVybiBuZXcgQ29udGV4dCh2aWV3LCB0aGlzKTsKICAgICAgfSwgQ29udGV4dC5wcm90b3R5cGUubG9va3VwID0gZnVuY3Rpb24gbG9va3VwKG5hbWUpIHsKICAgICAgICB2YXIgY2FjaGUgPSB0aGlzLmNhY2hlLAogICAgICAgICAgICB2YWx1ZTsKICAgICAgICBpZiAoY2FjaGUuaGFzT3duUHJvcGVydHkobmFtZSkpIHZhbHVlID0gY2FjaGVbbmFtZV07ZWxzZSB7CiAgICAgICAgICBmb3IgKHZhciBjb250ZXh0ID0gdGhpcywgaW50ZXJtZWRpYXRlVmFsdWUsIG5hbWVzLCBpbmRleCwgbG9va3VwSGl0ID0gITE7IGNvbnRleHQ7KSB7CiAgICAgICAgICAgIGlmIChuYW1lLmluZGV4T2YoIi4iKSA+IDApIGZvciAoaW50ZXJtZWRpYXRlVmFsdWUgPSBjb250ZXh0LnZpZXcsIG5hbWVzID0gbmFtZS5zcGxpdCgiLiIpLCBpbmRleCA9IDA7IG51bGwgIT0gaW50ZXJtZWRpYXRlVmFsdWUgJiYgaW5kZXggPCBuYW1lcy5sZW5ndGg7KSB7CiAgICAgICAgICAgICAgaW5kZXggPT09IG5hbWVzLmxlbmd0aCAtIDEgJiYgKGxvb2t1cEhpdCA9IGhhc1Byb3BlcnR5KGludGVybWVkaWF0ZVZhbHVlLCBuYW1lc1tpbmRleF0pIHx8IHByaW1pdGl2ZUhhc093blByb3BlcnR5KGludGVybWVkaWF0ZVZhbHVlLCBuYW1lc1tpbmRleF0pKSwgaW50ZXJtZWRpYXRlVmFsdWUgPSBpbnRlcm1lZGlhdGVWYWx1ZVtuYW1lc1tpbmRleCsrXV07CiAgICAgICAgICAgIH0gZWxzZSBpbnRlcm1lZGlhdGVWYWx1ZSA9IGNvbnRleHQudmlld1tuYW1lXSwgbG9va3VwSGl0ID0gaGFzUHJvcGVydHkoY29udGV4dC52aWV3LCBuYW1lKTsKCiAgICAgICAgICAgIGlmIChsb29rdXBIaXQpIHsKICAgICAgICAgICAgICB2YWx1ZSA9IGludGVybWVkaWF0ZVZhbHVlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb250ZXh0ID0gY29udGV4dC5wYXJlbnQ7CiAgICAgICAgICB9CgogICAgICAgICAgY2FjaGVbbmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGlzRnVuY3Rpb24odmFsdWUpICYmICh2YWx1ZSA9IHZhbHVlLmNhbGwodGhpcy52aWV3KSksIHZhbHVlOwogICAgICB9LCBXcml0ZXIucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiBjbGVhckNhY2hlKCkgewogICAgICAgIHRoaXMuY2FjaGUgPSB7fTsKICAgICAgfSwgV3JpdGVyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlKHRlbXBsYXRlLCB0YWdzKSB7CiAgICAgICAgdmFyIGNhY2hlID0gdGhpcy5jYWNoZSwKICAgICAgICAgICAgY2FjaGVLZXkgPSB0ZW1wbGF0ZSArICI6IiArICh0YWdzIHx8IG11c3RhY2hlLnRhZ3MpLmpvaW4oIjoiKSwKICAgICAgICAgICAgdG9rZW5zID0gY2FjaGVbY2FjaGVLZXldOwogICAgICAgIHJldHVybiBudWxsID09IHRva2VucyAmJiAodG9rZW5zID0gY2FjaGVbY2FjaGVLZXldID0gcGFyc2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgdGFncykpLCB0b2tlbnM7CiAgICAgIH0sIFdyaXRlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscywgdGFncykgewogICAgICAgIHZhciB0b2tlbnMgPSB0aGlzLnBhcnNlKHRlbXBsYXRlLCB0YWdzKSwKICAgICAgICAgICAgY29udGV4dCA9IHZpZXcgaW5zdGFuY2VvZiBDb250ZXh0ID8gdmlldyA6IG5ldyBDb250ZXh0KHZpZXcpOwogICAgICAgIHJldHVybiB0aGlzLnJlbmRlclRva2Vucyh0b2tlbnMsIGNvbnRleHQsIHBhcnRpYWxzLCB0ZW1wbGF0ZSwgdGFncyk7CiAgICAgIH0sIFdyaXRlci5wcm90b3R5cGUucmVuZGVyVG9rZW5zID0gZnVuY3Rpb24gcmVuZGVyVG9rZW5zKHRva2VucywgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUsIHRhZ3MpIHsKICAgICAgICBmb3IgKHZhciBidWZmZXIgPSAiIiwgdG9rZW4sIHN5bWJvbCwgdmFsdWUsIGkgPSAwLCBudW1Ub2tlbnMgPSB0b2tlbnMubGVuZ3RoOyBpIDwgbnVtVG9rZW5zOyArK2kpIHsKICAgICAgICAgIHZhbHVlID0gdm9pZCAwLCAiIyIgPT09IChzeW1ib2wgPSAodG9rZW4gPSB0b2tlbnNbaV0pWzBdKSA/IHZhbHVlID0gdGhpcy5yZW5kZXJTZWN0aW9uKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgb3JpZ2luYWxUZW1wbGF0ZSkgOiAiXiIgPT09IHN5bWJvbCA/IHZhbHVlID0gdGhpcy5yZW5kZXJJbnZlcnRlZCh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpIDogIj4iID09PSBzeW1ib2wgPyB2YWx1ZSA9IHRoaXMucmVuZGVyUGFydGlhbCh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIHRhZ3MpIDogIiYiID09PSBzeW1ib2wgPyB2YWx1ZSA9IHRoaXMudW5lc2NhcGVkVmFsdWUodG9rZW4sIGNvbnRleHQpIDogIm5hbWUiID09PSBzeW1ib2wgPyB2YWx1ZSA9IHRoaXMuZXNjYXBlZFZhbHVlKHRva2VuLCBjb250ZXh0KSA6ICJ0ZXh0IiA9PT0gc3ltYm9sICYmICh2YWx1ZSA9IHRoaXMucmF3VmFsdWUodG9rZW4pKSwgdm9pZCAwICE9PSB2YWx1ZSAmJiAoYnVmZmVyICs9IHZhbHVlKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBidWZmZXI7CiAgICAgIH0sIFdyaXRlci5wcm90b3R5cGUucmVuZGVyU2VjdGlvbiA9IGZ1bmN0aW9uIHJlbmRlclNlY3Rpb24odG9rZW4sIGNvbnRleHQsIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKSB7CiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICAgICAgICBidWZmZXIgPSAiIiwKICAgICAgICAgICAgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7CgogICAgICAgIGZ1bmN0aW9uIHN1YlJlbmRlcih0ZW1wbGF0ZSkgewogICAgICAgICAgcmV0dXJuIHNlbGYucmVuZGVyKHRlbXBsYXRlLCBjb250ZXh0LCBwYXJ0aWFscyk7CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgIGlmIChpc0FycmF5KHZhbHVlKSkgZm9yICh2YXIgaiA9IDAsIHZhbHVlTGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBqIDwgdmFsdWVMZW5ndGg7ICsraikgewogICAgICAgICAgICBidWZmZXIgKz0gdGhpcy5yZW5kZXJUb2tlbnModG9rZW5bNF0sIGNvbnRleHQucHVzaCh2YWx1ZVtqXSksIHBhcnRpYWxzLCBvcmlnaW5hbFRlbXBsYXRlKTsKICAgICAgICAgIH0gZWxzZSBpZiAoIm9iamVjdCIgPT0gX3R5cGVvZjIodmFsdWUpIHx8ICJzdHJpbmciID09IHR5cGVvZiB2YWx1ZSB8fCAibnVtYmVyIiA9PSB0eXBlb2YgdmFsdWUpIGJ1ZmZlciArPSB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dC5wdXNoKHZhbHVlKSwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpO2Vsc2UgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7CiAgICAgICAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2Ygb3JpZ2luYWxUZW1wbGF0ZSkgdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgdXNlIGhpZ2hlci1vcmRlciBzZWN0aW9ucyB3aXRob3V0IHRoZSBvcmlnaW5hbCB0ZW1wbGF0ZSIpOwogICAgICAgICAgICBudWxsICE9ICh2YWx1ZSA9IHZhbHVlLmNhbGwoY29udGV4dC52aWV3LCBvcmlnaW5hbFRlbXBsYXRlLnNsaWNlKHRva2VuWzNdLCB0b2tlbls1XSksIHN1YlJlbmRlcikpICYmIChidWZmZXIgKz0gdmFsdWUpOwogICAgICAgICAgfSBlbHNlIGJ1ZmZlciArPSB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpOwogICAgICAgICAgcmV0dXJuIGJ1ZmZlcjsKICAgICAgICB9CiAgICAgIH0sIFdyaXRlci5wcm90b3R5cGUucmVuZGVySW52ZXJ0ZWQgPSBmdW5jdGlvbiByZW5kZXJJbnZlcnRlZCh0b2tlbiwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpIHsKICAgICAgICB2YXIgdmFsdWUgPSBjb250ZXh0Lmxvb2t1cCh0b2tlblsxXSk7CiAgICAgICAgaWYgKCF2YWx1ZSB8fCBpc0FycmF5KHZhbHVlKSAmJiAwID09PSB2YWx1ZS5sZW5ndGgpIHJldHVybiB0aGlzLnJlbmRlclRva2Vucyh0b2tlbls0XSwgY29udGV4dCwgcGFydGlhbHMsIG9yaWdpbmFsVGVtcGxhdGUpOwogICAgICB9LCBXcml0ZXIucHJvdG90eXBlLnJlbmRlclBhcnRpYWwgPSBmdW5jdGlvbiByZW5kZXJQYXJ0aWFsKHRva2VuLCBjb250ZXh0LCBwYXJ0aWFscywgdGFncykgewogICAgICAgIGlmIChwYXJ0aWFscykgewogICAgICAgICAgdmFyIHZhbHVlID0gaXNGdW5jdGlvbihwYXJ0aWFscykgPyBwYXJ0aWFscyh0b2tlblsxXSkgOiBwYXJ0aWFsc1t0b2tlblsxXV07CiAgICAgICAgICByZXR1cm4gbnVsbCAhPSB2YWx1ZSA/IHRoaXMucmVuZGVyVG9rZW5zKHRoaXMucGFyc2UodmFsdWUsIHRhZ3MpLCBjb250ZXh0LCBwYXJ0aWFscywgdmFsdWUpIDogdm9pZCAwOwogICAgICAgIH0KICAgICAgfSwgV3JpdGVyLnByb3RvdHlwZS51bmVzY2FwZWRWYWx1ZSA9IGZ1bmN0aW9uIHVuZXNjYXBlZFZhbHVlKHRva2VuLCBjb250ZXh0KSB7CiAgICAgICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pOwogICAgICAgIGlmIChudWxsICE9IHZhbHVlKSByZXR1cm4gdmFsdWU7CiAgICAgIH0sIFdyaXRlci5wcm90b3R5cGUuZXNjYXBlZFZhbHVlID0gZnVuY3Rpb24gZXNjYXBlZFZhbHVlKHRva2VuLCBjb250ZXh0KSB7CiAgICAgICAgdmFyIHZhbHVlID0gY29udGV4dC5sb29rdXAodG9rZW5bMV0pOwogICAgICAgIGlmIChudWxsICE9IHZhbHVlKSByZXR1cm4gbXVzdGFjaGUuZXNjYXBlKHZhbHVlKTsKICAgICAgfSwgV3JpdGVyLnByb3RvdHlwZS5yYXdWYWx1ZSA9IGZ1bmN0aW9uIHJhd1ZhbHVlKHRva2VuKSB7CiAgICAgICAgcmV0dXJuIHRva2VuWzFdOwogICAgICB9LCBtdXN0YWNoZS5uYW1lID0gIm11c3RhY2hlLmpzIiwgbXVzdGFjaGUudmVyc2lvbiA9ICIzLjAuMSIsIG11c3RhY2hlLnRhZ3MgPSBbInt7IiwgIn19Il07CiAgICAgIHZhciBkZWZhdWx0V3JpdGVyID0gbmV3IFdyaXRlcigpOwogICAgICByZXR1cm4gbXVzdGFjaGUuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uIGNsZWFyQ2FjaGUoKSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRXcml0ZXIuY2xlYXJDYWNoZSgpOwogICAgICB9LCBtdXN0YWNoZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlKHRlbXBsYXRlLCB0YWdzKSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRXcml0ZXIucGFyc2UodGVtcGxhdGUsIHRhZ3MpOwogICAgICB9LCBtdXN0YWNoZS5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzLCB0YWdzKSB7CiAgICAgICAgaWYgKCJzdHJpbmciICE9IHR5cGVvZiB0ZW1wbGF0ZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0ZW1wbGF0ZSEgVGVtcGxhdGUgc2hvdWxkIGJlIGEgInN0cmluZyIgYnV0ICInICsgdHlwZVN0cih0ZW1wbGF0ZSkgKyAnIiB3YXMgZ2l2ZW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50IGZvciBtdXN0YWNoZSNyZW5kZXIodGVtcGxhdGUsIHZpZXcsIHBhcnRpYWxzKScpOwogICAgICAgIHJldHVybiBkZWZhdWx0V3JpdGVyLnJlbmRlcih0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMsIHRhZ3MpOwogICAgICB9LCBtdXN0YWNoZS50b19odG1sID0gZnVuY3Rpb24gdG9faHRtbCh0ZW1wbGF0ZSwgdmlldywgcGFydGlhbHMsIHNlbmQpIHsKICAgICAgICB2YXIgcmVzdWx0ID0gbXVzdGFjaGUucmVuZGVyKHRlbXBsYXRlLCB2aWV3LCBwYXJ0aWFscyk7CiAgICAgICAgaWYgKCFpc0Z1bmN0aW9uKHNlbmQpKSByZXR1cm4gcmVzdWx0OwogICAgICAgIHNlbmQocmVzdWx0KTsKICAgICAgfSwgbXVzdGFjaGUuZXNjYXBlID0gZXNjYXBlSHRtbCwgbXVzdGFjaGUuU2Nhbm5lciA9IFNjYW5uZXIsIG11c3RhY2hlLkNvbnRleHQgPSBDb250ZXh0LCBtdXN0YWNoZS5Xcml0ZXIgPSBXcml0ZXIsIG11c3RhY2hlOwogICAgfSk7CiAgfSksCiAgICAgIFRlbXBsYXRlID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gVGVtcGxhdGUodGVtcGxhdGVzLCBjb250ZW50cywgb3JkZXIpIHsKICAgICAgdGhpcy50ZW1wbGF0ZXMgPSB0ZW1wbGF0ZXMsIHRoaXMuY29udGVudHMgPSBjb250ZW50cywgdGhpcy5vcmRlciA9IG9yZGVyOwogICAgfQoKICAgIHZhciBfcHJvdG87CgogICAgcmV0dXJuIFRlbXBsYXRlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIoZGF0YSwgY2IpIHsKICAgICAgdmFyIG91dHB1dCA9IG11c3RhY2hlLnJlbmRlcih0aGlzLm1hc3RlclRlbXBsYXRlLCBkYXRhKTsKICAgICAgcmV0dXJuIGNiID8gY2Iob3V0cHV0KSA6IG91dHB1dDsKICAgIH0sIF9jcmVhdGVDbGFzcyhUZW1wbGF0ZSwgW3sKICAgICAga2V5OiAibWFzdGVyVGVtcGxhdGUiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICByZXR1cm4gdGhpcy5vcmRlci5yZWR1Y2UoZnVuY3Rpb24gKGFjYywga2V5KSB7CiAgICAgICAgICB2YXIgc3RyaW5nID0gIiI7CiAgICAgICAgICByZXR1cm4gX3RoaXMuY29udGVudHNba2V5XSAmJiAoc3RyaW5nID0gX3RoaXMudGVtcGxhdGVzW2tleV0gfHwgIiIpLCBhY2MgKyBzdHJpbmc7CiAgICAgICAgfSwgIiIpOwogICAgICB9CiAgICB9XSksIFRlbXBsYXRlOwogIH0oKSwKICAgICAgc3R5bGVzVGVtcGxhdGUgPSAie3sjc2VsZWN0b3JzfX17eyNtZWRpYX19IHt7bWVkaWF9fSB7IHt7L21lZGlhfX17e3NlbGVjdG9yfX0geyB7eyNkZWNsYXJhdGlvbnN9fXt7cHJvcGVydHl9fToge3t7dmFsdWV9fX07e3svZGVjbGFyYXRpb25zfX0gfSB7eyNtZWRpYX19IH0ge3svbWVkaWF9fXt7L3NlbGVjdG9yc319IiwKICAgICAgY29uZGl0aW9uYWxTdHlsZXMgPSAiLnNob3BpZnktYnV5X19tb2RhbCB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG5cbi5pcy1hY3RpdmUgLnNob3BpZnktYnV5X19tb2RhbCB7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgb3BhY2l0eTogMTtcbiAgICBtYXJnaW4tbGVmdDogYXV0bztcbiAgICBtYXJnaW4tcmlnaHQ6IGF1dG87XG4gIH1cbiI7CgogIGZ1bmN0aW9uIGFkZENsYXNzVG9FbGVtZW50KGNsYXNzTmFtZSwgZWxlbWVudCkgewogICAgaWYgKGNsYXNzTmFtZSkgaWYgKGVsZW1lbnQuY2xhc3NMaXN0KSBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtlbHNlIHsKICAgICAgdmFyIGNsYXNzZXM7CiAgICAgIGlmIChlbGVtZW50LmNsYXNzTmFtZS5zcGxpdCgiICIpLmluZGV4T2YoY2xhc3NOYW1lKSA+IC0xKSByZXR1cm47CiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCJjbGFzcyIsICIiLmNvbmNhdChlbGVtZW50LmNsYXNzTmFtZSwgIiAiKS5jb25jYXQoY2xhc3NOYW1lKSk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZW1vdmVDbGFzc0Zyb21FbGVtZW50KGNsYXNzTmFtZSwgZWxlbWVudCkgewogICAgY2xhc3NOYW1lICYmIChlbGVtZW50LmNsYXNzTGlzdCA/IGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpIDogZWxlbWVudC5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgZWxlbWVudC5jbGFzc05hbWUucmVwbGFjZShjbGFzc05hbWUsICIiKSkpOwogIH0KCiAgdmFyIGlmcmFtZVN0eWxlcyA9IHsKICAgIHdpZHRoOiAiMTAwJSIsCiAgICBvdmVyZmxvdzogImhpZGRlbiIsCiAgICBib3JkZXI6ICJub25lIgogIH0sCiAgICAgIGlmcmFtZUF0dHJzID0gewogICAgaG9yaXpvbnRhbHNjcm9sbGluZzogIm5vIiwKICAgIHZlcnRpY2Fsc2Nyb2xsaW5nOiAibm8iLAogICAgYWxsb3dUcmFuc3BhcmVuY3k6ICJ0cnVlIiwKICAgIGZyYW1lQm9yZGVyOiAiMCIsCiAgICBzY3JvbGxpbmc6ICJubyIKICB9LAogICAgICB3ZWJmb250U2NyaXB0ID0gImh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvd2ViZm9udC8xLjYuMTYvd2ViZm9udC5qcyI7CgogIGZ1bmN0aW9uIGlzUHNldWRvU2VsZWN0b3Ioa2V5KSB7CiAgICByZXR1cm4gIjoiID09PSBrZXkuY2hhckF0KDApOwogIH0KCiAgZnVuY3Rpb24gaXNNZWRpYShrZXkpIHsKICAgIHJldHVybiAiQCIgPT09IGtleS5jaGFyQXQoMCk7CiAgfQoKICBmdW5jdGlvbiBpc1ZhbHVlJDEodGVzdCkgewogICAgcmV0dXJuICJzdHJpbmciID09IHR5cGVvZiB0ZXN0IHx8ICJudW1iZXIiID09IHR5cGVvZiB0ZXN0OwogIH0KCiAgZnVuY3Rpb24gcnVsZURlY2xhcmF0aW9ucyhydWxlKSB7CiAgICByZXR1cm4gT2JqZWN0LmtleXMocnVsZSkuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgcmV0dXJuIGlzVmFsdWUkMShydWxlW2tleV0pOwogICAgfSkubWFwKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBwcm9wZXJ0eToga2V5LAogICAgICAgIHZhbHVlOiBydWxlW2tleV0KICAgICAgfTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gc2VsZWN0b3JTdHlsZUdyb3VwKHNlbGVjdG9yLCBzZWxlY3RvckNsYXNzLCBjbGFzc2VzKSB7CiAgICB2YXIgc3R5bGVHcm91cCA9IFtdOwoKICAgIGlmIChzZWxlY3RvciAmJiBzZWxlY3RvckNsYXNzKSB7CiAgICAgIHZhciBmb3JtYXR0ZWRTZWxlY3RvciA9IHNlbGVjdG9yQ2xhc3Muc3BsaXQoIiAiKS5qb2luKCIuIik7CiAgICAgIGlzUHNldWRvU2VsZWN0b3IoZm9ybWF0dGVkU2VsZWN0b3IpIHx8IChmb3JtYXR0ZWRTZWxlY3RvciA9ICIuIi5jb25jYXQoZm9ybWF0dGVkU2VsZWN0b3IpKSwgc3R5bGVHcm91cCA9IE9iamVjdC5rZXlzKHNlbGVjdG9yKS5maWx0ZXIoZnVuY3Rpb24gKGRlY0tleSkgewogICAgICAgIHJldHVybiAhaXNWYWx1ZSQxKHNlbGVjdG9yW2RlY0tleV0pOwogICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgZGVjS2V5KSB7CiAgICAgICAgdmFyIGNsYXNzTmFtZSA9IGNsYXNzZXNbZGVjS2V5XSB8fCBkZWNLZXk7CiAgICAgICAgcmV0dXJuIGFjYy5jb25jYXQoc2VsZWN0b3JTdHlsZUdyb3VwKHNlbGVjdG9yW2RlY0tleV0sIGNsYXNzTmFtZSwgY2xhc3NlcykubWFwKGZ1bmN0aW9uIChncm91cCkgewogICAgICAgICAgdmFyIGdyb3VwU2VsZWN0b3IgPSAiIjsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHNlbGVjdG9yOiBncm91cFNlbGVjdG9yID0gaXNQc2V1ZG9TZWxlY3Rvcihncm91cC5zZWxlY3RvcikgPyAiIi5jb25jYXQoZm9ybWF0dGVkU2VsZWN0b3IpLmNvbmNhdChncm91cC5zZWxlY3RvcikgOiBpc01lZGlhKGRlY0tleSkgPyBmb3JtYXR0ZWRTZWxlY3RvciA6ICIiLmNvbmNhdChmb3JtYXR0ZWRTZWxlY3RvciwgIiAiKS5jb25jYXQoZ3JvdXAuc2VsZWN0b3IpLAogICAgICAgICAgICBkZWNsYXJhdGlvbnM6IGdyb3VwLmRlY2xhcmF0aW9ucywKICAgICAgICAgICAgbWVkaWE6IGlzTWVkaWEoZGVjS2V5KSA/IGRlY0tleSA6IG51bGwKICAgICAgICAgIH07CiAgICAgICAgfSkpOwogICAgICB9LCBbXSk7CiAgICAgIHZhciBkZWNsYXJhdGlvbnMgPSBydWxlRGVjbGFyYXRpb25zKHNlbGVjdG9yKTsKICAgICAgZGVjbGFyYXRpb25zLmxlbmd0aCAmJiBzdHlsZUdyb3VwLnB1c2goewogICAgICAgIHNlbGVjdG9yOiAiIi5jb25jYXQoZm9ybWF0dGVkU2VsZWN0b3IpLAogICAgICAgIGRlY2xhcmF0aW9uczogZGVjbGFyYXRpb25zCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBzdHlsZUdyb3VwOwogIH0KCiAgdmFyIGlmcmFtZSA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIGlmcmFtZShub2RlLCBjb25maWcpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKSwgdGhpcy5wYXJlbnQgPSBub2RlLCB0aGlzLnN0eWxlc2hlZXQgPSBjb25maWcuc3R5bGVzaGVldCwgdGhpcy5jdXN0b21TdHlsZXNIYXNoID0gY29uZmlnLmN1c3RvbVN0eWxlcyB8fCB7fSwgdGhpcy5jbGFzc2VzID0gY29uZmlnLmNsYXNzZXMsIHRoaXMuYnJvd3NlckZlYXR1cmVzID0gY29uZmlnLmJyb3dzZXJGZWF0dXJlcywgdGhpcy5nb29nbGVGb250cyA9IGNvbmZpZy5nb29nbGVGb250cyB8fCBbXSwgdGhpcy5uYW1lID0gY29uZmlnLm5hbWUsIGNvbmZpZy53aWR0aCAmJiB0aGlzLnNldFdpZHRoKGNvbmZpZy53aWR0aCksIE9iamVjdC5rZXlzKGlmcmFtZVN0eWxlcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX3RoaXMuZWwuc3R5bGVba2V5XSA9IGlmcmFtZVN0eWxlc1trZXldOwogICAgICB9KSwgT2JqZWN0LmtleXMoaWZyYW1lQXR0cnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHJldHVybiBfdGhpcy5lbC5zZXRBdHRyaWJ1dGUoa2V5LCBpZnJhbWVBdHRyc1trZXldKTsKICAgICAgfSksIHRoaXMuZWwuc2V0QXR0cmlidXRlKCJuYW1lIiwgY29uZmlnLm5hbWUpLCB0aGlzLnN0eWxlVGFnID0gbnVsbDsKICAgIH0KCiAgICB2YXIgX3Byb3RvID0gaWZyYW1lLnByb3RvdHlwZTsKICAgIHJldHVybiBfcHJvdG8ubG9hZCA9IGZ1bmN0aW9uIGxvYWQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgX3RoaXMyLmVsLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIubG9hZEZvbnRzKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczIuYXBwZW5kU3R5bGVUYWcoKSwgcmVzb2x2ZSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfSwgX3RoaXMyLnBhcmVudC5hcHBlbmRDaGlsZChfdGhpczIuZWwpOwogICAgICB9KTsKICAgIH0sIF9wcm90by5sb2FkRm9udHMgPSBmdW5jdGlvbiBsb2FkRm9udHMoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRoaXMuZ29vZ2xlRm9udHMgJiYgdGhpcy5nb29nbGVGb250cy5sZW5ndGggPyB0aGlzLmxvYWRGb250U2NyaXB0KCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgICByZXR1cm4gd2luZG93LldlYkZvbnQgPyAod2luZG93LldlYkZvbnQubG9hZCh7CiAgICAgICAgICAgIGdvb2dsZTogewogICAgICAgICAgICAgIGZhbWlsaWVzOiBfdGhpczMuZ29vZ2xlRm9udHMKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZm9udGFjdGl2ZTogZnVuY3Rpb24gZm9udGFjdGl2ZSgpIHsKICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBjb250ZXh0OiBfdGhpczMuZWwuY29udGVudFdpbmRvdyB8fCBmcmFtZXNbX3RoaXMzLm5hbWVdCiAgICAgICAgICB9KSwgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpOwogICAgICAgICAgfSwgMWUzKSkgOiByZXNvbHZlKCk7CiAgICAgICAgfSk7CiAgICAgIH0pIDogUHJvbWlzZS5yZXNvbHZlKCEwKTsKICAgIH0sIF9wcm90by5sb2FkRm9udFNjcmlwdCA9IGZ1bmN0aW9uIGxvYWRGb250U2NyaXB0KCkgewogICAgICBpZiAod2luZG93LldlYkZvbnQpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgdmFyIGZvbnRTY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgZm9udFNjcmlwdC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgfSwgZm9udFNjcmlwdC5zcmMgPSB3ZWJmb250U2NyaXB0LCBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGZvbnRTY3JpcHQpLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9LCA1MDApOwogICAgICB9KTsKICAgIH0sIF9wcm90by5zZXRXaWR0aCA9IGZ1bmN0aW9uIHNldFdpZHRoKHdpZHRoKSB7CiAgICAgIHRoaXMucGFyZW50LnN0eWxlWyJtYXgtd2lkdGgiXSA9IHdpZHRoOwogICAgfSwgX3Byb3RvLmFkZENsYXNzID0gZnVuY3Rpb24gYWRkQ2xhc3MoY2xhc3NOYW1lKSB7CiAgICAgIGFkZENsYXNzVG9FbGVtZW50KGNsYXNzTmFtZSwgdGhpcy5wYXJlbnQpOwogICAgfSwgX3Byb3RvLnJlbW92ZUNsYXNzID0gZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKSB7CiAgICAgIHJlbW92ZUNsYXNzRnJvbUVsZW1lbnQoY2xhc3NOYW1lLCB0aGlzLnBhcmVudCk7CiAgICB9LCBfcHJvdG8uc2V0TmFtZSA9IGZ1bmN0aW9uIHNldE5hbWUobmFtZSkgewogICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgibmFtZSIsIG5hbWUpOwogICAgfSwgX3Byb3RvLnVwZGF0ZVN0eWxlcyA9IGZ1bmN0aW9uIHVwZGF0ZVN0eWxlcyhjdXN0b21TdHlsZXMsIGdvb2dsZUZvbnRzKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRoaXMuZ29vZ2xlRm9udHMgPSBnb29nbGVGb250cywgdGhpcy5sb2FkRm9udHMoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuY3VzdG9tU3R5bGVzSGFzaCA9IGN1c3RvbVN0eWxlcywgX3RoaXM0LnN0eWxlVGFnLmlubmVySFRNTCA9IF90aGlzNC5jc3M7CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLmFwcGVuZFN0eWxlVGFnID0gZnVuY3Rpb24gYXBwZW5kU3R5bGVUYWcoKSB7CiAgICAgIHRoaXMuZG9jdW1lbnQuaGVhZCAmJiAodGhpcy5zdHlsZVRhZyA9IHRoaXMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKSwgdGhpcy5zdHlsZVRhZy5zdHlsZVNoZWV0ID8gdGhpcy5zdHlsZVRhZy5zdHlsZVNoZWV0LmNzc1RleHQgPSB0aGlzLmNzcyA6IHRoaXMuc3R5bGVUYWcuYXBwZW5kQ2hpbGQodGhpcy5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmNzcykpLCB0aGlzLmRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQodGhpcy5zdHlsZVRhZykpOwogICAgfSwgX2NyZWF0ZUNsYXNzKGlmcmFtZSwgW3sKICAgICAga2V5OiAid2lkdGgiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuc3R5bGVbIm1heC13aWR0aCJdOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImRvY3VtZW50IiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIGRvYzsKICAgICAgICByZXR1cm4gdGhpcy5lbC5jb250ZW50V2luZG93ICYmIHRoaXMuZWwuY29udGVudFdpbmRvdy5kb2N1bWVudC5ib2R5ID8gZG9jID0gdGhpcy5lbC5jb250ZW50V2luZG93LmRvY3VtZW50IDogdGhpcy5lbC5kb2N1bWVudCAmJiB0aGlzLmVsLmRvY3VtZW50LmJvZHkgPyBkb2MgPSB0aGlzLmVsLmRvY3VtZW50IDogdGhpcy5lbC5jb250ZW50RG9jdW1lbnQgJiYgdGhpcy5lbC5jb250ZW50RG9jdW1lbnQuYm9keSAmJiAoZG9jID0gdGhpcy5lbC5jb250ZW50RG9jdW1lbnQpLCBkb2M7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiY3VzdG9tU3R5bGVzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzNSA9IHRoaXMsCiAgICAgICAgICAgIGN1c3RvbVN0eWxlcyA9IFtdOwoKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5jdXN0b21TdHlsZXNIYXNoKS5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlS2V5KSB7CiAgICAgICAgICBfdGhpczUuY3VzdG9tU3R5bGVzSGFzaFt0eXBlS2V5XSAmJiBPYmplY3Qua2V5cyhfdGhpczUuY3VzdG9tU3R5bGVzSGFzaFt0eXBlS2V5XSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICAgIHZhciBzdHlsZUdyb3VwID0gc2VsZWN0b3JTdHlsZUdyb3VwKF90aGlzNS5jdXN0b21TdHlsZXNIYXNoW3R5cGVLZXldW2tleV0sIF90aGlzNS5jbGFzc2VzW3R5cGVLZXldW2tleV0sIF90aGlzNS5jbGFzc2VzW3R5cGVLZXldKTsKICAgICAgICAgICAgY3VzdG9tU3R5bGVzID0gY3VzdG9tU3R5bGVzLmNvbmNhdChzdHlsZUdyb3VwKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pLCBjdXN0b21TdHlsZXM7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiY29uZGl0aW9uYWxDU1MiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5icm93c2VyRmVhdHVyZXMudHJhbnNpdGlvbiAmJiB0aGlzLmJyb3dzZXJGZWF0dXJlcy50cmFuc2Zvcm0gJiYgdGhpcy5icm93c2VyRmVhdHVyZXMuYW5pbWF0aW9uID8gIiIgOiBjb25kaXRpb25hbFN0eWxlczsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjc3MiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgY29tcGlsZWQgPSBtdXN0YWNoZS5yZW5kZXIoc3R5bGVzVGVtcGxhdGUsIHsKICAgICAgICAgIHNlbGVjdG9yczogdGhpcy5jdXN0b21TdHlsZXMKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KHRoaXMuc3R5bGVzaGVldCwgIiBcbiAiKS5jb25jYXQoY29tcGlsZWQsICIgXG4gIikuY29uY2F0KHRoaXMuY29uZGl0aW9uYWxDU1MpOwogICAgICB9CiAgICB9XSksIGlmcmFtZTsKICB9KCksCiAgICAgIHN0eWxlcyA9IHsKICAgIGNhcnQ6ICdodG1sLCBib2R5LCBoMSwgaDIsIGgzLCBoNCwgaDUsIHAgeyAgIHBhZGRpbmc6IDA7ICAgbWFyZ2luOiAwOyB9ICogeyAgIC13ZWJraXQtYm94LXNpemluZzogYm9yZGVyLWJveDsgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IH0gYm9keSwgaHRtbCB7ICAgbWluLWhlaWdodDogMTAwJTsgfSBodG1sIHsgICBmb250LWZhbWlseTogIkhlbHZldGljYSBOZXVlIiwgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsgICBmb250LXNpemU6IDE0cHg7ICAgbGluZS1oZWlnaHQ6IDEuMjsgICBjb2xvcjogIzRjNGM0YzsgICB0ZXh0LXJlbmRlcmluZzogb3B0aW1pemVMZWdpYmlsaXR5OyAgIC13ZWJraXQtZm9udC1zbW9vdGhpbmc6IGFudGlhbGlhc2VkOyAgIC1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7IH0gc2VsZWN0IHsgICB0ZXh0LXJlbmRlcmluZzogYXV0byAhaW1wb3J0YW50OyB9IHVsIHsgICBsaXN0LXN0eWxlOiBub25lOyAgIHBhZGRpbmctbGVmdDogMDsgICBtYXJnaW46IDA7IH0gaW1nIHsgICBkaXNwbGF5OiBibG9jazsgICBtYXgtd2lkdGg6IDEwMCU7IH0gaW5wdXQgeyAgIC13ZWJraXQtYXBwZWFyYW5jZTogdGV4dGZpZWxkOyAgIG1hcmdpbjogMDsgfSAuY2xlYXJmaXg6YWZ0ZXIgeyAgICAgY29udGVudDogIiI7ICAgICBkaXNwbGF5OiB0YWJsZTsgICAgIGNsZWFyOiBib3RoOyAgIH0gLnZpc3VhbGx5aGlkZGVuIHsgICBib3JkZXI6IDA7ICAgaGVpZ2h0OiAxcHg7ICAgbWFyZ2luOiAtMXB4OyAgIG92ZXJmbG93OiBoaWRkZW47ICAgcGFkZGluZzogMDsgICBwb3NpdGlvbjogYWJzb2x1dGU7ICAgd2lkdGg6IDFweDsgfSAuY29tcG9uZW50LWNvbnRhaW5lciB7ICAgb3ZlcmZsb3c6IGhpZGRlbjsgfSAuc2hvcGlmeS1idXlfX3R5cGUtLWNlbnRlciB7ICAgdGV4dC1hbGlnbjogY2VudGVyOyB9IC5zaG9waWZ5LWJ1eS0tdmlzdWFsbHktaGlkZGVuIHsgICBwb3NpdGlvbjogYWJzb2x1dGUgIWltcG9ydGFudDsgICBjbGlwOiByZWN0KDFweCwgMXB4LCAxcHgsIDFweCk7ICAgcGFkZGluZzowICFpbXBvcnRhbnQ7ICAgYm9yZGVyOjAgIWltcG9ydGFudDsgICBoZWlnaHQ6IDFweCAhaW1wb3J0YW50OyAgIHdpZHRoOiAxcHggIWltcG9ydGFudDsgICBvdmVyZmxvdzogaGlkZGVuOyB9IC5zaG9waWZ5LWJ1eV9fYnRuIHsgICBjb2xvcjogI2ZmZjsgICBmb250LXNpemU6IDE1cHg7ICAgYmFja2dyb3VuZC1jb2xvcjogIzc4YjY1NzsgICBwYWRkaW5nOiAxMnB4IDQwcHg7ICAgbGV0dGVyLXNwYWNpbmc6IC4zcHg7ICAgZGlzcGxheTogYmxvY2s7ICAgYm9yZGVyLXJhZGl1czogM3B4OyAgIGN1cnNvcjogcG9pbnRlcjsgICAtd2Via2l0LXRyYW5zaXRpb246IGJhY2tncm91bmQgMjAwbXMgZWFzZTsgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDIwMG1zIGVhc2U7ICAgbWF4LXdpZHRoOiAxMDAlOyAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyAgIG92ZXJmbG93OiBoaWRkZW47ICAgbGluZS1oZWlnaHQ6IDEuMjsgICBib3JkZXI6IDA7ICAgLW1vei1hcHBlYXJhbmNlOiBub25lOyAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZSB9IC5zaG9waWZ5LWJ1eV9fYnRuOmhvdmVyLCAgIC5zaG9waWZ5LWJ1eV9fYnRuOmZvY3VzIHsgICAgIGJhY2tncm91bmQtY29sb3I6ICM1ZjlkM2U7ICAgfSAuc2hvcGlmeS1idXlfX2J0bi0tcGFyZW50IHsgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgICBib3JkZXI6IDA7ICAgcGFkZGluZzogMDsgICBjdXJzb3I6IHBvaW50ZXIgfSAuc2hvcGlmeS1idXlfX2J0bi0tcGFyZW50OmhvdmVyIC5wcm9kdWN0X192YXJpYW50LWltZywgLnNob3BpZnktYnV5X19idG4tLXBhcmVudDpmb2N1cyAucHJvZHVjdF9fdmFyaWFudC1pbWcgeyAgICAgICBvcGFjaXR5OiAuNzsgICAgIH0gLnNob3BpZnktYnV5X19idG4tLWNhcnQtdGFiIHsgICBwYWRkaW5nOiA1cHggMTFweDsgICBib3JkZXItcmFkaXVzOiAzcHggMCAwIDNweDsgICBwb3NpdGlvbjogZml4ZWQ7ICAgcmlnaHQ6IDA7ICAgdG9wOiA1MCU7ICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZSgxMDAlLCAtNTAlKTsgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDEwMCUsIC01MCUpOyAgIG9wYWNpdHk6IDA7ICAgbWluLXdpZHRoOiBpbmhlcml0OyAgIHdpZHRoOiBhdXRvOyAgIGhlaWdodDogYXV0bzsgICB6LWluZGV4OiAyMTQ3NDgzNjQ3IH0gLnNob3BpZnktYnV5X19idG4tLWNhcnQtdGFiLmlzLWFjdGl2ZSB7ICAgICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsgICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyAgICAgb3BhY2l0eTogMTsgICB9IC5zaG9waWZ5LWJ1eV9fYnRuX19jb3VudGVyIHsgICBkaXNwbGF5OiBibG9jazsgICBtYXJnaW46IDAgYXV0byAxMHB4IGF1dG87ICAgZm9udC1zaXplOiAxOHB4OyB9IC5zaG9waWZ5LWJ1eV9faWNvbi1jYXJ0LS1zaWRlIHsgICBoZWlnaHQ6IDIwcHg7ICAgd2lkdGg6IDIwcHg7IH0gLnNob3BpZnktYnV5X19idG5bZGlzYWJsZWRdIHsgICBiYWNrZ3JvdW5kLWNvbG9yOiAjOTk5OyAgIHBvaW50ZXItZXZlbnRzOiBub25lOyB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1jbG9zZSB7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHJpZ2h0OiA5cHg7ICAgdG9wOiA4cHg7ICAgZm9udC1zaXplOiAzNXB4OyAgIGNvbG9yOiAjNzY3Njc2OyAgIGJvcmRlcjogbm9uZTsgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgICAtd2Via2l0LXRyYW5zaXRpb246IGNvbG9yIDEwMG1zIGVhc2UsIC13ZWJraXQtdHJhbnNmb3JtIDEwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogY29sb3IgMTAwbXMgZWFzZSwgLXdlYmtpdC10cmFuc2Zvcm0gMTAwbXMgZWFzZTsgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMTAwbXMgZWFzZSwgY29sb3IgMTAwbXMgZWFzZTsgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMTAwbXMgZWFzZSwgY29sb3IgMTAwbXMgZWFzZSwgLXdlYmtpdC10cmFuc2Zvcm0gMTAwbXMgZWFzZTsgICBjdXJzb3I6IHBvaW50ZXI7ICAgZm9udC1mYW1pbHk6ICJIZWx2ZXRpY2EgTmV1ZSIsIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7ICAgcGFkZGluZy1yaWdodDogOXB4IH0gLnNob3BpZnktYnV5X19idG4tLWNsb3NlOmhvdmVyIHsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiBzY2FsZSgxLjIpOyAgICAgICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMik7ICAgICBjb2xvcjogaHNsKDAsIDAlLCA0MS4yNzQ1MDk4MDM5JSk7ICAgfSBALXdlYmtpdC1rZXlmcmFtZXMgZmxpcEluIHsgICBmcm9tIHsgICAgIG1heC1oZWlnaHQ6IDA7ICAgICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRleCg5MGRlZykgdHJhbnNsYXRleSgtNTAlKTsgICAgICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGV4KDkwZGVnKSB0cmFuc2xhdGV5KC01MCUpOyAgICAgbWFyZ2luLWJvdHRvbTogLTY1cHg7ICAgICBvcGFjaXR5OiAwOyAgIH0gICAgdG8geyAgICAgbWF4LWhlaWdodDogbm9uZTsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiBub25lOyAgICAgICAgICAgICB0cmFuc2Zvcm06IG5vbmU7ICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OyAgICAgb3BhY2l0eTogMTsgICB9IH0gQGtleWZyYW1lcyBmbGlwSW4geyAgIGZyb20geyAgICAgbWF4LWhlaWdodDogMDsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGV4KDkwZGVnKSB0cmFuc2xhdGV5KC01MCUpOyAgICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZXgoOTBkZWcpIHRyYW5zbGF0ZXkoLTUwJSk7ICAgICBtYXJnaW4tYm90dG9tOiAtNjVweDsgICAgIG9wYWNpdHk6IDA7ICAgfSAgICB0byB7ICAgICBtYXgtaGVpZ2h0OiBub25lOyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IG5vbmU7ICAgICAgICAgICAgIHRyYW5zZm9ybTogbm9uZTsgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7ICAgICBvcGFjaXR5OiAxOyAgIH0gfSBALXdlYmtpdC1rZXlmcmFtZXMgZmxpcE91dCB7ICAgZnJvbSB7ICAgICBtYXgtaGVpZ2h0OiBub25lOyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IG5vbmU7ICAgICAgICAgICAgIHRyYW5zZm9ybTogbm9uZTsgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7ICAgICBvcGFjaXR5OiAxOyAgIH0gICAgdG8geyAgICAgbWF4LWhlaWdodDogMDsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGV4KDkwZGVnKSB0cmFuc2xhdGV5KC01MCUpOyAgICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZXgoOTBkZWcpIHRyYW5zbGF0ZXkoLTUwJSk7ICAgICBtYXJnaW4tYm90dG9tOiAtNjVweDsgICAgIG9wYWNpdHk6IDA7ICAgfSB9IEBrZXlmcmFtZXMgZmxpcE91dCB7ICAgZnJvbSB7ICAgICBtYXgtaGVpZ2h0OiBub25lOyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IG5vbmU7ICAgICAgICAgICAgIHRyYW5zZm9ybTogbm9uZTsgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7ICAgICBvcGFjaXR5OiAxOyAgIH0gICAgdG8geyAgICAgbWF4LWhlaWdodDogMDsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGV4KDkwZGVnKSB0cmFuc2xhdGV5KC01MCUpOyAgICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZXgoOTBkZWcpIHRyYW5zbGF0ZXkoLTUwJSk7ICAgICBtYXJnaW4tYm90dG9tOiAtNjVweDsgICAgIG9wYWNpdHk6IDA7ICAgfSB9IC5zaG9waWZ5LWJ1eV9fY2FydC13cmFwcGVyIHsgICBoZWlnaHQ6IDEwMCU7ICAgcGFkZGluZy1sZWZ0OiAxMHB4OyB9IC5zaG9waWZ5LWJ1eV9fY2FydCB7ICAgaGVpZ2h0OiAxMDAlOyAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7ICAgd2lkdGg6IGNhbGMoMTAwJSAtIDEwcHgpOyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICByaWdodDogMDsgICAtd2Via2l0LWJveC1zaGFkb3c6IC01cHggMCA1cHggcmdiYSgwLCAwLCAwLCAwLjEpOyAgICAgICAgICAgYm94LXNoYWRvdzogLTVweCAwIDVweCByZ2JhKDAsIDAsIDAsIDAuMSk7IH0gLnNob3BpZnktYnV5X19jYXJ0X19oZWFkZXIgeyAgIHBhZGRpbmc6IDIwcHg7ICAgcGFkZGluZy1yaWdodDogNDBweDsgICBwb3NpdGlvbjogcmVsYXRpdmU7ICAgei1pbmRleDogMjE0NzQ4MzY0NzsgICBiYWNrZ3JvdW5kLWNvbG9yOiBpbmhlcml0OyB9IC5zaG9waWZ5LWJ1eV9fY2FydF9fdGl0bGUgeyAgIGZvbnQtc2l6ZTogMThweDsgICBjb2xvcjogIzc2NzY3NjsgICBmb250LXdlaWdodDogbm9ybWFsOyAgIG92ZXJmbG93OiBoaWRkZW47ICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7IH0gLnNob3BpZnktYnV5X19jYXJ0LXNjcm9sbCB7ICAgcGFkZGluZzogNzBweCAwIDEzNXB4IDA7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHRvcDogMDsgICBoZWlnaHQ6IDEwMCU7ICAgd2lkdGg6IDEwMCU7IH0gLnNob3BpZnktYnV5X19jYXJ0LXNjcm9sbC0tZGlzY291bnRzIHsgICBwYWRkaW5nLWJvdHRvbTogMTcwcHg7IH0gLnNob3BpZnktYnV5X19jYXJ0LXNjcm9sbC0tY2FydC1ub3RlIHsgICBwYWRkaW5nLWJvdHRvbTogMjAwcHg7IH0gLnNob3BpZnktYnV5X19jYXJ0LXNjcm9sbC0tY2FydC1ub3RlLnNob3BpZnktYnV5X19jYXJ0LXNjcm9sbC0tZGlzY291bnRzIHsgICBwYWRkaW5nLWJvdHRvbTogMjMwcHg7IH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW1zIHsgICBvdmVyZmxvdzogaGlkZGVuOyAgIG92ZXJmbG93LXk6IGF1dG87ICAgaGVpZ2h0OiAxMDAlOyAgIHBvc2l0aW9uOiByZWxhdGl2ZTsgICBwYWRkaW5nOiAwIDIwcHggMjBweDsgICAtd2Via2l0LW92ZXJmbG93LXNjcm9sbGluZzogdG91Y2g7ICAgLXdlYmtpdC1wZXJzcGVjdGl2ZTogNDAwcHg7ICAgICAgICAgICBwZXJzcGVjdGl2ZTogNDAwcHg7ICAgLXdlYmtpdC1wZXJzcGVjdGl2ZS1vcmlnaW46IDUwJSAwcHg7ICAgICAgICAgICBwZXJzcGVjdGl2ZS1vcmlnaW46IDUwJSAwcHg7IH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW0geyAgIG1pbi1oZWlnaHQ6IDY1cHg7ICAgbWFyZ2luLWJvdHRvbTogMjBweDsgICBvdmVyZmxvdzogaGlkZGVuOyAgIHBvc2l0aW9uOiByZWxhdGl2ZTsgICAtd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6IHZpc2libGU7ICAgICAgICAgICBiYWNrZmFjZS12aXNpYmlsaXR5OiB2aXNpYmxlOyAgIC13ZWJraXQtYW5pbWF0aW9uOiAyMDBtcyBmbGlwSW4gZm9yd2FyZHM7ICAgICAgICAgICBhbmltYXRpb246IDIwMG1zIGZsaXBJbiBmb3J3YXJkczsgfSAuc2hvcGlmeS1idXlfX2NhcnQtaXRlbS5pcy1oaWRkZW4geyAgIC13ZWJraXQtYW5pbWF0aW9uLW5hbWU6IGZsaXBPdXQ7ICAgICAgICAgICBhbmltYXRpb24tbmFtZTogZmxpcE91dDsgfSAuc2hvcGlmeS1idXlfX2NhcnQtaXRlbV9faW1hZ2UgeyAgIHdpZHRoOiA2NXB4OyAgIGhlaWdodDogNjVweDsgICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47ICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXIgY2VudGVyOyAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICBsZWZ0OiAwOyAgIHRvcDogMDsgfSAuc2hvcGlmeS1idXlfX2NhcnQtaXRlbV9fdGl0bGUgeyAgIGZvbnQtc2l6ZTogMTRweDsgICBtYXJnaW4tbGVmdDogODBweDsgICBtYXJnaW4tYm90dG9tOiAzcHg7ICAgZGlzcGxheTogYmxvY2s7IH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3ByaWNlIHsgICBmbG9hdDogcmlnaHQ7ICAgZm9udC1zaXplOiAxNHB4OyAgIGZvbnQtd2VpZ2h0OiBib2xkOyAgIGxpbmUtaGVpZ2h0OiAyNnB4OyB9IC5zaG9waWZ5LWJ1eV9fY2FydC1pdGVtX19wcmljZS1hbmQtZGlzY291bnRzIHsgICBmbG9hdDogcmlnaHQ7ICAgdGV4dC1hbGlnbjogcmlnaHQ7ICAgbWF4LXdpZHRoOiAxMDBweCB9IC5zaG9waWZ5LWJ1eV9fY2FydC1pdGVtX19wcmljZS1hbmQtZGlzY291bnRzIC5zaG9waWZ5LWJ1eV9fY2FydC1pdGVtX19wcmljZSB7ICAgICBmbG9hdDogbm9uZTsgICB9IC5zaG9waWZ5LWJ1eV9fY2FydC1pdGVtX19mdWxsLXByaWNlIHsgICBmb250LXNpemU6IDEycHg7ICAgbGluZS1oZWlnaHQ6IDEycHg7IH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX2Rpc2NvdW50IHsgICBmb250LXNpemU6IDEycHg7ICAgd29yZC13cmFwOiBicmVhay13b3JkOyAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2UgfSAuc2hvcGlmeS1idXlfX2NhcnQtaXRlbV9fZGlzY291bnQgKyAuc2hvcGlmeS1idXlfX2NhcnQtaXRlbV9fZGlzY291bnQgeyAgICAgbWFyZ2luLXRvcDogNXB4OyAgIH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX2Rpc2NvdW50X19pY29uIHsgICB3aWR0aDogMTJweDsgICBoZWlnaHQ6IDEycHg7ICAgdmVydGljYWwtYWxpZ246IHRvcDsgICBmaWxsOiBjdXJyZW50Q29sb3I7IH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3ZhcmlhbnQtdGl0bGUgeyAgIG1hcmdpbi1sZWZ0OiA4MHB4OyAgIG1hcmdpbi1ib3R0b206IDEwcHg7ICAgY29sb3I6ICM0YzRjNGM7ICAgZm9udC1zaXplOiAxMnB4OyAgIG1heC13aWR0aDogMjIwcHg7ICAgb3ZlcmZsb3c6IGhpZGRlbjsgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgfSAuc2hvcGlmeS1idXlfX2NhcnQtYm90dG9tIHsgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICB3aWR0aDogMTAwJTsgICBib3R0b206IDA7ICAgcGFkZGluZzogMTVweCAyMHB4IDIwcHggMjBweDsgfSAuc2hvcGlmeS1idXlfX2NhcnRfX3N1YnRvdGFsX190ZXh0IHsgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOyAgIGZsb2F0OiBsZWZ0OyAgIGZvbnQtc2l6ZTogMTFweDsgICBjb2xvcjogIzRjNGM0YzsgfSAuc2hvcGlmeS1idXlfX2NhcnRfX3N1YnRvdGFsX19wcmljZSB7ICAgZmxvYXQ6IHJpZ2h0OyB9IC5zaG9waWZ5LWJ1eV9fY2FydF9fZGlzY291bnQgeyAgIGRpc3BsYXk6IC13ZWJraXQtYm94OyAgIGRpc3BsYXk6IC13ZWJraXQtZmxleDsgICBkaXNwbGF5OiAtbXMtZmxleGJveDsgICBkaXNwbGF5OiBmbGV4OyAgIG1hcmdpbi1ib3R0b206IDEwcHg7ICAgY29sb3I6ICM0YzRjNGM7IH0gLnNob3BpZnktYnV5X19jYXJ0X19kaXNjb3VudF9fdGV4dCB7ICAgZm9udC1zaXplOiAxMXB4OyAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7ICAgbWFyZ2luLXJpZ2h0OiAxMHB4OyAgIC13ZWJraXQtYm94LWZsZXg6IDE7ICAgLXdlYmtpdC1mbGV4LWdyb3c6IDE7ICAgICAgIC1tcy1mbGV4LXBvc2l0aXZlOiAxOyAgICAgICAgICAgZmxleC1ncm93OiAxOyB9IC5zaG9waWZ5LWJ1eV9fY2FydF9fZGlzY291bnRfX3RleHRfX2ljb24geyAgIHdpZHRoOiAxMXB4OyAgIGhlaWdodDogMTFweDsgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOyAgIGZpbGw6IGN1cnJlbnRDb2xvcjsgfSAuc2hvcGlmeS1idXlfX2NhcnRfX2Rpc2NvdW50X19hbW91bnQgeyAgIGZvbnQtc2l6ZTogMTJweDsgICBsaW5lLWhlaWdodDogMTJweDsgICAtd2Via2l0LWZsZXgtc2hyaW5rOiAwOyAgICAgICAtbXMtZmxleC1uZWdhdGl2ZTogMDsgICAgICAgICAgIGZsZXgtc2hyaW5rOiAwOyB9IC5zaG9waWZ5LWJ1eV9fY2FydF9fY3VycmVuY3kgeyAgIGZvbnQtc2l6ZTogMTJweDsgfSAuc2hvcGlmeS1idXlfX2NhcnRfX25vdGljZSB7ICAgZm9udC1zaXplOiAxMXB4OyAgIGNsZWFyOiBib3RoOyAgIHBhZGRpbmctdG9wOiAxMHB4OyAgIHRleHQtYWxpZ246IGNlbnRlcjsgICBjb2xvcjogIzRjNGM0YzsgfSAuc2hvcGlmeS1idXlfX2NhcnRfX25vdGUgeyAgIGNsZWFyOiBib3RoOyAgIHBhZGRpbmctdG9wOiAxMHB4OyB9IC5zaG9waWZ5LWJ1eV9fY2FydF9fbm90ZV9fZGVzY3JpcHRpb24geyAgIGZvbnQtc2l6ZTogMTFweDsgICBjb2xvcjogIzRjNGM0YzsgfSAuc2hvcGlmeS1idXlfX2NhcnRfX25vdGVfX3RleHQtYXJlYSB7ICAgcmVzaXplOiBub25lOyAgIGZvbnQtc2l6ZTogMTFweDsgICB3aWR0aDogMTAwJTsgICBjb2xvcjogIzRjNGM0YzsgfSAuc2hvcGlmeS1idXlfX2NhcnQtZW1wdHktdGV4dCB7ICAgcGFkZGluZzogMTBweCAxNXB4OyAgIHRleHQtYWxpZ246IGNlbnRlcjsgfSAuc2hvcGlmeS1idXlfX2J0bi0tY2FydC1jaGVja291dCB7ICAgY2xlYXI6IGJvdGg7ICAgbWFyZ2luLXRvcDogMTVweDsgICB3aWR0aDogMTAwJTsgICBwYWRkaW5nOiAxMHB4IDVweDsgICBmb250LXNpemU6IDE2cHg7IH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIgeyAgIG1hcmdpbi1sZWZ0OiA4MHB4OyAgIG1hcmdpbi1yaWdodDogMTAwcHg7ICAgaGVpZ2h0OiAyNnB4OyAgIGxpbmUtaGVpZ2h0OiAyNnB4OyB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLmlzLWxvYWRpbmcgeyAgIG9wYWNpdHk6IDAuNjU7ICAgcG9pbnRlci1ldmVudHM6IG5vbmU7IH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3F1YW50aXR5LWlucHV0IHsgICBmbG9hdDogbGVmdDsgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgfSBAbWVkaWEgKG1heC13aWR0aDogMzMwcHgpIHsgICAuc2hvcGlmeS1idXlfX2NhcnQtaXRlbV9fcHJpY2UtYW5kLWRpc2NvdW50cyB7ICAgICBtYXgtd2lkdGg6IDkwcHg7ICAgfSAgICAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lciB7ICAgICBtYXJnaW4tcmlnaHQ6IDkwcHg7ICAgfSB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktZGVjcmVtZW50LCAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWluY3JlbWVudCB7ICAgY29sb3I6ICM0YzRjNGM7ICAgZGlzcGxheTogYmxvY2s7ICAgaGVpZ2h0OiAzMHB4OyAgIGZsb2F0OiBsZWZ0OyAgIGxpbmUtaGVpZ2h0OiAxNnB4OyAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7ICAgd2lkdGg6IDI2cHg7ICAgcGFkZGluZzogMDsgICBib3JkZXI6IG5vbmU7ICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7ICAgLXdlYmtpdC1ib3gtc2hhZG93OiBub25lOyAgICAgICAgICAgYm94LXNoYWRvdzogbm9uZTsgICBjdXJzb3I6IHBvaW50ZXI7ICAgZm9udC1zaXplOiAxOHB4OyAgIHRleHQtYWxpZ246IGNlbnRlcjsgICBmb250LWZhbWlseTogIkhlbHZldGljYSBOZXVlIiwgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsgICBib3JkZXI6IDFweCBzb2xpZCAjNzY3Njc2OyAgIHBvc2l0aW9uOiByZWxhdGl2ZSB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktZGVjcmVtZW50IHN2ZywgLnNob3BpZnktYnV5X19xdWFudGl0eS1pbmNyZW1lbnQgc3ZnIHsgICAgIHdpZHRoOiAxNHB4OyAgICAgaGVpZ2h0OiAxNHB4OyAgICAgcG9zaXRpb246IGFic29sdXRlOyAgICAgdG9wOiA1MCU7ICAgICBsZWZ0OiA1MCU7ICAgICBtYXJnaW4tdG9wOiAtNnB4OyAgICAgbWFyZ2luLWxlZnQ6IC03cHg7ICAgICBmaWxsOiBjdXJyZW50Q29sb3I7ICAgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWRlY3JlbWVudCB7ICAgYm9yZGVyLXJhZGl1czogM3B4IDAgMCAzcHg7IH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1pbmNyZW1lbnQgeyAgIGJvcmRlci1yYWRpdXM6IDAgM3B4IDNweCAwOyB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHkgeyAgIGNvbG9yOiBibGFjazsgICB3aWR0aDogNDVweDsgICBoZWlnaHQ6IDMwcHg7ICAgZm9udC1zaXplOiAxNnB4OyAgIGJvcmRlcjogbm9uZTsgICB0ZXh0LWFsaWduOiBjZW50ZXI7ICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOyAgIC1tb3otYXBwZWFyYW5jZTogdGV4dGZpZWxkOyAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICBwYWRkaW5nOiAwOyAgIGJvcmRlci1yYWRpdXM6IDA7ICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICM3Njc2NzY7ICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICM3Njc2NzY7IH0gaW5wdXRbdHlwZT1udW1iZXJdOjotd2Via2l0LWlubmVyLXNwaW4tYnV0dG9uLCBpbnB1dFt0eXBlPW51bWJlcl06Oi13ZWJraXQtb3V0ZXItc3Bpbi1idXR0b24geyAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsgICBtYXJnaW46IDA7IH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIuc2hvcGlmeS1idXlfX3F1YW50aXR5LXdpdGgtYnRucyB7ICAgb3ZlcmZsb3c6IGhpZGRlbiB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLnNob3BpZnktYnV5X19xdWFudGl0eS13aXRoLWJ0bnMgLnNob3BpZnktYnV5X19xdWFudGl0eSB7ICAgICBib3JkZXItbGVmdDogMDsgICAgIGJvcmRlci1yaWdodDogMDsgICAgIGZsb2F0OiBsZWZ0OyAgIH0gJywKICAgIG1vZGFsOiAnaHRtbCwgYm9keSwgaDEsIGgyLCBoMywgaDQsIGg1LCBwIHsgICBwYWRkaW5nOiAwOyAgIG1hcmdpbjogMDsgfSAqIHsgICAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7ICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OyB9IGJvZHksIGh0bWwgeyAgIG1pbi1oZWlnaHQ6IDEwMCU7IH0gaHRtbCB7ICAgZm9udC1mYW1pbHk6ICJIZWx2ZXRpY2EgTmV1ZSIsIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7ICAgZm9udC1zaXplOiAxNHB4OyAgIGxpbmUtaGVpZ2h0OiAxLjI7ICAgY29sb3I6ICM0YzRjNGM7ICAgdGV4dC1yZW5kZXJpbmc6IG9wdGltaXplTGVnaWJpbGl0eTsgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsgICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlOyB9IHNlbGVjdCB7ICAgdGV4dC1yZW5kZXJpbmc6IGF1dG8gIWltcG9ydGFudDsgfSB1bCB7ICAgbGlzdC1zdHlsZTogbm9uZTsgICBwYWRkaW5nLWxlZnQ6IDA7ICAgbWFyZ2luOiAwOyB9IGltZyB7ICAgZGlzcGxheTogYmxvY2s7ICAgbWF4LXdpZHRoOiAxMDAlOyB9IGlucHV0IHsgICAtd2Via2l0LWFwcGVhcmFuY2U6IHRleHRmaWVsZDsgICBtYXJnaW46IDA7IH0gLmNsZWFyZml4OmFmdGVyIHsgICAgIGNvbnRlbnQ6ICIiOyAgICAgZGlzcGxheTogdGFibGU7ICAgICBjbGVhcjogYm90aDsgICB9IC52aXN1YWxseWhpZGRlbiB7ICAgYm9yZGVyOiAwOyAgIGhlaWdodDogMXB4OyAgIG1hcmdpbjogLTFweDsgICBvdmVyZmxvdzogaGlkZGVuOyAgIHBhZGRpbmc6IDA7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHdpZHRoOiAxcHg7IH0gLmNvbXBvbmVudC1jb250YWluZXIgeyAgIG92ZXJmbG93OiBoaWRkZW47IH0gLnNob3BpZnktYnV5X190eXBlLS1jZW50ZXIgeyAgIHRleHQtYWxpZ246IGNlbnRlcjsgfSAuc2hvcGlmeS1idXktLXZpc3VhbGx5LWhpZGRlbiB7ICAgcG9zaXRpb246IGFic29sdXRlICFpbXBvcnRhbnQ7ICAgY2xpcDogcmVjdCgxcHgsIDFweCwgMXB4LCAxcHgpOyAgIHBhZGRpbmc6MCAhaW1wb3J0YW50OyAgIGJvcmRlcjowICFpbXBvcnRhbnQ7ICAgaGVpZ2h0OiAxcHggIWltcG9ydGFudDsgICB3aWR0aDogMXB4ICFpbXBvcnRhbnQ7ICAgb3ZlcmZsb3c6IGhpZGRlbjsgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWRlY3JlbWVudCwgLnNob3BpZnktYnV5X19xdWFudGl0eS1pbmNyZW1lbnQgeyAgIGNvbG9yOiAjNGM0YzRjOyAgIGRpc3BsYXk6IGJsb2NrOyAgIGhlaWdodDogMzBweDsgICBmbG9hdDogbGVmdDsgICBsaW5lLWhlaWdodDogMTZweDsgICBmb250LWZhbWlseTogbW9ub3NwYWNlOyAgIHdpZHRoOiAyNnB4OyAgIHBhZGRpbmc6IDA7ICAgYm9yZGVyOiBub25lOyAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyAgIC13ZWJraXQtYm94LXNoYWRvdzogbm9uZTsgICAgICAgICAgIGJveC1zaGFkb3c6IG5vbmU7ICAgY3Vyc29yOiBwb2ludGVyOyAgIGZvbnQtc2l6ZTogMThweDsgICB0ZXh0LWFsaWduOiBjZW50ZXI7ICAgZm9udC1mYW1pbHk6ICJIZWx2ZXRpY2EgTmV1ZSIsIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7ICAgYm9yZGVyOiAxcHggc29saWQgIzc2NzY3NjsgICBwb3NpdGlvbjogcmVsYXRpdmUgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWRlY3JlbWVudCBzdmcsIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktaW5jcmVtZW50IHN2ZyB7ICAgICB3aWR0aDogMTRweDsgICAgIGhlaWdodDogMTRweDsgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICAgIHRvcDogNTAlOyAgICAgbGVmdDogNTAlOyAgICAgbWFyZ2luLXRvcDogLTZweDsgICAgIG1hcmdpbi1sZWZ0OiAtN3B4OyAgICAgZmlsbDogY3VycmVudENvbG9yOyAgIH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1kZWNyZW1lbnQgeyAgIGJvcmRlci1yYWRpdXM6IDNweCAwIDAgM3B4OyB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktaW5jcmVtZW50IHsgICBib3JkZXItcmFkaXVzOiAwIDNweCAzcHggMDsgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5IHsgICBjb2xvcjogYmxhY2s7ICAgd2lkdGg6IDQ1cHg7ICAgaGVpZ2h0OiAzMHB4OyAgIGZvbnQtc2l6ZTogMTZweDsgICBib3JkZXI6IG5vbmU7ICAgdGV4dC1hbGlnbjogY2VudGVyOyAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsgICAtbW96LWFwcGVhcmFuY2U6IHRleHRmaWVsZDsgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgcGFkZGluZzogMDsgICBib3JkZXItcmFkaXVzOiAwOyAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjNzY3Njc2OyAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjNzY3Njc2OyB9IGlucHV0W3R5cGU9bnVtYmVyXTo6LXdlYmtpdC1pbm5lci1zcGluLWJ1dHRvbiwgaW5wdXRbdHlwZT1udW1iZXJdOjotd2Via2l0LW91dGVyLXNwaW4tYnV0dG9uIHsgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7ICAgbWFyZ2luOiAwOyB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLnNob3BpZnktYnV5X19xdWFudGl0eS13aXRoLWJ0bnMgeyAgIG92ZXJmbG93OiBoaWRkZW4gfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lci5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktd2l0aC1idG5zIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHkgeyAgICAgYm9yZGVyLWxlZnQ6IDA7ICAgICBib3JkZXItcmlnaHQ6IDA7ICAgICBmbG9hdDogbGVmdDsgICB9IC5zaG9waWZ5LWJ1eV9fYnRuIHsgICBjb2xvcjogI2ZmZjsgICBmb250LXNpemU6IDE1cHg7ICAgYmFja2dyb3VuZC1jb2xvcjogIzc4YjY1NzsgICBwYWRkaW5nOiAxMnB4IDQwcHg7ICAgbGV0dGVyLXNwYWNpbmc6IC4zcHg7ICAgZGlzcGxheTogYmxvY2s7ICAgYm9yZGVyLXJhZGl1czogM3B4OyAgIGN1cnNvcjogcG9pbnRlcjsgICAtd2Via2l0LXRyYW5zaXRpb246IGJhY2tncm91bmQgMjAwbXMgZWFzZTsgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDIwMG1zIGVhc2U7ICAgbWF4LXdpZHRoOiAxMDAlOyAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyAgIG92ZXJmbG93OiBoaWRkZW47ICAgbGluZS1oZWlnaHQ6IDEuMjsgICBib3JkZXI6IDA7ICAgLW1vei1hcHBlYXJhbmNlOiBub25lOyAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZSB9IC5zaG9waWZ5LWJ1eV9fYnRuOmhvdmVyLCAgIC5zaG9waWZ5LWJ1eV9fYnRuOmZvY3VzIHsgICAgIGJhY2tncm91bmQtY29sb3I6ICM1ZjlkM2U7ICAgfSAuc2hvcGlmeS1idXlfX2J0bi0tcGFyZW50IHsgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgICBib3JkZXI6IDA7ICAgcGFkZGluZzogMDsgICBjdXJzb3I6IHBvaW50ZXIgfSAuc2hvcGlmeS1idXlfX2J0bi0tcGFyZW50OmhvdmVyIC5wcm9kdWN0X192YXJpYW50LWltZywgLnNob3BpZnktYnV5X19idG4tLXBhcmVudDpmb2N1cyAucHJvZHVjdF9fdmFyaWFudC1pbWcgeyAgICAgICBvcGFjaXR5OiAuNzsgICAgIH0gLnNob3BpZnktYnV5X19idG4tLWNhcnQtdGFiIHsgICBwYWRkaW5nOiA1cHggMTFweDsgICBib3JkZXItcmFkaXVzOiAzcHggMCAwIDNweDsgICBwb3NpdGlvbjogZml4ZWQ7ICAgcmlnaHQ6IDA7ICAgdG9wOiA1MCU7ICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZSgxMDAlLCAtNTAlKTsgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDEwMCUsIC01MCUpOyAgIG9wYWNpdHk6IDA7ICAgbWluLXdpZHRoOiBpbmhlcml0OyAgIHdpZHRoOiBhdXRvOyAgIGhlaWdodDogYXV0bzsgICB6LWluZGV4OiAyMTQ3NDgzNjQ3IH0gLnNob3BpZnktYnV5X19idG4tLWNhcnQtdGFiLmlzLWFjdGl2ZSB7ICAgICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsgICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyAgICAgb3BhY2l0eTogMTsgICB9IC5zaG9waWZ5LWJ1eV9fYnRuX19jb3VudGVyIHsgICBkaXNwbGF5OiBibG9jazsgICBtYXJnaW46IDAgYXV0byAxMHB4IGF1dG87ICAgZm9udC1zaXplOiAxOHB4OyB9IC5zaG9waWZ5LWJ1eV9faWNvbi1jYXJ0LS1zaWRlIHsgICBoZWlnaHQ6IDIwcHg7ICAgd2lkdGg6IDIwcHg7IH0gLnNob3BpZnktYnV5X19idG5bZGlzYWJsZWRdIHsgICBiYWNrZ3JvdW5kLWNvbG9yOiAjOTk5OyAgIHBvaW50ZXItZXZlbnRzOiBub25lOyB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1jbG9zZSB7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHJpZ2h0OiA5cHg7ICAgdG9wOiA4cHg7ICAgZm9udC1zaXplOiAzNXB4OyAgIGNvbG9yOiAjNzY3Njc2OyAgIGJvcmRlcjogbm9uZTsgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgICAtd2Via2l0LXRyYW5zaXRpb246IGNvbG9yIDEwMG1zIGVhc2UsIC13ZWJraXQtdHJhbnNmb3JtIDEwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogY29sb3IgMTAwbXMgZWFzZSwgLXdlYmtpdC10cmFuc2Zvcm0gMTAwbXMgZWFzZTsgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMTAwbXMgZWFzZSwgY29sb3IgMTAwbXMgZWFzZTsgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMTAwbXMgZWFzZSwgY29sb3IgMTAwbXMgZWFzZSwgLXdlYmtpdC10cmFuc2Zvcm0gMTAwbXMgZWFzZTsgICBjdXJzb3I6IHBvaW50ZXI7ICAgZm9udC1mYW1pbHk6ICJIZWx2ZXRpY2EgTmV1ZSIsIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7ICAgcGFkZGluZy1yaWdodDogOXB4IH0gLnNob3BpZnktYnV5X19idG4tLWNsb3NlOmhvdmVyIHsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiBzY2FsZSgxLjIpOyAgICAgICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMik7ICAgICBjb2xvcjogaHNsKDAsIDAlLCA0MS4yNzQ1MDk4MDM5JSk7ICAgfSAuc2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3Qtd3JhcHBlciB7ICAgYm9yZGVyOiAxcHggc29saWQgI2QzZGJlMjsgICBib3JkZXItcmFkaXVzOiAzcHg7ICAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94OyAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsgICBwb3NpdGlvbjogcmVsYXRpdmU7ICAgYmFja2dyb3VuZDogI2ZmZjsgICBvdmVyZmxvdzogaGlkZGVuOyAgIHZlcnRpY2FsLWFsaWduOiBib3R0b207IH0gLnNob3BpZnktYnV5X19zZWxlY3QtaWNvbiB7ICAgY3Vyc29yOiBwb2ludGVyOyAgIGRpc3BsYXk6IGJsb2NrOyAgIGZpbGw6ICM3OThjOWM7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHJpZ2h0OiAxMHB4OyAgIHRvcDogNTAlOyAgIG1hcmdpbi10b3A6IC02cHg7ICAgcG9pbnRlci1ldmVudHM6IG5vbmU7ICAgd2lkdGg6IDEycHg7ICAgaGVpZ2h0OiAxMnB4OyAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IH0gLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0ICsgLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0IHsgICAgIG1hcmdpbi10b3A6IDcuNXB4OyAgIH0gLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0X19sYWJlbCB7ICAgZGlzcGxheTogYmxvY2s7ICAgZm9udC1zaXplOiAxNHB4OyAgIG1hcmdpbi10b3A6IDE1cHg7ICAgbWFyZ2luLWJvdHRvbTogNXB4OyB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1wYXJlbnQgLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0X19sYWJlbCB7ICAgICBjdXJzb3I6IHBvaW50ZXI7ICAgfSAuc2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3RfX3NlbGVjdCB7ICAgZm9udC1zaXplOiBpbmhlcml0OyAgIHBhZGRpbmc6IDdweCAxMHB4OyAgIHBhZGRpbmctcmlnaHQ6IDMycHg7ICAgYm9yZGVyOiAwOyAgIHdpZHRoOiAxMDAlOyAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsgICAtbW96LWFwcGVhcmFuY2U6IG5vbmUgfSAuc2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3RfX3NlbGVjdDo6LW1zLWV4cGFuZCB7ICAgICBkaXNwbGF5OiBub25lOyAgIH0gLnNob3BpZnktYnV5X19idG4tLXBhcmVudCAuc2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3RfX3NlbGVjdCB7ICAgICBjdXJzb3I6IHBvaW50ZXI7ICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QgeyAgIG92ZXJmbG93OiBoaWRkZW47ICAgd2lkdGg6IDEwMCU7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LWltZyB7ICAgbWFyZ2luOiAwIGF1dG8gMTVweCBhdXRvOyAgIC13ZWJraXQtdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2U7ICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2U7ICAgb3BhY2l0eTogMSB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC1pbWcuaXMtdHJhbnNpdGlvbmluZyB7ICAgICBvcGFjaXR5OiAwOyAgIH0gLnNob3BpZnktYnV5X19pcy1idXR0b24geyAgIGN1cnNvcjogcG9pbnRlcjsgfSAuc2hvcGlmeS1idXlfX25vLWltYWdlIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC1pbWcgeyAgICAgZGlzcGxheTogbm9uZTsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdGl0bGUgeyAgIGZvbnQtc2l6ZTogMThweDsgICBsaW5lLWhlaWdodDogMS4yOyAgIGNvbG9yOiAjNGE0YTRhOyAgIG1hcmdpbi1ib3R0b206IDE1cHg7ICAgZm9udC13ZWlnaHQ6IDcwMDsgfSAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdGl0bGUgeyAgICAgbWFyZ2luLXRvcDogMTBweDsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC10aXRsZSB7ICAgZm9udC1zaXplOiAxOHB4OyAgIGNvbG9yOiAjNjY2OyAgIGZvbnQtd2VpZ2h0OiA0MDA7ICAgdGV4dC1hbGlnbjogY2VudGVyOyAgIG1hcmdpbi1ib3R0b206IDE1cHg7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X19wcmljZSB7ICAgbWFyZ2luLWJvdHRvbTogMTVweDsgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24geyAgIG1hcmdpbi10b3A6IDMwcHg7ICAgbGluZS1oZWlnaHQ6IDEuNjU7ICAgY29sb3I6ICM0YTRhNGEgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gcCwgICAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gdWwsICAgLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIG9sLCAgIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBpbWcgeyAgICAgbWFyZ2luLWJvdHRvbTogMTBweCAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHA6bGFzdC1jaGlsZCwgLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHVsOmxhc3QtY2hpbGQsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBvbDpsYXN0LWNoaWxkLCAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gaW1nOmxhc3QtY2hpbGQgeyAgICAgICBtYXJnaW4tYm90dG9tOiAwOyAgICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gYSB7ICAgICBjb2xvcjogaW5oZXJpdDsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBpbWcgeyAgICAgbWF4LXdpZHRoOiAxMDAlOyAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIGgxIHsgICAgIGZvbnQtc2l6ZTogMjBweDsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBoMiB7ICAgICBmb250LXNpemU6IDE4cHg7ICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gaDMgeyAgICAgZm9udC1zaXplOiAxN3B4OyAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHVsLCAgIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBvbCB7ICAgICBtYXJnaW4tbGVmdDogMmVtOyAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHVsIHsgICAgIGxpc3Qtc3R5bGUtdHlwZTogZGlzYzsgICB9IC5zaG9waWZ5LWJ1eV9fbGF5b3V0LXZlcnRpY2FsIHsgICB0ZXh0LWFsaWduOiBjZW50ZXI7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X19hY3R1YWwtcHJpY2UsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fY29tcGFyZS1wcmljZSB7ICAgY29sb3I6ICM0YTRhNGE7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fYWN0dWFsLXByaWNlIHsgICBmb250LXNpemU6IDE0cHg7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X19jb21wYXJlLXByaWNlIHsgICBmb250LXNpemU6IDEycHg7ICAgdGV4dC1kZWNvcmF0aW9uOiBsaW5lLXRocm91Z2g7ICAgcGFkZGluZy1sZWZ0OiA1cHg7ICAgb3BhY2l0eTogMC42NTsgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3VuaXQtcHJpY2UgeyAgIGNvbG9yOiAjNGE0YTRhOyAgIHBhZGRpbmctdG9wOiA1cHg7ICAgZm9udC1zaXplOiAxMnB4OyAgIG9wYWNpdHk6IDAuODsgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtc2VsZWN0b3JzIHsgICB0ZXh0LWFsaWduOiBsZWZ0OyAgIGZvbnQtc2l6ZTogMTRweDsgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtc2VsZWN0b3JzIHsgICAgIHdpZHRoOiAxMDAlOyAgICAgbWF4LXdpZHRoOiAyODBweDsgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHkgeyAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQ7ICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQ7ICAgYm9yZGVyLXJhZGl1czogM3B4OyB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHksIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktaW5jcmVtZW50LCAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWRlY3JlbWVudCB7ICAgYm9yZGVyLWNvbG9yOiAjZDNkYmUyOyAgIGxpbmUtaGVpZ2h0OiAxLjI7ICAgZm9udC1zaXplOiAxNXB4OyAgIGhlaWdodDogYXV0bzsgICBwYWRkaW5nLXRvcDogMTJweDsgICBwYWRkaW5nLWJvdHRvbTogMTJweDsgfSAuc2hvcGlmeS1idXlfX2J0biB7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9IC5zaG9waWZ5LWJ1eV9fYnRuLXdyYXBwZXIgeyAgIG1hcmdpbi10b3A6IDIwcHg7IH0gLnNob3BpZnktYnV5X19idG4uc2hvcGlmeS1idXlfX2Jlc2lkZS1xdWFudGl0eSB7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgIHZlcnRpY2FsLWFsaWduOiB0b3A7ICAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogMDsgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAwOyAgIGJvcmRlcjogMXB4IHNvbGlkIHRyYW5zcGFyZW50OyB9IC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSAuc2hvcGlmeS1idXlfX3F1YW50aXR5IHsgICAgIGJvcmRlci1yaWdodDogMDsgICAgIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAwOyAgICAgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6IDA7ICAgICBiYWNrZ3JvdW5kOiAjZmZmOyAgIH0gLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyIHsgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7ICAgfSAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgLnNob3BpZnktYnV5X19idG4td3JhcHBlciB7ICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOyAgICAgbWFyZ2luOiAwOyAgIH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3F1YW50aXR5LWNvbnRhaW5lciB7ICAgbWFyZ2luLXRvcDogMjBweDsgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IH0gLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19idG4sICAgLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIsICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX2J0biwgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyIHsgICAgIG1hcmdpbjogMjBweCBhdXRvIDA7ICAgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX2J0bjpmaXJzdC1jaGlsZCwgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX2J0bjpmaXJzdC1jaGlsZCB7ICAgICBtYXJnaW4tdG9wOiAwOyAgIH0gLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5LCAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSB7ICAgICBtYXJnaW46IDIwcHggYXV0byAwICAgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgLnNob3BpZnktYnV5X19idG4sICAgICAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgLnNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIsICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSAuc2hvcGlmeS1idXlfX2J0biwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWwgLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyIHsgICAgICAgbWFyZ2luOiAwIGF1dG87ICAgICB9IC5zaG9waWZ5LWJ1eV9fbGF5b3V0LXZlcnRpY2FsIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eTpmaXJzdC1jaGlsZCwgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHk6Zmlyc3QtY2hpbGQgeyAgICAgbWFyZ2luOiAwIGF1dG87ICAgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtaW1nLCAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC1pbWcgeyAgICAgbWF4LXdpZHRoOiAxMDAlOyAgIH0gQG1lZGlhIChtaW4td2lkdGg6IDUwMHB4KSB7ICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSB7ICAgICB0ZXh0LWFsaWduOiBsZWZ0OyAgICAgbWFyZ2luLWJvdHRvbTogMDsgICAgIG1hcmdpbi1sZWZ0OiAwICAgfSAgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0LWltZy13cmFwcGVyIHsgICAgICAgZmxvYXQ6IGxlZnQ7ICAgICAgIHdpZHRoOiA0MCU7ICAgICB9ICAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtdGl0bGUgeyAgICAgICB0ZXh0LWFsaWduOiBsZWZ0OyAgICAgfSAgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X190aXRsZSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXRpdGxlLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ByaWNlLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24sICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgPiAuc2hvcGlmeS1idXlfX2J0bi13cmFwcGVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSA+IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtc2VsZWN0b3JzIHsgICAgICAgbWFyZ2luLWxlZnQ6IGNhbGMoNDAlICsgMjVweCk7ICAgICB9IH0gQG1lZGlhIChtaW4td2lkdGg6IDY4MHB4KSB7ICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1pbWctd3JhcHBlciB7ICAgICAgIGZsb2F0OiBsZWZ0OyAgICAgICB3aWR0aDogNjAlOyAgICAgfSAgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X190aXRsZSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXRpdGxlLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ByaWNlLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24sICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgPiAuc2hvcGlmeS1idXlfX2J0bi13cmFwcGVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSA+IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtc2VsZWN0b3JzIHsgICAgICAgbWFyZ2luLWxlZnQ6IGNhbGMoNjAlICsgMjVweCk7ICAgICB9IH0gLm5vLWltYWdlIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1pbWctd3JhcHBlciB7ICAgICBkaXNwbGF5OiBub25lOyAgIH0gQC13ZWJraXQta2V5ZnJhbWVzIGRhc2ggeyAgIHRvIHsgICAgIHN0cm9rZS1kYXNob2Zmc2V0OiAwOyAgIH0gfSBAa2V5ZnJhbWVzIGRhc2ggeyAgIHRvIHsgICAgIHN0cm9rZS1kYXNob2Zmc2V0OiAwOyAgIH0gfSAuc2hvcGlmeS1idXlfX2Nhcm91c2VsIHsgICBmb250LXNpemU6IDA7ICAgdGV4dC1hbGlnbjogY2VudGVyOyAgIG1pbi1oZWlnaHQ6IDkwcHg7ICAgbWFyZ2luLWxlZnQ6IC0xNXB4OyAgIG1hcmdpbi10b3A6IDE1cHg7IH0gLnNob3BpZnktYnV5X19jYXJvdXNlbC1pdGVtIHsgICB3aWR0aDogY2FsYygxNi42NjYlIC0gMTVweCk7ICAgbWFyZ2luLWxlZnQ6IDE1cHg7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7ICAgY3Vyc29yOiBwb2ludGVyOyAgIHBvc2l0aW9uOiByZWxhdGl2ZTsgICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyOyAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsgICBwYWRkaW5nOiAwOyAgIGJvcmRlcjogbm9uZSB9IC5zaG9waWZ5LWJ1eV9fY2Fyb3VzZWwtaXRlbTpudGgtY2hpbGQobis3KSB7ICAgICBtYXJnaW4tdG9wOiAxNXB4OyAgIH0gLnNob3BpZnktYnV5X19jYXJvdXNlbC1pdGVtOmJlZm9yZSB7ICAgICBjb250ZW50OiAiIjsgICAgIGRpc3BsYXk6IGJsb2NrOyAgICAgcGFkZGluZy10b3A6IDEwMCU7ICAgfSAubWFpbi1pbWFnZS13cmFwcGVyIHsgICBwb3NpdGlvbjogcmVsYXRpdmU7IH0gLmNhcm91c2VsLWJ1dHRvbiB7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHdpZHRoOiA3NXB4OyAgIHRvcDogMDsgICBoZWlnaHQ6IDEwMCU7ICAgYm9yZGVyOiBub25lOyAgIGZvbnQtc2l6ZTogMDsgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgICBvcGFjaXR5OiAwLjQ7ICAgY3Vyc29yOiBwb2ludGVyIH0gLmNhcm91c2VsLWJ1dHRvbjpob3ZlciwgICAuY2Fyb3VzZWwtYnV0dG9uOmZvY3VzIHsgICAgIG9wYWNpdHk6IDAuOTsgICAgIG91dGxpbmU6IG5vbmU7ICAgfSAuY2Fyb3VzZWwtYnV0dG9uLWFycm93IHsgICB3aWR0aDogMjBweDsgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgbWFyZ2luLWxlZnQ6IDI1cHg7IH0gLmNhcm91c2VsLWJ1dHRvbi0tcHJldmlvdXMgeyAgIGxlZnQ6IDA7ICAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgxODBkZWcpOyAgICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMTgwZGVnKTsgfSAuY2Fyb3VzZWwtYnV0dG9uLS1uZXh0IHsgICByaWdodDogMDsgfSAuc2hvcGlmeS1idXlfX2Nhcm91c2VsLWl0ZW0tLXNlbGVjdGVkIHsgICBvcGFjaXR5OiAwLjQ7IH0gLnNob3BpZnktYnV5X19idG4tLWNsb3NlIHsgICByaWdodDogMHB4OyAgIGZvbnQtc2l6ZTogNDVweDsgICBmb250LXdlaWdodDogMTAwOyAgIHotaW5kZXg6IDIxNDc0ODM2NDc7ICAgcGFkZGluZzogMCAxMHB4OyB9IC5zaG9waWZ5LWJ1eV9fbW9kYWwgeyAgIGJhY2tncm91bmQ6ICNmZmY7ICAgd2lkdGg6IGNhbGMoMTAwJSAtIDIwcHgpOyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICBsZWZ0OiAwOyAgIHJpZ2h0OiAwOyAgIHotaW5kZXg6IDIxNDc0ODM2NDY7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0IHsgICB0ZXh0LWFsaWduOiBsZWZ0OyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdGl0bGUsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fcHJpY2UsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC10aXRsZSB7ICAgdGV4dC1hbGlnbjogbGVmdDsgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3RpdGxlIHsgICBmb250LXNpemU6IDI2cHg7ICAgZm9udC13ZWlnaHQ6IDcwMDsgICBsaW5lLWhlaWdodDogMS40OyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fY29tcGFyZS1wcmljZSB7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgIG1hcmdpbi1yaWdodDogNXB4OyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fYWN0dWFsLXByaWNlIHsgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IH0gLnNob3BpZnktYnV5X19tb2RhbCAuc2hvcGlmeS1idXlfX21vZGFsLXByb2R1Y3Qtd3JhcHBlciB7ICAgd2lkdGg6IDEwMCU7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LWltYWdlIHsgICBtYXJnaW46IDA7IH0gQG1lZGlhIChtYXgtd2lkdGg6IDQ5OXB4KSB7ICAgYm9keS5pcy1hY3RpdmUgeyAgICAgb3ZlcmZsb3c6IGhpZGRlbjsgICAgIHBvc2l0aW9uOiBmaXhlZDsgICAgIGhlaWdodDogMTAwdmg7ICAgICAtd2Via2l0LXRyYW5zaXRpb246IGFsbCAwczsgICAgIHRyYW5zaXRpb246IGFsbCAwczsgICB9ICAgIC5zaG9waWZ5LWJ1eV9fbW9kYWwgeyAgICAgd2lkdGg6IDEwMCU7ICAgICBtaW4taGVpZ2h0OiAxMDB2aDsgICAgIHBvc2l0aW9uOiBmaXhlZDsgICAgIG92ZXJmbG93LXk6IGF1dG87ICAgfSAgICAuc2hvcGlmeS1idXlfX3Byb2R1Y3QgeyAgICAgcGFkZGluZzogMTVweDsgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICAgIHRvcDogMDsgICAgIGxlZnQ6IDA7ICAgfSAgICAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtaW1nIHsgICAgIG1heC1oZWlnaHQ6IDYwdmg7ICAgICBtYXJnaW46IDAgYXV0bzsgICAgIHdpZHRoOiBhdXRvOyAgICAgbWF4LXdpZHRoOiAxMDAlOyAgIH0gICAgLnNob3BpZnktYnV5X19idG4tLWNsb3NlIHsgICAgIHBvc2l0aW9uOiBmaXhlZDsgICAgIHRvcDogMDsgICAgIHJpZ2h0OiAwOyAgIH0gfSBALXdlYmtpdC1rZXlmcmFtZXMgc2xpZGVJbiB7ICAgZnJvbSB7ICAgICBvcGFjaXR5OiAwOyAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0yMDBweCk7ICAgICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMjAwcHgpOyAgIH0gICAgdG8geyAgICAgb3BhY2l0eTogMTsgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyAgIH0gfSBAa2V5ZnJhbWVzIHNsaWRlSW4geyAgIGZyb20geyAgICAgb3BhY2l0eTogMDsgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMjAwcHgpOyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTIwMHB4KTsgICB9ICAgIHRvIHsgICAgIG9wYWNpdHk6IDE7ICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7ICAgICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgICB9IH0gQC13ZWJraXQta2V5ZnJhbWVzIHNsaWRlT3V0IHsgICBmcm9tIHsgICAgIG9wYWNpdHk6IDE7ICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMCk7ICAgICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgICB9ICAgIHRvIHsgICAgIG9wYWNpdHk6IDA7ICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTIwMHB4KTsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0yMDBweCk7ICAgfSB9IEBrZXlmcmFtZXMgc2xpZGVPdXQgeyAgIGZyb20geyAgICAgb3BhY2l0eTogMTsgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyAgIH0gICAgdG8geyAgICAgb3BhY2l0eTogMDsgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMjAwcHgpOyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTIwMHB4KTsgICB9IH0gQG1lZGlhIChtaW4td2lkdGg6IDUwMHB4KSB7ICAgaHRtbCwgICBib2R5LmlzLWFjdGl2ZSB7ICAgICBoZWlnaHQ6IDEwMCU7ICAgfSAgICAuc2hvcGlmeS1idXlfX21vZGFsLW92ZXJsYXkgeyAgICAgd2lkdGg6IDEwMCU7ICAgICBoZWlnaHQ6IDEwMCU7ICAgICBwb3NpdGlvbjogZml4ZWQ7ICAgICBvdmVyZmxvdy15OiBzY3JvbGw7ICAgfSAgICAuc2hvcGlmeS1idXlfX21vZGFsIHsgICAgIG1hcmdpbjogMTAwcHggYXV0byA0MHB4IGF1dG87ICAgICBvcGFjaXR5OiAwOyAgICAgYm9yZGVyLXJhZGl1czogMnB4OyAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjcyKTsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0yMDBweCk7ICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMjAwcHgpOyAgICAgbWF4LXdpZHRoOiAxMDAwcHg7ICAgICAtd2Via2l0LWFuaW1hdGlvbjogMjAwbXMgc2xpZGVPdXQgZm9yd2FyZHM7ICAgICAgICAgICAgIGFuaW1hdGlvbjogMjAwbXMgc2xpZGVPdXQgZm9yd2FyZHM7ICAgfSAgICAgLmlzLWFjdGl2ZSAuc2hvcGlmeS1idXlfX21vZGFsIHsgICAgICAgLXdlYmtpdC1hbmltYXRpb24tbmFtZTogc2xpZGVJbjsgICAgICAgICAgICAgICBhbmltYXRpb24tbmFtZTogc2xpZGVJbjsgICAgIH0gICAgLnNob3BpZnktYnV5X19wcm9kdWN0IHsgICAgIHBhZGRpbmc6IDMwcHg7ICAgfSAgICAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtaW1nLXdyYXBwZXIgeyAgICAgaGVpZ2h0OiAxMDAlOyAgICAgcGFkZGluZy1yaWdodDogMzBweDsgICB9ICAgIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC1pbWcgeyAgICAgbWFyZ2luOiAwIGF1dG87ICAgfSAgICAuc2hvcGlmeS1idXlfX2J0bi0tY2xvc2UgeyAgICAgdG9wOiAtNjBweDsgICAgIGNvbG9yOiBoc2woMCwgMCUsIDEwMCUpICAgfSAgICAgIC5zaG9waWZ5LWJ1eV9fYnRuLS1jbG9zZTpob3ZlciB7ICAgICAgIGNvbG9yOiAjZmZmOyAgICAgfSB9IEBtZWRpYSAobWluLXdpZHRoOiA2ODBweCkgeyAgIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdCB7ICAgICBwYWRkaW5nOiA0NXB4OyAgIH0gfSAnLAogICAgcHJvZHVjdDogJ2h0bWwsIGJvZHksIGgxLCBoMiwgaDMsIGg0LCBoNSwgcCB7ICAgcGFkZGluZzogMDsgICBtYXJnaW46IDA7IH0gKiB7ICAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94OyAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsgfSBib2R5LCBodG1sIHsgICBtaW4taGVpZ2h0OiAxMDAlOyB9IGh0bWwgeyAgIGZvbnQtZmFtaWx5OiAiSGVsdmV0aWNhIE5ldWUiLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOyAgIGZvbnQtc2l6ZTogMTRweDsgICBsaW5lLWhlaWdodDogMS4yOyAgIGNvbG9yOiAjNGM0YzRjOyAgIHRleHQtcmVuZGVyaW5nOiBvcHRpbWl6ZUxlZ2liaWxpdHk7ICAgLXdlYmtpdC1mb250LXNtb290aGluZzogYW50aWFsaWFzZWQ7ICAgLW1vei1vc3gtZm9udC1zbW9vdGhpbmc6IGdyYXlzY2FsZTsgfSBzZWxlY3QgeyAgIHRleHQtcmVuZGVyaW5nOiBhdXRvICFpbXBvcnRhbnQ7IH0gdWwgeyAgIGxpc3Qtc3R5bGU6IG5vbmU7ICAgcGFkZGluZy1sZWZ0OiAwOyAgIG1hcmdpbjogMDsgfSBpbWcgeyAgIGRpc3BsYXk6IGJsb2NrOyAgIG1heC13aWR0aDogMTAwJTsgfSBpbnB1dCB7ICAgLXdlYmtpdC1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7ICAgbWFyZ2luOiAwOyB9IC5jbGVhcmZpeDphZnRlciB7ICAgICBjb250ZW50OiAiIjsgICAgIGRpc3BsYXk6IHRhYmxlOyAgICAgY2xlYXI6IGJvdGg7ICAgfSAudmlzdWFsbHloaWRkZW4geyAgIGJvcmRlcjogMDsgICBoZWlnaHQ6IDFweDsgICBtYXJnaW46IC0xcHg7ICAgb3ZlcmZsb3c6IGhpZGRlbjsgICBwYWRkaW5nOiAwOyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICB3aWR0aDogMXB4OyB9IC5jb21wb25lbnQtY29udGFpbmVyIHsgICBvdmVyZmxvdzogaGlkZGVuOyB9IC5zaG9waWZ5LWJ1eV9fdHlwZS0tY2VudGVyIHsgICB0ZXh0LWFsaWduOiBjZW50ZXI7IH0gLnNob3BpZnktYnV5LS12aXN1YWxseS1oaWRkZW4geyAgIHBvc2l0aW9uOiBhYnNvbHV0ZSAhaW1wb3J0YW50OyAgIGNsaXA6IHJlY3QoMXB4LCAxcHgsIDFweCwgMXB4KTsgICBwYWRkaW5nOjAgIWltcG9ydGFudDsgICBib3JkZXI6MCAhaW1wb3J0YW50OyAgIGhlaWdodDogMXB4ICFpbXBvcnRhbnQ7ICAgd2lkdGg6IDFweCAhaW1wb3J0YW50OyAgIG92ZXJmbG93OiBoaWRkZW47IH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1kZWNyZW1lbnQsIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktaW5jcmVtZW50IHsgICBjb2xvcjogIzRjNGM0YzsgICBkaXNwbGF5OiBibG9jazsgICBoZWlnaHQ6IDMwcHg7ICAgZmxvYXQ6IGxlZnQ7ICAgbGluZS1oZWlnaHQ6IDE2cHg7ICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsgICB3aWR0aDogMjZweDsgICBwYWRkaW5nOiAwOyAgIGJvcmRlcjogbm9uZTsgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgICAtd2Via2l0LWJveC1zaGFkb3c6IG5vbmU7ICAgICAgICAgICBib3gtc2hhZG93OiBub25lOyAgIGN1cnNvcjogcG9pbnRlcjsgICBmb250LXNpemU6IDE4cHg7ICAgdGV4dC1hbGlnbjogY2VudGVyOyAgIGZvbnQtZmFtaWx5OiAiSGVsdmV0aWNhIE5ldWUiLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOyAgIGJvcmRlcjogMXB4IHNvbGlkICM3Njc2NzY7ICAgcG9zaXRpb246IHJlbGF0aXZlIH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1kZWNyZW1lbnQgc3ZnLCAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWluY3JlbWVudCBzdmcgeyAgICAgd2lkdGg6IDE0cHg7ICAgICBoZWlnaHQ6IDE0cHg7ICAgICBwb3NpdGlvbjogYWJzb2x1dGU7ICAgICB0b3A6IDUwJTsgICAgIGxlZnQ6IDUwJTsgICAgIG1hcmdpbi10b3A6IC02cHg7ICAgICBtYXJnaW4tbGVmdDogLTdweDsgICAgIGZpbGw6IGN1cnJlbnRDb2xvcjsgICB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktZGVjcmVtZW50IHsgICBib3JkZXItcmFkaXVzOiAzcHggMCAwIDNweDsgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWluY3JlbWVudCB7ICAgYm9yZGVyLXJhZGl1czogMCAzcHggM3B4IDA7IH0gLnNob3BpZnktYnV5X19xdWFudGl0eSB7ICAgY29sb3I6IGJsYWNrOyAgIHdpZHRoOiA0NXB4OyAgIGhlaWdodDogMzBweDsgICBmb250LXNpemU6IDE2cHg7ICAgYm9yZGVyOiBub25lOyAgIHRleHQtYWxpZ246IGNlbnRlcjsgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7ICAgLW1vei1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgIHBhZGRpbmc6IDA7ICAgYm9yZGVyLXJhZGl1czogMDsgICBib3JkZXItdG9wOiAxcHggc29saWQgIzc2NzY3NjsgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgIzc2NzY3NjsgfSBpbnB1dFt0eXBlPW51bWJlcl06Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24sIGlucHV0W3R5cGU9bnVtYmVyXTo6LXdlYmtpdC1vdXRlci1zcGluLWJ1dHRvbiB7ICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOyAgIG1hcmdpbjogMDsgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lci5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktd2l0aC1idG5zIHsgICBvdmVyZmxvdzogaGlkZGVuIH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIuc2hvcGlmeS1idXlfX3F1YW50aXR5LXdpdGgtYnRucyAuc2hvcGlmeS1idXlfX3F1YW50aXR5IHsgICAgIGJvcmRlci1sZWZ0OiAwOyAgICAgYm9yZGVyLXJpZ2h0OiAwOyAgICAgZmxvYXQ6IGxlZnQ7ICAgfSAuc2hvcGlmeS1idXlfX2J0biB7ICAgY29sb3I6ICNmZmY7ICAgZm9udC1zaXplOiAxNXB4OyAgIGJhY2tncm91bmQtY29sb3I6ICM3OGI2NTc7ICAgcGFkZGluZzogMTJweCA0MHB4OyAgIGxldHRlci1zcGFjaW5nOiAuM3B4OyAgIGRpc3BsYXk6IGJsb2NrOyAgIGJvcmRlci1yYWRpdXM6IDNweDsgICBjdXJzb3I6IHBvaW50ZXI7ICAgLXdlYmtpdC10cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDIwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAyMDBtcyBlYXNlOyAgIG1heC13aWR0aDogMTAwJTsgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgICBvdmVyZmxvdzogaGlkZGVuOyAgIGxpbmUtaGVpZ2h0OiAxLjI7ICAgYm9yZGVyOiAwOyAgIC1tb3otYXBwZWFyYW5jZTogbm9uZTsgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmUgfSAuc2hvcGlmeS1idXlfX2J0bjpob3ZlciwgICAuc2hvcGlmeS1idXlfX2J0bjpmb2N1cyB7ICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNWY5ZDNlOyAgIH0gLnNob3BpZnktYnV5X19idG4tLXBhcmVudCB7ICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7ICAgYm9yZGVyOiAwOyAgIHBhZGRpbmc6IDA7ICAgY3Vyc29yOiBwb2ludGVyIH0gLnNob3BpZnktYnV5X19idG4tLXBhcmVudDpob3ZlciAucHJvZHVjdF9fdmFyaWFudC1pbWcsIC5zaG9waWZ5LWJ1eV9fYnRuLS1wYXJlbnQ6Zm9jdXMgLnByb2R1Y3RfX3ZhcmlhbnQtaW1nIHsgICAgICAgb3BhY2l0eTogLjc7ICAgICB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1jYXJ0LXRhYiB7ICAgcGFkZGluZzogNXB4IDExcHg7ICAgYm9yZGVyLXJhZGl1czogM3B4IDAgMCAzcHg7ICAgcG9zaXRpb246IGZpeGVkOyAgIHJpZ2h0OiAwOyAgIHRvcDogNTAlOyAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGUoMTAwJSwgLTUwJSk7ICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgxMDAlLCAtNTAlKTsgICBvcGFjaXR5OiAwOyAgIG1pbi13aWR0aDogaW5oZXJpdDsgICB3aWR0aDogYXV0bzsgICBoZWlnaHQ6IGF1dG87ICAgei1pbmRleDogMjE0NzQ4MzY0NyB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1jYXJ0LXRhYi5pcy1hY3RpdmUgeyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7ICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsgICAgIG9wYWNpdHk6IDE7ICAgfSAuc2hvcGlmeS1idXlfX2J0bl9fY291bnRlciB7ICAgZGlzcGxheTogYmxvY2s7ICAgbWFyZ2luOiAwIGF1dG8gMTBweCBhdXRvOyAgIGZvbnQtc2l6ZTogMThweDsgfSAuc2hvcGlmeS1idXlfX2ljb24tY2FydC0tc2lkZSB7ICAgaGVpZ2h0OiAyMHB4OyAgIHdpZHRoOiAyMHB4OyB9IC5zaG9waWZ5LWJ1eV9fYnRuW2Rpc2FibGVkXSB7ICAgYmFja2dyb3VuZC1jb2xvcjogIzk5OTsgICBwb2ludGVyLWV2ZW50czogbm9uZTsgfSAuc2hvcGlmeS1idXlfX2J0bi0tY2xvc2UgeyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICByaWdodDogOXB4OyAgIHRvcDogOHB4OyAgIGZvbnQtc2l6ZTogMzVweDsgICBjb2xvcjogIzc2NzY3NjsgICBib3JkZXI6IG5vbmU7ICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7ICAgLXdlYmtpdC10cmFuc2l0aW9uOiBjb2xvciAxMDBtcyBlYXNlLCAtd2Via2l0LXRyYW5zZm9ybSAxMDBtcyBlYXNlOyAgIHRyYW5zaXRpb246IGNvbG9yIDEwMG1zIGVhc2UsIC13ZWJraXQtdHJhbnNmb3JtIDEwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDEwMG1zIGVhc2UsIGNvbG9yIDEwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDEwMG1zIGVhc2UsIGNvbG9yIDEwMG1zIGVhc2UsIC13ZWJraXQtdHJhbnNmb3JtIDEwMG1zIGVhc2U7ICAgY3Vyc29yOiBwb2ludGVyOyAgIGZvbnQtZmFtaWx5OiAiSGVsdmV0aWNhIE5ldWUiLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOyAgIHBhZGRpbmctcmlnaHQ6IDlweCB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1jbG9zZTpob3ZlciB7ICAgICAtd2Via2l0LXRyYW5zZm9ybTogc2NhbGUoMS4yKTsgICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxLjIpOyAgICAgY29sb3I6IGhzbCgwLCAwJSwgNDEuMjc0NTA5ODAzOSUpOyAgIH0gLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0LXdyYXBwZXIgeyAgIGJvcmRlcjogMXB4IHNvbGlkICNkM2RiZTI7ICAgYm9yZGVyLXJhZGl1czogM3B4OyAgIC13ZWJraXQtYm94LXNpemluZzogYm9yZGVyLWJveDsgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7ICAgcG9zaXRpb246IHJlbGF0aXZlOyAgIGJhY2tncm91bmQ6ICNmZmY7ICAgb3ZlcmZsb3c6IGhpZGRlbjsgICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tOyB9IC5zaG9waWZ5LWJ1eV9fc2VsZWN0LWljb24geyAgIGN1cnNvcjogcG9pbnRlcjsgICBkaXNwbGF5OiBibG9jazsgICBmaWxsOiAjNzk4YzljOyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICByaWdodDogMTBweDsgICB0b3A6IDUwJTsgICBtYXJnaW4tdG9wOiAtNnB4OyAgIHBvaW50ZXItZXZlbnRzOiBub25lOyAgIHdpZHRoOiAxMnB4OyAgIGhlaWdodDogMTJweDsgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyB9IC5zaG9waWZ5LWJ1eV9fb3B0aW9uLXNlbGVjdCArIC5zaG9waWZ5LWJ1eV9fb3B0aW9uLXNlbGVjdCB7ICAgICBtYXJnaW4tdG9wOiA3LjVweDsgICB9IC5zaG9waWZ5LWJ1eV9fb3B0aW9uLXNlbGVjdF9fbGFiZWwgeyAgIGRpc3BsYXk6IGJsb2NrOyAgIGZvbnQtc2l6ZTogMTRweDsgICBtYXJnaW4tdG9wOiAxNXB4OyAgIG1hcmdpbi1ib3R0b206IDVweDsgfSAuc2hvcGlmeS1idXlfX2J0bi0tcGFyZW50IC5zaG9waWZ5LWJ1eV9fb3B0aW9uLXNlbGVjdF9fbGFiZWwgeyAgICAgY3Vyc29yOiBwb2ludGVyOyAgIH0gLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0X19zZWxlY3QgeyAgIGZvbnQtc2l6ZTogaW5oZXJpdDsgICBwYWRkaW5nOiA3cHggMTBweDsgICBwYWRkaW5nLXJpZ2h0OiAzMnB4OyAgIGJvcmRlcjogMDsgICB3aWR0aDogMTAwJTsgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7ICAgLW1vei1hcHBlYXJhbmNlOiBub25lIH0gLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0X19zZWxlY3Q6Oi1tcy1leHBhbmQgeyAgICAgZGlzcGxheTogbm9uZTsgICB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1wYXJlbnQgLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0X19zZWxlY3QgeyAgICAgY3Vyc29yOiBwb2ludGVyOyAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0IHsgICBvdmVyZmxvdzogaGlkZGVuOyAgIHdpZHRoOiAxMDAlOyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC1pbWcgeyAgIG1hcmdpbjogMCBhdXRvIDE1cHggYXV0bzsgICAtd2Via2l0LXRyYW5zaXRpb246IG9wYWNpdHkgMC4zcyBlYXNlOyAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4zcyBlYXNlOyAgIG9wYWNpdHk6IDEgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtaW1nLmlzLXRyYW5zaXRpb25pbmcgeyAgICAgb3BhY2l0eTogMDsgICB9IC5zaG9waWZ5LWJ1eV9faXMtYnV0dG9uIHsgICBjdXJzb3I6IHBvaW50ZXI7IH0gLnNob3BpZnktYnV5X19uby1pbWFnZSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtaW1nIHsgICAgIGRpc3BsYXk6IG5vbmU7ICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3RpdGxlIHsgICBmb250LXNpemU6IDE4cHg7ICAgbGluZS1oZWlnaHQ6IDEuMjsgICBjb2xvcjogIzRhNGE0YTsgICBtYXJnaW4tYm90dG9tOiAxNXB4OyAgIGZvbnQtd2VpZ2h0OiA3MDA7IH0gLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3RpdGxlIHsgICAgIG1hcmdpbi10b3A6IDEwcHg7ICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtdGl0bGUgeyAgIGZvbnQtc2l6ZTogMThweDsgICBjb2xvcjogIzY2NjsgICBmb250LXdlaWdodDogNDAwOyAgIHRleHQtYWxpZ246IGNlbnRlcjsgICBtYXJnaW4tYm90dG9tOiAxNXB4OyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fcHJpY2UgeyAgIG1hcmdpbi1ib3R0b206IDE1cHg7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHsgICBtYXJnaW4tdG9wOiAzMHB4OyAgIGxpbmUtaGVpZ2h0OiAxLjY1OyAgIGNvbG9yOiAjNGE0YTRhIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHAsICAgLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHVsLCAgIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBvbCwgICAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gaW1nIHsgICAgIG1hcmdpbi1ib3R0b206IDEwcHggICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBwOmxhc3QtY2hpbGQsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiB1bDpsYXN0LWNoaWxkLCAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gb2w6bGFzdC1jaGlsZCwgLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIGltZzpsYXN0LWNoaWxkIHsgICAgICAgbWFyZ2luLWJvdHRvbTogMDsgICAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIGEgeyAgICAgY29sb3I6IGluaGVyaXQ7ICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gaW1nIHsgICAgIG1heC13aWR0aDogMTAwJTsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBoMSB7ICAgICBmb250LXNpemU6IDIwcHg7ICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gaDIgeyAgICAgZm9udC1zaXplOiAxOHB4OyAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIGgzIHsgICAgIGZvbnQtc2l6ZTogMTdweDsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiB1bCwgICAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gb2wgeyAgICAgbWFyZ2luLWxlZnQ6IDJlbTsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiB1bCB7ICAgICBsaXN0LXN0eWxlLXR5cGU6IGRpc2M7ICAgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCB7ICAgdGV4dC1hbGlnbjogY2VudGVyOyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fYWN0dWFsLXByaWNlLCAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX2NvbXBhcmUtcHJpY2UgeyAgIGNvbG9yOiAjNGE0YTRhOyAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX2FjdHVhbC1wcmljZSB7ICAgZm9udC1zaXplOiAxNHB4OyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fY29tcGFyZS1wcmljZSB7ICAgZm9udC1zaXplOiAxMnB4OyAgIHRleHQtZGVjb3JhdGlvbjogbGluZS10aHJvdWdoOyAgIHBhZGRpbmctbGVmdDogNXB4OyAgIG9wYWNpdHk6IDAuNjU7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X191bml0LXByaWNlIHsgICBjb2xvcjogIzRhNGE0YTsgICBwYWRkaW5nLXRvcDogNXB4OyAgIGZvbnQtc2l6ZTogMTJweDsgICBvcGFjaXR5OiAwLjg7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXNlbGVjdG9ycyB7ICAgdGV4dC1hbGlnbjogbGVmdDsgICBmb250LXNpemU6IDE0cHg7IH0gLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXNlbGVjdG9ycyB7ICAgICB3aWR0aDogMTAwJTsgICAgIG1heC13aWR0aDogMjgwcHg7ICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5IHsgICBib3JkZXItbGVmdDogMXB4IHNvbGlkOyAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkOyAgIGJvcmRlci1yYWRpdXM6IDNweDsgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LCAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWluY3JlbWVudCwgLnNob3BpZnktYnV5X19xdWFudGl0eS1kZWNyZW1lbnQgeyAgIGJvcmRlci1jb2xvcjogI2QzZGJlMjsgICBsaW5lLWhlaWdodDogMS4yOyAgIGZvbnQtc2l6ZTogMTVweDsgICBoZWlnaHQ6IGF1dG87ICAgcGFkZGluZy10b3A6IDEycHg7ICAgcGFkZGluZy1ib3R0b206IDEycHg7IH0gLnNob3BpZnktYnV5X19idG4geyAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgfSAuc2hvcGlmeS1idXlfX2J0bi13cmFwcGVyIHsgICBtYXJnaW4tdG9wOiAyMHB4OyB9IC5zaG9waWZ5LWJ1eV9fYnRuLnNob3BpZnktYnV5X19iZXNpZGUtcXVhbnRpdHkgeyAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOyAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDA7ICAgYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czogMDsgICBib3JkZXI6IDFweCBzb2xpZCB0cmFuc3BhcmVudDsgfSAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgLnNob3BpZnktYnV5X19xdWFudGl0eSB7ICAgICBib3JkZXItcmlnaHQ6IDA7ICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogMDsgICAgIGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiAwOyAgICAgYmFja2dyb3VuZDogI2ZmZjsgICB9IC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lciB7ICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOyAgIH0gLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5IC5zaG9waWZ5LWJ1eV9fYnRuLXdyYXBwZXIgeyAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgICAgdmVydGljYWwtYWxpZ246IHRvcDsgICAgIG1hcmdpbjogMDsgICB9IC5zaG9waWZ5LWJ1eV9fY2FydC1pdGVtX19xdWFudGl0eS1jb250YWluZXIgeyAgIG1hcmdpbi10b3A6IDIwcHg7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9IC5zaG9waWZ5LWJ1eV9fbGF5b3V0LXZlcnRpY2FsIC5zaG9waWZ5LWJ1eV9fYnRuLCAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LXZlcnRpY2FsIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLCAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWwgLnNob3BpZnktYnV5X19idG4sICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lciB7ICAgICBtYXJnaW46IDIwcHggYXV0byAwOyAgIH0gLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19idG46Zmlyc3QtY2hpbGQsIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWwgLnNob3BpZnktYnV5X19idG46Zmlyc3QtY2hpbGQgeyAgICAgbWFyZ2luLXRvcDogMDsgICB9IC5zaG9waWZ5LWJ1eV9fbGF5b3V0LXZlcnRpY2FsIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSwgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgeyAgICAgbWFyZ2luOiAyMHB4IGF1dG8gMCAgIH0gLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5IC5zaG9waWZ5LWJ1eV9fYnRuLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgLnNob3BpZnktYnV5X19idG4sICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lciB7ICAgICAgIG1hcmdpbjogMCBhdXRvOyAgICAgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHk6Zmlyc3QtY2hpbGQsIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWwgLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5OmZpcnN0LWNoaWxkIHsgICAgIG1hcmdpbjogMCBhdXRvOyAgIH0gLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LWltZywgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtaW1nIHsgICAgIG1heC13aWR0aDogMTAwJTsgICB9IEBtZWRpYSAobWluLXdpZHRoOiA1MDBweCkgeyAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgeyAgICAgdGV4dC1hbGlnbjogbGVmdDsgICAgIG1hcmdpbi1ib3R0b206IDA7ICAgICBtYXJnaW4tbGVmdDogMCAgIH0gICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1pbWctd3JhcHBlciB7ICAgICAgIGZsb2F0OiBsZWZ0OyAgICAgICB3aWR0aDogNDAlOyAgICAgfSAgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXRpdGxlIHsgICAgICAgdGV4dC1hbGlnbjogbGVmdDsgICAgIH0gICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdGl0bGUsICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC10aXRsZSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X19wcmljZSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHksICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpID4gLnNob3BpZnktYnV5X19idG4td3JhcHBlciwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgPiAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lciwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXNlbGVjdG9ycyB7ICAgICAgIG1hcmdpbi1sZWZ0OiBjYWxjKDQwJSArIDI1cHgpOyAgICAgfSB9IEBtZWRpYSAobWluLXdpZHRoOiA2ODBweCkgeyAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtaW1nLXdyYXBwZXIgeyAgICAgICBmbG9hdDogbGVmdDsgICAgICAgd2lkdGg6IDYwJTsgICAgIH0gICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdGl0bGUsICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC10aXRsZSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X19wcmljZSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHksICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpID4gLnNob3BpZnktYnV5X19idG4td3JhcHBlciwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgPiAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lciwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXNlbGVjdG9ycyB7ICAgICAgIG1hcmdpbi1sZWZ0OiBjYWxjKDYwJSArIDI1cHgpOyAgICAgfSB9IC5uby1pbWFnZSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtaW1nLXdyYXBwZXIgeyAgICAgZGlzcGxheTogbm9uZTsgICB9IEAtd2Via2l0LWtleWZyYW1lcyBkYXNoIHsgICB0byB7ICAgICBzdHJva2UtZGFzaG9mZnNldDogMDsgICB9IH0gQGtleWZyYW1lcyBkYXNoIHsgICB0byB7ICAgICBzdHJva2UtZGFzaG9mZnNldDogMDsgICB9IH0gLnNob3BpZnktYnV5X19jYXJvdXNlbCB7ICAgZm9udC1zaXplOiAwOyAgIHRleHQtYWxpZ246IGNlbnRlcjsgICBtaW4taGVpZ2h0OiA5MHB4OyAgIG1hcmdpbi1sZWZ0OiAtMTVweDsgICBtYXJnaW4tdG9wOiAxNXB4OyB9IC5zaG9waWZ5LWJ1eV9fY2Fyb3VzZWwtaXRlbSB7ICAgd2lkdGg6IGNhbGMoMTYuNjY2JSAtIDE1cHgpOyAgIG1hcmdpbi1sZWZ0OiAxNXB4OyAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyAgIGN1cnNvcjogcG9pbnRlcjsgICBwb3NpdGlvbjogcmVsYXRpdmU7ICAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjsgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7ICAgcGFkZGluZzogMDsgICBib3JkZXI6IG5vbmUgfSAuc2hvcGlmeS1idXlfX2Nhcm91c2VsLWl0ZW06bnRoLWNoaWxkKG4rNykgeyAgICAgbWFyZ2luLXRvcDogMTVweDsgICB9IC5zaG9waWZ5LWJ1eV9fY2Fyb3VzZWwtaXRlbTpiZWZvcmUgeyAgICAgY29udGVudDogIiI7ICAgICBkaXNwbGF5OiBibG9jazsgICAgIHBhZGRpbmctdG9wOiAxMDAlOyAgIH0gLm1haW4taW1hZ2Utd3JhcHBlciB7ICAgcG9zaXRpb246IHJlbGF0aXZlOyB9IC5jYXJvdXNlbC1idXR0b24geyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICB3aWR0aDogNzVweDsgICB0b3A6IDA7ICAgaGVpZ2h0OiAxMDAlOyAgIGJvcmRlcjogbm9uZTsgICBmb250LXNpemU6IDA7ICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7ICAgb3BhY2l0eTogMC40OyAgIGN1cnNvcjogcG9pbnRlciB9IC5jYXJvdXNlbC1idXR0b246aG92ZXIsICAgLmNhcm91c2VsLWJ1dHRvbjpmb2N1cyB7ICAgICBvcGFjaXR5OiAwLjk7ICAgICBvdXRsaW5lOiBub25lOyAgIH0gLmNhcm91c2VsLWJ1dHRvbi1hcnJvdyB7ICAgd2lkdGg6IDIwcHg7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgIG1hcmdpbi1sZWZ0OiAyNXB4OyB9IC5jYXJvdXNlbC1idXR0b24tLXByZXZpb3VzIHsgICBsZWZ0OiAwOyAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMTgwZGVnKTsgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDE4MGRlZyk7IH0gLmNhcm91c2VsLWJ1dHRvbi0tbmV4dCB7ICAgcmlnaHQ6IDA7IH0gLnNob3BpZnktYnV5X19jYXJvdXNlbC1pdGVtLS1zZWxlY3RlZCB7ICAgb3BhY2l0eTogMC40OyB9ICcsCiAgICBwcm9kdWN0U2V0OiAnaHRtbCwgYm9keSwgaDEsIGgyLCBoMywgaDQsIGg1LCBwIHsgICBwYWRkaW5nOiAwOyAgIG1hcmdpbjogMDsgfSAqIHsgICAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7ICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OyB9IGJvZHksIGh0bWwgeyAgIG1pbi1oZWlnaHQ6IDEwMCU7IH0gaHRtbCB7ICAgZm9udC1mYW1pbHk6ICJIZWx2ZXRpY2EgTmV1ZSIsIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7ICAgZm9udC1zaXplOiAxNHB4OyAgIGxpbmUtaGVpZ2h0OiAxLjI7ICAgY29sb3I6ICM0YzRjNGM7ICAgdGV4dC1yZW5kZXJpbmc6IG9wdGltaXplTGVnaWJpbGl0eTsgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDsgICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlOyB9IHNlbGVjdCB7ICAgdGV4dC1yZW5kZXJpbmc6IGF1dG8gIWltcG9ydGFudDsgfSB1bCB7ICAgbGlzdC1zdHlsZTogbm9uZTsgICBwYWRkaW5nLWxlZnQ6IDA7ICAgbWFyZ2luOiAwOyB9IGltZyB7ICAgZGlzcGxheTogYmxvY2s7ICAgbWF4LXdpZHRoOiAxMDAlOyB9IGlucHV0IHsgICAtd2Via2l0LWFwcGVhcmFuY2U6IHRleHRmaWVsZDsgICBtYXJnaW46IDA7IH0gLmNsZWFyZml4OmFmdGVyIHsgICAgIGNvbnRlbnQ6ICIiOyAgICAgZGlzcGxheTogdGFibGU7ICAgICBjbGVhcjogYm90aDsgICB9IC52aXN1YWxseWhpZGRlbiB7ICAgYm9yZGVyOiAwOyAgIGhlaWdodDogMXB4OyAgIG1hcmdpbjogLTFweDsgICBvdmVyZmxvdzogaGlkZGVuOyAgIHBhZGRpbmc6IDA7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHdpZHRoOiAxcHg7IH0gLmNvbXBvbmVudC1jb250YWluZXIgeyAgIG92ZXJmbG93OiBoaWRkZW47IH0gLnNob3BpZnktYnV5X190eXBlLS1jZW50ZXIgeyAgIHRleHQtYWxpZ246IGNlbnRlcjsgfSAuc2hvcGlmeS1idXktLXZpc3VhbGx5LWhpZGRlbiB7ICAgcG9zaXRpb246IGFic29sdXRlICFpbXBvcnRhbnQ7ICAgY2xpcDogcmVjdCgxcHgsIDFweCwgMXB4LCAxcHgpOyAgIHBhZGRpbmc6MCAhaW1wb3J0YW50OyAgIGJvcmRlcjowICFpbXBvcnRhbnQ7ICAgaGVpZ2h0OiAxcHggIWltcG9ydGFudDsgICB3aWR0aDogMXB4ICFpbXBvcnRhbnQ7ICAgb3ZlcmZsb3c6IGhpZGRlbjsgfSAuc2hvcGlmeS1idXlfX2J0biB7ICAgY29sb3I6ICNmZmY7ICAgZm9udC1zaXplOiAxNXB4OyAgIGJhY2tncm91bmQtY29sb3I6ICM3OGI2NTc7ICAgcGFkZGluZzogMTJweCA0MHB4OyAgIGxldHRlci1zcGFjaW5nOiAuM3B4OyAgIGRpc3BsYXk6IGJsb2NrOyAgIGJvcmRlci1yYWRpdXM6IDNweDsgICBjdXJzb3I6IHBvaW50ZXI7ICAgLXdlYmtpdC10cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDIwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAyMDBtcyBlYXNlOyAgIG1heC13aWR0aDogMTAwJTsgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgICBvdmVyZmxvdzogaGlkZGVuOyAgIGxpbmUtaGVpZ2h0OiAxLjI7ICAgYm9yZGVyOiAwOyAgIC1tb3otYXBwZWFyYW5jZTogbm9uZTsgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmUgfSAuc2hvcGlmeS1idXlfX2J0bjpob3ZlciwgICAuc2hvcGlmeS1idXlfX2J0bjpmb2N1cyB7ICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNWY5ZDNlOyAgIH0gLnNob3BpZnktYnV5X19idG4tLXBhcmVudCB7ICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7ICAgYm9yZGVyOiAwOyAgIHBhZGRpbmc6IDA7ICAgY3Vyc29yOiBwb2ludGVyIH0gLnNob3BpZnktYnV5X19idG4tLXBhcmVudDpob3ZlciAucHJvZHVjdF9fdmFyaWFudC1pbWcsIC5zaG9waWZ5LWJ1eV9fYnRuLS1wYXJlbnQ6Zm9jdXMgLnByb2R1Y3RfX3ZhcmlhbnQtaW1nIHsgICAgICAgb3BhY2l0eTogLjc7ICAgICB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1jYXJ0LXRhYiB7ICAgcGFkZGluZzogNXB4IDExcHg7ICAgYm9yZGVyLXJhZGl1czogM3B4IDAgMCAzcHg7ICAgcG9zaXRpb246IGZpeGVkOyAgIHJpZ2h0OiAwOyAgIHRvcDogNTAlOyAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGUoMTAwJSwgLTUwJSk7ICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgxMDAlLCAtNTAlKTsgICBvcGFjaXR5OiAwOyAgIG1pbi13aWR0aDogaW5oZXJpdDsgICB3aWR0aDogYXV0bzsgICBoZWlnaHQ6IGF1dG87ICAgei1pbmRleDogMjE0NzQ4MzY0NyB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1jYXJ0LXRhYi5pcy1hY3RpdmUgeyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7ICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsgICAgIG9wYWNpdHk6IDE7ICAgfSAuc2hvcGlmeS1idXlfX2J0bl9fY291bnRlciB7ICAgZGlzcGxheTogYmxvY2s7ICAgbWFyZ2luOiAwIGF1dG8gMTBweCBhdXRvOyAgIGZvbnQtc2l6ZTogMThweDsgfSAuc2hvcGlmeS1idXlfX2ljb24tY2FydC0tc2lkZSB7ICAgaGVpZ2h0OiAyMHB4OyAgIHdpZHRoOiAyMHB4OyB9IC5zaG9waWZ5LWJ1eV9fYnRuW2Rpc2FibGVkXSB7ICAgYmFja2dyb3VuZC1jb2xvcjogIzk5OTsgICBwb2ludGVyLWV2ZW50czogbm9uZTsgfSAuc2hvcGlmeS1idXlfX2J0bi0tY2xvc2UgeyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICByaWdodDogOXB4OyAgIHRvcDogOHB4OyAgIGZvbnQtc2l6ZTogMzVweDsgICBjb2xvcjogIzc2NzY3NjsgICBib3JkZXI6IG5vbmU7ICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7ICAgLXdlYmtpdC10cmFuc2l0aW9uOiBjb2xvciAxMDBtcyBlYXNlLCAtd2Via2l0LXRyYW5zZm9ybSAxMDBtcyBlYXNlOyAgIHRyYW5zaXRpb246IGNvbG9yIDEwMG1zIGVhc2UsIC13ZWJraXQtdHJhbnNmb3JtIDEwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDEwMG1zIGVhc2UsIGNvbG9yIDEwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDEwMG1zIGVhc2UsIGNvbG9yIDEwMG1zIGVhc2UsIC13ZWJraXQtdHJhbnNmb3JtIDEwMG1zIGVhc2U7ICAgY3Vyc29yOiBwb2ludGVyOyAgIGZvbnQtZmFtaWx5OiAiSGVsdmV0aWNhIE5ldWUiLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOyAgIHBhZGRpbmctcmlnaHQ6IDlweCB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1jbG9zZTpob3ZlciB7ICAgICAtd2Via2l0LXRyYW5zZm9ybTogc2NhbGUoMS4yKTsgICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxLjIpOyAgICAgY29sb3I6IGhzbCgwLCAwJSwgNDEuMjc0NTA5ODAzOSUpOyAgIH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1kZWNyZW1lbnQsIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktaW5jcmVtZW50IHsgICBjb2xvcjogIzRjNGM0YzsgICBkaXNwbGF5OiBibG9jazsgICBoZWlnaHQ6IDMwcHg7ICAgZmxvYXQ6IGxlZnQ7ICAgbGluZS1oZWlnaHQ6IDE2cHg7ICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsgICB3aWR0aDogMjZweDsgICBwYWRkaW5nOiAwOyAgIGJvcmRlcjogbm9uZTsgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgICAtd2Via2l0LWJveC1zaGFkb3c6IG5vbmU7ICAgICAgICAgICBib3gtc2hhZG93OiBub25lOyAgIGN1cnNvcjogcG9pbnRlcjsgICBmb250LXNpemU6IDE4cHg7ICAgdGV4dC1hbGlnbjogY2VudGVyOyAgIGZvbnQtZmFtaWx5OiAiSGVsdmV0aWNhIE5ldWUiLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOyAgIGJvcmRlcjogMXB4IHNvbGlkICM3Njc2NzY7ICAgcG9zaXRpb246IHJlbGF0aXZlIH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1kZWNyZW1lbnQgc3ZnLCAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWluY3JlbWVudCBzdmcgeyAgICAgd2lkdGg6IDE0cHg7ICAgICBoZWlnaHQ6IDE0cHg7ICAgICBwb3NpdGlvbjogYWJzb2x1dGU7ICAgICB0b3A6IDUwJTsgICAgIGxlZnQ6IDUwJTsgICAgIG1hcmdpbi10b3A6IC02cHg7ICAgICBtYXJnaW4tbGVmdDogLTdweDsgICAgIGZpbGw6IGN1cnJlbnRDb2xvcjsgICB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktZGVjcmVtZW50IHsgICBib3JkZXItcmFkaXVzOiAzcHggMCAwIDNweDsgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWluY3JlbWVudCB7ICAgYm9yZGVyLXJhZGl1czogMCAzcHggM3B4IDA7IH0gLnNob3BpZnktYnV5X19xdWFudGl0eSB7ICAgY29sb3I6IGJsYWNrOyAgIHdpZHRoOiA0NXB4OyAgIGhlaWdodDogMzBweDsgICBmb250LXNpemU6IDE2cHg7ICAgYm9yZGVyOiBub25lOyAgIHRleHQtYWxpZ246IGNlbnRlcjsgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7ICAgLW1vei1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgIHBhZGRpbmc6IDA7ICAgYm9yZGVyLXJhZGl1czogMDsgICBib3JkZXItdG9wOiAxcHggc29saWQgIzc2NzY3NjsgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgIzc2NzY3NjsgfSBpbnB1dFt0eXBlPW51bWJlcl06Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24sIGlucHV0W3R5cGU9bnVtYmVyXTo6LXdlYmtpdC1vdXRlci1zcGluLWJ1dHRvbiB7ICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOyAgIG1hcmdpbjogMDsgfSAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWNvbnRhaW5lci5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktd2l0aC1idG5zIHsgICBvdmVyZmxvdzogaGlkZGVuIH0gLnNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIuc2hvcGlmeS1idXlfX3F1YW50aXR5LXdpdGgtYnRucyAuc2hvcGlmeS1idXlfX3F1YW50aXR5IHsgICAgIGJvcmRlci1sZWZ0OiAwOyAgICAgYm9yZGVyLXJpZ2h0OiAwOyAgICAgZmxvYXQ6IGxlZnQ7ICAgfSAuc2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3Qtd3JhcHBlciB7ICAgYm9yZGVyOiAxcHggc29saWQgI2QzZGJlMjsgICBib3JkZXItcmFkaXVzOiAzcHg7ICAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94OyAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsgICBwb3NpdGlvbjogcmVsYXRpdmU7ICAgYmFja2dyb3VuZDogI2ZmZjsgICBvdmVyZmxvdzogaGlkZGVuOyAgIHZlcnRpY2FsLWFsaWduOiBib3R0b207IH0gLnNob3BpZnktYnV5X19zZWxlY3QtaWNvbiB7ICAgY3Vyc29yOiBwb2ludGVyOyAgIGRpc3BsYXk6IGJsb2NrOyAgIGZpbGw6ICM3OThjOWM7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHJpZ2h0OiAxMHB4OyAgIHRvcDogNTAlOyAgIG1hcmdpbi10b3A6IC02cHg7ICAgcG9pbnRlci1ldmVudHM6IG5vbmU7ICAgd2lkdGg6IDEycHg7ICAgaGVpZ2h0OiAxMnB4OyAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IH0gLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0ICsgLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0IHsgICAgIG1hcmdpbi10b3A6IDcuNXB4OyAgIH0gLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0X19sYWJlbCB7ICAgZGlzcGxheTogYmxvY2s7ICAgZm9udC1zaXplOiAxNHB4OyAgIG1hcmdpbi10b3A6IDE1cHg7ICAgbWFyZ2luLWJvdHRvbTogNXB4OyB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1wYXJlbnQgLnNob3BpZnktYnV5X19vcHRpb24tc2VsZWN0X19sYWJlbCB7ICAgICBjdXJzb3I6IHBvaW50ZXI7ICAgfSAuc2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3RfX3NlbGVjdCB7ICAgZm9udC1zaXplOiBpbmhlcml0OyAgIHBhZGRpbmc6IDdweCAxMHB4OyAgIHBhZGRpbmctcmlnaHQ6IDMycHg7ICAgYm9yZGVyOiAwOyAgIHdpZHRoOiAxMDAlOyAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsgICAtbW96LWFwcGVhcmFuY2U6IG5vbmUgfSAuc2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3RfX3NlbGVjdDo6LW1zLWV4cGFuZCB7ICAgICBkaXNwbGF5OiBub25lOyAgIH0gLnNob3BpZnktYnV5X19idG4tLXBhcmVudCAuc2hvcGlmeS1idXlfX29wdGlvbi1zZWxlY3RfX3NlbGVjdCB7ICAgICBjdXJzb3I6IHBvaW50ZXI7ICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QgeyAgIG92ZXJmbG93OiBoaWRkZW47ICAgd2lkdGg6IDEwMCU7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LWltZyB7ICAgbWFyZ2luOiAwIGF1dG8gMTVweCBhdXRvOyAgIC13ZWJraXQtdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2U7ICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2U7ICAgb3BhY2l0eTogMSB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC1pbWcuaXMtdHJhbnNpdGlvbmluZyB7ICAgICBvcGFjaXR5OiAwOyAgIH0gLnNob3BpZnktYnV5X19pcy1idXR0b24geyAgIGN1cnNvcjogcG9pbnRlcjsgfSAuc2hvcGlmeS1idXlfX25vLWltYWdlIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC1pbWcgeyAgICAgZGlzcGxheTogbm9uZTsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdGl0bGUgeyAgIGZvbnQtc2l6ZTogMThweDsgICBsaW5lLWhlaWdodDogMS4yOyAgIGNvbG9yOiAjNGE0YTRhOyAgIG1hcmdpbi1ib3R0b206IDE1cHg7ICAgZm9udC13ZWlnaHQ6IDcwMDsgfSAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdGl0bGUgeyAgICAgbWFyZ2luLXRvcDogMTBweDsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC10aXRsZSB7ICAgZm9udC1zaXplOiAxOHB4OyAgIGNvbG9yOiAjNjY2OyAgIGZvbnQtd2VpZ2h0OiA0MDA7ICAgdGV4dC1hbGlnbjogY2VudGVyOyAgIG1hcmdpbi1ib3R0b206IDE1cHg7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X19wcmljZSB7ICAgbWFyZ2luLWJvdHRvbTogMTVweDsgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24geyAgIG1hcmdpbi10b3A6IDMwcHg7ICAgbGluZS1oZWlnaHQ6IDEuNjU7ICAgY29sb3I6ICM0YTRhNGEgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gcCwgICAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gdWwsICAgLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIG9sLCAgIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBpbWcgeyAgICAgbWFyZ2luLWJvdHRvbTogMTBweCAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHA6bGFzdC1jaGlsZCwgLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHVsOmxhc3QtY2hpbGQsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBvbDpsYXN0LWNoaWxkLCAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gaW1nOmxhc3QtY2hpbGQgeyAgICAgICBtYXJnaW4tYm90dG9tOiAwOyAgICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gYSB7ICAgICBjb2xvcjogaW5oZXJpdDsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBpbWcgeyAgICAgbWF4LXdpZHRoOiAxMDAlOyAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIGgxIHsgICAgIGZvbnQtc2l6ZTogMjBweDsgICB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBoMiB7ICAgICBmb250LXNpemU6IDE4cHg7ICAgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24gaDMgeyAgICAgZm9udC1zaXplOiAxN3B4OyAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHVsLCAgIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1kZXNjcmlwdGlvbiBvbCB7ICAgICBtYXJnaW4tbGVmdDogMmVtOyAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0LWRlc2NyaXB0aW9uIHVsIHsgICAgIGxpc3Qtc3R5bGUtdHlwZTogZGlzYzsgICB9IC5zaG9waWZ5LWJ1eV9fbGF5b3V0LXZlcnRpY2FsIHsgICB0ZXh0LWFsaWduOiBjZW50ZXI7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X19hY3R1YWwtcHJpY2UsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fY29tcGFyZS1wcmljZSB7ICAgY29sb3I6ICM0YTRhNGE7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9IC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fYWN0dWFsLXByaWNlIHsgICBmb250LXNpemU6IDE0cHg7IH0gLnNob3BpZnktYnV5X19wcm9kdWN0X19jb21wYXJlLXByaWNlIHsgICBmb250LXNpemU6IDEycHg7ICAgdGV4dC1kZWNvcmF0aW9uOiBsaW5lLXRocm91Z2g7ICAgcGFkZGluZy1sZWZ0OiA1cHg7ICAgb3BhY2l0eTogMC42NTsgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3VuaXQtcHJpY2UgeyAgIGNvbG9yOiAjNGE0YTRhOyAgIHBhZGRpbmctdG9wOiA1cHg7ICAgZm9udC1zaXplOiAxMnB4OyAgIG9wYWNpdHk6IDAuODsgfSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtc2VsZWN0b3JzIHsgICB0ZXh0LWFsaWduOiBsZWZ0OyAgIGZvbnQtc2l6ZTogMTRweDsgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtc2VsZWN0b3JzIHsgICAgIHdpZHRoOiAxMDAlOyAgICAgbWF4LXdpZHRoOiAyODBweDsgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHkgeyAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQ7ICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQ7ICAgYm9yZGVyLXJhZGl1czogM3B4OyB9IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHksIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktaW5jcmVtZW50LCAuc2hvcGlmeS1idXlfX3F1YW50aXR5LWRlY3JlbWVudCB7ICAgYm9yZGVyLWNvbG9yOiAjZDNkYmUyOyAgIGxpbmUtaGVpZ2h0OiAxLjI7ICAgZm9udC1zaXplOiAxNXB4OyAgIGhlaWdodDogYXV0bzsgICBwYWRkaW5nLXRvcDogMTJweDsgICBwYWRkaW5nLWJvdHRvbTogMTJweDsgfSAuc2hvcGlmeS1idXlfX2J0biB7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9IC5zaG9waWZ5LWJ1eV9fYnRuLXdyYXBwZXIgeyAgIG1hcmdpbi10b3A6IDIwcHg7IH0gLnNob3BpZnktYnV5X19idG4uc2hvcGlmeS1idXlfX2Jlc2lkZS1xdWFudGl0eSB7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgIHZlcnRpY2FsLWFsaWduOiB0b3A7ICAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogMDsgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAwOyAgIGJvcmRlcjogMXB4IHNvbGlkIHRyYW5zcGFyZW50OyB9IC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSAuc2hvcGlmeS1idXlfX3F1YW50aXR5IHsgICAgIGJvcmRlci1yaWdodDogMDsgICAgIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAwOyAgICAgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6IDA7ICAgICBiYWNrZ3JvdW5kOiAjZmZmOyAgIH0gLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyIHsgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7ICAgfSAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgLnNob3BpZnktYnV5X19idG4td3JhcHBlciB7ICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOyAgICAgbWFyZ2luOiAwOyAgIH0gLnNob3BpZnktYnV5X19jYXJ0LWl0ZW1fX3F1YW50aXR5LWNvbnRhaW5lciB7ICAgbWFyZ2luLXRvcDogMjBweDsgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IH0gLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19idG4sICAgLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIsICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX2J0biwgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyIHsgICAgIG1hcmdpbjogMjBweCBhdXRvIDA7ICAgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX2J0bjpmaXJzdC1jaGlsZCwgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX2J0bjpmaXJzdC1jaGlsZCB7ICAgICBtYXJnaW4tdG9wOiAwOyAgIH0gLnNob3BpZnktYnV5X19sYXlvdXQtdmVydGljYWwgLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5LCAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSB7ICAgICBtYXJnaW46IDIwcHggYXV0byAwICAgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgLnNob3BpZnktYnV5X19idG4sICAgICAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHkgLnNob3BpZnktYnV5X19xdWFudGl0eS1jb250YWluZXIsICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSAuc2hvcGlmeS1idXlfX2J0biwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWwgLnNob3BpZnktYnV5X19idG4tYW5kLXF1YW50aXR5IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyIHsgICAgICAgbWFyZ2luOiAwIGF1dG87ICAgICB9IC5zaG9waWZ5LWJ1eV9fbGF5b3V0LXZlcnRpY2FsIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eTpmaXJzdC1jaGlsZCwgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCAuc2hvcGlmeS1idXlfX2J0bi1hbmQtcXVhbnRpdHk6Zmlyc3QtY2hpbGQgeyAgICAgbWFyZ2luOiAwIGF1dG87ICAgfSAuc2hvcGlmeS1idXlfX2xheW91dC12ZXJ0aWNhbCAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtaW1nLCAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdF9fdmFyaWFudC1pbWcgeyAgICAgbWF4LXdpZHRoOiAxMDAlOyAgIH0gQG1lZGlhIChtaW4td2lkdGg6IDUwMHB4KSB7ICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSB7ICAgICB0ZXh0LWFsaWduOiBsZWZ0OyAgICAgbWFyZ2luLWJvdHRvbTogMDsgICAgIG1hcmdpbi1sZWZ0OiAwICAgfSAgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0LWltZy13cmFwcGVyIHsgICAgICAgZmxvYXQ6IGxlZnQ7ICAgICAgIHdpZHRoOiA0MCU7ICAgICB9ICAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtdGl0bGUgeyAgICAgICB0ZXh0LWFsaWduOiBsZWZ0OyAgICAgfSAgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X190aXRsZSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXRpdGxlLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ByaWNlLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24sICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgPiAuc2hvcGlmeS1idXlfX2J0bi13cmFwcGVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSA+IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtc2VsZWN0b3JzIHsgICAgICAgbWFyZ2luLWxlZnQ6IGNhbGMoNDAlICsgMjVweCk7ICAgICB9IH0gQG1lZGlhIChtaW4td2lkdGg6IDY4MHB4KSB7ICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1pbWctd3JhcHBlciB7ICAgICAgIGZsb2F0OiBsZWZ0OyAgICAgICB3aWR0aDogNjAlOyAgICAgfSAgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X190aXRsZSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgLnNob3BpZnktYnV5X19wcm9kdWN0X192YXJpYW50LXRpdGxlLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ByaWNlLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3QtZGVzY3JpcHRpb24sICAgICAuc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsOm5vdCgubm8taW1hZ2UpIC5zaG9waWZ5LWJ1eV9fYnRuLWFuZC1xdWFudGl0eSwgICAgIC5zaG9waWZ5LWJ1eV9fbGF5b3V0LWhvcml6b250YWw6bm90KC5uby1pbWFnZSkgPiAuc2hvcGlmeS1idXlfX2J0bi13cmFwcGVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSA+IC5zaG9waWZ5LWJ1eV9fcXVhbnRpdHktY29udGFpbmVyLCAgICAgLnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbDpub3QoLm5vLWltYWdlKSAuc2hvcGlmeS1idXlfX3Byb2R1Y3RfX3ZhcmlhbnQtc2VsZWN0b3JzIHsgICAgICAgbWFyZ2luLWxlZnQ6IGNhbGMoNjAlICsgMjVweCk7ICAgICB9IH0gLm5vLWltYWdlIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdC1pbWctd3JhcHBlciB7ICAgICBkaXNwbGF5OiBub25lOyAgIH0gQC13ZWJraXQta2V5ZnJhbWVzIGRhc2ggeyAgIHRvIHsgICAgIHN0cm9rZS1kYXNob2Zmc2V0OiAwOyAgIH0gfSBAa2V5ZnJhbWVzIGRhc2ggeyAgIHRvIHsgICAgIHN0cm9rZS1kYXNob2Zmc2V0OiAwOyAgIH0gfSAuc2hvcGlmeS1idXlfX2Nhcm91c2VsIHsgICBmb250LXNpemU6IDA7ICAgdGV4dC1hbGlnbjogY2VudGVyOyAgIG1pbi1oZWlnaHQ6IDkwcHg7ICAgbWFyZ2luLWxlZnQ6IC0xNXB4OyAgIG1hcmdpbi10b3A6IDE1cHg7IH0gLnNob3BpZnktYnV5X19jYXJvdXNlbC1pdGVtIHsgICB3aWR0aDogY2FsYygxNi42NjYlIC0gMTVweCk7ICAgbWFyZ2luLWxlZnQ6IDE1cHg7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7ICAgY3Vyc29yOiBwb2ludGVyOyAgIHBvc2l0aW9uOiByZWxhdGl2ZTsgICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyOyAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsgICBwYWRkaW5nOiAwOyAgIGJvcmRlcjogbm9uZSB9IC5zaG9waWZ5LWJ1eV9fY2Fyb3VzZWwtaXRlbTpudGgtY2hpbGQobis3KSB7ICAgICBtYXJnaW4tdG9wOiAxNXB4OyAgIH0gLnNob3BpZnktYnV5X19jYXJvdXNlbC1pdGVtOmJlZm9yZSB7ICAgICBjb250ZW50OiAiIjsgICAgIGRpc3BsYXk6IGJsb2NrOyAgICAgcGFkZGluZy10b3A6IDEwMCU7ICAgfSAubWFpbi1pbWFnZS13cmFwcGVyIHsgICBwb3NpdGlvbjogcmVsYXRpdmU7IH0gLmNhcm91c2VsLWJ1dHRvbiB7ICAgcG9zaXRpb246IGFic29sdXRlOyAgIHdpZHRoOiA3NXB4OyAgIHRvcDogMDsgICBoZWlnaHQ6IDEwMCU7ICAgYm9yZGVyOiBub25lOyAgIGZvbnQtc2l6ZTogMDsgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgICBvcGFjaXR5OiAwLjQ7ICAgY3Vyc29yOiBwb2ludGVyIH0gLmNhcm91c2VsLWJ1dHRvbjpob3ZlciwgICAuY2Fyb3VzZWwtYnV0dG9uOmZvY3VzIHsgICAgIG9wYWNpdHk6IDAuOTsgICAgIG91dGxpbmU6IG5vbmU7ICAgfSAuY2Fyb3VzZWwtYnV0dG9uLWFycm93IHsgICB3aWR0aDogMjBweDsgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgbWFyZ2luLWxlZnQ6IDI1cHg7IH0gLmNhcm91c2VsLWJ1dHRvbi0tcHJldmlvdXMgeyAgIGxlZnQ6IDA7ICAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgxODBkZWcpOyAgICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMTgwZGVnKTsgfSAuY2Fyb3VzZWwtYnV0dG9uLS1uZXh0IHsgICByaWdodDogMDsgfSAuc2hvcGlmeS1idXlfX2Nhcm91c2VsLWl0ZW0tLXNlbGVjdGVkIHsgICBvcGFjaXR5OiAwLjQ7IH0gLnNob3BpZnktYnV5X19jb2xsZWN0aW9uIHsgICBvdmVyZmxvdzogaGlkZGVuOyB9IC5zaG9waWZ5LWJ1eV9fY29sbGVjdGlvbi1wcm9kdWN0cyB7ICAgbWFyZ2luLWxlZnQ6IC0xNXB4OyAgIHRleHQtYWxpZ246IGNlbnRlciB9IEBtZWRpYShtaW4td2lkdGg6IDYwMXB4KSB7IC5zaG9waWZ5LWJ1eV9fY29sbGVjdGlvbi1wcm9kdWN0cyB7ICAgICBtYXJnaW4tbGVmdDogLTIwcHggfSAgIH0gLnNob3BpZnktYnV5X19wcm9kdWN0IHsgICBtaW4td2lkdGg6IDI0MHB4OyAgIHdpZHRoOiBhdXRvOyAgIG1hcmdpbi1sZWZ0OiAxNXB4OyAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICB2ZXJ0aWNhbC1hbGlnbjogdG9wIH0gLnNob3BpZnktYnV5X19wcm9kdWN0ICsgLnNob3BpZnktYnV5X19wcm9kdWN0IHsgICAgIG1hcmdpbi10b3A6IDE1cHg7ICAgfSBAbWVkaWEobWluLXdpZHRoOiA2MDFweCkgeyAuc2hvcGlmeS1idXlfX3Byb2R1Y3QgeyAgICAgd2lkdGg6IGNhbGMoMjUlIC0gMjBweCk7ICAgICBtYXJnaW4tbGVmdDogMjBweDsgICAgIG1hcmdpbi1ib3R0b206IDUwcHggfSAgICAgIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdCArIC5zaG9waWZ5LWJ1eV9fcHJvZHVjdCB7ICAgICAgIG1hcmdpbi10b3A6IDA7ICAgICB9ICAgfSAuc2hvcGlmeS1idXlfX2J0bi5zaG9waWZ5LWJ1eV9fY29sbGVjdGlvbi1wYWdpbmF0aW9uLWJ1dHRvbiAgeyAgIGRpc3BsYXk6IG5vbmU7ICAgbWFyZ2luOiAxNXB4IGF1dG8gfSAuc2hvcGlmeS1idXlfX2J0bi5zaG9waWZ5LWJ1eV9fY29sbGVjdGlvbi1wYWdpbmF0aW9uLWJ1dHRvbi5pcy1hY3RpdmUgeyAgICAgZGlzcGxheTogYmxvY2s7ICAgfSAgJywKICAgIHRvZ2dsZTogJ2h0bWwsIGJvZHksIGgxLCBoMiwgaDMsIGg0LCBoNSwgcCB7ICAgcGFkZGluZzogMDsgICBtYXJnaW46IDA7IH0gKiB7ICAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94OyAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsgfSBib2R5LCBodG1sIHsgICBtaW4taGVpZ2h0OiAxMDAlOyB9IGh0bWwgeyAgIGZvbnQtZmFtaWx5OiAiSGVsdmV0aWNhIE5ldWUiLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOyAgIGZvbnQtc2l6ZTogMTRweDsgICBsaW5lLWhlaWdodDogMS4yOyAgIGNvbG9yOiAjNGM0YzRjOyAgIHRleHQtcmVuZGVyaW5nOiBvcHRpbWl6ZUxlZ2liaWxpdHk7ICAgLXdlYmtpdC1mb250LXNtb290aGluZzogYW50aWFsaWFzZWQ7ICAgLW1vei1vc3gtZm9udC1zbW9vdGhpbmc6IGdyYXlzY2FsZTsgfSBzZWxlY3QgeyAgIHRleHQtcmVuZGVyaW5nOiBhdXRvICFpbXBvcnRhbnQ7IH0gdWwgeyAgIGxpc3Qtc3R5bGU6IG5vbmU7ICAgcGFkZGluZy1sZWZ0OiAwOyAgIG1hcmdpbjogMDsgfSBpbWcgeyAgIGRpc3BsYXk6IGJsb2NrOyAgIG1heC13aWR0aDogMTAwJTsgfSBpbnB1dCB7ICAgLXdlYmtpdC1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7ICAgbWFyZ2luOiAwOyB9IC5jbGVhcmZpeDphZnRlciB7ICAgICBjb250ZW50OiAiIjsgICAgIGRpc3BsYXk6IHRhYmxlOyAgICAgY2xlYXI6IGJvdGg7ICAgfSAudmlzdWFsbHloaWRkZW4geyAgIGJvcmRlcjogMDsgICBoZWlnaHQ6IDFweDsgICBtYXJnaW46IC0xcHg7ICAgb3ZlcmZsb3c6IGhpZGRlbjsgICBwYWRkaW5nOiAwOyAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICB3aWR0aDogMXB4OyB9IC5jb21wb25lbnQtY29udGFpbmVyIHsgICBvdmVyZmxvdzogaGlkZGVuOyB9IC5zaG9waWZ5LWJ1eV9fdHlwZS0tY2VudGVyIHsgICB0ZXh0LWFsaWduOiBjZW50ZXI7IH0gLnNob3BpZnktYnV5LS12aXN1YWxseS1oaWRkZW4geyAgIHBvc2l0aW9uOiBhYnNvbHV0ZSAhaW1wb3J0YW50OyAgIGNsaXA6IHJlY3QoMXB4LCAxcHgsIDFweCwgMXB4KTsgICBwYWRkaW5nOjAgIWltcG9ydGFudDsgICBib3JkZXI6MCAhaW1wb3J0YW50OyAgIGhlaWdodDogMXB4ICFpbXBvcnRhbnQ7ICAgd2lkdGg6IDFweCAhaW1wb3J0YW50OyAgIG92ZXJmbG93OiBoaWRkZW47IH0gLnNob3BpZnktYnV5X19idG4geyAgIGNvbG9yOiAjZmZmOyAgIGZvbnQtc2l6ZTogMTVweDsgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNzhiNjU3OyAgIHBhZGRpbmc6IDEycHggNDBweDsgICBsZXR0ZXItc3BhY2luZzogLjNweDsgICBkaXNwbGF5OiBibG9jazsgICBib3JkZXItcmFkaXVzOiAzcHg7ICAgY3Vyc29yOiBwb2ludGVyOyAgIC13ZWJraXQtdHJhbnNpdGlvbjogYmFja2dyb3VuZCAyMDBtcyBlYXNlOyAgIHRyYW5zaXRpb246IGJhY2tncm91bmQgMjAwbXMgZWFzZTsgICBtYXgtd2lkdGg6IDEwMCU7ICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7ICAgb3ZlcmZsb3c6IGhpZGRlbjsgICBsaW5lLWhlaWdodDogMS4yOyAgIGJvcmRlcjogMDsgICAtbW96LWFwcGVhcmFuY2U6IG5vbmU7ICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lIH0gLnNob3BpZnktYnV5X19idG46aG92ZXIsICAgLnNob3BpZnktYnV5X19idG46Zm9jdXMgeyAgICAgYmFja2dyb3VuZC1jb2xvcjogIzVmOWQzZTsgICB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1wYXJlbnQgeyAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyAgIGJvcmRlcjogMDsgICBwYWRkaW5nOiAwOyAgIGN1cnNvcjogcG9pbnRlciB9IC5zaG9waWZ5LWJ1eV9fYnRuLS1wYXJlbnQ6aG92ZXIgLnByb2R1Y3RfX3ZhcmlhbnQtaW1nLCAuc2hvcGlmeS1idXlfX2J0bi0tcGFyZW50OmZvY3VzIC5wcm9kdWN0X192YXJpYW50LWltZyB7ICAgICAgIG9wYWNpdHk6IC43OyAgICAgfSAuc2hvcGlmeS1idXlfX2J0bi0tY2FydC10YWIgeyAgIHBhZGRpbmc6IDVweCAxMXB4OyAgIGJvcmRlci1yYWRpdXM6IDNweCAwIDAgM3B4OyAgIHBvc2l0aW9uOiBmaXhlZDsgICByaWdodDogMDsgICB0b3A6IDUwJTsgICAtd2Via2l0LXRyYW5zZm9ybTogdHJhbnNsYXRlKDEwMCUsIC01MCUpOyAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMTAwJSwgLTUwJSk7ICAgb3BhY2l0eTogMDsgICBtaW4td2lkdGg6IGluaGVyaXQ7ICAgd2lkdGg6IGF1dG87ICAgaGVpZ2h0OiBhdXRvOyAgIHotaW5kZXg6IDIxNDc0ODM2NDcgfSAuc2hvcGlmeS1idXlfX2J0bi0tY2FydC10YWIuaXMtYWN0aXZlIHsgICAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyAgICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7ICAgICBvcGFjaXR5OiAxOyAgIH0gLnNob3BpZnktYnV5X19idG5fX2NvdW50ZXIgeyAgIGRpc3BsYXk6IGJsb2NrOyAgIG1hcmdpbjogMCBhdXRvIDEwcHggYXV0bzsgICBmb250LXNpemU6IDE4cHg7IH0gLnNob3BpZnktYnV5X19pY29uLWNhcnQtLXNpZGUgeyAgIGhlaWdodDogMjBweDsgICB3aWR0aDogMjBweDsgfSAuc2hvcGlmeS1idXlfX2J0bltkaXNhYmxlZF0geyAgIGJhY2tncm91bmQtY29sb3I6ICM5OTk7ICAgcG9pbnRlci1ldmVudHM6IG5vbmU7IH0gLnNob3BpZnktYnV5X19idG4tLWNsb3NlIHsgICBwb3NpdGlvbjogYWJzb2x1dGU7ICAgcmlnaHQ6IDlweDsgICB0b3A6IDhweDsgICBmb250LXNpemU6IDM1cHg7ICAgY29sb3I6ICM3Njc2NzY7ICAgYm9yZGVyOiBub25lOyAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyAgIC13ZWJraXQtdHJhbnNpdGlvbjogY29sb3IgMTAwbXMgZWFzZSwgLXdlYmtpdC10cmFuc2Zvcm0gMTAwbXMgZWFzZTsgICB0cmFuc2l0aW9uOiBjb2xvciAxMDBtcyBlYXNlLCAtd2Via2l0LXRyYW5zZm9ybSAxMDBtcyBlYXNlOyAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAxMDBtcyBlYXNlLCBjb2xvciAxMDBtcyBlYXNlOyAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAxMDBtcyBlYXNlLCBjb2xvciAxMDBtcyBlYXNlLCAtd2Via2l0LXRyYW5zZm9ybSAxMDBtcyBlYXNlOyAgIGN1cnNvcjogcG9pbnRlcjsgICBmb250LWZhbWlseTogIkhlbHZldGljYSBOZXVlIiwgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsgICBwYWRkaW5nLXJpZ2h0OiA5cHggfSAuc2hvcGlmeS1idXlfX2J0bi0tY2xvc2U6aG92ZXIgeyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHNjYWxlKDEuMik7ICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMS4yKTsgICAgIGNvbG9yOiBoc2woMCwgMCUsIDQxLjI3NDUwOTgwMzklKTsgICB9IC5zaG9waWZ5LWJ1eV9fY2FydC10b2dnbGUtd3JhcHBlciB7ICAgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9IC5zaG9waWZ5LWJ1eV9fY2FydC10b2dnbGUgeyAgIGJhY2tncm91bmQtY29sb3I6ICM3OGI2NTc7ICAgY29sb3I6ICNmZmY7ICAgYm9yZGVyLXJhZGl1czogM3B4IDAgMCAzcHg7OyAgIHBhZGRpbmc6IDhweCAxMHB4OyAgIHRleHQtYWxpZ246IGNlbnRlcjsgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgbWluLXdpZHRoOiA0NnB4OyAgIG1hcmdpbi1yaWdodDogMDsgICBjdXJzb3I6IHBvaW50ZXI7ICAgLXdlYmtpdC10cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDIwMG1zIGVhc2U7ICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAyMDBtcyBlYXNlIH0gLnNob3BpZnktYnV5X19jYXJ0LXRvZ2dsZTpob3ZlciB7ICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNWY5ZDNlOyAgIH0gLnNob3BpZnktYnV5X19jYXJ0LXRvZ2dsZV9fY291bnQgeyAgIGZvbnQtc2l6ZTogMThweDsgICBtYXJnaW4tYm90dG9tOiAxMHB4OyB9IC5zaG9waWZ5LWJ1eV9faWNvbi1jYXJ0X19ncm91cCB7ICAgZmlsbDogI2ZmZjsgfSAuaXMtaW5saW5lIC5zaG9waWZ5LWJ1eV9faWNvbi1jYXJ0LCAgIC5pcy1pbmxpbmUgLnNob3BpZnktYnV5X19jYXJ0LXRvZ2dsZV9fdGl0bGUsICAgLmlzLWlubGluZSAuc2hvcGlmeS1idXlfX2NhcnQtdG9nZ2xlX19jb3VudCB7ICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyAgIH0gLmlzLWlubGluZSB7ICAgIC5zaG9waWZ5LWJ1eV9faWNvbi1jYXJ0IHsgICAgIG1hcmdpbi1yaWdodDogNXB4OyAgIH0gICAgLnNob3BpZnktYnV5X19jYXJ0LXRvZ2dsZV9fdGl0bGUgeyAgICAgZm9udC1zaXplOiAxNnB4OyAgICAgZm9udC13ZWlnaHQ6IG5vcm1hbDsgICB9ICAgIC5zaG9waWZ5LWJ1eV9fY2FydC10b2dnbGVfX2NvdW50IHsgICAgIG1hcmdpbi1sZWZ0OiAyMXB4OyAgICAgbWFyZ2luLWJvdHRvbTogMDsgICAgIHBvc2l0aW9uOiByZWxhdGl2ZSAgIH0gICAgICAuc2hvcGlmeS1idXlfX2NhcnQtdG9nZ2xlX19jb3VudDpiZWZvcmUgeyAgICAgICBjb250ZW50OiAiIjsgICAgICAgZGlzcGxheTogYmxvY2s7ICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICAgICAgbGVmdDogLTEycHg7ICAgICAgIGhlaWdodDogMTAwJTsgICAgICAgd2lkdGg6IDFweDsgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsgICAgICAgb3BhY2l0eTogMC4zOyAgICAgfSB9IC5pcy1pbmxpbmUuc2hvcGlmeS1idXlfX2NhcnQtdG9nZ2xlIHsgICAgIGJvcmRlci1yYWRpdXM6IDNweDsgICAgIHBhZGRpbmc6IDVweCAxMHB4OyAgIH0gJwogIH0sCiAgICAgIGRlbGVnYXRlRXZlbnRTcGxpdHRlciA9IC9eKFxTKylccyooLiopJC8sCiAgICAgIEVTQ19LRVkgPSAyNywKICAgICAgVmlldyA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFZpZXcoY29tcG9uZW50KSB7CiAgICAgIHRoaXMuY29tcG9uZW50ID0gY29tcG9uZW50LCB0aGlzLmlmcmFtZSA9IG51bGwsIHRoaXMubm9kZSA9IHRoaXMuY29tcG9uZW50Lm5vZGUsIHRoaXMudGVtcGxhdGUgPSBuZXcgVGVtcGxhdGUodGhpcy5jb21wb25lbnQub3B0aW9ucy50ZW1wbGF0ZXMsIHRoaXMuY29tcG9uZW50Lm9wdGlvbnMuY29udGVudHMsIHRoaXMuY29tcG9uZW50Lm9wdGlvbnMub3JkZXIpLCB0aGlzLmV2ZW50c0JvdW5kID0gITE7CiAgICB9CgogICAgdmFyIF9wcm90byA9IFZpZXcucHJvdG90eXBlOwogICAgcmV0dXJuIF9wcm90by5pbml0ID0gZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50Lm5vZGUuY2xhc3NOYW1lICs9ICIgc2hvcGlmeS1idXktZnJhbWUgc2hvcGlmeS1idXktZnJhbWUtLSIuY29uY2F0KHRoaXMuY29tcG9uZW50LnR5cGVLZXkpLCB0aGlzLmlmcmFtZSB8fCAhdGhpcy5jb21wb25lbnQub3B0aW9ucy5pZnJhbWUgPyBQcm9taXNlLnJlc29sdmUodGhpcy5pZnJhbWUpIDogKHRoaXMuaWZyYW1lID0gbmV3IGlmcmFtZSh0aGlzLmNvbXBvbmVudC5ub2RlLCB7CiAgICAgICAgY2xhc3NlczogdGhpcy5jb21wb25lbnQuY2xhc3NlcywKICAgICAgICBjdXN0b21TdHlsZXM6IHRoaXMuY29tcG9uZW50LnN0eWxlcywKICAgICAgICBzdHlsZXNoZWV0OiBzdHlsZXNbdGhpcy5jb21wb25lbnQudHlwZUtleV0sCiAgICAgICAgYnJvd3NlckZlYXR1cmVzOiB0aGlzLmNvbXBvbmVudC5wcm9wcy5icm93c2VyRmVhdHVyZXMsCiAgICAgICAgZ29vZ2xlRm9udHM6IHRoaXMuY29tcG9uZW50Lmdvb2dsZUZvbnRzLAogICAgICAgIG5hbWU6IHRoaXMuY29tcG9uZW50Lm5hbWUsCiAgICAgICAgd2lkdGg6ICJ2ZXJ0aWNhbCIgPT09IHRoaXMuY29tcG9uZW50Lm9wdGlvbnMubGF5b3V0ID8gdGhpcy5jb21wb25lbnQub3B0aW9ucy53aWR0aCA6IG51bGwKICAgICAgfSksIHRoaXMuaWZyYW1lLmFkZENsYXNzKHRoaXMuY2xhc3NOYW1lKSwgdGhpcy5pZnJhbWUubG9hZCgpKTsKICAgIH0sIF9wcm90by5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLmNvbXBvbmVudC5fdXNlckV2ZW50KCJiZWZvcmVSZW5kZXIiKTsKCiAgICAgIHZhciBodG1sID0gdGhpcy50ZW1wbGF0ZS5yZW5kZXIoewogICAgICAgIGRhdGE6IHRoaXMuY29tcG9uZW50LnZpZXdEYXRhCiAgICAgIH0sIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLndyYXBUZW1wbGF0ZShkYXRhKTsKICAgICAgfSk7CiAgICAgIHRoaXMud3JhcHBlciB8fCAodGhpcy53cmFwcGVyID0gdGhpcy5fY3JlYXRlV3JhcHBlcigpKSwgdGhpcy51cGRhdGVOb2RlKHRoaXMud3JhcHBlciwgaHRtbCksIHRoaXMucmVzaXplKCksIHRoaXMuY29tcG9uZW50Ll91c2VyRXZlbnQoImFmdGVyUmVuZGVyIik7CiAgICB9LCBfcHJvdG8uZGVsZWdhdGVFdmVudHMgPSBmdW5jdGlvbiBkZWxlZ2F0ZUV2ZW50cygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmV2ZW50c0JvdW5kIHx8ICh0aGlzLmNsb3NlQ29tcG9uZW50c09uRXNjKCksIE9iamVjdC5rZXlzKHRoaXMuY29tcG9uZW50LkRPTUV2ZW50cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIF9rZXkkbWF0Y2gsCiAgICAgICAgICAgIF9rZXkkbWF0Y2gyID0gX3NsaWNlZFRvQXJyYXkoa2V5Lm1hdGNoKGRlbGVnYXRlRXZlbnRTcGxpdHRlciksIDMpLAogICAgICAgICAgICBldmVudE5hbWUgPSBfa2V5JG1hdGNoMlsxXSwKICAgICAgICAgICAgc2VsZWN0b3JTdHJpbmcgPSBfa2V5JG1hdGNoMlsyXTsKCiAgICAgICAgc2VsZWN0b3JTdHJpbmcgPyBfdGhpczIuX29uKGV2ZW50TmFtZSwgc2VsZWN0b3JTdHJpbmcsIGZ1bmN0aW9uIChldnQsIHRhcmdldCkgewogICAgICAgICAgX3RoaXMyLmNvbXBvbmVudC5ET01FdmVudHNba2V5XS5jYWxsKF90aGlzMiwgZXZ0LCB0YXJnZXQpOwogICAgICAgIH0pIDogX3RoaXMyLndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgICBfdGhpczIuY29tcG9uZW50LkRPTUV2ZW50c1trZXldLmNhbGwoX3RoaXMyLCBldnQpOwogICAgICAgIH0pOwogICAgICB9KSwgdGhpcy5pZnJhbWUgJiYgKHRoaXMuaWZyYW1lLmVsLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczIuaWZyYW1lLmVsLm9ubG9hZCA9IG51bGwsIF90aGlzMi5yZWxvYWRJZnJhbWUoKTsKICAgICAgfSksIHRoaXMuZXZlbnRzQm91bmQgPSAhMCk7CiAgICB9LCBfcHJvdG8ucmVsb2FkSWZyYW1lID0gZnVuY3Rpb24gcmVsb2FkSWZyYW1lKCkgewogICAgICB0aGlzLm5vZGUucmVtb3ZlQ2hpbGQodGhpcy5pZnJhbWUuZWwpLCB0aGlzLndyYXBwZXIgPSBudWxsLCB0aGlzLmlmcmFtZSA9IG51bGwsIHRoaXMuY29tcG9uZW50LmluaXQoKTsKICAgIH0sIF9wcm90by5hcHBlbmQgPSBmdW5jdGlvbiBhcHBlbmQod3JhcHBlcikgewogICAgICB0aGlzLmlmcmFtZSA/IHRoaXMuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh3cmFwcGVyKSA6IHRoaXMuY29tcG9uZW50Lm5vZGUuYXBwZW5kQ2hpbGQod3JhcHBlcik7CiAgICB9LCBfcHJvdG8uYWRkQ2xhc3MgPSBmdW5jdGlvbiBhZGRDbGFzcyhjbGFzc05hbWUpIHsKICAgICAgdGhpcy5pZnJhbWUgPyB0aGlzLmlmcmFtZS5hZGRDbGFzcyhjbGFzc05hbWUpIDogYWRkQ2xhc3NUb0VsZW1lbnQoY2xhc3NOYW1lLCB0aGlzLmNvbXBvbmVudC5ub2RlKTsKICAgIH0sIF9wcm90by5yZW1vdmVDbGFzcyA9IGZ1bmN0aW9uIHJlbW92ZUNsYXNzKGNsYXNzTmFtZSkgewogICAgICB0aGlzLmlmcmFtZSA/IHRoaXMuaWZyYW1lLnJlbW92ZUNsYXNzKGNsYXNzTmFtZSkgOiByZW1vdmVDbGFzc0Zyb21FbGVtZW50KGNsYXNzTmFtZSwgdGhpcy5jb21wb25lbnQubm9kZSk7CiAgICB9LCBfcHJvdG8uZGVzdHJveSA9IGZ1bmN0aW9uIGRlc3Ryb3koKSB7CiAgICAgIHRoaXMubm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMubm9kZSk7CiAgICB9LCBfcHJvdG8ucmVuZGVyQ2hpbGQgPSBmdW5jdGlvbiByZW5kZXJDaGlsZChjbGFzc05hbWUsIHRlbXBsYXRlKSB7CiAgICAgIHZhciBzZWxlY3RvciA9ICIuIi5jb25jYXQoY2xhc3NOYW1lLnNwbGl0KCIgIikuam9pbigiLiIpKSwKICAgICAgICAgIG5vZGUgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcihzZWxlY3RvciksCiAgICAgICAgICBodG1sID0gdGVtcGxhdGUucmVuZGVyKHsKICAgICAgICBkYXRhOiB0aGlzLmNvbXBvbmVudC52aWV3RGF0YQogICAgICB9KTsKICAgICAgdGhpcy51cGRhdGVOb2RlKG5vZGUsIGh0bWwpOwogICAgfSwgX3Byb3RvLnVwZGF0ZU5vZGUgPSBmdW5jdGlvbiB1cGRhdGVOb2RlKG5vZGUsIGh0bWwpIHsKICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBkaXYuaW5uZXJIVE1MID0gaHRtbCwgbW9ycGhkb20obm9kZSwgZGl2LmZpcnN0RWxlbWVudENoaWxkKTsKICAgIH0sIF9wcm90by53cmFwVGVtcGxhdGUgPSBmdW5jdGlvbiB3cmFwVGVtcGxhdGUoaHRtbCkgewogICAgICByZXR1cm4gJzxkaXYgY2xhc3M9IicuY29uY2F0KHRoaXMuY29tcG9uZW50LmNsYXNzZXNbdGhpcy5jb21wb25lbnQudHlwZUtleV1bdGhpcy5jb21wb25lbnQudHlwZUtleV0sICciPicpLmNvbmNhdChodG1sLCAiPC9kaXY+Iik7CiAgICB9LCBfcHJvdG8ucmVzaXplID0gZnVuY3Rpb24gcmVzaXplKCkgewogICAgICB0aGlzLmlmcmFtZSAmJiB0aGlzLndyYXBwZXIgJiYgKHRoaXMuc2hvdWxkUmVzaXplWCAmJiB0aGlzLl9yZXNpemVYKCksIHRoaXMuc2hvdWxkUmVzaXplWSAmJiB0aGlzLl9yZXNpemVZKCkpOwogICAgfSwgX3Byb3RvLnNldEZvY3VzID0gZnVuY3Rpb24gc2V0Rm9jdXMoKSB7CiAgICAgIHZhciBmb2N1c2FibGUgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgiYSwgYnV0dG9uLCBpbnB1dCwgc2VsZWN0IilbMF07CiAgICAgIGZvY3VzYWJsZSAmJiBmb2N1c2FibGUuZm9jdXMoKTsKICAgIH0sIF9wcm90by5jbG9zZUNvbXBvbmVudHNPbkVzYyA9IGZ1bmN0aW9uIGNsb3NlQ29tcG9uZW50c09uRXNjKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuaWZyYW1lICYmIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIGZ1bmN0aW9uIChldnQpIHsKICAgICAgICAyNyA9PT0gZXZ0LmtleUNvZGUgJiYgKF90aGlzMy5jb21wb25lbnQucHJvcHMuY2xvc2VNb2RhbCgpLCBfdGhpczMuY29tcG9uZW50LnByb3BzLmNsb3NlQ2FydCgpKTsKICAgICAgfSk7CiAgICB9LCBfcHJvdG8uYW5pbWF0ZVJlbW92ZU5vZGUgPSBmdW5jdGlvbiBhbmltYXRlUmVtb3ZlTm9kZShpZCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpcywKICAgICAgICAgIGVsID0gdGhpcy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CgogICAgICBhZGRDbGFzc1RvRWxlbWVudCgiaXMtaGlkZGVuIiwgZWwpLCB0aGlzLmNvbXBvbmVudC5wcm9wcy5icm93c2VyRmVhdHVyZXMuYW5pbWF0aW9uID8gZWwuYWRkRXZlbnRMaXN0ZW5lcigiYW5pbWF0aW9uZW5kIiwgZnVuY3Rpb24gKCkgewogICAgICAgIGVsLnBhcmVudE5vZGUgJiYgX3RoaXM0LnJlbW92ZU5vZGUoZWwpOwogICAgICB9KSA6IHRoaXMucmVtb3ZlTm9kZShlbCk7CiAgICB9LCBfcHJvdG8ucmVtb3ZlTm9kZSA9IGZ1bmN0aW9uIHJlbW92ZU5vZGUoZWwpIHsKICAgICAgZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbCksIHRoaXMucmVuZGVyKCk7CiAgICB9LCBfcHJvdG8uX2NyZWF0ZVdyYXBwZXIgPSBmdW5jdGlvbiBfY3JlYXRlV3JhcHBlcigpIHsKICAgICAgdmFyIHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgcmV0dXJuIHdyYXBwZXIuY2xhc3NOYW1lID0gdGhpcy5jb21wb25lbnQuY2xhc3Nlc1t0aGlzLmNvbXBvbmVudC50eXBlS2V5XVt0aGlzLmNvbXBvbmVudC50eXBlS2V5XSwgdGhpcy5hcHBlbmQod3JhcHBlciksIHdyYXBwZXI7CiAgICB9LCBfcHJvdG8uX3Jlc2l6ZVggPSBmdW5jdGlvbiBfcmVzaXplWCgpIHsKICAgICAgdGhpcy5pZnJhbWUuZWwuc3R5bGUud2lkdGggPSAiIi5jb25jYXQodGhpcy5kb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoLCAicHgiKTsKICAgIH0sIF9wcm90by5fcmVzaXplWSA9IGZ1bmN0aW9uIF9yZXNpemVZKHZhbHVlKSB7CiAgICAgIHZhciBuZXdIZWlnaHQgPSB2YWx1ZSB8fCB0aGlzLm91dGVySGVpZ2h0OwogICAgICB0aGlzLmlmcmFtZS5lbC5zdHlsZS5oZWlnaHQgPSBuZXdIZWlnaHQ7CiAgICB9LCBfcHJvdG8uX29uID0gZnVuY3Rpb24gX29uKGV2ZW50TmFtZSwgc2VsZWN0b3IsIGZuKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgdmFyIHBvc3NpYmxlVGFyZ2V0cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKF90aGlzNS53cmFwcGVyLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKSwKICAgICAgICAgICAgdGFyZ2V0ID0gZXZ0LnRhcmdldDsKICAgICAgICBwb3NzaWJsZVRhcmdldHMuZm9yRWFjaChmdW5jdGlvbiAocG9zc2libGVUYXJnZXQpIHsKICAgICAgICAgIGZvciAodmFyIGVsID0gdGFyZ2V0OyBlbCAmJiBlbCAhPT0gX3RoaXM1LndyYXBwZXI7KSB7CiAgICAgICAgICAgIGlmIChlbCA9PT0gcG9zc2libGVUYXJnZXQpIHJldHVybiBmbi5jYWxsKHBvc3NpYmxlVGFyZ2V0LCBldnQsIHBvc3NpYmxlVGFyZ2V0KTsKICAgICAgICAgICAgZWwgPSBlbC5wYXJlbnROb2RlOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBlbDsKICAgICAgICB9KTsKICAgICAgfSwgImJsdXIiID09PSBldmVudE5hbWUpOwogICAgfSwgX2NyZWF0ZUNsYXNzKFZpZXcsIFt7CiAgICAgIGtleTogIm91dGVySGVpZ2h0IiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy53cmFwcGVyLCAiIik7CiAgICAgICAgaWYgKCFzdHlsZSkgcmV0dXJuICIiLmNvbmNhdCh0aGlzLndyYXBwZXIuY2xpZW50SGVpZ2h0LCAicHgiKTsKICAgICAgICB2YXIgaGVpZ2h0ID0gc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgiaGVpZ2h0Iik7CgogICAgICAgIGlmICghaGVpZ2h0IHx8ICIwcHgiID09PSBoZWlnaHQgfHwgImF1dG8iID09PSBoZWlnaHQpIHsKICAgICAgICAgIHZhciBjbGllbnRIZWlnaHQgPSB0aGlzLndyYXBwZXIuY2xpZW50SGVpZ2h0OwogICAgICAgICAgaGVpZ2h0ID0gc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgiaGVpZ2h0IikgfHwgIiIuY29uY2F0KGNsaWVudEhlaWdodCwgInB4Iik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaGVpZ2h0OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNsYXNzTmFtZSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzaG91bGRSZXNpemVYIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICExOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInNob3VsZFJlc2l6ZVkiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gITE7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZG9jdW1lbnQiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5pZnJhbWUgPyB0aGlzLmlmcmFtZS5kb2N1bWVudCA6IHdpbmRvdy5kb2N1bWVudDsKICAgICAgfQogICAgfV0pLCBWaWV3OwogIH0oKSwKICAgICAgVXBkYXRlciA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFVwZGF0ZXIoY29tcG9uZW50KSB7CiAgICAgIHRoaXMuY29tcG9uZW50ID0gY29tcG9uZW50OwogICAgfQoKICAgIHZhciBfcHJvdG87CgogICAgcmV0dXJuIFVwZGF0ZXIucHJvdG90eXBlLnVwZGF0ZUNvbmZpZyA9IGZ1bmN0aW9uIHVwZGF0ZUNvbmZpZyhjb25maWcpIHsKICAgICAgdGhpcy5jb21wb25lbnQuY29uZmlnID0gbWVyZ2UodGhpcy5jb21wb25lbnQuY29uZmlnLCBjb25maWcub3B0aW9ucyksIHRoaXMuY29tcG9uZW50LnZpZXcudGVtcGxhdGUgPSBuZXcgVGVtcGxhdGUodGhpcy5jb21wb25lbnQub3B0aW9ucy50ZW1wbGF0ZXMsIHRoaXMuY29tcG9uZW50Lm9wdGlvbnMuY29udGVudHMsIHRoaXMuY29tcG9uZW50Lm9wdGlvbnMub3JkZXIpLCB0aGlzLmNvbXBvbmVudC52aWV3LmlmcmFtZSAmJiB0aGlzLmNvbXBvbmVudC52aWV3LmlmcmFtZS51cGRhdGVTdHlsZXModGhpcy5jb21wb25lbnQuc3R5bGVzLCB0aGlzLmNvbXBvbmVudC5nb29nbGVGb250cyksIHRoaXMuY29tcG9uZW50LnZpZXcucmVuZGVyKCksIHRoaXMuY29tcG9uZW50LnZpZXcucmVzaXplKCk7CiAgICB9LCBVcGRhdGVyOwogIH0oKTsKCiAgZnVuY3Rpb24gbW9uZXlGb3JtYXQoKSB7CiAgICB2YXIgZm9ybWF0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMF0gPyBhcmd1bWVudHNbMF0gOiAiJHt7YW1vdW50fX0iOwogICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChmb3JtYXQpOwogIH0KCiAgdmFyIENvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIENvbXBvbmVudChjb25maWcsIHByb3BzKSB7CiAgICAgIHRoaXMuaWQgPSBjb25maWcuaWQsIHRoaXMuc3RvcmVmcm9udElkID0gY29uZmlnLnN0b3JlZnJvbnRJZCwgdGhpcy5oYW5kbGUgPSBjb25maWcuaGFuZGxlLCB0aGlzLm5vZGUgPSBjb25maWcubm9kZSwgdGhpcy5nbG9iYWxDb25maWcgPSB7CiAgICAgICAgZGVidWc6IGNvbmZpZy5kZWJ1ZywKICAgICAgICBtb25leUZvcm1hdDogbW9uZXlGb3JtYXQoY29uZmlnLm1vbmV5Rm9ybWF0KSwKICAgICAgICBjYXJ0Tm9kZTogY29uZmlnLmNhcnROb2RlLAogICAgICAgIG1vZGFsTm9kZTogY29uZmlnLm1vZGFsTm9kZSwKICAgICAgICB0b2dnbGVzOiBjb25maWcudG9nZ2xlcwogICAgICB9LCB0aGlzLmNvbmZpZyA9IG1lcmdlKHt9LCBkZWZhdWx0cywgY29uZmlnLm9wdGlvbnMgfHwge30pLCB0aGlzLnByb3BzID0gcHJvcHMsIHRoaXMubW9kZWwgPSB7fSwgdGhpcy51cGRhdGVyID0gbmV3IFVwZGF0ZXIodGhpcyksIHRoaXMudmlldyA9IG5ldyBWaWV3KHRoaXMpOwogICAgfQoKICAgIHZhciBfcHJvdG8gPSBDb21wb25lbnQucHJvdG90eXBlOwogICAgcmV0dXJuIF9wcm90by5pbml0ID0gZnVuY3Rpb24gaW5pdChkYXRhKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gdGhpcy5fdXNlckV2ZW50KCJiZWZvcmVJbml0IiksIHRoaXMudmlldy5pbml0KCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLnNldHVwTW9kZWwoZGF0YSk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKG1vZGVsKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm1vZGVsID0gbW9kZWwsIF90aGlzLnZpZXcucmVuZGVyKCksIF90aGlzLnZpZXcuZGVsZWdhdGVFdmVudHMoKSwgX3RoaXMuX3VzZXJFdmVudCgiYWZ0ZXJJbml0IiksIF90aGlzOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgdGhyb3cgZXJyLm1lc3NhZ2UuaW5kZXhPZigiTm90IEZvdW5kIikgPiAtMSAmJiBsb2dOb3RGb3VuZChfdGhpcyksIGVycjsKICAgICAgfSk7CiAgICB9LCBfcHJvdG8uc2V0dXBNb2RlbCA9IGZ1bmN0aW9uIHNldHVwTW9kZWwoZGF0YSkgewogICAgICByZXR1cm4gZGF0YSA/IFByb21pc2UucmVzb2x2ZShkYXRhKSA6IHRoaXMuZmV0Y2hEYXRhKCk7CiAgICB9LCBfcHJvdG8udXBkYXRlQ29uZmlnID0gZnVuY3Rpb24gdXBkYXRlQ29uZmlnKGNvbmZpZykgewogICAgICByZXR1cm4gdGhpcy51cGRhdGVyLnVwZGF0ZUNvbmZpZyhjb25maWcpOwogICAgfSwgX3Byb3RvLmRlc3Ryb3kgPSBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICB0aGlzLnZpZXcuZGVzdHJveSgpOwogICAgfSwgX3Byb3RvLl91c2VyRXZlbnQgPSBmdW5jdGlvbiBfdXNlckV2ZW50KG1ldGhvZE5hbWUpIHsKICAgICAgdGhpcy5nbG9iYWxDb25maWcuZGVidWcgJiYgbG9nZ2VyLmluZm8oIkVWRU5UOiAiLmNvbmNhdChtZXRob2ROYW1lLCAiICgiKS5jb25jYXQodGhpcy50eXBlS2V5LCAiKSIpKSwgaXNGdW5jdGlvbih0aGlzLmV2ZW50c1ttZXRob2ROYW1lXSkgJiYgdGhpcy5ldmVudHNbbWV0aG9kTmFtZV0uY2FsbCh0aGlzLCB0aGlzKTsKICAgIH0sIF9jcmVhdGVDbGFzcyhDb21wb25lbnQsIFt7CiAgICAgIGtleTogIm5hbWUiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgdW5pcXVlSGFuZGxlID0gIiI7CiAgICAgICAgcmV0dXJuIHRoaXMuaWQgPyB1bmlxdWVIYW5kbGUgPSAiLSIuY29uY2F0KHRoaXMuaWQpIDogdGhpcy5oYW5kbGUgJiYgKHVuaXF1ZUhhbmRsZSA9ICItIi5jb25jYXQodGhpcy5oYW5kbGUpKSwgImZyYW1lLSIuY29uY2F0KHRoaXMudHlwZUtleSkuY29uY2F0KHVuaXF1ZUhhbmRsZSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAib3B0aW9ucyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiBtZXJnZSh7fSwgdGhpcy5jb25maWdbdGhpcy50eXBlS2V5XSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiRE9NRXZlbnRzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5ET01FdmVudHMgfHwge307CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZXZlbnRzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5ldmVudHMgfHwge307CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiY2xhc3NlcyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLm1hbmlmZXN0LmZpbHRlcihmdW5jdGlvbiAoY29tcG9uZW50KSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLmNvbmZpZ1tjb21wb25lbnRdLmNsYXNzZXM7CiAgICAgICAgfSkucmVkdWNlKGZ1bmN0aW9uIChoYXNoLCBjb21wb25lbnQpIHsKICAgICAgICAgIHJldHVybiBoYXNoW2NvbXBvbmVudF0gPSBfdGhpczIuY29uZmlnW2NvbXBvbmVudF0uY2xhc3NlcywgaGFzaDsKICAgICAgICB9LCB7fSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2VsZWN0b3JzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMubWFuaWZlc3QuZmlsdGVyKGZ1bmN0aW9uIChjb21wb25lbnQpIHsKICAgICAgICAgIHJldHVybiBfdGhpczMuY29uZmlnW2NvbXBvbmVudF0uY2xhc3NlczsKICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGhhc2gsIGNvbXBvbmVudCkgewogICAgICAgICAgcmV0dXJuIGhhc2hbY29tcG9uZW50XSA9IE9iamVjdC5rZXlzKF90aGlzMy5jb25maWdbY29tcG9uZW50XS5jbGFzc2VzKS5yZWR1Y2UoZnVuY3Rpb24gKGNsYXNzZXMsIGNsYXNzS2V5KSB7CiAgICAgICAgICAgIHJldHVybiBjbGFzc2VzW2NsYXNzS2V5XSA9ICIuIi5jb25jYXQoX3RoaXMzLmNsYXNzZXNbY29tcG9uZW50XVtjbGFzc0tleV0uc3BsaXQoIiAiKS5qb2luKCIuIikpLCBjbGFzc2VzOwogICAgICAgICAgfSwge30pLCBoYXNoOwogICAgICAgIH0sIHt9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzdHlsZXMiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5tYW5pZmVzdC5maWx0ZXIoZnVuY3Rpb24gKGNvbXBvbmVudCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNC5jb25maWdbY29tcG9uZW50XS5zdHlsZXM7CiAgICAgICAgfSkucmVkdWNlKGZ1bmN0aW9uIChoYXNoLCBjb21wb25lbnQpIHsKICAgICAgICAgIHJldHVybiBoYXNoW2NvbXBvbmVudF0gPSBfdGhpczQuY29uZmlnW2NvbXBvbmVudF0uc3R5bGVzLCBoYXNoOwogICAgICAgIH0sIHt9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnb29nbGVGb250cyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLm1hbmlmZXN0LmZpbHRlcihmdW5jdGlvbiAoY29tcG9uZW50KSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM1LmNvbmZpZ1tjb21wb25lbnRdLmdvb2dsZUZvbnRzOwogICAgICAgIH0pLnJlZHVjZShmdW5jdGlvbiAoZm9udHMsIGNvbXBvbmVudCkgewogICAgICAgICAgcmV0dXJuIGZvbnRzLmNvbmNhdChfdGhpczUuY29uZmlnW2NvbXBvbmVudF0uZ29vZ2xlRm9udHMpOwogICAgICAgIH0sIFtdKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ2aWV3RGF0YSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiBtZXJnZSh0aGlzLm1vZGVsLCB0aGlzLm9wdGlvbnMudmlld0RhdGEsIHsKICAgICAgICAgIGNsYXNzZXM6IHRoaXMuY2xhc3NlcywKICAgICAgICAgIHRleHQ6IHRoaXMub3B0aW9ucy50ZXh0CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAibW9ycGhDYWxsYmFja3MiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgb25CZWZvcmVFbFVwZGF0ZWQ6IGZ1bmN0aW9uIG9uQmVmb3JlRWxVcGRhdGVkKGZyb21FbCwgdG9FbCkgewogICAgICAgICAgICByZXR1cm4gIklNRyIgIT09IGZyb21FbC50YWdOYW1lIHx8IGZyb21FbC5zcmMgIT09IHRvRWwuZ2V0QXR0cmlidXRlKCJkYXRhLXNyYyIpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KICAgIH1dKSwgQ29tcG9uZW50OwogIH0oKSwKICAgICAgQ2hlY2tvdXROYXZpZ2F0b3IgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBDaGVja291dE5hdmlnYXRvcihjb25maWcpIHsKICAgICAgdGhpcy5jb25maWcgPSBjb25maWc7CiAgICB9CgogICAgdmFyIF9wcm90bzsKCiAgICByZXR1cm4gQ2hlY2tvdXROYXZpZ2F0b3IucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiBvcGVuKHVybCkgewogICAgICB0aGlzLmNvbmZpZy5jYXJ0LnBvcHVwID8gd2luZG93Lm9wZW4odXJsLCAiY2hlY2tvdXQiLCB0aGlzLnBhcmFtcykgOiB3aW5kb3cub3Blbih1cmwsICJjaGVja291dCIpOwogICAgfSwgX2NyZWF0ZUNsYXNzKENoZWNrb3V0TmF2aWdhdG9yLCBbewogICAgICBrZXk6ICJwYXJhbXMiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgY29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb25maWcud2luZG93LCB7CiAgICAgICAgICBsZWZ0OiB3aW5kb3cub3V0ZXJXaWR0aCAvIDIgLSAyMDAsCiAgICAgICAgICB0b3A6IHdpbmRvdy5vdXRlckhlaWdodCAvIDIgLSAzMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoY29uZmlnKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywga2V5KSB7CiAgICAgICAgICByZXR1cm4gIiIuY29uY2F0KGFjYykuY29uY2F0KGtleSwgIj0iKS5jb25jYXQoY29uZmlnW2tleV0sICIsIik7CiAgICAgICAgfSwgIiIpOwogICAgICB9CiAgICB9XSksIENoZWNrb3V0TmF2aWdhdG9yOwogIH0oKSwKICAgICAgd2luZG93VXRpbHNfbG9jYXRpb24gPSBmdW5jdGlvbiBsb2NhdGlvbigpIHsKICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24uaHJlZjsKICB9LAogICAgICBwbGFjZWhvbGRlclJlZ2V4ID0gL1x7XHtccyooXHcrKVxzKlx9XH0vLAogICAgICB0aG91c2FuZHNSZWdleCA9IC8oXGQpKD89KFxkXGRcZCkrKD8hXGQpKS9nOwoKICBmdW5jdGlvbiBmb3JtYXRXaXRoRGVsaW1pdGVycyhudW1iZXIpIHsKICAgIHZhciBwcmVjaXNpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB2b2lkIDAgIT09IGFyZ3VtZW50c1sxXSA/IGFyZ3VtZW50c1sxXSA6IDIsCiAgICAgICAgdGhvdXNhbmRzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMl0gPyBhcmd1bWVudHNbMl0gOiAiLCIsCiAgICAgICAgZGVjaW1hbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzNdID8gYXJndW1lbnRzWzNdIDogIi4iOwogICAgaWYgKGlzTmFOKG51bWJlcikgfHwgbnVsbCA9PSBudW1iZXIpIHJldHVybiAwOwogICAgdmFyIGZpeGVkTnVtYmVyID0gKG51bWJlciAvIDEwMCkudG9GaXhlZChwcmVjaXNpb24pLAogICAgICAgIHBhcnRzID0gZml4ZWROdW1iZXIuc3BsaXQoIi4iKSwKICAgICAgICBkb2xsYXJzID0gcGFydHNbMF0ucmVwbGFjZSh0aG91c2FuZHNSZWdleCwgIiQxIi5jb25jYXQodGhvdXNhbmRzKSksCiAgICAgICAgY2VudHMgPSBwYXJ0c1sxXSA/IGRlY2ltYWwgKyBwYXJ0c1sxXSA6ICIiOwogICAgcmV0dXJuIGRvbGxhcnMgKyBjZW50czsKICB9CgogIGZ1bmN0aW9uIGZvcm1hdE1vbmV5KGFtb3VudCwgZm9ybWF0KSB7CiAgICB2YXIgY2VudHMgPSAxMDAgKiBhbW91bnQ7CiAgICAic3RyaW5nIiA9PSB0eXBlb2YgY2VudHMgJiYgKGNlbnRzID0gY2VudHMucmVwbGFjZSgiLiIsICIiKSk7CiAgICB2YXIgdmFsdWUgPSAiIiwKICAgICAgICBmb3JtYXRTdHJpbmcgPSBmb3JtYXQgfHwgIiR7e2Ftb3VudH19IiwKICAgICAgICBwbGFjZWhvbGRlck1hdGNoID0gZm9ybWF0U3RyaW5nLm1hdGNoKHBsYWNlaG9sZGVyUmVnZXgpOwoKICAgIHN3aXRjaCAocGxhY2Vob2xkZXJNYXRjaCB8fCAocGxhY2Vob2xkZXJNYXRjaCA9IChmb3JtYXRTdHJpbmcgPSAiJHt7YW1vdW50fX0iKS5tYXRjaChwbGFjZWhvbGRlclJlZ2V4KSksIHBsYWNlaG9sZGVyTWF0Y2hbMV0pIHsKICAgICAgY2FzZSAiYW1vdW50IjoKICAgICAgICB2YWx1ZSA9IGZvcm1hdFdpdGhEZWxpbWl0ZXJzKGNlbnRzKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImFtb3VudF9ub19kZWNpbWFscyI6CiAgICAgICAgdmFsdWUgPSBmb3JtYXRXaXRoRGVsaW1pdGVycyhjZW50cywgMCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJhbW91bnRfd2l0aF9jb21tYV9zZXBhcmF0b3IiOgogICAgICAgIHZhbHVlID0gZm9ybWF0V2l0aERlbGltaXRlcnMoY2VudHMsIDIsICIuIiwgIiwiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImFtb3VudF9ub19kZWNpbWFsc193aXRoX2NvbW1hX3NlcGFyYXRvciI6CiAgICAgICAgdmFsdWUgPSBmb3JtYXRXaXRoRGVsaW1pdGVycyhjZW50cywgMCwgIi4iLCAiLCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiYW1vdW50X25vX2RlY2ltYWxzX3dpdGhfc3BhY2Vfc2VwYXJhdG9yIjoKICAgICAgICB2YWx1ZSA9IGZvcm1hdFdpdGhEZWxpbWl0ZXJzKGNlbnRzLCAwLCAiICIpOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICB2YWx1ZSA9IGZvcm1hdFdpdGhEZWxpbWl0ZXJzKGNlbnRzKTsKICAgIH0KCiAgICByZXR1cm4gZm9ybWF0U3RyaW5nLnJlcGxhY2UocGxhY2Vob2xkZXJSZWdleCwgdmFsdWUpOwogIH0KCiAgZnVuY3Rpb24gbm9ybWFsaXplSWQodHlwZSwgZGF0YWJhc2VLZXkpIHsKICAgIHJldHVybiBidG9hKCJnaWQ6Ly9zaG9waWZ5LyIuY29uY2F0KHR5cGUsICIvIikuY29uY2F0KGRhdGFiYXNlS2V5KSk7CiAgfQoKICBmdW5jdGlvbiBnZXROb3JtYWxpemVkSWRGcm9tQ29uZmlnKHR5cGUsIGNvbmZpZywgZGF0YWJhc2VLZXksIHN0b3JlZnJvbnRLZXkpIHsKICAgIHZhciBkZW5vcm1hbGl6ZWRWYWx1ZSA9IGNvbmZpZ1tkYXRhYmFzZUtleV0sCiAgICAgICAgbm9ybWFsaXplZFZhbHVlID0gY29uZmlnW3N0b3JlZnJvbnRLZXldOwogICAgcmV0dXJuIG5vcm1hbGl6ZWRWYWx1ZSB8fCAoZGVub3JtYWxpemVkVmFsdWUgPyBBcnJheS5pc0FycmF5KGRlbm9ybWFsaXplZFZhbHVlKSA/IGRlbm9ybWFsaXplZFZhbHVlLm1hcChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgcmV0dXJuIG5vcm1hbGl6ZUlkKHR5cGUsIHZhbHVlKTsKICAgIH0pIDogbm9ybWFsaXplSWQodHlwZSwgZGVub3JtYWxpemVkVmFsdWUpIDogbnVsbCk7CiAgfQoKICBmdW5jdGlvbiBub3JtYWxpemVDb25maWcoY29uZmlnKSB7CiAgICB2YXIgYmFzZVJlc291cmNlVHlwZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdID8gYXJndW1lbnRzWzFdIDogIlByb2R1Y3QiOwogICAgcmV0dXJuIChjb25maWcuaWQgfHwgY29uZmlnLnN0b3JlZnJvbnRJZCkgJiYgKGNvbmZpZy5zdG9yZWZyb250SWQgPSBnZXROb3JtYWxpemVkSWRGcm9tQ29uZmlnKGJhc2VSZXNvdXJjZVR5cGUsIGNvbmZpZywgImlkIiwgInN0b3JlZnJvbnRJZCIpKSwgKGNvbmZpZy52YXJpYW50SWQgfHwgY29uZmlnLnN0b3JlZnJvbnRWYXJpYW50SWQpICYmIChjb25maWcuc3RvcmVmcm9udFZhcmlhbnRJZCA9IGdldE5vcm1hbGl6ZWRJZEZyb21Db25maWcoIlByb2R1Y3RWYXJpYW50IiwgY29uZmlnLCAidmFyaWFudElkIiwgInN0b3JlZnJvbnRWYXJpYW50SWQiKSksIGNvbmZpZzsKICB9CgogIGZ1bmN0aW9uIGRldGVjdENTU0ZlYXR1cmUoZmVhdHVyZW5hbWUpIHsKICAgIHZhciBmZWF0dXJlID0gITEsCiAgICAgICAgZG9tUHJlZml4ZXMgPSAiV2Via2l0IE1veiBtcyBPIi5zcGxpdCgiICIpLAogICAgICAgIGVsbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLAogICAgICAgIGZlYXR1cmVuYW1lQ2FwaXRhbCA9IG51bGw7CgogICAgaWYgKGZlYXR1cmVuYW1lID0gZmVhdHVyZW5hbWUudG9Mb3dlckNhc2UoKSwgdm9pZCAwICE9PSBlbG0uc3R5bGVbZmVhdHVyZW5hbWVdICYmIChmZWF0dXJlID0gITApLCAhMSA9PT0gZmVhdHVyZSkgewogICAgICBmZWF0dXJlbmFtZUNhcGl0YWwgPSBmZWF0dXJlbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGZlYXR1cmVuYW1lLnN1YnN0cigxKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9tUHJlZml4ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAodm9pZCAwICE9PSBlbG0uc3R5bGVbZG9tUHJlZml4ZXNbaV0gKyBmZWF0dXJlbmFtZUNhcGl0YWxdKSB7CiAgICAgICAgICBmZWF0dXJlID0gITA7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmVhdHVyZTsKICB9CgogIHZhciBzdXBwb3J0c0FuaW1hdGlvbnMsCiAgICAgIHN1cHBvcnRzVHJhbnNpdGlvbnMgPSBmdW5jdGlvbiBzdXBwb3J0c1RyYW5zaXRpb25zKCkgewogICAgcmV0dXJuIGRldGVjdENTU0ZlYXR1cmUoInRyYW5zaXRpb24iKTsKICB9LAogICAgICBzdXBwb3J0c1RyYW5zZm9ybXMgPSBmdW5jdGlvbiBzdXBwb3J0c1RyYW5zZm9ybXMoKSB7CiAgICByZXR1cm4gZGV0ZWN0Q1NTRmVhdHVyZSgidHJhbnNmb3JtIik7CiAgfSwKICAgICAgc3VwcG9ydHNXaW5kb3dPcGVuID0gZnVuY3Rpb24gc3VwcG9ydHNXaW5kb3dPcGVuKCkgewogICAgdmFyIHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQgfHwgbmF2aWdhdG9yLnZlbmRvciB8fCB3aW5kb3cub3BlcmEsCiAgICAgICAgdW5TdXBwb3J0ZWRBcHBzOwogICAgcmV0dXJuIC0xID09PSB1c2VyQWdlbnQuaW5kZXhPZigiTWFjIE9TIFgiKSB8fCAhWyJJbnN0YWdyYW0iLCAiUGludGVyZXN0L2lPUyIsICJGQkFOL0ZCSU9TIiwgIkZCQU4vTWVzc2VuZ2VyRm9yaU9TIl0uc29tZShmdW5jdGlvbiAoYXBwTmFtZSkgewogICAgICByZXR1cm4gdXNlckFnZW50LmluZGV4T2YoYXBwTmFtZSkgPiAtMTsKICAgIH0pOwogIH0sCiAgICAgIGJyb3dzZXJGZWF0dXJlcyA9IHsKICAgIGFuaW1hdGlvbjogZnVuY3Rpb24gc3VwcG9ydHNBbmltYXRpb25zKCkgewogICAgICByZXR1cm4gZGV0ZWN0Q1NTRmVhdHVyZSgiYW5pbWF0aW9uIik7CiAgICB9KCksCiAgICB0cmFuc2l0aW9uOiBzdXBwb3J0c1RyYW5zaXRpb25zKCksCiAgICB0cmFuc2Zvcm06IHN1cHBvcnRzVHJhbnNmb3JtcygpLAogICAgd2luZG93T3Blbjogc3VwcG9ydHNXaW5kb3dPcGVuCiAgfTsKCiAgZnVuY3Rpb24gZ2V0VW5pdFN0cmluZyh1bml0RW51bSkgewogICAgcmV0dXJuICJMIiA9PT0gdW5pdEVudW0gPyAiTCIgOiAiTTMiID09PSB1bml0RW51bSA/ICJtw4LCsyIgOiAiTTIiID09PSB1bml0RW51bSA/ICJtw4LCsiIgOiB1bml0RW51bS50b0xvd2VyQ2FzZSgpOwogIH0KCiAgZnVuY3Rpb24gZ2V0VW5pdFByaWNlQmFzZVVuaXQocmVmZXJlbmNlVmFsdWUsIHJlZmVyZW5jZVVuaXQpIHsKICAgIHZhciB1bml0U3RyaW5nID0gZ2V0VW5pdFN0cmluZyhyZWZlcmVuY2VVbml0KTsKICAgIHJldHVybiAxID09PSByZWZlcmVuY2VWYWx1ZSA/ICIiLmNvbmNhdCh1bml0U3RyaW5nKSA6ICIiLmNvbmNhdChyZWZlcmVuY2VWYWx1ZSkuY29uY2F0KHVuaXRTdHJpbmcpOwogIH0KCiAgdmFyIFByb2R1Y3RWaWV3ID0gZnVuY3Rpb24gKF9WaWV3KSB7CiAgICBmdW5jdGlvbiBQcm9kdWN0VmlldygpIHsKICAgICAgcmV0dXJuIF9WaWV3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKICAgIH0KCiAgICBfaW5oZXJpdHNMb29zZShQcm9kdWN0VmlldywgX1ZpZXcpOwoKICAgIHZhciBfcHJvdG8gPSBQcm9kdWN0Vmlldy5wcm90b3R5cGU7CiAgICByZXR1cm4gX3Byb3RvLnJlc2l6ZU9uTG9hZCA9IGZ1bmN0aW9uIHJlc2l6ZU9uTG9hZCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpcywKICAgICAgICAgIHByb2R1Y3RDb250ZW50cyA9IHRoaXMuY29tcG9uZW50LmNvbmZpZy5wcm9kdWN0LmNvbnRlbnRzOwoKICAgICAgaWYgKHByb2R1Y3RDb250ZW50cy5pbWcgfHwgcHJvZHVjdENvbnRlbnRzLmltZ1dpdGhDYXJvdXNlbCkgewogICAgICAgIHZhciBpbWFnZSA9IHRoaXMud3JhcHBlci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRoaXMuY29tcG9uZW50LmNsYXNzZXMucHJvZHVjdC5pbWcpWzBdOwogICAgICAgIGltYWdlICYmIGltYWdlLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5yZXNpemUoKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgX3Byb3RvLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgX1ZpZXcucHJvdG90eXBlLnJlbmRlci5jYWxsKHRoaXMpLCB0aGlzLnJlc2l6ZU9uTG9hZCgpOwogICAgfSwgX3Byb3RvLndyYXBUZW1wbGF0ZSA9IGZ1bmN0aW9uIHdyYXBUZW1wbGF0ZShodG1sKSB7CiAgICAgIHZhciBhcmlhTGFiZWw7CgogICAgICBzd2l0Y2ggKHRoaXMuY29tcG9uZW50Lm9wdGlvbnMuYnV0dG9uRGVzdGluYXRpb24pIHsKICAgICAgICBjYXNlICJtb2RhbCI6CiAgICAgICAgICBhcmlhTGFiZWwgPSAiVmlldyBkZXRhaWxzIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJjYXJ0IjoKICAgICAgICAgIGFyaWFMYWJlbCA9ICJBZGQgdG8gY2FydCI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGFyaWFMYWJlbCA9ICJCdXkgTm93IjsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50LmlzQnV0dG9uID8gJzxkaXYgY2xhc3M9IicuY29uY2F0KHRoaXMud3JhcHBlckNsYXNzLCAiICIpLmNvbmNhdCh0aGlzLmNvbXBvbmVudC5jbGFzc2VzLnByb2R1Y3QucHJvZHVjdCwgJyI+PGRpdiB0YWJpbmRleD0iMCIgcm9sZT0iYnV0dG9uIiBhcmlhLWxhYmVsPSInKS5jb25jYXQoYXJpYUxhYmVsLCAnIiBjbGFzcz0iJykuY29uY2F0KHRoaXMuY29tcG9uZW50LmNsYXNzZXMucHJvZHVjdC5ibG9ja0J1dHRvbiwgJyI+JykuY29uY2F0KGh0bWwsICI8L2Rpdj48L2Rpdj4iKSA6ICc8ZGl2IGNsYXNzPSInLmNvbmNhdCh0aGlzLndyYXBwZXJDbGFzcywgIiAiKS5jb25jYXQodGhpcy5jb21wb25lbnQuY2xhc3Nlcy5wcm9kdWN0LnByb2R1Y3QsICciPicpLmNvbmNhdChodG1sLCAiPC9kaXY+Iik7CiAgICB9LCBfY3JlYXRlQ2xhc3MoUHJvZHVjdFZpZXcsIFt7CiAgICAgIGtleTogImNsYXNzTmFtZSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5jbGFzc2VzLnByb2R1Y3RbdGhpcy5jb21wb25lbnQub3B0aW9ucy5sYXlvdXRdOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInNob3VsZFJlc2l6ZVgiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gITE7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2hvdWxkUmVzaXplWSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAhMDsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJvdXRlckhlaWdodCIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy53cmFwcGVyLmNsaWVudEhlaWdodCwgInB4Iik7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAid3JhcHBlckNsYXNzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmNvbXBvbmVudC5jdXJyZW50SW1hZ2UgPyAiaGFzLWltYWdlIiA6ICJuby1pbWFnZSIsICIgIikuY29uY2F0KHRoaXMuY29tcG9uZW50LmNsYXNzZXMucHJvZHVjdFt0aGlzLmNvbXBvbmVudC5vcHRpb25zLmxheW91dF0pOwogICAgICB9CiAgICB9XSksIFByb2R1Y3RWaWV3OwogIH0oVmlldyksCiAgICAgIE1BWF9XSURUSCA9ICI5NTBweCIsCiAgICAgIFByb2R1Y3RVcGRhdGVyID0gZnVuY3Rpb24gKF9VcGRhdGVyKSB7CiAgICBmdW5jdGlvbiBQcm9kdWN0VXBkYXRlcigpIHsKICAgICAgcmV0dXJuIF9VcGRhdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKICAgIH0KCiAgICB2YXIgX3Byb3RvOwoKICAgIHJldHVybiBfaW5oZXJpdHNMb29zZShQcm9kdWN0VXBkYXRlciwgX1VwZGF0ZXIpLCBQcm9kdWN0VXBkYXRlci5wcm90b3R5cGUudXBkYXRlQ29uZmlnID0gZnVuY3Rpb24gdXBkYXRlQ29uZmlnKGNvbmZpZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzLAogICAgICAgICAgbmV3Q29uZmlnID0gbm9ybWFsaXplQ29uZmlnKGNvbmZpZyk7CgogICAgICBpZiAobmV3Q29uZmlnLnN0b3JlZnJvbnRJZCB8fCBuZXdDb25maWcuc3RvcmVmcm9udFZhcmlhbnRJZCkgcmV0dXJuIHRoaXMuY29tcG9uZW50LnN0b3JlZnJvbnRJZCA9IG5ld0NvbmZpZy5zdG9yZWZyb250SWQgfHwgdGhpcy5jb21wb25lbnQuc3RvcmVmcm9udElkLCB0aGlzLmNvbXBvbmVudC5kZWZhdWx0U3RvcmVmcm9udFZhcmlhbnRJZCA9IG5ld0NvbmZpZy5zdG9yZWZyb250VmFyaWFudElkIHx8IHRoaXMuY29tcG9uZW50LmRlZmF1bHRTdG9yZWZyb250VmFyaWFudElkLCB2b2lkIHRoaXMuY29tcG9uZW50LmluaXQoKTsKICAgICAgdmFyIGxheW91dCA9IHRoaXMuY29tcG9uZW50Lm9wdGlvbnMubGF5b3V0OwogICAgICBjb25maWcub3B0aW9ucyAmJiBjb25maWcub3B0aW9ucy5wcm9kdWN0ICYmIChjb25maWcub3B0aW9ucy5wcm9kdWN0LmxheW91dCAmJiAobGF5b3V0ID0gY29uZmlnLm9wdGlvbnMucHJvZHVjdC5sYXlvdXQpLCB0aGlzLmNvbXBvbmVudC52aWV3LmlmcmFtZSAmJiAoInZlcnRpY2FsIiA9PT0gbGF5b3V0ICYmICI5NTBweCIgPT09IHRoaXMuY29tcG9uZW50LnZpZXcuaWZyYW1lLndpZHRoICYmIHRoaXMuY29tcG9uZW50LnZpZXcuaWZyYW1lLnNldFdpZHRoKHRoaXMuY29tcG9uZW50Lm9wdGlvbnMud2lkdGgpLCAiaG9yaXpvbnRhbCIgPT09IGxheW91dCAmJiB0aGlzLmNvbXBvbmVudC52aWV3LmlmcmFtZS53aWR0aCAmJiAiOTUwcHgiICE9PSB0aGlzLmNvbXBvbmVudC52aWV3LmlmcmFtZS53aWR0aCAmJiB0aGlzLmNvbXBvbmVudC52aWV3LmlmcmFtZS5zZXRXaWR0aCgiOTUwcHgiKSwgY29uZmlnLm9wdGlvbnMucHJvZHVjdC53aWR0aCAmJiAidmVydGljYWwiID09PSBsYXlvdXQgJiYgdGhpcy5jb21wb25lbnQudmlldy5pZnJhbWUuc2V0V2lkdGgoY29uZmlnLm9wdGlvbnMucHJvZHVjdC53aWR0aCksIGNvbmZpZy5vcHRpb25zLnByb2R1Y3QubGF5b3V0ICYmICh0aGlzLmNvbXBvbmVudC52aWV3LmlmcmFtZS5lbC5zdHlsZS53aWR0aCA9ICIxMDAlIikpKSwgdGhpcy5jb21wb25lbnQudmlldy5pZnJhbWUgJiYgKHRoaXMuY29tcG9uZW50LnZpZXcuaWZyYW1lLnJlbW92ZUNsYXNzKHRoaXMuY29tcG9uZW50LmNsYXNzZXMucHJvZHVjdC52ZXJ0aWNhbCksIHRoaXMuY29tcG9uZW50LnZpZXcuaWZyYW1lLnJlbW92ZUNsYXNzKHRoaXMuY29tcG9uZW50LmNsYXNzZXMucHJvZHVjdC5ob3Jpem9udGFsKSwgdGhpcy5jb21wb25lbnQudmlldy5pZnJhbWUuYWRkQ2xhc3ModGhpcy5jb21wb25lbnQuY2xhc3Nlcy5wcm9kdWN0W2xheW91dF0pLCB0aGlzLmNvbXBvbmVudC52aWV3LnJlc2l6ZSgpKSwgX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMuY29tcG9uZW50LnZpZXcud3JhcHBlci5xdWVyeVNlbGVjdG9yQWxsKCJpbWciKSkuZm9yRWFjaChmdW5jdGlvbiAoaW1nKSB7CiAgICAgICAgaW1nLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5jb21wb25lbnQudmlldy5yZXNpemUoKTsKICAgICAgICB9KTsKICAgICAgfSksIF9VcGRhdGVyLnByb3RvdHlwZS51cGRhdGVDb25maWcuY2FsbCh0aGlzLCBjb25maWcpLCB0aGlzLmNvbXBvbmVudC5jYXJ0ICYmIHRoaXMuY29tcG9uZW50LmNhcnQudXBkYXRlQ29uZmlnKGNvbmZpZyksIHRoaXMuY29tcG9uZW50Lm1vZGFsICYmIHRoaXMuY29tcG9uZW50Lm1vZGFsLnVwZGF0ZUNvbmZpZyhPYmplY3QuYXNzaWduKHt9LCBjb25maWcsIHsKICAgICAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmNvbXBvbmVudC5jb25maWcsIHsKICAgICAgICAgIHByb2R1Y3Q6IHRoaXMuY29tcG9uZW50Lm1vZGFsUHJvZHVjdENvbmZpZwogICAgICAgIH0pCiAgICAgIH0pKTsKICAgIH0sIFByb2R1Y3RVcGRhdGVyOwogIH0oVXBkYXRlcik7CgogIGZ1bmN0aW9uIGlzRnVuY3Rpb24kMShvYmopIHsKICAgIHJldHVybiBCb29sZWFuKG9iaiAmJiBvYmouY29uc3RydWN0b3IgJiYgb2JqLmNhbGwgJiYgb2JqLmFwcGx5KTsKICB9CgogIGZ1bmN0aW9uIGlzUHNldWRvU2VsZWN0b3IkMShrZXkpIHsKICAgIHJldHVybiAiOiIgPT09IGtleS5jaGFyQXQoMCk7CiAgfQoKICBmdW5jdGlvbiBpc01lZGlhJDEoa2V5KSB7CiAgICByZXR1cm4gIkAiID09PSBrZXkuY2hhckF0KDApOwogIH0KCiAgdmFyIEVOVEVSX0tFWSA9IDEzLAogICAgICBwcm9wZXJ0aWVzV2hpdGVsaXN0ID0gWyJiYWNrZ3JvdW5kIiwgImJhY2tncm91bmQtY29sb3IiLCAiYm9yZGVyIiwgImJvcmRlci1yYWRpdXMiLCAiY29sb3IiLCAiYm9yZGVyLWNvbG9yIiwgImJvcmRlci13aWR0aCIsICJib3JkZXItc3R5bGUiLCAidHJhbnNpdGlvbiIsICJ0ZXh0LXRyYW5zZm9ybSIsICJ0ZXh0LXNoYWRvdyIsICJib3gtc2hhZG93IiwgImZvbnQtc2l6ZSIsICJmb250LWZhbWlseSJdOwoKICBmdW5jdGlvbiB3aGl0ZWxpc3RlZFByb3BlcnRpZXMoc2VsZWN0b3JTdHlsZXMpIHsKICAgIHJldHVybiBPYmplY3Qua2V5cyhzZWxlY3RvclN0eWxlcykucmVkdWNlKGZ1bmN0aW9uIChmaWx0ZXJlZFN0eWxlcywgcHJvcGVydHlOYW1lKSB7CiAgICAgIHJldHVybiBpc1BzZXVkb1NlbGVjdG9yJDEocHJvcGVydHlOYW1lKSB8fCBpc01lZGlhJDEocHJvcGVydHlOYW1lKSA/IChmaWx0ZXJlZFN0eWxlc1twcm9wZXJ0eU5hbWVdID0gd2hpdGVsaXN0ZWRQcm9wZXJ0aWVzKHNlbGVjdG9yU3R5bGVzW3Byb3BlcnR5TmFtZV0pLCBmaWx0ZXJlZFN0eWxlcykgOiAocHJvcGVydGllc1doaXRlbGlzdC5pbmRleE9mKHByb3BlcnR5TmFtZSkgPiAtMSAmJiAoZmlsdGVyZWRTdHlsZXNbcHJvcGVydHlOYW1lXSA9IHNlbGVjdG9yU3R5bGVzW3Byb3BlcnR5TmFtZV0pLCBmaWx0ZXJlZFN0eWxlcyk7CiAgICB9LCB7fSk7CiAgfQoKICB2YXIgUHJvZHVjdCQxID0gZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICAgIGZ1bmN0aW9uIFByb2R1Y3QoY29uZmlnLCBwcm9wcykgewogICAgICB2YXIgX3RoaXM7CgogICAgICByZXR1cm4gY29uZmlnID0gbm9ybWFsaXplQ29uZmlnKGNvbmZpZyksIChfdGhpcyA9IF9Db21wb25lbnQuY2FsbCh0aGlzLCBjb25maWcsIHByb3BzKSB8fCB0aGlzKS50eXBlS2V5ID0gInByb2R1Y3QiLCBfdGhpcy5kZWZhdWx0U3RvcmVmcm9udFZhcmlhbnRJZCA9IGNvbmZpZy5zdG9yZWZyb250VmFyaWFudElkLCBfdGhpcy5jYWNoZWRJbWFnZSA9IG51bGwsIF90aGlzLmNoaWxkVGVtcGxhdGUgPSBuZXcgVGVtcGxhdGUoX3RoaXMuY29uZmlnLm9wdGlvbi50ZW1wbGF0ZXMsIF90aGlzLmNvbmZpZy5vcHRpb24uY29udGVudHMsIF90aGlzLmNvbmZpZy5vcHRpb24ub3JkZXIpLCBfdGhpcy5jYXJ0ID0gbnVsbCwgX3RoaXMubW9kYWwgPSBudWxsLCBfdGhpcy5pbWdTdHlsZSA9ICIiLCBfdGhpcy5zZWxlY3RlZFF1YW50aXR5ID0gMSwgX3RoaXMuc2VsZWN0ZWRWYXJpYW50ID0ge30sIF90aGlzLnNlbGVjdGVkT3B0aW9ucyA9IHt9LCBfdGhpcy5zZWxlY3RlZEltYWdlID0gbnVsbCwgX3RoaXMudXBkYXRlciA9IG5ldyBQcm9kdWN0VXBkYXRlcihfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSksIF90aGlzLnZpZXcgPSBuZXcgUHJvZHVjdFZpZXcoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpLCBfdGhpczsKICAgIH0KCiAgICBfaW5oZXJpdHNMb29zZShQcm9kdWN0LCBfQ29tcG9uZW50KTsKCiAgICB2YXIgX3Byb3RvID0gUHJvZHVjdC5wcm90b3R5cGU7CiAgICByZXR1cm4gX3Byb3RvLnN0b3BQcm9wYWdhdGlvbiA9IGZ1bmN0aW9uIHN0b3BQcm9wYWdhdGlvbihldnQpIHsKICAgICAgdGhpcy5pc0J1dHRvbiAmJiBldnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7CiAgICB9LCBfcHJvdG8ub3B0aW9uVmFsdWVDYW5CZVNlbGVjdGVkID0gZnVuY3Rpb24gb3B0aW9uVmFsdWVDYW5CZVNlbGVjdGVkKHNlbGVjdGlvbnMsIG5hbWUsIHZhbHVlKSB7CiAgICAgIHZhciB2YXJpYW50cyA9IHRoaXMudmFyaWFudEFycmF5LAogICAgICAgICAgc2VsZWN0YWJsZVZhbHVlcyA9IE9iamVjdC5hc3NpZ24oe30sIHNlbGVjdGlvbnMsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgbmFtZSwgdmFsdWUpKSwKICAgICAgICAgIHNhdGlzZmFjdG9yeVZhcmlhbnRzID0gdmFyaWFudHMuZmlsdGVyKGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgdmFyIG1hdGNoaW5nT3B0aW9uczsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoc2VsZWN0YWJsZVZhbHVlcykuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIHJldHVybiB2YXJpYW50Lm9wdGlvblZhbHVlc1trZXldID09PSBzZWxlY3RhYmxlVmFsdWVzW2tleV07CiAgICAgICAgfSkubGVuZ3RoID09PSBPYmplY3Qua2V5cyhzZWxlY3RhYmxlVmFsdWVzKS5sZW5ndGg7CiAgICAgIH0pLAogICAgICAgICAgdmFyaWFudFNlbGVjdGFibGUgPSAhMTsKICAgICAgcmV0dXJuIGNvbnNvLCB2YXJpYW50U2VsZWN0YWJsZSA9IHNhdGlzZmFjdG9yeVZhcmlhbnRzLnJlZHVjZShmdW5jdGlvbiAodmFyaWFudEV4aXN0cywgdmFyaWFudCkgewogICAgICAgIHZhciB2YXJpYW50QXZhaWxhYmxlID0gdmFyaWFudC5hdmFpbGFibGU7CiAgICAgICAgcmV0dXJuIHZhcmlhbnRFeGlzdHMgfHwgdmFyaWFudEF2YWlsYWJsZTsKICAgICAgfSwgITEpOwogICAgfSwgX3Byb3RvLm9wZW5PbmxpbmVTdG9yZSA9IGZ1bmN0aW9uIG9wZW5PbmxpbmVTdG9yZSgpIHsKICAgICAgdGhpcy5fdXNlckV2ZW50KCJvcGVuT25saW5lU3RvcmUiKSwgd2luZG93Lm9wZW4odGhpcy5vbmxpbmVTdG9yZVVSTCk7CiAgICB9LCBfcHJvdG8uaW5pdCA9IGZ1bmN0aW9uIGluaXQoZGF0YSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUNhcnQoKS50aGVuKGZ1bmN0aW9uIChjYXJ0KSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5jYXJ0ID0gY2FydCwgX0NvbXBvbmVudC5wcm90b3R5cGUuaW5pdC5jYWxsKF90aGlzMiwgZGF0YSkudGhlbihmdW5jdGlvbiAobW9kZWwpIHsKICAgICAgICAgIHJldHVybiBtb2RlbCAmJiBfdGhpczIudmlldy5yZW5kZXIoKSwgbW9kZWw7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLmNyZWF0ZUNhcnQgPSBmdW5jdGlvbiBjcmVhdGVDYXJ0KCkgewogICAgICB2YXIgY2FydENvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZ2xvYmFsQ29uZmlnLCB7CiAgICAgICAgbm9kZTogdGhpcy5nbG9iYWxDb25maWcuY2FydE5vZGUsCiAgICAgICAgb3B0aW9uczogdGhpcy5jb25maWcKICAgICAgfSk7CiAgICAgIHJldHVybiB0aGlzLnByb3BzLmNyZWF0ZUNhcnQoY2FydENvbmZpZyk7CiAgICB9LCBfcHJvdG8uc2V0dXBNb2RlbCA9IGZ1bmN0aW9uIHNldHVwTW9kZWwoZGF0YSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfQ29tcG9uZW50LnByb3RvdHlwZS5zZXR1cE1vZGVsLmNhbGwodGhpcywgZGF0YSkudGhlbihmdW5jdGlvbiAobW9kZWwpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLnNldERlZmF1bHRWYXJpYW50KG1vZGVsKTsKICAgICAgfSk7CiAgICB9LCBfcHJvdG8uc2RrRmV0Y2ggPSBmdW5jdGlvbiBzZGtGZXRjaCgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RvcmVmcm9udElkICYmIEFycmF5LmlzQXJyYXkodGhpcy5zdG9yZWZyb250SWQpICYmIHRoaXMuc3RvcmVmcm9udElkWzBdID8gdGhpcy5wcm9wcy5jbGllbnQucHJvZHVjdC5mZXRjaCh0aGlzLnN0b3JlZnJvbnRJZFswXSkgOiB0aGlzLnN0b3JlZnJvbnRJZCAmJiAhQXJyYXkuaXNBcnJheSh0aGlzLnN0b3JlZnJvbnRJZCkgPyB0aGlzLnByb3BzLmNsaWVudC5wcm9kdWN0LmZldGNoKHRoaXMuc3RvcmVmcm9udElkKSA6IHRoaXMuaGFuZGxlID8gdGhpcy5wcm9wcy5jbGllbnQucHJvZHVjdC5mZXRjaEJ5SGFuZGxlKHRoaXMuaGFuZGxlKS50aGVuKGZ1bmN0aW9uIChwcm9kdWN0KSB7CiAgICAgICAgcmV0dXJuIHByb2R1Y3Q7CiAgICAgIH0pIDogUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJTREsgRmV0Y2ggRmFpbGVkIikpOwogICAgfSwgX3Byb3RvLmZldGNoRGF0YSA9IGZ1bmN0aW9uIGZldGNoRGF0YSgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICByZXR1cm4gdGhpcy5zZGtGZXRjaCgpLnRoZW4oZnVuY3Rpb24gKG1vZGVsKSB7CiAgICAgICAgaWYgKG1vZGVsKSByZXR1cm4gX3RoaXM0LnN0b3JlZnJvbnRJZCA9IG1vZGVsLmlkLCBfdGhpczQuaGFuZGxlID0gbW9kZWwuaGFuZGxlLCBtb2RlbDsKICAgICAgICB0aHJvdyBfdGhpczQubm9kZS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiLCBuZXcgRXJyb3IoIk5vdCBGb3VuZCIpOwogICAgICB9KTsKICAgIH0sIF9wcm90by5vbkJ1dHRvbkNsaWNrID0gZnVuY3Rpb24gb25CdXR0b25DbGljayhldnQsIHRhcmdldCkgewogICAgICBpZiAoZXZ0LnN0b3BQcm9wYWdhdGlvbigpLCBpc0Z1bmN0aW9uJDEodGhpcy5vcHRpb25zLmJ1dHRvbkRlc3RpbmF0aW9uKSkgdGhpcy5vcHRpb25zLmJ1dHRvbkRlc3RpbmF0aW9uKHRoaXMpO2Vsc2UgaWYgKCJjYXJ0IiA9PT0gdGhpcy5vcHRpb25zLmJ1dHRvbkRlc3RpbmF0aW9uKSB0aGlzLnByb3BzLmNsb3NlTW9kYWwoKSwgdGhpcy5fdXNlckV2ZW50KCJhZGRWYXJpYW50VG9DYXJ0IiksIHRoaXMucHJvcHMudHJhY2tlci50cmFja01ldGhvZCh0aGlzLmNhcnQuYWRkVmFyaWFudFRvQ2FydC5iaW5kKHRoaXMpLCAiVXBkYXRlIENhcnQiLCB0aGlzLnNlbGVjdGVkVmFyaWFudFRyYWNraW5nSW5mbykodGhpcy5zZWxlY3RlZFZhcmlhbnQsIHRoaXMuc2VsZWN0ZWRRdWFudGl0eSksIHRoaXMuaWZyYW1lICYmIHRoaXMucHJvcHMuc2V0QWN0aXZlRWwodGFyZ2V0KTtlbHNlIGlmICgibW9kYWwiID09PSB0aGlzLm9wdGlvbnMuYnV0dG9uRGVzdGluYXRpb24pIHRoaXMucHJvcHMuc2V0QWN0aXZlRWwodGFyZ2V0KSwgdGhpcy5wcm9wcy50cmFja2VyLnRyYWNrKCJPcGVuIG1vZGFsIiwgdGhpcy5wcm9kdWN0VHJhY2tpbmdJbmZvKSwgdGhpcy5vcGVuTW9kYWwoKTtlbHNlIGlmICgib25saW5lU3RvcmUiID09PSB0aGlzLm9wdGlvbnMuYnV0dG9uRGVzdGluYXRpb24pIHRoaXMub3Blbk9ubGluZVN0b3JlKCk7ZWxzZSB7CiAgICAgICAgdmFyIGNoZWNrb3V0V2luZG93OwoKICAgICAgICBpZiAodGhpcy5fdXNlckV2ZW50KCJvcGVuQ2hlY2tvdXQiKSwgdGhpcy5wcm9wcy50cmFja2VyLnRyYWNrKCJEaXJlY3QgQ2hlY2tvdXQiLCB7fSksIHRoaXMuY29uZmlnLmNhcnQucG9wdXAgJiYgYnJvd3NlckZlYXR1cmVzLndpbmRvd09wZW4oKSkgewogICAgICAgICAgdmFyIHBhcmFtcyA9IG5ldyBDaGVja291dE5hdmlnYXRvcih0aGlzLmNvbmZpZykucGFyYW1zOwogICAgICAgICAgY2hlY2tvdXRXaW5kb3cgPSB3aW5kb3cub3BlbigiIiwgImNoZWNrb3V0IiwgcGFyYW1zKTsKICAgICAgICB9IGVsc2UgY2hlY2tvdXRXaW5kb3cgPSB3aW5kb3c7CgogICAgICAgIHZhciBpbnB1dCA9IHsKICAgICAgICAgIGxpbmVJdGVtczogW3sKICAgICAgICAgICAgdmFyaWFudElkOiB0aGlzLnNlbGVjdGVkVmFyaWFudC5pZCwKICAgICAgICAgICAgcXVhbnRpdHk6IHRoaXMuc2VsZWN0ZWRRdWFudGl0eQogICAgICAgICAgfV0KICAgICAgICB9OwogICAgICAgIHRoaXMucHJvcHMuY2xpZW50LmNoZWNrb3V0LmNyZWF0ZShpbnB1dCkudGhlbihmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICAgIGNoZWNrb3V0V2luZG93LmxvY2F0aW9uID0gY2hlY2tvdXQud2ViVXJsOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCBfcHJvdG8ub25CbG9ja0J1dHRvbktleXVwID0gZnVuY3Rpb24gb25CbG9ja0J1dHRvbktleXVwKGV2dCwgdGFyZ2V0KSB7CiAgICAgIDEzID09PSBldnQua2V5Q29kZSAmJiB0aGlzLm9uQnV0dG9uQ2xpY2soZXZ0LCB0YXJnZXQpOwogICAgfSwgX3Byb3RvLm9uT3B0aW9uU2VsZWN0ID0gZnVuY3Rpb24gb25PcHRpb25TZWxlY3QoZXZ0KSB7CiAgICAgIHZhciB0YXJnZXQgPSBldnQudGFyZ2V0LAogICAgICAgICAgdmFsdWUgPSB0YXJnZXQub3B0aW9uc1t0YXJnZXQuc2VsZWN0ZWRJbmRleF0udmFsdWUsCiAgICAgICAgICBuYW1lID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgibmFtZSIpOwogICAgICB0aGlzLnVwZGF0ZVZhcmlhbnQobmFtZSwgdmFsdWUpOwogICAgfSwgX3Byb3RvLm9uUXVhbnRpdHlCbHVyID0gZnVuY3Rpb24gb25RdWFudGl0eUJsdXIoZXZ0LCB0YXJnZXQpIHsKICAgICAgdGhpcy51cGRhdGVRdWFudGl0eShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHRhcmdldC52YWx1ZSwgMTApOwogICAgICB9KTsKICAgIH0sIF9wcm90by5vblF1YW50aXR5SW5jcmVtZW50ID0gZnVuY3Rpb24gb25RdWFudGl0eUluY3JlbWVudChxdHkpIHsKICAgICAgdGhpcy51cGRhdGVRdWFudGl0eShmdW5jdGlvbiAocHJldlF0eSkgewogICAgICAgIHJldHVybiBwcmV2UXR5ICsgcXR5OwogICAgICB9KTsKICAgIH0sIF9wcm90by5jbG9zZUNhcnRPbkJnQ2xpY2sgPSBmdW5jdGlvbiBjbG9zZUNhcnRPbkJnQ2xpY2soKSB7CiAgICAgIHRoaXMuY2FydCAmJiB0aGlzLmNhcnQuaXNWaXNpYmxlICYmIHRoaXMuY2FydC5jbG9zZSgpOwogICAgfSwgX3Byb3RvLm9uQ2Fyb3VzZWxJdGVtQ2xpY2sgPSBmdW5jdGlvbiBvbkNhcm91c2VsSXRlbUNsaWNrKGV2dCwgdGFyZ2V0KSB7CiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB2YXIgc2VsZWN0ZWRJbWFnZUlkID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgiZGF0YS1pbWFnZS1pZCIpLAogICAgICAgICAgaW1hZ2VMaXN0LAogICAgICAgICAgZm91bmRJbWFnZSA9IHRoaXMubW9kZWwuaW1hZ2VzLmZpbmQoZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgcmV0dXJuIGltYWdlLmlkID09PSBzZWxlY3RlZEltYWdlSWQ7CiAgICAgIH0pOwogICAgICBmb3VuZEltYWdlICYmICh0aGlzLnNlbGVjdGVkSW1hZ2UgPSBmb3VuZEltYWdlLCB0aGlzLmNhY2hlZEltYWdlID0gZm91bmRJbWFnZSksIHRoaXMudmlldy5yZW5kZXIoKTsKICAgIH0sIF9wcm90by5uZXh0SW5kZXggPSBmdW5jdGlvbiBuZXh0SW5kZXgoY3VycmVudEluZGV4LCBvZmZzZXQpIHsKICAgICAgdmFyIG5leHRJbmRleCA9IGN1cnJlbnRJbmRleCArIG9mZnNldDsKICAgICAgcmV0dXJuIG5leHRJbmRleCA+PSB0aGlzLm1vZGVsLmltYWdlcy5sZW5ndGggPyAwIDogbmV4dEluZGV4IDwgMCA/IHRoaXMubW9kZWwuaW1hZ2VzLmxlbmd0aCAtIDEgOiBuZXh0SW5kZXg7CiAgICB9LCBfcHJvdG8ub25DYXJvdXNlbENoYW5nZSA9IGZ1bmN0aW9uIG9uQ2Fyb3VzZWxDaGFuZ2Uob2Zmc2V0KSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzLAogICAgICAgICAgaW1hZ2VMaXN0ID0gdGhpcy5tb2RlbC5pbWFnZXMsCiAgICAgICAgICBjdXJyZW50SW1hZ2UgPSBpbWFnZUxpc3QuZmlsdGVyKGZ1bmN0aW9uIChpbWFnZSkgewogICAgICAgIHJldHVybiBpbWFnZS5pZCA9PT0gX3RoaXM1LmN1cnJlbnRJbWFnZS5pZDsKICAgICAgfSlbMF0sCiAgICAgICAgICBjdXJyZW50SW1hZ2VJbmRleCA9IGltYWdlTGlzdC5pbmRleE9mKGN1cnJlbnRJbWFnZSk7CgogICAgICB0aGlzLnNlbGVjdGVkSW1hZ2UgPSBpbWFnZUxpc3RbdGhpcy5uZXh0SW5kZXgoY3VycmVudEltYWdlSW5kZXgsIG9mZnNldCldLCB0aGlzLmNhY2hlZEltYWdlID0gdGhpcy5zZWxlY3RlZEltYWdlLCB0aGlzLnZpZXcucmVuZGVyKCk7CiAgICB9LCBfcHJvdG8ub3Blbk1vZGFsID0gZnVuY3Rpb24gb3Blbk1vZGFsKCkgewogICAgICBpZiAoIXRoaXMubW9kYWwpIHsKICAgICAgICB2YXIgbW9kYWxDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmdsb2JhbENvbmZpZywgewogICAgICAgICAgbm9kZTogdGhpcy5nbG9iYWxDb25maWcubW9kYWxOb2RlLAogICAgICAgICAgb3B0aW9uczogT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb25maWcsIHsKICAgICAgICAgICAgcHJvZHVjdDogdGhpcy5tb2RhbFByb2R1Y3RDb25maWcsCiAgICAgICAgICAgIG1vZGFsOiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmNvbmZpZy5tb2RhbCwgewogICAgICAgICAgICAgIGdvb2dsZUZvbnRzOiB0aGlzLm9wdGlvbnMuZ29vZ2xlRm9udHMKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5tb2RhbCA9IHRoaXMucHJvcHMuY3JlYXRlTW9kYWwobW9kYWxDb25maWcsIHRoaXMucHJvcHMpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5fdXNlckV2ZW50KCJvcGVuTW9kYWwiKSwgdGhpcy5tb2RhbC5pbml0KHRoaXMubW9kZWwpOwogICAgfSwgX3Byb3RvLnVwZGF0ZVF1YW50aXR5ID0gZnVuY3Rpb24gdXBkYXRlUXVhbnRpdHkoZm4pIHsKICAgICAgdmFyIHF1YW50aXR5ID0gZm4odGhpcy5zZWxlY3RlZFF1YW50aXR5KTsKICAgICAgcXVhbnRpdHkgPCAwICYmIChxdWFudGl0eSA9IDApLCB0aGlzLnNlbGVjdGVkUXVhbnRpdHkgPSBxdWFudGl0eSwgdGhpcy5fdXNlckV2ZW50KCJ1cGRhdGVRdWFudGl0eSIpLCB0aGlzLnZpZXcucmVuZGVyKCk7CiAgICB9LCBfcHJvdG8udXBkYXRlVmFyaWFudCA9IGZ1bmN0aW9uIHVwZGF0ZVZhcmlhbnQob3B0aW9uTmFtZSwgdmFsdWUpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXMsCiAgICAgICAgICB1cGRhdGVkT3B0aW9uID0gdGhpcy5tb2RlbC5vcHRpb25zLmZpbmQoZnVuY3Rpb24gKG9wdGlvbikgewogICAgICAgIHJldHVybiBvcHRpb24ubmFtZSA9PT0gb3B0aW9uTmFtZTsKICAgICAgfSk7CgogICAgICByZXR1cm4gdXBkYXRlZE9wdGlvbiAmJiAodGhpcy5zZWxlY3RlZE9wdGlvbnNbdXBkYXRlZE9wdGlvbi5uYW1lXSA9IHZhbHVlLCB0aGlzLnNlbGVjdGVkVmFyaWFudCA9IHRoaXMucHJvcHMuY2xpZW50LnByb2R1Y3QuaGVscGVycy52YXJpYW50Rm9yT3B0aW9ucyh0aGlzLm1vZGVsLCB0aGlzLnNlbGVjdGVkT3B0aW9ucykpLCB0aGlzLnZhcmlhbnRFeGlzdHMgPyAodGhpcy5jYWNoZWRJbWFnZSA9IHRoaXMuc2VsZWN0ZWRWYXJpYW50LmltYWdlLCB0aGlzLnNlbGVjdGVkVmFyaWFudC5pbWFnZSA/IHRoaXMuc2VsZWN0ZWRJbWFnZSA9IG51bGwgOiB0aGlzLnNlbGVjdGVkSW1hZ2UgPSB0aGlzLm1vZGVsLmltYWdlc1swXSkgOiB0aGlzLnNlbGVjdGVkSW1hZ2UgPSB0aGlzLm1vZGVsLmltYWdlcy5maW5kKGZ1bmN0aW9uIChpbWFnZSkgewogICAgICAgIHJldHVybiBpbWFnZS5pZCA9PT0gX3RoaXM2LmNhY2hlZEltYWdlLmlkOwogICAgICB9KSwgdGhpcy52aWV3LnJlbmRlcigpLCB0aGlzLl91c2VyRXZlbnQoInVwZGF0ZVZhcmlhbnQiKSwgdXBkYXRlZE9wdGlvbjsKICAgIH0sIF9wcm90by5zZXREZWZhdWx0VmFyaWFudCA9IGZ1bmN0aW9uIHNldERlZmF1bHRWYXJpYW50KG1vZGVsKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzLAogICAgICAgICAgc2VsZWN0ZWRWYXJpYW50OwoKICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdFN0b3JlZnJvbnRWYXJpYW50SWQgPyBzZWxlY3RlZFZhcmlhbnQgPSBtb2RlbC52YXJpYW50cy5maW5kKGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgcmV0dXJuIHZhcmlhbnQuaWQgPT09IF90aGlzNy5kZWZhdWx0U3RvcmVmcm9udFZhcmlhbnRJZDsKICAgICAgfSkgOiAodGhpcy5kZWZhdWx0U3RvcmVmcm9udFZhcmlhbnRJZCA9IG1vZGVsLnZhcmlhbnRzWzBdLmlkLCBzZWxlY3RlZFZhcmlhbnQgPSBtb2RlbC52YXJpYW50c1swXSwgdGhpcy5zZWxlY3RlZEltYWdlID0gbW9kZWwuaW1hZ2VzWzBdKSwgc2VsZWN0ZWRWYXJpYW50IHx8IChzZWxlY3RlZFZhcmlhbnQgPSBtb2RlbC52YXJpYW50c1swXSksIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gc2VsZWN0ZWRWYXJpYW50LnNlbGVjdGVkT3B0aW9ucy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgb3B0aW9uKSB7CiAgICAgICAgcmV0dXJuIGFjY1tvcHRpb24ubmFtZV0gPSBvcHRpb24udmFsdWUsIGFjYzsKICAgICAgfSwge30pLCB0aGlzLnNlbGVjdGVkVmFyaWFudCA9IHNlbGVjdGVkVmFyaWFudCwgbW9kZWw7CiAgICB9LCBfcHJvdG8uaW1hZ2VBbHRUZXh0ID0gZnVuY3Rpb24gaW1hZ2VBbHRUZXh0KGFsdFRleHQpIHsKICAgICAgcmV0dXJuIGFsdFRleHQgfHwgdGhpcy5tb2RlbC50aXRsZTsKICAgIH0sIF9jcmVhdGVDbGFzcyhQcm9kdWN0LCBbewogICAgICBrZXk6ICJzaG91bGRVcGRhdGVJbWFnZSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAhdGhpcy5jYWNoZWRJbWFnZSB8fCB0aGlzLmltYWdlICYmIHRoaXMuaW1hZ2Uuc3JjICE9PSB0aGlzLmNhY2hlZEltYWdlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImN1cnJlbnRJbWFnZSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLnNob3VsZFVwZGF0ZUltYWdlICYmICh0aGlzLmNhY2hlZEltYWdlID0gdGhpcy5pbWFnZSksIHRoaXMuY2FjaGVkSW1hZ2U7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiaW1hZ2UiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgREVGQVVMVF9JTUFHRV9TSVpFID0gNDgwLAogICAgICAgICAgICBNT0RBTF9JTUFHRV9TSVpFID0gNTUwLAogICAgICAgICAgICBpbWFnZVNpemUsCiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBzcmMsCiAgICAgICAgICAgIHNyY0xhcmdlLAogICAgICAgICAgICBzcmNPcmlnaW5hbCwKICAgICAgICAgICAgYWx0VGV4dDsKICAgICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRWYXJpYW50ICYmICF0aGlzLm9wdGlvbnMuY29udGVudHMuaW1nV2l0aENhcm91c2VsKSByZXR1cm4gbnVsbDsKICAgICAgICB2YXIgaW1hZ2VPcHRpb25zID0gewogICAgICAgICAgbWF4V2lkdGg6IGltYWdlU2l6ZSA9IHRoaXMub3B0aW9ucy53aWR0aCAmJiAiJSIgPT09IHRoaXMub3B0aW9ucy53aWR0aC5zbGljZSgtMSkgPyAxZTMgOiBwYXJzZUludCh0aGlzLm9wdGlvbnMud2lkdGgsIDEwKSB8fCA0ODAsCiAgICAgICAgICBtYXhIZWlnaHQ6IDEuNSAqIGltYWdlU2l6ZQogICAgICAgIH0sCiAgICAgICAgICAgIGltYWdlT3B0aW9uc0xhcmdlID0gewogICAgICAgICAgbWF4V2lkdGg6IDU1MCwKICAgICAgICAgIG1heEhlaWdodDogODI1CiAgICAgICAgfTsKICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEltYWdlID8gKGlkID0gdGhpcy5zZWxlY3RlZEltYWdlLmlkLCBzcmMgPSB0aGlzLnByb3BzLmNsaWVudC5pbWFnZS5oZWxwZXJzLmltYWdlRm9yU2l6ZSh0aGlzLnNlbGVjdGVkSW1hZ2UsIGltYWdlT3B0aW9ucyksIHNyY0xhcmdlID0gdGhpcy5wcm9wcy5jbGllbnQuaW1hZ2UuaGVscGVycy5pbWFnZUZvclNpemUodGhpcy5zZWxlY3RlZEltYWdlLCBpbWFnZU9wdGlvbnNMYXJnZSksIHNyY09yaWdpbmFsID0gdGhpcy5zZWxlY3RlZEltYWdlLnNyYywgYWx0VGV4dCA9IHRoaXMuaW1hZ2VBbHRUZXh0KHRoaXMuc2VsZWN0ZWRJbWFnZS5hbHRUZXh0KSkgOiBudWxsID09IHRoaXMuc2VsZWN0ZWRWYXJpYW50LmltYWdlICYmIG51bGwgPT0gdGhpcy5tb2RlbC5pbWFnZXNbMF0gPyAoaWQgPSBudWxsLCBzcmMgPSAiIiwgc3JjTGFyZ2UgPSAiIiwgc3JjT3JpZ2luYWwgPSAiIiwgYWx0VGV4dCA9ICIiKSA6IG51bGwgPT0gdGhpcy5zZWxlY3RlZFZhcmlhbnQuaW1hZ2UgPyAoaWQgPSB0aGlzLm1vZGVsLmltYWdlc1swXS5pZCwgc3JjID0gdGhpcy5tb2RlbC5pbWFnZXNbMF0uc3JjLCBzcmNMYXJnZSA9IHRoaXMucHJvcHMuY2xpZW50LmltYWdlLmhlbHBlcnMuaW1hZ2VGb3JTaXplKHRoaXMubW9kZWwuaW1hZ2VzWzBdLCBpbWFnZU9wdGlvbnNMYXJnZSksIHNyY09yaWdpbmFsID0gdGhpcy5tb2RlbC5pbWFnZXNbMF0uc3JjLCBhbHRUZXh0ID0gdGhpcy5pbWFnZUFsdFRleHQodGhpcy5tb2RlbC5pbWFnZXNbMF0uYWx0VGV4dCkpIDogKGlkID0gdGhpcy5zZWxlY3RlZFZhcmlhbnQuaW1hZ2UuaWQsIHNyYyA9IHRoaXMucHJvcHMuY2xpZW50LmltYWdlLmhlbHBlcnMuaW1hZ2VGb3JTaXplKHRoaXMuc2VsZWN0ZWRWYXJpYW50LmltYWdlLCBpbWFnZU9wdGlvbnMpLCBzcmNMYXJnZSA9IHRoaXMucHJvcHMuY2xpZW50LmltYWdlLmhlbHBlcnMuaW1hZ2VGb3JTaXplKHRoaXMuc2VsZWN0ZWRWYXJpYW50LmltYWdlLCBpbWFnZU9wdGlvbnNMYXJnZSksIHNyY09yaWdpbmFsID0gdGhpcy5zZWxlY3RlZFZhcmlhbnQuaW1hZ2Uuc3JjLCBhbHRUZXh0ID0gdGhpcy5pbWFnZUFsdFRleHQodGhpcy5zZWxlY3RlZFZhcmlhbnQuaW1hZ2UuYWx0VGV4dCkpLCB7CiAgICAgICAgICBpZDogaWQsCiAgICAgICAgICBzcmM6IHNyYywKICAgICAgICAgIHNyY0xhcmdlOiBzcmNMYXJnZSwKICAgICAgICAgIHNyY09yaWdpbmFsOiBzcmNPcmlnaW5hbCwKICAgICAgICAgIGFsdFRleHQ6IGFsdFRleHQKICAgICAgICB9OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZvcm1hdHRlZFByaWNlIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRWYXJpYW50ID8gZm9ybWF0TW9uZXkodGhpcy5zZWxlY3RlZFZhcmlhbnQucHJpY2VWMi5hbW91bnQsIHRoaXMuZ2xvYmFsQ29uZmlnLm1vbmV5Rm9ybWF0KSA6ICIiOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZvcm1hdHRlZENvbXBhcmVBdFByaWNlIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRWYXJpYW50ICYmIHRoaXMuc2VsZWN0ZWRWYXJpYW50LmNvbXBhcmVBdFByaWNlVjIgPyBmb3JtYXRNb25leSh0aGlzLnNlbGVjdGVkVmFyaWFudC5jb21wYXJlQXRQcmljZVYyLmFtb3VudCwgdGhpcy5nbG9iYWxDb25maWcubW9uZXlGb3JtYXQpIDogIiI7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2hvd1VuaXRQcmljZSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAhISh0aGlzLnNlbGVjdGVkVmFyaWFudCAmJiB0aGlzLnNlbGVjdGVkVmFyaWFudC51bml0UHJpY2UgJiYgdGhpcy5vcHRpb25zLmNvbnRlbnRzLnVuaXRQcmljZSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZm9ybWF0dGVkVW5pdFByaWNlIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc2hvd1VuaXRQcmljZSA/IGZvcm1hdE1vbmV5KHRoaXMuc2VsZWN0ZWRWYXJpYW50LnVuaXRQcmljZS5hbW91bnQsIHRoaXMuZ2xvYmFsQ29uZmlnLm1vbmV5Rm9ybWF0KSA6ICIiOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZvcm1hdHRlZFVuaXRQcmljZUJhc2VVbml0IiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgaWYgKCF0aGlzLnNob3dVbml0UHJpY2UpIHJldHVybiAiIjsKICAgICAgICB2YXIgdW5pdFByaWNlTWVhc3VyZW1lbnQgPSB0aGlzLnNlbGVjdGVkVmFyaWFudC51bml0UHJpY2VNZWFzdXJlbWVudDsKICAgICAgICByZXR1cm4gZ2V0VW5pdFByaWNlQmFzZVVuaXQodW5pdFByaWNlTWVhc3VyZW1lbnQucmVmZXJlbmNlVmFsdWUsIHVuaXRQcmljZU1lYXN1cmVtZW50LnJlZmVyZW5jZVVuaXQpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInZpZXdEYXRhIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRoaXMubW9kZWwsIHRoaXMub3B0aW9ucy52aWV3RGF0YSwgewogICAgICAgICAgY2xhc3NlczogdGhpcy5jbGFzc2VzLAogICAgICAgICAgY29udGVudHM6IHRoaXMub3B0aW9ucy5jb250ZW50cywKICAgICAgICAgIHRleHQ6IHRoaXMub3B0aW9ucy50ZXh0LAogICAgICAgICAgb3B0aW9uc0h0bWw6IHRoaXMub3B0aW9uc0h0bWwsCiAgICAgICAgICBkZWNvcmF0ZWRPcHRpb25zOiB0aGlzLmRlY29yYXRlZE9wdGlvbnMsCiAgICAgICAgICBjdXJyZW50SW1hZ2U6IHRoaXMuY3VycmVudEltYWdlLAogICAgICAgICAgYnV0dG9uQ2xhc3M6IHRoaXMuYnV0dG9uQ2xhc3MsCiAgICAgICAgICBoYXNWYXJpYW50czogdGhpcy5oYXNWYXJpYW50cywKICAgICAgICAgIGJ1dHRvbkRpc2FibGVkOiAhdGhpcy5idXR0b25FbmFibGVkLAogICAgICAgICAgc2VsZWN0ZWRWYXJpYW50OiB0aGlzLnNlbGVjdGVkVmFyaWFudCwKICAgICAgICAgIHNlbGVjdGVkUXVhbnRpdHk6IHRoaXMuc2VsZWN0ZWRRdWFudGl0eSwKICAgICAgICAgIGJ1dHRvblRleHQ6IHRoaXMuYnV0dG9uVGV4dCwKICAgICAgICAgIGltZ1N0eWxlOiB0aGlzLmltZ1N0eWxlLAogICAgICAgICAgcXVhbnRpdHlDbGFzczogdGhpcy5xdWFudGl0eUNsYXNzLAogICAgICAgICAgcHJpY2VDbGFzczogdGhpcy5wcmljZUNsYXNzLAogICAgICAgICAgZm9ybWF0dGVkUHJpY2U6IHRoaXMuZm9ybWF0dGVkUHJpY2UsCiAgICAgICAgICBmb3JtYXR0ZWRDb21wYXJlQXRQcmljZTogdGhpcy5mb3JtYXR0ZWRDb21wYXJlQXRQcmljZSwKICAgICAgICAgIHNob3dVbml0UHJpY2U6IHRoaXMuc2hvd1VuaXRQcmljZSwKICAgICAgICAgIGZvcm1hdHRlZFVuaXRQcmljZTogdGhpcy5mb3JtYXR0ZWRVbml0UHJpY2UsCiAgICAgICAgICBmb3JtYXR0ZWRVbml0UHJpY2VCYXNlVW5pdDogdGhpcy5mb3JtYXR0ZWRVbml0UHJpY2VCYXNlVW5pdCwKICAgICAgICAgIGNhcm91c2VsSW5kZXg6IDAsCiAgICAgICAgICBjYXJvdXNlbEltYWdlczogdGhpcy5jYXJvdXNlbEltYWdlcwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNhcm91c2VsSW1hZ2VzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICAgIHJldHVybiB0aGlzLm1vZGVsLmltYWdlcy5tYXAoZnVuY3Rpb24gKGltYWdlKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpZDogaW1hZ2UuaWQsCiAgICAgICAgICAgIHNyYzogaW1hZ2Uuc3JjLAogICAgICAgICAgICBjYXJvdXNlbFNyYzogX3RoaXM4LnByb3BzLmNsaWVudC5pbWFnZS5oZWxwZXJzLmltYWdlRm9yU2l6ZShpbWFnZSwgewogICAgICAgICAgICAgIG1heFdpZHRoOiAxMDAsCiAgICAgICAgICAgICAgbWF4SGVpZ2h0OiAxMDAKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIGlzU2VsZWN0ZWQ6IGltYWdlLmlkID09PSBfdGhpczguY3VycmVudEltYWdlLmlkLAogICAgICAgICAgICBhbHRUZXh0OiBfdGhpczguaW1hZ2VBbHRUZXh0KGltYWdlLmFsdFRleHQpCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImJ1dHRvbkNsYXNzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIGRpc2FibGVkQ2xhc3MgPSB0aGlzLmJ1dHRvbkVuYWJsZWQgPyAiIiA6IHRoaXMuY2xhc3Nlcy5wcm9kdWN0LmRpc2FibGVkLAogICAgICAgICAgICBxdWFudGl0eUNsYXNzID0gdGhpcy5vcHRpb25zLmNvbnRlbnRzLmJ1dHRvbldpdGhRdWFudGl0eSA/IHRoaXMuY2xhc3Nlcy5wcm9kdWN0LmJ1dHRvbkJlc2lkZVF0eSA6ICIiOwogICAgICAgIHJldHVybiAiIi5jb25jYXQoZGlzYWJsZWRDbGFzcywgIiAiKS5jb25jYXQocXVhbnRpdHlDbGFzcyk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAicXVhbnRpdHlDbGFzcyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuY29udGVudHMucXVhbnRpdHlJbmNyZW1lbnQgfHwgdGhpcy5vcHRpb25zLmNvbnRlbnRzLnF1YW50aXR5RGVjcmVtZW50ID8gdGhpcy5jbGFzc2VzLnByb2R1Y3QucXVhbnRpdHlXaXRoQnV0dG9ucyA6ICIiOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImJ1dHRvblRleHQiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gIm1vZGFsIiA9PT0gdGhpcy5vcHRpb25zLmJ1dHRvbkRlc3RpbmF0aW9uID8gdGhpcy5vcHRpb25zLnRleHQuYnV0dG9uIDogdGhpcy52YXJpYW50RXhpc3RzID8gdGhpcy52YXJpYW50SW5TdG9jayA/IHRoaXMub3B0aW9ucy50ZXh0LmJ1dHRvbiA6IHRoaXMub3B0aW9ucy50ZXh0Lm91dE9mU3RvY2sgOiB0aGlzLm9wdGlvbnMudGV4dC51bmF2YWlsYWJsZTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJidXR0b25FbmFibGVkIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICJtb2RhbCIgPT09IHRoaXMub3B0aW9ucy5idXR0b25EZXN0aW5hdGlvbiB8fCB0aGlzLmJ1dHRvbkFjdGlvbkF2YWlsYWJsZSAmJiB0aGlzLnZhcmlhbnRFeGlzdHMgJiYgdGhpcy52YXJpYW50SW5TdG9jazsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ2YXJpYW50RXhpc3RzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICAgIHJldHVybiB0aGlzLm1vZGVsLnZhcmlhbnRzLnNvbWUoZnVuY3Rpb24gKHZhcmlhbnQpIHsKICAgICAgICAgIHJldHVybiAhIV90aGlzOS5zZWxlY3RlZFZhcmlhbnQgJiYgdmFyaWFudC5pZCA9PT0gX3RoaXM5LnNlbGVjdGVkVmFyaWFudC5pZDsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ2YXJpYW50SW5TdG9jayIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLnZhcmlhbnRFeGlzdHMgJiYgdGhpcy5zZWxlY3RlZFZhcmlhbnQuYXZhaWxhYmxlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImhhc1ZhcmlhbnRzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwudmFyaWFudHMubGVuZ3RoID4gMTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJyZXF1aXJlc0NhcnQiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gImNhcnQiID09PSB0aGlzLm9wdGlvbnMuYnV0dG9uRGVzdGluYXRpb247CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiYnV0dG9uQWN0aW9uQXZhaWxhYmxlIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICF0aGlzLnJlcXVpcmVzQ2FydCB8fCBCb29sZWFuKHRoaXMuY2FydCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiaGFzUXVhbnRpdHkiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmNvbnRlbnRzLnF1YW50aXR5SW5wdXQ7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAicHJpY2VDbGFzcyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkVmFyaWFudCAmJiB0aGlzLnNlbGVjdGVkVmFyaWFudC5jb21wYXJlQXRQcmljZVYyID8gdGhpcy5jbGFzc2VzLnByb2R1Y3QubG93ZXJlZFByaWNlIDogIiI7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiaXNCdXR0b24iLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmlzQnV0dG9uICYmICEodGhpcy5vcHRpb25zLmNvbnRlbnRzLmJ1dHRvbiB8fCB0aGlzLm9wdGlvbnMuY29udGVudHMuYnV0dG9uV2l0aFF1YW50aXR5KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJET01FdmVudHMiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgX21lcmdlOwoKICAgICAgICByZXR1cm4gbWVyZ2Uoe30sIChfZGVmaW5lUHJvcGVydHkoX21lcmdlID0gewogICAgICAgICAgY2xpY2s6IHRoaXMuY2xvc2VDYXJ0T25CZ0NsaWNrLmJpbmQodGhpcykKICAgICAgICB9LCAiY2xpY2sgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMub3B0aW9uLnNlbGVjdCksIHRoaXMuc3RvcFByb3BhZ2F0aW9uLmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiZm9jdXMgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMub3B0aW9uLnNlbGVjdCksIHRoaXMuc3RvcFByb3BhZ2F0aW9uLmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiY2xpY2sgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMub3B0aW9uLndyYXBwZXIpLCB0aGlzLnN0b3BQcm9wYWdhdGlvbi5iaW5kKHRoaXMpKSwgX2RlZmluZVByb3BlcnR5KF9tZXJnZSwgImNsaWNrICIuY29uY2F0KHRoaXMuc2VsZWN0b3JzLnByb2R1Y3QucXVhbnRpdHlJbnB1dCksIHRoaXMuc3RvcFByb3BhZ2F0aW9uLmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiY2xpY2sgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMucHJvZHVjdC5xdWFudGl0eUJ1dHRvbiksIHRoaXMuc3RvcFByb3BhZ2F0aW9uLmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiY2hhbmdlICIuY29uY2F0KHRoaXMuc2VsZWN0b3JzLm9wdGlvbi5zZWxlY3QpLCB0aGlzLm9uT3B0aW9uU2VsZWN0LmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiY2xpY2sgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMucHJvZHVjdC5idXR0b24pLCB0aGlzLm9uQnV0dG9uQ2xpY2suYmluZCh0aGlzKSksIF9kZWZpbmVQcm9wZXJ0eShfbWVyZ2UsICJjbGljayAiLmNvbmNhdCh0aGlzLnNlbGVjdG9ycy5wcm9kdWN0LmJsb2NrQnV0dG9uKSwgdGhpcy5vbkJ1dHRvbkNsaWNrLmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAia2V5dXAgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMucHJvZHVjdC5ibG9ja0J1dHRvbiksIHRoaXMub25CbG9ja0J1dHRvbktleXVwLmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiY2xpY2sgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMucHJvZHVjdC5xdWFudGl0eUluY3JlbWVudCksIHRoaXMub25RdWFudGl0eUluY3JlbWVudC5iaW5kKHRoaXMsIDEpKSwgX2RlZmluZVByb3BlcnR5KF9tZXJnZSwgImNsaWNrICIuY29uY2F0KHRoaXMuc2VsZWN0b3JzLnByb2R1Y3QucXVhbnRpdHlEZWNyZW1lbnQpLCB0aGlzLm9uUXVhbnRpdHlJbmNyZW1lbnQuYmluZCh0aGlzLCAtMSkpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiYmx1ciAiLmNvbmNhdCh0aGlzLnNlbGVjdG9ycy5wcm9kdWN0LnF1YW50aXR5SW5wdXQpLCB0aGlzLm9uUXVhbnRpdHlCbHVyLmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiY2xpY2sgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMucHJvZHVjdC5jYXJvdXNlbEl0ZW0pLCB0aGlzLm9uQ2Fyb3VzZWxJdGVtQ2xpY2suYmluZCh0aGlzKSksIF9kZWZpbmVQcm9wZXJ0eShfbWVyZ2UsICJjbGljayAiLmNvbmNhdCh0aGlzLnNlbGVjdG9ycy5wcm9kdWN0LmNhcm91c2VsTmV4dCksIHRoaXMub25DYXJvdXNlbENoYW5nZS5iaW5kKHRoaXMsIDEpKSwgX2RlZmluZVByb3BlcnR5KF9tZXJnZSwgImNsaWNrICIuY29uY2F0KHRoaXMuc2VsZWN0b3JzLnByb2R1Y3QuY2Fyb3VzZWxQcmV2aW91cyksIHRoaXMub25DYXJvdXNlbENoYW5nZS5iaW5kKHRoaXMsIC0xKSksIF9tZXJnZSksIHRoaXMub3B0aW9ucy5ET01FdmVudHMpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm9wdGlvbnNIdG1sIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmNvbnRlbnRzLm9wdGlvbnMgPyB0aGlzLmRlY29yYXRlZE9wdGlvbnMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIG9wdGlvbikgewogICAgICAgICAgdmFyIGRhdGEgPSBtZXJnZShvcHRpb24sIF90aGlzMTAub3B0aW9ucy52aWV3RGF0YSk7CiAgICAgICAgICByZXR1cm4gZGF0YS5jbGFzc2VzID0gX3RoaXMxMC5jbGFzc2VzLCBkYXRhLm9ubHlPcHRpb24gPSAxID09PSBfdGhpczEwLm1vZGVsLm9wdGlvbnMubGVuZ3RoLCBhY2MgKyBfdGhpczEwLmNoaWxkVGVtcGxhdGUucmVuZGVyKHsKICAgICAgICAgICAgZGF0YTogZGF0YQogICAgICAgICAgfSk7CiAgICAgICAgfSwgIiIpIDogIiI7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidmFyaWFudEFycmF5IiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIGRlbGV0ZSB0aGlzLnZhcmlhbnRBcnJheU1lbW8sIHRoaXMudmFyaWFudEFycmF5TWVtbyA9IHRoaXMubW9kZWwudmFyaWFudHMubWFwKGZ1bmN0aW9uICh2YXJpYW50KSB7CiAgICAgICAgICB2YXIgYmV0dGVyVmFyaWFudCA9IHsKICAgICAgICAgICAgaWQ6IHZhcmlhbnQuaWQsCiAgICAgICAgICAgIGF2YWlsYWJsZTogdmFyaWFudC5hdmFpbGFibGUsCiAgICAgICAgICAgIG9wdGlvblZhbHVlczoge30KICAgICAgICAgIH07CiAgICAgICAgICByZXR1cm4gdmFyaWFudC5vcHRpb25WYWx1ZXMuZm9yRWFjaChmdW5jdGlvbiAob3B0aW9uVmFsdWUpIHsKICAgICAgICAgICAgYmV0dGVyVmFyaWFudC5vcHRpb25WYWx1ZXNbb3B0aW9uVmFsdWUubmFtZV0gPSBvcHRpb25WYWx1ZS52YWx1ZTsKICAgICAgICAgIH0pLCBiZXR0ZXJWYXJpYW50OwogICAgICAgIH0pLCB0aGlzLnZhcmlhbnRBcnJheU1lbW87CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZGVjb3JhdGVkT3B0aW9ucyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwub3B0aW9ucy5tYXAoZnVuY3Rpb24gKG9wdGlvbikgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbmFtZTogb3B0aW9uLm5hbWUsCiAgICAgICAgICAgIHZhbHVlczogb3B0aW9uLnZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIG5hbWU6IHZhbHVlLnZhbHVlLAogICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IF90aGlzMTEuc2VsZWN0ZWRPcHRpb25zW29wdGlvbi5uYW1lXSA9PT0gdmFsdWUudmFsdWUKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KQogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ0cmFja2luZ0luZm8iLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICB2YXIgdmFyaWFudCA9IHRoaXMuc2VsZWN0ZWRWYXJpYW50IHx8IHRoaXMubW9kZWwudmFyaWFudHNbMF0sCiAgICAgICAgICAgIGNvbnRlbnRzID0gdGhpcy5vcHRpb25zLmNvbnRlbnRzLAogICAgICAgICAgICBjb250ZW50U3RyaW5nID0gT2JqZWN0LmtleXMoY29udGVudHMpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICByZXR1cm4gY29udGVudHNba2V5XTsKICAgICAgICB9KS50b1N0cmluZygpOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpZDogdGhpcy5tb2RlbC5pZCwKICAgICAgICAgIG5hbWU6IHRoaXMubW9kZWwudGl0bGUsCiAgICAgICAgICB2YXJpYW50SWQ6IHZhcmlhbnQuaWQsCiAgICAgICAgICB2YXJpYW50TmFtZTogdmFyaWFudC50aXRsZSwKICAgICAgICAgIHByaWNlOiB2YXJpYW50LnByaWNlVjIuYW1vdW50LAogICAgICAgICAgZGVzdGluYXRpb246IHRoaXMub3B0aW9ucy5idXR0b25EZXN0aW5hdGlvbiwKICAgICAgICAgIGxheW91dDogdGhpcy5vcHRpb25zLmxheW91dCwKICAgICAgICAgIGNvbnRlbnRzOiBjb250ZW50U3RyaW5nLAogICAgICAgICAgY2hlY2tvdXRQb3B1cDogdGhpcy5jb25maWcuY2FydC5wb3B1cCwKICAgICAgICAgIHNrdTogbnVsbAogICAgICAgIH07CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2VsZWN0ZWRWYXJpYW50VHJhY2tpbmdJbmZvIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIHZhcmlhbnQgPSB0aGlzLnNlbGVjdGVkVmFyaWFudDsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWQ6IHZhcmlhbnQuaWQsCiAgICAgICAgICBuYW1lOiB2YXJpYW50LnRpdGxlLAogICAgICAgICAgcHJvZHVjdElkOiB0aGlzLm1vZGVsLmlkLAogICAgICAgICAgcHJvZHVjdE5hbWU6IHRoaXMubW9kZWwudGl0bGUsCiAgICAgICAgICBxdWFudGl0eTogdGhpcy5zZWxlY3RlZFF1YW50aXR5LAogICAgICAgICAgcHJpY2U6IHZhcmlhbnQucHJpY2VWMi5hbW91bnQsCiAgICAgICAgICBza3U6IG51bGwKICAgICAgICB9OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInByb2R1Y3RUcmFja2luZ0luZm8iLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWQ6IHRoaXMubW9kZWwuaWQKICAgICAgICB9OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm1vZGFsUHJvZHVjdENvbmZpZyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHZhciBfdGhpczEyID0gdGhpcywKICAgICAgICAgICAgbW9kYWxQcm9kdWN0U3R5bGVzOwoKICAgICAgICByZXR1cm4gbW9kYWxQcm9kdWN0U3R5bGVzID0gdGhpcy5jb25maWcucHJvZHVjdC5zdHlsZXMgPyBtZXJnZSh7fSwgT2JqZWN0LmtleXModGhpcy5jb25maWcucHJvZHVjdC5zdHlsZXMpLnJlZHVjZShmdW5jdGlvbiAocHJvZHVjdFN0eWxlcywgc2VsZWN0b3JLZXkpIHsKICAgICAgICAgIHJldHVybiBwcm9kdWN0U3R5bGVzW3NlbGVjdG9yS2V5XSA9IHdoaXRlbGlzdGVkUHJvcGVydGllcyhfdGhpczEyLmNvbmZpZy5wcm9kdWN0LnN0eWxlc1tzZWxlY3RvcktleV0pLCBwcm9kdWN0U3R5bGVzOwogICAgICAgIH0sIHt9KSwgdGhpcy5jb25maWcubW9kYWxQcm9kdWN0LnN0eWxlcykgOiB7fSwgT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb25maWcubW9kYWxQcm9kdWN0LCB7CiAgICAgICAgICBzdHlsZXM6IG1vZGFsUHJvZHVjdFN0eWxlcwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm9ubGluZVN0b3JlUGFyYW1zIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGNoYW5uZWw6ICJidXlfYnV0dG9uIiwKICAgICAgICAgIHJlZmVycmVyOiBlbmNvZGVVUklDb21wb25lbnQod2luZG93VXRpbHNfbG9jYXRpb24oKSksCiAgICAgICAgICB2YXJpYW50OiBhdG9iKHRoaXMuc2VsZWN0ZWRWYXJpYW50LmlkKS5zcGxpdCgiLyIpWzRdCiAgICAgICAgfTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJvbmxpbmVTdG9yZVF1ZXJ5U3RyaW5nIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5vbmxpbmVTdG9yZVBhcmFtcykucmVkdWNlKGZ1bmN0aW9uIChzdHJpbmcsIGtleSkgewogICAgICAgICAgcmV0dXJuICIiLmNvbmNhdChzdHJpbmcpLmNvbmNhdChrZXksICI9IikuY29uY2F0KF90aGlzMTMub25saW5lU3RvcmVQYXJhbXNba2V5XSwgIiYiKTsKICAgICAgICB9LCAiPyIpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm9ubGluZVN0b3JlVVJMIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLm1vZGVsLm9ubGluZVN0b3JlVXJsKS5jb25jYXQodGhpcy5vbmxpbmVTdG9yZVF1ZXJ5U3RyaW5nKTsKICAgICAgfQogICAgfV0pLCBQcm9kdWN0OwogIH0oQ29tcG9uZW50KSwKICAgICAgTW9kYWxWaWV3ID0gZnVuY3Rpb24gKF9WaWV3KSB7CiAgICBmdW5jdGlvbiBNb2RhbFZpZXcoKSB7CiAgICAgIHJldHVybiBfVmlldy5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CiAgICB9CgogICAgX2luaGVyaXRzTG9vc2UoTW9kYWxWaWV3LCBfVmlldyk7CgogICAgdmFyIF9wcm90byA9IE1vZGFsVmlldy5wcm90b3R5cGU7CiAgICByZXR1cm4gX3Byb3RvLndyYXBUZW1wbGF0ZSA9IGZ1bmN0aW9uIHdyYXBUZW1wbGF0ZShodG1sKSB7CiAgICAgIHJldHVybiAnPGRpdiBjbGFzcz0iJy5jb25jYXQodGhpcy5jb21wb25lbnQuY2xhc3Nlcy5tb2RhbC5vdmVybGF5LCAnIj48ZGl2IGNsYXNzPSInKS5jb25jYXQodGhpcy5jb21wb25lbnQuY2xhc3Nlcy5tb2RhbC5tb2RhbCwgJyI+JykuY29uY2F0KGh0bWwsICI8L2Rpdj48L2Rpdj4iKTsKICAgIH0sIF9wcm90by5jbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuY29tcG9uZW50LmlzVmlzaWJsZSA9ICExLCB0aGlzLndyYXBwZXIgJiYgdGhpcy5fY2xvc2VPbkJnQ2xpY2sgJiYgdGhpcy53cmFwcGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoImNsaWNrIiwgdGhpcy5fY2xvc2VPbkJnQ2xpY2spLCByZW1vdmVDbGFzc0Zyb21FbGVtZW50KCJpcy1hY3RpdmUiLCB0aGlzLndyYXBwZXIpLCByZW1vdmVDbGFzc0Zyb21FbGVtZW50KCJpcy1hY3RpdmUiLCB0aGlzLmRvY3VtZW50LmJvZHkpLCByZW1vdmVDbGFzc0Zyb21FbGVtZW50KCJzaG9waWZ5LWJ1eS1tb2RhbC1pcy1hY3RpdmUiLCBkb2N1bWVudC5ib2R5KSwgcmVtb3ZlQ2xhc3NGcm9tRWxlbWVudCgic2hvcGlmeS1idXktbW9kYWwtaXMtYWN0aXZlIiwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImh0bWwiKVswXSksICF0aGlzLmlmcmFtZSkgcmV0dXJuIHJlbW92ZUNsYXNzRnJvbUVsZW1lbnQoImlzLWFjdGl2ZSIsIHRoaXMuY29tcG9uZW50Lm5vZGUpLCB2b2lkIHJlbW92ZUNsYXNzRnJvbUVsZW1lbnQoImlzLWJsb2NrIiwgdGhpcy5jb21wb25lbnQubm9kZSk7CiAgICAgIHRoaXMuaWZyYW1lLnJlbW92ZUNsYXNzKCJpcy1ibG9jayIpLCB0aGlzLmNvbXBvbmVudC5wcm9wcy5icm93c2VyRmVhdHVyZXMudHJhbnNpdGlvbiA/IHRoaXMuaWZyYW1lLnBhcmVudC5hZGRFdmVudExpc3RlbmVyKCJ0cmFuc2l0aW9uZW5kIiwgZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzLmlmcmFtZS5yZW1vdmVDbGFzcygiaXMtYWN0aXZlIik7CiAgICAgIH0pIDogdGhpcy5pZnJhbWUucmVtb3ZlQ2xhc3MoImlzLWFjdGl2ZSIpOwogICAgfSwgX3Byb3RvLmRlbGVnYXRlRXZlbnRzID0gZnVuY3Rpb24gZGVsZWdhdGVFdmVudHMoKSB7CiAgICAgIF9WaWV3LnByb3RvdHlwZS5kZWxlZ2F0ZUV2ZW50cy5jYWxsKHRoaXMpLCB0aGlzLl9jbG9zZU9uQmdDbGljayA9IHRoaXMuY29tcG9uZW50LmNsb3NlT25CZ0NsaWNrLmJpbmQodGhpcy5jb21wb25lbnQpLCB0aGlzLndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCB0aGlzLl9jbG9zZU9uQmdDbGljayk7CiAgICB9LCBfcHJvdG8ucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB0aGlzLmNvbXBvbmVudC5pc1Zpc2libGUgJiYgKF9WaWV3LnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKSwgYWRkQ2xhc3NUb0VsZW1lbnQoImlzLWFjdGl2ZSIsIHRoaXMuZG9jdW1lbnQuYm9keSksIGFkZENsYXNzVG9FbGVtZW50KCJzaG9waWZ5LWJ1eS1tb2RhbC1pcy1hY3RpdmUiLCBkb2N1bWVudC5ib2R5KSwgYWRkQ2xhc3NUb0VsZW1lbnQoInNob3BpZnktYnV5LW1vZGFsLWlzLWFjdGl2ZSIsIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJodG1sIilbMF0pLCBhZGRDbGFzc1RvRWxlbWVudCgiaXMtYWN0aXZlIiwgdGhpcy53cmFwcGVyKSwgdGhpcy5pZnJhbWUgPyAodGhpcy5pZnJhbWUuYWRkQ2xhc3MoImlzLWFjdGl2ZSIpLCB0aGlzLmlmcmFtZS5hZGRDbGFzcygiaXMtYmxvY2siKSkgOiAoYWRkQ2xhc3NUb0VsZW1lbnQoImlzLWFjdGl2ZSIsIHRoaXMuY29tcG9uZW50Lm5vZGUpLCBhZGRDbGFzc1RvRWxlbWVudCgiaXMtYmxvY2siLCB0aGlzLmNvbXBvbmVudC5ub2RlKSkpOwogICAgfSwgTW9kYWxWaWV3OwogIH0oVmlldyksCiAgICAgIE1vZGFsVXBkYXRlciA9IGZ1bmN0aW9uIChfVXBkYXRlcikgewogICAgZnVuY3Rpb24gTW9kYWxVcGRhdGVyKCkgewogICAgICByZXR1cm4gX1VwZGF0ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwogICAgfQoKICAgIHZhciBfcHJvdG87CgogICAgcmV0dXJuIF9pbmhlcml0c0xvb3NlKE1vZGFsVXBkYXRlciwgX1VwZGF0ZXIpLCBNb2RhbFVwZGF0ZXIucHJvdG90eXBlLnVwZGF0ZUNvbmZpZyA9IGZ1bmN0aW9uIHVwZGF0ZUNvbmZpZyhjb25maWcpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfVXBkYXRlci5wcm90b3R5cGUudXBkYXRlQ29uZmlnLmNhbGwodGhpcywgY29uZmlnKSwgdGhpcy5jb21wb25lbnQucHJvZHVjdCA9IG5ldyBQcm9kdWN0JDEodGhpcy5jb21wb25lbnQucHJvZHVjdENvbmZpZywgdGhpcy5jb21wb25lbnQucHJvcHMpLCB0aGlzLmNvbXBvbmVudC5wcm9kdWN0LmluaXQodGhpcy5jb21wb25lbnQubW9kZWwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpcy5jb21wb25lbnQudmlldy5yZXNpemUoKTsKICAgICAgfSk7CiAgICB9LCBNb2RhbFVwZGF0ZXI7CiAgfShVcGRhdGVyKSwKICAgICAgTW9kYWwgPSBmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogICAgZnVuY3Rpb24gTW9kYWwoY29uZmlnLCBwcm9wcykgewogICAgICB2YXIgX3RoaXM7CgogICAgICByZXR1cm4gKF90aGlzID0gX0NvbXBvbmVudC5jYWxsKHRoaXMsIGNvbmZpZywgcHJvcHMpIHx8IHRoaXMpLnR5cGVLZXkgPSAibW9kYWwiLCBfdGhpcy5ub2RlID0gY29uZmlnLm5vZGUgPyBjb25maWcubm9kZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSkgOiBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpKSwgX3RoaXMubm9kZS5jbGFzc05hbWUgPSAic2hvcGlmeS1idXktbW9kYWwtd3JhcHBlciIsIF90aGlzLnByb2R1Y3QgPSBudWxsLCBfdGhpcy51cGRhdGVyID0gbmV3IE1vZGFsVXBkYXRlcihfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSksIF90aGlzLnZpZXcgPSBuZXcgTW9kYWxWaWV3KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKSwgX3RoaXM7CiAgICB9CgogICAgX2luaGVyaXRzTG9vc2UoTW9kYWwsIF9Db21wb25lbnQpOwoKICAgIHZhciBfcHJvdG8gPSBNb2RhbC5wcm90b3R5cGU7CiAgICByZXR1cm4gX3Byb3RvLmNsb3NlT25CZ0NsaWNrID0gZnVuY3Rpb24gY2xvc2VPbkJnQ2xpY2soZXZ0KSB7CiAgICAgIHRoaXMucHJvZHVjdFdyYXBwZXIuY29udGFpbnMoZXZ0LnRhcmdldCkgfHwgdGhpcy5wcm9wcy5jbG9zZU1vZGFsKCk7CiAgICB9LCBfcHJvdG8uaW5pdCA9IGZ1bmN0aW9uIGluaXQoZGF0YSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiB0aGlzLmlzVmlzaWJsZSA9ICEwLCBfQ29tcG9uZW50LnByb3RvdHlwZS5pbml0LmNhbGwodGhpcywgZGF0YSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5wcm9kdWN0V3JhcHBlciA9IF90aGlzMi52aWV3LndyYXBwZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShfdGhpczIuY2xhc3Nlcy5tb2RhbC5tb2RhbClbMF0sIF90aGlzMi5wcm9kdWN0ID0gbmV3IFByb2R1Y3QkMShfdGhpczIucHJvZHVjdENvbmZpZywgX3RoaXMyLnByb3BzKSwgX3RoaXMyLnByb2R1Y3QuaW5pdChfdGhpczIubW9kZWwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi52aWV3LnNldEZvY3VzKCksIF90aGlzMi52aWV3LnJlc2l6ZSgpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sIF9wcm90by5jbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgICB0aGlzLl91c2VyRXZlbnQoImNsb3NlTW9kYWwiKSwgdGhpcy52aWV3LmNsb3NlKCk7CiAgICB9LCBfY3JlYXRlQ2xhc3MoTW9kYWwsIFt7CiAgICAgIGtleTogIkRPTUV2ZW50cyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBfZGVmaW5lUHJvcGVydHkoe30sICJjbGljayAiLmNvbmNhdCh0aGlzLnNlbGVjdG9ycy5tb2RhbC5jbG9zZSksIHRoaXMucHJvcHMuY2xvc2VNb2RhbC5iaW5kKHRoaXMpKSwgdGhpcy5vcHRpb25zLkRPTUV2ZW50cyk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAicHJvZHVjdENvbmZpZyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmdsb2JhbENvbmZpZywgewogICAgICAgICAgbm9kZTogdGhpcy5wcm9kdWN0V3JhcHBlciwKICAgICAgICAgIG9wdGlvbnM6IG1lcmdlKHt9LCB0aGlzLmNvbmZpZykKICAgICAgICB9KTsKICAgICAgfQogICAgfV0pLCBNb2RhbDsKICB9KENvbXBvbmVudCksCiAgICAgIFByb2R1Y3RTZXRVcGRhdGVyID0gZnVuY3Rpb24gKF9VcGRhdGVyKSB7CiAgICBmdW5jdGlvbiBQcm9kdWN0U2V0VXBkYXRlcigpIHsKICAgICAgcmV0dXJuIF9VcGRhdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKICAgIH0KCiAgICB2YXIgX3Byb3RvOwoKICAgIHJldHVybiBfaW5oZXJpdHNMb29zZShQcm9kdWN0U2V0VXBkYXRlciwgX1VwZGF0ZXIpLCBQcm9kdWN0U2V0VXBkYXRlci5wcm90b3R5cGUudXBkYXRlQ29uZmlnID0gZnVuY3Rpb24gdXBkYXRlQ29uZmlnKGNvbmZpZykgewogICAgICBfVXBkYXRlci5wcm90b3R5cGUudXBkYXRlQ29uZmlnLmNhbGwodGhpcywgY29uZmlnKSwgdGhpcy5jb21wb25lbnQucHJvZHVjdHNbMF0udXBkYXRlQ29uZmlnKHsKICAgICAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBjb25maWcub3B0aW9ucykKICAgICAgfSksIHRoaXMuY29tcG9uZW50LmNhcnQudXBkYXRlQ29uZmlnKGNvbmZpZyksIHRoaXMuY29tcG9uZW50LnJlbmRlclByb2R1Y3RzKCk7CiAgICB9LCBQcm9kdWN0U2V0VXBkYXRlcjsKICB9KFVwZGF0ZXIpLAogICAgICBwb2xsSW50ZXJ2YWwgPSAyMDAsCiAgICAgIFByb2R1Y3RTZXRWaWV3ID0gZnVuY3Rpb24gKF9WaWV3KSB7CiAgICBmdW5jdGlvbiBQcm9kdWN0U2V0Vmlldyhjb21wb25lbnQpIHsKICAgICAgdmFyIF90aGlzOwoKICAgICAgcmV0dXJuIChfdGhpcyA9IF9WaWV3LmNhbGwodGhpcywgY29tcG9uZW50KSB8fCB0aGlzKS5oZWlnaHQgPSAwLCBfdGhpcy5yZXNpemVDb21wbGV0ZWQgPSAhMSwgX3RoaXM7CiAgICB9CgogICAgX2luaGVyaXRzTG9vc2UoUHJvZHVjdFNldFZpZXcsIF9WaWV3KTsKCiAgICB2YXIgX3Byb3RvID0gUHJvZHVjdFNldFZpZXcucHJvdG90eXBlOwogICAgcmV0dXJuIF9wcm90by53cmFwVGVtcGxhdGUgPSBmdW5jdGlvbiB3cmFwVGVtcGxhdGUoaHRtbCkgewogICAgICByZXR1cm4gJzxkaXYgY2xhc3M9IicuY29uY2F0KHRoaXMuY29tcG9uZW50LmNsYXNzZXMucHJvZHVjdFNldC5wcm9kdWN0U2V0LCAnIj4nKS5jb25jYXQoaHRtbCwgIjwvZGl2PiIpOwogICAgfSwgX3Byb3RvLnJlc2l6ZVVudGlsRml0cyA9IGZ1bmN0aW9uIHJlc2l6ZVVudGlsRml0cygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAodGhpcy5pZnJhbWUgJiYgIXRoaXMucmVzaXplQ29tcGxldGVkKSB7CiAgICAgICAgdmFyIG1heFJlc2l6ZXMgPSB0aGlzLmNvbXBvbmVudC5wcm9kdWN0cy5sZW5ndGgsCiAgICAgICAgICAgIHJlc2l6ZXMgPSAwOwogICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5vdXRlckhlaWdodCwgdGhpcy5yZXNpemUoKTsKICAgICAgICB2YXIgcHJvZHVjdFNldFJlc2l6ZSA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBjdXJyZW50SGVpZ2h0ID0gX3RoaXMyLm91dGVySGVpZ2h0OwogICAgICAgICAgcGFyc2VJbnQoY3VycmVudEhlaWdodCwgMTApID4gcGFyc2VJbnQoX3RoaXMyLmhlaWdodCwgMTApICYmIChyZXNpemVzKyssIF90aGlzMi5oZWlnaHQgPSBjdXJyZW50SGVpZ2h0LCBfdGhpczIucmVzaXplKGN1cnJlbnRIZWlnaHQpKSwgcmVzaXplcyA+IG1heFJlc2l6ZXMgJiYgKF90aGlzMi5yZXNpemVDb21wbGV0ZWQgPSAhMCwgY2xlYXJJbnRlcnZhbChwcm9kdWN0U2V0UmVzaXplKSk7CiAgICAgICAgfSwgMjAwKTsKICAgICAgfQogICAgfSwgX2NyZWF0ZUNsYXNzKFByb2R1Y3RTZXRWaWV3LCBbewogICAgICBrZXk6ICJzaG91bGRSZXNpemVZIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICEwOwogICAgICB9CiAgICB9XSksIFByb2R1Y3RTZXRWaWV3OwogIH0oVmlldyk7CgogIGZ1bmN0aW9uIGlzQXJyYXkkMShhcmcpIHsKICAgIHJldHVybiAiW29iamVjdCBBcnJheV0iID09PSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJnKTsKICB9CgogIHZhciBQcm9kdWN0U2V0ID0gZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICAgIGZ1bmN0aW9uIFByb2R1Y3RTZXQoY29uZmlnLCBwcm9wcykgewogICAgICB2YXIgX3RoaXM7CgogICAgICByZXR1cm4gY29uZmlnID0gQXJyYXkuaXNBcnJheShjb25maWcuaWQpID8gbm9ybWFsaXplQ29uZmlnKGNvbmZpZykgOiBub3JtYWxpemVDb25maWcoY29uZmlnLCAiQ29sbGVjdGlvbiIpLCAoX3RoaXMgPSBfQ29tcG9uZW50LmNhbGwodGhpcywgY29uZmlnLCBwcm9wcykgfHwgdGhpcykudHlwZUtleSA9ICJwcm9kdWN0U2V0IiwgX3RoaXMucHJvZHVjdHMgPSBbXSwgX3RoaXMuY2FydCA9IG51bGwsIF90aGlzLnBhZ2UgPSAxLCBfdGhpcy5uZXh0TW9kZWwgPSB7CiAgICAgICAgcHJvZHVjdHM6IFtdCiAgICAgIH0sIF90aGlzLnVwZGF0ZXIgPSBuZXcgUHJvZHVjdFNldFVwZGF0ZXIoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpLCBfdGhpcy52aWV3ID0gbmV3IFByb2R1Y3RTZXRWaWV3KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKSwgX3RoaXM7CiAgICB9CgogICAgX2luaGVyaXRzTG9vc2UoUHJvZHVjdFNldCwgX0NvbXBvbmVudCk7CgogICAgdmFyIF9wcm90byA9IFByb2R1Y3RTZXQucHJvdG90eXBlOwogICAgcmV0dXJuIF9wcm90by5pbml0ID0gZnVuY3Rpb24gaW5pdChkYXRhKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzLAogICAgICAgICAgY2FydENvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZ2xvYmFsQ29uZmlnLCB7CiAgICAgICAgbm9kZTogdGhpcy5nbG9iYWxDb25maWcuY2FydE5vZGUsCiAgICAgICAgb3B0aW9uczogdGhpcy5jb25maWcKICAgICAgfSk7CgogICAgICByZXR1cm4gdGhpcy5wcm9wcy5jcmVhdGVDYXJ0KGNhcnRDb25maWcpLnRoZW4oZnVuY3Rpb24gKGNhcnQpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLmNhcnQgPSBjYXJ0LCBfQ29tcG9uZW50LnByb3RvdHlwZS5pbml0LmNhbGwoX3RoaXMyLCBkYXRhKS50aGVuKGZ1bmN0aW9uIChtb2RlbCkgewogICAgICAgICAgcmV0dXJuIG1vZGVsID8gX3RoaXMyLnJlbmRlclByb2R1Y3RzKF90aGlzMi5tb2RlbC5wcm9kdWN0cykgOiBfdGhpczI7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLnNka0ZldGNoID0gZnVuY3Rpb24gc2RrRmV0Y2goKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzLAogICAgICAgICAgcHJvbWlzZTsKCiAgICAgIHJldHVybiB0aGlzLnN0b3JlZnJvbnRJZCA/IHByb21pc2UgPSBBcnJheS5pc0FycmF5KHRoaXMuc3RvcmVmcm9udElkKSA/IHRoaXMucHJvcHMuY2xpZW50LnByb2R1Y3QuZmV0Y2hNdWx0aXBsZSh0aGlzLnN0b3JlZnJvbnRJZCkgOiB0aGlzLnByb3BzLmNsaWVudC5jb2xsZWN0aW9uLmZldGNoV2l0aFByb2R1Y3RzKHRoaXMuc3RvcmVmcm9udElkKSA6IHRoaXMuaGFuZGxlICYmIChwcm9taXNlID0gdGhpcy5wcm9wcy5jbGllbnQuY29sbGVjdGlvbi5mZXRjaEJ5SGFuZGxlKHRoaXMuaGFuZGxlKS50aGVuKGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5zdG9yZWZyb250SWQgPSBjb2xsZWN0aW9uLmlkLCBfdGhpczMucHJvcHMuY2xpZW50LmNvbGxlY3Rpb24uZmV0Y2hXaXRoUHJvZHVjdHMoX3RoaXMzLnN0b3JlZnJvbnRJZCk7CiAgICAgIH0pKSwgcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChjb2xsZWN0aW9uT3JQcm9kdWN0cykgewogICAgICAgIHZhciBwcm9kdWN0czsKICAgICAgICByZXR1cm4gcHJvZHVjdHMgPSBBcnJheS5pc0FycmF5KGNvbGxlY3Rpb25PclByb2R1Y3RzKSA/IGNvbGxlY3Rpb25PclByb2R1Y3RzIDogY29sbGVjdGlvbk9yUHJvZHVjdHMucHJvZHVjdHM7CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLmZldGNoRGF0YSA9IGZ1bmN0aW9uIGZldGNoRGF0YSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc2RrRmV0Y2goKS50aGVuKGZ1bmN0aW9uIChwcm9kdWN0cykgewogICAgICAgIGlmIChwcm9kdWN0cy5sZW5ndGgpIHJldHVybiB7CiAgICAgICAgICBwcm9kdWN0czogcHJvZHVjdHMKICAgICAgICB9OwogICAgICAgIHRocm93IG5ldyBFcnJvcigiTm90IEZvdW5kIik7CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLnNob3dQYWdpbmF0aW9uID0gZnVuY3Rpb24gc2hvd1BhZ2luYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY2xpZW50LmZldGNoTmV4dFBhZ2UodGhpcy5tb2RlbC5wcm9kdWN0cykudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIF90aGlzNC5uZXh0TW9kZWwgPSB7CiAgICAgICAgICBwcm9kdWN0czogZGF0YS5tb2RlbAogICAgICAgIH0sIF90aGlzNC52aWV3LnJlbmRlckNoaWxkKF90aGlzNC5jbGFzc2VzLnByb2R1Y3RTZXQucGFnaW5hdGlvbkJ1dHRvbiwgX3RoaXM0LnBhZ2luYXRpb25UZW1wbGF0ZSksIF90aGlzNC52aWV3LnJlc2l6ZSgpOwogICAgICB9KTsKICAgIH0sIF9wcm90by5uZXh0UGFnZSA9IGZ1bmN0aW9uIG5leHRQYWdlKCkgewogICAgICB0aGlzLm1vZGVsID0gdGhpcy5uZXh0TW9kZWwsIHRoaXMuX3VzZXJFdmVudCgibG9hZE5leHRQYWdlIiksIHRoaXMucmVuZGVyUHJvZHVjdHMoKTsKICAgIH0sIF9wcm90by5yZW5kZXJQcm9kdWN0cyA9IGZ1bmN0aW9uIHJlbmRlclByb2R1Y3RzKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5tb2RlbC5wcm9kdWN0cy5sZW5ndGgpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgdmFyIHByb2R1Y3RDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmdsb2JhbENvbmZpZywgewogICAgICAgIG5vZGU6IHRoaXMudmlldy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQodGhpcy5jbGFzc2VzLnByb2R1Y3RTZXQucHJvZHVjdHMpKSwKICAgICAgICBvcHRpb25zOiBtZXJnZSh7fSwgdGhpcy5jb25maWcsIHsKICAgICAgICAgIHByb2R1Y3Q6IHsKICAgICAgICAgICAgaWZyYW1lOiAhMSwKICAgICAgICAgICAgY2xhc3NlczogewogICAgICAgICAgICAgIHdyYXBwZXI6IHRoaXMuY2xhc3Nlcy5wcm9kdWN0U2V0LnByb2R1Y3QKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0pOwogICAgICAhMSA9PT0gdGhpcy5jb25maWcucHJvZHVjdFNldC5pZnJhbWUgJiYgKHByb2R1Y3RDb25maWcubm9kZSA9IHRoaXMubm9kZS5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQodGhpcy5jbGFzc2VzLnByb2R1Y3RTZXQucHJvZHVjdHMpKSk7CiAgICAgIHZhciBwcm9taXNlcyA9IHRoaXMubW9kZWwucHJvZHVjdHMubWFwKGZ1bmN0aW9uIChwcm9kdWN0TW9kZWwpIHsKICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBQcm9kdWN0JDEocHJvZHVjdENvbmZpZywgX3RoaXM1LnByb3BzKTsKICAgICAgICByZXR1cm4gX3RoaXM1LnByb2R1Y3RzLnB1c2gocHJvZHVjdCksIHByb2R1Y3QuaW5pdChwcm9kdWN0TW9kZWwpOwogICAgICB9KTsKICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczUudmlldy5yZXNpemVVbnRpbEZpdHMoKTsKCiAgICAgICAgdmFyIGhhc1BhZ2luYXRpb24gPSBfdGhpczUubW9kZWwucHJvZHVjdHNbMF0uaGFzT3duUHJvcGVydHkoImhhc05leHRQYWdlIik7CgogICAgICAgIHJldHVybiBfdGhpczUub3B0aW9ucy5jb250ZW50cy5wYWdpbmF0aW9uICYmIGhhc1BhZ2luYXRpb24gJiYgX3RoaXM1LnNob3dQYWdpbmF0aW9uKCksIF90aGlzNTsKICAgICAgfSk7CiAgICB9LCBfY3JlYXRlQ2xhc3MoUHJvZHVjdFNldCwgW3sKICAgICAga2V5OiAibmV4dEJ1dHRvbkNsYXNzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmV4dE1vZGVsLnByb2R1Y3RzLmxlbmd0aCA/ICJpcy1hY3RpdmUiIDogIiI7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidmlld0RhdGEiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5vcHRpb25zLnZpZXdEYXRhLCB7CiAgICAgICAgICBjbGFzc2VzOiB0aGlzLmNsYXNzZXMsCiAgICAgICAgICB0ZXh0OiB0aGlzLm9wdGlvbnMudGV4dCwKICAgICAgICAgIG5leHRCdXR0b25DbGFzczogdGhpcy5uZXh0QnV0dG9uQ2xhc3MKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJET01FdmVudHMiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgX2RlZmluZVByb3BlcnR5KHsKICAgICAgICAgIGNsaWNrOiB0aGlzLnByb3BzLmNsb3NlQ2FydC5iaW5kKHRoaXMpCiAgICAgICAgfSwgImNsaWNrICIuY29uY2F0KHRoaXMuc2VsZWN0b3JzLnByb2R1Y3RTZXQucGFnaW5hdGlvbkJ1dHRvbiksIHRoaXMubmV4dFBhZ2UuYmluZCh0aGlzKSksIHRoaXMub3B0aW9ucy5ET01FdmVudHMpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInBhZ2luYXRpb25UZW1wbGF0ZSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLl9wYWdpbmF0aW9uVGVtcGxhdGUgPSB0aGlzLl9wYWdpbmF0aW9uVGVtcGxhdGUgfHwgbmV3IFRlbXBsYXRlKHsKICAgICAgICAgIHBhZ2luYXRpb246IHRoaXMub3B0aW9ucy50ZW1wbGF0ZXMucGFnaW5hdGlvbgogICAgICAgIH0sIHsKICAgICAgICAgIHBhZ2luYXRpb246ICEwCiAgICAgICAgfSwgWyJwYWdpbmF0aW9uIl0pLCB0aGlzLl9wYWdpbmF0aW9uVGVtcGxhdGU7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidHJhY2tpbmdJbmZvIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIGNvbnRlbnRzID0gdGhpcy5jb25maWcucHJvZHVjdC5jb250ZW50cywKICAgICAgICAgICAgY29udGVudFN0cmluZyA9IE9iamVjdC5rZXlzKGNvbnRlbnRzKS5maWx0ZXIoZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgcmV0dXJuIGNvbnRlbnRzW2tleV07CiAgICAgICAgfSkudG9TdHJpbmcoKSwKICAgICAgICAgICAgY29uZmlnID0gewogICAgICAgICAgZGVzdGluYXRpb246IHRoaXMuY29uZmlnLnByb2R1Y3QuYnV0dG9uRGVzdGluYXRpb24sCiAgICAgICAgICBsYXlvdXQ6IHRoaXMuY29uZmlnLnByb2R1Y3QubGF5b3V0LAogICAgICAgICAgY29udGVudHM6IGNvbnRlbnRTdHJpbmcsCiAgICAgICAgICBjaGVja291dFBvcHVwOiB0aGlzLmNvbmZpZy5jYXJ0LnBvcHVwCiAgICAgICAgfTsKICAgICAgICByZXR1cm4gaXNBcnJheSQxKHRoaXMuaWQpID8gdGhpcy5tb2RlbC5wcm9kdWN0cy5tYXAoZnVuY3Rpb24gKHByb2R1Y3QpIHsKICAgICAgICAgIHZhciB2YXJpYW50ID0gcHJvZHVjdC52YXJpYW50c1swXTsKICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjb25maWcsIHsKICAgICAgICAgICAgaWQ6IHByb2R1Y3QuaWQsCiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QudGl0bGUsCiAgICAgICAgICAgIHZhcmlhbnRJZDogdmFyaWFudC5pZCwKICAgICAgICAgICAgdmFyaWFudE5hbWU6IHZhcmlhbnQudGl0bGUsCiAgICAgICAgICAgIHByaWNlOiB2YXJpYW50LnByaWNlVjIuYW1vdW50LAogICAgICAgICAgICBza3U6IG51bGwsCiAgICAgICAgICAgIGlzUHJvZHVjdFNldDogITAKICAgICAgICAgIH0pOwogICAgICAgIH0pIDogT2JqZWN0LmFzc2lnbihjb25maWcsIHsKICAgICAgICAgIGlkOiB0aGlzLnN0b3JlZnJvbnRJZAogICAgICAgIH0pOwogICAgICB9CiAgICB9XSksIFByb2R1Y3RTZXQ7CiAgfShDb21wb25lbnQpLAogICAgICBFTlRFUl9LRVkkMSA9IDEzLAogICAgICBUb2dnbGVWaWV3ID0gZnVuY3Rpb24gKF9WaWV3KSB7CiAgICBmdW5jdGlvbiBUb2dnbGVWaWV3KCkgewogICAgICByZXR1cm4gX1ZpZXcuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwogICAgfQoKICAgIF9pbmhlcml0c0xvb3NlKFRvZ2dsZVZpZXcsIF9WaWV3KTsKCiAgICB2YXIgX3Byb3RvID0gVG9nZ2xlVmlldy5wcm90b3R5cGU7CiAgICByZXR1cm4gX3Byb3RvLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgX1ZpZXcucHJvdG90eXBlLnJlbmRlci5jYWxsKHRoaXMpLCB0aGlzLmNvbXBvbmVudC5vcHRpb25zLnN0aWNreSAmJiB0aGlzLmFkZENsYXNzKCJpcy1zdGlja3kiKSwgdGhpcy5pc1Zpc2libGUgPyB0aGlzLmFkZENsYXNzKCJpcy1hY3RpdmUiKSA6IHRoaXMucmVtb3ZlQ2xhc3MoImlzLWFjdGl2ZSIpLCB0aGlzLmlmcmFtZSAmJiAodGhpcy5pZnJhbWUucGFyZW50LnNldEF0dHJpYnV0ZSgidGFiaW5kZXgiLCAwKSwgdGhpcy5pZnJhbWUucGFyZW50LnNldEF0dHJpYnV0ZSgicm9sZSIsICJidXR0b24iKSwgdGhpcy5pZnJhbWUucGFyZW50LnNldEF0dHJpYnV0ZSgiYXJpYS1sYWJlbCIsIHRoaXMuY29tcG9uZW50Lm9wdGlvbnMudGV4dC50aXRsZSksIHRoaXMucmVzaXplKCkpOwogICAgfSwgX3Byb3RvLmRlbGVnYXRlRXZlbnRzID0gZnVuY3Rpb24gZGVsZWdhdGVFdmVudHMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfVmlldy5wcm90b3R5cGUuZGVsZWdhdGVFdmVudHMuY2FsbCh0aGlzKSwgdGhpcy5pZnJhbWUgJiYgdGhpcy5pZnJhbWUucGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCBmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgMTMgPT09IGV2dC5rZXlDb2RlICYmIF90aGlzLmNvbXBvbmVudC5wcm9wcy5jYXJ0LnRvZ2dsZVZpc2liaWxpdHkoX3RoaXMuY29tcG9uZW50LnByb3BzLmNhcnQpOwogICAgICB9KTsKICAgIH0sIF9wcm90by53cmFwVGVtcGxhdGUgPSBmdW5jdGlvbiB3cmFwVGVtcGxhdGUoaHRtbCkgewogICAgICByZXR1cm4gJzxkaXYgY2xhc3M9IicuY29uY2F0KHRoaXMuc3RpY2t5Q2xhc3MsICIgIikuY29uY2F0KHRoaXMuY29tcG9uZW50LmNsYXNzZXMudG9nZ2xlLnRvZ2dsZSwgJyI+XG4gICAgICAnKS5jb25jYXQoaHRtbCwgIlxuICAgICAgIikuY29uY2F0KHRoaXMucmVhZGFibGVMYWJlbCwgIlxuICAgIDwvZGl2PiIpOwogICAgfSwgX3Byb3RvLl9yZXNpemVYID0gZnVuY3Rpb24gX3Jlc2l6ZVgoKSB7CiAgICAgIHRoaXMuaWZyYW1lLmVsLnN0eWxlLndpZHRoID0gIiIuY29uY2F0KHRoaXMud3JhcHBlci5jbGllbnRXaWR0aCwgInB4Iik7CiAgICB9LCBfY3JlYXRlQ2xhc3MoVG9nZ2xlVmlldywgW3sKICAgICAga2V5OiAic2hvdWxkUmVzaXplWSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAhMDsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzaG91bGRSZXNpemVYIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICEwOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImlzVmlzaWJsZSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5jb3VudCA+IDA7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic3RpY2t5Q2xhc3MiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQub3B0aW9ucy5zdGlja3kgPyAiaXMtc3RpY2t5IiA6ICJpcy1pbmxpbmUiOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm91dGVySGVpZ2h0IiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLndyYXBwZXIuY2xpZW50SGVpZ2h0LCAicHgiKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJyZWFkYWJsZUxhYmVsIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50Lm9wdGlvbnMuY29udGVudHMudGl0bGUgPyAiIiA6ICc8cCBjbGFzcz0ic2hvcGlmeS1idXktLXZpc3VhbGx5LWhpZGRlbiI+Jy5jb25jYXQodGhpcy5jb21wb25lbnQub3B0aW9ucy50ZXh0LnRpdGxlLCAiPC9wPiIpOwogICAgICB9CiAgICB9XSksIFRvZ2dsZVZpZXc7CiAgfShWaWV3KSwKICAgICAgQ2FydFRvZ2dsZSA9IGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgICBmdW5jdGlvbiBDYXJ0VG9nZ2xlKGNvbmZpZywgcHJvcHMpIHsKICAgICAgdmFyIF90aGlzOwoKICAgICAgcmV0dXJuIChfdGhpcyA9IF9Db21wb25lbnQuY2FsbCh0aGlzLCBjb25maWcsIHByb3BzKSB8fCB0aGlzKS50eXBlS2V5ID0gInRvZ2dsZSIsIF90aGlzLm5vZGUgPSBjb25maWcubm9kZSB8fCBfdGhpcy5wcm9wcy5jYXJ0Lm5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksIF90aGlzLnByb3BzLmNhcnQubm9kZSksIF90aGlzLnZpZXcgPSBuZXcgVG9nZ2xlVmlldyhfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSksIF90aGlzOwogICAgfQoKICAgIHZhciBfcHJvdG87CgogICAgcmV0dXJuIF9pbmhlcml0c0xvb3NlKENhcnRUb2dnbGUsIF9Db21wb25lbnQpLCBDYXJ0VG9nZ2xlLnByb3RvdHlwZS50b2dnbGVDYXJ0ID0gZnVuY3Rpb24gdG9nZ2xlQ2FydChldnQpIHsKICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpLCB0aGlzLnByb3BzLmNhcnQudG9nZ2xlVmlzaWJpbGl0eSgpOwogICAgfSwgX2NyZWF0ZUNsYXNzKENhcnRUb2dnbGUsIFt7CiAgICAgIGtleTogImNvdW50IiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY2FydC5tb2RlbCA/IHRoaXMucHJvcHMuY2FydC5tb2RlbC5saW5lSXRlbXMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIGxpbmVJdGVtKSB7CiAgICAgICAgICByZXR1cm4gYWNjICsgbGluZUl0ZW0ucXVhbnRpdHk7CiAgICAgICAgfSwgMCkgOiAwOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInZpZXdEYXRhIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRoaXMub3B0aW9ucy52aWV3RGF0YSwgewogICAgICAgICAgY2xhc3NlczogdGhpcy5jbGFzc2VzLAogICAgICAgICAgdGV4dDogdGhpcy5vcHRpb25zLnRleHQsCiAgICAgICAgICBjb3VudDogdGhpcy5jb3VudAogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIkRPTUV2ZW50cyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiBtZXJnZSh7fSwgewogICAgICAgICAgY2xpY2s6IHRoaXMudG9nZ2xlQ2FydC5iaW5kKHRoaXMpCiAgICAgICAgfSwgdGhpcy5vcHRpb25zLkRPTUV2ZW50cyk7CiAgICAgIH0KICAgIH1dKSwgQ2FydFRvZ2dsZTsKICB9KENvbXBvbmVudCksCiAgICAgIENhcnRWaWV3ID0gZnVuY3Rpb24gKF9WaWV3KSB7CiAgICBmdW5jdGlvbiBDYXJ0Vmlldyhjb21wb25lbnQpIHsKICAgICAgdmFyIF90aGlzOwoKICAgICAgcmV0dXJuIChfdGhpcyA9IF9WaWV3LmNhbGwodGhpcywgY29tcG9uZW50KSB8fCB0aGlzKS5ub2RlLmNsYXNzTmFtZSA9ICJzaG9waWZ5LWJ1eS1jYXJ0LXdyYXBwZXIiLCBfdGhpczsKICAgIH0KCiAgICBfaW5oZXJpdHNMb29zZShDYXJ0VmlldywgX1ZpZXcpOwoKICAgIHZhciBfcHJvdG8gPSBDYXJ0Vmlldy5wcm90b3R5cGU7CiAgICByZXR1cm4gX3Byb3RvLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgX1ZpZXcucHJvdG90eXBlLnJlbmRlci5jYWxsKHRoaXMpLCB0aGlzLmNvbXBvbmVudC5pc1Zpc2libGUgPyAodGhpcy5hZGRDbGFzcygiaXMtYWN0aXZlIiksIHRoaXMuYWRkQ2xhc3MoImlzLWluaXRpYWxpemVkIikpIDogdGhpcy5yZW1vdmVDbGFzcygiaXMtYWN0aXZlIik7CiAgICB9LCBfcHJvdG8ud3JhcFRlbXBsYXRlID0gZnVuY3Rpb24gd3JhcFRlbXBsYXRlKGh0bWwpIHsKICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPSInLmNvbmNhdCh0aGlzLmNvbXBvbmVudC5jbGFzc2VzLmNhcnQuY2FydCwgJyI+JykuY29uY2F0KGh0bWwsICI8L2Rpdj4iKTsKICAgIH0sIF9jcmVhdGVDbGFzcyhDYXJ0VmlldywgW3sKICAgICAga2V5OiAid3JhcHBlckNsYXNzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50LmlzVmlzaWJsZSA/ICJpcy1hY3RpdmUiIDogIiI7CiAgICAgIH0KICAgIH1dKSwgQ2FydFZpZXc7CiAgfShWaWV3KSwKICAgICAgQ2FydFVwZGF0ZXIgPSBmdW5jdGlvbiAoX1VwZGF0ZXIpIHsKICAgIGZ1bmN0aW9uIENhcnRVcGRhdGVyKCkgewogICAgICByZXR1cm4gX1VwZGF0ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwogICAgfQoKICAgIHZhciBfcHJvdG87CgogICAgcmV0dXJuIF9pbmhlcml0c0xvb3NlKENhcnRVcGRhdGVyLCBfVXBkYXRlciksIENhcnRVcGRhdGVyLnByb3RvdHlwZS51cGRhdGVDb25maWcgPSBmdW5jdGlvbiB1cGRhdGVDb25maWcoY29uZmlnKSB7CiAgICAgIF9VcGRhdGVyLnByb3RvdHlwZS51cGRhdGVDb25maWcuY2FsbCh0aGlzLCBjb25maWcpLCB0aGlzLmNvbXBvbmVudC50b2dnbGVzLmZvckVhY2goZnVuY3Rpb24gKHRvZ2dsZSkgewogICAgICAgIHJldHVybiB0b2dnbGUudXBkYXRlQ29uZmlnKGNvbmZpZyk7CiAgICAgIH0pOwogICAgfSwgQ2FydFVwZGF0ZXI7CiAgfShVcGRhdGVyKSwKICAgICAgTk9fSU1HX1VSTCA9ICIvL3Nka3Muc2hvcGlmeWNkbi5jb20vYnV5LWJ1dHRvbi9sYXRlc3Qvbm8taW1hZ2UuanBnIiwKICAgICAgTElORV9JVEVNX1RBUkdFVF9TRUxFQ1RJT05TID0gWyJFTlRJVExFRCIsICJFWFBMSUNJVCJdLAogICAgICBDQVJUX1RBUkdFVF9TRUxFQ1RJT04gPSAiQUxMIiwKICAgICAgQ2FydCA9IGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgICBmdW5jdGlvbiBDYXJ0KGNvbmZpZywgcHJvcHMpIHsKICAgICAgdmFyIF90aGlzOwoKICAgICAgKF90aGlzID0gX0NvbXBvbmVudC5jYWxsKHRoaXMsIGNvbmZpZywgcHJvcHMpIHx8IHRoaXMpLmFkZFZhcmlhbnRUb0NhcnQgPSBfdGhpcy5hZGRWYXJpYW50VG9DYXJ0LmJpbmQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpLCBfdGhpcy5jaGlsZFRlbXBsYXRlID0gbmV3IFRlbXBsYXRlKF90aGlzLmNvbmZpZy5saW5lSXRlbS50ZW1wbGF0ZXMsIF90aGlzLmNvbmZpZy5saW5lSXRlbS5jb250ZW50cywgX3RoaXMuY29uZmlnLmxpbmVJdGVtLm9yZGVyKSwgX3RoaXMubm9kZSA9IGNvbmZpZy5ub2RlIHx8IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLCBfdGhpcy5pc1Zpc2libGUgPSBfdGhpcy5vcHRpb25zLnN0YXJ0T3BlbiwgX3RoaXMubGluZUl0ZW1DYWNoZSA9IFtdLCBfdGhpcy5tb25leUZvcm1hdCA9IF90aGlzLmdsb2JhbENvbmZpZy5tb25leUZvcm1hdCwgX3RoaXMuY2hlY2tvdXQgPSBuZXcgQ2hlY2tvdXROYXZpZ2F0b3IoX3RoaXMuY29uZmlnKTsKICAgICAgdmFyIHRvZ2dsZXMgPSBfdGhpcy5nbG9iYWxDb25maWcudG9nZ2xlcyB8fCBbewogICAgICAgIG5vZGU6IF90aGlzLm5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksIF90aGlzLm5vZGUpCiAgICAgIH1dOwogICAgICByZXR1cm4gX3RoaXMudG9nZ2xlcyA9IHRvZ2dsZXMubWFwKGZ1bmN0aW9uICh0b2dnbGUpIHsKICAgICAgICByZXR1cm4gbmV3IENhcnRUb2dnbGUobWVyZ2Uoe30sIGNvbmZpZywgdG9nZ2xlKSwgT2JqZWN0LmFzc2lnbih7fSwgX3RoaXMucHJvcHMsIHsKICAgICAgICAgIGNhcnQ6IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpCiAgICAgICAgfSkpOwogICAgICB9KSwgX3RoaXMudXBkYXRlciA9IG5ldyBDYXJ0VXBkYXRlcihfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSksIF90aGlzLnZpZXcgPSBuZXcgQ2FydFZpZXcoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykpLCBfdGhpczsKICAgIH0KCiAgICBfaW5oZXJpdHNMb29zZShDYXJ0LCBfQ29tcG9uZW50KTsKCiAgICB2YXIgX3Byb3RvID0gQ2FydC5wcm90b3R5cGU7CiAgICByZXR1cm4gX3Byb3RvLmNyZWF0ZVRvZ2dsZXMgPSBmdW5jdGlvbiBjcmVhdGVUb2dnbGVzKGNvbmZpZykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiB0aGlzLnRvZ2dsZXMgPSB0aGlzLnRvZ2dsZXMuY29uY2F0KGNvbmZpZy50b2dnbGVzLm1hcChmdW5jdGlvbiAodG9nZ2xlKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDYXJ0VG9nZ2xlKG1lcmdlKHt9LCBjb25maWcsIHRvZ2dsZSksIE9iamVjdC5hc3NpZ24oe30sIF90aGlzMi5wcm9wcywgewogICAgICAgICAgY2FydDogX3RoaXMyCiAgICAgICAgfSkpOwogICAgICB9KSksIFByb21pc2UuYWxsKHRoaXMudG9nZ2xlcy5tYXAoZnVuY3Rpb24gKHRvZ2dsZSkgewogICAgICAgIHJldHVybiB0b2dnbGUuaW5pdCh7CiAgICAgICAgICBsaW5lSXRlbXM6IF90aGlzMi5saW5lSXRlbXMKICAgICAgICB9KTsKICAgICAgfSkpOwogICAgfSwgX3Byb3RvLmltYWdlRm9yTGluZUl0ZW0gPSBmdW5jdGlvbiBpbWFnZUZvckxpbmVJdGVtKGxpbmVJdGVtKSB7CiAgICAgIHZhciBpbWFnZVNpemUgPSAxODAsCiAgICAgICAgICBpbWFnZU9wdGlvbnMgPSB7CiAgICAgICAgbWF4V2lkdGg6IDE4MCwKICAgICAgICBtYXhIZWlnaHQ6IDE4MAogICAgICB9OwogICAgICByZXR1cm4gbGluZUl0ZW0udmFyaWFudC5pbWFnZSA/IHRoaXMucHJvcHMuY2xpZW50LmltYWdlLmhlbHBlcnMuaW1hZ2VGb3JTaXplKGxpbmVJdGVtLnZhcmlhbnQuaW1hZ2UsIGltYWdlT3B0aW9ucykgOiBOT19JTUdfVVJMOwogICAgfSwgX3Byb3RvLnJlbW92ZUNoZWNrb3V0ID0gZnVuY3Rpb24gcmVtb3ZlQ2hlY2tvdXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGVsID0gbnVsbCwgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5sb2NhbFN0b3JhZ2VDaGVja291dEtleSksIHRoaXMubW9kZWw7CiAgICB9LCBfcHJvdG8uZmV0Y2hEYXRhID0gZnVuY3Rpb24gZmV0Y2hEYXRhKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpcywKICAgICAgICAgIGNoZWNrb3V0SWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmxvY2FsU3RvcmFnZUNoZWNrb3V0S2V5KTsKCiAgICAgIHJldHVybiBjaGVja291dElkID8gdGhpcy5wcm9wcy5jbGllbnQuY2hlY2tvdXQuZmV0Y2goY2hlY2tvdXRJZCkudGhlbihmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLm1vZGVsID0gY2hlY2tvdXQsIGNoZWNrb3V0LmNvbXBsZXRlZEF0ID8gX3RoaXMzLnJlbW92ZUNoZWNrb3V0KCkgOiBfdGhpczMuc2FuaXRpemVDaGVja291dChjaGVja291dCkudGhlbihmdW5jdGlvbiAobmV3Q2hlY2tvdXQpIHsKICAgICAgICAgIHJldHVybiBfdGhpczMudXBkYXRlQ2FjaGUobmV3Q2hlY2tvdXQubGluZUl0ZW1zKSwgbmV3Q2hlY2tvdXQ7CiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLnJlbW92ZUNoZWNrb3V0KCk7CiAgICAgIH0pIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpOwogICAgfSwgX3Byb3RvLnNhbml0aXplQ2hlY2tvdXQgPSBmdW5jdGlvbiBzYW5pdGl6ZUNoZWNrb3V0KGNoZWNrb3V0KSB7CiAgICAgIHZhciBsaW5lSXRlbXNUb0RlbGV0ZSA9IGNoZWNrb3V0LmxpbmVJdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gIWl0ZW0udmFyaWFudDsKICAgICAgfSk7CiAgICAgIGlmICghbGluZUl0ZW1zVG9EZWxldGUubGVuZ3RoKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNoZWNrb3V0KTsKICAgICAgdmFyIGxpbmVJdGVtSWRzID0gbGluZUl0ZW1zVG9EZWxldGUubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0uaWQ7CiAgICAgIH0pOwogICAgICByZXR1cm4gdGhpcy5wcm9wcy5jbGllbnQuY2hlY2tvdXQucmVtb3ZlTGluZUl0ZW1zKGNoZWNrb3V0LmlkLCBsaW5lSXRlbUlkcykudGhlbihmdW5jdGlvbiAobmV3Q2hlY2tvdXQpIHsKICAgICAgICByZXR1cm4gbmV3Q2hlY2tvdXQ7CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLmZldGNoTW9uZXlGb3JtYXQgPSBmdW5jdGlvbiBmZXRjaE1vbmV5Rm9ybWF0KCkgewogICAgICByZXR1cm4gdGhpcy5wcm9wcy5jbGllbnQuc2hvcC5mZXRjaEluZm8oKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICByZXR1cm4gcmVzLm1vbmV5Rm9ybWF0OwogICAgICB9KTsKICAgIH0sIF9wcm90by5pbml0ID0gZnVuY3Rpb24gaW5pdChkYXRhKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIHRoaXMubW9uZXlGb3JtYXQgfHwgdGhpcy5mZXRjaE1vbmV5Rm9ybWF0KCkudGhlbihmdW5jdGlvbiAobW9uZXlGb3JtYXQpIHsKICAgICAgICBfdGhpczQubW9uZXlGb3JtYXQgPSBtb25leUZvcm1hdDsKICAgICAgfSksIF9Db21wb25lbnQucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzLCBkYXRhKS50aGVuKGZ1bmN0aW9uIChjYXJ0KSB7CiAgICAgICAgcmV0dXJuIF90aGlzNC50b2dnbGVzLm1hcChmdW5jdGlvbiAodG9nZ2xlKSB7CiAgICAgICAgICB2YXIgbGluZUl0ZW1zID0gY2FydC5tb2RlbCA/IGNhcnQubW9kZWwubGluZUl0ZW1zIDogW107CiAgICAgICAgICByZXR1cm4gdG9nZ2xlLmluaXQoewogICAgICAgICAgICBsaW5lSXRlbXM6IGxpbmVJdGVtcwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczQ7CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLmRlc3Ryb3kgPSBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICBfQ29tcG9uZW50LnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyksIHRoaXMudG9nZ2xlcy5mb3JFYWNoKGZ1bmN0aW9uICh0b2dnbGUpIHsKICAgICAgICByZXR1cm4gdG9nZ2xlLmRlc3Ryb3koKTsKICAgICAgfSk7CiAgICB9LCBfcHJvdG8uY2xvc2UgPSBmdW5jdGlvbiBjbG9zZSgpIHsKICAgICAgdGhpcy5pc1Zpc2libGUgPSAhMSwgdGhpcy52aWV3LnJlbmRlcigpOwogICAgfSwgX3Byb3RvLm9wZW4gPSBmdW5jdGlvbiBvcGVuKCkgewogICAgICB0aGlzLmlzVmlzaWJsZSA9ICEwLCB0aGlzLnZpZXcucmVuZGVyKCksIHRoaXMudmlldy5zZXRGb2N1cygpOwogICAgfSwgX3Byb3RvLnRvZ2dsZVZpc2liaWxpdHkgPSBmdW5jdGlvbiB0b2dnbGVWaXNpYmlsaXR5KHZpc2libGUpIHsKICAgICAgdGhpcy5pc1Zpc2libGUgPSB2aXNpYmxlIHx8ICF0aGlzLmlzVmlzaWJsZSwgdGhpcy52aWV3LnJlbmRlcigpLCB0aGlzLmlzVmlzaWJsZSAmJiB0aGlzLnZpZXcuc2V0Rm9jdXMoKTsKICAgIH0sIF9wcm90by5vblF1YW50aXR5Qmx1ciA9IGZ1bmN0aW9uIG9uUXVhbnRpdHlCbHVyKGV2dCwgdGFyZ2V0KSB7CiAgICAgIHRoaXMuc2V0UXVhbnRpdHkodGFyZ2V0LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHRhcmdldC52YWx1ZSwgMTApOwogICAgICB9KTsKICAgIH0sIF9wcm90by5vblF1YW50aXR5SW5jcmVtZW50ID0gZnVuY3Rpb24gb25RdWFudGl0eUluY3JlbWVudChxdHksIGV2dCwgdGFyZ2V0KSB7CiAgICAgIHRoaXMuc2V0UXVhbnRpdHkodGFyZ2V0LCBmdW5jdGlvbiAocHJldlF0eSkgewogICAgICAgIHJldHVybiBwcmV2UXR5ICsgcXR5OwogICAgICB9KTsKICAgIH0sIF9wcm90by5vbkNoZWNrb3V0ID0gZnVuY3Rpb24gb25DaGVja291dCgpIHsKICAgICAgdGhpcy5fdXNlckV2ZW50KCJvcGVuQ2hlY2tvdXQiKSwgdGhpcy5wcm9wcy50cmFja2VyLnRyYWNrKCJPcGVuIGNhcnQgY2hlY2tvdXQiLCB7fSksIHRoaXMuY2hlY2tvdXQub3Blbih0aGlzLm1vZGVsLndlYlVybCk7CiAgICB9LCBfcHJvdG8uc2V0UXVhbnRpdHkgPSBmdW5jdGlvbiBzZXRRdWFudGl0eSh0YXJnZXQsIGZuKSB7CiAgICAgIHZhciBpZCA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoImRhdGEtbGluZS1pdGVtLWlkIiksCiAgICAgICAgICBpdGVtID0gdGhpcy5tb2RlbC5saW5lSXRlbXMuZmluZChmdW5jdGlvbiAobGluZUl0ZW0pIHsKICAgICAgICByZXR1cm4gbGluZUl0ZW0uaWQgPT09IGlkOwogICAgICB9KSwKICAgICAgICAgIG5ld1F0eSA9IGZuKGl0ZW0ucXVhbnRpdHkpOwogICAgICByZXR1cm4gdGhpcy5wcm9wcy50cmFja2VyLnRyYWNrTWV0aG9kKHRoaXMudXBkYXRlSXRlbS5iaW5kKHRoaXMpLCAiVXBkYXRlIENhcnQiLCB0aGlzLmNhcnRJdGVtVHJhY2tpbmdJbmZvKGl0ZW0sIG5ld1F0eSkpKGlkLCBuZXdRdHkpOwogICAgfSwgX3Byb3RvLnNldE5vdGUgPSBmdW5jdGlvbiBzZXROb3RlKGV2dCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpcywKICAgICAgICAgIG5vdGUgPSBldnQudGFyZ2V0LnZhbHVlOwoKICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY2xpZW50LmNoZWNrb3V0LnVwZGF0ZUF0dHJpYnV0ZXModGhpcy5tb2RlbC5pZCwgewogICAgICAgIG5vdGU6IG5vdGUKICAgICAgfSkudGhlbihmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICByZXR1cm4gX3RoaXM1Lm1vZGVsID0gY2hlY2tvdXQsIGNoZWNrb3V0OwogICAgICB9KTsKICAgIH0sIF9wcm90by51cGRhdGVDYWNoZSA9IGZ1bmN0aW9uIHVwZGF0ZUNhY2hlKGxpbmVJdGVtcykgewogICAgICB2YXIgY2FjaGVkTGluZUl0ZW1zID0gdGhpcy5saW5lSXRlbUNhY2hlLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBpdGVtKSB7CiAgICAgICAgcmV0dXJuIGFjY1tpdGVtLmlkXSA9IGl0ZW0sIGFjYzsKICAgICAgfSwge30pOwogICAgICByZXR1cm4gdGhpcy5saW5lSXRlbUNhY2hlID0gbGluZUl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjYWNoZWRMaW5lSXRlbXNbaXRlbS5pZF0sIGl0ZW0pOwogICAgICB9KSwgdGhpcy5saW5lSXRlbUNhY2hlOwogICAgfSwgX3Byb3RvLnVwZGF0ZUNhY2hlSXRlbSA9IGZ1bmN0aW9uIHVwZGF0ZUNhY2hlSXRlbShsaW5lSXRlbUlkLCBxdWFudGl0eSkgewogICAgICB2YXIgbGluZUl0ZW07CiAgICAgIDAgIT09IHRoaXMubGluZUl0ZW1DYWNoZS5sZW5ndGggJiYgKHRoaXMubGluZUl0ZW1DYWNoZS5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGxpbmVJdGVtSWQgPT09IGl0ZW0uaWQ7CiAgICAgIH0pLnF1YW50aXR5ID0gcXVhbnRpdHksIHRoaXMudmlldy5yZW5kZXIoKSk7CiAgICB9LCBfcHJvdG8udXBkYXRlSXRlbSA9IGZ1bmN0aW9uIHVwZGF0ZUl0ZW0oaWQsIHF1YW50aXR5KSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdGhpcy5fdXNlckV2ZW50KCJ1cGRhdGVJdGVtUXVhbnRpdHkiKTsKCiAgICAgIHZhciBsaW5lSXRlbSA9IHsKICAgICAgICBpZDogaWQsCiAgICAgICAgcXVhbnRpdHk6IHF1YW50aXR5CiAgICAgIH0sCiAgICAgICAgICBsaW5lSXRlbUVsID0gdGhpcy52aWV3LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKCiAgICAgIGlmIChsaW5lSXRlbUVsKSB7CiAgICAgICAgdmFyIHF1YW50aXR5RWwgPSBsaW5lSXRlbUVsLmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGhpcy5jbGFzc2VzLmxpbmVJdGVtLnF1YW50aXR5KVswXTsKICAgICAgICBxdWFudGl0eUVsICYmIGFkZENsYXNzVG9FbGVtZW50KCJpcy1sb2FkaW5nIiwgcXVhbnRpdHlFbCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLnByb3BzLmNsaWVudC5jaGVja291dC51cGRhdGVMaW5lSXRlbXModGhpcy5tb2RlbC5pZCwgW2xpbmVJdGVtXSkudGhlbihmdW5jdGlvbiAoY2hlY2tvdXQpIHsKICAgICAgICByZXR1cm4gX3RoaXM2Lm1vZGVsID0gY2hlY2tvdXQsIF90aGlzNi51cGRhdGVDYWNoZShfdGhpczYubW9kZWwubGluZUl0ZW1zKSwgX3RoaXM2LnRvZ2dsZXMuZm9yRWFjaChmdW5jdGlvbiAodG9nZ2xlKSB7CiAgICAgICAgICByZXR1cm4gdG9nZ2xlLnZpZXcucmVuZGVyKCk7CiAgICAgICAgfSksIHF1YW50aXR5ID4gMCA/IF90aGlzNi52aWV3LnJlbmRlcigpIDogX3RoaXM2LnZpZXcuYW5pbWF0ZVJlbW92ZU5vZGUoaWQpLCBjaGVja291dDsKICAgICAgfSk7CiAgICB9LCBfcHJvdG8uYWRkVmFyaWFudFRvQ2FydCA9IGZ1bmN0aW9uIGFkZFZhcmlhbnRUb0NhcnQodmFyaWFudCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpcywKICAgICAgICAgIHF1YW50aXR5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMV0gPyBhcmd1bWVudHNbMV0gOiAxLAogICAgICAgICAgb3BlbkNhcnQgPSAhKGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzJdKSB8fCBhcmd1bWVudHNbMl07CgogICAgICBpZiAocXVhbnRpdHkgPD0gMCkgcmV0dXJuIG51bGw7CiAgICAgIG9wZW5DYXJ0ICYmIHRoaXMub3BlbigpOwogICAgICB2YXIgbGluZUl0ZW0gPSB7CiAgICAgICAgdmFyaWFudElkOiB2YXJpYW50LmlkLAogICAgICAgIHF1YW50aXR5OiBxdWFudGl0eQogICAgICB9OwogICAgICBpZiAodGhpcy5tb2RlbCkgcmV0dXJuIHRoaXMucHJvcHMuY2xpZW50LmNoZWNrb3V0LmFkZExpbmVJdGVtcyh0aGlzLm1vZGVsLmlkLCBbbGluZUl0ZW1dKS50aGVuKGZ1bmN0aW9uIChjaGVja291dCkgewogICAgICAgIHJldHVybiBfdGhpczcubW9kZWwgPSBjaGVja291dCwgX3RoaXM3LnVwZGF0ZUNhY2hlKF90aGlzNy5tb2RlbC5saW5lSXRlbXMpLCBfdGhpczcudmlldy5yZW5kZXIoKSwgX3RoaXM3LnRvZ2dsZXMuZm9yRWFjaChmdW5jdGlvbiAodG9nZ2xlKSB7CiAgICAgICAgICByZXR1cm4gdG9nZ2xlLnZpZXcucmVuZGVyKCk7CiAgICAgICAgfSksIF90aGlzNy52aWV3LnNldEZvY3VzKCksIGNoZWNrb3V0OwogICAgICB9KTsKICAgICAgdmFyIGlucHV0ID0gewogICAgICAgIGxpbmVJdGVtczogW2xpbmVJdGVtXQogICAgICB9OwogICAgICByZXR1cm4gdGhpcy5wcm9wcy5jbGllbnQuY2hlY2tvdXQuY3JlYXRlKGlucHV0KS50aGVuKGZ1bmN0aW9uIChjaGVja291dCkgewogICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShfdGhpczcubG9jYWxTdG9yYWdlQ2hlY2tvdXRLZXksIGNoZWNrb3V0LmlkKSwgX3RoaXM3Lm1vZGVsID0gY2hlY2tvdXQsIF90aGlzNy51cGRhdGVDYWNoZShfdGhpczcubW9kZWwubGluZUl0ZW1zKSwgX3RoaXM3LnZpZXcucmVuZGVyKCksIF90aGlzNy50b2dnbGVzLmZvckVhY2goZnVuY3Rpb24gKHRvZ2dsZSkgewogICAgICAgICAgcmV0dXJuIHRvZ2dsZS52aWV3LnJlbmRlcigpOwogICAgICAgIH0pLCBfdGhpczcudmlldy5zZXRGb2N1cygpLCBjaGVja291dDsKICAgICAgfSk7CiAgICB9LCBfcHJvdG8uZW1wdHkgPSBmdW5jdGlvbiBlbXB0eSgpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXMsCiAgICAgICAgICBsaW5lSXRlbUlkcyA9IHRoaXMubW9kZWwubGluZUl0ZW1zID8gdGhpcy5tb2RlbC5saW5lSXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0uaWQ7CiAgICAgIH0pIDogW107CgogICAgICByZXR1cm4gdGhpcy5wcm9wcy5jbGllbnQuY2hlY2tvdXQucmVtb3ZlTGluZUl0ZW1zKHRoaXMubW9kZWwuaWQsIGxpbmVJdGVtSWRzKS50aGVuKGZ1bmN0aW9uIChjaGVja291dCkgewogICAgICAgIHJldHVybiBfdGhpczgubW9kZWwgPSBjaGVja291dCwgX3RoaXM4LnZpZXcucmVuZGVyKCksIF90aGlzOC50b2dnbGVzLmZvckVhY2goZnVuY3Rpb24gKHRvZ2dsZSkgewogICAgICAgICAgcmV0dXJuIHRvZ2dsZS52aWV3LnJlbmRlcigpOwogICAgICAgIH0pLCBjaGVja291dDsKICAgICAgfSk7CiAgICB9LCBfcHJvdG8uY2FydEl0ZW1UcmFja2luZ0luZm8gPSBmdW5jdGlvbiBjYXJ0SXRlbVRyYWNraW5nSW5mbyhpdGVtLCBxdWFudGl0eSkgewogICAgICByZXR1cm4gewogICAgICAgIGlkOiBpdGVtLnZhcmlhbnQuaWQsCiAgICAgICAgdmFyaWFudE5hbWU6IGl0ZW0udmFyaWFudC50aXRsZSwKICAgICAgICBwcm9kdWN0SWQ6IGl0ZW0udmFyaWFudC5wcm9kdWN0LmlkLAogICAgICAgIG5hbWU6IGl0ZW0udGl0bGUsCiAgICAgICAgcHJpY2U6IGl0ZW0udmFyaWFudC5wcmljZVYyLmFtb3VudCwKICAgICAgICBwcmV2UXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksCiAgICAgICAgcXVhbnRpdHk6IHBhcnNlRmxvYXQocXVhbnRpdHkpLAogICAgICAgIHNrdTogbnVsbAogICAgICB9OwogICAgfSwgX2NyZWF0ZUNsYXNzKENhcnQsIFt7CiAgICAgIGtleTogInR5cGVLZXkiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gImNhcnQiOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIkRPTUV2ZW50cyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHZhciBfbWVyZ2U7CgogICAgICAgIHJldHVybiBtZXJnZSh7fSwgKF9kZWZpbmVQcm9wZXJ0eShfbWVyZ2UgPSB7fSwgImNsaWNrICIuY29uY2F0KHRoaXMuc2VsZWN0b3JzLmNhcnQuY2xvc2UpLCB0aGlzLnByb3BzLmNsb3NlQ2FydC5iaW5kKHRoaXMpKSwgX2RlZmluZVByb3BlcnR5KF9tZXJnZSwgImNsaWNrICIuY29uY2F0KHRoaXMuc2VsZWN0b3JzLmxpbmVJdGVtLnF1YW50aXR5SW5jcmVtZW50KSwgdGhpcy5vblF1YW50aXR5SW5jcmVtZW50LmJpbmQodGhpcywgMSkpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiY2xpY2sgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMubGluZUl0ZW0ucXVhbnRpdHlEZWNyZW1lbnQpLCB0aGlzLm9uUXVhbnRpdHlJbmNyZW1lbnQuYmluZCh0aGlzLCAtMSkpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiY2xpY2sgIi5jb25jYXQodGhpcy5zZWxlY3RvcnMuY2FydC5idXR0b24pLCB0aGlzLm9uQ2hlY2tvdXQuYmluZCh0aGlzKSksIF9kZWZpbmVQcm9wZXJ0eShfbWVyZ2UsICJibHVyICIuY29uY2F0KHRoaXMuc2VsZWN0b3JzLmxpbmVJdGVtLnF1YW50aXR5SW5wdXQpLCB0aGlzLm9uUXVhbnRpdHlCbHVyLmJpbmQodGhpcykpLCBfZGVmaW5lUHJvcGVydHkoX21lcmdlLCAiYmx1ciAiLmNvbmNhdCh0aGlzLnNlbGVjdG9ycy5jYXJ0Lm5vdGUpLCB0aGlzLnNldE5vdGUuYmluZCh0aGlzKSksIF9tZXJnZSksIHRoaXMub3B0aW9ucy5ET01FdmVudHMpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImxpbmVJdGVtcyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLm1vZGVsID8gdGhpcy5tb2RlbC5saW5lSXRlbXMgOiBbXTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJsaW5lSXRlbXNIdG1sIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICAgIHJldHVybiB0aGlzLmxpbmVJdGVtQ2FjaGUucmVkdWNlKGZ1bmN0aW9uIChhY2MsIGxpbmVJdGVtKSB7CiAgICAgICAgICB2YXIgZGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIGxpbmVJdGVtLCBfdGhpczkub3B0aW9ucy52aWV3RGF0YSksCiAgICAgICAgICAgICAgZnVsbFByaWNlID0gZGF0YS52YXJpYW50LnByaWNlVjIuYW1vdW50ICogZGF0YS5xdWFudGl0eSwKICAgICAgICAgICAgICBmb3JtYXR0ZWRQcmljZSA9IGZvcm1hdE1vbmV5KGZ1bGxQcmljZSwgX3RoaXM5Lm1vbmV5Rm9ybWF0KSwKICAgICAgICAgICAgICBkaXNjb3VudEFsbG9jYXRpb25zLAogICAgICAgICAgICAgIF9kaXNjb3VudEFsbG9jYXRpb25zJCA9IGRhdGEuZGlzY291bnRBbGxvY2F0aW9ucy5yZWR1Y2UoZnVuY3Rpb24gKGRpc2NvdW50QWNjLCBkaXNjb3VudCkgewogICAgICAgICAgICB2YXIgdGFyZ2V0U2VsZWN0aW9uID0gZGlzY291bnQuZGlzY291bnRBcHBsaWNhdGlvbi50YXJnZXRTZWxlY3Rpb247CgogICAgICAgICAgICBpZiAoTElORV9JVEVNX1RBUkdFVF9TRUxFQ1RJT05TLmluZGV4T2YodGFyZ2V0U2VsZWN0aW9uKSA+IC0xKSB7CiAgICAgICAgICAgICAgdmFyIGRpc2NvdW50QW1vdW50ID0gZGlzY291bnQuYWxsb2NhdGVkQW1vdW50LmFtb3VudCwKICAgICAgICAgICAgICAgICAgZGlzY291bnREaXNwbGF5VGV4dCA9IGRpc2NvdW50LmRpc2NvdW50QXBwbGljYXRpb24udGl0bGUgfHwgZGlzY291bnQuZGlzY291bnRBcHBsaWNhdGlvbi5jb2RlOwogICAgICAgICAgICAgIGRpc2NvdW50QWNjLnRvdGFsRGlzY291bnQgKz0gZGlzY291bnRBbW91bnQsIGRpc2NvdW50QWNjLmRpc2NvdW50cy5wdXNoKHsKICAgICAgICAgICAgICAgIGRpc2NvdW50OiAiIi5jb25jYXQoZGlzY291bnREaXNwbGF5VGV4dCwgIiAoLSIpLmNvbmNhdChmb3JtYXRNb25leShkaXNjb3VudEFtb3VudCwgX3RoaXM5Lm1vbmV5Rm9ybWF0KSwgIikiKQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gZGlzY291bnRBY2M7CiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGRpc2NvdW50czogW10sCiAgICAgICAgICAgIHRvdGFsRGlzY291bnQ6IDAKICAgICAgICAgIH0pLAogICAgICAgICAgICAgIGRpc2NvdW50cyA9IF9kaXNjb3VudEFsbG9jYXRpb25zJC5kaXNjb3VudHMsCiAgICAgICAgICAgICAgdG90YWxEaXNjb3VudCA9IF9kaXNjb3VudEFsbG9jYXRpb25zJC50b3RhbERpc2NvdW50OwoKICAgICAgICAgIHJldHVybiBkYXRhLmRpc2NvdW50cyA9IGRpc2NvdW50cy5sZW5ndGggPiAwID8gZGlzY291bnRzIDogbnVsbCwgZGF0YS5mb3JtYXR0ZWRGdWxsUHJpY2UgPSB0b3RhbERpc2NvdW50ID4gMCA/IGZvcm1hdHRlZFByaWNlIDogbnVsbCwgZGF0YS5mb3JtYXR0ZWRBY3R1YWxQcmljZSA9IGZvcm1hdE1vbmV5KGZ1bGxQcmljZSAtIHRvdGFsRGlzY291bnQsIF90aGlzOS5tb25leUZvcm1hdCksIGRhdGEuZm9ybWF0dGVkUHJpY2UgPSBmb3JtYXR0ZWRQcmljZSwgZGF0YS5jbGFzc2VzID0gX3RoaXM5LmNsYXNzZXMsIGRhdGEubGluZUl0ZW1JbWFnZSA9IF90aGlzOS5pbWFnZUZvckxpbmVJdGVtKGRhdGEpLCBkYXRhLnZhcmlhbnRUaXRsZSA9ICJEZWZhdWx0IFRpdGxlIiA9PT0gZGF0YS52YXJpYW50LnRpdGxlID8gIiIgOiBkYXRhLnZhcmlhbnQudGl0bGUsIGFjYyArIF90aGlzOS5jaGlsZFRlbXBsYXRlLnJlbmRlcih7CiAgICAgICAgICAgIGRhdGE6IGRhdGEKICAgICAgICAgIH0sIGZ1bmN0aW9uIChvdXRwdXQpIHsKICAgICAgICAgICAgcmV0dXJuICc8ZGl2IGlkPSInLmNvbmNhdChsaW5lSXRlbS5pZCwgJyIgY2xhc3M9JykuY29uY2F0KF90aGlzOS5jbGFzc2VzLmxpbmVJdGVtLmxpbmVJdGVtLCAiPiIpLmNvbmNhdChvdXRwdXQsICI8L2Rpdj4iKTsKICAgICAgICAgIH0pOwogICAgICAgIH0sICIiKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ2aWV3RGF0YSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHZhciBtb2RlbERhdGE7CiAgICAgICAgcmV0dXJuIG1lcmdlKHRoaXMubW9kZWwgfHwge30sIHRoaXMub3B0aW9ucy52aWV3RGF0YSwgewogICAgICAgICAgdGV4dDogdGhpcy5vcHRpb25zLnRleHQsCiAgICAgICAgICBjbGFzc2VzOiB0aGlzLmNsYXNzZXMsCiAgICAgICAgICBsaW5lSXRlbXNIdG1sOiB0aGlzLmxpbmVJdGVtc0h0bWwsCiAgICAgICAgICBpc0VtcHR5OiB0aGlzLmlzRW1wdHksCiAgICAgICAgICBmb3JtYXR0ZWRUb3RhbDogdGhpcy5mb3JtYXR0ZWRUb3RhbCwKICAgICAgICAgIGRpc2NvdW50czogdGhpcy5jYXJ0RGlzY291bnRzLAogICAgICAgICAgY29udGVudHM6IHRoaXMub3B0aW9ucy5jb250ZW50cywKICAgICAgICAgIGNhcnROb3RlOiB0aGlzLmNhcnROb3RlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZm9ybWF0dGVkVG90YWwiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5tb2RlbCA/IGZvcm1hdE1vbmV5KHRoaXMub3B0aW9ucy5jb250ZW50cy5kaXNjb3VudHMgPyB0aGlzLm1vZGVsLnN1YnRvdGFsUHJpY2VWMi5hbW91bnQgOiB0aGlzLm1vZGVsLmxpbmVJdGVtc1N1YnRvdGFsUHJpY2UuYW1vdW50LCB0aGlzLm1vbmV5Rm9ybWF0KSA6IGZvcm1hdE1vbmV5KDAsIHRoaXMubW9uZXlGb3JtYXQpOwogICAgICAgIHZhciB0b3RhbDsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjYXJ0RGlzY291bnRzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmNvbnRlbnRzLmRpc2NvdW50cyAmJiB0aGlzLm1vZGVsID8gdGhpcy5tb2RlbC5kaXNjb3VudEFwcGxpY2F0aW9ucy5yZWR1Y2UoZnVuY3Rpb24gKGRpc2NvdW50QXJyLCBkaXNjb3VudCkgewogICAgICAgICAgaWYgKCJBTEwiID09PSBkaXNjb3VudC50YXJnZXRTZWxlY3Rpb24pIHsKICAgICAgICAgICAgdmFyIGRpc2NvdW50VmFsdWUgPSAwOwoKICAgICAgICAgICAgaWYgKGRpc2NvdW50LnZhbHVlLmFtb3VudCA/IGRpc2NvdW50VmFsdWUgPSBkaXNjb3VudC52YWx1ZS5hbW91bnQgOiBkaXNjb3VudC52YWx1ZS5wZXJjZW50YWdlICYmIChkaXNjb3VudFZhbHVlID0gZGlzY291bnQudmFsdWUucGVyY2VudGFnZSAvIDEwMCAqIF90aGlzMTAubW9kZWwubGluZUl0ZW1zU3VidG90YWxQcmljZS5hbW91bnQpLCBkaXNjb3VudFZhbHVlID4gMCkgewogICAgICAgICAgICAgIHZhciBkaXNjb3VudERpc3BsYXlUZXh0ID0gZGlzY291bnQudGl0bGUgfHwgZGlzY291bnQuY29kZTsKICAgICAgICAgICAgICBkaXNjb3VudEFyci5wdXNoKHsKICAgICAgICAgICAgICAgIHRleHQ6IGRpc2NvdW50RGlzcGxheVRleHQsCiAgICAgICAgICAgICAgICBhbW91bnQ6ICItIi5jb25jYXQoZm9ybWF0TW9uZXkoZGlzY291bnRWYWx1ZSwgX3RoaXMxMC5tb25leUZvcm1hdCkpCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gZGlzY291bnRBcnI7CiAgICAgICAgfSwgW10pIDogW107CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiaXNFbXB0eSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAhdGhpcy5tb2RlbCB8fCB0aGlzLm1vZGVsLmxpbmVJdGVtcy5sZW5ndGggPCAxOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNhcnROb3RlIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwgJiYgdGhpcy5tb2RlbC5ub3RlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIndyYXBwZXJDbGFzcyIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLmlzVmlzaWJsZSA/ICJpcy1hY3RpdmUiIDogIiI7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAibG9jYWxTdG9yYWdlQ2hlY2tvdXRLZXkiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KHRoaXMucHJvcHMuY2xpZW50LmNvbmZpZy5zdG9yZWZyb250QWNjZXNzVG9rZW4sICIuIikuY29uY2F0KHRoaXMucHJvcHMuY2xpZW50LmNvbmZpZy5kb21haW4sICIuY2hlY2tvdXRJZCIpOwogICAgICB9CiAgICB9XSksIENhcnQ7CiAgfShDb21wb25lbnQpLAogICAgICBUcmFja2VyID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gVHJhY2tlcihsaWIsIGNsaWVudENvbmZpZykgewogICAgICB0aGlzLmxpYiA9IGxpYiB8fCBudWxsLCB0aGlzLmNsaWVudENvbmZpZyA9IGNsaWVudENvbmZpZzsKICAgIH0KCiAgICB2YXIgX3Byb3RvID0gVHJhY2tlci5wcm90b3R5cGU7CiAgICByZXR1cm4gX3Byb3RvLnRyYWNrTWV0aG9kID0gZnVuY3Rpb24gdHJhY2tNZXRob2QoZm4sIGV2ZW50LCBwcm9wZXJ0aWVzKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcmV0dXJuVmFsdWUgPSBmbi5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cyk7CiAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlICYmIHJldHVyblZhbHVlLnRoZW4gPyByZXR1cm5WYWx1ZS50aGVuKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgIHJldHVybiBzZWxmLmNhbGxMaWIoZXZlbnQsIHByb3BlcnRpZXMpLCB2YWw7CiAgICAgICAgfSkgOiAoc2VsZi5jYWxsTGliKGV2ZW50LCBwcm9wZXJ0aWVzKSwgcmV0dXJuVmFsdWUpOwogICAgICB9OwogICAgfSwgX3Byb3RvLmNhbGxMaWIgPSBmdW5jdGlvbiBjYWxsTGliKGV2ZW50TmFtZSwgcHJvcGVydGllcykgewogICAgICBzd2l0Y2ggKGV2ZW50TmFtZSkgewogICAgICAgIGNhc2UgIlVwZGF0ZSBDYXJ0IjoKICAgICAgICAgIGlmIChwcm9wZXJ0aWVzLnF1YW50aXR5IDwgMSkgcmV0dXJuIHRoaXMudHJhY2soIlJlbW92ZWQgUHJvZHVjdCIsIHByb3BlcnRpZXMpOwogICAgICAgICAgaWYgKHByb3BlcnRpZXMucHJldlF1YW50aXR5ICYmIHByb3BlcnRpZXMucXVhbnRpdHkgPCBwcm9wZXJ0aWVzLnByZXZRdWFudGl0eSkgcmV0dXJuOwogICAgICAgICAgcmV0dXJuIHRoaXMudHJhY2soIkFkZGVkIFByb2R1Y3QiLCBwcm9wZXJ0aWVzKTsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiB0aGlzLnRyYWNrKGV2ZW50TmFtZSwgcHJvcGVydGllcyk7CiAgICAgIH0KICAgIH0sIF9wcm90by50cmFja1BhZ2V2aWV3ID0gZnVuY3Rpb24gdHJhY2tQYWdldmlldygpIHsKICAgICAgdGhpcy5saWIgJiYgdGhpcy5saWIucGFnZSAmJiB0aGlzLmxpYi5wYWdlKCk7CiAgICB9LCBfcHJvdG8udHJhY2tDb21wb25lbnQgPSBmdW5jdGlvbiB0cmFja0NvbXBvbmVudCh0eXBlLCBwcm9wZXJ0aWVzKSB7CiAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgIGNhc2UgInByb2R1Y3QiOgogICAgICAgICAgcmV0dXJuIHRoaXMudHJhY2soIlZpZXdlZCBQcm9kdWN0IiwgcHJvcGVydGllcyk7CgogICAgICAgIGNhc2UgImNvbGxlY3Rpb24iOgogICAgICAgICAgcmV0dXJuIHRoaXMudHJhY2soIlZpZXdlZCBQcm9kdWN0IENhdGVnb3J5IiwgcHJvcGVydGllcyk7CiAgICAgIH0KICAgIH0sIF9wcm90by50cmFjayA9IGZ1bmN0aW9uIHRyYWNrKGV2ZW50TmFtZSwgcHJvcGVydGllcykgewogICAgICBwcm9wZXJ0aWVzLnBhZ2V1cmwgPSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmLCBwcm9wZXJ0aWVzLnJlZmVycmVyID0gZG9jdW1lbnQucmVmZXJyZXIsIHByb3BlcnRpZXMuc3ViZG9tYWluID0gdGhpcy5jbGllbnRDb25maWcuZG9tYWluLCB0aGlzLmxpYiAmJiB0aGlzLmxpYi50cmFjayAmJiB0aGlzLmxpYi50cmFjayhldmVudE5hbWUsIHByb3BlcnRpZXMpOwogICAgfSwgVHJhY2tlcjsKICB9KCksCiAgICAgIGhvc3RTdHlsZXMgPSAiLnNob3BpZnktYnV5LW1vZGFsLWlzLWFjdGl2ZSB7XG4gIGhlaWdodDogMTAwJTtcbiAgb3ZlcmZsb3c6IGF1dG87XG59XG5cbi5zaG9waWZ5LWJ1eS1mcmFtZSB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9ja1xufVxuXG4uc2hvcGlmeS1idXktZnJhbWUgaWZyYW1lIHtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICBoZWlnaHQ6IDA7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgfVxuXG4uc2hvcGlmeS1idXktZnJhbWUtLWNhcnQge1xuICB3aWR0aDogMTAwJTtcbiAgbWF4LXdpZHRoOiAzNTBweDtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDA7XG4gIHJpZ2h0OiAwO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHotaW5kZXg6IDIxNDc0ODM2NDc7XG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgxMDAlKTtcbiAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMTAwJSlcbn1cblxuLnNob3BpZnktYnV5LWZyYW1lLS1jYXJ0IGlmcmFtZSB7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICB9XG5cbi5zaG9waWZ5LWJ1eS1mcmFtZS0tY2FydC5pcy1pbml0aWFsaXplZCB7XG4gICAgLXdlYmtpdC10cmFuc2l0aW9uOiBhbGwgMjUwbXMgY3ViaWMtYmV6aWVyKDAuMTY1LCAwLjg0LCAwLjQ0LCAxKTtcbiAgICB0cmFuc2l0aW9uOiBhbGwgMjUwbXMgY3ViaWMtYmV6aWVyKDAuMTY1LCAwLjg0LCAwLjQ0LCAxKTtcbiAgfVxuXG4uc2hvcGlmeS1idXktZnJhbWUtLWNhcnQuaXMtYWN0aXZlIHtcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7XG4gICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7XG4gIH1cblxuLnNob3BpZnktYnV5LWZyYW1lLS1wcm9kdWN0IHtcbiAgZGlzcGxheTogYmxvY2tcbn1cblxuLnNob3BpZnktYnV5LWZyYW1lLS1wcm9kdWN0LnNob3BpZnktYnV5X19sYXlvdXQtaG9yaXpvbnRhbCB7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgbWFyZ2luLWxlZnQ6IGF1dG87XG5cbiAgICBtYXJnaW4tcmlnaHQ6IGF1dG9cbiAgfVxuXG4uc2hvcGlmeS1idXktZnJhbWUtLXByb2R1Y3Quc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIGlmcmFtZSB7XG4gICAgICBtYXgtd2lkdGg6IDEwMCVcbiAgICB9XG5cbkBtZWRpYSAobWluLXdpZHRoOiA5NTBweCkge1xuXG4uc2hvcGlmeS1idXktZnJhbWUtLXByb2R1Y3Quc2hvcGlmeS1idXlfX2xheW91dC1ob3Jpem9udGFsIGlmcmFtZSB7XG4gICAgICAgIG1heC13aWR0aDogOTUwcHg7XG4gICAgICAgIG1hcmdpbi1sZWZ0OiBhdXRvO1xuICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG9cbiAgICB9XG4gICAgICB9XG5cbi5zaG9waWZ5LWJ1eS1mcmFtZS0tdG9nZ2xlIHtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrXG59XG5cbi5zaG9waWZ5LWJ1eS1mcmFtZS0tdG9nZ2xlOm5vdCguaXMtc3RpY2t5KSB7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICBwYWRkaW5nOiA1cHg7XG4gIH1cblxuLnNob3BpZnktYnV5LWZyYW1lLS10b2dnbGUuaXMtc3RpY2t5IHtcbiAgICBkaXNwbGF5OiBub25lO1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICByaWdodDogMDtcbiAgICB0b3A6IDUwJTtcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7XG4gICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7XG4gICAgei1pbmRleDogMjE0NzQ4MzY0NTtcbiAgfVxuXG4uc2hvcGlmeS1idXktZnJhbWUtLXRvZ2dsZS5pcy1hY3RpdmUuaXMtc3RpY2t5IHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgfVxuXG4uaXMtYWN0aXZlIC5zaG9waWZ5LWJ1eS1mcmFtZS0tdG9nZ2xlIGlmcmFtZSB7XG4gICAgICBtaW4taGVpZ2h0OiA2N3B4O1xuICAgIH1cblxuLnNob3BpZnktYnV5LWZyYW1lLS1wcm9kdWN0U2V0IHtcbiAgd2lkdGg6IDEwMCU7XG59XG5cbi5zaG9waWZ5LWJ1eS1mcmFtZS0tbW9kYWwge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgei1pbmRleDogMjE0NzQ4MzY0NjtcbiAgZGlzcGxheTogbm9uZTtcbiAgLXdlYmtpdC10cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIDMwMG1zIGVhc2U7XG4gIHRyYW5zaXRpb246IGJhY2tncm91bmQgMzAwbXMgZWFzZVxufVxuXG4uc2hvcGlmeS1idXktZnJhbWUtLW1vZGFsIGlmcmFtZSB7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIG1heC13aWR0aDogbm9uZTtcbiAgfVxuXG4uc2hvcGlmeS1idXktZnJhbWUtLW1vZGFsLmlzLWFjdGl2ZSB7XG4gICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjYpO1xuICB9XG5cbi5zaG9waWZ5LWJ1eS1mcmFtZS0tbW9kYWwuaXMtYmxvY2sge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICB9XG4iLAogICAgICBjb25kaXRpb25hbFN0eWxlcyQxID0gIi5zaG9waWZ5LWJ1eS1mcmFtZS0tY2FydCB7XG4gIGRpc3BsYXk6IG5vbmVcbn1cbi5zaG9waWZ5LWJ1eS1mcmFtZS0tY2FydC5pcy1hY3RpdmUge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICB9XG4iLAogICAgICBmcmFtZVV0aWxzID0ge30sCiAgICAgIGxhc3RUaW1lID0gMCwKICAgICAgdmVuZG9ycyA9IFsibXMiLCAibW96IiwgIndlYmtpdCIsICJvIl07CgogIGlmICh3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lICYmIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSkgZnJhbWVVdGlscy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lLCBmcmFtZVV0aWxzLmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lO2Vsc2UgewogICAgZm9yICh2YXIgeCA9IDA7IHggPCB2ZW5kb3JzLmxlbmd0aCAmJiAhZnJhbWVVdGlscy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7ICsreCkgewogICAgICBmcmFtZVV0aWxzLnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvd1t2ZW5kb3JzW3hdICsgIlJlcXVlc3RBbmltYXRpb25GcmFtZSJdLCBmcmFtZVV0aWxzLmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gd2luZG93W3ZlbmRvcnNbeF0gKyAiQ2FuY2VsQW5pbWF0aW9uRnJhbWUiXSB8fCB3aW5kb3dbdmVuZG9yc1t4XSArICJDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiXTsKICAgIH0KCiAgICBmcmFtZVV0aWxzLnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCAoZnJhbWVVdGlscy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIGVsZW1lbnQpIHsKICAgICAgdmFyIGN1cnJUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCksCiAgICAgICAgICB0aW1lVG9DYWxsID0gTWF0aC5tYXgoMCwgMTYgLSAoY3VyclRpbWUgLSBsYXN0VGltZSkpLAogICAgICAgICAgaWQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgY2FsbGJhY2soY3VyclRpbWUgKyB0aW1lVG9DYWxsKTsKICAgICAgfSwgdGltZVRvQ2FsbCk7CiAgICAgIHJldHVybiBsYXN0VGltZSA9IGN1cnJUaW1lICsgdGltZVRvQ2FsbCwgaWQ7CiAgICB9KSwgZnJhbWVVdGlscy5jYW5jZWxBbmltYXRpb25GcmFtZSB8fCAoZnJhbWVVdGlscy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChpZCkgewogICAgICBjbGVhclRpbWVvdXQoaWQpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBDdXN0b21FdmVudChldmVudCwgcGFyYW1zKSB7CiAgICBwYXJhbXMgPSBwYXJhbXMgfHwgewogICAgICBidWJibGVzOiAhMSwKICAgICAgY2FuY2VsYWJsZTogITEsCiAgICAgIGRldGFpbDogdm9pZCAwCiAgICB9OwogICAgdmFyIGV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCJDdXN0b21FdmVudCIpOwogICAgcmV0dXJuIGV2dC5pbml0Q3VzdG9tRXZlbnQoZXZlbnQsIHBhcmFtcy5idWJibGVzLCBwYXJhbXMuY2FuY2VsYWJsZSwgcGFyYW1zLmRldGFpbCksIGV2dDsKICB9CgogIEN1c3RvbUV2ZW50LnByb3RvdHlwZSA9IHdpbmRvdy5FdmVudC5wcm90b3R5cGU7CgogIHZhciB0aHJvdHRsZSA9IGZ1bmN0aW9uIHRocm90dGxlKHR5cGUsIG5hbWUsIG9iaikgewogICAgb2JqID0gb2JqIHx8IHdpbmRvdzsKCiAgICB2YXIgcnVubmluZyA9ICExLAogICAgICAgIGZ1bmMgPSBmdW5jdGlvbiBmdW5jKCkgewogICAgICBydW5uaW5nIHx8IChydW5uaW5nID0gITAsIGZyYW1lVXRpbHMucmVxdWVzdEFuaW1hdGlvbkZyYW1lLmNhbGwod2luZG93LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgb2JqLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KG5hbWUpKSwgcnVubmluZyA9ICExOwogICAgICB9KSk7CiAgICB9OwoKICAgIG9iai5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGZ1bmMpOwogIH0sCiAgICAgIERBVEFfQVRUUklCVVRFID0gImRhdGEtc2hvcGlmeS1idXktdWkiLAogICAgICBFU0NfS0VZJDEgPSAyNywKICAgICAgVUkgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBVSShjbGllbnQpIHsKICAgICAgdmFyIGludGVncmF0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzFdID8gYXJndW1lbnRzWzFdIDoge30sCiAgICAgICAgICBzdHlsZU92ZXJyaWRlcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIHZvaWQgMCAhPT0gYXJndW1lbnRzWzJdID8gYXJndW1lbnRzWzJdIDogIiI7CiAgICAgIHRoaXMuY2xpZW50ID0gY2xpZW50LCB0aGlzLmNvbmZpZyA9IHt9LCB0aGlzLmNvbmZpZy5kb21haW4gPSB0aGlzLmNsaWVudC5jb25maWcuZG9tYWluLCB0aGlzLmlmcmFtZUNvbXBvbmVudHMgPSBbXSwgdGhpcy5jb21wb25lbnRzID0gewogICAgICAgIHByb2R1Y3Q6IFtdLAogICAgICAgIGNhcnQ6IFtdLAogICAgICAgIGNvbGxlY3Rpb246IFtdLAogICAgICAgIHByb2R1Y3RTZXQ6IFtdLAogICAgICAgIG1vZGFsOiBbXSwKICAgICAgICB0b2dnbGU6IFtdCiAgICAgIH0sIHRoaXMuY29tcG9uZW50VHlwZXMgPSB7CiAgICAgICAgcHJvZHVjdDogUHJvZHVjdCQxLAogICAgICAgIGNhcnQ6IENhcnQsCiAgICAgICAgY29sbGVjdGlvbjogUHJvZHVjdFNldCwKICAgICAgICBwcm9kdWN0U2V0OiBQcm9kdWN0U2V0LAogICAgICAgIHRvZ2dsZTogQ2FydFRvZ2dsZQogICAgICB9LCB0aGlzLmVycm9yUmVwb3J0ZXIgPSBpbnRlZ3JhdGlvbnMuZXJyb3JSZXBvcnRlciwgdGhpcy50cmFja2VyID0gbmV3IFRyYWNrZXIoaW50ZWdyYXRpb25zLnRyYWNrZXIsIHRoaXMuY29uZmlnKSwgdGhpcy5zdHlsZU92ZXJyaWRlcyA9IHN0eWxlT3ZlcnJpZGVzLCB0aGlzLnRyYWNrZXIudHJhY2tQYWdldmlldygpLCB0aGlzLmFjdGl2ZUVsID0gbnVsbCwgdGhpcy5fYXBwZW5kU3R5bGVUYWcoKSwgdGhpcy5fYmluZFJlc2l6ZSgpLCB0aGlzLl9iaW5kSG9zdENsaWNrKCksIHRoaXMuX2JpbmRFc2Mod2luZG93KSwgdGhpcy5fYmluZFBvc3RNZXNzYWdlKCk7CiAgICB9CgogICAgdmFyIF9wcm90byA9IFVJLnByb3RvdHlwZTsKICAgIHJldHVybiBfcHJvdG8uY3JlYXRlQ29tcG9uZW50ID0gZnVuY3Rpb24gY3JlYXRlQ29tcG9uZW50KHR5cGUsIGNvbmZpZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY29uZmlnLm5vZGUgPSBjb25maWcubm9kZSB8fCB0aGlzLl9xdWVyeUVudHJ5Tm9kZSgpOwogICAgICB2YXIgY29tcG9uZW50ID0gbmV3IHRoaXMuY29tcG9uZW50VHlwZXNbdHlwZV0oY29uZmlnLCB0aGlzLmNvbXBvbmVudFByb3BzKTsKICAgICAgcmV0dXJuIGNvbXBvbmVudC5pZnJhbWUgJiYgdGhpcy5fYmluZEVzYyhjb21wb25lbnQuaWZyYW1lLmVsLmNvbnRlbnRXaW5kb3cgfHwgY29tcG9uZW50LmlmcmFtZS5lbCksIHRoaXMuY29tcG9uZW50c1t0eXBlXS5wdXNoKGNvbXBvbmVudCksIGNvbXBvbmVudC5pbml0KCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLnRyYWNrQ29tcG9uZW50KHR5cGUsIGNvbXBvbmVudCksIGNvbXBvbmVudDsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgX3RoaXMuZXJyb3JSZXBvcnRlciAmJiBfdGhpcy5lcnJvclJlcG9ydGVyLm5vdGlmeUV4Y2VwdGlvbihlcnJvciksIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICB9KTsKICAgIH0sIF9wcm90by50cmFja0NvbXBvbmVudCA9IGZ1bmN0aW9uIHRyYWNrQ29tcG9uZW50KHR5cGUsIGNvbXBvbmVudCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgICJwcm9kdWN0U2V0IiA9PT0gdHlwZSA/IGNvbXBvbmVudC50cmFja2luZ0luZm8uZm9yRWFjaChmdW5jdGlvbiAocHJvZHVjdCkgewogICAgICAgIF90aGlzMi50cmFja2VyLnRyYWNrQ29tcG9uZW50KCJwcm9kdWN0IiwgcHJvZHVjdCk7CiAgICAgIH0pIDogdGhpcy50cmFja2VyLnRyYWNrQ29tcG9uZW50KHR5cGUsIGNvbXBvbmVudC50cmFja2luZ0luZm8pOwogICAgfSwgX3Byb3RvLmRlc3Ryb3lDb21wb25lbnQgPSBmdW5jdGlvbiBkZXN0cm95Q29tcG9uZW50KHR5cGUsIGlkKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5jb21wb25lbnRzW3R5cGVdLmZvckVhY2goZnVuY3Rpb24gKGNvbXBvbmVudCwgaW5kZXgpIHsKICAgICAgICBpZCAmJiAhY29tcG9uZW50Lm1vZGVsLmlkID09PSBpZCB8fCAoX3RoaXMzLmNvbXBvbmVudHNbdHlwZV1baW5kZXhdLmRlc3Ryb3koKSwgX3RoaXMzLmNvbXBvbmVudHNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKSk7CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLmNyZWF0ZUNhcnQgPSBmdW5jdGlvbiBjcmVhdGVDYXJ0KGNvbmZpZykgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmNvbXBvbmVudHMuY2FydC5sZW5ndGgpIHJldHVybiBjb25maWcudG9nZ2xlcyAmJiBjb25maWcudG9nZ2xlcy5sZW5ndGggPiB0aGlzLmNvbXBvbmVudHMuY2FydFswXS50b2dnbGVzLmxlbmd0aCA/IHRoaXMuY29tcG9uZW50cy5jYXJ0WzBdLmNyZWF0ZVRvZ2dsZXMoY29uZmlnKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LmNvbXBvbmVudHMuY2FydFswXTsKICAgICAgfSkgOiBQcm9taXNlLnJlc29sdmUodGhpcy5jb21wb25lbnRzLmNhcnRbMF0pOwogICAgICB2YXIgY2FydCA9IG5ldyBDYXJ0KGNvbmZpZywgdGhpcy5jb21wb25lbnRQcm9wcyk7CiAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudHMuY2FydC5wdXNoKGNhcnQpLCBjYXJ0LmluaXQoKTsKICAgIH0sIF9wcm90by5jbG9zZUNhcnQgPSBmdW5jdGlvbiBjbG9zZUNhcnQoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy5jb21wb25lbnRzLmNhcnQubGVuZ3RoICYmIHRoaXMuY29tcG9uZW50cy5jYXJ0LmZvckVhY2goZnVuY3Rpb24gKGNhcnQpIHsKICAgICAgICBjYXJ0LmlzVmlzaWJsZSAmJiAoY2FydC5jbG9zZSgpLCBfdGhpczUucmVzdG9yZUZvY3VzKCkpOwogICAgICB9KTsKICAgIH0sIF9wcm90by5vcGVuQ2FydCA9IGZ1bmN0aW9uIG9wZW5DYXJ0KCkgewogICAgICB0aGlzLmNvbXBvbmVudHMuY2FydC5sZW5ndGggJiYgdGhpcy5jb21wb25lbnRzLmNhcnQuZm9yRWFjaChmdW5jdGlvbiAoY2FydCkgewogICAgICAgIGNhcnQub3BlbigpOwogICAgICB9KTsKICAgIH0sIF9wcm90by50b2dnbGVDYXJ0ID0gZnVuY3Rpb24gdG9nZ2xlQ2FydCh2aXNpYmlsaXR5KSB7CiAgICAgIHRoaXMuY29tcG9uZW50cy5jYXJ0Lmxlbmd0aCAmJiB0aGlzLmNvbXBvbmVudHMuY2FydC5mb3JFYWNoKGZ1bmN0aW9uIChjYXJ0KSB7CiAgICAgICAgY2FydC50b2dnbGVWaXNpYmlsaXR5KHZpc2liaWxpdHkpOwogICAgICB9KSwgdmlzaWJpbGl0eSB8fCB0aGlzLnJlc3RvcmVGb2N1cygpOwogICAgfSwgX3Byb3RvLmNyZWF0ZU1vZGFsID0gZnVuY3Rpb24gY3JlYXRlTW9kYWwoY29uZmlnKSB7CiAgICAgIGlmICh0aGlzLmNvbXBvbmVudHMubW9kYWwubGVuZ3RoKSByZXR1cm4gdGhpcy5jb21wb25lbnRzLm1vZGFsWzBdOwogICAgICB2YXIgbW9kYWwgPSBuZXcgTW9kYWwoY29uZmlnLCB0aGlzLmNvbXBvbmVudFByb3BzKTsKICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50cy5tb2RhbC5wdXNoKG1vZGFsKSwgbW9kYWw7CiAgICB9LCBfcHJvdG8uc2V0QWN0aXZlRWwgPSBmdW5jdGlvbiBzZXRBY3RpdmVFbChlbCkgewogICAgICB0aGlzLmFjdGl2ZUVsID0gZWw7CiAgICB9LCBfcHJvdG8uY2xvc2VNb2RhbCA9IGZ1bmN0aW9uIGNsb3NlTW9kYWwoKSB7CiAgICAgIHRoaXMuY29tcG9uZW50cy5tb2RhbC5sZW5ndGggJiYgKHRoaXMuY29tcG9uZW50cy5tb2RhbC5mb3JFYWNoKGZ1bmN0aW9uIChtb2RhbCkgewogICAgICAgIHJldHVybiBtb2RhbC5jbG9zZSgpOwogICAgICB9KSwgdGhpcy5yZXN0b3JlRm9jdXMoKSk7CiAgICB9LCBfcHJvdG8ucmVzdG9yZUZvY3VzID0gZnVuY3Rpb24gcmVzdG9yZUZvY3VzKCkgewogICAgICAhdGhpcy5hY3RpdmVFbCB8fCB0aGlzLm1vZGFsT3BlbiB8fCB0aGlzLmNhcnRPcGVuIHx8IHRoaXMuYWN0aXZlRWwuZm9jdXMoKTsKICAgIH0sIF9wcm90by5fcXVlcnlFbnRyeU5vZGUgPSBmdW5jdGlvbiBfcXVlcnlFbnRyeU5vZGUoKSB7CiAgICAgIHRoaXMuZW50cnkgPSB0aGlzLmVudHJ5IHx8IHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJzY3JpcHRbIi5jb25jYXQoREFUQV9BVFRSSUJVVEUsICJdIikpWzBdOwogICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CgogICAgICBpZiAodGhpcy5lbnRyeSkgewogICAgICAgIHZhciBwYXJlbnROb2RlID0gdGhpcy5lbnRyeS5wYXJlbnROb2RlOwogICAgICAgICJIRUFEIiA9PT0gcGFyZW50Tm9kZS50YWdOYW1lIHx8ICJIVE1MIiA9PT0gcGFyZW50Tm9kZS50YWdOYW1lID8gdGhpcy5fYXBwZW5kVG9Cb2R5KGRpdikgOiAodGhpcy5lbnRyeS5yZW1vdmVBdHRyaWJ1dGUoREFUQV9BVFRSSUJVVEUpLCBwYXJlbnROb2RlLmluc2VydEJlZm9yZShkaXYsIHRoaXMuZW50cnkpKTsKICAgICAgfSBlbHNlIHRoaXMuX2FwcGVuZFRvQm9keShkaXYpOwoKICAgICAgcmV0dXJuIGRpdjsKICAgIH0sIF9wcm90by5fYXBwZW5kVG9Cb2R5ID0gZnVuY3Rpb24gX2FwcGVuZFRvQm9keShlbCkgewogICAgICBkb2N1bWVudC5ib2R5IHx8IChkb2N1bWVudC5ib2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYm9keSIpKSwgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7CiAgICB9LCBfcHJvdG8uX2FwcGVuZFN0eWxlVGFnID0gZnVuY3Rpb24gX2FwcGVuZFN0eWxlVGFnKCkgewogICAgICB2YXIgc3R5bGVUYWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICBzdHlsZVRhZy5zdHlsZVNoZWV0ID8gc3R5bGVUYWcuc3R5bGVTaGVldC5jc3NUZXh0ID0gdGhpcy5zdHlsZVRleHQgOiBzdHlsZVRhZy5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLnN0eWxlVGV4dCkpLCBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlVGFnKTsKICAgIH0sIF9wcm90by5fYmluZEhvc3RDbGljayA9IGZ1bmN0aW9uIF9iaW5kSG9zdENsaWNrKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24gKGV2dCkgewogICAgICAgIGlmICghKF90aGlzNi5jb21wb25lbnRzLmNhcnQubGVuZ3RoIDwgMSkpIHsKICAgICAgICAgIHZhciBjYXJ0Tm9kZSA9IF90aGlzNi5jb21wb25lbnRzLmNhcnRbMF0ubm9kZTsKICAgICAgICAgIGV2dC50YXJnZXQgPT09IGNhcnROb2RlIHx8IGNhcnROb2RlLmNvbnRhaW5zKGV2dC50YXJnZXQpIHx8IF90aGlzNi5jbG9zZUNhcnQoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwgX3Byb3RvLl9iaW5kUmVzaXplID0gZnVuY3Rpb24gX2JpbmRSZXNpemUoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdGhyb3R0bGUoInJlc2l6ZSIsICJzYWZlUmVzaXplIiksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJzYWZlUmVzaXplIiwgZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNy5jb21wb25lbnRzLmNvbGxlY3Rpb24uZm9yRWFjaChmdW5jdGlvbiAoY29sbGVjdGlvbikgewogICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb24udmlldy5yZXNpemUoKTsKICAgICAgICB9KSwgX3RoaXM3LmNvbXBvbmVudHMucHJvZHVjdFNldC5mb3JFYWNoKGZ1bmN0aW9uIChzZXQpIHsKICAgICAgICAgIHJldHVybiBzZXQudmlldy5yZXNpemUoKTsKICAgICAgICB9KSwgX3RoaXM3LmNvbXBvbmVudHMucHJvZHVjdC5mb3JFYWNoKGZ1bmN0aW9uIChwcm9kdWN0KSB7CiAgICAgICAgICByZXR1cm4gcHJvZHVjdC52aWV3LnJlc2l6ZSgpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sIF9wcm90by5fYmluZEVzYyA9IGZ1bmN0aW9uIF9iaW5kRXNjKGNvbnRleHQpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICBjb250ZXh0LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCBmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgMjcgPT09IGV2dC5rZXlDb2RlICYmIChfdGhpczguY2xvc2VNb2RhbCgpLCBfdGhpczguY2xvc2VDYXJ0KCkpOwogICAgICB9KTsKICAgIH0sIF9wcm90by5fYmluZFBvc3RNZXNzYWdlID0gZnVuY3Rpb24gX2JpbmRQb3N0TWVzc2FnZSgpIHsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgdmFyIGRhdGE7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShtc2cuZGF0YSk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBkYXRhID0ge307CiAgICAgICAgfQoKICAgICAgICAoZGF0YS5zeW5jQ2FydCB8fCBkYXRhLmN1cnJlbnRfY2hlY2tvdXRfcGFnZSAmJiAiL2NoZWNrb3V0L3RoYW5rX3lvdSIgPT09IGRhdGEuY3VycmVudF9jaGVja291dF9wYWdlKSAmJiBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfSk7CiAgICB9LCBfY3JlYXRlQ2xhc3MoVUksIFt7CiAgICAgIGtleTogIm1vZGFsT3BlbiIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudHMubW9kYWwucmVkdWNlKGZ1bmN0aW9uIChpc09wZW4sIG1vZGFsKSB7CiAgICAgICAgICByZXR1cm4gaXNPcGVuIHx8IG1vZGFsLmlzVmlzaWJsZTsKICAgICAgICB9LCAhMSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiY2FydE9wZW4iLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnRzLmNhcnQucmVkdWNlKGZ1bmN0aW9uIChpc09wZW4sIGNhcnQpIHsKICAgICAgICAgIHJldHVybiBpc09wZW4gfHwgY2FydC5pc1Zpc2libGU7CiAgICAgICAgfSwgITEpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNvbXBvbmVudFByb3BzIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGNsaWVudDogdGhpcy5jbGllbnQsCiAgICAgICAgICBjcmVhdGVDYXJ0OiB0aGlzLmNyZWF0ZUNhcnQuYmluZCh0aGlzKSwKICAgICAgICAgIGNsb3NlQ2FydDogdGhpcy5jbG9zZUNhcnQuYmluZCh0aGlzKSwKICAgICAgICAgIHRvZ2dsZUNhcnQ6IHRoaXMudG9nZ2xlQ2FydC5iaW5kKHRoaXMpLAogICAgICAgICAgY3JlYXRlTW9kYWw6IHRoaXMuY3JlYXRlTW9kYWwuYmluZCh0aGlzKSwKICAgICAgICAgIGNsb3NlTW9kYWw6IHRoaXMuY2xvc2VNb2RhbC5iaW5kKHRoaXMpLAogICAgICAgICAgc2V0QWN0aXZlRWw6IHRoaXMuc2V0QWN0aXZlRWwuYmluZCh0aGlzKSwKICAgICAgICAgIGRlc3Ryb3lDb21wb25lbnQ6IHRoaXMuZGVzdHJveUNvbXBvbmVudC5iaW5kKHRoaXMpLAogICAgICAgICAgdHJhY2tlcjogdGhpcy50cmFja2VyLAogICAgICAgICAgZXJyb3JSZXBvcnRlcjogdGhpcy5lcnJvclJlcG9ydGVyLAogICAgICAgICAgYnJvd3NlckZlYXR1cmVzOiBicm93c2VyRmVhdHVyZXMKICAgICAgICB9OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInN0eWxlVGV4dCIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiBicm93c2VyRmVhdHVyZXMudHJhbnNpdGlvbiAmJiBicm93c2VyRmVhdHVyZXMudHJhbnNmb3JtICYmIGJyb3dzZXJGZWF0dXJlcy5hbmltYXRpb24gPyBob3N0U3R5bGVzICsgdGhpcy5zdHlsZU92ZXJyaWRlcyA6IGhvc3RTdHlsZXMgKyBjb25kaXRpb25hbFN0eWxlcyQxICsgdGhpcy5zdHlsZU92ZXJyaWRlczsKICAgICAgfQogICAgfV0pLCBVSTsKICB9KCksCiAgICAgIHN1cHBvcnRfc2VhcmNoUGFyYW1zID0gKCJVUkxTZWFyY2hQYXJhbXMiIGluIHNlbGYpLAogICAgICBzdXBwb3J0X2l0ZXJhYmxlID0gIlN5bWJvbCIgaW4gc2VsZiAmJiAiaXRlcmF0b3IiIGluIFN5bWJvbCwKICAgICAgc3VwcG9ydF9ibG9iID0gIkZpbGVSZWFkZXIiIGluIHNlbGYgJiYgIkJsb2IiIGluIHNlbGYgJiYgZnVuY3Rpb24gKCkgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIG5ldyBCbG9iKCksICEwOwogICAgfSBjYXRjaCAoZSkgewogICAgICByZXR1cm4gITE7CiAgICB9CiAgfSgpLAogICAgICBzdXBwb3J0X2Zvcm1EYXRhID0gKCJGb3JtRGF0YSIgaW4gc2VsZiksCiAgICAgIHN1cHBvcnRfYXJyYXlCdWZmZXIgPSAoIkFycmF5QnVmZmVyIiBpbiBzZWxmKTsKCiAgZnVuY3Rpb24gaXNEYXRhVmlldyhvYmopIHsKICAgIHJldHVybiBvYmogJiYgRGF0YVZpZXcucHJvdG90eXBlLmlzUHJvdG90eXBlT2Yob2JqKTsKICB9CgogIGlmIChzdXBwb3J0X2FycmF5QnVmZmVyKSB2YXIgdmlld0NsYXNzZXMgPSBbIltvYmplY3QgSW50OEFycmF5XSIsICJbb2JqZWN0IFVpbnQ4QXJyYXldIiwgIltvYmplY3QgVWludDhDbGFtcGVkQXJyYXldIiwgIltvYmplY3QgSW50MTZBcnJheV0iLCAiW29iamVjdCBVaW50MTZBcnJheV0iLCAiW29iamVjdCBJbnQzMkFycmF5XSIsICJbb2JqZWN0IFVpbnQzMkFycmF5XSIsICJbb2JqZWN0IEZsb2F0MzJBcnJheV0iLCAiW29iamVjdCBGbG9hdDY0QXJyYXldIl0sCiAgICAgIGlzQXJyYXlCdWZmZXJWaWV3ID0gQXJyYXlCdWZmZXIuaXNWaWV3IHx8IGZ1bmN0aW9uIChvYmopIHsKICAgIHJldHVybiBvYmogJiYgdmlld0NsYXNzZXMuaW5kZXhPZihPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSkgPiAtMTsKICB9OwoKICBmdW5jdGlvbiBub3JtYWxpemVOYW1lKG5hbWUpIHsKICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgbmFtZSAmJiAobmFtZSA9IFN0cmluZyhuYW1lKSksIC9bXmEtejAtOVwtIyQlJicqKy5eX2B8fl0vaS50ZXN0KG5hbWUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGNoYXJhY3RlciBpbiBoZWFkZXIgZmllbGQgbmFtZSIpOwogICAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKTsKICB9CgogIGZ1bmN0aW9uIG5vcm1hbGl6ZVZhbHVlKHZhbHVlKSB7CiAgICByZXR1cm4gInN0cmluZyIgIT0gdHlwZW9mIHZhbHVlICYmICh2YWx1ZSA9IFN0cmluZyh2YWx1ZSkpLCB2YWx1ZTsKICB9CgogIGZ1bmN0aW9uIGl0ZXJhdG9yRm9yKGl0ZW1zKSB7CiAgICB2YXIgaXRlcmF0b3IgPSB7CiAgICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7CiAgICAgICAgdmFyIHZhbHVlID0gaXRlbXMuc2hpZnQoKTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgZG9uZTogdm9pZCAwID09PSB2YWx1ZSwKICAgICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICAgIH07CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gc3VwcG9ydF9pdGVyYWJsZSAmJiAoaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGl0ZXJhdG9yOwogICAgfSksIGl0ZXJhdG9yOwogIH0KCiAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7CiAgICB0aGlzLm1hcCA9IHt9LCBoZWFkZXJzIGluc3RhbmNlb2YgSGVhZGVycyA/IGhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUpIHsKICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpOwogICAgfSwgdGhpcykgOiBBcnJheS5pc0FycmF5KGhlYWRlcnMpID8gaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHsKICAgICAgdGhpcy5hcHBlbmQoaGVhZGVyWzBdLCBoZWFkZXJbMV0pOwogICAgfSwgdGhpcykgOiBoZWFkZXJzICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGhlYWRlcnMpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSk7CiAgICB9LCB0aGlzKTsKICB9CgogIGZ1bmN0aW9uIGNvbnN1bWVkKGJvZHkpIHsKICAgIGlmIChib2R5LmJvZHlVc2VkKSByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcigiQWxyZWFkeSByZWFkIikpOwogICAgYm9keS5ib2R5VXNlZCA9ICEwOwogIH0KCiAgZnVuY3Rpb24gZmlsZVJlYWRlclJlYWR5KHJlYWRlcikgewogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpOwogICAgICB9LCByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZWplY3QocmVhZGVyLmVycm9yKTsKICAgICAgfTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gcmVhZEJsb2JBc0FycmF5QnVmZmVyKGJsb2IpIHsKICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpLAogICAgICAgIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKTsKICAgIHJldHVybiByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYmxvYiksIHByb21pc2U7CiAgfQoKICBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dChibG9iKSB7CiAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKSwKICAgICAgICBwcm9taXNlID0gZmlsZVJlYWRlclJlYWR5KHJlYWRlcik7CiAgICByZXR1cm4gcmVhZGVyLnJlYWRBc1RleHQoYmxvYiksIHByb21pc2U7CiAgfQoKICBmdW5jdGlvbiByZWFkQXJyYXlCdWZmZXJBc1RleHQoYnVmKSB7CiAgICBmb3IgKHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKSwgY2hhcnMgPSBuZXcgQXJyYXkodmlldy5sZW5ndGgpLCBpID0gMDsgaSA8IHZpZXcubGVuZ3RoOyBpKyspIHsKICAgICAgY2hhcnNbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHZpZXdbaV0pOwogICAgfQoKICAgIHJldHVybiBjaGFycy5qb2luKCIiKTsKICB9CgogIGZ1bmN0aW9uIGJ1ZmZlckNsb25lKGJ1ZikgewogICAgaWYgKGJ1Zi5zbGljZSkgcmV0dXJuIGJ1Zi5zbGljZSgwKTsKICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmLmJ5dGVMZW5ndGgpOwogICAgcmV0dXJuIHZpZXcuc2V0KG5ldyBVaW50OEFycmF5KGJ1ZikpLCB2aWV3LmJ1ZmZlcjsKICB9CgogIGZ1bmN0aW9uIEJvZHkoKSB7CiAgICByZXR1cm4gdGhpcy5ib2R5VXNlZCA9ICExLCB0aGlzLl9pbml0Qm9keSA9IGZ1bmN0aW9uIChib2R5KSB7CiAgICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keSwgYm9keSA/ICJzdHJpbmciID09IHR5cGVvZiBib2R5ID8gdGhpcy5fYm9keVRleHQgPSBib2R5IDogc3VwcG9ydF9ibG9iICYmIEJsb2IucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkgPyB0aGlzLl9ib2R5QmxvYiA9IGJvZHkgOiBzdXBwb3J0X2Zvcm1EYXRhICYmIEZvcm1EYXRhLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpID8gdGhpcy5fYm9keUZvcm1EYXRhID0gYm9keSA6IHN1cHBvcnRfc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSA/IHRoaXMuX2JvZHlUZXh0ID0gYm9keS50b1N0cmluZygpIDogc3VwcG9ydF9hcnJheUJ1ZmZlciAmJiBzdXBwb3J0X2Jsb2IgJiYgaXNEYXRhVmlldyhib2R5KSA/ICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIgPSBidWZmZXJDbG9uZShib2R5LmJ1ZmZlciksIHRoaXMuX2JvZHlJbml0ID0gbmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pKSA6IHN1cHBvcnRfYXJyYXlCdWZmZXIgJiYgKEFycmF5QnVmZmVyLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpIHx8IGlzQXJyYXlCdWZmZXJWaWV3KGJvZHkpKSA/IHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkpIDogdGhpcy5fYm9keVRleHQgPSBib2R5ID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGJvZHkpIDogdGhpcy5fYm9keVRleHQgPSAiIiwgdGhpcy5oZWFkZXJzLmdldCgiY29udGVudC10eXBlIikgfHwgKCJzdHJpbmciID09IHR5cGVvZiBib2R5ID8gdGhpcy5oZWFkZXJzLnNldCgiY29udGVudC10eXBlIiwgInRleHQvcGxhaW47Y2hhcnNldD1VVEYtOCIpIDogdGhpcy5fYm9keUJsb2IgJiYgdGhpcy5fYm9keUJsb2IudHlwZSA/IHRoaXMuaGVhZGVycy5zZXQoImNvbnRlbnQtdHlwZSIsIHRoaXMuX2JvZHlCbG9iLnR5cGUpIDogc3VwcG9ydF9zZWFyY2hQYXJhbXMgJiYgVVJMU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpICYmIHRoaXMuaGVhZGVycy5zZXQoImNvbnRlbnQtdHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCIpKTsKICAgIH0sIHN1cHBvcnRfYmxvYiAmJiAodGhpcy5ibG9iID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKTsKICAgICAgaWYgKHJlamVjdGVkKSByZXR1cm4gcmVqZWN0ZWQ7CiAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5QmxvYik7CiAgICAgIGlmICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pKTsKICAgICAgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkgdGhyb3cgbmV3IEVycm9yKCJjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIGJsb2IiKTsKICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgQmxvYihbdGhpcy5fYm9keVRleHRdKSk7CiAgICB9LCB0aGlzLmFycmF5QnVmZmVyID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy5fYm9keUFycmF5QnVmZmVyID8gY29uc3VtZWQodGhpcykgfHwgUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikgOiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcik7CiAgICB9KSwgdGhpcy50ZXh0ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKTsKICAgICAgaWYgKHJlamVjdGVkKSByZXR1cm4gcmVqZWN0ZWQ7CiAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikgcmV0dXJuIHJlYWRCbG9iQXNUZXh0KHRoaXMuX2JvZHlCbG9iKTsKICAgICAgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZWFkQXJyYXlCdWZmZXJBc1RleHQodGhpcy5fYm9keUFycmF5QnVmZmVyKSk7CiAgICAgIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHRocm93IG5ldyBFcnJvcigiY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyB0ZXh0Iik7CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpOwogICAgfSwgc3VwcG9ydF9mb3JtRGF0YSAmJiAodGhpcy5mb3JtRGF0YSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oZGVjb2RlJDEpOwogICAgfSksIHRoaXMuanNvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oSlNPTi5wYXJzZSk7CiAgICB9LCB0aGlzOwogIH0KCiAgSGVhZGVycy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKSwgdmFsdWUgPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSk7CiAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLm1hcFtuYW1lXTsKICAgIHRoaXMubWFwW25hbWVdID0gb2xkVmFsdWUgPyBvbGRWYWx1ZSArICIsICIgKyB2YWx1ZSA6IHZhbHVlOwogIH0sIEhlYWRlcnMucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgICBkZWxldGUgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV07CiAgfSwgSGVhZGVycy5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG5hbWUpIHsKICAgIHJldHVybiBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKSwgdGhpcy5oYXMobmFtZSkgPyB0aGlzLm1hcFtuYW1lXSA6IG51bGw7CiAgfSwgSGVhZGVycy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKG5hbWUpIHsKICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKTsKICB9LCBIZWFkZXJzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKICAgIHRoaXMubWFwW25vcm1hbGl6ZU5hbWUobmFtZSldID0gbm9ybWFsaXplVmFsdWUodmFsdWUpOwogIH0sIEhlYWRlcnMucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHsKICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcy5tYXApIHsKICAgICAgdGhpcy5tYXAuaGFzT3duUHJvcGVydHkobmFtZSkgJiYgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCB0aGlzLm1hcFtuYW1lXSwgbmFtZSwgdGhpcyk7CiAgICB9CiAgfSwgSGVhZGVycy5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciBpdGVtcyA9IFtdOwogICAgcmV0dXJuIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUpIHsKICAgICAgaXRlbXMucHVzaChuYW1lKTsKICAgIH0pLCBpdGVyYXRvckZvcihpdGVtcyk7CiAgfSwgSGVhZGVycy5wcm90b3R5cGUudmFsdWVzID0gZnVuY3Rpb24gKCkgewogICAgdmFyIGl0ZW1zID0gW107CiAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICBpdGVtcy5wdXNoKHZhbHVlKTsKICAgIH0pLCBpdGVyYXRvckZvcihpdGVtcyk7CiAgfSwgSGVhZGVycy5wcm90b3R5cGUuZW50cmllcyA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciBpdGVtcyA9IFtdOwogICAgcmV0dXJuIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUpIHsKICAgICAgaXRlbXMucHVzaChbbmFtZSwgdmFsdWVdKTsKICAgIH0pLCBpdGVyYXRvckZvcihpdGVtcyk7CiAgfSwgc3VwcG9ydF9pdGVyYWJsZSAmJiAoSGVhZGVycy5wcm90b3R5cGVbU3ltYm9sLml0ZXJhdG9yXSA9IEhlYWRlcnMucHJvdG90eXBlLmVudHJpZXMpOwogIHZhciBtZXRob2RzID0gWyJERUxFVEUiLCAiR0VUIiwgIkhFQUQiLCAiT1BUSU9OUyIsICJQT1NUIiwgIlBVVCJdOwoKICBmdW5jdGlvbiBub3JtYWxpemVNZXRob2QobWV0aG9kKSB7CiAgICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpOwogICAgcmV0dXJuIG1ldGhvZHMuaW5kZXhPZih1cGNhc2VkKSA+IC0xID8gdXBjYXNlZCA6IG1ldGhvZDsKICB9CgogIGZ1bmN0aW9uIFJlcXVlc3QoaW5wdXQsIG9wdGlvbnMpIHsKICAgIHZhciBib2R5ID0gKG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9KS5ib2R5OwoKICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIFJlcXVlc3QpIHsKICAgICAgaWYgKGlucHV0LmJvZHlVc2VkKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJBbHJlYWR5IHJlYWQiKTsKICAgICAgdGhpcy51cmwgPSBpbnB1dC51cmwsIHRoaXMuY3JlZGVudGlhbHMgPSBpbnB1dC5jcmVkZW50aWFscywgb3B0aW9ucy5oZWFkZXJzIHx8ICh0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhpbnB1dC5oZWFkZXJzKSksIHRoaXMubWV0aG9kID0gaW5wdXQubWV0aG9kLCB0aGlzLm1vZGUgPSBpbnB1dC5tb2RlLCB0aGlzLnNpZ25hbCA9IGlucHV0LnNpZ25hbCwgYm9keSB8fCBudWxsID09IGlucHV0Ll9ib2R5SW5pdCB8fCAoYm9keSA9IGlucHV0Ll9ib2R5SW5pdCwgaW5wdXQuYm9keVVzZWQgPSAhMCk7CiAgICB9IGVsc2UgdGhpcy51cmwgPSBTdHJpbmcoaW5wdXQpOwoKICAgIGlmICh0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICJzYW1lLW9yaWdpbiIsICFvcHRpb25zLmhlYWRlcnMgJiYgdGhpcy5oZWFkZXJzIHx8ICh0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpKSwgdGhpcy5tZXRob2QgPSBub3JtYWxpemVNZXRob2Qob3B0aW9ucy5tZXRob2QgfHwgdGhpcy5tZXRob2QgfHwgIkdFVCIpLCB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgdGhpcy5tb2RlIHx8IG51bGwsIHRoaXMuc2lnbmFsID0gb3B0aW9ucy5zaWduYWwgfHwgdGhpcy5zaWduYWwsIHRoaXMucmVmZXJyZXIgPSBudWxsLCAoIkdFVCIgPT09IHRoaXMubWV0aG9kIHx8ICJIRUFEIiA9PT0gdGhpcy5tZXRob2QpICYmIGJvZHkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkJvZHkgbm90IGFsbG93ZWQgZm9yIEdFVCBvciBIRUFEIHJlcXVlc3RzIik7CgogICAgdGhpcy5faW5pdEJvZHkoYm9keSk7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGUkMShib2R5KSB7CiAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpOwogICAgcmV0dXJuIGJvZHkudHJpbSgpLnNwbGl0KCImIikuZm9yRWFjaChmdW5jdGlvbiAoYnl0ZXMpIHsKICAgICAgaWYgKGJ5dGVzKSB7CiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoIj0iKSwKICAgICAgICAgICAgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXCsvZywgIiAiKSwKICAgICAgICAgICAgdmFsdWUgPSBzcGxpdC5qb2luKCI9IikucmVwbGFjZSgvXCsvZywgIiAiKTsKICAgICAgICBmb3JtLmFwcGVuZChkZWNvZGVVUklDb21wb25lbnQobmFtZSksIGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpOwogICAgICB9CiAgICB9KSwgZm9ybTsKICB9CgogIGZ1bmN0aW9uIHBhcnNlSGVhZGVycyhyYXdIZWFkZXJzKSB7CiAgICB2YXIgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCksCiAgICAgICAgcHJlUHJvY2Vzc2VkSGVhZGVyczsKICAgIHJldHVybiByYXdIZWFkZXJzLnJlcGxhY2UoL1xyP1xuW1x0IF0rL2csICIgIikuc3BsaXQoL1xyP1xuLykuZm9yRWFjaChmdW5jdGlvbiAobGluZSkgewogICAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCI6IiksCiAgICAgICAgICBrZXkgPSBwYXJ0cy5zaGlmdCgpLnRyaW0oKTsKCiAgICAgIGlmIChrZXkpIHsKICAgICAgICB2YXIgdmFsdWUgPSBwYXJ0cy5qb2luKCI6IikudHJpbSgpOwogICAgICAgIGhlYWRlcnMuYXBwZW5kKGtleSwgdmFsdWUpOwogICAgICB9CiAgICB9KSwgaGVhZGVyczsKICB9CgogIGZ1bmN0aW9uIFJlc3BvbnNlKGJvZHlJbml0LCBvcHRpb25zKSB7CiAgICBvcHRpb25zIHx8IChvcHRpb25zID0ge30pLCB0aGlzLnR5cGUgPSAiZGVmYXVsdCIsIHRoaXMuc3RhdHVzID0gdm9pZCAwID09PSBvcHRpb25zLnN0YXR1cyA/IDIwMCA6IG9wdGlvbnMuc3RhdHVzLCB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwLCB0aGlzLnN0YXR1c1RleHQgPSAic3RhdHVzVGV4dCIgaW4gb3B0aW9ucyA/IG9wdGlvbnMuc3RhdHVzVGV4dCA6ICJPSyIsIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycyksIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgIiIsIHRoaXMuX2luaXRCb2R5KGJvZHlJbml0KTsKICB9CgogIFJlcXVlc3QucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIG5ldyBSZXF1ZXN0KHRoaXMsIHsKICAgICAgYm9keTogdGhpcy5fYm9keUluaXQKICAgIH0pOwogIH0sIEJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSksIEJvZHkuY2FsbChSZXNwb25zZS5wcm90b3R5cGUpLCBSZXNwb25zZS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKHRoaXMuX2JvZHlJbml0LCB7CiAgICAgIHN0YXR1czogdGhpcy5zdGF0dXMsCiAgICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dCwKICAgICAgaGVhZGVyczogbmV3IEhlYWRlcnModGhpcy5oZWFkZXJzKSwKICAgICAgdXJsOiB0aGlzLnVybAogICAgfSk7CiAgfSwgUmVzcG9uc2UuZXJyb3IgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgcmVzcG9uc2UgPSBuZXcgUmVzcG9uc2UobnVsbCwgewogICAgICBzdGF0dXM6IDAsCiAgICAgIHN0YXR1c1RleHQ6ICIiCiAgICB9KTsKICAgIHJldHVybiByZXNwb25zZS50eXBlID0gImVycm9yIiwgcmVzcG9uc2U7CiAgfTsKICB2YXIgcmVkaXJlY3RTdGF0dXNlcyA9IFszMDEsIDMwMiwgMzAzLCAzMDcsIDMwOF07CgogIFJlc3BvbnNlLnJlZGlyZWN0ID0gZnVuY3Rpb24gKHVybCwgc3RhdHVzKSB7CiAgICBpZiAoLTEgPT09IHJlZGlyZWN0U3RhdHVzZXMuaW5kZXhPZihzdGF0dXMpKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcigiSW52YWxpZCBzdGF0dXMgY29kZSIpOwogICAgcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7CiAgICAgIHN0YXR1czogc3RhdHVzLAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgbG9jYXRpb246IHVybAogICAgICB9CiAgICB9KTsKICB9OwoKICB2YXIgRE9NRXhjZXB0aW9uID0gc2VsZi5ET01FeGNlcHRpb247CgogIHRyeSB7CiAgICBuZXcgRE9NRXhjZXB0aW9uKCk7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICAoRE9NRXhjZXB0aW9uID0gZnVuY3Rpb24gRE9NRXhjZXB0aW9uKG1lc3NhZ2UsIG5hbWUpIHsKICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSwgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgdmFyIGVycm9yID0gRXJyb3IobWVzc2FnZSk7CiAgICAgIHRoaXMuc3RhY2sgPSBlcnJvci5zdGFjazsKICAgIH0pLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKSwgRE9NRXhjZXB0aW9uLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IERPTUV4Y2VwdGlvbjsKICB9CgogIGZ1bmN0aW9uIGZldGNoJDEoaW5wdXQsIGluaXQpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoaW5wdXQsIGluaXQpOwogICAgICBpZiAocmVxdWVzdC5zaWduYWwgJiYgcmVxdWVzdC5zaWduYWwuYWJvcnRlZCkgcmV0dXJuIHJlamVjdChuZXcgRE9NRXhjZXB0aW9uKCJBYm9ydGVkIiwgIkFib3J0RXJyb3IiKSk7CiAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKCiAgICAgIGZ1bmN0aW9uIGFib3J0WGhyKCkgewogICAgICAgIHhoci5hYm9ydCgpOwogICAgICB9CgogICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBvcHRpb25zID0gewogICAgICAgICAgc3RhdHVzOiB4aHIuc3RhdHVzLAogICAgICAgICAgc3RhdHVzVGV4dDogeGhyLnN0YXR1c1RleHQsCiAgICAgICAgICBoZWFkZXJzOiBwYXJzZUhlYWRlcnMoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpIHx8ICIiKQogICAgICAgIH07CiAgICAgICAgb3B0aW9ucy51cmwgPSAicmVzcG9uc2VVUkwiIGluIHhociA/IHhoci5yZXNwb25zZVVSTCA6IG9wdGlvbnMuaGVhZGVycy5nZXQoIlgtUmVxdWVzdC1VUkwiKTsKICAgICAgICB2YXIgYm9keSA9ICJyZXNwb25zZSIgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dDsKICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZShib2R5LCBvcHRpb25zKSk7CiAgICAgIH0sIHhoci5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCJOZXR3b3JrIHJlcXVlc3QgZmFpbGVkIikpOwogICAgICB9LCB4aHIub250aW1lb3V0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCJOZXR3b3JrIHJlcXVlc3QgZmFpbGVkIikpOwogICAgICB9LCB4aHIub25hYm9ydCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZWplY3QobmV3IERPTUV4Y2VwdGlvbigiQWJvcnRlZCIsICJBYm9ydEVycm9yIikpOwogICAgICB9LCB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC51cmwsICEwKSwgImluY2x1ZGUiID09PSByZXF1ZXN0LmNyZWRlbnRpYWxzID8geGhyLndpdGhDcmVkZW50aWFscyA9ICEwIDogIm9taXQiID09PSByZXF1ZXN0LmNyZWRlbnRpYWxzICYmICh4aHIud2l0aENyZWRlbnRpYWxzID0gITEpLCAicmVzcG9uc2VUeXBlIiBpbiB4aHIgJiYgc3VwcG9ydF9ibG9iICYmICh4aHIucmVzcG9uc2VUeXBlID0gImJsb2IiKSwgcmVxdWVzdC5oZWFkZXJzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBuYW1lKSB7CiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIobmFtZSwgdmFsdWUpOwogICAgICB9KSwgcmVxdWVzdC5zaWduYWwgJiYgKHJlcXVlc3Quc2lnbmFsLmFkZEV2ZW50TGlzdGVuZXIoImFib3J0IiwgYWJvcnRYaHIpLCB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgICAgIDQgPT09IHhoci5yZWFkeVN0YXRlICYmIHJlcXVlc3Quc2lnbmFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoImFib3J0IiwgYWJvcnRYaHIpOwogICAgICB9KSwgeGhyLnNlbmQodm9pZCAwID09PSByZXF1ZXN0Ll9ib2R5SW5pdCA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdCk7CiAgICB9KTsKICB9CgogIGZldGNoJDEucG9seWZpbGwgPSAhMCwgc2VsZi5mZXRjaCB8fCAoc2VsZi5mZXRjaCA9IGZldGNoJDEsIHNlbGYuSGVhZGVycyA9IEhlYWRlcnMsIHNlbGYuUmVxdWVzdCA9IFJlcXVlc3QsIHNlbGYuUmVzcG9uc2UgPSBSZXNwb25zZSk7CgogIHZhciBPID0gIm9iamVjdCIsCiAgICAgIGNoZWNrID0gZnVuY3Rpb24gY2hlY2soaXQpIHsKICAgIHJldHVybiBpdCAmJiBpdC5NYXRoID09IE1hdGggJiYgaXQ7CiAgfSwKICAgICAgZ2xvYmFsXzEgPSBjaGVjaygodHlwZW9mIGdsb2JhbFRoaXMgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mMihnbG9iYWxUaGlzKSkgPT0gTyAmJiBnbG9iYWxUaGlzKSB8fCBjaGVjaygodHlwZW9mIHdpbmRvdyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YyKHdpbmRvdykpID09IE8gJiYgd2luZG93KSB8fCBjaGVjaygodHlwZW9mIHNlbGYgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mMihzZWxmKSkgPT0gTyAmJiBzZWxmKSB8fCBjaGVjayhfdHlwZW9mMihjb21tb25qc0dsb2JhbCkgPT0gTyAmJiBjb21tb25qc0dsb2JhbCkgfHwgRnVuY3Rpb24oInJldHVybiB0aGlzIikoKSwKICAgICAgZmFpbHMgPSBmdW5jdGlvbiBmYWlscyhleGVjKSB7CiAgICB0cnkgewogICAgICByZXR1cm4gISFleGVjKCk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICByZXR1cm4gITA7CiAgICB9CiAgfSwKICAgICAgZGVzY3JpcHRvcnMgPSAhZmFpbHMoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIDcgIT0gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAiYSIsIHsKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIDc7CiAgICAgIH0KICAgIH0pLmE7CiAgfSksCiAgICAgIGlzT2JqZWN0JDEgPSBmdW5jdGlvbiBpc09iamVjdCQxKGl0KSB7CiAgICByZXR1cm4gIm9iamVjdCIgPT0gX3R5cGVvZjIoaXQpID8gbnVsbCAhPT0gaXQgOiAiZnVuY3Rpb24iID09IHR5cGVvZiBpdDsKICB9LAogICAgICBkb2N1bWVudCQxID0gZ2xvYmFsXzEuZG9jdW1lbnQsCiAgICAgIEVYSVNUUyA9IGlzT2JqZWN0JDEoZG9jdW1lbnQkMSkgJiYgaXNPYmplY3QkMShkb2N1bWVudCQxLmNyZWF0ZUVsZW1lbnQpLAogICAgICBkb2N1bWVudENyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiBkb2N1bWVudENyZWF0ZUVsZW1lbnQoaXQpIHsKICAgIHJldHVybiBFWElTVFMgPyBkb2N1bWVudCQxLmNyZWF0ZUVsZW1lbnQoaXQpIDoge307CiAgfSwKICAgICAgaWU4RG9tRGVmaW5lID0gIWRlc2NyaXB0b3JzICYmICFmYWlscyhmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gNyAhPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnRDcmVhdGVFbGVtZW50KCJkaXYiKSwgImEiLCB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiA3OwogICAgICB9CiAgICB9KS5hOwogIH0pLAogICAgICBhbk9iamVjdCA9IGZ1bmN0aW9uIGFuT2JqZWN0KGl0KSB7CiAgICBpZiAoIWlzT2JqZWN0JDEoaXQpKSB0aHJvdyBUeXBlRXJyb3IoU3RyaW5nKGl0KSArICIgaXMgbm90IGFuIG9iamVjdCIpOwogICAgcmV0dXJuIGl0OwogIH0sCiAgICAgIHRvUHJpbWl0aXZlID0gZnVuY3Rpb24gdG9QcmltaXRpdmUoaW5wdXQsIFBSRUZFUlJFRF9TVFJJTkcpIHsKICAgIGlmICghaXNPYmplY3QkMShpbnB1dCkpIHJldHVybiBpbnB1dDsKICAgIHZhciBmbiwgdmFsOwogICAgaWYgKFBSRUZFUlJFRF9TVFJJTkcgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgKGZuID0gaW5wdXQudG9TdHJpbmcpICYmICFpc09iamVjdCQxKHZhbCA9IGZuLmNhbGwoaW5wdXQpKSkgcmV0dXJuIHZhbDsKICAgIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiAoZm4gPSBpbnB1dC52YWx1ZU9mKSAmJiAhaXNPYmplY3QkMSh2YWwgPSBmbi5jYWxsKGlucHV0KSkpIHJldHVybiB2YWw7CiAgICBpZiAoIVBSRUZFUlJFRF9TVFJJTkcgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgKGZuID0gaW5wdXQudG9TdHJpbmcpICYmICFpc09iamVjdCQxKHZhbCA9IGZuLmNhbGwoaW5wdXQpKSkgcmV0dXJuIHZhbDsKICAgIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlIik7CiAgfSwKICAgICAgbmF0aXZlRGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHksCiAgICAgIGYsCiAgICAgIG9iamVjdERlZmluZVByb3BlcnR5ID0gewogICAgZjogZGVzY3JpcHRvcnMgPyBuYXRpdmVEZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpIHsKICAgICAgaWYgKGFuT2JqZWN0KE8pLCBQID0gdG9QcmltaXRpdmUoUCwgITApLCBhbk9iamVjdChBdHRyaWJ1dGVzKSwgaWU4RG9tRGVmaW5lKSB0cnkgewogICAgICAgIHJldHVybiBuYXRpdmVEZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHt9CiAgICAgIGlmICgiZ2V0IiBpbiBBdHRyaWJ1dGVzIHx8ICJzZXQiIGluIEF0dHJpYnV0ZXMpIHRocm93IFR5cGVFcnJvcigiQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQiKTsKICAgICAgcmV0dXJuICJ2YWx1ZSIgaW4gQXR0cmlidXRlcyAmJiAoT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWUpLCBPOwogICAgfQogIH0sCiAgICAgIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvcihiaXRtYXAsIHZhbHVlKSB7CiAgICByZXR1cm4gewogICAgICBlbnVtZXJhYmxlOiAhKDEgJiBiaXRtYXApLAogICAgICBjb25maWd1cmFibGU6ICEoMiAmIGJpdG1hcCksCiAgICAgIHdyaXRhYmxlOiAhKDQgJiBiaXRtYXApLAogICAgICB2YWx1ZTogdmFsdWUKICAgIH07CiAgfSwKICAgICAgaGlkZSA9IGRlc2NyaXB0b3JzID8gZnVuY3Rpb24gKG9iamVjdCwga2V5LCB2YWx1ZSkgewogICAgcmV0dXJuIG9iamVjdERlZmluZVByb3BlcnR5LmYob2JqZWN0LCBrZXksIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvcigxLCB2YWx1ZSkpOwogIH0gOiBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7CiAgICByZXR1cm4gb2JqZWN0W2tleV0gPSB2YWx1ZSwgb2JqZWN0OwogIH0sCiAgICAgIHNldEdsb2JhbCA9IGZ1bmN0aW9uIHNldEdsb2JhbChrZXksIHZhbHVlKSB7CiAgICB0cnkgewogICAgICBoaWRlKGdsb2JhbF8xLCBrZXksIHZhbHVlKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGdsb2JhbF8xW2tleV0gPSB2YWx1ZTsKICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfSwKICAgICAgaXNQdXJlID0gITEsCiAgICAgIHNoYXJlZCA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICAgIHZhciBTSEFSRUQgPSAiX19jb3JlLWpzX3NoYXJlZF9fIiwKICAgICAgICBzdG9yZSA9IGdsb2JhbF8xW1NIQVJFRF0gfHwgc2V0R2xvYmFsKFNIQVJFRCwge30pOwogICAgKG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB2b2lkIDAgIT09IHZhbHVlID8gdmFsdWUgOiB7fSk7CiAgICB9KSgidmVyc2lvbnMiLCBbXSkucHVzaCh7CiAgICAgIHZlcnNpb246ICIzLjEuMyIsCiAgICAgIG1vZGU6ICJnbG9iYWwiLAogICAgICBjb3B5cmlnaHQ6ICLDgsKpIDIwMTkgRGVuaXMgUHVzaGthcmV2ICh6bG9pcm9jay5ydSkiCiAgICB9KTsKICB9KSwKICAgICAgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgICAgaGFzID0gZnVuY3Rpb24gaGFzKGl0LCBrZXkpIHsKICAgIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpOwogIH0sCiAgICAgIGZ1bmN0aW9uVG9TdHJpbmcgPSBzaGFyZWQoIm5hdGl2ZS1mdW5jdGlvbi10by1zdHJpbmciLCBGdW5jdGlvbi50b1N0cmluZyksCiAgICAgIFdlYWtNYXAgPSBnbG9iYWxfMS5XZWFrTWFwLAogICAgICBuYXRpdmVXZWFrTWFwID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgV2Vha01hcCAmJiAvbmF0aXZlIGNvZGUvLnRlc3QoZnVuY3Rpb25Ub1N0cmluZy5jYWxsKFdlYWtNYXApKSwKICAgICAgaWQgPSAwLAogICAgICBwb3N0Zml4ID0gTWF0aC5yYW5kb20oKSwKICAgICAgdWlkID0gZnVuY3Rpb24gdWlkKGtleSkgewogICAgcmV0dXJuICJTeW1ib2woIiArIFN0cmluZyh2b2lkIDAgPT09IGtleSA/ICIiIDoga2V5KSArICIpXyIgKyAoKytpZCArIHBvc3RmaXgpLnRvU3RyaW5nKDM2KTsKICB9LAogICAgICBrZXlzID0gc2hhcmVkKCJrZXlzIiksCiAgICAgIHNoYXJlZEtleSA9IGZ1bmN0aW9uIHNoYXJlZEtleShrZXkpIHsKICAgIHJldHVybiBrZXlzW2tleV0gfHwgKGtleXNba2V5XSA9IHVpZChrZXkpKTsKICB9LAogICAgICBoaWRkZW5LZXlzID0ge30sCiAgICAgIFdlYWtNYXAkMSA9IGdsb2JhbF8xLldlYWtNYXAsCiAgICAgIHNldCwKICAgICAgZ2V0LAogICAgICBoYXMkMSwKICAgICAgZW5mb3JjZSA9IGZ1bmN0aW9uIGVuZm9yY2UoaXQpIHsKICAgIHJldHVybiBoYXMkMShpdCkgPyBnZXQoaXQpIDogc2V0KGl0LCB7fSk7CiAgfSwKICAgICAgZ2V0dGVyRm9yID0gZnVuY3Rpb24gZ2V0dGVyRm9yKFRZUEUpIHsKICAgIHJldHVybiBmdW5jdGlvbiAoaXQpIHsKICAgICAgdmFyIHN0YXRlOwogICAgICBpZiAoIWlzT2JqZWN0JDEoaXQpIHx8IChzdGF0ZSA9IGdldChpdCkpLnR5cGUgIT09IFRZUEUpIHRocm93IFR5cGVFcnJvcigiSW5jb21wYXRpYmxlIHJlY2VpdmVyLCAiICsgVFlQRSArICIgcmVxdWlyZWQiKTsKICAgICAgcmV0dXJuIHN0YXRlOwogICAgfTsKICB9OwoKICBpZiAobmF0aXZlV2Vha01hcCkgewogICAgdmFyIHN0b3JlID0gbmV3IFdlYWtNYXAkMSgpLAogICAgICAgIHdtZ2V0ID0gc3RvcmUuZ2V0LAogICAgICAgIHdtaGFzID0gc3RvcmUuaGFzLAogICAgICAgIHdtc2V0ID0gc3RvcmUuc2V0OwogICAgc2V0ID0gZnVuY3Rpb24gc2V0KGl0LCBtZXRhZGF0YSkgewogICAgICByZXR1cm4gd21zZXQuY2FsbChzdG9yZSwgaXQsIG1ldGFkYXRhKSwgbWV0YWRhdGE7CiAgICB9LCBnZXQgPSBmdW5jdGlvbiBnZXQoaXQpIHsKICAgICAgcmV0dXJuIHdtZ2V0LmNhbGwoc3RvcmUsIGl0KSB8fCB7fTsKICAgIH0sIGhhcyQxID0gZnVuY3Rpb24gaGFzJDEoaXQpIHsKICAgICAgcmV0dXJuIHdtaGFzLmNhbGwoc3RvcmUsIGl0KTsKICAgIH07CiAgfSBlbHNlIHsKICAgIHZhciBTVEFURSA9IHNoYXJlZEtleSgic3RhdGUiKTsKICAgIGhpZGRlbktleXNbU1RBVEVdID0gITAsIHNldCA9IGZ1bmN0aW9uIHNldChpdCwgbWV0YWRhdGEpIHsKICAgICAgcmV0dXJuIGhpZGUoaXQsIFNUQVRFLCBtZXRhZGF0YSksIG1ldGFkYXRhOwogICAgfSwgZ2V0ID0gZnVuY3Rpb24gZ2V0KGl0KSB7CiAgICAgIHJldHVybiBoYXMoaXQsIFNUQVRFKSA/IGl0W1NUQVRFXSA6IHt9OwogICAgfSwgaGFzJDEgPSBmdW5jdGlvbiBoYXMkMShpdCkgewogICAgICByZXR1cm4gaGFzKGl0LCBTVEFURSk7CiAgICB9OwogIH0KCiAgdmFyIGludGVybmFsU3RhdGUgPSB7CiAgICBzZXQ6IHNldCwKICAgIGdldDogZ2V0LAogICAgaGFzOiBoYXMkMSwKICAgIGVuZm9yY2U6IGVuZm9yY2UsCiAgICBnZXR0ZXJGb3I6IGdldHRlckZvcgogIH0sCiAgICAgIHJlZGVmaW5lID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkgewogICAgdmFyIGdldEludGVybmFsU3RhdGUgPSBpbnRlcm5hbFN0YXRlLmdldCwKICAgICAgICBlbmZvcmNlSW50ZXJuYWxTdGF0ZSA9IGludGVybmFsU3RhdGUuZW5mb3JjZSwKICAgICAgICBURU1QTEFURSA9IFN0cmluZyhmdW5jdGlvblRvU3RyaW5nKS5zcGxpdCgidG9TdHJpbmciKTsKICAgIHNoYXJlZCgiaW5zcGVjdFNvdXJjZSIsIGZ1bmN0aW9uIChpdCkgewogICAgICByZXR1cm4gZnVuY3Rpb25Ub1N0cmluZy5jYWxsKGl0KTsKICAgIH0pLCAobW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTywga2V5LCB2YWx1ZSwgb3B0aW9ucykgewogICAgICB2YXIgdW5zYWZlID0gISFvcHRpb25zICYmICEhb3B0aW9ucy51bnNhZmUsCiAgICAgICAgICBzaW1wbGUgPSAhIW9wdGlvbnMgJiYgISFvcHRpb25zLmVudW1lcmFibGUsCiAgICAgICAgICBub1RhcmdldEdldCA9ICEhb3B0aW9ucyAmJiAhIW9wdGlvbnMubm9UYXJnZXRHZXQ7CiAgICAgICJmdW5jdGlvbiIgPT0gdHlwZW9mIHZhbHVlICYmICgic3RyaW5nIiAhPSB0eXBlb2Yga2V5IHx8IGhhcyh2YWx1ZSwgIm5hbWUiKSB8fCBoaWRlKHZhbHVlLCAibmFtZSIsIGtleSksIGVuZm9yY2VJbnRlcm5hbFN0YXRlKHZhbHVlKS5zb3VyY2UgPSBURU1QTEFURS5qb2luKCJzdHJpbmciID09IHR5cGVvZiBrZXkgPyBrZXkgOiAiIikpLCBPICE9PSBnbG9iYWxfMSA/ICh1bnNhZmUgPyAhbm9UYXJnZXRHZXQgJiYgT1trZXldICYmIChzaW1wbGUgPSAhMCkgOiBkZWxldGUgT1trZXldLCBzaW1wbGUgPyBPW2tleV0gPSB2YWx1ZSA6IGhpZGUoTywga2V5LCB2YWx1ZSkpIDogc2ltcGxlID8gT1trZXldID0gdmFsdWUgOiBzZXRHbG9iYWwoa2V5LCB2YWx1ZSk7CiAgICB9KShGdW5jdGlvbi5wcm90b3R5cGUsICJ0b1N0cmluZyIsIGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogICAgICByZXR1cm4gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdGhpcyAmJiBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpLnNvdXJjZSB8fCBmdW5jdGlvblRvU3RyaW5nLmNhbGwodGhpcyk7CiAgICB9KTsKICB9KSwKICAgICAgdG9TdHJpbmcgPSB7fS50b1N0cmluZywKICAgICAgY2xhc3NvZlJhdyA9IGZ1bmN0aW9uIGNsYXNzb2ZSYXcoaXQpIHsKICAgIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7CiAgfSwKICAgICAgbmF0aXZlU3ltYm9sID0gISFPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzICYmICFmYWlscyhmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gIVN0cmluZyhTeW1ib2woKSk7CiAgfSksCiAgICAgIFN5bWJvbCQxID0gZ2xvYmFsXzEuU3ltYm9sLAogICAgICBzdG9yZSQxID0gc2hhcmVkKCJ3a3MiKSwKICAgICAgd2VsbEtub3duU3ltYm9sID0gZnVuY3Rpb24gd2VsbEtub3duU3ltYm9sKG5hbWUpIHsKICAgIHJldHVybiBzdG9yZSQxW25hbWVdIHx8IChzdG9yZSQxW25hbWVdID0gbmF0aXZlU3ltYm9sICYmIFN5bWJvbCQxW25hbWVdIHx8IChuYXRpdmVTeW1ib2wgPyBTeW1ib2wkMSA6IHVpZCkoIlN5bWJvbC4iICsgbmFtZSkpOwogIH0sCiAgICAgIFRPX1NUUklOR19UQUcgPSB3ZWxsS25vd25TeW1ib2woInRvU3RyaW5nVGFnIiksCiAgICAgIENPUlJFQ1RfQVJHVU1FTlRTID0gIkFyZ3VtZW50cyIgPT0gY2xhc3NvZlJhdyhmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gYXJndW1lbnRzOwogIH0oKSksCiAgICAgIHRyeUdldCA9IGZ1bmN0aW9uIHRyeUdldChpdCwga2V5KSB7CiAgICB0cnkgewogICAgICByZXR1cm4gaXRba2V5XTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7fQogIH0sCiAgICAgIGNsYXNzb2YgPSBmdW5jdGlvbiBjbGFzc29mKGl0KSB7CiAgICB2YXIgTywgdGFnLCByZXN1bHQ7CiAgICByZXR1cm4gdm9pZCAwID09PSBpdCA/ICJVbmRlZmluZWQiIDogbnVsbCA9PT0gaXQgPyAiTnVsbCIgOiAic3RyaW5nIiA9PSB0eXBlb2YgKHRhZyA9IHRyeUdldChPID0gT2JqZWN0KGl0KSwgVE9fU1RSSU5HX1RBRykpID8gdGFnIDogQ09SUkVDVF9BUkdVTUVOVFMgPyBjbGFzc29mUmF3KE8pIDogIk9iamVjdCIgPT0gKHJlc3VsdCA9IGNsYXNzb2ZSYXcoTykpICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIE8uY2FsbGVlID8gIkFyZ3VtZW50cyIgOiByZXN1bHQ7CiAgfSwKICAgICAgVE9fU1RSSU5HX1RBRyQxLAogICAgICB0ZXN0ID0ge307CgogIHRlc3Rbd2VsbEtub3duU3ltYm9sKCJ0b1N0cmluZ1RhZyIpXSA9ICJ6IjsKICB2YXIgb2JqZWN0VG9TdHJpbmcgPSAiW29iamVjdCB6XSIgIT09IFN0cmluZyh0ZXN0KSA/IGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogICAgcmV0dXJuICJbb2JqZWN0ICIgKyBjbGFzc29mKHRoaXMpICsgIl0iOwogIH0gOiB0ZXN0LnRvU3RyaW5nLAogICAgICBPYmplY3RQcm90b3R5cGUgPSBPYmplY3QucHJvdG90eXBlOwogIG9iamVjdFRvU3RyaW5nICE9PSBPYmplY3RQcm90b3R5cGUudG9TdHJpbmcgJiYgcmVkZWZpbmUoT2JqZWN0UHJvdG90eXBlLCAidG9TdHJpbmciLCBvYmplY3RUb1N0cmluZywgewogICAgdW5zYWZlOiAhMAogIH0pOwoKICB2YXIgY2VpbCA9IE1hdGguY2VpbCwKICAgICAgZmxvb3IgPSBNYXRoLmZsb29yLAogICAgICB0b0ludGVnZXIgPSBmdW5jdGlvbiB0b0ludGVnZXIoYXJndW1lbnQpIHsKICAgIHJldHVybiBpc05hTihhcmd1bWVudCA9ICthcmd1bWVudCkgPyAwIDogKGFyZ3VtZW50ID4gMCA/IGZsb29yIDogY2VpbCkoYXJndW1lbnQpOwogIH0sCiAgICAgIHJlcXVpcmVPYmplY3RDb2VyY2libGUgPSBmdW5jdGlvbiByZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGl0KSB7CiAgICBpZiAobnVsbCA9PSBpdCkgdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAiICsgaXQpOwogICAgcmV0dXJuIGl0OwogIH0sCiAgICAgIGNyZWF0ZU1ldGhvZCA9IGZ1bmN0aW9uIGNyZWF0ZU1ldGhvZChDT05WRVJUX1RPX1NUUklORykgewogICAgcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgcG9zKSB7CiAgICAgIHZhciBTID0gU3RyaW5nKHJlcXVpcmVPYmplY3RDb2VyY2libGUoJHRoaXMpKSwKICAgICAgICAgIHBvc2l0aW9uID0gdG9JbnRlZ2VyKHBvcyksCiAgICAgICAgICBzaXplID0gUy5sZW5ndGgsCiAgICAgICAgICBmaXJzdCwKICAgICAgICAgIHNlY29uZDsKICAgICAgcmV0dXJuIHBvc2l0aW9uIDwgMCB8fCBwb3NpdGlvbiA+PSBzaXplID8gQ09OVkVSVF9UT19TVFJJTkcgPyAiIiA6IHZvaWQgMCA6IChmaXJzdCA9IFMuY2hhckNvZGVBdChwb3NpdGlvbikpIDwgNTUyOTYgfHwgZmlyc3QgPiA1NjMxOSB8fCBwb3NpdGlvbiArIDEgPT09IHNpemUgfHwgKHNlY29uZCA9IFMuY2hhckNvZGVBdChwb3NpdGlvbiArIDEpKSA8IDU2MzIwIHx8IHNlY29uZCA+IDU3MzQzID8gQ09OVkVSVF9UT19TVFJJTkcgPyBTLmNoYXJBdChwb3NpdGlvbikgOiBmaXJzdCA6IENPTlZFUlRfVE9fU1RSSU5HID8gUy5zbGljZShwb3NpdGlvbiwgcG9zaXRpb24gKyAyKSA6IHNlY29uZCAtIDU2MzIwICsgKGZpcnN0IC0gNTUyOTYgPDwgMTApICsgNjU1MzY7CiAgICB9OwogIH0sCiAgICAgIHN0cmluZ011bHRpYnl0ZSA9IHsKICAgIGNvZGVBdDogY3JlYXRlTWV0aG9kKCExKSwKICAgIGNoYXJBdDogY3JlYXRlTWV0aG9kKCEwKQogIH0sCiAgICAgIG5hdGl2ZVByb3BlcnR5SXNFbnVtZXJhYmxlID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUsCiAgICAgIGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgICAgIE5BU0hPUk5fQlVHLAogICAgICBmJDEsCiAgICAgIG9iamVjdFByb3BlcnR5SXNFbnVtZXJhYmxlID0gewogICAgZjogZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yICYmICFuYXRpdmVQcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHsKICAgICAgMTogMgogICAgfSwgMSkgPyBmdW5jdGlvbiBwcm9wZXJ0eUlzRW51bWVyYWJsZShWKSB7CiAgICAgIHZhciBkZXNjcmlwdG9yID0gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRoaXMsIFYpOwogICAgICByZXR1cm4gISFkZXNjcmlwdG9yICYmIGRlc2NyaXB0b3IuZW51bWVyYWJsZTsKICAgIH0gOiBuYXRpdmVQcm9wZXJ0eUlzRW51bWVyYWJsZQogIH0sCiAgICAgIHNwbGl0ID0gIiIuc3BsaXQsCiAgICAgIGluZGV4ZWRPYmplY3QgPSBmYWlscyhmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gIU9iamVjdCgieiIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApOwogIH0pID8gZnVuY3Rpb24gKGl0KSB7CiAgICByZXR1cm4gIlN0cmluZyIgPT0gY2xhc3NvZlJhdyhpdCkgPyBzcGxpdC5jYWxsKGl0LCAiIikgOiBPYmplY3QoaXQpOwogIH0gOiBPYmplY3QsCiAgICAgIHRvSW5kZXhlZE9iamVjdCA9IGZ1bmN0aW9uIHRvSW5kZXhlZE9iamVjdChpdCkgewogICAgcmV0dXJuIGluZGV4ZWRPYmplY3QocmVxdWlyZU9iamVjdENvZXJjaWJsZShpdCkpOwogIH0sCiAgICAgIG5hdGl2ZUdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgICAgIGYkMiwKICAgICAgb2JqZWN0R2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gewogICAgZjogZGVzY3JpcHRvcnMgPyBuYXRpdmVHZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgOiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkgewogICAgICBpZiAoTyA9IHRvSW5kZXhlZE9iamVjdChPKSwgUCA9IHRvUHJpbWl0aXZlKFAsICEwKSwgaWU4RG9tRGVmaW5lKSB0cnkgewogICAgICAgIHJldHVybiBuYXRpdmVHZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7fQogICAgICBpZiAoaGFzKE8sIFApKSByZXR1cm4gY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKCFvYmplY3RQcm9wZXJ0eUlzRW51bWVyYWJsZS5mLmNhbGwoTywgUCksIE9bUF0pOwogICAgfQogIH0sCiAgICAgIHBhdGggPSBnbG9iYWxfMSwKICAgICAgYUZ1bmN0aW9uID0gZnVuY3Rpb24gYUZ1bmN0aW9uKHZhcmlhYmxlKSB7CiAgICByZXR1cm4gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdmFyaWFibGUgPyB2YXJpYWJsZSA6IHZvaWQgMDsKICB9LAogICAgICBnZXRCdWlsdEluID0gZnVuY3Rpb24gZ2V0QnVpbHRJbihuYW1lc3BhY2UsIG1ldGhvZCkgewogICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyID8gYUZ1bmN0aW9uKHBhdGhbbmFtZXNwYWNlXSkgfHwgYUZ1bmN0aW9uKGdsb2JhbF8xW25hbWVzcGFjZV0pIDogcGF0aFtuYW1lc3BhY2VdICYmIHBhdGhbbmFtZXNwYWNlXVttZXRob2RdIHx8IGdsb2JhbF8xW25hbWVzcGFjZV0gJiYgZ2xvYmFsXzFbbmFtZXNwYWNlXVttZXRob2RdOwogIH0sCiAgICAgIG1pbiA9IE1hdGgubWluLAogICAgICB0b0xlbmd0aCA9IGZ1bmN0aW9uIHRvTGVuZ3RoKGFyZ3VtZW50KSB7CiAgICByZXR1cm4gYXJndW1lbnQgPiAwID8gbWluKHRvSW50ZWdlcihhcmd1bWVudCksIDkwMDcxOTkyNTQ3NDA5OTEpIDogMDsKICB9LAogICAgICBtYXggPSBNYXRoLm1heCwKICAgICAgbWluJDEgPSBNYXRoLm1pbiwKICAgICAgdG9BYnNvbHV0ZUluZGV4ID0gZnVuY3Rpb24gdG9BYnNvbHV0ZUluZGV4KGluZGV4LCBsZW5ndGgpIHsKICAgIHZhciBpbnRlZ2VyID0gdG9JbnRlZ2VyKGluZGV4KTsKICAgIHJldHVybiBpbnRlZ2VyIDwgMCA/IG1heChpbnRlZ2VyICsgbGVuZ3RoLCAwKSA6IG1pbiQxKGludGVnZXIsIGxlbmd0aCk7CiAgfSwKICAgICAgY3JlYXRlTWV0aG9kJDEgPSBmdW5jdGlvbiBjcmVhdGVNZXRob2QkMShJU19JTkNMVURFUykgewogICAgcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgZWwsIGZyb21JbmRleCkgewogICAgICB2YXIgTyA9IHRvSW5kZXhlZE9iamVjdCgkdGhpcyksCiAgICAgICAgICBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCksCiAgICAgICAgICBpbmRleCA9IHRvQWJzb2x1dGVJbmRleChmcm9tSW5kZXgsIGxlbmd0aCksCiAgICAgICAgICB2YWx1ZTsKCiAgICAgIGlmIChJU19JTkNMVURFUyAmJiBlbCAhPSBlbCkgewogICAgICAgIGZvciAoOyBsZW5ndGggPiBpbmRleDspIHsKICAgICAgICAgIGlmICgodmFsdWUgPSBPW2luZGV4KytdKSAhPSB2YWx1ZSkgcmV0dXJuICEwOwogICAgICAgIH0KICAgICAgfSBlbHNlIGZvciAoOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKykgewogICAgICAgIGlmICgoSVNfSU5DTFVERVMgfHwgaW5kZXggaW4gTykgJiYgT1tpbmRleF0gPT09IGVsKSByZXR1cm4gSVNfSU5DTFVERVMgfHwgaW5kZXggfHwgMDsKICAgICAgfQoKICAgICAgcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTsKICAgIH07CiAgfSwKICAgICAgYXJyYXlJbmNsdWRlcywKICAgICAgaW5kZXhPZiA9IHsKICAgIGluY2x1ZGVzOiBjcmVhdGVNZXRob2QkMSghMCksCiAgICBpbmRleE9mOiBjcmVhdGVNZXRob2QkMSghMSkKICB9LmluZGV4T2YsCiAgICAgIG9iamVjdEtleXNJbnRlcm5hbCA9IGZ1bmN0aW9uIG9iamVjdEtleXNJbnRlcm5hbChvYmplY3QsIG5hbWVzKSB7CiAgICB2YXIgTyA9IHRvSW5kZXhlZE9iamVjdChvYmplY3QpLAogICAgICAgIGkgPSAwLAogICAgICAgIHJlc3VsdCA9IFtdLAogICAgICAgIGtleTsKCiAgICBmb3IgKGtleSBpbiBPKSB7CiAgICAgICFoYXMoaGlkZGVuS2V5cywga2V5KSAmJiBoYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpOwogICAgfQoKICAgIGZvciAoOyBuYW1lcy5sZW5ndGggPiBpOykgewogICAgICBoYXMoTywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKH5pbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpKTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwogIH0sCiAgICAgIGVudW1CdWdLZXlzID0gWyJjb25zdHJ1Y3RvciIsICJoYXNPd25Qcm9wZXJ0eSIsICJpc1Byb3RvdHlwZU9mIiwgInByb3BlcnR5SXNFbnVtZXJhYmxlIiwgInRvTG9jYWxlU3RyaW5nIiwgInRvU3RyaW5nIiwgInZhbHVlT2YiXSwKICAgICAgaGlkZGVuS2V5cyQxID0gZW51bUJ1Z0tleXMuY29uY2F0KCJsZW5ndGgiLCAicHJvdG90eXBlIiksCiAgICAgIGYkMywKICAgICAgb2JqZWN0R2V0T3duUHJvcGVydHlOYW1lcyA9IHsKICAgIGY6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoTykgewogICAgICByZXR1cm4gb2JqZWN0S2V5c0ludGVybmFsKE8sIGhpZGRlbktleXMkMSk7CiAgICB9CiAgfSwKICAgICAgZiQ0LAogICAgICBvYmplY3RHZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSB7CiAgICBmOiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzCiAgfSwKICAgICAgb3duS2V5cyA9IGdldEJ1aWx0SW4oIlJlZmxlY3QiLCAib3duS2V5cyIpIHx8IGZ1bmN0aW9uIG93bktleXMoaXQpIHsKICAgIHZhciBrZXlzID0gb2JqZWN0R2V0T3duUHJvcGVydHlOYW1lcy5mKGFuT2JqZWN0KGl0KSksCiAgICAgICAgZ2V0T3duUHJvcGVydHlTeW1ib2xzID0gb2JqZWN0R2V0T3duUHJvcGVydHlTeW1ib2xzLmY7CiAgICByZXR1cm4gZ2V0T3duUHJvcGVydHlTeW1ib2xzID8ga2V5cy5jb25jYXQoZ2V0T3duUHJvcGVydHlTeW1ib2xzKGl0KSkgOiBrZXlzOwogIH0sCiAgICAgIGNvcHlDb25zdHJ1Y3RvclByb3BlcnRpZXMgPSBmdW5jdGlvbiBjb3B5Q29uc3RydWN0b3JQcm9wZXJ0aWVzKHRhcmdldCwgc291cmNlKSB7CiAgICBmb3IgKHZhciBrZXlzID0gb3duS2V5cyhzb3VyY2UpLCBkZWZpbmVQcm9wZXJ0eSA9IG9iamVjdERlZmluZVByb3BlcnR5LmYsIGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IG9iamVjdEdldE93blByb3BlcnR5RGVzY3JpcHRvci5mLCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGtleSA9IGtleXNbaV07CiAgICAgIGhhcyh0YXJnZXQsIGtleSkgfHwgZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgfQogIH0sCiAgICAgIHJlcGxhY2VtZW50ID0gLyN8XC5wcm90b3R5cGVcLi8sCiAgICAgIGlzRm9yY2VkID0gZnVuY3Rpb24gaXNGb3JjZWQoZmVhdHVyZSwgZGV0ZWN0aW9uKSB7CiAgICB2YXIgdmFsdWUgPSBkYXRhW25vcm1hbGl6ZShmZWF0dXJlKV07CiAgICByZXR1cm4gdmFsdWUgPT0gUE9MWUZJTEwgfHwgdmFsdWUgIT0gTkFUSVZFICYmICgiZnVuY3Rpb24iID09IHR5cGVvZiBkZXRlY3Rpb24gPyBmYWlscyhkZXRlY3Rpb24pIDogISFkZXRlY3Rpb24pOwogIH0sCiAgICAgIG5vcm1hbGl6ZSA9IGlzRm9yY2VkLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uIChzdHJpbmcpIHsKICAgIHJldHVybiBTdHJpbmcoc3RyaW5nKS5yZXBsYWNlKHJlcGxhY2VtZW50LCAiLiIpLnRvTG93ZXJDYXNlKCk7CiAgfSwKICAgICAgZGF0YSA9IGlzRm9yY2VkLmRhdGEgPSB7fSwKICAgICAgTkFUSVZFID0gaXNGb3JjZWQuTkFUSVZFID0gIk4iLAogICAgICBQT0xZRklMTCA9IGlzRm9yY2VkLlBPTFlGSUxMID0gIlAiLAogICAgICBpc0ZvcmNlZF8xID0gaXNGb3JjZWQsCiAgICAgIGdldE93blByb3BlcnR5RGVzY3JpcHRvciQxID0gb2JqZWN0R2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLmYsCiAgICAgIF9leHBvcnQgPSBmdW5jdGlvbiBfZXhwb3J0KG9wdGlvbnMsIHNvdXJjZSkgewogICAgdmFyIFRBUkdFVCA9IG9wdGlvbnMudGFyZ2V0LAogICAgICAgIEdMT0JBTCA9IG9wdGlvbnMuZ2xvYmFsLAogICAgICAgIFNUQVRJQyA9IG9wdGlvbnMuc3RhdCwKICAgICAgICBGT1JDRUQsCiAgICAgICAgdGFyZ2V0LAogICAgICAgIGtleSwKICAgICAgICB0YXJnZXRQcm9wZXJ0eSwKICAgICAgICBzb3VyY2VQcm9wZXJ0eSwKICAgICAgICBkZXNjcmlwdG9yOwogICAgaWYgKHRhcmdldCA9IEdMT0JBTCA/IGdsb2JhbF8xIDogU1RBVElDID8gZ2xvYmFsXzFbVEFSR0VUXSB8fCBzZXRHbG9iYWwoVEFSR0VULCB7fSkgOiAoZ2xvYmFsXzFbVEFSR0VUXSB8fCB7fSkucHJvdG90eXBlKSBmb3IgKGtleSBpbiBzb3VyY2UpIHsKICAgICAgaWYgKHNvdXJjZVByb3BlcnR5ID0gc291cmNlW2tleV0sIHRhcmdldFByb3BlcnR5ID0gb3B0aW9ucy5ub1RhcmdldEdldCA/IChkZXNjcmlwdG9yID0gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yJDEodGFyZ2V0LCBrZXkpKSAmJiBkZXNjcmlwdG9yLnZhbHVlIDogdGFyZ2V0W2tleV0sICEoRk9SQ0VEID0gaXNGb3JjZWRfMShHTE9CQUwgPyBrZXkgOiBUQVJHRVQgKyAoU1RBVElDID8gIi4iIDogIiMiKSArIGtleSwgb3B0aW9ucy5mb3JjZWQpKSAmJiB2b2lkIDAgIT09IHRhcmdldFByb3BlcnR5KSB7CiAgICAgICAgaWYgKF90eXBlb2YyKHNvdXJjZVByb3BlcnR5KSA9PSBfdHlwZW9mMih0YXJnZXRQcm9wZXJ0eSkpIGNvbnRpbnVlOwogICAgICAgIGNvcHlDb25zdHJ1Y3RvclByb3BlcnRpZXMoc291cmNlUHJvcGVydHksIHRhcmdldFByb3BlcnR5KTsKICAgICAgfQoKICAgICAgKG9wdGlvbnMuc2hhbSB8fCB0YXJnZXRQcm9wZXJ0eSAmJiB0YXJnZXRQcm9wZXJ0eS5zaGFtKSAmJiBoaWRlKHNvdXJjZVByb3BlcnR5LCAic2hhbSIsICEwKSwgcmVkZWZpbmUodGFyZ2V0LCBrZXksIHNvdXJjZVByb3BlcnR5LCBvcHRpb25zKTsKICAgIH0KICB9LAogICAgICB0b09iamVjdCA9IGZ1bmN0aW9uIHRvT2JqZWN0KGFyZ3VtZW50KSB7CiAgICByZXR1cm4gT2JqZWN0KHJlcXVpcmVPYmplY3RDb2VyY2libGUoYXJndW1lbnQpKTsKICB9LAogICAgICBjb3JyZWN0UHJvdG90eXBlR2V0dGVyID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIEYoKSB7fQoKICAgIHJldHVybiBGLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IG51bGwsIE9iamVjdC5nZXRQcm90b3R5cGVPZihuZXcgRigpKSAhPT0gRi5wcm90b3R5cGU7CiAgfSksCiAgICAgIElFX1BST1RPID0gc2hhcmVkS2V5KCJJRV9QUk9UTyIpLAogICAgICBPYmplY3RQcm90b3R5cGUkMSA9IE9iamVjdC5wcm90b3R5cGUsCiAgICAgIG9iamVjdEdldFByb3RvdHlwZU9mID0gY29ycmVjdFByb3RvdHlwZUdldHRlciA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIChPKSB7CiAgICByZXR1cm4gTyA9IHRvT2JqZWN0KE8pLCBoYXMoTywgSUVfUFJPVE8pID8gT1tJRV9QUk9UT10gOiAiZnVuY3Rpb24iID09IHR5cGVvZiBPLmNvbnN0cnVjdG9yICYmIE8gaW5zdGFuY2VvZiBPLmNvbnN0cnVjdG9yID8gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgOiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG90eXBlJDEgOiBudWxsOwogIH0sCiAgICAgIElURVJBVE9SID0gd2VsbEtub3duU3ltYm9sKCJpdGVyYXRvciIpLAogICAgICBCVUdHWV9TQUZBUklfSVRFUkFUT1JTID0gITEsCiAgICAgIHJldHVyblRoaXMgPSBmdW5jdGlvbiByZXR1cm5UaGlzKCkgewogICAgcmV0dXJuIHRoaXM7CiAgfSwKICAgICAgSXRlcmF0b3JQcm90b3R5cGUsCiAgICAgIFByb3RvdHlwZU9mQXJyYXlJdGVyYXRvclByb3RvdHlwZSwKICAgICAgYXJyYXlJdGVyYXRvcjsKCiAgW10ua2V5cyAmJiAoIm5leHQiIGluIChhcnJheUl0ZXJhdG9yID0gW10ua2V5cygpKSA/IChQcm90b3R5cGVPZkFycmF5SXRlcmF0b3JQcm90b3R5cGUgPSBvYmplY3RHZXRQcm90b3R5cGVPZihvYmplY3RHZXRQcm90b3R5cGVPZihhcnJheUl0ZXJhdG9yKSkpICE9PSBPYmplY3QucHJvdG90eXBlICYmIChJdGVyYXRvclByb3RvdHlwZSA9IFByb3RvdHlwZU9mQXJyYXlJdGVyYXRvclByb3RvdHlwZSkgOiBCVUdHWV9TQUZBUklfSVRFUkFUT1JTID0gITApLCBudWxsID09IEl0ZXJhdG9yUHJvdG90eXBlICYmIChJdGVyYXRvclByb3RvdHlwZSA9IHt9KSwgaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikgfHwgaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwoKICB2YXIgaXRlcmF0b3JzQ29yZSA9IHsKICAgIEl0ZXJhdG9yUHJvdG90eXBlOiBJdGVyYXRvclByb3RvdHlwZSwKICAgIEJVR0dZX1NBRkFSSV9JVEVSQVRPUlM6IEJVR0dZX1NBRkFSSV9JVEVSQVRPUlMKICB9LAogICAgICBvYmplY3RLZXlzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24ga2V5cyhPKSB7CiAgICByZXR1cm4gb2JqZWN0S2V5c0ludGVybmFsKE8sIGVudW1CdWdLZXlzKTsKICB9LAogICAgICBvYmplY3REZWZpbmVQcm9wZXJ0aWVzID0gZGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcykgewogICAgYW5PYmplY3QoTyk7CgogICAgZm9yICh2YXIga2V5cyA9IG9iamVjdEtleXMoUHJvcGVydGllcyksIGxlbmd0aCA9IGtleXMubGVuZ3RoLCBpbmRleCA9IDAsIGtleTsgbGVuZ3RoID4gaW5kZXg7KSB7CiAgICAgIG9iamVjdERlZmluZVByb3BlcnR5LmYoTywga2V5ID0ga2V5c1tpbmRleCsrXSwgUHJvcGVydGllc1trZXldKTsKICAgIH0KCiAgICByZXR1cm4gTzsKICB9LAogICAgICBodG1sID0gZ2V0QnVpbHRJbigiZG9jdW1lbnQiLCAiZG9jdW1lbnRFbGVtZW50IiksCiAgICAgIElFX1BST1RPJDEgPSBzaGFyZWRLZXkoIklFX1BST1RPIiksCiAgICAgIFBST1RPVFlQRSA9ICJwcm90b3R5cGUiLAogICAgICBFbXB0eSA9IGZ1bmN0aW9uIEVtcHR5KCkge30sCiAgICAgIF9jcmVhdGVEaWN0ID0gZnVuY3Rpb24gY3JlYXRlRGljdCgpIHsKICAgIHZhciBpZnJhbWUgPSBkb2N1bWVudENyZWF0ZUVsZW1lbnQoImlmcmFtZSIpLAogICAgICAgIGxlbmd0aCA9IGVudW1CdWdLZXlzLmxlbmd0aCwKICAgICAgICBsdCA9ICI8IiwKICAgICAgICBzY3JpcHQgPSAic2NyaXB0IiwKICAgICAgICBndCA9ICI+IiwKICAgICAgICBqcyA9ICJqYXZhc2NyaXB0OiIsCiAgICAgICAgaWZyYW1lRG9jdW1lbnQ7CgogICAgZm9yIChpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICJub25lIiwgaHRtbC5hcHBlbmRDaGlsZChpZnJhbWUpLCBpZnJhbWUuc3JjID0gU3RyaW5nKGpzKSwgKGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQpLm9wZW4oKSwgaWZyYW1lRG9jdW1lbnQud3JpdGUoIjxzY3JpcHQ+ZG9jdW1lbnQuRj1PYmplY3Q8XC9zY3JpcHQ+IiksIGlmcmFtZURvY3VtZW50LmNsb3NlKCksIF9jcmVhdGVEaWN0ID0gaWZyYW1lRG9jdW1lbnQuRjsgbGVuZ3RoLS07KSB7CiAgICAgIGRlbGV0ZSBfY3JlYXRlRGljdC5wcm90b3R5cGVbZW51bUJ1Z0tleXNbbGVuZ3RoXV07CiAgICB9CgogICAgcmV0dXJuIF9jcmVhdGVEaWN0KCk7CiAgfSwKICAgICAgb2JqZWN0Q3JlYXRlID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcykgewogICAgdmFyIHJlc3VsdDsKICAgIHJldHVybiBudWxsICE9PSBPID8gKEVtcHR5LnByb3RvdHlwZSA9IGFuT2JqZWN0KE8pLCByZXN1bHQgPSBuZXcgRW1wdHkoKSwgRW1wdHkucHJvdG90eXBlID0gbnVsbCwgcmVzdWx0W0lFX1BST1RPJDFdID0gTykgOiByZXN1bHQgPSBfY3JlYXRlRGljdCgpLCB2b2lkIDAgPT09IFByb3BlcnRpZXMgPyByZXN1bHQgOiBvYmplY3REZWZpbmVQcm9wZXJ0aWVzKHJlc3VsdCwgUHJvcGVydGllcyk7CiAgfTsKCiAgaGlkZGVuS2V5c1tJRV9QUk9UTyQxXSA9ICEwOwoKICB2YXIgZGVmaW5lUHJvcGVydHkgPSBvYmplY3REZWZpbmVQcm9wZXJ0eS5mLAogICAgICBUT19TVFJJTkdfVEFHJDIgPSB3ZWxsS25vd25TeW1ib2woInRvU3RyaW5nVGFnIiksCiAgICAgIHNldFRvU3RyaW5nVGFnID0gZnVuY3Rpb24gc2V0VG9TdHJpbmdUYWcoaXQsIFRBRywgU1RBVElDKSB7CiAgICBpdCAmJiAhaGFzKGl0ID0gU1RBVElDID8gaXQgOiBpdC5wcm90b3R5cGUsIFRPX1NUUklOR19UQUckMikgJiYgZGVmaW5lUHJvcGVydHkoaXQsIFRPX1NUUklOR19UQUckMiwgewogICAgICBjb25maWd1cmFibGU6ICEwLAogICAgICB2YWx1ZTogVEFHCiAgICB9KTsKICB9LAogICAgICBpdGVyYXRvcnMgPSB7fSwKICAgICAgSXRlcmF0b3JQcm90b3R5cGUkMSA9IGl0ZXJhdG9yc0NvcmUuSXRlcmF0b3JQcm90b3R5cGUsCiAgICAgIHJldHVyblRoaXMkMSA9IGZ1bmN0aW9uIHJldHVyblRoaXMkMSgpIHsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgICAgIGNyZWF0ZUl0ZXJhdG9yQ29uc3RydWN0b3IgPSBmdW5jdGlvbiBjcmVhdGVJdGVyYXRvckNvbnN0cnVjdG9yKEl0ZXJhdG9yQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpIHsKICAgIHZhciBUT19TVFJJTkdfVEFHID0gTkFNRSArICIgSXRlcmF0b3IiOwogICAgcmV0dXJuIEl0ZXJhdG9yQ29uc3RydWN0b3IucHJvdG90eXBlID0gb2JqZWN0Q3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlJDEsIHsKICAgICAgbmV4dDogY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKDEsIG5leHQpCiAgICB9KSwgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JDb25zdHJ1Y3RvciwgVE9fU1RSSU5HX1RBRywgITEpLCBpdGVyYXRvcnNbVE9fU1RSSU5HX1RBR10gPSByZXR1cm5UaGlzJDEsIEl0ZXJhdG9yQ29uc3RydWN0b3I7CiAgfSwKICAgICAgYVBvc3NpYmxlUHJvdG90eXBlID0gZnVuY3Rpb24gYVBvc3NpYmxlUHJvdG90eXBlKGl0KSB7CiAgICBpZiAoIWlzT2JqZWN0JDEoaXQpICYmIG51bGwgIT09IGl0KSB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IHNldCAiICsgU3RyaW5nKGl0KSArICIgYXMgYSBwcm90b3R5cGUiKTsKICAgIHJldHVybiBpdDsKICB9LAogICAgICBvYmplY3RTZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoIl9fcHJvdG9fXyIgaW4ge30gPyBmdW5jdGlvbiAoKSB7CiAgICB2YXIgQ09SUkVDVF9TRVRURVIgPSAhMSwKICAgICAgICB0ZXN0ID0ge30sCiAgICAgICAgc2V0dGVyOwoKICAgIHRyeSB7CiAgICAgIChzZXR0ZXIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE9iamVjdC5wcm90b3R5cGUsICJfX3Byb3RvX18iKS5zZXQpLmNhbGwodGVzdCwgW10pLCBDT1JSRUNUX1NFVFRFUiA9IHRlc3QgaW5zdGFuY2VvZiBBcnJheTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7fQoKICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90bykgewogICAgICByZXR1cm4gYW5PYmplY3QoTyksIGFQb3NzaWJsZVByb3RvdHlwZShwcm90byksIENPUlJFQ1RfU0VUVEVSID8gc2V0dGVyLmNhbGwoTywgcHJvdG8pIDogTy5fX3Byb3RvX18gPSBwcm90bywgTzsKICAgIH07CiAgfSgpIDogdm9pZCAwKSwKICAgICAgSXRlcmF0b3JQcm90b3R5cGUkMiA9IGl0ZXJhdG9yc0NvcmUuSXRlcmF0b3JQcm90b3R5cGUsCiAgICAgIEJVR0dZX1NBRkFSSV9JVEVSQVRPUlMkMSA9IGl0ZXJhdG9yc0NvcmUuQlVHR1lfU0FGQVJJX0lURVJBVE9SUywKICAgICAgSVRFUkFUT1IkMSA9IHdlbGxLbm93blN5bWJvbCgiaXRlcmF0b3IiKSwKICAgICAgS0VZUyA9ICJrZXlzIiwKICAgICAgVkFMVUVTID0gInZhbHVlcyIsCiAgICAgIEVOVFJJRVMgPSAiZW50cmllcyIsCiAgICAgIHJldHVyblRoaXMkMiA9IGZ1bmN0aW9uIHJldHVyblRoaXMkMigpIHsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgICAgIGRlZmluZUl0ZXJhdG9yID0gZnVuY3Rpb24gZGVmaW5lSXRlcmF0b3IoSXRlcmFibGUsIE5BTUUsIEl0ZXJhdG9yQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKSB7CiAgICBjcmVhdGVJdGVyYXRvckNvbnN0cnVjdG9yKEl0ZXJhdG9yQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpOwoKICAgIHZhciBnZXRJdGVyYXRpb25NZXRob2QgPSBmdW5jdGlvbiBnZXRJdGVyYXRpb25NZXRob2QoS0lORCkgewogICAgICBpZiAoS0lORCA9PT0gREVGQVVMVCAmJiBkZWZhdWx0SXRlcmF0b3IpIHJldHVybiBkZWZhdWx0SXRlcmF0b3I7CiAgICAgIGlmICghQlVHR1lfU0FGQVJJX0lURVJBVE9SUyQxICYmIEtJTkQgaW4gSXRlcmFibGVQcm90b3R5cGUpIHJldHVybiBJdGVyYWJsZVByb3RvdHlwZVtLSU5EXTsKCiAgICAgIHN3aXRjaCAoS0lORCkgewogICAgICAgIGNhc2UgS0VZUzoKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBrZXlzKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEl0ZXJhdG9yQ29uc3RydWN0b3IodGhpcywgS0lORCk7CiAgICAgICAgICB9OwoKICAgICAgICBjYXNlIFZBTFVFUzoKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiB2YWx1ZXMoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzLCBLSU5EKTsKICAgICAgICAgIH07CgogICAgICAgIGNhc2UgRU5UUklFUzoKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEl0ZXJhdG9yQ29uc3RydWN0b3IodGhpcywgS0lORCk7CiAgICAgICAgICB9OwogICAgICB9CgogICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzKTsKICAgICAgfTsKICAgIH0sCiAgICAgICAgVE9fU1RSSU5HX1RBRyA9IE5BTUUgKyAiIEl0ZXJhdG9yIiwKICAgICAgICBJTkNPUlJFQ1RfVkFMVUVTX05BTUUgPSAhMSwKICAgICAgICBJdGVyYWJsZVByb3RvdHlwZSA9IEl0ZXJhYmxlLnByb3RvdHlwZSwKICAgICAgICBuYXRpdmVJdGVyYXRvciA9IEl0ZXJhYmxlUHJvdG90eXBlW0lURVJBVE9SJDFdIHx8IEl0ZXJhYmxlUHJvdG90eXBlWyJAQGl0ZXJhdG9yIl0gfHwgREVGQVVMVCAmJiBJdGVyYWJsZVByb3RvdHlwZVtERUZBVUxUXSwKICAgICAgICBkZWZhdWx0SXRlcmF0b3IgPSAhQlVHR1lfU0FGQVJJX0lURVJBVE9SUyQxICYmIG5hdGl2ZUl0ZXJhdG9yIHx8IGdldEl0ZXJhdGlvbk1ldGhvZChERUZBVUxUKSwKICAgICAgICBhbnlOYXRpdmVJdGVyYXRvciA9ICJBcnJheSIgPT0gTkFNRSAmJiBJdGVyYWJsZVByb3RvdHlwZS5lbnRyaWVzIHx8IG5hdGl2ZUl0ZXJhdG9yLAogICAgICAgIEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwKICAgICAgICBtZXRob2RzLAogICAgICAgIEtFWTsKCiAgICBpZiAoYW55TmF0aXZlSXRlcmF0b3IgJiYgKEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSA9IG9iamVjdEdldFByb3RvdHlwZU9mKGFueU5hdGl2ZUl0ZXJhdG9yLmNhbGwobmV3IEl0ZXJhYmxlKCkpKSwgSXRlcmF0b3JQcm90b3R5cGUkMiAhPT0gT2JqZWN0LnByb3RvdHlwZSAmJiBDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUubmV4dCAmJiAob2JqZWN0R2V0UHJvdG90eXBlT2YoQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlKSAhPT0gSXRlcmF0b3JQcm90b3R5cGUkMiAmJiAob2JqZWN0U2V0UHJvdG90eXBlT2YgPyBvYmplY3RTZXRQcm90b3R5cGVPZihDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUsIEl0ZXJhdG9yUHJvdG90eXBlJDIpIDogImZ1bmN0aW9uIiAhPSB0eXBlb2YgQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SJDFdICYmIGhpZGUoQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUiQxLCByZXR1cm5UaGlzJDIpKSwgc2V0VG9TdHJpbmdUYWcoQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlLCBUT19TVFJJTkdfVEFHLCAhMCkpKSwgREVGQVVMVCA9PSBWQUxVRVMgJiYgbmF0aXZlSXRlcmF0b3IgJiYgbmF0aXZlSXRlcmF0b3IubmFtZSAhPT0gVkFMVUVTICYmIChJTkNPUlJFQ1RfVkFMVUVTX05BTUUgPSAhMCwgZGVmYXVsdEl0ZXJhdG9yID0gZnVuY3Rpb24gdmFsdWVzKCkgewogICAgICByZXR1cm4gbmF0aXZlSXRlcmF0b3IuY2FsbCh0aGlzKTsKICAgIH0pLCBJdGVyYWJsZVByb3RvdHlwZVtJVEVSQVRPUiQxXSAhPT0gZGVmYXVsdEl0ZXJhdG9yICYmIGhpZGUoSXRlcmFibGVQcm90b3R5cGUsIElURVJBVE9SJDEsIGRlZmF1bHRJdGVyYXRvciksIGl0ZXJhdG9yc1tOQU1FXSA9IGRlZmF1bHRJdGVyYXRvciwgREVGQVVMVCkgaWYgKG1ldGhvZHMgPSB7CiAgICAgIHZhbHVlczogZ2V0SXRlcmF0aW9uTWV0aG9kKFZBTFVFUyksCiAgICAgIGtleXM6IElTX1NFVCA/IGRlZmF1bHRJdGVyYXRvciA6IGdldEl0ZXJhdGlvbk1ldGhvZChLRVlTKSwKICAgICAgZW50cmllczogZ2V0SXRlcmF0aW9uTWV0aG9kKEVOVFJJRVMpCiAgICB9LCBGT1JDRUQpIGZvciAoS0VZIGluIG1ldGhvZHMpIHsKICAgICAgIUJVR0dZX1NBRkFSSV9JVEVSQVRPUlMkMSAmJiAhSU5DT1JSRUNUX1ZBTFVFU19OQU1FICYmIEtFWSBpbiBJdGVyYWJsZVByb3RvdHlwZSB8fCByZWRlZmluZShJdGVyYWJsZVByb3RvdHlwZSwgS0VZLCBtZXRob2RzW0tFWV0pOwogICAgfSBlbHNlIF9leHBvcnQoewogICAgICB0YXJnZXQ6IE5BTUUsCiAgICAgIHByb3RvOiAhMCwKICAgICAgZm9yY2VkOiBCVUdHWV9TQUZBUklfSVRFUkFUT1JTJDEgfHwgSU5DT1JSRUNUX1ZBTFVFU19OQU1FCiAgICB9LCBtZXRob2RzKTsKICAgIHJldHVybiBtZXRob2RzOwogIH0sCiAgICAgIGNoYXJBdCA9IHN0cmluZ011bHRpYnl0ZS5jaGFyQXQsCiAgICAgIFNUUklOR19JVEVSQVRPUiA9ICJTdHJpbmcgSXRlcmF0b3IiLAogICAgICBzZXRJbnRlcm5hbFN0YXRlID0gaW50ZXJuYWxTdGF0ZS5zZXQsCiAgICAgIGdldEludGVybmFsU3RhdGUgPSBpbnRlcm5hbFN0YXRlLmdldHRlckZvcihTVFJJTkdfSVRFUkFUT1IpOwoKICBkZWZpbmVJdGVyYXRvcihTdHJpbmcsICJTdHJpbmciLCBmdW5jdGlvbiAoaXRlcmF0ZWQpIHsKICAgIHNldEludGVybmFsU3RhdGUodGhpcywgewogICAgICB0eXBlOiBTVFJJTkdfSVRFUkFUT1IsCiAgICAgIHN0cmluZzogU3RyaW5nKGl0ZXJhdGVkKSwKICAgICAgaW5kZXg6IDAKICAgIH0pOwogIH0sIGZ1bmN0aW9uIG5leHQoKSB7CiAgICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpLAogICAgICAgIHN0cmluZyA9IHN0YXRlLnN0cmluZywKICAgICAgICBpbmRleCA9IHN0YXRlLmluZGV4LAogICAgICAgIHBvaW50OwogICAgcmV0dXJuIGluZGV4ID49IHN0cmluZy5sZW5ndGggPyB7CiAgICAgIHZhbHVlOiB2b2lkIDAsCiAgICAgIGRvbmU6ICEwCiAgICB9IDogKHBvaW50ID0gY2hhckF0KHN0cmluZywgaW5kZXgpLCBzdGF0ZS5pbmRleCArPSBwb2ludC5sZW5ndGgsIHsKICAgICAgdmFsdWU6IHBvaW50LAogICAgICBkb25lOiAhMQogICAgfSk7CiAgfSk7CiAgdmFyIGRvbUl0ZXJhYmxlcyA9IHsKICAgIENTU1J1bGVMaXN0OiAwLAogICAgQ1NTU3R5bGVEZWNsYXJhdGlvbjogMCwKICAgIENTU1ZhbHVlTGlzdDogMCwKICAgIENsaWVudFJlY3RMaXN0OiAwLAogICAgRE9NUmVjdExpc3Q6IDAsCiAgICBET01TdHJpbmdMaXN0OiAwLAogICAgRE9NVG9rZW5MaXN0OiAxLAogICAgRGF0YVRyYW5zZmVySXRlbUxpc3Q6IDAsCiAgICBGaWxlTGlzdDogMCwKICAgIEhUTUxBbGxDb2xsZWN0aW9uOiAwLAogICAgSFRNTENvbGxlY3Rpb246IDAsCiAgICBIVE1MRm9ybUVsZW1lbnQ6IDAsCiAgICBIVE1MU2VsZWN0RWxlbWVudDogMCwKICAgIE1lZGlhTGlzdDogMCwKICAgIE1pbWVUeXBlQXJyYXk6IDAsCiAgICBOYW1lZE5vZGVNYXA6IDAsCiAgICBOb2RlTGlzdDogMSwKICAgIFBhaW50UmVxdWVzdExpc3Q6IDAsCiAgICBQbHVnaW46IDAsCiAgICBQbHVnaW5BcnJheTogMCwKICAgIFNWR0xlbmd0aExpc3Q6IDAsCiAgICBTVkdOdW1iZXJMaXN0OiAwLAogICAgU1ZHUGF0aFNlZ0xpc3Q6IDAsCiAgICBTVkdQb2ludExpc3Q6IDAsCiAgICBTVkdTdHJpbmdMaXN0OiAwLAogICAgU1ZHVHJhbnNmb3JtTGlzdDogMCwKICAgIFNvdXJjZUJ1ZmZlckxpc3Q6IDAsCiAgICBTdHlsZVNoZWV0TGlzdDogMCwKICAgIFRleHRUcmFja0N1ZUxpc3Q6IDAsCiAgICBUZXh0VHJhY2tMaXN0OiAwLAogICAgVG91Y2hMaXN0OiAwCiAgfSwKICAgICAgVU5TQ09QQUJMRVMgPSB3ZWxsS25vd25TeW1ib2woInVuc2NvcGFibGVzIiksCiAgICAgIEFycmF5UHJvdG90eXBlID0gQXJyYXkucHJvdG90eXBlOwogIG51bGwgPT0gQXJyYXlQcm90b3R5cGVbVU5TQ09QQUJMRVNdICYmIGhpZGUoQXJyYXlQcm90b3R5cGUsIFVOU0NPUEFCTEVTLCBvYmplY3RDcmVhdGUobnVsbCkpOwoKICB2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IGZ1bmN0aW9uIGFkZFRvVW5zY29wYWJsZXMoa2V5KSB7CiAgICBBcnJheVByb3RvdHlwZVtVTlNDT1BBQkxFU11ba2V5XSA9ICEwOwogIH0sCiAgICAgIEFSUkFZX0lURVJBVE9SID0gIkFycmF5IEl0ZXJhdG9yIiwKICAgICAgc2V0SW50ZXJuYWxTdGF0ZSQxID0gaW50ZXJuYWxTdGF0ZS5zZXQsCiAgICAgIGdldEludGVybmFsU3RhdGUkMSA9IGludGVybmFsU3RhdGUuZ2V0dGVyRm9yKEFSUkFZX0lURVJBVE9SKSwKICAgICAgZXNfYXJyYXlfaXRlcmF0b3IgPSBkZWZpbmVJdGVyYXRvcihBcnJheSwgIkFycmF5IiwgZnVuY3Rpb24gKGl0ZXJhdGVkLCBraW5kKSB7CiAgICBzZXRJbnRlcm5hbFN0YXRlJDEodGhpcywgewogICAgICB0eXBlOiBBUlJBWV9JVEVSQVRPUiwKICAgICAgdGFyZ2V0OiB0b0luZGV4ZWRPYmplY3QoaXRlcmF0ZWQpLAogICAgICBpbmRleDogMCwKICAgICAga2luZDoga2luZAogICAgfSk7CiAgfSwgZnVuY3Rpb24gKCkgewogICAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZSQxKHRoaXMpLAogICAgICAgIHRhcmdldCA9IHN0YXRlLnRhcmdldCwKICAgICAgICBraW5kID0gc3RhdGUua2luZCwKICAgICAgICBpbmRleCA9IHN0YXRlLmluZGV4Kys7CiAgICByZXR1cm4gIXRhcmdldCB8fCBpbmRleCA+PSB0YXJnZXQubGVuZ3RoID8gKHN0YXRlLnRhcmdldCA9IHZvaWQgMCwgewogICAgICB2YWx1ZTogdm9pZCAwLAogICAgICBkb25lOiAhMAogICAgfSkgOiAia2V5cyIgPT0ga2luZCA/IHsKICAgICAgdmFsdWU6IGluZGV4LAogICAgICBkb25lOiAhMQogICAgfSA6ICJ2YWx1ZXMiID09IGtpbmQgPyB7CiAgICAgIHZhbHVlOiB0YXJnZXRbaW5kZXhdLAogICAgICBkb25lOiAhMQogICAgfSA6IHsKICAgICAgdmFsdWU6IFtpbmRleCwgdGFyZ2V0W2luZGV4XV0sCiAgICAgIGRvbmU6ICExCiAgICB9OwogIH0sICJ2YWx1ZXMiKTsKCiAgaXRlcmF0b3JzLkFyZ3VtZW50cyA9IGl0ZXJhdG9ycy5BcnJheSwgYWRkVG9VbnNjb3BhYmxlcygia2V5cyIpLCBhZGRUb1Vuc2NvcGFibGVzKCJ2YWx1ZXMiKSwgYWRkVG9VbnNjb3BhYmxlcygiZW50cmllcyIpOwogIHZhciBJVEVSQVRPUiQyID0gd2VsbEtub3duU3ltYm9sKCJpdGVyYXRvciIpLAogICAgICBUT19TVFJJTkdfVEFHJDMgPSB3ZWxsS25vd25TeW1ib2woInRvU3RyaW5nVGFnIiksCiAgICAgIEFycmF5VmFsdWVzID0gZXNfYXJyYXlfaXRlcmF0b3IudmFsdWVzOwoKICBmb3IgKHZhciBDT0xMRUNUSU9OX05BTUUgaW4gZG9tSXRlcmFibGVzKSB7CiAgICB2YXIgQ29sbGVjdGlvbiQxID0gZ2xvYmFsXzFbQ09MTEVDVElPTl9OQU1FXSwKICAgICAgICBDb2xsZWN0aW9uUHJvdG90eXBlID0gQ29sbGVjdGlvbiQxICYmIENvbGxlY3Rpb24kMS5wcm90b3R5cGU7CgogICAgaWYgKENvbGxlY3Rpb25Qcm90b3R5cGUpIHsKICAgICAgaWYgKENvbGxlY3Rpb25Qcm90b3R5cGVbSVRFUkFUT1IkMl0gIT09IEFycmF5VmFsdWVzKSB0cnkgewogICAgICAgIGhpZGUoQ29sbGVjdGlvblByb3RvdHlwZSwgSVRFUkFUT1IkMiwgQXJyYXlWYWx1ZXMpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIENvbGxlY3Rpb25Qcm90b3R5cGVbSVRFUkFUT1IkMl0gPSBBcnJheVZhbHVlczsKICAgICAgfQogICAgICBpZiAoQ29sbGVjdGlvblByb3RvdHlwZVtUT19TVFJJTkdfVEFHJDNdIHx8IGhpZGUoQ29sbGVjdGlvblByb3RvdHlwZSwgVE9fU1RSSU5HX1RBRyQzLCBDT0xMRUNUSU9OX05BTUUpLCBkb21JdGVyYWJsZXNbQ09MTEVDVElPTl9OQU1FXSkgZm9yICh2YXIgTUVUSE9EX05BTUUgaW4gZXNfYXJyYXlfaXRlcmF0b3IpIHsKICAgICAgICBpZiAoQ29sbGVjdGlvblByb3RvdHlwZVtNRVRIT0RfTkFNRV0gIT09IGVzX2FycmF5X2l0ZXJhdG9yW01FVEhPRF9OQU1FXSkgdHJ5IHsKICAgICAgICAgIGhpZGUoQ29sbGVjdGlvblByb3RvdHlwZSwgTUVUSE9EX05BTUUsIGVzX2FycmF5X2l0ZXJhdG9yW01FVEhPRF9OQU1FXSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIENvbGxlY3Rpb25Qcm90b3R5cGVbTUVUSE9EX05BTUVdID0gZXNfYXJyYXlfaXRlcmF0b3JbTUVUSE9EX05BTUVdOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgdmFyIHJlZGVmaW5lQWxsID0gZnVuY3Rpb24gcmVkZWZpbmVBbGwodGFyZ2V0LCBzcmMsIG9wdGlvbnMpIHsKICAgIGZvciAodmFyIGtleSBpbiBzcmMpIHsKICAgICAgcmVkZWZpbmUodGFyZ2V0LCBrZXksIHNyY1trZXldLCBvcHRpb25zKTsKICAgIH0KCiAgICByZXR1cm4gdGFyZ2V0OwogIH0sCiAgICAgIFNQRUNJRVMgPSB3ZWxsS25vd25TeW1ib2woInNwZWNpZXMiKSwKICAgICAgc2V0U3BlY2llcyA9IGZ1bmN0aW9uIHNldFNwZWNpZXMoQ09OU1RSVUNUT1JfTkFNRSkgewogICAgdmFyIENvbnN0cnVjdG9yID0gZ2V0QnVpbHRJbihDT05TVFJVQ1RPUl9OQU1FKSwKICAgICAgICBkZWZpbmVQcm9wZXJ0eSA9IG9iamVjdERlZmluZVByb3BlcnR5LmY7CiAgICBkZXNjcmlwdG9ycyAmJiBDb25zdHJ1Y3RvciAmJiAhQ29uc3RydWN0b3JbU1BFQ0lFU10gJiYgZGVmaW5lUHJvcGVydHkoQ29uc3RydWN0b3IsIFNQRUNJRVMsIHsKICAgICAgY29uZmlndXJhYmxlOiAhMCwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgICAgIGFGdW5jdGlvbiQxID0gZnVuY3Rpb24gYUZ1bmN0aW9uJDEoaXQpIHsKICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiBpdCkgdGhyb3cgVHlwZUVycm9yKFN0cmluZyhpdCkgKyAiIGlzIG5vdCBhIGZ1bmN0aW9uIik7CiAgICByZXR1cm4gaXQ7CiAgfSwKICAgICAgYW5JbnN0YW5jZSA9IGZ1bmN0aW9uIGFuSW5zdGFuY2UoaXQsIENvbnN0cnVjdG9yLCBuYW1lKSB7CiAgICBpZiAoIShpdCBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgdGhyb3cgVHlwZUVycm9yKCJJbmNvcnJlY3QgIiArIChuYW1lID8gbmFtZSArICIgIiA6ICIiKSArICJpbnZvY2F0aW9uIik7CiAgICByZXR1cm4gaXQ7CiAgfSwKICAgICAgSVRFUkFUT1IkMyA9IHdlbGxLbm93blN5bWJvbCgiaXRlcmF0b3IiKSwKICAgICAgQXJyYXlQcm90b3R5cGUkMSA9IEFycmF5LnByb3RvdHlwZSwKICAgICAgaXNBcnJheUl0ZXJhdG9yTWV0aG9kID0gZnVuY3Rpb24gaXNBcnJheUl0ZXJhdG9yTWV0aG9kKGl0KSB7CiAgICByZXR1cm4gdm9pZCAwICE9PSBpdCAmJiAoaXRlcmF0b3JzLkFycmF5ID09PSBpdCB8fCBBcnJheVByb3RvdHlwZSQxW0lURVJBVE9SJDNdID09PSBpdCk7CiAgfSwKICAgICAgYmluZENvbnRleHQgPSBmdW5jdGlvbiBiaW5kQ29udGV4dChmbiwgdGhhdCwgbGVuZ3RoKSB7CiAgICBpZiAoYUZ1bmN0aW9uJDEoZm4pLCB2b2lkIDAgPT09IHRoYXQpIHJldHVybiBmbjsKCiAgICBzd2l0Y2ggKGxlbmd0aCkgewogICAgICBjYXNlIDA6CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQpOwogICAgICAgIH07CgogICAgICBjYXNlIDE6CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTsKICAgICAgICB9OwoKICAgICAgY2FzZSAyOgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7CiAgICAgICAgfTsKCiAgICAgIGNhc2UgMzoKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGIsIGMpIHsKICAgICAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpOwogICAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0sCiAgICAgIElURVJBVE9SJDQgPSB3ZWxsS25vd25TeW1ib2woIml0ZXJhdG9yIiksCiAgICAgIGdldEl0ZXJhdG9yTWV0aG9kID0gZnVuY3Rpb24gZ2V0SXRlcmF0b3JNZXRob2QoaXQpIHsKICAgIGlmIChudWxsICE9IGl0KSByZXR1cm4gaXRbSVRFUkFUT1IkNF0gfHwgaXRbIkBAaXRlcmF0b3IiXSB8fCBpdGVyYXRvcnNbY2xhc3NvZihpdCldOwogIH0sCiAgICAgIGNhbGxXaXRoU2FmZUl0ZXJhdGlvbkNsb3NpbmcgPSBmdW5jdGlvbiBjYWxsV2l0aFNhZmVJdGVyYXRpb25DbG9zaW5nKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIEVOVFJJRVMpIHsKICAgIHRyeSB7CiAgICAgIHJldHVybiBFTlRSSUVTID8gZm4oYW5PYmplY3QodmFsdWUpWzBdLCB2YWx1ZVsxXSkgOiBmbih2YWx1ZSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICB2YXIgcmV0dXJuTWV0aG9kID0gaXRlcmF0b3IucmV0dXJuOwogICAgICB0aHJvdyB2b2lkIDAgIT09IHJldHVybk1ldGhvZCAmJiBhbk9iamVjdChyZXR1cm5NZXRob2QuY2FsbChpdGVyYXRvcikpLCBlcnJvcjsKICAgIH0KICB9LAogICAgICBpdGVyYXRlXzEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7CiAgICB2YXIgUmVzdWx0ID0gZnVuY3Rpb24gUmVzdWx0KHN0b3BwZWQsIHJlc3VsdCkgewogICAgICB0aGlzLnN0b3BwZWQgPSBzdG9wcGVkLCB0aGlzLnJlc3VsdCA9IHJlc3VsdDsKICAgIH0sCiAgICAgICAgaXRlcmF0ZTsKCiAgICAobW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXRlcmFibGUsIGZuLCB0aGF0LCBBU19FTlRSSUVTLCBJU19JVEVSQVRPUikgewogICAgICB2YXIgYm91bmRGdW5jdGlvbiA9IGJpbmRDb250ZXh0KGZuLCB0aGF0LCBBU19FTlRSSUVTID8gMiA6IDEpLAogICAgICAgICAgaXRlcmF0b3IsCiAgICAgICAgICBpdGVyRm4sCiAgICAgICAgICBpbmRleCwKICAgICAgICAgIGxlbmd0aCwKICAgICAgICAgIHJlc3VsdCwKICAgICAgICAgIHN0ZXA7CiAgICAgIGlmIChJU19JVEVSQVRPUikgaXRlcmF0b3IgPSBpdGVyYWJsZTtlbHNlIHsKICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgKGl0ZXJGbiA9IGdldEl0ZXJhdG9yTWV0aG9kKGl0ZXJhYmxlKSkpIHRocm93IFR5cGVFcnJvcigiVGFyZ2V0IGlzIG5vdCBpdGVyYWJsZSIpOwoKICAgICAgICBpZiAoaXNBcnJheUl0ZXJhdG9yTWV0aG9kKGl0ZXJGbikpIHsKICAgICAgICAgIGZvciAoaW5kZXggPSAwLCBsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKykgewogICAgICAgICAgICBpZiAoKHJlc3VsdCA9IEFTX0VOVFJJRVMgPyBib3VuZEZ1bmN0aW9uKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGJvdW5kRnVuY3Rpb24oaXRlcmFibGVbaW5kZXhdKSkgJiYgcmVzdWx0IGluc3RhbmNlb2YgUmVzdWx0KSByZXR1cm4gcmVzdWx0OwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuZXcgUmVzdWx0KCExKTsKICAgICAgICB9CgogICAgICAgIGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOwogICAgICB9CgogICAgICBmb3IgKDsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOykgewogICAgICAgIGlmICgocmVzdWx0ID0gY2FsbFdpdGhTYWZlSXRlcmF0aW9uQ2xvc2luZyhpdGVyYXRvciwgYm91bmRGdW5jdGlvbiwgc3RlcC52YWx1ZSwgQVNfRU5UUklFUykpICYmIHJlc3VsdCBpbnN0YW5jZW9mIFJlc3VsdCkgcmV0dXJuIHJlc3VsdDsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBSZXN1bHQoITEpOwogICAgfSkuc3RvcCA9IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgcmV0dXJuIG5ldyBSZXN1bHQoITAsIHJlc3VsdCk7CiAgICB9OwogIH0pLAogICAgICBJVEVSQVRPUiQ1ID0gd2VsbEtub3duU3ltYm9sKCJpdGVyYXRvciIpLAogICAgICBTQUZFX0NMT1NJTkcgPSAhMTsKCiAgdHJ5IHsKICAgIHZhciBjYWxsZWQgPSAwLAogICAgICAgIGl0ZXJhdG9yV2l0aFJldHVybiA9IHsKICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgZG9uZTogISFjYWxsZWQrKwogICAgICAgIH07CiAgICAgIH0sCiAgICAgIHJldHVybjogZnVuY3Rpb24gX3JldHVybigpIHsKICAgICAgICBTQUZFX0NMT1NJTkcgPSAhMDsKICAgICAgfQogICAgfTsKICAgIGl0ZXJhdG9yV2l0aFJldHVybltJVEVSQVRPUiQ1XSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LCBBcnJheS5mcm9tKGl0ZXJhdG9yV2l0aFJldHVybiwgZnVuY3Rpb24gKCkgewogICAgICB0aHJvdyAyOwogICAgfSk7CiAgfSBjYXRjaCAoZXJyb3IpIHt9CgogIHZhciBjaGVja0NvcnJlY3RuZXNzT2ZJdGVyYXRpb24gPSBmdW5jdGlvbiBjaGVja0NvcnJlY3RuZXNzT2ZJdGVyYXRpb24oZXhlYywgU0tJUF9DTE9TSU5HKSB7CiAgICBpZiAoIVNLSVBfQ0xPU0lORyAmJiAhU0FGRV9DTE9TSU5HKSByZXR1cm4gITE7CiAgICB2YXIgSVRFUkFUSU9OX1NVUFBPUlQgPSAhMTsKCiAgICB0cnkgewogICAgICB2YXIgb2JqZWN0ID0ge307CiAgICAgIG9iamVjdFtJVEVSQVRPUiQ1XSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBkb25lOiBJVEVSQVRJT05fU1VQUE9SVCA9ICEwCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSwgZXhlYyhvYmplY3QpOwogICAgfSBjYXRjaCAoZXJyb3IpIHt9CgogICAgcmV0dXJuIElURVJBVElPTl9TVVBQT1JUOwogIH0sCiAgICAgIFNQRUNJRVMkMSA9IHdlbGxLbm93blN5bWJvbCgic3BlY2llcyIpLAogICAgICBzcGVjaWVzQ29uc3RydWN0b3IgPSBmdW5jdGlvbiBzcGVjaWVzQ29uc3RydWN0b3IoTywgZGVmYXVsdENvbnN0cnVjdG9yKSB7CiAgICB2YXIgQyA9IGFuT2JqZWN0KE8pLmNvbnN0cnVjdG9yLAogICAgICAgIFM7CiAgICByZXR1cm4gdm9pZCAwID09PSBDIHx8IG51bGwgPT0gKFMgPSBhbk9iamVjdChDKVtTUEVDSUVTJDFdKSA/IGRlZmF1bHRDb25zdHJ1Y3RvciA6IGFGdW5jdGlvbiQxKFMpOwogIH0sCiAgICAgIGxvY2F0aW9uJDEgPSBnbG9iYWxfMS5sb2NhdGlvbiwKICAgICAgc2V0JDEgPSBnbG9iYWxfMS5zZXRJbW1lZGlhdGUsCiAgICAgIGNsZWFyID0gZ2xvYmFsXzEuY2xlYXJJbW1lZGlhdGUsCiAgICAgIHByb2Nlc3MgPSBnbG9iYWxfMS5wcm9jZXNzLAogICAgICBNZXNzYWdlQ2hhbm5lbCA9IGdsb2JhbF8xLk1lc3NhZ2VDaGFubmVsLAogICAgICBEaXNwYXRjaCA9IGdsb2JhbF8xLkRpc3BhdGNoLAogICAgICBjb3VudGVyID0gMCwKICAgICAgcXVldWUgPSB7fSwKICAgICAgT05SRUFEWVNUQVRFQ0hBTkdFID0gIm9ucmVhZHlzdGF0ZWNoYW5nZSIsCiAgICAgIGRlZmVyLAogICAgICBjaGFubmVsLAogICAgICBwb3J0LAogICAgICBydW4gPSBmdW5jdGlvbiBydW4oaWQpIHsKICAgIGlmIChxdWV1ZS5oYXNPd25Qcm9wZXJ0eShpZCkpIHsKICAgICAgdmFyIGZuID0gcXVldWVbaWRdOwogICAgICBkZWxldGUgcXVldWVbaWRdLCBmbigpOwogICAgfQogIH0sCiAgICAgIHJ1bm5lciA9IGZ1bmN0aW9uIHJ1bm5lcihpZCkgewogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgcnVuKGlkKTsKICAgIH07CiAgfSwKICAgICAgbGlzdGVuZXIgPSBmdW5jdGlvbiBsaXN0ZW5lcihldmVudCkgewogICAgcnVuKGV2ZW50LmRhdGEpOwogIH0sCiAgICAgIHBvc3QgPSBmdW5jdGlvbiBwb3N0KGlkKSB7CiAgICBnbG9iYWxfMS5wb3N0TWVzc2FnZShpZCArICIiLCBsb2NhdGlvbiQxLnByb3RvY29sICsgIi8vIiArIGxvY2F0aW9uJDEuaG9zdCk7CiAgfTsKCiAgc2V0JDEgJiYgY2xlYXIgfHwgKHNldCQxID0gZnVuY3Rpb24gc2V0SW1tZWRpYXRlKGZuKSB7CiAgICBmb3IgKHZhciBhcmdzID0gW10sIGkgPSAxOyBhcmd1bWVudHMubGVuZ3RoID4gaTspIHsKICAgICAgYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIH0KCiAgICByZXR1cm4gcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGZuID8gZm4gOiBGdW5jdGlvbihmbikpLmFwcGx5KHZvaWQgMCwgYXJncyk7CiAgICB9LCBkZWZlcihjb3VudGVyKSwgY291bnRlcjsKICB9LCBjbGVhciA9IGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGlkKSB7CiAgICBkZWxldGUgcXVldWVbaWRdOwogIH0sICJwcm9jZXNzIiA9PSBjbGFzc29mUmF3KHByb2Nlc3MpID8gZGVmZXIgPSBmdW5jdGlvbiBkZWZlcihpZCkgewogICAgcHJvY2Vzcy5uZXh0VGljayhydW5uZXIoaWQpKTsKICB9IDogRGlzcGF0Y2ggJiYgRGlzcGF0Y2gubm93ID8gZGVmZXIgPSBmdW5jdGlvbiBkZWZlcihpZCkgewogICAgRGlzcGF0Y2gubm93KHJ1bm5lcihpZCkpOwogIH0gOiBNZXNzYWdlQ2hhbm5lbCA/IChwb3J0ID0gKGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKSkucG9ydDIsIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXIsIGRlZmVyID0gYmluZENvbnRleHQocG9ydC5wb3N0TWVzc2FnZSwgcG9ydCwgMSkpIDogIWdsb2JhbF8xLmFkZEV2ZW50TGlzdGVuZXIgfHwgImZ1bmN0aW9uIiAhPSB0eXBlb2YgcG9zdE1lc3NhZ2UgfHwgZ2xvYmFsXzEuaW1wb3J0U2NyaXB0cyB8fCBmYWlscyhwb3N0KSA/IGRlZmVyID0gT05SRUFEWVNUQVRFQ0hBTkdFIGluIGRvY3VtZW50Q3JlYXRlRWxlbWVudCgic2NyaXB0IikgPyBmdW5jdGlvbiAoaWQpIHsKICAgIGh0bWwuYXBwZW5kQ2hpbGQoZG9jdW1lbnRDcmVhdGVFbGVtZW50KCJzY3JpcHQiKSkub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgICBodG1sLnJlbW92ZUNoaWxkKHRoaXMpLCBydW4oaWQpOwogICAgfTsKICB9IDogZnVuY3Rpb24gKGlkKSB7CiAgICBzZXRUaW1lb3V0KHJ1bm5lcihpZCksIDApOwogIH0gOiAoZGVmZXIgPSBwb3N0LCBnbG9iYWxfMS5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgbGlzdGVuZXIsICExKSkpOwogIHZhciB0YXNrID0gewogICAgc2V0OiBzZXQkMSwKICAgIGNsZWFyOiBjbGVhcgogIH0sCiAgICAgIHVzZXJBZ2VudCA9IGdldEJ1aWx0SW4oIm5hdmlnYXRvciIsICJ1c2VyQWdlbnQiKSB8fCAiIiwKICAgICAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yJDIgPSBvYmplY3RHZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IuZiwKICAgICAgbWFjcm90YXNrID0gdGFzay5zZXQsCiAgICAgIE11dGF0aW9uT2JzZXJ2ZXIgPSBnbG9iYWxfMS5NdXRhdGlvbk9ic2VydmVyIHx8IGdsb2JhbF8xLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsCiAgICAgIHByb2Nlc3MkMSA9IGdsb2JhbF8xLnByb2Nlc3MsCiAgICAgIFByb21pc2UkMSA9IGdsb2JhbF8xLlByb21pc2UsCiAgICAgIElTX05PREUgPSAicHJvY2VzcyIgPT0gY2xhc3NvZlJhdyhwcm9jZXNzJDEpLAogICAgICBxdWV1ZU1pY3JvdGFza0Rlc2NyaXB0b3IgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IkMihnbG9iYWxfMSwgInF1ZXVlTWljcm90YXNrIiksCiAgICAgIHF1ZXVlTWljcm90YXNrID0gcXVldWVNaWNyb3Rhc2tEZXNjcmlwdG9yICYmIHF1ZXVlTWljcm90YXNrRGVzY3JpcHRvci52YWx1ZSwKICAgICAgZmx1c2gsCiAgICAgIGhlYWQsCiAgICAgIGxhc3QsCiAgICAgIG5vdGlmeSwKICAgICAgdG9nZ2xlLAogICAgICBub2RlLAogICAgICBwcm9taXNlOwogIHF1ZXVlTWljcm90YXNrIHx8IChmbHVzaCA9IGZ1bmN0aW9uIGZsdXNoKCkgewogICAgdmFyIHBhcmVudCwgZm47CgogICAgZm9yIChJU19OT0RFICYmIChwYXJlbnQgPSBwcm9jZXNzJDEuZG9tYWluKSAmJiBwYXJlbnQuZXhpdCgpOyBoZWFkOykgewogICAgICBmbiA9IGhlYWQuZm4sIGhlYWQgPSBoZWFkLm5leHQ7CgogICAgICB0cnkgewogICAgICAgIGZuKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhyb3cgaGVhZCA/IG5vdGlmeSgpIDogbGFzdCA9IHZvaWQgMCwgZXJyb3I7CiAgICAgIH0KICAgIH0KCiAgICBsYXN0ID0gdm9pZCAwLCBwYXJlbnQgJiYgcGFyZW50LmVudGVyKCk7CiAgfSwgSVNfTk9ERSA/IG5vdGlmeSA9IGZ1bmN0aW9uIG5vdGlmeSgpIHsKICAgIHByb2Nlc3MkMS5uZXh0VGljayhmbHVzaCk7CiAgfSA6IE11dGF0aW9uT2JzZXJ2ZXIgJiYgIS8oaXBob25lfGlwb2R8aXBhZCkuKmFwcGxld2Via2l0L2kudGVzdCh1c2VyQWdlbnQpID8gKHRvZ2dsZSA9ICEwLCBub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpLCBuZXcgTXV0YXRpb25PYnNlcnZlcihmbHVzaCkub2JzZXJ2ZShub2RlLCB7CiAgICBjaGFyYWN0ZXJEYXRhOiAhMAogIH0pLCBub3RpZnkgPSBmdW5jdGlvbiBub3RpZnkoKSB7CiAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwogIH0pIDogUHJvbWlzZSQxICYmIFByb21pc2UkMS5yZXNvbHZlID8gKHByb21pc2UgPSBQcm9taXNlJDEucmVzb2x2ZSh2b2lkIDApLCBub3RpZnkgPSBmdW5jdGlvbiBub3RpZnkoKSB7CiAgICBwcm9taXNlLnRoZW4oZmx1c2gpOwogIH0pIDogbm90aWZ5ID0gZnVuY3Rpb24gbm90aWZ5KCkgewogICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsXzEsIGZsdXNoKTsKICB9KTsKCiAgdmFyIG1pY3JvdGFzayA9IHF1ZXVlTWljcm90YXNrIHx8IGZ1bmN0aW9uIChmbikgewogICAgdmFyIHRhc2sgPSB7CiAgICAgIGZuOiBmbiwKICAgICAgbmV4dDogdm9pZCAwCiAgICB9OwogICAgbGFzdCAmJiAobGFzdC5uZXh0ID0gdGFzayksIGhlYWQgfHwgKGhlYWQgPSB0YXNrLCBub3RpZnkoKSksIGxhc3QgPSB0YXNrOwogIH0sCiAgICAgIFByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24gUHJvbWlzZUNhcGFiaWxpdHkoQykgewogICAgdmFyIHJlc29sdmUsIHJlamVjdDsKICAgIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uICgkJHJlc29sdmUsICQkcmVqZWN0KSB7CiAgICAgIGlmICh2b2lkIDAgIT09IHJlc29sdmUgfHwgdm9pZCAwICE9PSByZWplY3QpIHRocm93IFR5cGVFcnJvcigiQmFkIFByb21pc2UgY29uc3RydWN0b3IiKTsKICAgICAgcmVzb2x2ZSA9ICQkcmVzb2x2ZSwgcmVqZWN0ID0gJCRyZWplY3Q7CiAgICB9KSwgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uJDEocmVzb2x2ZSksIHRoaXMucmVqZWN0ID0gYUZ1bmN0aW9uJDEocmVqZWN0KTsKICB9LAogICAgICBmJDUsCiAgICAgIG5ld1Byb21pc2VDYXBhYmlsaXR5ID0gewogICAgZjogZnVuY3Rpb24gZihDKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoQyk7CiAgICB9CiAgfSwKICAgICAgcHJvbWlzZVJlc29sdmUgPSBmdW5jdGlvbiBwcm9taXNlUmVzb2x2ZShDLCB4KSB7CiAgICBpZiAoYW5PYmplY3QoQyksIGlzT2JqZWN0JDEoeCkgJiYgeC5jb25zdHJ1Y3RvciA9PT0gQykgcmV0dXJuIHg7CiAgICB2YXIgcHJvbWlzZUNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eS5mKEMpLAogICAgICAgIHJlc29sdmU7CiAgICByZXR1cm4gKDAsIHByb21pc2VDYXBhYmlsaXR5LnJlc29sdmUpKHgpLCBwcm9taXNlQ2FwYWJpbGl0eS5wcm9taXNlOwogIH0sCiAgICAgIGhvc3RSZXBvcnRFcnJvcnMgPSBmdW5jdGlvbiBob3N0UmVwb3J0RXJyb3JzKGEsIGIpIHsKICAgIHZhciBjb25zb2xlID0gZ2xvYmFsXzEuY29uc29sZTsKICAgIGNvbnNvbGUgJiYgY29uc29sZS5lcnJvciAmJiAoMSA9PT0gYXJndW1lbnRzLmxlbmd0aCA/IGNvbnNvbGUuZXJyb3IoYSkgOiBjb25zb2xlLmVycm9yKGEsIGIpKTsKICB9LAogICAgICBwZXJmb3JtID0gZnVuY3Rpb24gcGVyZm9ybShleGVjKSB7CiAgICB0cnkgewogICAgICByZXR1cm4gewogICAgICAgIGVycm9yOiAhMSwKICAgICAgICB2YWx1ZTogZXhlYygpCiAgICAgIH07CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICByZXR1cm4gewogICAgICAgIGVycm9yOiAhMCwKICAgICAgICB2YWx1ZTogZXJyb3IKICAgICAgfTsKICAgIH0KICB9LAogICAgICB0YXNrJDEgPSB0YXNrLnNldCwKICAgICAgU1BFQ0lFUyQyID0gd2VsbEtub3duU3ltYm9sKCJzcGVjaWVzIiksCiAgICAgIFBST01JU0UgPSAiUHJvbWlzZSIsCiAgICAgIGdldEludGVybmFsU3RhdGUkMiA9IGludGVybmFsU3RhdGUuZ2V0LAogICAgICBzZXRJbnRlcm5hbFN0YXRlJDIgPSBpbnRlcm5hbFN0YXRlLnNldCwKICAgICAgZ2V0SW50ZXJuYWxQcm9taXNlU3RhdGUgPSBpbnRlcm5hbFN0YXRlLmdldHRlckZvcihQUk9NSVNFKSwKICAgICAgUHJvbWlzZUNvbnN0cnVjdG9yID0gZ2xvYmFsXzEuUHJvbWlzZSwKICAgICAgVHlwZUVycm9yJDEgPSBnbG9iYWxfMS5UeXBlRXJyb3IsCiAgICAgIGRvY3VtZW50JDIgPSBnbG9iYWxfMS5kb2N1bWVudCwKICAgICAgcHJvY2VzcyQyID0gZ2xvYmFsXzEucHJvY2VzcywKICAgICAgJGZldGNoID0gZ2xvYmFsXzEuZmV0Y2gsCiAgICAgIHZlcnNpb25zID0gcHJvY2VzcyQyICYmIHByb2Nlc3MkMi52ZXJzaW9ucywKICAgICAgdjggPSB2ZXJzaW9ucyAmJiB2ZXJzaW9ucy52OCB8fCAiIiwKICAgICAgbmV3UHJvbWlzZUNhcGFiaWxpdHkkMSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5LmYsCiAgICAgIG5ld0dlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5JDEsCiAgICAgIElTX05PREUkMSA9ICJwcm9jZXNzIiA9PSBjbGFzc29mUmF3KHByb2Nlc3MkMiksCiAgICAgIERJU1BBVENIX0VWRU5UID0gISEoZG9jdW1lbnQkMiAmJiBkb2N1bWVudCQyLmNyZWF0ZUV2ZW50ICYmIGdsb2JhbF8xLmRpc3BhdGNoRXZlbnQpLAogICAgICBVTkhBTkRMRURfUkVKRUNUSU9OID0gInVuaGFuZGxlZHJlamVjdGlvbiIsCiAgICAgIFJFSkVDVElPTl9IQU5ETEVEID0gInJlamVjdGlvbmhhbmRsZWQiLAogICAgICBQRU5ESU5HID0gMCwKICAgICAgRlVMRklMTEVEID0gMSwKICAgICAgUkVKRUNURUQgPSAyLAogICAgICBIQU5ETEVEID0gMSwKICAgICAgVU5IQU5ETEVEID0gMiwKICAgICAgSW50ZXJuYWwsCiAgICAgIE93blByb21pc2VDYXBhYmlsaXR5LAogICAgICBQcm9taXNlV3JhcHBlciwKICAgICAgRk9SQ0VEID0gaXNGb3JjZWRfMShQUk9NSVNFLCBmdW5jdGlvbiAoKSB7CiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2VDb25zdHJ1Y3Rvci5yZXNvbHZlKDEpLAogICAgICAgIGVtcHR5ID0gZnVuY3Rpb24gZW1wdHkoKSB7fSwKICAgICAgICBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW1NQRUNJRVMkMl0gPSBmdW5jdGlvbiAoZXhlYykgewogICAgICBleGVjKGVtcHR5LCBlbXB0eSk7CiAgICB9OwoKICAgIHJldHVybiAhKChJU19OT0RFJDEgfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50KSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2UgJiYgMCAhPT0gdjguaW5kZXhPZigiNi42IikgJiYgLTEgPT09IHVzZXJBZ2VudC5pbmRleE9mKCJDaHJvbWUvNjYiKSk7CiAgfSksCiAgICAgIElOQ09SUkVDVF9JVEVSQVRJT04gPSBGT1JDRUQgfHwgIWNoZWNrQ29ycmVjdG5lc3NPZkl0ZXJhdGlvbihmdW5jdGlvbiAoaXRlcmFibGUpIHsKICAgIFByb21pc2VDb25zdHJ1Y3Rvci5hbGwoaXRlcmFibGUpLmNhdGNoKGZ1bmN0aW9uICgpIHt9KTsKICB9KSwKICAgICAgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uIGlzVGhlbmFibGUoaXQpIHsKICAgIHZhciB0aGVuOwogICAgcmV0dXJuICEoIWlzT2JqZWN0JDEoaXQpIHx8ICJmdW5jdGlvbiIgIT0gdHlwZW9mICh0aGVuID0gaXQudGhlbikpICYmIHRoZW47CiAgfSwKICAgICAgbm90aWZ5JDEgPSBmdW5jdGlvbiBub3RpZnkkMShwcm9taXNlLCBzdGF0ZSwgaXNSZWplY3QpIHsKICAgIGlmICghc3RhdGUubm90aWZpZWQpIHsKICAgICAgc3RhdGUubm90aWZpZWQgPSAhMDsKICAgICAgdmFyIGNoYWluID0gc3RhdGUucmVhY3Rpb25zOwogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24gKCkgewogICAgICAgIGZvciAodmFyIHZhbHVlID0gc3RhdGUudmFsdWUsIG9rID0gMSA9PSBzdGF0ZS5zdGF0ZSwgaW5kZXggPSAwOyBjaGFpbi5sZW5ndGggPiBpbmRleDspIHsKICAgICAgICAgIHZhciByZWFjdGlvbiA9IGNoYWluW2luZGV4KytdLAogICAgICAgICAgICAgIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbCwKICAgICAgICAgICAgICByZXNvbHZlID0gcmVhY3Rpb24ucmVzb2x2ZSwKICAgICAgICAgICAgICByZWplY3QgPSByZWFjdGlvbi5yZWplY3QsCiAgICAgICAgICAgICAgZG9tYWluID0gcmVhY3Rpb24uZG9tYWluLAogICAgICAgICAgICAgIHJlc3VsdCwKICAgICAgICAgICAgICB0aGVuLAogICAgICAgICAgICAgIGV4aXRlZDsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBoYW5kbGVyID8gKG9rIHx8ICgyID09PSBzdGF0ZS5yZWplY3Rpb24gJiYgb25IYW5kbGVVbmhhbmRsZWQocHJvbWlzZSwgc3RhdGUpLCBzdGF0ZS5yZWplY3Rpb24gPSAxKSwgITAgPT09IGhhbmRsZXIgPyByZXN1bHQgPSB2YWx1ZSA6IChkb21haW4gJiYgZG9tYWluLmVudGVyKCksIHJlc3VsdCA9IGhhbmRsZXIodmFsdWUpLCBkb21haW4gJiYgKGRvbWFpbi5leGl0KCksIGV4aXRlZCA9ICEwKSksIHJlc3VsdCA9PT0gcmVhY3Rpb24ucHJvbWlzZSA/IHJlamVjdChUeXBlRXJyb3IkMSgiUHJvbWlzZS1jaGFpbiBjeWNsZSIpKSA6ICh0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKSA/IHRoZW4uY2FsbChyZXN1bHQsIHJlc29sdmUsIHJlamVjdCkgOiByZXNvbHZlKHJlc3VsdCkpIDogcmVqZWN0KHZhbHVlKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGRvbWFpbiAmJiAhZXhpdGVkICYmIGRvbWFpbi5leGl0KCksIHJlamVjdChlcnJvcik7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzdGF0ZS5yZWFjdGlvbnMgPSBbXSwgc3RhdGUubm90aWZpZWQgPSAhMSwgaXNSZWplY3QgJiYgIXN0YXRlLnJlamVjdGlvbiAmJiBvblVuaGFuZGxlZChwcm9taXNlLCBzdGF0ZSk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgICAgIGRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiBkaXNwYXRjaEV2ZW50KG5hbWUsIHByb21pc2UsIHJlYXNvbikgewogICAgdmFyIGV2ZW50LCBoYW5kbGVyOwogICAgRElTUEFUQ0hfRVZFTlQgPyAoKGV2ZW50ID0gZG9jdW1lbnQkMi5jcmVhdGVFdmVudCgiRXZlbnQiKSkucHJvbWlzZSA9IHByb21pc2UsIGV2ZW50LnJlYXNvbiA9IHJlYXNvbiwgZXZlbnQuaW5pdEV2ZW50KG5hbWUsICExLCAhMCksIGdsb2JhbF8xLmRpc3BhdGNoRXZlbnQoZXZlbnQpKSA6IGV2ZW50ID0gewogICAgICBwcm9taXNlOiBwcm9taXNlLAogICAgICByZWFzb246IHJlYXNvbgogICAgfSwgKGhhbmRsZXIgPSBnbG9iYWxfMVsib24iICsgbmFtZV0pID8gaGFuZGxlcihldmVudCkgOiBuYW1lID09PSBVTkhBTkRMRURfUkVKRUNUSU9OICYmIGhvc3RSZXBvcnRFcnJvcnMoIlVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbiIsIHJlYXNvbik7CiAgfSwKICAgICAgb25VbmhhbmRsZWQgPSBmdW5jdGlvbiBvblVuaGFuZGxlZChwcm9taXNlLCBzdGF0ZSkgewogICAgdGFzayQxLmNhbGwoZ2xvYmFsXzEsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHZhbHVlID0gc3RhdGUudmFsdWUsCiAgICAgICAgICBJU19VTkhBTkRMRUQsCiAgICAgICAgICByZXN1bHQ7CiAgICAgIGlmIChpc1VuaGFuZGxlZChzdGF0ZSkgJiYgKHJlc3VsdCA9IHBlcmZvcm0oZnVuY3Rpb24gKCkgewogICAgICAgIElTX05PREUkMSA/IHByb2Nlc3MkMi5lbWl0KCJ1bmhhbmRsZWRSZWplY3Rpb24iLCB2YWx1ZSwgcHJvbWlzZSkgOiBkaXNwYXRjaEV2ZW50KFVOSEFORExFRF9SRUpFQ1RJT04sIHByb21pc2UsIHZhbHVlKTsKICAgICAgfSksIHN0YXRlLnJlamVjdGlvbiA9IElTX05PREUkMSB8fCBpc1VuaGFuZGxlZChzdGF0ZSkgPyAyIDogMSwgcmVzdWx0LmVycm9yKSkgdGhyb3cgcmVzdWx0LnZhbHVlOwogICAgfSk7CiAgfSwKICAgICAgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbiBpc1VuaGFuZGxlZChzdGF0ZSkgewogICAgcmV0dXJuIDEgIT09IHN0YXRlLnJlamVjdGlvbiAmJiAhc3RhdGUucGFyZW50OwogIH0sCiAgICAgIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24gb25IYW5kbGVVbmhhbmRsZWQocHJvbWlzZSwgc3RhdGUpIHsKICAgIHRhc2skMS5jYWxsKGdsb2JhbF8xLCBmdW5jdGlvbiAoKSB7CiAgICAgIElTX05PREUkMSA/IHByb2Nlc3MkMi5lbWl0KCJyZWplY3Rpb25IYW5kbGVkIiwgcHJvbWlzZSkgOiBkaXNwYXRjaEV2ZW50KFJFSkVDVElPTl9IQU5ETEVELCBwcm9taXNlLCBzdGF0ZS52YWx1ZSk7CiAgICB9KTsKICB9LAogICAgICBiaW5kID0gZnVuY3Rpb24gYmluZChmbiwgcHJvbWlzZSwgc3RhdGUsIHVud3JhcCkgewogICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICBmbihwcm9taXNlLCBzdGF0ZSwgdmFsdWUsIHVud3JhcCk7CiAgICB9OwogIH0sCiAgICAgIGludGVybmFsUmVqZWN0ID0gZnVuY3Rpb24gaW50ZXJuYWxSZWplY3QocHJvbWlzZSwgc3RhdGUsIHZhbHVlLCB1bndyYXApIHsKICAgIHN0YXRlLmRvbmUgfHwgKHN0YXRlLmRvbmUgPSAhMCwgdW53cmFwICYmIChzdGF0ZSA9IHVud3JhcCksIHN0YXRlLnZhbHVlID0gdmFsdWUsIHN0YXRlLnN0YXRlID0gMiwgbm90aWZ5JDEocHJvbWlzZSwgc3RhdGUsICEwKSk7CiAgfSwKICAgICAgaW50ZXJuYWxSZXNvbHZlID0gZnVuY3Rpb24gaW50ZXJuYWxSZXNvbHZlKHByb21pc2UsIHN0YXRlLCB2YWx1ZSwgdW53cmFwKSB7CiAgICBpZiAoIXN0YXRlLmRvbmUpIHsKICAgICAgc3RhdGUuZG9uZSA9ICEwLCB1bndyYXAgJiYgKHN0YXRlID0gdW53cmFwKTsKCiAgICAgIHRyeSB7CiAgICAgICAgaWYgKHByb21pc2UgPT09IHZhbHVlKSB0aHJvdyBUeXBlRXJyb3IkMSgiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGYiKTsKICAgICAgICB2YXIgdGhlbiA9IGlzVGhlbmFibGUodmFsdWUpOwogICAgICAgIHRoZW4gPyBtaWNyb3Rhc2soZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHdyYXBwZXIgPSB7CiAgICAgICAgICAgIGRvbmU6ICExCiAgICAgICAgICB9OwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHRoZW4uY2FsbCh2YWx1ZSwgYmluZChpbnRlcm5hbFJlc29sdmUsIHByb21pc2UsIHdyYXBwZXIsIHN0YXRlKSwgYmluZChpbnRlcm5hbFJlamVjdCwgcHJvbWlzZSwgd3JhcHBlciwgc3RhdGUpKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGludGVybmFsUmVqZWN0KHByb21pc2UsIHdyYXBwZXIsIGVycm9yLCBzdGF0ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSkgOiAoc3RhdGUudmFsdWUgPSB2YWx1ZSwgc3RhdGUuc3RhdGUgPSAxLCBub3RpZnkkMShwcm9taXNlLCBzdGF0ZSwgITEpKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBpbnRlcm5hbFJlamVjdChwcm9taXNlLCB7CiAgICAgICAgICBkb25lOiAhMQogICAgICAgIH0sIGVycm9yLCBzdGF0ZSk7CiAgICAgIH0KICAgIH0KICB9OwoKICBGT1JDRUQgJiYgKFByb21pc2VDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpIHsKICAgIGFuSW5zdGFuY2UodGhpcywgUHJvbWlzZUNvbnN0cnVjdG9yLCBQUk9NSVNFKSwgYUZ1bmN0aW9uJDEoZXhlY3V0b3IpLCBJbnRlcm5hbC5jYWxsKHRoaXMpOwogICAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZSQyKHRoaXMpOwoKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKGJpbmQoaW50ZXJuYWxSZXNvbHZlLCB0aGlzLCBzdGF0ZSksIGJpbmQoaW50ZXJuYWxSZWplY3QsIHRoaXMsIHN0YXRlKSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBpbnRlcm5hbFJlamVjdCh0aGlzLCBzdGF0ZSwgZXJyb3IpOwogICAgfQogIH0sIChJbnRlcm5hbCA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpIHsKICAgIHNldEludGVybmFsU3RhdGUkMih0aGlzLCB7CiAgICAgIHR5cGU6IFBST01JU0UsCiAgICAgIGRvbmU6ICExLAogICAgICBub3RpZmllZDogITEsCiAgICAgIHBhcmVudDogITEsCiAgICAgIHJlYWN0aW9uczogW10sCiAgICAgIHJlamVjdGlvbjogITEsCiAgICAgIHN0YXRlOiAwLAogICAgICB2YWx1ZTogdm9pZCAwCiAgICB9KTsKICB9KS5wcm90b3R5cGUgPSByZWRlZmluZUFsbChQcm9taXNlQ29uc3RydWN0b3IucHJvdG90eXBlLCB7CiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7CiAgICAgIHZhciBzdGF0ZSA9IGdldEludGVybmFsUHJvbWlzZVN0YXRlKHRoaXMpLAogICAgICAgICAgcmVhY3Rpb24gPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSQxKHNwZWNpZXNDb25zdHJ1Y3Rvcih0aGlzLCBQcm9taXNlQ29uc3RydWN0b3IpKTsKICAgICAgcmV0dXJuIHJlYWN0aW9uLm9rID0gImZ1bmN0aW9uIiAhPSB0eXBlb2Ygb25GdWxmaWxsZWQgfHwgb25GdWxmaWxsZWQsIHJlYWN0aW9uLmZhaWwgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBvblJlamVjdGVkICYmIG9uUmVqZWN0ZWQsIHJlYWN0aW9uLmRvbWFpbiA9IElTX05PREUkMSA/IHByb2Nlc3MkMi5kb21haW4gOiB2b2lkIDAsIHN0YXRlLnBhcmVudCA9ICEwLCBzdGF0ZS5yZWFjdGlvbnMucHVzaChyZWFjdGlvbiksIDAgIT0gc3RhdGUuc3RhdGUgJiYgbm90aWZ5JDEodGhpcywgc3RhdGUsICExKSwgcmVhY3Rpb24ucHJvbWlzZTsKICAgIH0sCiAgICBjYXRjaDogZnVuY3Rpb24gX2NhdGNoKG9uUmVqZWN0ZWQpIHsKICAgICAgcmV0dXJuIHRoaXMudGhlbih2b2lkIDAsIG9uUmVqZWN0ZWQpOwogICAgfQogIH0pLCBPd25Qcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uIE93blByb21pc2VDYXBhYmlsaXR5KCkgewogICAgdmFyIHByb21pc2UgPSBuZXcgSW50ZXJuYWwoKSwKICAgICAgICBzdGF0ZSA9IGdldEludGVybmFsU3RhdGUkMihwcm9taXNlKTsKICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2UsIHRoaXMucmVzb2x2ZSA9IGJpbmQoaW50ZXJuYWxSZXNvbHZlLCBwcm9taXNlLCBzdGF0ZSksIHRoaXMucmVqZWN0ID0gYmluZChpbnRlcm5hbFJlamVjdCwgcHJvbWlzZSwgc3RhdGUpOwogIH0sIG5ld1Byb21pc2VDYXBhYmlsaXR5LmYgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSQxID0gZnVuY3Rpb24gbmV3UHJvbWlzZUNhcGFiaWxpdHkkMShDKSB7CiAgICByZXR1cm4gQyA9PT0gUHJvbWlzZUNvbnN0cnVjdG9yIHx8IEMgPT09IFByb21pc2VXcmFwcGVyID8gbmV3IE93blByb21pc2VDYXBhYmlsaXR5KEMpIDogbmV3R2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwogIH0sICJmdW5jdGlvbiIgPT0gdHlwZW9mICRmZXRjaCAmJiBfZXhwb3J0KHsKICAgIGdsb2JhbDogITAsCiAgICBlbnVtZXJhYmxlOiAhMCwKICAgIGZvcmNlZDogITAKICB9LCB7CiAgICBmZXRjaDogZnVuY3Rpb24gZmV0Y2goaW5wdXQpIHsKICAgICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKFByb21pc2VDb25zdHJ1Y3RvciwgJGZldGNoLmFwcGx5KGdsb2JhbF8xLCBhcmd1bWVudHMpKTsKICAgIH0KICB9KSksIF9leHBvcnQoewogICAgZ2xvYmFsOiAhMCwKICAgIHdyYXA6ICEwLAogICAgZm9yY2VkOiBGT1JDRUQKICB9LCB7CiAgICBQcm9taXNlOiBQcm9taXNlQ29uc3RydWN0b3IKICB9KSwgc2V0VG9TdHJpbmdUYWcoUHJvbWlzZUNvbnN0cnVjdG9yLCBQUk9NSVNFLCAhMSksIHNldFNwZWNpZXMoUFJPTUlTRSksIFByb21pc2VXcmFwcGVyID0gcGF0aC5Qcm9taXNlLCBfZXhwb3J0KHsKICAgIHRhcmdldDogUFJPTUlTRSwKICAgIHN0YXQ6ICEwLAogICAgZm9yY2VkOiBGT1JDRUQKICB9LCB7CiAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKSB7CiAgICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkkMSh0aGlzKTsKICAgICAgcmV0dXJuIGNhcGFiaWxpdHkucmVqZWN0LmNhbGwodm9pZCAwLCByKSwgY2FwYWJpbGl0eS5wcm9taXNlOwogICAgfQogIH0pLCBfZXhwb3J0KHsKICAgIHRhcmdldDogUFJPTUlTRSwKICAgIHN0YXQ6ICEwLAogICAgZm9yY2VkOiBGT1JDRUQKICB9LCB7CiAgICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpIHsKICAgICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKHRoaXMsIHgpOwogICAgfQogIH0pLCBfZXhwb3J0KHsKICAgIHRhcmdldDogUFJPTUlTRSwKICAgIHN0YXQ6ICEwLAogICAgZm9yY2VkOiBJTkNPUlJFQ1RfSVRFUkFUSU9OCiAgfSwgewogICAgYWxsOiBmdW5jdGlvbiBhbGwoaXRlcmFibGUpIHsKICAgICAgdmFyIEMgPSB0aGlzLAogICAgICAgICAgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5JDEoQyksCiAgICAgICAgICByZXNvbHZlID0gY2FwYWJpbGl0eS5yZXNvbHZlLAogICAgICAgICAgcmVqZWN0ID0gY2FwYWJpbGl0eS5yZWplY3QsCiAgICAgICAgICByZXN1bHQgPSBwZXJmb3JtKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgJHByb21pc2VSZXNvbHZlID0gYUZ1bmN0aW9uJDEoQy5yZXNvbHZlKSwKICAgICAgICAgICAgdmFsdWVzID0gW10sCiAgICAgICAgICAgIGNvdW50ZXIgPSAwLAogICAgICAgICAgICByZW1haW5pbmcgPSAxOwogICAgICAgIGl0ZXJhdGVfMShpdGVyYWJsZSwgZnVuY3Rpb24gKHByb21pc2UpIHsKICAgICAgICAgIHZhciBpbmRleCA9IGNvdW50ZXIrKywKICAgICAgICAgICAgICBhbHJlYWR5Q2FsbGVkID0gITE7CiAgICAgICAgICB2YWx1ZXMucHVzaCh2b2lkIDApLCByZW1haW5pbmcrKywgJHByb21pc2VSZXNvbHZlLmNhbGwoQywgcHJvbWlzZSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgYWxyZWFkeUNhbGxlZCB8fCAoYWxyZWFkeUNhbGxlZCA9ICEwLCB2YWx1ZXNbaW5kZXhdID0gdmFsdWUsIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKSk7CiAgICAgICAgICB9LCByZWplY3QpOwogICAgICAgIH0pLCAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0LmVycm9yICYmIHJlamVjdChyZXN1bHQudmFsdWUpLCBjYXBhYmlsaXR5LnByb21pc2U7CiAgICB9LAogICAgcmFjZTogZnVuY3Rpb24gcmFjZShpdGVyYWJsZSkgewogICAgICB2YXIgQyA9IHRoaXMsCiAgICAgICAgICBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkkMShDKSwKICAgICAgICAgIHJlamVjdCA9IGNhcGFiaWxpdHkucmVqZWN0LAogICAgICAgICAgcmVzdWx0ID0gcGVyZm9ybShmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyICRwcm9taXNlUmVzb2x2ZSA9IGFGdW5jdGlvbiQxKEMucmVzb2x2ZSk7CiAgICAgICAgaXRlcmF0ZV8xKGl0ZXJhYmxlLCBmdW5jdGlvbiAocHJvbWlzZSkgewogICAgICAgICAgJHByb21pc2VSZXNvbHZlLmNhbGwoQywgcHJvbWlzZSkudGhlbihjYXBhYmlsaXR5LnJlc29sdmUsIHJlamVjdCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0LmVycm9yICYmIHJlamVjdChyZXN1bHQudmFsdWUpLCBjYXBhYmlsaXR5LnByb21pc2U7CiAgICB9CiAgfSksIF9leHBvcnQoewogICAgdGFyZ2V0OiAiUHJvbWlzZSIsCiAgICBwcm90bzogITAsCiAgICByZWFsOiAhMAogIH0sIHsKICAgIGZpbmFsbHk6IGZ1bmN0aW9uIF9maW5hbGx5KG9uRmluYWxseSkgewogICAgICB2YXIgQyA9IHNwZWNpZXNDb25zdHJ1Y3Rvcih0aGlzLCBnZXRCdWlsdEluKCJQcm9taXNlIikpLAogICAgICAgICAgaXNGdW5jdGlvbiA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIG9uRmluYWxseTsKICAgICAgcmV0dXJuIHRoaXMudGhlbihpc0Z1bmN0aW9uID8gZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4gcHJvbWlzZVJlc29sdmUoQywgb25GaW5hbGx5KCkpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHg7CiAgICAgICAgfSk7CiAgICAgIH0gOiBvbkZpbmFsbHksIGlzRnVuY3Rpb24gPyBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZShDLCBvbkZpbmFsbHkoKSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aHJvdyBlOwogICAgICAgIH0pOwogICAgICB9IDogb25GaW5hbGx5KTsKICAgIH0KICB9KTsKCiAgdmFyIHByb21pc2UkMSA9IHBhdGguUHJvbWlzZSwKICAgICAgJEFnZ3JlZ2F0ZUVycm9yID0gZnVuY3Rpb24gQWdncmVnYXRlRXJyb3IoZXJyb3JzLCBtZXNzYWdlKSB7CiAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICBpZiAoISh0aGF0IGluc3RhbmNlb2YgJEFnZ3JlZ2F0ZUVycm9yKSkgcmV0dXJuIG5ldyAkQWdncmVnYXRlRXJyb3IoZXJyb3JzLCBtZXNzYWdlKTsKICAgIG9iamVjdFNldFByb3RvdHlwZU9mICYmICh0aGF0ID0gb2JqZWN0U2V0UHJvdG90eXBlT2YobmV3IEVycm9yKG1lc3NhZ2UpLCBvYmplY3RHZXRQcm90b3R5cGVPZih0aGF0KSkpOwogICAgdmFyIGVycm9yc0FycmF5ID0gW107CiAgICByZXR1cm4gaXRlcmF0ZV8xKGVycm9ycywgZXJyb3JzQXJyYXkucHVzaCwgZXJyb3JzQXJyYXkpLCB0aGF0LmVycm9ycyA9IGVycm9yc0FycmF5LCB2b2lkIDAgIT09IG1lc3NhZ2UgJiYgaGlkZSh0aGF0LCAibWVzc2FnZSIsIFN0cmluZyhtZXNzYWdlKSksIHRoYXQ7CiAgfTsKCiAgJEFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZSA9IG9iamVjdENyZWF0ZShFcnJvci5wcm90b3R5cGUsIHsKICAgIGNvbnN0cnVjdG9yOiBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IoNSwgJEFnZ3JlZ2F0ZUVycm9yKSwKICAgIG5hbWU6IGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvcig1LCAiQWdncmVnYXRlRXJyb3IiKQogIH0pLCBfZXhwb3J0KHsKICAgIGdsb2JhbDogITAKICB9LCB7CiAgICBBZ2dyZWdhdGVFcnJvcjogJEFnZ3JlZ2F0ZUVycm9yCiAgfSksIF9leHBvcnQoewogICAgdGFyZ2V0OiAiUHJvbWlzZSIsCiAgICBzdGF0OiAhMAogIH0sIHsKICAgIGFsbFNldHRsZWQ6IGZ1bmN0aW9uIGFsbFNldHRsZWQoaXRlcmFibGUpIHsKICAgICAgdmFyIEMgPSB0aGlzLAogICAgICAgICAgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5LmYoQyksCiAgICAgICAgICByZXNvbHZlID0gY2FwYWJpbGl0eS5yZXNvbHZlLAogICAgICAgICAgcmVqZWN0ID0gY2FwYWJpbGl0eS5yZWplY3QsCiAgICAgICAgICByZXN1bHQgPSBwZXJmb3JtKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcHJvbWlzZVJlc29sdmUgPSBhRnVuY3Rpb24kMShDLnJlc29sdmUpLAogICAgICAgICAgICB2YWx1ZXMgPSBbXSwKICAgICAgICAgICAgY291bnRlciA9IDAsCiAgICAgICAgICAgIHJlbWFpbmluZyA9IDE7CiAgICAgICAgaXRlcmF0ZV8xKGl0ZXJhYmxlLCBmdW5jdGlvbiAocHJvbWlzZSkgewogICAgICAgICAgdmFyIGluZGV4ID0gY291bnRlcisrLAogICAgICAgICAgICAgIGFscmVhZHlDYWxsZWQgPSAhMTsKICAgICAgICAgIHZhbHVlcy5wdXNoKHZvaWQgMCksIHJlbWFpbmluZysrLCBwcm9taXNlUmVzb2x2ZS5jYWxsKEMsIHByb21pc2UpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgIGFscmVhZHlDYWxsZWQgfHwgKGFscmVhZHlDYWxsZWQgPSAhMCwgdmFsdWVzW2luZGV4XSA9IHsKICAgICAgICAgICAgICBzdGF0dXM6ICJmdWxmaWxsZWQiLAogICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICAgICAgICB9LCAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcykpOwogICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgYWxyZWFkeUNhbGxlZCB8fCAoYWxyZWFkeUNhbGxlZCA9ICEwLCB2YWx1ZXNbaW5kZXhdID0gewogICAgICAgICAgICAgIHN0YXR1czogInJlamVjdGVkIiwKICAgICAgICAgICAgICByZWFzb246IGUKICAgICAgICAgICAgfSwgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pLCAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0LmVycm9yICYmIHJlamVjdChyZXN1bHQudmFsdWUpLCBjYXBhYmlsaXR5LnByb21pc2U7CiAgICB9CiAgfSksIF9leHBvcnQoewogICAgdGFyZ2V0OiAiUHJvbWlzZSIsCiAgICBzdGF0OiAhMAogIH0sIHsKICAgIHRyeTogZnVuY3Rpb24gX3RyeShjYWxsYmFja2ZuKSB7CiAgICAgIHZhciBwcm9taXNlQ2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5LmYodGhpcyksCiAgICAgICAgICByZXN1bHQgPSBwZXJmb3JtKGNhbGxiYWNrZm4pOwogICAgICByZXR1cm4gKHJlc3VsdC5lcnJvciA/IHByb21pc2VDYXBhYmlsaXR5LnJlamVjdCA6IHByb21pc2VDYXBhYmlsaXR5LnJlc29sdmUpKHJlc3VsdC52YWx1ZSksIHByb21pc2VDYXBhYmlsaXR5LnByb21pc2U7CiAgICB9CiAgfSk7CiAgdmFyIFBST01JU0VfQU5ZX0VSUk9SID0gIk5vIG9uZSBwcm9taXNlIHJlc29sdmVkIjsKCiAgX2V4cG9ydCh7CiAgICB0YXJnZXQ6ICJQcm9taXNlIiwKICAgIHN0YXQ6ICEwCiAgfSwgewogICAgYW55OiBmdW5jdGlvbiBhbnkoaXRlcmFibGUpIHsKICAgICAgdmFyIEMgPSB0aGlzLAogICAgICAgICAgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5LmYoQyksCiAgICAgICAgICByZXNvbHZlID0gY2FwYWJpbGl0eS5yZXNvbHZlLAogICAgICAgICAgcmVqZWN0ID0gY2FwYWJpbGl0eS5yZWplY3QsCiAgICAgICAgICByZXN1bHQgPSBwZXJmb3JtKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcHJvbWlzZVJlc29sdmUgPSBhRnVuY3Rpb24kMShDLnJlc29sdmUpLAogICAgICAgICAgICBlcnJvcnMgPSBbXSwKICAgICAgICAgICAgY291bnRlciA9IDAsCiAgICAgICAgICAgIHJlbWFpbmluZyA9IDEsCiAgICAgICAgICAgIGFscmVhZHlSZXNvbHZlZCA9ICExOwogICAgICAgIGl0ZXJhdGVfMShpdGVyYWJsZSwgZnVuY3Rpb24gKHByb21pc2UpIHsKICAgICAgICAgIHZhciBpbmRleCA9IGNvdW50ZXIrKywKICAgICAgICAgICAgICBhbHJlYWR5UmVqZWN0ZWQgPSAhMTsKICAgICAgICAgIGVycm9ycy5wdXNoKHZvaWQgMCksIHJlbWFpbmluZysrLCBwcm9taXNlUmVzb2x2ZS5jYWxsKEMsIHByb21pc2UpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgIGFscmVhZHlSZWplY3RlZCB8fCBhbHJlYWR5UmVzb2x2ZWQgfHwgKGFscmVhZHlSZXNvbHZlZCA9ICEwLCByZXNvbHZlKHZhbHVlKSk7CiAgICAgICAgICB9LCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBhbHJlYWR5UmVqZWN0ZWQgfHwgYWxyZWFkeVJlc29sdmVkIHx8IChhbHJlYWR5UmVqZWN0ZWQgPSAhMCwgZXJyb3JzW2luZGV4XSA9IGUsIC0tcmVtYWluaW5nIHx8IHJlamVjdChuZXcgKGdldEJ1aWx0SW4oIkFnZ3JlZ2F0ZUVycm9yIikpKGVycm9ycywgUFJPTUlTRV9BTllfRVJST1IpKSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KSwgLS1yZW1haW5pbmcgfHwgcmVqZWN0KG5ldyAoZ2V0QnVpbHRJbigiQWdncmVnYXRlRXJyb3IiKSkoZXJyb3JzLCBQUk9NSVNFX0FOWV9FUlJPUikpOwogICAgICB9KTsKICAgICAgcmV0dXJuIHJlc3VsdC5lcnJvciAmJiByZWplY3QocmVzdWx0LnZhbHVlKSwgY2FwYWJpbGl0eS5wcm9taXNlOwogICAgfQogIH0pOwoKICB2YXIgTUFUQ0ggPSB3ZWxsS25vd25TeW1ib2woIm1hdGNoIiksCiAgICAgIGlzUmVnZXhwID0gZnVuY3Rpb24gaXNSZWdleHAoaXQpIHsKICAgIHZhciBpc1JlZ0V4cDsKICAgIHJldHVybiBpc09iamVjdCQxKGl0KSAmJiAodm9pZCAwICE9PSAoaXNSZWdFeHAgPSBpdFtNQVRDSF0pID8gISFpc1JlZ0V4cCA6ICJSZWdFeHAiID09IGNsYXNzb2ZSYXcoaXQpKTsKICB9LAogICAgICBub3RBUmVnZXhwID0gZnVuY3Rpb24gbm90QVJlZ2V4cChpdCkgewogICAgaWYgKGlzUmVnZXhwKGl0KSkgdGhyb3cgVHlwZUVycm9yKCJUaGUgbWV0aG9kIGRvZXNuJ3QgYWNjZXB0IHJlZ3VsYXIgZXhwcmVzc2lvbnMiKTsKICAgIHJldHVybiBpdDsKICB9LAogICAgICBNQVRDSCQxID0gd2VsbEtub3duU3ltYm9sKCJtYXRjaCIpLAogICAgICBjb3JyZWN0SXNSZWdleHBMb2dpYyA9IGZ1bmN0aW9uIGNvcnJlY3RJc1JlZ2V4cExvZ2ljKE1FVEhPRF9OQU1FKSB7CiAgICB2YXIgcmVnZXhwID0gLy4vOwoKICAgIHRyeSB7CiAgICAgICIvLi8iW01FVEhPRF9OQU1FXShyZWdleHApOwogICAgfSBjYXRjaCAoZSkgewogICAgICB0cnkgewogICAgICAgIHJldHVybiByZWdleHBbTUFUQ0gkMV0gPSAhMSwgIi8uLyJbTUVUSE9EX05BTUVdKHJlZ2V4cCk7CiAgICAgIH0gY2F0Y2ggKGYpIHt9CiAgICB9CgogICAgcmV0dXJuICExOwogIH0sCiAgICAgIG5hdGl2ZUVuZHNXaXRoID0gIiIuZW5kc1dpdGgsCiAgICAgIG1pbiQyID0gTWF0aC5taW47CgogIF9leHBvcnQoewogICAgdGFyZ2V0OiAiU3RyaW5nIiwKICAgIHByb3RvOiAhMCwKICAgIGZvcmNlZDogIWNvcnJlY3RJc1JlZ2V4cExvZ2ljKCJlbmRzV2l0aCIpCiAgfSwgewogICAgZW5kc1dpdGg6IGZ1bmN0aW9uIGVuZHNXaXRoKHNlYXJjaFN0cmluZykgewogICAgICB2YXIgdGhhdCA9IFN0cmluZyhyZXF1aXJlT2JqZWN0Q29lcmNpYmxlKHRoaXMpKTsKICAgICAgbm90QVJlZ2V4cChzZWFyY2hTdHJpbmcpOwogICAgICB2YXIgZW5kUG9zaXRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHZvaWQgMCwKICAgICAgICAgIGxlbiA9IHRvTGVuZ3RoKHRoYXQubGVuZ3RoKSwKICAgICAgICAgIGVuZCA9IHZvaWQgMCA9PT0gZW5kUG9zaXRpb24gPyBsZW4gOiBtaW4kMih0b0xlbmd0aChlbmRQb3NpdGlvbiksIGxlbiksCiAgICAgICAgICBzZWFyY2ggPSBTdHJpbmcoc2VhcmNoU3RyaW5nKTsKICAgICAgcmV0dXJuIG5hdGl2ZUVuZHNXaXRoID8gbmF0aXZlRW5kc1dpdGguY2FsbCh0aGF0LCBzZWFyY2gsIGVuZCkgOiB0aGF0LnNsaWNlKGVuZCAtIHNlYXJjaC5sZW5ndGgsIGVuZCkgPT09IHNlYXJjaDsKICAgIH0KICB9KTsKCiAgdmFyIGNhbGwgPSBGdW5jdGlvbi5jYWxsLAogICAgICBlbnRyeVVuYmluZCA9IGZ1bmN0aW9uIGVudHJ5VW5iaW5kKENPTlNUUlVDVE9SLCBNRVRIT0QsIGxlbmd0aCkgewogICAgcmV0dXJuIGJpbmRDb250ZXh0KGNhbGwsIGdsb2JhbF8xW0NPTlNUUlVDVE9SXS5wcm90b3R5cGVbTUVUSE9EXSwgbGVuZ3RoKTsKICB9LAogICAgICBlbmRzV2l0aCA9IGVudHJ5VW5iaW5kKCJTdHJpbmciLCAiZW5kc1dpdGgiKSwKICAgICAgaXRlcmF0b3IgPSBlbnRyeVVuYmluZCgiQXJyYXkiLCAidmFsdWVzIiksCiAgICAgIGlzQXJyYXkkMiA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheShhcmcpIHsKICAgIHJldHVybiAiQXJyYXkiID09IGNsYXNzb2ZSYXcoYXJnKTsKICB9LAogICAgICBTUEVDSUVTJDMgPSB3ZWxsS25vd25TeW1ib2woInNwZWNpZXMiKSwKICAgICAgYXJyYXlTcGVjaWVzQ3JlYXRlID0gZnVuY3Rpb24gYXJyYXlTcGVjaWVzQ3JlYXRlKG9yaWdpbmFsQXJyYXksIGxlbmd0aCkgewogICAgdmFyIEM7CiAgICByZXR1cm4gaXNBcnJheSQyKG9yaWdpbmFsQXJyYXkpICYmICgiZnVuY3Rpb24iICE9IHR5cGVvZiAoQyA9IG9yaWdpbmFsQXJyYXkuY29uc3RydWN0b3IpIHx8IEMgIT09IEFycmF5ICYmICFpc0FycmF5JDIoQy5wcm90b3R5cGUpID8gaXNPYmplY3QkMShDKSAmJiBudWxsID09PSAoQyA9IENbU1BFQ0lFUyQzXSkgJiYgKEMgPSB2b2lkIDApIDogQyA9IHZvaWQgMCksIG5ldyAodm9pZCAwID09PSBDID8gQXJyYXkgOiBDKSgwID09PSBsZW5ndGggPyAwIDogbGVuZ3RoKTsKICB9LAogICAgICBwdXNoID0gW10ucHVzaCwKICAgICAgY3JlYXRlTWV0aG9kJDIgPSBmdW5jdGlvbiBjcmVhdGVNZXRob2QkMihUWVBFKSB7CiAgICB2YXIgSVNfTUFQID0gMSA9PSBUWVBFLAogICAgICAgIElTX0ZJTFRFUiA9IDIgPT0gVFlQRSwKICAgICAgICBJU19TT01FID0gMyA9PSBUWVBFLAogICAgICAgIElTX0VWRVJZID0gNCA9PSBUWVBFLAogICAgICAgIElTX0ZJTkRfSU5ERVggPSA2ID09IFRZUEUsCiAgICAgICAgTk9fSE9MRVMgPSA1ID09IFRZUEUgfHwgSVNfRklORF9JTkRFWDsKICAgIHJldHVybiBmdW5jdGlvbiAoJHRoaXMsIGNhbGxiYWNrZm4sIHRoYXQsIHNwZWNpZmljQ3JlYXRlKSB7CiAgICAgIGZvciAodmFyIE8gPSB0b09iamVjdCgkdGhpcyksIHNlbGYgPSBpbmRleGVkT2JqZWN0KE8pLCBib3VuZEZ1bmN0aW9uID0gYmluZENvbnRleHQoY2FsbGJhY2tmbiwgdGhhdCwgMyksIGxlbmd0aCA9IHRvTGVuZ3RoKHNlbGYubGVuZ3RoKSwgaW5kZXggPSAwLCBjcmVhdGUgPSBzcGVjaWZpY0NyZWF0ZSB8fCBhcnJheVNwZWNpZXNDcmVhdGUsIHRhcmdldCA9IElTX01BUCA/IGNyZWF0ZSgkdGhpcywgbGVuZ3RoKSA6IElTX0ZJTFRFUiA/IGNyZWF0ZSgkdGhpcywgMCkgOiB2b2lkIDAsIHZhbHVlLCByZXN1bHQ7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKSB7CiAgICAgICAgaWYgKChOT19IT0xFUyB8fCBpbmRleCBpbiBzZWxmKSAmJiAocmVzdWx0ID0gYm91bmRGdW5jdGlvbih2YWx1ZSA9IHNlbGZbaW5kZXhdLCBpbmRleCwgTyksIFRZUEUpKSBpZiAoSVNfTUFQKSB0YXJnZXRbaW5kZXhdID0gcmVzdWx0O2Vsc2UgaWYgKHJlc3VsdCkgc3dpdGNoIChUWVBFKSB7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIHJldHVybiAhMDsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIHJldHVybiBpbmRleDsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHB1c2guY2FsbCh0YXJnZXQsIHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKElTX0VWRVJZKSByZXR1cm4gITE7CiAgICAgIH0KCiAgICAgIHJldHVybiBJU19GSU5EX0lOREVYID8gLTEgOiBJU19TT01FIHx8IElTX0VWRVJZID8gSVNfRVZFUlkgOiB0YXJnZXQ7CiAgICB9OwogIH0sCiAgICAgIGFycmF5SXRlcmF0aW9uLAogICAgICAkZmluZCA9IHsKICAgIGZvckVhY2g6IGNyZWF0ZU1ldGhvZCQyKDApLAogICAgbWFwOiBjcmVhdGVNZXRob2QkMigxKSwKICAgIGZpbHRlcjogY3JlYXRlTWV0aG9kJDIoMiksCiAgICBzb21lOiBjcmVhdGVNZXRob2QkMigzKSwKICAgIGV2ZXJ5OiBjcmVhdGVNZXRob2QkMig0KSwKICAgIGZpbmQ6IGNyZWF0ZU1ldGhvZCQyKDUpLAogICAgZmluZEluZGV4OiBjcmVhdGVNZXRob2QkMig2KQogIH0uZmluZCwKICAgICAgRklORCA9ICJmaW5kIiwKICAgICAgU0tJUFNfSE9MRVMgPSAhMDsKCiAgRklORCBpbiBbXSAmJiBBcnJheSgxKS5maW5kKGZ1bmN0aW9uICgpIHsKICAgIFNLSVBTX0hPTEVTID0gITE7CiAgfSksIF9leHBvcnQoewogICAgdGFyZ2V0OiAiQXJyYXkiLAogICAgcHJvdG86ICEwLAogICAgZm9yY2VkOiBTS0lQU19IT0xFUwogIH0sIHsKICAgIGZpbmQ6IGZ1bmN0aW9uIGZpbmQoY2FsbGJhY2tmbikgewogICAgICByZXR1cm4gJGZpbmQodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB2b2lkIDApOwogICAgfQogIH0pLCBhZGRUb1Vuc2NvcGFibGVzKEZJTkQpOwogIHZhciBmaW5kID0gZW50cnlVbmJpbmQoIkFycmF5IiwgImZpbmQiKSwKICAgICAgbmF0aXZlQXNzaWduID0gT2JqZWN0LmFzc2lnbiwKICAgICAgb2JqZWN0QXNzaWduID0gIW5hdGl2ZUFzc2lnbiB8fCBmYWlscyhmdW5jdGlvbiAoKSB7CiAgICB2YXIgQSA9IHt9LAogICAgICAgIEIgPSB7fSwKICAgICAgICBzeW1ib2wgPSBTeW1ib2woKSwKICAgICAgICBhbHBoYWJldCA9ICJhYmNkZWZnaGlqa2xtbm9wcXJzdCI7CiAgICByZXR1cm4gQVtzeW1ib2xdID0gNywgYWxwaGFiZXQuc3BsaXQoIiIpLmZvckVhY2goZnVuY3Rpb24gKGNocikgewogICAgICBCW2Nocl0gPSBjaHI7CiAgICB9KSwgNyAhPSBuYXRpdmVBc3NpZ24oe30sIEEpW3N5bWJvbF0gfHwgb2JqZWN0S2V5cyhuYXRpdmVBc3NpZ24oe30sIEIpKS5qb2luKCIiKSAhPSBhbHBoYWJldDsKICB9KSA/IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHNvdXJjZSkgewogICAgZm9yICh2YXIgVCA9IHRvT2JqZWN0KHRhcmdldCksIGFyZ3VtZW50c0xlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsIGluZGV4ID0gMSwgZ2V0T3duUHJvcGVydHlTeW1ib2xzID0gb2JqZWN0R2V0T3duUHJvcGVydHlTeW1ib2xzLmYsIHByb3BlcnR5SXNFbnVtZXJhYmxlID0gb2JqZWN0UHJvcGVydHlJc0VudW1lcmFibGUuZjsgYXJndW1lbnRzTGVuZ3RoID4gaW5kZXg7KSB7CiAgICAgIGZvciAodmFyIFMgPSBpbmRleGVkT2JqZWN0KGFyZ3VtZW50c1tpbmRleCsrXSksIGtleXMgPSBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPyBvYmplY3RLZXlzKFMpLmNvbmNhdChnZXRPd25Qcm9wZXJ0eVN5bWJvbHMoUykpIDogb2JqZWN0S2V5cyhTKSwgbGVuZ3RoID0ga2V5cy5sZW5ndGgsIGogPSAwLCBrZXk7IGxlbmd0aCA+IGo7KSB7CiAgICAgICAga2V5ID0ga2V5c1tqKytdLCBkZXNjcmlwdG9ycyAmJiAhcHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChTLCBrZXkpIHx8IChUW2tleV0gPSBTW2tleV0pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIFQ7CiAgfSA6IG5hdGl2ZUFzc2lnbjsKCiAgX2V4cG9ydCh7CiAgICB0YXJnZXQ6ICJPYmplY3QiLAogICAgc3RhdDogITAsCiAgICBmb3JjZWQ6IE9iamVjdC5hc3NpZ24gIT09IG9iamVjdEFzc2lnbgogIH0sIHsKICAgIGFzc2lnbjogb2JqZWN0QXNzaWduCiAgfSk7CgogIHZhciBhc3NpZ24gPSBwYXRoLk9iamVjdC5hc3NpZ24sCiAgICAgIHByb3BlcnR5SXNFbnVtZXJhYmxlID0gb2JqZWN0UHJvcGVydHlJc0VudW1lcmFibGUuZiwKICAgICAgY3JlYXRlTWV0aG9kJDMgPSBmdW5jdGlvbiBjcmVhdGVNZXRob2QkMyhUT19FTlRSSUVTKSB7CiAgICByZXR1cm4gZnVuY3Rpb24gKGl0KSB7CiAgICAgIGZvciAodmFyIE8gPSB0b0luZGV4ZWRPYmplY3QoaXQpLCBrZXlzID0gb2JqZWN0S2V5cyhPKSwgbGVuZ3RoID0ga2V5cy5sZW5ndGgsIGkgPSAwLCByZXN1bHQgPSBbXSwga2V5OyBsZW5ndGggPiBpOykgewogICAgICAgIGtleSA9IGtleXNbaSsrXSwgZGVzY3JpcHRvcnMgJiYgIXByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoTywga2V5KSB8fCByZXN1bHQucHVzaChUT19FTlRSSUVTID8gW2tleSwgT1trZXldXSA6IE9ba2V5XSk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwogIH0sCiAgICAgIG9iamVjdFRvQXJyYXksCiAgICAgICR2YWx1ZXMgPSB7CiAgICBlbnRyaWVzOiBjcmVhdGVNZXRob2QkMyghMCksCiAgICB2YWx1ZXM6IGNyZWF0ZU1ldGhvZCQzKCExKQogIH0udmFsdWVzOwoKICBfZXhwb3J0KHsKICAgIHRhcmdldDogIk9iamVjdCIsCiAgICBzdGF0OiAhMAogIH0sIHsKICAgIHZhbHVlczogZnVuY3Rpb24gdmFsdWVzKE8pIHsKICAgICAgcmV0dXJuICR2YWx1ZXMoTyk7CiAgICB9CiAgfSk7CgogIHZhciB2YWx1ZXMgPSBwYXRoLk9iamVjdC52YWx1ZXMsCiAgICAgIFVwZGF0ZWRTaG9waWZ5QnV5ID0gZnVuY3Rpb24gKF9TaG9waWZ5QnV5KSB7CiAgICBmdW5jdGlvbiBVcGRhdGVkU2hvcGlmeUJ1eSgpIHsKICAgICAgcmV0dXJuIF9TaG9waWZ5QnV5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKICAgIH0KCiAgICByZXR1cm4gX2luaGVyaXRzTG9vc2UoVXBkYXRlZFNob3BpZnlCdXksIF9TaG9waWZ5QnV5KSwgVXBkYXRlZFNob3BpZnlCdXkuYnVpbGRDbGllbnQgPSBmdW5jdGlvbiBidWlsZENsaWVudChjb25maWcpIHsKICAgICAgdmFyIG5ld0NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZywgewogICAgICAgIHNvdXJjZTogImJ1eS1idXR0b24tanMiCiAgICAgIH0pOwogICAgICByZXR1cm4gX1Nob3BpZnlCdXkuYnVpbGRDbGllbnQuY2FsbCh0aGlzLCBuZXdDb25maWcpOwogICAgfSwgVXBkYXRlZFNob3BpZnlCdXk7CiAgfShzaG9waWZ5QnV5KTsKCiAgcmV0dXJuIHdpbmRvdy5TaG9waWZ5QnV5ID0gd2luZG93LlNob3BpZnlCdXkgfHwgVXBkYXRlZFNob3BpZnlCdXksIFVwZGF0ZWRTaG9waWZ5QnV5LlVJID0gd2luZG93LlNob3BpZnlCdXkuVUkgfHwgewogICAgZG9tYWluczoge30sCiAgICBpbml0OiBmdW5jdGlvbiBpbml0KGNsaWVudCkgewogICAgICB2YXIgaW50ZWdyYXRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMV0gPyBhcmd1bWVudHNbMV0gOiB7fSwKICAgICAgICAgIHN0eWxlT3ZlcnJpZGVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB2b2lkIDAsCiAgICAgICAgICB1bmlxdWVDbGllbnRLZXkgPSAiIi5jb25jYXQoY2xpZW50LmNvbmZpZy5kb21haW4sICIuIikuY29uY2F0KGNsaWVudC5jb25maWcuc3RvcmVmcm9udEFjY2Vzc1Rva2VuKTsKICAgICAgcmV0dXJuIHRoaXMuZG9tYWluc1t1bmlxdWVDbGllbnRLZXldIHx8ICh0aGlzLmRvbWFpbnNbdW5pcXVlQ2xpZW50S2V5XSA9IG5ldyBVSShjbGllbnQsIGludGVncmF0aW9ucywgc3R5bGVPdmVycmlkZXMpKSwgdGhpcy5kb21haW5zW3VuaXF1ZUNsaWVudEtleV07CiAgICB9LAogICAgYWRhcHRlckhlbHBlcnM6IHsKICAgICAgdGVtcGxhdGVzOiB7CiAgICAgICAgcHJvZHVjdDogcHJvZHVjdFRlbXBsYXRlCiAgICAgIH0KICAgIH0KICB9LCBVcGRhdGVkU2hvcGlmeUJ1eTsKfSgpOw=="},null]}