{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Customer Support/CustomerTicketing.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Customer Support/CustomerTicketing.vue","mtime":1645594423483},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwppbXBvcnQgU3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb21wYW55bmFtZTogbnVsbCwKICAgICAgY29tcGFueWlkOiBudWxsLAogICAgICBzcGlubmVyT246IGZhbHNlLAogICAgICB0aWNrZXRfbGlzdDogW10sCiAgICAgIHBhZ2Vfbm86IDEsCiAgICAgIHBlcl9wYWdlOiAxMCwKICAgICAgcGFnZV9hcnJheTogW10sCiAgICAgIHRvdGFsX3BhZ2VzOiBudWxsLAogICAgICBudW1iZXJfb2Zfcm93czogbnVsbCwKICAgICAgaXNFZGl0OiBmYWxzZSwKICAgICAgQ29tbWVudHNfbGlzdDogW10sCiAgICAgIGNvbW1lbnRfaXRlbV9saXN0OiBbXSwKICAgICAgdGlja2V0X251bWJlcjogIiIsCiAgICAgIGN1cnJlbnRfc2VsZWN0ZWRfdGlja2V0X251bWJlcjogIiIsCiAgICAgIG5ld190aWNrZXRfY29tbWVudDogIiIsCiAgICAgIGN1cnJlbnRfaW1hZ2VfbmFtZV9pbl9jb21tZW50OiAiIiwKICAgICAgSW1hZ2VzX2luX2N1cnJlbnRfY29tbWVudDogIiIsCiAgICAgIG5ld19pbWFnZV9uYW1lOiAiIiwKICAgICAgbmV3X2ltYWdlX2ZpbGU6ICIiLAogICAgICBpbWFnZV9maWxlOiAiIiwKICAgICAgdGlja2V0X2lzc3VlX25hbWU6ICIiLAogICAgICB0aWNrZXRfc3RhdHVzOiAiIiwKICAgICAgaXNzdWVfbmFtZTogIiIsCiAgICAgIGlzc3VlX2Rlc2NyaXB0aW9uOiAiIiwKICAgICAgaXNzdWVfY29tbWVudDogIiIsCiAgICAgIGZpbGVfbGFiZWw6ICJDaG9vc2UgZmlsZSIsCiAgICAgIGlzX3N0YXR1czogbnVsbCwKICAgICAgc2hvd190aWNrZXRfc3RhdHVzOiAiT3BlbiIsCiAgICAgIGN1cnJlbnRfc3RhdHVzOiAiIiwKICAgICAgaXNfc3RhdHVzX2Nsb3NlZDogZmFsc2UsCiAgICAgIGN1cnJlbnRfdGlja2V0X2Rlc2NyaXB0aW9uOiAiIiwKICAgICAgc2VhcmNoX2tleTogIiIsCiAgICAgIGlzVmlzaWJsZVNlYXJjaENsZWFyOiBmYWxzZQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBpc19zZW5kX2J0bl9lbmFibGU6IGZ1bmN0aW9uIGlzX3NlbmRfYnRuX2VuYWJsZSgpIHsKICAgICAgaWYgKEJvb2xlYW4odGhpcy5uZXdfdGlja2V0X2NvbW1lbnQgfHwgdGhpcy5uZXdfaW1hZ2VfbmFtZSkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBpc19yZW9wZW5fYnRuX2VuYWJsZTogZnVuY3Rpb24gaXNfcmVvcGVuX2J0bl9lbmFibGUoKSB7CiAgICAgIGlmIChCb29sZWFuKHRoaXMubmV3X3RpY2tldF9jb21tZW50IHx8IHRoaXMubmV3X2ltYWdlX25hbWUpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgc2VhcmNoX2tleTogZnVuY3Rpb24gc2VhcmNoX2tleSgpIHsKICAgICAgaWYgKHRoaXMuc2VhcmNoX2tleSA9PT0gIiIpIHsKICAgICAgICB0aGlzLnRpY2tldF9zdGF0dXNfZHJvcGRvd24oKTsKICAgICAgICB0aGlzLmlzVmlzaWJsZVNlYXJjaENsZWFyID0gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWFyY2hfa2V5ICE9PSAiIikgewogICAgICAgIHRoaXMuaXNWaXNpYmxlU2VhcmNoQ2xlYXIgPSB0cnVlOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgaWYgKCF0aGlzLiRzZXNzaW9uLmhhcygiQ29tcGFueUlkIikgJiYgdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUgPT0gIlN1cGVyQWRtaW4iKSB7CiAgICAgIHRvYXN0ci53YXJuaW5nKCJQbGVhc2Ugc2VsZWN0IGEgY29tcGFueSBuYW1lIGZyb20gdGhlIGRyb3Bkb3duIik7CiAgICB9IGVsc2UgaWYgKHRoaXMudXNlcl9yb2xlID09ICJTdXBlckFkbWluIikgewogICAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpKSB7CiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiQ29tcGFueUlkIik7CiAgICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55TmFtZSIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQ7CiAgICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQ7CiAgICAgIHRoaXMuY29tcGFueW5hbWUgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIC8vICQoJy5tb2RhbCcpLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbigpewogICAgLy8gICAkKCJbZGF0YS1kaXNtaXNzPW1vZGFsXSIpLnRyaWdnZXIoeyB0eXBlOiAiY2xpY2siIH0pOwogICAgLy8gfSk7CiAgICB0aGlzLnRpY2tldF9zdGF0dXNfZHJvcGRvd24oKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHRpY2tldF9zdGF0dXNfZHJvcGRvd246IGZ1bmN0aW9uIHRpY2tldF9zdGF0dXNfZHJvcGRvd24oKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5zaG93X3RpY2tldF9zdGF0dXMgIT0gIiIpIHsKICAgICAgICB0aGlzLmlzX3N0YXR1cyA9IHRoaXMuc2hvd190aWNrZXRfc3RhdHVzOwogICAgICB9CgogICAgICB0aGlzLnRpY2tldF9saXN0ID0gW107CiAgICAgIHRoaXMucGFnZV9ubyA9IDE7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3VwcG9ydF90aWNrZXQoKSwgewogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgIGZpbHRlcl9ieTogdGhpcy5pc19zdGF0dXMsCiAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZQogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNUZXh0ID09ICJPSyIgJiYgcmVzcG9uc2UuZGF0YS5UaWNrZXRzICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgX3RoaXMubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLkNvdW50OwogICAgICAgICAgX3RoaXMudG90YWxfcGFnZXMgPSBNYXRoLmNlaWwoX3RoaXMubnVtYmVyX29mX3Jvd3MgLyBfdGhpcy5wZXJfcGFnZSk7CiAgICAgICAgICBfdGhpcy50aWNrZXRfbGlzdCA9IHJlc3BvbnNlLmRhdGEuVGlja2V0czsKICAgICAgICAgIF90aGlzLnBhZ2Vfbm8gPSAxOwogICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09ICJubyBleGlzdGluZyB0aWNrZXQgZm91bmQiKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogIk5vIHRpY2tldHMgZm91bmQiLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09ICJFcnJvciIpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRleHQ6ICJTb21lIGVycm9yIGhhcyBvY2N1cmVkLiBQbGVhc2UgdHJ5IGFnYWluICIsCiAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHRleHQ6ICJUaGVyZSB3YXMgYW4gaW50ZXJuYWwgc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIF90aGlzLnNldHBhZ2luYXRpb24oX3RoaXMucGFnZV9ubyk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXMuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICB0cmltX3RpY2tldF9pc3N1ZV9uYW1lOiBmdW5jdGlvbiB0cmltX3RpY2tldF9pc3N1ZV9uYW1lKG5hbWUpIHsKICAgICAgaWYgKG5hbWUubGVuZ3RoID4gNDApIHsKICAgICAgICB2YXIgc3RyaW5nX25hbWUgPSBuYW1lLnN1YnN0cmluZygwLCAzMCkgKyAiLi4uIjsKICAgICAgICByZXR1cm4gc3RyaW5nX25hbWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBuYW1lOwogICAgfSwKICAgIC8vIHRyaW1fdGlja2V0X2Rlc2NyaXB0aW9uKGRlc19uYW1lKSB7CiAgICAvLyAgIGlmIChkZXNfbmFtZS5sZW5ndGggPiA2MCkgewogICAgLy8gICAgIGxldCB0aWNrZXRfZGVzX25hbWUgPSBkZXNfbmFtZS5zdWJzdHJpbmcoMCwgNTApICsgIi4uLiI7CiAgICAvLyAgICAgcmV0dXJuIHRpY2tldF9kZXNfbmFtZTsKICAgIC8vICAgfQogICAgLy8gICByZXR1cm4gZGVzX25hbWU7CiAgICAvLyB9LAogICAgZGF0ZV9mb3JtYXRpbmc6IGZ1bmN0aW9uIGRhdGVfZm9ybWF0aW5nKHN1Yl9kYXRlKSB7CiAgICAgIHJldHVybiBtb21lbnQoc3ViX2RhdGUpLmZvcm1hdCgiRCBNTU0gWVlZWSBISDptbSBhIik7CiAgICB9LAogICAgY2xlYXJfc2VhcmNoX25hbWU6IGZ1bmN0aW9uIGNsZWFyX3NlYXJjaF9uYW1lKCkgewogICAgICB0aGlzLnNlYXJjaF9rZXkgPSAiIjsKICAgIH0sCiAgICBvcGVuX2NvbW1lbnRfbW9kZWw6IGZ1bmN0aW9uIG9wZW5fY29tbWVudF9tb2RlbChpbmRleCkgewogICAgICB0aGlzLkNvbW1lbnRzX2xpc3QgPSBbXTsKICAgICAgdGhpcy5Db21tZW50c19saXN0ID0gQm9vbGVhbih0aGlzLnRpY2tldF9saXN0W2luZGV4XS5Db21tZW50cykgPyB0aGlzLnRpY2tldF9saXN0W2luZGV4XS5Db21tZW50cyA6IFtdOwogICAgICB0aGlzLmN1cnJlbnRfc2VsZWN0ZWRfdGlja2V0X251bWJlciA9IHRoaXMudGlja2V0X2xpc3RbaW5kZXhdLlRpY2tldE51bWJlcjsKICAgICAgdGhpcy50aWNrZXRfaXNzdWVfbmFtZSA9IHRoaXMudGlja2V0X2xpc3RbaW5kZXhdLlRpY2tldElzc3VlOwogICAgICB0aGlzLnRpY2tldF9zdGF0dXMgPSB0aGlzLnRpY2tldF9saXN0W2luZGV4XS5DdXJyZW50U3RhdHVzOwogICAgICB0aGlzLmN1cnJlbnRfdGlja2V0X2Rlc2NyaXB0aW9uID0gdGhpcy50aWNrZXRfbGlzdFtpbmRleF0uRGVzY3JpcHRpb247CgogICAgICBpZiAodGhpcy50aWNrZXRfc3RhdHVzID09PSAiQ2xvc2VkIikgewogICAgICAgIHRoaXMuaXNfc3RhdHVzX2Nsb3NlZCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc19zdGF0dXNfY2xvc2VkID0gZmFsc2U7CiAgICAgIH0gLy90aGlzLmN1cnJlbnRfaW1hZ2VfbmFtZSA9IHRoaXMuQ29tbWVudHNfbGlzdFtpbmRleF0uaW1hZ2VfbmFtZTsKCgogICAgICB0aGlzLmN1cnJlbnRfc3RhdHVzID0gdGhpcy50aWNrZXRfbGlzdFtpbmRleF0uQ3VycmVudFN0YXR1czsKICAgIH0sCiAgICByZW9wZW5fY29tbWVudDogZnVuY3Rpb24gcmVvcGVuX2NvbW1lbnQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMubmV3X3RpY2tldF9jb21tZW50ICE9ICIiKSB7CiAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnN1cHBvcnRfdGlja2V0KCksIHsKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgaXNfZWRpdDogdHJ1ZSwKICAgICAgICAgIHJlb3BlbjogdHJ1ZSwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICByZXNwb25zZTogewogICAgICAgICAgICB0aWNrZXRfbnVtYmVyOiB0aGlzLmN1cnJlbnRfc2VsZWN0ZWRfdGlja2V0X251bWJlciwKICAgICAgICAgICAgbmV3X2NvbW1lbnQ6IHRoaXMubmV3X3RpY2tldF9jb21tZW50LAogICAgICAgICAgICB0aWNrZXRfaW1nX25hbWU6IHRoaXMubmV3X2ltYWdlX25hbWUgPyB0aGlzLm5ld19pbWFnZV9uYW1lIDogbnVsbCwKICAgICAgICAgICAgdGlja2V0X2ltZ19maWxlOiB0aGlzLmltYWdlX2ZpbGUgPyB0aGlzLmltYWdlX2ZpbGUgOiBudWxsCiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczIuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PT0gIlRpY2tldCBVcGRhdGVkIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgdGV4dDogIlRpY2tldCBzdGF0dXMgdXBkYXRlZCBTdWNjZXNzZnVsbHkuIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICBfdGhpczIuZW1wdHlfdmFyaWFibGUoKTsKCiAgICAgICAgICAgICAgJCgiI215TW9kYWwiKS5tb2RhbCgiaGlkZSIpOwoKICAgICAgICAgICAgICBpZiAoX3RoaXMyLnNlYXJjaF9rZXkgIT0gIiIpIHsKICAgICAgICAgICAgICAgIF90aGlzMi5zZWFyY2hfa2V5ID0gIiI7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczIudGlja2V0X3N0YXR1c19kcm9wZG93bigpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YSA9PSAiRHVwbGljYXRlIGltYWdlIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiAiSW1hZ2UgYWxyZWFkeSBmb3VuZC4gUGxlYXNlIHVwbG9hZCBhbm90aGVyIGltYWdlIG9yIHJlbmFtZSBpdC4iLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgdGltZXI6IDMwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAiREIgT1BFUkFUSU9OIFVOU1VDQ0VTU0ZVTCIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogIlNvbWUgZXJyb3Igb2NjdXJyZWQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuIiwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRpbWVyOiAzMDAwCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgX3RoaXMyLmVtcHR5X3ZhcmlhYmxlKCk7CgogICAgICAgICAgICAkKCIjbXlNb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09ICJFcnJvciIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0ZXh0OiAiU29tZSBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICAgIH0pOyAvLyQoIiNteU1vZGFsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgLy90aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRleHQ6ICJUaGVyZSB3YXMgYW4gaW50ZXJuYWwgc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIF90aGlzMi5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXMyLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXMyLmVtcHR5X3ZhcmlhYmxlKCk7CgogICAgICAgICAgICAkKCIjbXlNb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgdGV4dDogIlRoZXJlIHdhcyBhbiBpbnRlcm5hbCBzZXJ2ZXIgZXJyb3IuIFBsZWFzZSB0cnkgYWdhaW4uIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHt9CiAgICB9LAogICAgb3Blbl9pbWFnZV9tb2RlbDogZnVuY3Rpb24gb3Blbl9pbWFnZV9tb2RlbChpbmRleCkgewogICAgICBpZiAodGhpcy5Db21tZW50c19saXN0W2luZGV4XS5pbWFnZV91cmwgIT0gbnVsbCkgewogICAgICAgIHRoaXMuSW1hZ2VzX2luX2N1cnJlbnRfY29tbWVudCA9IHRoaXMuQ29tbWVudHNfbGlzdFtpbmRleF0uaW1hZ2VfdXJsOwogICAgICAgIHRoaXMuY3VycmVudF9pbWFnZV9uYW1lX2luX2NvbW1lbnQgPSB0aGlzLkNvbW1lbnRzX2xpc3RbaW5kZXhdLmltYWdlX25hbWU7CiAgICAgIH0KICAgIH0sCiAgICBVcGxvYWRfaW1hZ2VfZmlsZTogZnVuY3Rpb24gVXBsb2FkX2ltYWdlX2ZpbGUoZXZlbnQpIHsKICAgICAgdmFyIGZpbGVzID0gZXZlbnQudGFyZ2V0LmZpbGVzIHx8IGUuZGF0YVRyYW5zZmVyLmZpbGVzOwoKICAgICAgaWYgKGZpbGVzWzBdLnNpemUgPiAyMDk3MTUyKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiAiVXBsb2FkIGltYWdlIHdpdGggc2l6ZSBsZXNzIHRoYW4gMk1CIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMTAwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMubmV3X2ltYWdlX25hbWUgPSBldmVudC50YXJnZXQuZmlsZXNbMF0ubmFtZTsKICAgICAgdGhpcy5uZXdfaW1hZ2VfZmlsZSA9IGV2ZW50LnRhcmdldC5maWxlc1swXS50eXBlOwoKICAgICAgaWYgKHRoaXMubmV3X2ltYWdlX25hbWUgIT0gdGhpcy5jdXJyZW50X2ltYWdlX25hbWVfaW5fY29tbWVudCkge30KCiAgICAgIGlmICh0aGlzLm5ld19pbWFnZV9maWxlID09ICJpbWFnZS9wbmciKSB7CiAgICAgICAgdGhpcy5jcmVhdGVJbWFnZShmaWxlc1swXSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5uZXdfaW1hZ2VfZmlsZSA9PSAiaW1hZ2UvanBlZyIpIHsKICAgICAgICB0aGlzLmNyZWF0ZUltYWdlKGZpbGVzWzBdKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLm5ld19pbWFnZV9maWxlID09ICJpbWFnZS9qcGciKSB7CiAgICAgICAgdGhpcy5jcmVhdGVJbWFnZShmaWxlc1swXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGV4dDogIlBsZWFzZSBTZWxlY3QgYW4gSW1hZ2Ugb2YgdHlwZSBQTkcgb3IgSlBFRyIsCiAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlSW1hZ2U6IGZ1bmN0aW9uIGNyZWF0ZUltYWdlKGZpbGUsIHR5cGUpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCiAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMy5pbWFnZV9maWxlID0gZS50YXJnZXQucmVzdWx0LnNwbGl0KCJiYXNlNjQsIilbMV07CiAgICAgIH07CgogICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgIH0sCiAgICBTZW5kX3RpY2tldF9jb21tZW50czogZnVuY3Rpb24gU2VuZF90aWNrZXRfY29tbWVudHMoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMubmV3X3RpY2tldF9jb21tZW50ICE9ICIiIHx8IHRoaXMubmV3X2ltYWdlX25hbWUgIT0gIiIgJiYgdGhpcy5uZXdfaW1hZ2VfZmlsZSAhPSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogIlBsZWFzZSB3YWl0IHdoaWxlIHdlIGFyZSBhZGRpbmcgeW91ciB0aWNrZXQgY29tbWVudHMuLi4iLAogICAgICAgICAgdHlwZTogImluZm8iLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UKICAgICAgICB9KTsKICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3VwcG9ydF90aWNrZXQoKSwgewogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICBpc19lZGl0OiB0cnVlLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHJlc3BvbnNlOiB7CiAgICAgICAgICAgIHRpY2tldF9udW1iZXI6IHRoaXMuY3VycmVudF9zZWxlY3RlZF90aWNrZXRfbnVtYmVyLAogICAgICAgICAgICBuZXdfY29tbWVudDogdGhpcy5uZXdfdGlja2V0X2NvbW1lbnQgPyB0aGlzLm5ld190aWNrZXRfY29tbWVudCA6IG51bGwsCiAgICAgICAgICAgIHRpY2tldF9pbWdfbmFtZTogdGhpcy5uZXdfaW1hZ2VfbmFtZSA/IHRoaXMubmV3X2ltYWdlX25hbWUgOiBudWxsLAogICAgICAgICAgICB0aWNrZXRfaW1nX2ZpbGU6IHRoaXMuaW1hZ2VfZmlsZSA/IHRoaXMuaW1hZ2VfZmlsZSA6IG51bGwKICAgICAgICAgIH0gLy8gcGFnZW5vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAvLyBwZXJwYWdlOiB0aGlzLnBlcl9wYWdlLAoKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzNC5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09PSAiVGlja2V0IFVwZGF0ZWQiKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0ZXh0OiAiWW91ciBDb21tZW50cyBoYXMgYmVlbiBhZGRlZCBTdWNjZXNzZnVsbHkuIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICBfdGhpczQuZW1wdHlfdmFyaWFibGUoKTsgLy8gJCgiI2J0bi1jbG9zZS1jb21tZW50IikuY2xpY2soKTsKCgogICAgICAgICAgICAgICQoIiNteU1vZGFsIikubW9kYWwoImhpZGUiKTsKCiAgICAgICAgICAgICAgaWYgKF90aGlzNC5zZWFyY2hfa2V5ICE9ICIiKSB7CiAgICAgICAgICAgICAgICBfdGhpczQuc2VhcmNoX2tleSA9ICIiOwogICAgICAgICAgICAgIH0gLy8gJCgnYm9keScpLnJlbW92ZUNsYXNzKCdtb2RhbC1vcGVuJyk7CiAgICAgICAgICAgICAgLy8gJCgnLm1vZGFsLWJhY2tkcm9wJykucmVtb3ZlKCk7CgoKICAgICAgICAgICAgICBfdGhpczQudGlja2V0X3N0YXR1c19kcm9wZG93bigpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YSA9PSAiRHVwbGljYXRlIGltYWdlIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiAiSW1hZ2UgYWxyZWFkeSBmb3VuZC4gUGxlYXNlIHVwbG9hZCBhbm90aGVyIGltYWdlIG9yIHJlbmFtZSBpdC4iLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgdGltZXI6IDMwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09ICJFcnJvciIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0ZXh0OiAiU29tZSBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICAgIH0pOyAvLyQoIiNteU1vZGFsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgLy90aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRleHQ6ICJUaGVyZSB3YXMgYW4gaW50ZXJuYWwgc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIF90aGlzNC5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXM0LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXM0LmVtcHR5X3ZhcmlhYmxlKCk7CgogICAgICAgICAgICAkKCIjbXlNb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgdGV4dDogIlRoZXJlIHdhcyBhbiBpbnRlcm5hbCBzZXJ2ZXIgZXJyb3IuIFBsZWFzZSB0cnkgYWdhaW4uIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHRpY2tldF9zdWJtaXQ6IGZ1bmN0aW9uIHRpY2tldF9zdWJtaXQoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKCiAgICAgIGlmICh0aGlzLmlzc3VlX25hbWUgPT0gIiIpIHsKICAgICAgICB0b2FzdHIud2FybmluZygiUGxlYXNlIGVudGVyIHRoZSB0aWNrZXQgaXNzdWUiKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzc3VlX2Rlc2NyaXB0aW9uID09ICIiKSB7CiAgICAgICAgdG9hc3RyLndhcm5pbmcoIlBsZWFzZSBlbnRlciB0aGUgYnJpZWYgZGVzY3JpcHRpb24gb2YgYW4gaXNzdWUiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiAiUGxlYXNlIHdhaXQgd2hpbGUgd2UgYXJlIHN1Ym1pdHRpbmcgeW91ciB0aWNrZXQgZGV0YWlscy4uLiIsCiAgICAgICAgICB0eXBlOiAiaW5mbyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnN1cHBvcnRfdGlja2V0KCksIHsKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgaXNfc2F2ZTogdHJ1ZSwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICByZXNwb25zZTogewogICAgICAgICAgICB0aWNrZXRfaW1nX25hbWU6IHRoaXMuZmlsZV9sYWJlbCA9PSAiQ2hvb3NlIGZpbGUiID8gbnVsbCA6IHRoaXMuZmlsZV9sYWJlbCwKICAgICAgICAgICAgdGlja2V0X2ltZ19maWxlOiB0aGlzLmltZ19maWxlID8gdGhpcy5pbWdfZmlsZSA6IG51bGwsCiAgICAgICAgICAgIG5ld19jb21tZW50OiB0aGlzLmlzc3VlX2NvbW1lbnQgPyB0aGlzLmlzc3VlX2NvbW1lbnQgOiBudWxsLAogICAgICAgICAgICB0aWNrZXRfaXNzdWU6IHRoaXMuaXNzdWVfbmFtZSwKICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuaXNzdWVfZGVzY3JpcHRpb24KICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzNS5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09ICJUaWNrZXQgQ3JlYXRlZCIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogIllvdXIgdGlja2V0IGhhcyBiZWVuIGFkZGVkIHN1Y2Nlc3NmdWxseS4iLAogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgJCgiI3RpY2tldG1vZGFsIikubW9kYWwoImhpZGUiKTsKCiAgICAgICAgICAgIF90aGlzNS5jbGVhcl9maWVsZHMoKTsKCiAgICAgICAgICAgIF90aGlzNS50aWNrZXRfc3RhdHVzX2Ryb3Bkb3duKCk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIkR1cGxpY2F0ZSBpbWFnZSIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogIkltYWdlIGFscmVhZHkgZm91bmQuIFBsZWFzZSB1cGxvYWQgYW5vdGhlciBpbWFnZSBvciByZW5hbWUgaXQuIiwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRpbWVyOiAzMDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT0gIkRCIE9QRVJBVElPTiBVTlNVQ0NFU1NGVUwiKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJTb21lIGVycm9yIG9jY3VycmVkLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLiIsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0aW1lcjogMzAwMAogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIF90aGlzNS5jbGVhcl9maWVsZHMoKTsKCiAgICAgICAgICAgICQoIiN0aWNrZXRtb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09ICJFcnJvciIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0ZXh0OiAiU29tZSBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICAgIH0pOyAvLyQoIiN0aWNrZXRtb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgIC8vdGhpcy5jbGVhcl9maWVsZHMoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICQoIiN0aWNrZXRtb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgdGV4dDogIlRoZXJlIHdhcyBhbiBpbnRlcm5hbCBzZXJ2ZXIgZXJyb3IuIFBsZWFzZSB0cnkgYWdhaW4uIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgX3RoaXM1LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICBfdGhpczUuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRleHQ6ICJUaGVyZSB3YXMgYW4gaW50ZXJuYWwgc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBfdGhpczUuY2xlYXJfZmllbGRzKCk7CgogICAgICAgICAgICAkKCIjdGlja2V0bW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY2FsbHNlYXJjaDogZnVuY3Rpb24gY2FsbHNlYXJjaCgpIHsKICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7CiAgICAgICAgaWYgKHRoaXMuaXNFZGl0SW50ZW50KSB7CiAgICAgICAgICB0aGlzLnZlcmlmeV9jaGFuZ2VzKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc2VhcmNoX3RpY2tldCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNlYXJjaF90aWNrZXQ6IGZ1bmN0aW9uIHNlYXJjaF90aWNrZXQoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuc2VhcmNoX2tleSAhPSAiIikgewogICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5zdXBwb3J0X3RpY2tldCgpLCB7CiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgIGlzX3NlYXJjaDogdHJ1ZSwKICAgICAgICAgIHNlYXJjaF9rZXk6IHRoaXMuc2VhcmNoX2tleSwKICAgICAgICAgIGZpbHRlcl9ieTogdGhpcy5pc19zdGF0dXMsCiAgICAgICAgICBwYWdlX25vOiAxLAogICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzNi5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5SZXNwb25zZUxpc3QgIT0gbnVsbCkgewogICAgICAgICAgICBfdGhpczYudGlja2V0X2xpc3QgPSBbXTsKICAgICAgICAgICAgX3RoaXM2LnBhZ2Vfbm8gPSAxOwogICAgICAgICAgICBfdGhpczYubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLkNvdW50OwogICAgICAgICAgICBfdGhpczYudG90YWxfcGFnZXMgPSBNYXRoLmNlaWwoX3RoaXM2Lm51bWJlcl9vZl9yb3dzIC8gX3RoaXM2LnBlcl9wYWdlKTsKICAgICAgICAgICAgX3RoaXM2LnRpY2tldF9saXN0ID0gcmVzcG9uc2UuZGF0YS5SZXNwb25zZUxpc3Q7CgogICAgICAgICAgICBfdGhpczYuc2V0cGFnaW5hdGlvbihfdGhpczYucGFnZV9ubyk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJTZWFyY2gga2V5IHJlcXVpcmVkIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRleHQ6ICJQbGVhc2UgZW50ZXIgdGhlIGtleSB0byBzZWFyY2guIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIkludGVybmFsIFNlcnZlciBFcnJvciIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0ZXh0OiAiU29tZSBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgX3RoaXM2LnRpY2tldF9zdGF0dXNfZHJvcGRvd24oKTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIk5vIFJlc3VsdHMgRm91bmQiKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJObyBSZXN1bHRzIEZvdW5kIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDIwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRleHQ6ICJUaGVyZSB3YXMgYW4gaW50ZXJuYWwgc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIF90aGlzNi5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXM2LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogIlBsZWFzZSB0eXBlIHNvbWV0aGluZyBpbiB0aGUgc2VhcmNoIGJhciIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgcGFnZV9yZXF1aXJlOiBmdW5jdGlvbiBwYWdlX3JlcXVpcmUocGFnZSkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIGlmIChwYWdlID09IDAgfHwgcGFnZSA9PSB0aGlzLnRvdGFsX3BhZ2VzICsgMSkge30gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuc2VhcmNoX2tleSA9PSAiIikgewogICAgICAgICAgaWYgKHBhZ2UgPT0gIi4uLnMiKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgoMSArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICAgIH0gZWxzZSBpZiAocGFnZSA9PSAiLi4ubCIpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCh0aGlzLnRvdGFsX3BhZ2VzICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gcGFnZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5zdXBwb3J0X3RpY2tldCgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgIGlzX2dldDogdHJ1ZSwKICAgICAgICAgICAgZmlsdGVyX2J5OiB0aGlzLmlzX3N0YXR1cywKICAgICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZQogICAgICAgICAgfSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXM3LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c1RleHQgPT0gIk9LIikgewogICAgICAgICAgICAgIF90aGlzNy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEuQ291bnQ7CiAgICAgICAgICAgICAgX3RoaXM3LnRvdGFsX3BhZ2VzID0gTWF0aC5jZWlsKF90aGlzNy5udW1iZXJfb2Zfcm93cyAvIF90aGlzNy5wZXJfcGFnZSk7CiAgICAgICAgICAgICAgX3RoaXM3LnRpY2tldF9saXN0ID0gcmVzcG9uc2UuZGF0YS5UaWNrZXRzOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAibm8gZXhpc3RpbmcgdGlja2V0IGZvdW5kIikgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogIk5vIHRpY2tldHMgZm91bmQiLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLk1TRyA9PSAiTm8gUmVzdWx0cyBGb3VuZCIpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIHRleHQ6ICJObyB0aWNrZXQgZm91bmQuIiwKICAgICAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIlNlYXJjaCBrZXkgcmVxdWlyZWQiKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICB0ZXh0OiAiTm8gdGlja2V0IGZvdW5kLiIsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgIHRleHQ6ICJUaGVyZSB3YXMgYW4gaW50ZXJuYWwgc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczcuc2V0cGFnaW5hdGlvbihfdGhpczcucGFnZV9ubyk7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBfdGhpczcuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICBfdGhpczcuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAodGhpcy5wYWdlbm8gPT0gIi4uLnMiKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgoMSArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wYWdlbm8gPT0gIi4uLmwiKSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgodGhpcy50b3RhbF9wYWdlcyArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHRoaXMucGFnZW5vOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnN1cHBvcnRfdGlja2V0KCksIHsKICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgICAgICAgaXNfZ2V0OiB0cnVlLAogICAgICAgICAgICBmaWx0ZXJfYnk6IHRoaXMuaXNfc3RhdHVzLAogICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczcuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzVGV4dCA9PSAiT0siKSB7CiAgICAgICAgICAgICAgX3RoaXM3Lm51bWJlcl9vZl9yb3dzID0gcmVzcG9uc2UuZGF0YS5Db3VudDsKICAgICAgICAgICAgICBfdGhpczcudG90YWxfcGFnZXMgPSBNYXRoLmNlaWwoX3RoaXM3Lm51bWJlcl9vZl9yb3dzIC8gX3RoaXM3LnBlcl9wYWdlKTsKICAgICAgICAgICAgICBfdGhpczcudGlja2V0X2xpc3QgPSByZXNwb25zZS5kYXRhLlRpY2tldHM7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09ICJubyBleGlzdGluZyB0aWNrZXQgZm91bmQiKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiAiTm8gdGlja2V0cyBmb3VuZCIsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgIHRleHQ6ICJUaGVyZSB3YXMgYW4gaW50ZXJuYWwgc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczcuc2V0cGFnaW5hdGlvbihfdGhpczcucGFnZV9ubyk7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBfdGhpczcuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICBfdGhpczcuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNldHBhZ2luYXRpb246IGZ1bmN0aW9uIHNldHBhZ2luYXRpb24ocGFnZV9ubykgewogICAgICB0aGlzLnBhZ2VfYXJyYXkgPSBbXTsKCiAgICAgIGlmICh0aGlzLnRvdGFsX3BhZ2VzIDw9IDcpIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudG90YWxfcGFnZXM7IGkrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IDEpIHsKICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgNDsgX2krKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2kgKyAxKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSB0aGlzLnRvdGFsX3BhZ2VzKSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKCiAgICAgICAgZm9yICh2YXIgX2kyID0gdGhpcy50b3RhbF9wYWdlcyAtIDQ7IF9pMiA8IHRoaXMudG90YWxfcGFnZXM7IF9pMisrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTIgKyAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA8PSA0KSB7CiAgICAgICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgcGFnZV9ubyArIDM7IF9pMysrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTMgKyAxKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA+PSB0aGlzLnRvdGFsX3BhZ2VzIC0gNCkgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CgogICAgICAgIGZvciAodmFyIF9pNCA9IHBhZ2Vfbm8gLSA0OyBfaTQgPCB0aGlzLnRvdGFsX3BhZ2VzOyBfaTQrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2k0ICsgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CgogICAgICAgIGZvciAodmFyIF9pNSA9IHBhZ2Vfbm8gLSAzOyBfaTUgPD0gcGFnZV9ubyArIDM7IF9pNSsrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTUpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfQogICAgfSwKICAgIHBhZ2luYXRpb25fY2xhc3M6IGZ1bmN0aW9uIHBhZ2luYXRpb25fY2xhc3MoaW5kZXgpIHsKICAgICAgaWYgKGluZGV4ID09IHRoaXMucGFnZV9ubykgewogICAgICAgIHJldHVybiAiIGFjdGl2ZSI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICB9LAogICAgZmlsZWlucHV0OiBmdW5jdGlvbiBmaWxlaW5wdXQoZSkgewogICAgICB2YXIgZmlsZXMgPSBlLnRhcmdldC5maWxlcyB8fCBlLmRhdGFUcmFuc2Zlci5maWxlczsKCiAgICAgIGlmIChmaWxlc1swXS5zaXplID4gMjA5NzE1MikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogIlVwbG9hZCBpbWFnZSB3aXRoIHNpemUgbGVzcyB0aGFuIDJNQiIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDEwMDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoZmlsZXNbMF0udHlwZSA9PT0gImltYWdlL3BuZyIgfHwgZmlsZXNbMF0udHlwZSA9PT0gImltYWdlL2pwZWciKSB7CiAgICAgICAgaWYgKCFmaWxlcy5sZW5ndGgpIHJldHVybjsKICAgICAgICB0aGlzLm9sZF9pbWFnZV9uYW1lID0gdGhpcy5maWxlX2xhYmVsOwogICAgICAgIHRoaXMuZmlsZV9sYWJlbCA9IGZpbGVzWzBdLm5hbWU7CiAgICAgICAgdGhpcy5uZXdfaW1hZ2VfZmlsZSA9IGZpbGVzWzBdLnR5cGU7CiAgICAgICAgdGhpcy5jcmVhdGVJbWFnZTEoZmlsZXNbMF0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIFNlbGVjdCBhbiBJbWFnZSBvZiB0eXBlIFBORyBvciBKUEVHIik7CiAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVJbWFnZTE6IGZ1bmN0aW9uIGNyZWF0ZUltYWdlMShmaWxlLCB0eXBlKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczguaW1nX2ZpbGUgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoImJhc2U2NCwiKVsxXTsKICAgICAgfTsKCiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgfSwKICAgIGNsZWFyX2ZpZWxkczogZnVuY3Rpb24gY2xlYXJfZmllbGRzKCkgewogICAgICB0aGlzLmltZ19maWxlID0gIiI7CiAgICAgIHRoaXMuZmlsZV9sYWJlbCA9ICJDaG9vc2UgZmlsZSI7CiAgICAgIHRoaXMuaXNzdWVfY29tbWVudCA9ICIiOwogICAgICB0aGlzLmlzc3VlX25hbWUgPSAiIjsKICAgICAgdGhpcy5pc3N1ZV9kZXNjcmlwdGlvbiA9ICIiOwogICAgfSwKICAgIGVtcHR5X3ZhcmlhYmxlOiBmdW5jdGlvbiBlbXB0eV92YXJpYWJsZSgpIHsKICAgICAgLy8gdGhpcy5zZWFyY2hfa2V5ID0gIiI7CiAgICAgIHRoaXMuQ29tbWVudHNfbGlzdCA9IFsiIl07CiAgICAgIHRoaXMuY29tbWVudF9pdGVtX2xpc3QgPSBbIiJdOwogICAgICB0aGlzLm5ld190aWNrZXRfY29tbWVudCA9ICIiOwogICAgICB0aGlzLm5ld19pbWFnZV9uYW1lID0gIiI7CiAgICAgIHRoaXMubmV3X2ltYWdlX2ZpbGUgPSAiIjsKICAgICAgdGhpcy5maWxlX2NvbnRlbnQyID0gIiI7CiAgICB9CiAgfQp9Ow=="},null]}