{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/ConversationalFlow/Dialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/ConversationalFlow/Dialog.vue","mtime":1663910265454},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIi9ob21lL3ZpbWFsZXNoL0NFTlNFL2NoYXRib3QtcG9ydGFsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiL2hvbWUvdmltYWxlc2gvQ0VOU0UvY2hhdGJvdC1wb3J0YWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8gaW1wb3J0IHsgVHJlZSwgVHJlZU5vZGUgfSBmcm9tICJ2dWUtdHJlZS1saXN0IjsKaW1wb3J0IHsgVnVlVHJlZUxpc3QsIFRyZWUsIFRyZWVOb2RlIH0gZnJvbSAiLi4vLi4vLi4vLi4vLi4vcHVibGljL2pzL3Z1ZS10cmVlLWxpc3QudW1kLm1pbi5qcyI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IFN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgeyBWdWVFZGl0b3IgfSBmcm9tICJ2dWUyLWVkaXRvciI7CmltcG9ydCBNdWx0aXNlbGVjdCBmcm9tICJ2dWUtbXVsdGlzZWxlY3QiOwppbXBvcnQgUmVzcG9uc2VCb3QgZnJvbSAiLi4vRGF0YSBJbnB1dHMvUmVzcG9uc2VCb3QiOwppbXBvcnQgZHJhZ2dhYmxlIGZyb20gInZ1ZWRyYWdnYWJsZSI7CmltcG9ydCB7IGZyZWV6ZV9wb3J0YWwsIHNob3dfc3Vic2NyaXB0aW9uX2V4cGlyZWRfc3dhbCwgY2xvc2VfbW9kYWwgfSBmcm9tICJAL3BvcnRhbC9taXhpbnMiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgVnVlVHJlZUxpc3Q6IFZ1ZVRyZWVMaXN0LAogICAgVnVlRWRpdG9yOiBWdWVFZGl0b3IsCiAgICBNdWx0aXNlbGVjdDogTXVsdGlzZWxlY3QsCiAgICBSZXNwb25zZUJvdDogUmVzcG9uc2VCb3QsCiAgICBkcmFnZ2FibGU6IGRyYWdnYWJsZQogIH0sCiAgbmFtZTogImRpYWxvZ19jb21wb25lbnQiLAogIG1peGluczogW2ZyZWV6ZV9wb3J0YWwsIHNob3dfc3Vic2NyaXB0aW9uX2V4cGlyZWRfc3dhbCwgY2xvc2VfbW9kYWxdLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzZWxlY3RlZF9lbnRpdHk6ICIiLAogICAgICB1cGRhdGVkX25vZGVfbGlzdDogIiIsCiAgICAgIHNwaW5uZXJPbjogZmFsc2UsCiAgICAgIGJ1dHRvbl90eXBlX2xpc3Q6IFt7CiAgICAgICAgdmFsdWU6ICJwb3N0YmFjayIsCiAgICAgICAgbmFtZTogIlBvc3RiYWNrIgogICAgICB9LCB7CiAgICAgICAgdmFsdWU6ICJ3ZWJfdXJsIiwKICAgICAgICBuYW1lOiAiVVJMIgogICAgICB9XSwKICAgICAgYXNzaXN0YW5jZV9yZXNwb25zZV9pZDogMCwKICAgICAgYXNzaXN0YW5jZV9yZXNwb25zZV9fdmFsX2luZGV4OiAwLAogICAgICBtYW5hZ2VfaGFuZGxlcnNfaW5kOiAwLAogICAgICBtYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV9pZDogMCwKICAgICAgbWFuYWdlX2hhbmRsZXJzX2Fzc2lzdGFuY2VfcmVzcG9uc2VfX3ZhbF9pbmRleDogMCwKICAgICAgc2xvdF92YXJpYWJsZTogW10sCiAgICAgIGZpbHRlcmVkX2Fzc2lzdGFudF9yZXNwb25zZTogW10sCiAgICAgIHJlZ191cmw6IC9odHRwczpcL1wvWyh3d3dcLik/YS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIoWy1hLXpBLVowLTlAOiVfXCsufiM/JlwvXC89XSopL2ksCiAgICAgIHJlZ19pbWFnZTogLyhodHRwczpcL1wvKShbXlxzKFsiPCw+L10qKShcLylbXlxzWyIsPjxdKigucG5nfC5qcGd8LmpwZWd8LmdpZikoXD9bXlxzWyIsPjxdKik/LywKICAgICAgbmV3VHJlZToge30sCiAgICAgIG5vZGVzX2xpc3Q6IFtdLAogICAgICBkYXRhOiBuZXcgVHJlZShbXSksCiAgICAgIGxvYWRfYm90X3ByZXZpZXc6IGZhbHNlLAogICAgICBkcmFnX3Nsb3RzOiBmYWxzZSwKICAgICAgLy8gdGVzdF9yZXNwb25zZV90cmVlOiBbCiAgICAgIC8vICAgewogICAgICAvLyAgICAgaWQ6IDE2MjM2NjkwMTQzMDcsCiAgICAgIC8vICAgICBpc19sZWFmOiBmYWxzZSwKICAgICAgLy8gICAgIGVkaXROb2RlRGlzYWJsZWQ6IHRydWUsCiAgICAgIC8vICAgICBuYW1lOiAiSGVsbG8iLAogICAgICAvLyAgICAgbmV4dF9zdGVwOiB7CiAgICAgIC8vICAgICAgIGJlaGF2aW9yOiAid2FpdF9mb3JfcmVwbHkiLAogICAgICAvLyAgICAgICBub2RlX2lkOiBudWxsLAogICAgICAvLyAgICAgICBzZWxlY3RvcjogIndhaXRfZm9yX3VzZXJfaW5wdXQiLAogICAgICAvLyAgICAgfSwKICAgICAgLy8gICAgIHBpZDogMCwKICAgICAgLy8gICAgIHJlc3BvbnNlczogWwogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBpZDogMCwKICAgICAgLy8gICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAvLyAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgLy8gICAgICAgICB2YWx1ZXM6IFsiSGV5eWEiXSwKICAgICAgLy8gICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAvLyAgICAgICB9LAogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBpZDogMSwKICAgICAgLy8gICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAvLyAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgLy8gICAgICAgICB2YWx1ZXM6IFsiSGV5eWEyIl0sCiAgICAgIC8vICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgIF0sCiAgICAgIC8vICAgICBzbG90X3NldHRpbmc6IGZhbHNlLAogICAgICAvLyAgICAgc2xvdHM6IFtdLAogICAgICAvLyAgICAgdHJpZ2dlcnM6IFsKICAgICAgLy8gICAgICAgewogICAgICAvLyAgICAgICAgIHRyaWdnZXJfdHlwZTogImludGVudCIsCiAgICAgIC8vICAgICAgICAgdHJpZ2dlcl92YWx1ZTogImludGVudCIsCiAgICAgIC8vICAgICAgIH0sCiAgICAgIC8vICAgICBdLAogICAgICAvLyAgICAgd2ViaG9va19pZDogbnVsbCwKICAgICAgLy8gICAgIHdlYmhvb2tfaW50ZWdyYXRpb246IGZhbHNlLAogICAgICAvLyAgICAgd2ViaG9va19tYXBwaW5nOiBudWxsLAogICAgICAvLyAgICAgd2ViaG9va19yZXR1cm5fdmFyaWFibGU6IG51bGwsCiAgICAgIC8vICAgICBjaGlsZHJlbjogWwogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgaWQ6IDE2MjM2NzA5OTk4NzgsCiAgICAgIC8vICAgICAgICAgaXNfbGVhZjogZmFsc2UsCiAgICAgIC8vICAgICAgICAgZWRpdE5vZGVEaXNhYmxlZDogdHJ1ZSwKICAgICAgLy8gICAgICAgICBuYW1lOiAiSGVsbG8gY2hpbGQiLAogICAgICAvLyAgICAgICAgIG5leHRfc3RlcDogewogICAgICAvLyAgICAgICAgICAgYmVoYXZpb3I6ICJ3YWl0X2Zvcl9yZXBseSIsCiAgICAgIC8vICAgICAgICAgICBub2RlX2lkOiBudWxsLAogICAgICAvLyAgICAgICAgICAgc2VsZWN0b3I6ICJ3YWl0X2Zvcl91c2VyX2lucHV0IiwKICAgICAgLy8gICAgICAgICB9LAogICAgICAvLyAgICAgICAgIHBpZDogMTYyMzY2OTAxNDMwNywKICAgICAgLy8gICAgICAgICByZXNwb25zZXM6IFsKICAgICAgLy8gICAgICAgICAgIHsKICAgICAgLy8gICAgICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgICAgICAgICAgaWQ6IDAsCiAgICAgIC8vICAgICAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgIC8vICAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgLy8gICAgICAgICAgICAgdmFsdWVzOiBbImNoaWxkIiwgIm5vZGUiXSwKICAgICAgLy8gICAgICAgICAgICAgdmFyaWF0aW9uOiAic2VxdWVudGlhbCIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgIF0sCiAgICAgIC8vICAgICAgICAgc2xvdF9zZXR0aW5nOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBzbG90czogW10sCiAgICAgIC8vICAgICAgICAgdHJpZ2dlcnM6IFsKICAgICAgLy8gICAgICAgICAgIHsKICAgICAgLy8gICAgICAgICAgICAgdHJpZ2dlcl90eXBlOiAiaW50ZW50IiwKICAgICAgLy8gICAgICAgICAgICAgdHJpZ2dlcl92YWx1ZTogImludGVudCIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgIF0sCiAgICAgIC8vICAgICAgICAgd2ViaG9va19pZDogbnVsbCwKICAgICAgLy8gICAgICAgICB3ZWJob29rX2ludGVncmF0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgICAgICB3ZWJob29rX21hcHBpbmc6IG51bGwsCiAgICAgIC8vICAgICAgICAgd2ViaG9va19yZXR1cm5fdmFyaWFibGU6IG51bGwsCiAgICAgIC8vICAgICAgIH0sCiAgICAgIC8vICAgICAgIHsKICAgICAgLy8gICAgICAgICBpZDogMTYyMzczMTAyNTQxNCwKICAgICAgLy8gICAgICAgICBpc19sZWFmOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBlZGl0Tm9kZURpc2FibGVkOiB0cnVlLAogICAgICAvLyAgICAgICAgIG5hbWU6ICJjaGlsZF8yIiwKICAgICAgLy8gICAgICAgICBuZXh0X3N0ZXA6IHsKICAgICAgLy8gICAgICAgICAgIGJlaGF2aW9yOiAid2FpdF9mb3JfcmVwbHkiLAogICAgICAvLyAgICAgICAgICAgbm9kZV9pZDogbnVsbCwKICAgICAgLy8gICAgICAgICAgIHNlbGVjdG9yOiAid2FpdF9mb3JfdXNlcl9pbnB1dCIsCiAgICAgIC8vICAgICAgICAgfSwKICAgICAgLy8gICAgICAgICBub2RlX25hbWU6ICJiYXNpY19jaGlsZF8yIiwKICAgICAgLy8gICAgICAgICBub2RlX3R5cGU6ICJiYXNpYyIsCiAgICAgIC8vICAgICAgICAgcGlkOiAxNjIzNjY5MDE0MzA3LAogICAgICAvLyAgICAgICAgIHJlc3BvbnNlczogWwogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgICAgICBpZDogMCwKICAgICAgLy8gICAgICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgLy8gICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAvLyAgICAgICAgICAgICB2YWx1ZXM6IFsiY2hpbGQiLCAidGV4dCByZXNwb25zZSJdLAogICAgICAvLyAgICAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAvLyAgICAgICAgICAgfSwKICAgICAgLy8gICAgICAgICAgIHsKICAgICAgLy8gICAgICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgICAgICAgICAgaWQ6IDEsCiAgICAgIC8vICAgICAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgIC8vICAgICAgICAgICAgIHNvdXJjZTogImdvb2dsLmNvbSIsCiAgICAgIC8vICAgICAgICAgICAgIHR5cGU6ICJpbWFnZSIsCiAgICAgIC8vICAgICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgIF0sCiAgICAgIC8vICAgICAgICAgc2xvdF9zZXR0aW5nOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBzbG90czogW10sCiAgICAgIC8vICAgICAgICAgdHJpZ2dlcnM6IFsKICAgICAgLy8gICAgICAgICAgIHsKICAgICAgLy8gICAgICAgICAgICAgdHJpZ2dlcl90eXBlOiAiaW50ZW50IiwKICAgICAgLy8gICAgICAgICAgICAgdHJpZ2dlcl92YWx1ZTogImludGVudCIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgIF0sCiAgICAgIC8vICAgICAgICAgd2ViaG9va19pZDogbnVsbCwKICAgICAgLy8gICAgICAgICB3ZWJob29rX2ludGVncmF0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgICAgICB3ZWJob29rX21hcHBpbmc6IG51bGwsCiAgICAgIC8vICAgICAgICAgd2ViaG9va19yZXR1cm5fdmFyaWFibGU6IG51bGwsCiAgICAgIC8vICAgICAgIH0sCiAgICAgIC8vICAgICBdLAogICAgICAvLyAgIH0sCiAgICAgIC8vICAgewogICAgICAvLyAgICAgaWQ6IDE2MjM2NzA4ODIxMzAsCiAgICAgIC8vICAgICBpc19sZWFmOiBmYWxzZSwKICAgICAgLy8gICAgIGVkaXROb2RlRGlzYWJsZWQ6IHRydWUsCiAgICAgIC8vICAgICBuYW1lOiAiV29ybGQiLAogICAgICAvLyAgICAgbmV4dF9zdGVwOiB7CiAgICAgIC8vICAgICAgIGJlaGF2aW9yOiAid2FpdF9mb3JfcmVwbHkiLAogICAgICAvLyAgICAgICBub2RlX2lkOiBudWxsLAogICAgICAvLyAgICAgICBzZWxlY3RvcjogIndhaXRfZm9yX3VzZXJfaW5wdXQiLAogICAgICAvLyAgICAgfSwKICAgICAgLy8gICAgIG5vZGVfbmFtZTogImJhc2ljX1dvcmxkIiwKICAgICAgLy8gICAgIG5vZGVfdHlwZTogImJhc2ljIiwKICAgICAgLy8gICAgIHBpZDogMCwKICAgICAgLy8gICAgIHJlc3BvbnNlczogWwogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBpZDogIjAiLAogICAgICAvLyAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgIC8vICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAvLyAgICAgICAgIHZhbHVlczogWyJ0ZXh0Il0sCiAgICAgIC8vICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgICAgewogICAgICAvLyAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgIC8vICAgICAgICAgaWQ6ICIxIiwKICAgICAgLy8gICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAvLyAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgLy8gICAgICAgICB2YWx1ZXM6IFsicmVzcCJdLAogICAgICAvLyAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgIC8vICAgICAgIH0sCiAgICAgIC8vICAgICBdLAogICAgICAvLyAgICAgc2xvdF9zZXR0aW5nOiBmYWxzZSwKICAgICAgLy8gICAgIHNsb3RzOiBbXSwKICAgICAgLy8gICAgIHRyaWdnZXJzOiBbCiAgICAgIC8vICAgICAgIHsKICAgICAgLy8gICAgICAgICB0cmlnZ2VyX3R5cGU6ICJpbnRlbnQiLAogICAgICAvLyAgICAgICAgIHRyaWdnZXJfdmFsdWU6ICJpbnRlbnQiLAogICAgICAvLyAgICAgICB9LAogICAgICAvLyAgICAgXSwKICAgICAgLy8gICAgIHdlYmhvb2tfaWQ6IG51bGwsCiAgICAgIC8vICAgICB3ZWJob29rX2ludGVncmF0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgIHdlYmhvb2tfbWFwcGluZzogbnVsbCwKICAgICAgLy8gICAgIHdlYmhvb2tfcmV0dXJuX3ZhcmlhYmxlOiBudWxsLAogICAgICAvLyAgIH0sCiAgICAgIC8vICAgewogICAgICAvLyAgICAgaWQ6IDE2MjM2NzEyMTg5OTYsCiAgICAgIC8vICAgICBpc19sZWFmOiBmYWxzZSwKICAgICAgLy8gICAgIGVkaXROb2RlRGlzYWJsZWQ6IHRydWUsCiAgICAgIC8vICAgICBuYW1lOiAiVGVzdCBub2RlMyIsCiAgICAgIC8vICAgICBuZXh0X3N0ZXA6IHsKICAgICAgLy8gICAgICAgYmVoYXZpb3I6ICJ3YWl0X2Zvcl9yZXBseSIsCiAgICAgIC8vICAgICAgIG5vZGVfaWQ6IG51bGwsCiAgICAgIC8vICAgICAgIHNlbGVjdG9yOiAid2FpdF9mb3JfdXNlcl9pbnB1dCIsCiAgICAgIC8vICAgICB9LAogICAgICAvLyAgICAgcGlkOiAwLAogICAgICAvLyAgICAgcmVzcG9uc2VzOiBbCiAgICAgIC8vICAgICAgIHsKICAgICAgLy8gICAgICAgICBjb25kaXRpb246ICJ1bmZpbGxlZCIsCiAgICAgIC8vICAgICAgICAgaWQ6ICIwIiwKICAgICAgLy8gICAgICAgICByZWNvZ25pemVzOiAiJHdlYmhvb2tfcmVzdWx0IiwKICAgICAgLy8gICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgIC8vICAgICAgICAgdmFsdWVzOiBbIndlYmhvb2tfdmFyaWFiYmxlIHJlc3BvbnNlIl0sCiAgICAgIC8vICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgIF0sCiAgICAgIC8vICAgICBzbG90X3NldHRpbmc6IGZhbHNlLAogICAgICAvLyAgICAgc2xvdHM6IFtdLAogICAgICAvLyAgICAgdHJpZ2dlcnM6IFsKICAgICAgLy8gICAgICAgewogICAgICAvLyAgICAgICAgIHRyaWdnZXJfdHlwZTogIkludGVudCIsCiAgICAgIC8vICAgICAgICAgdHJpZ2dlcl92YWx1ZTogIkludGVudCIsCiAgICAgIC8vICAgICAgIH0sCiAgICAgIC8vICAgICBdLAogICAgICAvLyAgICAgd2ViaG9va19pZDogIjEiLAogICAgICAvLyAgICAgd2ViaG9va19pbnRlZ3JhdGlvbjogdHJ1ZSwKICAgICAgLy8gICAgIHdlYmhvb2tfbWFwcGluZzogWwogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAga2V5OiAibmFtZSIsCiAgICAgIC8vICAgICAgICAgdmFsdWU6ICJ2YWx1ZSIsCiAgICAgIC8vICAgICAgIH0sCiAgICAgIC8vICAgICBdLAogICAgICAvLyAgICAgd2ViaG9va19yZXR1cm5fdmFyaWFibGU6ICIkd2ViaG9va19yZXN1bHQiLAogICAgICAvLyAgICAgY2hpbGRyZW46IFsKICAgICAgLy8gICAgICAgewogICAgICAvLyAgICAgICAgIGlkOiAxNjIzNzMwODI3MjA2LAogICAgICAvLyAgICAgICAgIGlzX2xlYWY6IGZhbHNlLAogICAgICAvLyAgICAgICAgIGVkaXROb2RlRGlzYWJsZWQ6IHRydWUsCiAgICAgIC8vICAgICAgICAgbmFtZTogInRlc3QgY2hpbGQgbm9kZSIsCiAgICAgIC8vICAgICAgICAgbmV4dF9zdGVwOiB7CiAgICAgIC8vICAgICAgICAgICBiZWhhdmlvcjogIndhaXRfZm9yX3JlcGx5IiwKICAgICAgLy8gICAgICAgICAgIG5vZGVfaWQ6IG51bGwsCiAgICAgIC8vICAgICAgICAgICBzZWxlY3RvcjogIndhaXRfZm9yX3VzZXJfaW5wdXQiLAogICAgICAvLyAgICAgICAgIH0sCiAgICAgIC8vICAgICAgICAgbm9kZV9uYW1lOiAiYmFzaWNfdGVzdCBjaGlsZCBub2RlIiwKICAgICAgLy8gICAgICAgICBub2RlX3R5cGU6ICJiYXNpYyIsCiAgICAgIC8vICAgICAgICAgcGlkOiAxNjIzNjcxMjE4OTk2LAogICAgICAvLyAgICAgICAgIHJlc3BvbnNlczogWwogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgICAgICBpZDogMCwKICAgICAgLy8gICAgICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgLy8gICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAvLyAgICAgICAgICAgICB2YWx1ZXM6IFsiaGVsbG8iXSwKICAgICAgLy8gICAgICAgICAgICAgdmFyaWF0aW9uOiAic2VxdWVudGlhbCIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgICAgICBpZDogMSwKICAgICAgLy8gICAgICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgLy8gICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAvLyAgICAgICAgICAgICB2YWx1ZXM6IFsidGV4dCIsICJyZXNwb25zZSJdLAogICAgICAvLyAgICAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAvLyAgICAgICAgICAgfSwKICAgICAgLy8gICAgICAgICBdLAogICAgICAvLyAgICAgICAgIHNsb3Rfc2V0dGluZzogZmFsc2UsCiAgICAgIC8vICAgICAgICAgc2xvdHM6IFtdLAogICAgICAvLyAgICAgICAgIHRyaWdnZXJzOiBbCiAgICAgIC8vICAgICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgIHRyaWdnZXJfdHlwZTogIkludGVudCIsCiAgICAgIC8vICAgICAgICAgICAgIHRyaWdnZXJfdmFsdWU6ICJJbnRlbnQiLAogICAgICAvLyAgICAgICAgICAgfSwKICAgICAgLy8gICAgICAgICBdLAogICAgICAvLyAgICAgICAgIHdlYmhvb2tfaWQ6ICIxIiwKICAgICAgLy8gICAgICAgICB3ZWJob29rX2ludGVncmF0aW9uOiB0cnVlLAogICAgICAvLyAgICAgICAgIHdlYmhvb2tfbWFwcGluZzogWwogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICBrZXk6ICJuYW1lIiwKICAgICAgLy8gICAgICAgICAgICAgdmFsdWU6ICIkdmFsdWUiLAogICAgICAvLyAgICAgICAgICAgfSwKICAgICAgLy8gICAgICAgICBdLAogICAgICAvLyAgICAgICAgIHdlYmhvb2tfcmV0dXJuX3ZhcmlhYmxlOiAiJHdlYmhvb2tfcmVzdWx0IiwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgIF0sCiAgICAgIC8vICAgfSwKICAgICAgLy8gXSwKICAgICAgbmV3X2NoaWxkX25vZGU6IGZhbHNlLAogICAgICBjaGlsZF9ub2RlOiB7fSwKICAgICAgbm9kZV9pZDogIiIsCiAgICAgIG5vZGVfbmFtZTogIiIsCiAgICAgIG5vZGVfdHlwZTogIiIsCiAgICAgIGlzX3Jvb3Q6IGZhbHNlLAogICAgICBhc3Npc3RhbnRfcmVzcG9uc2U6IFtdLAogICAgICBhc3Npc3RhbnRfcmVzcG9uc2VfdHlwZTogWyJ0ZXh0IiwgImltYWdlIiwgInZpZGVvIiwgImNob2ljZXMiLCAiY2FyZCJdLAogICAgICBzZWxlY3RlZF9yZXNwb25zZV90eXBlOiAidGV4dCIsCiAgICAgIHJlc3BvbnNlX3ZhcmlhdGlvbjogWyJzZXF1ZW50aWFsIl0sCiAgICAgIHRyaWdnZXJzX2ZpbHRlcl9ieV9vcHRpb25zOiBbImludGVudCIsICJlbnRpdHkiXSwKICAgICAgaW5zZXJ0X3Nsb3RfdmFyaWFibGVfb3B0aW9uczogW10sCiAgICAgIGVudGl0eV9vcGVyYW5kX29wdGlvbnM6IFsiaXMiLCAiYW55Il0sCiAgICAgIHRyaWdnZXJzOiBbewogICAgICAgIHRyaWdnZXJfdHlwZTogIiIsCiAgICAgICAgdHJpZ2dlcl92YWx1ZTogIiIKICAgICAgfV0sCiAgICAgIHRoZW5fYXNzaXN0YW50X3Nob3VsZDogWyJ3YWl0X2Zvcl9yZXBseSIsICJqdW1wX3RvIl0sCiAgICAgIHNhdmVfdGhlbl9hc3Npc3RhbnRfc2hvdWxkOiAiIiwKICAgICAgbmV4dF9zdGVwOiB7fSwKICAgICAganVtcF90b19ub2RlX2lkOiAiIiwKICAgICAgaXNfc2xvdDogZmFsc2UsCiAgICAgIGlzX3dlYmhvb2s6IGZhbHNlLAogICAgICBpc19ub3RpZmljYXRpb246IGZhbHNlLAogICAgICB3ZWJob29rX2lkOiBudWxsLAogICAgICB3ZWJob29rX2xpc3Q6IFtdLAogICAgICBpc193ZWJob29rX2RldGFpbHM6IGZhbHNlLAogICAgICB3ZWJob29rX21hcHBpbmc6IFtdLAogICAgICB3ZWJob29rX3ZhcmlhYmxlOiAiIiwKICAgICAgd2ViaG9va19hc3Npc3RhbnRfcmVzcG9uc2U6IFtdLAogICAgICBzbG90czogW10sCiAgICAgIGlzX3ZhbGlkYXRpb25fZW50aXR5OiBmYWxzZSwKICAgICAgdW5maWxsZWRfc2xvdF9hc3Npc3RhbnRfcmVzcG9uc2U6IFtdLAogICAgICB2YWxpZGF0aW9uX3Nsb3RfYXNzaXN0YW50X3Jlc3BvbnNlOiBbXSwKICAgICAgbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfYXNzaXN0YW50X3Jlc3BvbnNlOiBbXSwKICAgICAgbm90aWZpY2F0aW9uX3Vuc3VjY2Vzc2Z1bF9hc3Npc3RhbnRfcmVzcG9uc2U6IFtdLAogICAgICBlZGl0X3Nsb3RfaW5kZXg6ICIiLAogICAgICBlZGl0X3Nsb3RfY2hlY2tfZm9yOiAiIiwKICAgICAgZWRpdF9zbG90X3Nsb3RfdmFyaWFibGU6ICIiLAogICAgICBtYW5hZ2VfaGFuZGxlcnM6IFtdLAogICAgICBub3RpZmljYXRpb25zOiB7CiAgICAgICAgbm90aWZ5OiBbewogICAgICAgICAgdHlwZTogIiIsCiAgICAgICAgICBzbG90OiAiIiwKICAgICAgICAgIHRlbXBsYXRlX2lkOiAiIiwKICAgICAgICAgIHRlbXBsYXRlX25hbWU6ICIiCiAgICAgICAgfV0sCiAgICAgICAgcmVzcG9uc2VzOiBbXQogICAgICB9LAogICAgICBub3RpZmljYXRpb25zX25vdGlmeV90eXBlX2xpc3Q6IFsiZW1haWwiXSwKICAgICAgbm90aWZpY2F0aW9uc19ub3RpZnlfdGVtcGxhdGVfbGlzdDogWy8vIHsKICAgICAgICAvLyAgICJlbWFpbCI6ICI8cD5OZXcgWWVhciBPZmZlcnMgb2YgNTAlIGRpc2NvdW50IG9uIGFsbCBncm9jZXJ5IHByb2R1Y3RzISEhPC9wPiIsCiAgICAgICAgLy8gICAic21zIjogbnVsbCwKICAgICAgICAvLyAgICJ0ZW1wbGF0ZV9pZCI6ICI0MzUzMTJiYy1kNDI3LTQ5N2EtYWVjZS1iOGI5MmE0ODJlMjAiLAogICAgICAgIC8vICAgInRlbXBsYXRlX25hbWUiOiAiTmV3IFllYXIgT2ZmZXJzIgogICAgICAgIC8vIH0sCiAgICAgICAgLy8gewogICAgICAgIC8vICAgImVtYWlsIjogIjxwPlNhbGUgb2YgNTAgJSBvbiBkaXdhbGk8L3A+IiwKICAgICAgICAvLyAgICJzbXMiOiBudWxsLAogICAgICAgIC8vICAgInRlbXBsYXRlX2lkIjogImU3NjZlNzk1LTliM2EtNGFkOC04ZWEzLTU5ZDY5ZWRmMDI2NyIsCiAgICAgICAgLy8gICAidGVtcGxhdGVfbmFtZSI6ICJEaXdhbGkgVGVtcGxhdGUiCiAgICAgICAgLy8gfSwKICAgICAgICAvLyB7CiAgICAgICAgLy8gICAiZW1haWwiOiAiPHA+SGVsbG8gQ3VzdG9tZXJzITwvcD48cD5DaHJpc3RtYXMgbWF5IGJlIHdlZWtzIGFnbyBidXQgd2UgYXJlIGVuY291cmFnaW5nIGN1c3RvbWVycyB0byBzaG9wIGVhcmx5IHRoaXMgeWVhciBmb3IgdGltZWx5IGRlbGl2ZXJ5LiBDT1ZJRC0xOSB3aWxsIGNhdXNlIHN1cmdlIGluIG9ubGluZSBzaG9wcGluZywgd2hpY2ggbWVhbnMgdGhhdCB0aGVyZSBjb3VsZCBiZSB1bmV4cGVjdGVkIHNoaXBwaW5nIGRlbGF5cyB3aXRoIGNhcnJpZXJzLiBHbyB2aXNpdCBvdXIgc3RvcmUgbm93OiBodHRwczovL2VhcnRob25zdG9yZS5jb20vIDwvcD4iLAogICAgICAgIC8vICAgInNtcyI6IG51bGwsCiAgICAgICAgLy8gICAic3ViamVjdCI6ICJPZmZlcnMiLAogICAgICAgIC8vICAgInRlbXBsYXRlX2lkIjogIjBiYjBjZWIzLWZkMzAtNDEzZS04ZjM3LWIwYmM1OWJiMDBlNyIsCiAgICAgICAgLy8gICAidGVtcGxhdGVfbmFtZSI6ICJDaHJpc3RtYXMiCiAgICAgICAgLy8gfQogICAgICBdLAogICAgICBjdXN0b21Ub29sYmFyOiBbWyJib2xkIiwgIml0YWxpYyIsICJ1bmRlcmxpbmUiXSwgW3sKICAgICAgICBhbGlnbjogW10KICAgICAgfV0sIFt7CiAgICAgICAgY29sb3I6IFtdCiAgICAgIH0sIHsKICAgICAgICBiYWNrZ3JvdW5kOiBbXQogICAgICB9XSwgW3sKICAgICAgICBsaXN0OiAib3JkZXJlZCIKICAgICAgfSwgewogICAgICAgIGxpc3Q6ICJidWxsZXQiCiAgICAgIH1dLCBbImxpbmsiXV0sCiAgICAgIC8vIGVudGl0eV9saXN0OiBbImVudGl0eTEiLCJlbnRpdHkyIl0sCiAgICAgIGVudGl0eV9saXN0OiBbXSwKICAgICAgLy8gdHJpZ2dlcl9vcHRpb25zOiBbIklOdGVudDEiLCJJbnRlbnQyIiwiSW50ZW50MyJdLAogICAgICB0cmlnZ2VyX29wdGlvbnM6IFtdLAogICAgICB0cmlnZ2VyX29wdGlvbnNfaW50ZW50OiBbXSwKICAgICAgdHJpZ2dlcl9vcHRpb25zX2VudGl0eTogW10sCiAgICAgIGludGVudF9saXN0X2Nob2ljZV9jYXJkOiBbXSwKICAgICAgdHJpZ2dlcl9vcHRpb25zX2VudGl0eV92YWx1ZXM6IFtdLAogICAgICBpc19zaG93X2VkaXQ6IGZhbHNlLAogICAgICBpc19sb2FkaW5nOiBmYWxzZSwKICAgICAgc2hvd19pbnRlbnRfbGlzdDogZmFsc2UKICAgIH07CiAgfSwKICB3YXRjaDoge30sCiAgY29tcHV0ZWQ6IHsKICAgIGRyYWdPcHRpb25zU2xvdHM6IGZ1bmN0aW9uIGRyYWdPcHRpb25zU2xvdHMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgYW5pbWF0aW9uOiAyMDAsCiAgICAgICAgZ3JvdXA6ICJkZXNjcmlwdGlvbiIsCiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgIGdob3N0Q2xhc3M6ICJnaG9zdCIsCiAgICAgICAgc2Nyb2xsU2Vuc2l0aXZpdHk6IDIwMCwKICAgICAgICBmb3JjZUZhbGxiYWNrOiB0cnVlCiAgICAgIH07CiAgICB9IC8vIHBsYWNlaG9sZGVyKCkgewogICAgLy8gICBpZiAodGhpcy50cmlnZ2Vycy5sZW5ndGggPiAxKXsKICAgIC8vICAgICB0aGlzLnRyaWdnZXJfb3B0aW9ucyA9IFtdOwogICAgLy8gICAgIHJldHVybiAiVHlwZSB0byBzZWFyY2ggRW50aXR5IgogICAgLy8gICB9ZWxzZXsKICAgIC8vICAgICByZXR1cm4gIlR5cGUgdG8gc2VhcmNoIG9iamVjdGl2ZSIKICAgIC8vICAgfQogICAgLy8gfQoKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5mcmVlemVfcG9ydGFsKCk7CiAgICB9LCAxMDAwKTsKICAgIHRoaXMuJHJvb3QuJG9uKCJkaWFsb2dfY29tcG9uZW50RGlzYWJsZWQiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICBpZiAoZGF0YSA9PT0gdHJ1ZSkgewogICAgICAgIF90aGlzLnNob3dfc3Vic2NyaXB0aW9uX2V4cGlyZWRfc3dhbCgpOwogICAgICB9CiAgICB9KTsgLy8gJCgiI3RyeV9ib3RfYnRuIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgLy8gICBhbGVydCgnY2xpY2tlZCEnKTsKICAgIC8vIH0pOwoKICAgIHZhciB2bSA9IHRoaXM7CiAgICAkKCIjaW5zZXJ0X3ZhcmlhYmxlX21vZGFsIikub24oImhpZGRlbi5icy5tb2RhbCIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciBpZCA9IHZtLmFzc2lzdGFuY2VfcmVzcG9uc2VfaWQ7CiAgICAgIHZhciBudW0gPSB2bS5hc3Npc3RhbmNlX3Jlc3BvbnNlX192YWxfaW5kZXg7CiAgICAgICQoIiNhc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS5mb2N1cygpOwogICAgfSk7CiAgICAkKCIjbWFuYWdlX2hhbmRsZXJzX2luc2VydF92YXJpYWJsZV9tb2RhbCIpLm9uKCJoaWRkZW4uYnMubW9kYWwiLCBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgaWQgPSB2bS5tYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV9pZDsKICAgICAgdmFyIG51bSA9IHZtLm1hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlX192YWxfaW5kZXg7CiAgICAgICQoIiNtYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkuZm9jdXMoKTsKICAgIH0pOwoKICAgIHdpbmRvdy5vbmNsaWNrID0gZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoIiN0cnlfYm90X3Jlc3BvbnNlIikgfHwgZS50YXJnZXQuY2xvc2VzdCgiI3RyeV9ib3RfYnRuIikpIHt9IGVsc2UgewogICAgICAgIHZtLmxvYWRfYm90X3ByZXZpZXcgPSBmYWxzZTsKICAgICAgfQogICAgfTsgLy8gR0VUIFNBVkVEIERJQUxPRyBUUkVFCgoKICAgIHRoaXMubG9hZF9zYXZlZF9kaWFsb2dfdHJlZSgpOyAvLyBDSEVDS0lORyBXRUJIT09LIERFVEFJTFMKCiAgICB0aGlzLmxvYWRfd2ViaG9vaygpOwogICAgdGhpcy5sb2FkX2ludGVudCgpOwogICAgdGhpcy5sb2FkX2VudGl0eSgpOwogICAgdGhpcy5sb2FkX3RlbXBsYXRlcygpOyAvLyB0aGlzLmRhdGEgPSBuZXcgVHJlZSh0aGlzLnRlc3RfcmVzcG9uc2VfdHJlZSkKICAgIC8vIHRoaXMuZ2V0X25vZGVzX2xpc3QodGhpcy5kYXRhKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGZpbHRlcl9hc2lzdGFuY2VfcmVzcG9uc2U6IGZ1bmN0aW9uIGZpbHRlcl9hc2lzdGFuY2VfcmVzcG9uc2UoKSB7CiAgICAgIHRoaXMuZmlsdGVyZWRfYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CgogICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmNvbmRpdGlvbiAhPSAndW5maWxsZWRfc2xvdCcgJiYgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uY29uZGl0aW9uICE9ICchc3VjY2Vzc2Z1bCcgJiYgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uY29uZGl0aW9uICE9ICchdW5zdWNjZXNzZnVsJyAmJiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5jb25kaXRpb24gIT0gJ3ZhbGlkYXRpb25fcmVzcG9uc2UnKSB7CiAgICAgICAgICB0aGlzLmZpbHRlcmVkX2Fzc2lzdGFudF9yZXNwb25zZS5wdXNoKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBpbnRlcmNoYW5nZV9wb3NpdGlvbl9hc3Npc3RhbnRfcmVzcG9uc2U6IGZ1bmN0aW9uIGludGVyY2hhbmdlX3Bvc2l0aW9uX2Fzc2lzdGFudF9yZXNwb25zZShpZDEsIGlkMiwgdHlwZSkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmlkID09PSBpZDEpIHsKICAgICAgICAgIHZhciB0ZW1wMSA9IGk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQgPT09IGlkMikgewogICAgICAgICAgdmFyIHRlbXAyID0gaTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciB0bXAgPSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVt0ZW1wMV07CiAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW3RlbXAxXSA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW3RlbXAyXTsKICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbdGVtcDJdID0gdG1wOwoKICAgICAgaWYgKHR5cGUgPT09ICdub3RpZmljYXRpb25fbW9kYWwnKSB7CiAgICAgICAgdGhpcy5vbl9vcGVuX25vdGlmaWNhdGlvbl9tb2RhbCgpOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdzbG90X21vZGFsJykgewogICAgICAgIHRoaXMub25fb3Blbl9zbG90c19tb2RhbCh0aGlzLmVkaXRfc2xvdF9zbG90X3ZhcmlhYmxlLCB0aGlzLmVkaXRfc2xvdF9pbmRleCwgdGhpcy5lZGl0X3Nsb3RfY2hlY2tfZm9yKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnZmlsdGVyX2Fzc2lzdGFuY2UnKSB7CiAgICAgICAgdGhpcy5maWx0ZXJfYXNpc3RhbmNlX3Jlc3BvbnNlKCk7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3dlYmhvb2tfbW9kYWwnKSB7CiAgICAgICAgdGhpcy5vbl9vcGVuX3dlYmhvb2tfbW9kYWwoKTsKICAgICAgfQogICAgfSwKICAgIG1hbmFnZV9oYW5kbGVyc19pbnRlcmNoYW5nZV9wb3NpdGlvbl9hc3Npc3RhbnRfcmVzcG9uc2U6IGZ1bmN0aW9uIG1hbmFnZV9oYW5kbGVyc19pbnRlcmNoYW5nZV9wb3NpdGlvbl9hc3Npc3RhbnRfcmVzcG9uc2UoaWQxLCBpZDIsIGluZCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzW2ldLmlkID09PSBpZDEpIHsKICAgICAgICAgIHZhciB0ZW1wMSA9IGk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaV0uaWQgPT09IGlkMikgewogICAgICAgICAgdmFyIHRlbXAyID0gaTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciB0bXAgPSB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1t0ZW1wMV07CiAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzW3RlbXAxXSA9IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzW3RlbXAyXTsKICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbdGVtcDJdID0gdG1wOwogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS4kc2V0KHZtLm1hbmFnZV9oYW5kbGVycywgaW5kLCB2bS5tYW5hZ2VfaGFuZGxlcnNbaW5kXSk7CiAgICB9LAogICAgY2hhbmdlX2J0bl92YWx1ZV9wbGFjZWhvbGRlcjogZnVuY3Rpb24gY2hhbmdlX2J0bl92YWx1ZV9wbGFjZWhvbGRlcih0eXBlKSB7CiAgICAgIGlmICh0eXBlID09PSAicG9zdGJhY2siKSB7CiAgICAgICAgcmV0dXJuICJFbnRlciB2YWx1ZSI7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gInVybCIpIHsKICAgICAgICByZXR1cm4gIkVudGVyIFVSTCI7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVkX2VudGl0eV9saXN0X2FmdGVyX3JlbW92aW5nX3VzZWRfZW50aXR5X2luX3Nsb3Q6IGZ1bmN0aW9uIHVwZGF0ZWRfZW50aXR5X2xpc3RfYWZ0ZXJfcmVtb3ZpbmdfdXNlZF9lbnRpdHlfaW5fc2xvdChlbnRpdHlfbGlzdCwgc2xvdF9saXN0KSB7CiAgICAgIHZhciB0b1JlbW92ZSA9IHNsb3RfbGlzdC5tYXAoZnVuY3Rpb24gKHNsb3QpIHsKICAgICAgICByZXR1cm4gc2xvdC5jaGVja19mb3I7CiAgICAgIH0pOwogICAgICB2YXIgZGlmZmVyZW5jZSA9IGVudGl0eV9saXN0LmZpbHRlcihmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiAhdG9SZW1vdmUuaW5jbHVkZXMoeCk7CiAgICAgIH0pOwogICAgICByZXR1cm4gZGlmZmVyZW5jZTsKICAgIH0sCiAgICBsb2FkX3Nsb3RfdmFyaWFibGU6IGZ1bmN0aW9uIGxvYWRfc2xvdF92YXJpYWJsZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fZGlhbG9nX3RyZWUoKSwgewogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBpc19nZXRfc2xvdF92YXJpYWJsZTogdHJ1ZSwKICAgICAgICBub2RlX2lkOiB0aGlzLm5vZGVfaWQudG9TdHJpbmcoKQogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKF90aGlzMi5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEVfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXMyLnNsb3RfdmFyaWFibGUgPSByZXNwb25zZS5kYXRhLmRhdGEuc2xvdHNfbGlzdDsKICAgICAgICB9IGVsc2UgaWYgKF90aGlzMi5hcGlfc3RhdHVzX2NvZGUuTk9fU0xPVFNfRk9VTkRfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGx0KCdkaWFsb2dfZmxvd19sb2FkX3Nsb3RfaW50ZXJuYWxfc2VydmVyX21zZycpLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBfdGhpczIuYWRkX3RvX2luc2VydF9zbG90X3ZhcmlhYmxlX29wdGlvbnMoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczIuYWRkX3RvX2luc2VydF9zbG90X3ZhcmlhYmxlX29wdGlvbnMoKTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczIuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjaXJjbGVfbW91c2VvdmVyOiBmdW5jdGlvbiBjaXJjbGVfbW91c2VvdmVyKGlkLCBudW0pIHsKICAgICAgJCgiI2luc2VydF92YXJpYWJsZV9jaXJjbGVfIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnRvZ2dsZUNsYXNzKCJpbnNlcnRfdmFyaWFibGVfY2lyY2xlIik7CiAgICB9LAogICAgY2lyY2xlX21vdXNlb3V0OiBmdW5jdGlvbiBjaXJjbGVfbW91c2VvdXQoaWQsIG51bSkgewogICAgICAkKCIjaW5zZXJ0X3ZhcmlhYmxlX2NpcmNsZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkudG9nZ2xlQ2xhc3MoImluc2VydF92YXJpYWJsZV9jaXJjbGUiKTsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfY2lyY2xlX21vdXNlb3ZlcjogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2NpcmNsZV9tb3VzZW92ZXIoaWQsIG51bSkgewogICAgICAkKCIjbWFuYWdlX2hhbmRsZXJzX2luc2VydF92YXJpYWJsZV9jaXJjbGVfIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnRvZ2dsZUNsYXNzKCJpbnNlcnRfdmFyaWFibGVfY2lyY2xlIik7CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2NpcmNsZV9tb3VzZW91dDogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2NpcmNsZV9tb3VzZW91dChpZCwgbnVtKSB7CiAgICAgICQoIiNtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX2NpcmNsZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkudG9nZ2xlQ2xhc3MoImluc2VydF92YXJpYWJsZV9jaXJjbGUiKTsKICAgIH0sCiAgICBpbnNlcnRfdmFyaWFibGVfYmxvY2tfb2ZmOiBmdW5jdGlvbiBpbnNlcnRfdmFyaWFibGVfYmxvY2tfb2ZmKGlkLCBudW0pIHsKICAgICAgJCgiI2luc2VydF92YXJpYWJsZV9ibG9jayIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS50b2dnbGVDbGFzcygiaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrIik7CiAgICB9LAogICAgaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrX29uOiBmdW5jdGlvbiBpbnNlcnRfdmFyaWFibGVfYmxvY2tfb24oaWQsIG51bSkgewogICAgICAkKCIjaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnRvZ2dsZUNsYXNzKCJpbnNlcnRfdmFyaWFibGVfYmxvY2siKTsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrX29mZjogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2luc2VydF92YXJpYWJsZV9ibG9ja19vZmYoaWQsIG51bSkgewogICAgICAkKCIjbWFuYWdlX2hhbmRsZXJzX2luc2VydF92YXJpYWJsZV9ibG9jayIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS50b2dnbGVDbGFzcygiaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrIik7CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2luc2VydF92YXJpYWJsZV9ibG9ja19vbjogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2luc2VydF92YXJpYWJsZV9ibG9ja19vbihpZCwgbnVtKSB7CiAgICAgICQoIiNtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnRvZ2dsZUNsYXNzKCJpbnNlcnRfdmFyaWFibGVfYmxvY2siKTsKICAgIH0sCiAgICBzZXRfYXNzaXN0YW5jZV9yZXNwb25zZV9pbmRleDogZnVuY3Rpb24gc2V0X2Fzc2lzdGFuY2VfcmVzcG9uc2VfaW5kZXgoaWQsIG51bSkgewogICAgICAkKCIjYXNzaXN0YW5jZV9yZXNwb25zZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkuZm9jdXMoKTsKICAgICAgdGhpcy5hc3Npc3RhbmNlX3Jlc3BvbnNlX2lkID0gaWQ7CiAgICAgIHRoaXMuYXNzaXN0YW5jZV9yZXNwb25zZV9fdmFsX2luZGV4ID0gbnVtOwogICAgICB0aGlzLmFkZF90b19pbnNlcnRfc2xvdF92YXJpYWJsZV9vcHRpb25zKCk7CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX3NldF9hc3Npc3RhbmNlX3Jlc3BvbnNlX2luZGV4OiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfc2V0X2Fzc2lzdGFuY2VfcmVzcG9uc2VfaW5kZXgoaWQsIG51bSwgaW5kKSB7CiAgICAgICQoIiNtYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkuZm9jdXMoKTsKICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNfaW5kID0gaW5kOwogICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlX2lkID0gaWQ7CiAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzX2Fzc2lzdGFuY2VfcmVzcG9uc2VfX3ZhbF9pbmRleCA9IG51bTsKICAgICAgdGhpcy5hZGRfdG9faW5zZXJ0X3Nsb3RfdmFyaWFibGVfb3B0aW9ucygpOwogICAgfSwKICAgIGFkZFRhZzogZnVuY3Rpb24gYWRkVGFnKG5ld1RhZykgewogICAgICB0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnNsb3QgPSBuZXdUYWc7CiAgICB9LAogICAgYWRkX3RvX2luc2VydF9zbG90X3ZhcmlhYmxlX29wdGlvbnM6IGZ1bmN0aW9uIGFkZF90b19pbnNlcnRfc2xvdF92YXJpYWJsZV9vcHRpb25zKCkgewogICAgICB2YXIgdGVtcDEgPSBbXTsKICAgICAgdmFyIHRlbXAgPSB0aGlzLnNsb3RzLm1hcChmdW5jdGlvbiAoc2xvdCkgewogICAgICAgIHJldHVybiBzbG90LnNsb3Q7CiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtICE9ICIiOwogICAgICB9KTsKCiAgICAgIGlmIChCb29sZWFuKHRoaXMud2ViaG9va192YXJpYWJsZSkpIHsKICAgICAgICB0ZW1wMS5wdXNoKCIkIiArIHRoaXMud2ViaG9va192YXJpYWJsZSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIG1lcmdlTm9EdXBsaWNhdGVzKCkgewogICAgICAgIHZhciBtZXJnZWRBcnJheSA9IFtdOwoKICAgICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJyYXlzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgICAgYXJyYXlzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgICAgIH0KCiAgICAgICAgYXJyYXlzLmZvckVhY2goZnVuY3Rpb24gKGFycmF5KSB7CiAgICAgICAgICBtZXJnZWRBcnJheSA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkobWVyZ2VkQXJyYXkpLCBfdG9Db25zdW1hYmxlQXJyYXkoYXJyYXkpKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gX3RvQ29uc3VtYWJsZUFycmF5KG5ldyBTZXQoX3RvQ29uc3VtYWJsZUFycmF5KG1lcmdlZEFycmF5KSkpOwogICAgICB9CgogICAgICB0aGlzLmluc2VydF9zbG90X3ZhcmlhYmxlX29wdGlvbnMgPSBtZXJnZU5vRHVwbGljYXRlcyh0ZW1wLCB0ZW1wMSwgdGhpcy5zbG90X3ZhcmlhYmxlKTsKICAgIH0sCiAgICBpbnNlcnRfc2xvdF92YXJpYWJsZV90b19hc3Npc3RhbmNlX3Jlc3BvbnNlOiBmdW5jdGlvbiBpbnNlcnRfc2xvdF92YXJpYWJsZV90b19hc3Npc3RhbmNlX3Jlc3BvbnNlKHZhcmlhYmxlKSB7CiAgICAgIHZhciBpZCA9IHRoaXMuYXNzaXN0YW5jZV9yZXNwb25zZV9pZDsKICAgICAgdmFyIG51bSA9IHRoaXMuYXNzaXN0YW5jZV9yZXNwb25zZV9fdmFsX2luZGV4OwogICAgICAkKCIjYXNzaXN0YW5jZV9yZXNwb25zZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkuZm9jdXMoKTsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdmFyIGN1cnNvclBvcyA9ICQoIiNhc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS5wcm9wKCJzZWxlY3Rpb25TdGFydCIpOwogICAgICB2YXIgdiA9ICQoIiNhc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS52YWwoKTsKICAgICAgdmFyIHRleHRCZWZvcmUgPSB2LnN1YnN0cmluZygwLCBjdXJzb3JQb3MpOwogICAgICB2YXIgdGV4dEFmdGVyID0gdi5zdWJzdHJpbmcoY3Vyc29yUG9zLCB2Lmxlbmd0aCk7IC8vICQoJyNhc3Npc3RhbmNlX3Jlc3BvbnNlXycrIGlkICsgJ18nICsgbnVtKS52YWwoIHRleHRCZWZvcmUrIGFtICt0ZXh0QWZ0ZXIgKTsKCiAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2lkXS52YWx1ZXNbbnVtXSA9IHRleHRCZWZvcmUgKyAieyIgKyB2YXJpYWJsZSArICJ9IiArIHRleHRBZnRlcjsKICAgICAgdm0uJHNldCh2bS5hc3Npc3RhbnRfcmVzcG9uc2UsIGlkLCB2bS5hc3Npc3RhbnRfcmVzcG9uc2VbaWRdKTsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3Nsb3RfdmFyaWFibGVfdG9fYXNzaXN0YW5jZV9yZXNwb25zZTogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2luc2VydF9zbG90X3ZhcmlhYmxlX3RvX2Fzc2lzdGFuY2VfcmVzcG9uc2UodmFyaWFibGUpIHsKICAgICAgdmFyIGluZCA9IHRoaXMubWFuYWdlX2hhbmRsZXJzX2luZDsKICAgICAgdmFyIGlkID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV9pZDsKICAgICAgdmFyIG51bSA9IHRoaXMubWFuYWdlX2hhbmRsZXJzX2Fzc2lzdGFuY2VfcmVzcG9uc2VfX3ZhbF9pbmRleDsKICAgICAgJCgiI21hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS5mb2N1cygpOwogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2YXIgY3Vyc29yUG9zID0gJCgiI21hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS5wcm9wKCJzZWxlY3Rpb25TdGFydCIpOwogICAgICB2YXIgdiA9ICQoIiNtYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkudmFsKCk7CiAgICAgIHZhciB0ZXh0QmVmb3JlID0gdi5zdWJzdHJpbmcoMCwgY3Vyc29yUG9zKTsKICAgICAgdmFyIHRleHRBZnRlciA9IHYuc3Vic3RyaW5nKGN1cnNvclBvcywgdi5sZW5ndGgpOyAvLyAkKCcjbWFuYWdlX2hhbmRsZXJzX2Fzc2lzdGFuY2VfcmVzcG9uc2VfJysgaWQgKyAnXycgKyBudW0pLnZhbCggdGV4dEJlZm9yZSsgYW0gK3RleHRBZnRlciApOwoKICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaWRdLnZhbHVlc1tudW1dID0gdGV4dEJlZm9yZSArICJ7IiArIHZhcmlhYmxlICsgIn0iICsgdGV4dEFmdGVyOwogICAgICB2bS4kc2V0KHZtLm1hbmFnZV9oYW5kbGVycywgaW5kLCB2bS5tYW5hZ2VfaGFuZGxlcnNbaW5kXSk7CiAgICB9LAogICAgYWRkX3JlbW92ZV90b19tYW5hZ2VfaGFuZGxlcl9saXN0OiBmdW5jdGlvbiBhZGRfcmVtb3ZlX3RvX21hbmFnZV9oYW5kbGVyX2xpc3QoZnVuYywgaW5kKSB7CiAgICAgIGlmIChmdW5jID09PSAiYWRkIikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzLnB1c2goewogICAgICAgICAgaWQ6IERhdGUubm93KCksCiAgICAgICAgICBub2RlX3R5cGU6ICJldmVudF9oYW5kbGVyIiwKICAgICAgICAgIG5hbWU6ICIiLAogICAgICAgICAgdHJpZ2dlcnM6IFt7CiAgICAgICAgICAgIHRyaWdnZXJfdHlwZTogIiIsCiAgICAgICAgICAgIHRyaWdnZXJfdmFsdWU6ICIiCiAgICAgICAgICB9XSwKICAgICAgICAgIHJlc3BvbnNlczogW10sCiAgICAgICAgICBwYXJlbnRfbm9kZTogdGhpcy5ub2RlX2lkLAogICAgICAgICAgcHJldmlvdXNfbm9kZTogIiIsCiAgICAgICAgICBuZXh0X3N0ZXA6IHsKICAgICAgICAgICAgYmVoYXZpb3I6ICJza2lwX2FsbF9zbG90cyIsCiAgICAgICAgICAgIHNlbGVjdG9yOiBudWxsLAogICAgICAgICAgICBub2RlX2lkOiBudWxsCiAgICAgICAgICB9LAogICAgICAgICAgZXZlbnRfbmFtZTogImdlbmVyaWMiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVycy5zcGxpY2UoaW5kLCAxKTsKICAgICAgfQogICAgfSwKICAgIHNldF93ZWJob29rX3JldHVybl92YXJpYWJsZTogZnVuY3Rpb24gc2V0X3dlYmhvb2tfcmV0dXJuX3ZhcmlhYmxlKHdlYmhvb2tfaWQpIHsKICAgICAgY29uc29sZS5sb2cod2ViaG9va19pZCwgIi0tIik7CiAgICAgIHRoaXMud2ViaG9va192YXJpYWJsZSA9IHRoaXMud2ViaG9va19saXN0LmZpbHRlcihmdW5jdGlvbiAoaWQpIHsKICAgICAgICByZXR1cm4gaWQuaWQgPT0gd2ViaG9va19pZDsKICAgICAgfSlbMF0ubmFtZS5yZXBsYWNlKC9ccysvZywgIl8iKTsKICAgIH0sCiAgICBsb2FkX3NhdmVkX2RpYWxvZ190cmVlOiBmdW5jdGlvbiBsb2FkX3NhdmVkX2RpYWxvZ190cmVlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZm9ybV9hdXRvbWF0aW9uX2RpYWxvZ190cmVlKCksIHsKICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgaXNfZ2V0OiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczMuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChfdGhpczMuYXBpX3N0YXR1c19jb2RlLk5PREVfU1RSVUNUVVJFX1JFQ0VJVkVEX01PREVMUy5NU0dfQ09ERSA9PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIF90aGlzMy5kYXRhID0gbmV3IFRyZWUocmVzcG9uc2UuZGF0YS5kYXRhLm5vZGVfc3RydWN0dXJlWzBdLm5vZGVzdHJ1Y3R1cmUpOwoKICAgICAgICAgIF90aGlzMy5nZXRfbm9kZXNfbGlzdChfdGhpczMuZGF0YSk7CiAgICAgICAgfSBlbHNlIGlmIChfdGhpczMuYXBpX3N0YXR1c19jb2RlLk5PREVfU1RSVUNUVVJFX05PVF9FWElTVFNfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiBfdGhpczMudGx0KCdkaWFsb2dfZmxvd19jcmVhdGVfZGlhbG9nX3RyZWVfbXNnJyksCiAgICAgICAgICAgIHRleHQ6IF90aGlzMy50bHQoJ2RpYWxvZ19mbG93X2FkZGluZ19ub2Rlc19tc2cnKSwKICAgICAgICAgICAgdHlwZTogImluZm8iLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiBfdGhpczMudGx0KCdkaWFsb2dfZmxvd19sb2FkX3NhdmVkX2ludGVybmFsX3NlcnZlcl9tc2cnKSwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczMuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXMzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgbG9hZF93ZWJob29rOiBmdW5jdGlvbiBsb2FkX3dlYmhvb2soKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fd2ViaG9va19kZXRhaWxzKCksIHsKICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgaXNfZ2V0OiB0cnVlLAogICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgcGVyX3BhZ2U6IDQwCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczQuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgX3RoaXM0LndlYmhvb2tfbGlzdCA9IFtdOwoKICAgICAgICBpZiAoX3RoaXM0LmFwaV9zdGF0dXNfY29kZS5XRUJIT09LX0RFVEFJTFNfUkVDRUlWRURfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXM0LmlzX3dlYmhvb2tfZGV0YWlscyA9IHRydWU7CgogICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLmRhdGEud2ViaG9va1swXS53ZWJob29rKSB7CiAgICAgICAgICAgIF90aGlzNC53ZWJob29rX2xpc3QucHVzaChyZXNwb25zZS5kYXRhLmRhdGEud2ViaG9va1swXS53ZWJob29rW2ldKTsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKF90aGlzNC53ZWJob29rX2xpc3QpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoX3RoaXM0LmFwaV9zdGF0dXNfY29kZS5XRUJIT09LX0RFVEFJTFNfTk9UX0VYSVNUU19NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBfdGhpczQuaXNfd2ViaG9va19kZXRhaWxzID0gZmFsc2U7CiAgICAgICAgICBfdGhpczQud2ViaG9va19pZCA9IG51bGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgdGV4dDogdGx0KCdkaWFsb2dfZmxvd19sb2FkX3dlYmhvb2tfaW50ZXJuYWxfc2VydmVyX21zZycpLAogICAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgIF90aGlzNC5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczQuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBsb2FkX2ludGVudDogZnVuY3Rpb24gbG9hZF9pbnRlbnQoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fc2F2ZV9pbnRlbnRfZXhhbXBsZSgpLCB7CiAgICAgICAgaXNfZ2V0OiB0cnVlLAogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICBwZXJfcGFnZTogNDAKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzNS5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKF90aGlzNS5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEVfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXM1LnRyaWdnZXJfb3B0aW9uc19pbnRlbnQgPSBbXTsKICAgICAgICAgIF90aGlzNS5pbnRlbnRfbGlzdF9jaG9pY2VfY2FyZCA9IFtdOwoKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzcG9uc2UuZGF0YS5kYXRhLmRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgX3RoaXM1LnRyaWdnZXJfb3B0aW9uc19pbnRlbnQucHVzaChyZXNwb25zZS5kYXRhLmRhdGEuZGF0YVtpXS5JbnRlbnQpOwoKICAgICAgICAgICAgX3RoaXM1LmludGVudF9saXN0X2Nob2ljZV9jYXJkLnB1c2goIi8iLmNvbmNhdChyZXNwb25zZS5kYXRhLmRhdGEuZGF0YVtpXS5JbnRlbnQpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczUuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXM1LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgbG9hZF9lbnRpdHk6IGZ1bmN0aW9uIGxvYWRfZW50aXR5KCkgewogICAgICB2YXIgX2F4aW9zJHBvc3QsCiAgICAgICAgICBfdGhpczYgPSB0aGlzOwoKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fYWRkX2VudGl0eSgpLCAoX2F4aW9zJHBvc3QgPSB7CiAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbAogICAgICB9LCBfZGVmaW5lUHJvcGVydHkoX2F4aW9zJHBvc3QsICJsaWNlbnNlX2tleSIsIHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSksIF9kZWZpbmVQcm9wZXJ0eShfYXhpb3MkcG9zdCwgInRva2VuIiwgdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucyksIF9kZWZpbmVQcm9wZXJ0eShfYXhpb3MkcG9zdCwgInN1YnNjcmlwdGlvbiIsIHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24pLCBfZGVmaW5lUHJvcGVydHkoX2F4aW9zJHBvc3QsICJpc19nZXRfZW50aXR5IiwgdHJ1ZSksIF9kZWZpbmVQcm9wZXJ0eShfYXhpb3MkcG9zdCwgInBhZ2Vfbm8iLCAxKSwgX2RlZmluZVByb3BlcnR5KF9heGlvcyRwb3N0LCAicGVyX3BhZ2UiLCA0MCksIF9heGlvcyRwb3N0KSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzNi5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKF90aGlzNi5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEVfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIF90aGlzNi5lbnRpdHlfbGlzdCA9IFtdOwogICAgICAgICAgX3RoaXM2LnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzID0gW107CiAgICAgICAgICBfdGhpczYudHJpZ2dlcl9vcHRpb25zX2VudGl0eSA9IFtdOwoKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzcG9uc2UuZGF0YS5kYXRhLmVudGl0eV9uYW1lcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBfdGhpczYuZW50aXR5X2xpc3QucHVzaChyZXNwb25zZS5kYXRhLmRhdGEuZW50aXR5X25hbWVzW2ldLmVudGl0eSk7CgogICAgICAgICAgICBfdGhpczYudHJpZ2dlcl9vcHRpb25zX2VudGl0eV92YWx1ZXMucHVzaChyZXNwb25zZS5kYXRhLmRhdGEuZW50aXR5X25hbWVzW2ldKTsKCiAgICAgICAgICAgIF90aGlzNi50cmlnZ2VyX29wdGlvbnNfZW50aXR5LnB1c2gocmVzcG9uc2UuZGF0YS5kYXRhLmVudGl0eV9uYW1lc1tpXS5lbnRpdHkpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoX3RoaXM2LmFwaV9zdGF0dXNfY29kZS5FTVBUWV9EQVRBX01PREVMUy5NU0dfQ09ERSA9PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0bHQoJ2RpYWxvZ19mbG93X2FkZF9zb21lX2VudGl0aWVzX21zZycpLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXM2LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzNi4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGxvYWRfdGVtcGxhdGVzOiBmdW5jdGlvbiBsb2FkX3RlbXBsYXRlcygpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnRlbXBsYXRlX3Byb21vdGlvbmFsX2VtYWlsKCksIHsKICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgaXNfZ2V0OiB0cnVlLAogICAgICAgIGlzX25vdGlmaWNhdGlvbjogdHJ1ZSwKICAgICAgICBwYWdlX25vOiAxLAogICAgICAgIHBlcl9wYWdlOiA0MAogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM3LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICBpZiAoX3RoaXM3LmFwaV9zdGF0dXNfY29kZS5TVEFUVVNfU1VDQ0VTU19NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXM3Lm5vdGlmaWNhdGlvbnNfbm90aWZ5X3RlbXBsYXRlX2xpc3QgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgfSBlbHNlIGlmIChfdGhpczcuYXBpX3N0YXR1c19jb2RlLlVOU1VDQ0VTU0ZVTF9EQl9PUEVSQVRJT05fTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIF90aGlzNy5ub3RpZmljYXRpb25zX25vdGlmeV90ZW1wbGF0ZV9saXN0ID0gW107CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXM3LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzNy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNoZWNrX3Nsb3RfdmFsdWVfdXNlX2luX3Jlc3BvbnNlOiBmdW5jdGlvbiBjaGVja19zbG90X3ZhbHVlX3VzZV9pbl9yZXNwb25zZShyZXNwb25zZSkgewogICAgICBpZiAoQm9vbGVhbihyZXNwb25zZS5pbmNsdWRlcygieyIpKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIHZpc2libGVfdHJ5X2JvdDogZnVuY3Rpb24gdmlzaWJsZV90cnlfYm90KCkgewogICAgICB0aGlzLmxvYWRfYm90X3ByZXZpZXcgPSAhdGhpcy5sb2FkX2JvdF9wcmV2aWV3OwogICAgfSwKICAgIGlzX2VudGl0eV90eXBlX3N5c19wYXR0ZXJuOiBmdW5jdGlvbiBpc19lbnRpdHlfdHlwZV9zeXNfcGF0dGVybih0cmlnZ2VyX3ZhbHVlKSB7CiAgICAgIHZhciBhID0gdGhpcy50cmlnZ2VyX29wdGlvbnNfZW50aXR5X3ZhbHVlcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5lbnRpdHkgPT0gdHJpZ2dlcl92YWx1ZTsKICAgICAgfSk7CiAgICAgIHRoaXMuc2VsZWN0ZWRfZW50aXR5ID0gdHJpZ2dlcl92YWx1ZTsKCiAgICAgIGlmIChhLmxlbmd0aCA+IDApIHsKICAgICAgICBpZiAodGhpcy50cmlnZ2VyX29wdGlvbnNfZW50aXR5X3ZhbHVlcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmVudGl0eSA9PSB0cmlnZ2VyX3ZhbHVlOwogICAgICAgIH0pWzBdLnR5cGUgPT09ICJwYXR0ZXJuIiB8fCB0aGlzLnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uZW50aXR5ID09IHRyaWdnZXJfdmFsdWU7CiAgICAgICAgfSlbMF0udHlwZSA9PT0gInN5c3RlbSIpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgZW50aXR5X3ZhbHVlX29wdGlvbnM6IGZ1bmN0aW9uIGVudGl0eV92YWx1ZV9vcHRpb25zKHRyaWdnZXJfdmFsdWUpIHsKICAgICAgdmFyIGEgPSB0aGlzLnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmVudGl0eSA9PSB0cmlnZ2VyX3ZhbHVlOwogICAgICB9KTsKICAgICAgdmFyIHRlbXAgPSBbXTsKCiAgICAgIGlmIChhLmxlbmd0aCA+IDApIHsKICAgICAgICB0ZW1wID0gdGhpcy50cmlnZ2VyX29wdGlvbnNfZW50aXR5X3ZhbHVlcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmVudGl0eSA9PSB0cmlnZ2VyX3ZhbHVlOwogICAgICAgIH0pWzBdLnZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgcmV0dXJuIHZhbC52YWx1ZTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRlbXA7CiAgICB9LAogICAgY2hlY2tfaW1hZ2VfdXJsOiBmdW5jdGlvbiBjaGVja19pbWFnZV91cmwodXJsKSB7CiAgICAgIGlmICh0aGlzLnJlZ19pbWFnZS50ZXN0KHVybCkgPT09IHRydWUpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBjaGVja192aWRlb191cmw6IGZ1bmN0aW9uIGNoZWNrX3ZpZGVvX3VybCh1cmwpIHsKICAgICAgaWYgKHRoaXMucmVnX3VybC50ZXN0KHVybCkgPT09IHRydWUpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBzZWFyY2hfd2ViaG9vazogZnVuY3Rpb24gc2VhcmNoX3dlYmhvb2socXVlcnkpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICBpZiAocXVlcnkgIT0gIiIpIHsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fd2ViaG9va19kZXRhaWxzKCksIHsKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHN1YnNjcmlwdGlvbjogIlBsYXRpbnVtIiwKICAgICAgICAgIGlzX3NlYXJjaDogdHJ1ZSwKICAgICAgICAgIHNlYXJjaF90ZXJtOiB0aGlzLnNlYXJjaF9uYW1lLAogICAgICAgICAgcGVyX3BhZ2U6IDQwLAogICAgICAgICAgcGFnZV9ubzogMQogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXM4LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgIGlmIChfdGhpczguYXBpX3N0YXR1c19jb2RlLldFQkhPT0tfREVUQUlMU19SRUNFSVZFRF9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBfdGhpczgud2ViaG9va19saXN0ID0gW107CiAgICAgICAgICAgIF90aGlzOC5pc193ZWJob29rX2RldGFpbHMgPSB0cnVlOwoKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLmRhdGEud2ViaG9va1swXS53ZWJob29rKSB7CiAgICAgICAgICAgICAgX3RoaXM4LndlYmhvb2tfbGlzdC5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS53ZWJob29rWzBdLndlYmhvb2tbaV0pOwoKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfdGhpczgud2ViaG9va19saXN0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChfdGhpczguYXBpX3N0YXR1c19jb2RlLlNFQVJDSF9XRUJIT09LX05PVF9GT1VORF9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgdGV4dDogX3RoaXM4LnRsdCgnZGlhbG9nX2Zsb3dfd2ViaG9va19ub3RfZm91bmRfbXNnJyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDMwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiBfdGhpczgudGx0KCdkaWFsb2dfZmxvd19zZWFyY2hfd2ViaG9va19pbnRlcm5hbF9zZXJ2ZXInKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDIwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICBfdGhpczguJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBzZWFyY2hfaW50ZW50X2VudGl0eTogZnVuY3Rpb24gc2VhcmNoX2ludGVudF9lbnRpdHkodHJpZ2dlcl90eXBlLCBxdWVyeSkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIC8vIGlmKHF1ZXJ5ID09ICIiKXsKICAgICAgLy8gICB0aGlzLnRyaWdnZXJfb3B0aW9uc19pbnRlbnQgPSBbXTsKICAgICAgLy8gICB0aGlzLnRyaWdnZXJfb3B0aW9uc19lbnRpdHkgPSBbXTsKICAgICAgLy8gfQogICAgICBpZiAodGhpcy5pc19yb290IHx8IHRyaWdnZXJfdHlwZSA9PT0gImludGVudCIpIHsKICAgICAgICBpZiAocXVlcnkgIT0gIiIpIHsKICAgICAgICAgIHRoaXMuaXNfbG9hZGluZyA9IHRydWU7CiAgICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fc2F2ZV9pbnRlbnRfZXhhbXBsZSgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBzdWJzY3JpcHRpb246ICJQbGF0aW51bSIsCiAgICAgICAgICAgIGlzX3NlYXJjaDogdHJ1ZSwKICAgICAgICAgICAgc2VhcmNoX2tleTogcXVlcnksCiAgICAgICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgICAgIHBlcl9wYWdlOiA0MAogICAgICAgICAgfSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKF90aGlzOS5hcGlfc3RhdHVzX2NvZGUuRU1QVFlfREFUQV9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgIC8vIHRvYXN0ci5lcnJvcigiTm8gUmVzdWx0cyBGb3VuZCIpOwogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogX3RoaXM5LnRsdCgnZGlhbG9nX2Zsb3dfbm9fcmVzdWx0X2ZvdW5kX21zZycpLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpczkuYXBpX3N0YXR1c19jb2RlLkRBVEFfQVZBSUxBQkxFX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgX3RoaXM5LnRyaWdnZXJfb3B0aW9uc19pbnRlbnQgPSBbXTsKICAgICAgICAgICAgICBfdGhpczkuaW50ZW50X2xpc3RfY2hvaWNlX2NhcmQgPSBbXTsKCiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5kYXRhLmRhdGEuUmVzcG9uc2VMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBfdGhpczkudHJpZ2dlcl9vcHRpb25zX2ludGVudC5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS5SZXNwb25zZUxpc3RbaV0uSW50ZW50KTsKCiAgICAgICAgICAgICAgICBfdGhpczkuaW50ZW50X2xpc3RfY2hvaWNlX2NhcmQucHVzaChyZXNwb25zZS5kYXRhLmRhdGEuUmVzcG9uc2VMaXN0W2ldLkludGVudCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIHRvYXN0ci5lcnJvcigiSW50cm5hbCBTZXJ2ZXIgRXJyb3IiKTsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IF90aGlzOS50bHQoJ2RpYWxvZ19mbG93X2ludGVybmFsX3NlcnZlcl9tc2cxJyksCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgX3RoaXM5LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuaXNfbG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmxvYWRfaW50ZW50KCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRyaWdnZXJfdHlwZSA9PT0gImVudGl0eSIpIHsKICAgICAgICBpZiAocXVlcnkgIT0gIiIpIHsKICAgICAgICAgIHRoaXMuaXNfbG9hZGluZyA9IHRydWU7CiAgICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fYWRkX2VudGl0eSgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBzdWJzY3JpcHRpb246ICJQbGF0aW51bSIsCiAgICAgICAgICAgIGlzX3NlYXJjaDogdHJ1ZSwKICAgICAgICAgICAgc2VhcmNoX2tleTogcXVlcnksCiAgICAgICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgICAgIHBlcl9wYWdlOiA0MAogICAgICAgICAgfSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKF90aGlzOS5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEVfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICBfdGhpczkudHJpZ2dlcl9vcHRpb25zX2VudGl0eSA9IFtdOwogICAgICAgICAgICAgIF90aGlzOS50cmlnZ2VyX29wdGlvbnNfZW50aXR5X3ZhbHVlcyA9IFtdOwoKICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3BvbnNlLmRhdGEuZGF0YS5lbnRpdGllc19zZWFyY2gubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIF90aGlzOS50cmlnZ2VyX29wdGlvbnNfZW50aXR5X3ZhbHVlcy5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS5lbnRpdGllc19zZWFyY2hbaV0pOwoKICAgICAgICAgICAgICAgIF90aGlzOS50cmlnZ2VyX29wdGlvbnNfZW50aXR5LnB1c2gocmVzcG9uc2UuZGF0YS5lbnRpdGllc19zZWFyY2hbaV0uZW50aXR5KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXM5LmFwaV9zdGF0dXNfY29kZS5FTVBUWV9EQVRBX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiBfdGhpczkudGx0KCdkaWFsb2dfZmxvd19ub19yZXN1bHRfZm91bmRfbXNnMScpLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyB0b2FzdHIuZXJyb3IoIkludHJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiBfdGhpczkudGx0KCdkaWFsb2dfZmxvd19pbnRlcm5hbF9zZXJ2ZXJfbXNnMycpLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICAgIF90aGlzOS4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmlzX2xvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5sb2FkX2VudGl0eSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNlYXJjaF9lbnRpdHk6IGZ1bmN0aW9uIHNlYXJjaF9lbnRpdHkocXVlcnkpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgaWYgKHF1ZXJ5ICE9ICIiKSB7CiAgICAgICAgdGhpcy5pc19sb2FkaW5nID0gdHJ1ZTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fYWRkX2VudGl0eSgpLCB7CiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBzdWJzY3JpcHRpb246ICJQbGF0aW51bSIsCiAgICAgICAgICBpc19zZWFyY2g6IHRydWUsCiAgICAgICAgICBzZWFyY2hfa2V5OiBxdWVyeSwKICAgICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgICBwZXJfcGFnZTogNDAKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzMTAuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgaWYgKF90aGlzMTAuYXBpX3N0YXR1c19jb2RlLkRBVEFfQVZBSUxBQkxFX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIF90aGlzMTAuZW50aXR5X2xpc3QgPSBbXTsKCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzcG9uc2UuZGF0YS5kYXRhLmVudGl0aWVzX3NlYXJjaC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIF90aGlzMTAuZW50aXR5X2xpc3QucHVzaChyZXNwb25zZS5kYXRhLmRhdGEuZW50aXRpZXNfc2VhcmNoW2ldLmVudGl0eSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMxMC5hcGlfc3RhdHVzX2NvZGUuRU1QVFlfREFUQV9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiBfdGhpczEwLnRsdCgnZGlhbG9nX2Zsb3dfbm9fcmVzdWx0X2ZvdW5kX21zZzInKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyB0b2FzdHIuZXJyb3IoIkludHJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IF90aGlzMTAudGx0KCdkaWFsb2dfZmxvd19pbnRlcm5hbF9zZXJ2ZXJfbXNnNCcpLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICBfdGhpczEwLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuaXNfbG9hZGluZyA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubG9hZF9lbnRpdHkoKTsKICAgICAgfQogICAgfSwKICAgIHNlYXJjaF9mb3JfZW50aXR5X2hhc192YWxpZGF0aW9uOiBmdW5jdGlvbiBzZWFyY2hfZm9yX2VudGl0eV9oYXNfdmFsaWRhdGlvbihxdWVyeSkgewogICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CgogICAgICBpZiAocXVlcnkgIT0gIiIpIHsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fYWRkX2VudGl0eSgpLCB7CiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBzdWJzY3JpcHRpb246ICJQbGF0aW51bSIsCiAgICAgICAgICBpc192YWxpZGF0aW9uX2VudGl0eTogdHJ1ZSwKICAgICAgICAgIGVudGl0eTogcXVlcnkKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzMTEuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgaWYgKF90aGlzMTEuYXBpX3N0YXR1c19jb2RlLkVOVElUWV9IQVNfVkFMSURBVElPTl9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBfdGhpczExLmlzX3ZhbGlkYXRpb25fZW50aXR5ID0gdHJ1ZTsKICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMxMS5hcGlfc3RhdHVzX2NvZGUuRU5USVRZX0hBU19OT19WQUxJREFUSU9OLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgX3RoaXMxMS5pc192YWxpZGF0aW9uX2VudGl0eSA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXMxMS5pc192YWxpZGF0aW9uX2VudGl0eSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBfdGhpczExLmlzX3ZhbGlkYXRpb25fZW50aXR5ID0gZmFsc2U7CgogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzMTEuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc192YWxpZGF0aW9uX2VudGl0eSA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgc2VhcmNoX3RlbXBsYXRlX25hbWU6IGZ1bmN0aW9uIHNlYXJjaF90ZW1wbGF0ZV9uYW1lKHF1ZXJ5KSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIGlmIChxdWVyeSAhPSAiIikgewogICAgICAgIHRoaXMuaXNfbG9hZGluZyA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfZW1haWwoKSwgewogICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgc3Vic2NyaXB0aW9uOiAiUGxhdGludW0iLAogICAgICAgICAgaXNfc2VhcmNoOiB0cnVlLAogICAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0cnVlLAogICAgICAgICAgc2VhcmNoX2tleTogcXVlcnksCiAgICAgICAgICBwYWdlX25vOiAxLAogICAgICAgICAgcGVyX3BhZ2U6IDQwCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczEyLnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgIGlmIChfdGhpczEyLmFwaV9zdGF0dXNfY29kZS5URU1QTEFURV9ET0VTX05PVF9FWElTVFNfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogX3RoaXMxMi50bHQoJ2RpYWxvZ19mbG93X25vX3Jlc3VsdF9mb3VuZF9tc2czJyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmIChfdGhpczEyLmFwaV9zdGF0dXNfY29kZS5URU1QTEFURV9TRUFSQ0hfUkVTVUxUX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIF90aGlzMTIubm90aWZpY2F0aW9uc19ub3RpZnlfdGVtcGxhdGVfbGlzdCA9IFtdOwoKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5kYXRhLmRhdGEudGVtcGxhdGVfc2VhcmNoLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgX3RoaXMxMi5ub3RpZmljYXRpb25zX25vdGlmeV90ZW1wbGF0ZV9saXN0LnB1c2gocmVzcG9uc2UuZGF0YS5kYXRhLnRlbXBsYXRlX3NlYXJjaFtpXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzMTIuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5pc19sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5sb2FkX3RlbXBsYXRlcygpOwogICAgICB9CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2FycmFuZ2VfaWRzX2Z1bmN0aW9uOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfYXJyYW5nZV9pZHNfZnVuY3Rpb24oaW5kKSB7CiAgICAgIGlmICh0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcyAhPSBbXSkgewogICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMpIHsKICAgICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzW2ldLmlkID0gaS50b1N0cmluZygpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFycmFuZ2VfaWRzX2Z1bmN0aW9uOiBmdW5jdGlvbiBhcnJhbmdlX2lkc19mdW5jdGlvbigpIHsKICAgICAgLy9Gb3IgcmVzcG9uc2VzIHJld3JpdGUgaWRzCiAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZSAhPSBbXSkgewogICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UpIHsKICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmlkID0gaS50b1N0cmluZygpOwogICAgICAgIH0KICAgICAgfSAvL0ZvciBzbG90cyByZXdyaXRlIGlkcwoKCiAgICAgIGlmICh0aGlzLnNsb3RzICE9IFtdKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnNsb3RzKSB7CiAgICAgICAgICB0aGlzLnNsb3RzW2ldLnJlc3BvbnNlcyA9IFtdOwogICAgICAgICAgdmFyIHRlbXAgPSB0aGlzLnNsb3RzW2ldLnNsb3Q7CgogICAgICAgICAgZm9yICh2YXIgaiBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Vbal0ucmVjb2duaXplcyA9PSB0ZW1wKSB7CiAgICAgICAgICAgICAgdGhpcy5zbG90c1tpXS5yZXNwb25zZXMucHVzaCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5pZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy9Gb3Igbm90aWZpY2F0aW9uIHJld3JpdGUgaWRzCgoKICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXMgIT0gW10pIHsKICAgICAgICB0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzID0gW107CgogICAgICAgIGZvciAodmFyIGogaW4gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UpIHsKICAgICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5yZWNvZ25pemVzID09ICJzdWNjZXNzZnVsIiB8fCB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5yZWNvZ25pemVzID09ICJ1bnN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICAgIHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXMucHVzaCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5pZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8gYXJyYW5nZV9pZHNfZnVuY3Rpb25fZm9yX25vdGlmaWNhdGlvbigpewogICAgLy8gICAvL0ZvciByZXNwb25zZXMgcmV3cml0ZSBpZHMKICAgIC8vICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlICE9IFtdKSB7CiAgICAvLyAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgLy8gICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQgPSBpLnRvU3RyaW5nKCk7CiAgICAvLyAgICAgfQogICAgLy8gICB9CiAgICAvLyAgIC8vRm9yIG5vdGlmaWNhdGlvbiByZXdyaXRlIGlkcwogICAgLy8gICBpZiAodGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcyAhPSBbXSkgewogICAgLy8gICAgICAgdGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcyA9IFtdOwogICAgLy8gICAgICAgZm9yICh2YXIgaiBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgLy8gICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Vbal0ucmVjb2duaXplcyA9PSAic3VjY2Vzc2Z1bCIgfHwKICAgIC8vICAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5yZWNvZ25pemVzID09ICJ1bnN1Y2Nlc3NmdWwiKSB7CiAgICAvLyAgICAgICAgICAgICB0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzLnB1c2godGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Vbal0uaWQpOwogICAgLy8gICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICBnZXRfbm9kZXNfbGlzdDogZnVuY3Rpb24gZ2V0X25vZGVzX2xpc3Qob2xkTm9kZSkgewogICAgICBpZiAob2xkTm9kZS5jaGlsZHJlbiAmJiBvbGROb2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gb2xkTm9kZS5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5pc19yb290ID0gdHJ1ZTsKICAgICAgICAgIHRoaXMubm9kZXNfbGlzdC5wdXNoKFt7CiAgICAgICAgICAgIGlkOiBvbGROb2RlLmNoaWxkcmVuW2ldLmlkLAogICAgICAgICAgICBuYW1lOiBvbGROb2RlLmNoaWxkcmVuW2ldLm5hbWUKICAgICAgICAgIH1dKTsKICAgICAgICAgIHRoaXMuYWRkX2NoaWxkcmVuX25vZGVfbmFtZShvbGROb2RlLmNoaWxkcmVuW2ldLCBpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhZGRfY2hpbGRyZW5fbm9kZV9uYW1lOiBmdW5jdGlvbiBhZGRfY2hpbGRyZW5fbm9kZV9uYW1lKGNoaWxkTm9kZSwgaW5keCkgewogICAgICBpZiAoY2hpbGROb2RlLmNoaWxkcmVuICYmIGNoaWxkTm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNoaWxkTm9kZS5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgY2hpbGROb2RlLmNoaWxkcmVuW2ldLmlzX3Jvb3QgPSBmYWxzZTsKICAgICAgICAgIHRoaXMubm9kZXNfbGlzdFtpbmR4XS5zcGxpY2UoaW5keCwgMCwgewogICAgICAgICAgICBpZDogY2hpbGROb2RlLmNoaWxkcmVuW2ldLmlkLAogICAgICAgICAgICBuYW1lOiBjaGlsZE5vZGUuY2hpbGRyZW5baV0ubmFtZQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmFkZF9jaGlsZHJlbl9ub2RlX25hbWUoY2hpbGROb2RlLmNoaWxkcmVuW2ldLCBpbmR4KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBkcm9wOiBmdW5jdGlvbiBkcm9wKG5vZGUsIHNyYywgdGFyZ2V0KSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKG5vZGUsIHNyYywgdGFyZ2V0KTsKICAgICAgdGhpcy5wdXNoTmV3VHJlZSgpOwogICAgfSwKICAgIGRyb3BBZnRlcjogZnVuY3Rpb24gZHJvcEFmdGVyKG5vZGUsIHNyYywgdGFyZ2V0KSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKG5vZGUsIHNyYywgdGFyZ2V0KTsKICAgICAgdGhpcy5wdXNoTmV3VHJlZSgpOwogICAgfSwKICAgIGRyb3BCZWZvcmU6IGZ1bmN0aW9uIGRyb3BCZWZvcmUobm9kZSwgc3JjLCB0YXJnZXQpIHsKICAgICAgLy8gY29uc29sZS5sb2cobm9kZSwgc3JjLCB0YXJnZXQpOwogICAgICB0aGlzLnB1c2hOZXdUcmVlKCk7CiAgICB9LAogICAgY2xvc2VfYWRkbm9kZW1vZGFsOiBmdW5jdGlvbiBjbG9zZV9hZGRub2RlbW9kYWwoKSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19hbGVydF9tc2cnKSwKICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfbm9kZV9jaGFuZ2VzX21zZycpLAogICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19zYXZlX2J0bicpLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19kaXNjYXJkX2J0bicpCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgIGlmIChfdGhpczEzLmlzX3Nob3dfZWRpdCkgewogICAgICAgICAgICBfdGhpczEzLmVkaXROb2RlKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpczEzLmFkZE5vZGUoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5kaXNtaXNzID09PSAiY2FuY2VsIikgewogICAgICAgICAgJCgiI2FkZG5vZGVtb2RhbCIpLm1vZGFsKCJoaWRlIik7CgogICAgICAgICAgX3RoaXMxMy5lbXB0eV92YXJpYWJsZSgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgb25EZWw6IGZ1bmN0aW9uIG9uRGVsKG5vZGUpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMubmV3X2NoaWxkX25vZGUpIHsKICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19hbGVydF9tc2cnKSwKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19ub2RlX2NoYW5nZXNfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19kZWxfc2F2ZV9idG4nKSwKICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19kZWxfZGlzY2FyZF9idG4nKQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICBpZiAoX3RoaXMxNC5pc19zaG93X2VkaXQpIHsKICAgICAgICAgICAgICBfdGhpczE0LmVkaXROb2RlKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX3RoaXMxNC5hZGROb2RlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LmRpc21pc3MgPT09ICJjYW5jZWwiKSB7CiAgICAgICAgICAgICQoIiNhZGRub2RlbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwoKICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IF90aGlzMTQubm9kZXNfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKHNlbGVjdCkgewogICAgICAgICAgICAgIHJldHVybiBzZWxlY3QuaWQgIT09IG5vZGUuaWQ7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgX3RoaXMxNC5ub2Rlc19saXN0ID0gbmV3X25vZGVzOwogICAgICAgICAgICBfdGhpczE0Lm5ld19jaGlsZF9ub2RlID0gZmFsc2U7CiAgICAgICAgICAgIG5vZGUucmVtb3ZlKCk7CgogICAgICAgICAgICBfdGhpczE0LmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfYWxlcnRfbXNnJyksCiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfbm9fcmV2ZXJ0X21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfZGVsZXRlX2J0bicpCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgIHZhciBuZXdfbm9kZXMgPSBfdGhpczE0Lm5vZGVzX2xpc3QuZmlsdGVyKGZ1bmN0aW9uIChzZWxlY3QpIHsKICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0LmlkICE9PSBub2RlLmlkOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIF90aGlzMTQubm9kZXNfbGlzdCA9IG5ld19ub2RlczsKICAgICAgICAgICAgbm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgdmFyIHZtID0gX3RoaXMxNDsKCiAgICAgICAgICAgIF9kZnModm0uZGF0YSk7CgogICAgICAgICAgICBmdW5jdGlvbiBfZGZzKG9sZE5vZGUpIHsKICAgICAgICAgICAgICBpZiAob2xkTm9kZS5jaGlsZHJlbiAmJiBvbGROb2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBvbGROb2RlLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkID09IG9sZE5vZGUuY2hpbGRyZW5baV0ubmV4dF9zdGVwLm5vZGVfaWQpIHsKICAgICAgICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLm5leHRfc3RlcC5iZWhhdmlvciA9ICJ3YWl0X2Zvcl9yZXBseSI7CiAgICAgICAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5uZXh0X3N0ZXAubm9kZV9pZCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5uZXh0X3N0ZXAuc2VsZWN0b3IgPSAid2FpdF9mb3JfdXNlcl9pbnB1dCI7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIF9kZnMob2xkTm9kZS5jaGlsZHJlbltpXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczE0LnB1c2hOZXdUcmVlKCJkZWxldGVub2RlIik7CgogICAgICAgICAgICBfdGhpczE0LmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gLy8gdGhpcy5lbXB0eV92YXJpYWJsZSgpOwoKICAgIH0sCiAgICBvbkFkZE5vZGU6IGZ1bmN0aW9uIG9uQWRkTm9kZShwYXJhbXMpIHsKICAgICAgdGhpcy5jaGlsZF9ub2RlID0gcGFyYW1zOwogICAgICB0aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgIHRoaXMuaXNfc2hvd19lZGl0ID0gdHJ1ZTsKICAgICAgdGhpcy5uZXdfY2hpbGRfbm9kZSA9IHRydWU7IC8vIE5vZGUgaWQgaXMgaW1wb3J0YW50LCBjaGVjayBob3cgd2UgYXJlIGFkZGluZyBjaGlsZG5vZGUgaW4gZWRpdE5vZGUoKQoKICAgICAgdGhpcy5ub2RlX2lkID0gcGFyYW1zLmlkOwogICAgICB0aGlzLm5vZGVfbmFtZSA9IHBhcmFtcy5uYW1lOwogICAgICAkKCIjYWRkbm9kZW1vZGFsIikubW9kYWwoInNob3ciKTsKICAgIH0sCiAgICBjaGFuZ2Vfcm9vdDogZnVuY3Rpb24gY2hhbmdlX3Jvb3QoKSB7CiAgICAgIHRoaXMuaXNfcm9vdCA9IHRydWU7CiAgICB9LAogICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhwYXJhbXMpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgdmFyIG5ld19vYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICB0cmlnZ2VyczogcGFyYW1zLnRyaWdnZXJzLAogICAgICAgIGFzc2lzdGFudF9yZXNwb25zZTogcGFyYW1zLnJlc3BvbnNlcywKICAgICAgICBzbG90czogcGFyYW1zLnNsb3RzICE9IG51bGwgPyBwYXJhbXMuc2xvdHMgOiBbXSwKICAgICAgICBub3RpZmljYXRpb25zOiBwYXJhbXMubm90aWZpY2F0aW9ucyAhPSBudWxsID8gcGFyYW1zLm5vdGlmaWNhdGlvbnMgOiB7CiAgICAgICAgICBub3RpZnk6IFt7CiAgICAgICAgICAgIHR5cGU6ICIiLAogICAgICAgICAgICBzbG90OiAiIiwKICAgICAgICAgICAgdGVtcGxhdGVfaWQ6ICIiLAogICAgICAgICAgICB0ZW1wbGF0ZV9uYW1lOiAiIgogICAgICAgICAgfV0sCiAgICAgICAgICByZXNwb25zZXM6IFtdCiAgICAgICAgfSwKICAgICAgICBtYW5hZ2VfaGFuZGxlcnM6IHBhcmFtcy5tYW5hZ2VfaGFuZGxlcnMgIT0gbnVsbCA/IHBhcmFtcy5tYW5hZ2VfaGFuZGxlcnMgOiBbXSwKICAgICAgICB3ZWJob29rX21hcHBpbmc6IHBhcmFtcy53ZWJob29rX21hcHBpbmcgPT0gbnVsbCA/IFtdIDogcGFyYW1zLndlYmhvb2tfbWFwcGluZywKICAgICAgICBub2RlX2lkOiBwYXJhbXMuaWQsCiAgICAgICAgbm9kZV9uYW1lOiBwYXJhbXMubmFtZSwKICAgICAgICBpc19yb290OiBwYXJhbXMuaXNfcm9vdCwKICAgICAgICBpc19zbG90OiBwYXJhbXMuc2xvdF9zZXR0aW5nLAogICAgICAgIGlzX25vdGlmaWNhdGlvbjogcGFyYW1zLm5vdGlmaWNhdGlvbl9lbmFibGVkLAogICAgICAgIG5leHRfc3RlcDogcGFyYW1zLm5leHRfc3RlcCwKICAgICAgICBzYXZlX3RoZW5fYXNzaXN0YW50X3Nob3VsZDogcGFyYW1zLm5leHRfc3RlcC5iZWhhdmlvciwKICAgICAgICBqdW1wX3RvX25vZGVfaWQ6IHBhcmFtcy5uZXh0X3N0ZXAubm9kZV9pZCwKICAgICAgICBpc193ZWJob29rOiBwYXJhbXMud2ViaG9va19pbnRlZ3JhdGlvbiAvLyB3ZWJob29rX2lkOiB0aGlzLmlzX3dlYmhvb2sgPT0gdHJ1ZSA/IHBhcmFtcy53ZWJob29rX2lkIDogbnVsbCwKICAgICAgICAvLyB3ZWJob29rX3ZhcmlhYmxlOnRoaXMud2ViaG9va19pZCAhPSBudWxsID8gcGFyYW1zLndlYmhvb2tfcmV0dXJuX3ZhcmlhYmxlIDogIiIsCgogICAgICB9KSk7IC8vIG5ld19vYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5ld19vYmopKTsKCiAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgdGhpcy5pc19zaG93X2VkaXQgPSB0cnVlOwogICAgICB0aGlzLm5vZGVfaWQgPSBuZXdfb2JqLm5vZGVfaWQ7CiAgICAgIHRoaXMubm9kZV9uYW1lID0gbmV3X29iai5ub2RlX25hbWU7CiAgICAgIHRoaXMuaXNfcm9vdCA9IG5ld19vYmouaXNfcm9vdDsKICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UgPSBuZXdfb2JqLmFzc2lzdGFudF9yZXNwb25zZTsgLy8gdGhpcy50cmlnZ2VycyA9IE9iamVjdC5hc3NpZ24ocGFyYW1zLnRyaWdnZXJzKTsKCiAgICAgIHRoaXMudHJpZ2dlcnMgPSBuZXdfb2JqLnRyaWdnZXJzOwogICAgICB0aGlzLnNsb3RzID0gbmV3X29iai5zbG90czsKICAgICAgdGhpcy5pc19zbG90ID0gbmV3X29iai5pc19zbG90OwogICAgICB0aGlzLmlzX25vdGlmaWNhdGlvbiA9IG5ld19vYmouaXNfbm90aWZpY2F0aW9uOwogICAgICB0aGlzLm5vdGlmaWNhdGlvbnMgPSBuZXdfb2JqLm5vdGlmaWNhdGlvbnM7CiAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzID0gbmV3X29iai5tYW5hZ2VfaGFuZGxlcnM7CiAgICAgIHRoaXMubmV4dF9zdGVwID0gbmV3X29iai5uZXh0X3N0ZXA7CiAgICAgIHRoaXMuc2F2ZV90aGVuX2Fzc2lzdGFudF9zaG91bGQgPSBuZXdfb2JqLnNhdmVfdGhlbl9hc3Npc3RhbnRfc2hvdWxkOwogICAgICB0aGlzLmp1bXBfdG9fbm9kZV9pZCA9IG5ld19vYmouanVtcF90b19ub2RlX2lkID09PSBudWxsID8gIiIgOiBuZXdfb2JqLmp1bXBfdG9fbm9kZV9pZDsKICAgICAgdGhpcy5pc193ZWJob29rID0gbmV3X29iai5pc193ZWJob29rOwogICAgICB0aGlzLndlYmhvb2tfaWQgPSB0aGlzLmlzX3dlYmhvb2sgPT0gdHJ1ZSA/IHBhcmFtcy53ZWJob29rX2lkIDogbnVsbCwgdGhpcy53ZWJob29rX3ZhcmlhYmxlID0gdGhpcy53ZWJob29rX2lkICE9IG51bGwgPyBwYXJhbXMud2ViaG9va19yZXR1cm5fdmFyaWFibGUgOiAiIiwgdGhpcy53ZWJob29rX21hcHBpbmcgPSBuZXdfb2JqLndlYmhvb2tfbWFwcGluZzsgLy8gVGhpcyBjb25kaXRpb24gaXMgdG8gY2hlY2sgaWYgcm9vdCBub2RlIGlzIHNlbGVjdGVkIHRoZW4gZG9uJ3QgbGV0IGl0IGFkZCBtb3JlIHRoYW4gb25lIHRyaWdnZXIKICAgICAgLy8gaWYgKHRoaXMuaXNfcm9vdCkgewogICAgICAvLyAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhZGRfdHJpZ2dlcl9idG4iKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhZGRfdHJpZ2dlcl9idG4iKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgLy8gICB0aGlzLmlzX3Jvb3QgPSBmYWxzZTsKICAgICAgLy8gfQoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGZvdW5kID0gX3RoaXMxNS50cmlnZ2VyX29wdGlvbnNfZW50aXR5X3ZhbHVlcy5zb21lKGZ1bmN0aW9uIChlbnRpdHkpIHsKICAgICAgICAgIHJldHVybiBlbnRpdHkuZW50aXR5ID09PSBfdGhpczE1LnNlbGVjdGVkX2VudGl0eTsKICAgICAgICB9KTsgLy8gY29uc29sZS5sb2codGhpcy5zZWxlY3RlZF9lbnRpdHkgLCItLXNlbGN0ZWQgZW50aXR5IiwgdGhpcy50cmlnZ2Vyc1swXS5lbnRpdHlfdmFsdWUgLCAiLS1lbnRpdHkgdmFsdWUiICwgZm91bmQpCiAgICAgICAgLy8gY29uc29sZS5sb2coQm9vbGVhbih0aGlzLnNlbGVjdGVkX2VudGl0eSAsICJib29vbCIpKQoKCiAgICAgICAgaWYgKF90aGlzMTUuc2VsZWN0ZWRfZW50aXR5ICE9PSAiIiAmJiAhZm91bmQpIHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJzaG93IHN3YWwiKQogICAgICAgICAgLy8gICBTd2FsKHsKICAgICAgICAgIC8vICAgdGV4dDogYFRoZSAgZW50aXR5IC0gJHt0aGlzLnNlbGVjdGVkX2VudGl0eX0gIGluIHNlbGVjdGVkIG5vZGUgaGFzIGJlZW4gZGVsZXRlZCBmcm9tIHRoZSBlbnRpdGllcyBsaXN0LlBsZWFzZSBtYWtlIHN1cmUgaXQgaXMgYWRkZWQgaW4gdGhlIGVudGl0aWVzIGxpc3QgdG8gYXZvaWQgdGhlIHVuZXhwZWN0ZWQgYmVoYXZpb3IuYCwKICAgICAgICAgIC8vICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgLy8gICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgIC8vICAgdGltZXI6NTAwMCwKICAgICAgICAgIC8vIH0pOwogICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgdGl0bGU6ICJBcmUgeW91IHN1cmU/IiwKICAgICAgICAgICAgdGV4dDogIlRoZSAgZW50aXR5IC0gIi5jb25jYXQoX3RoaXMxNS5zZWxlY3RlZF9lbnRpdHksICIgIGluIHNlbGVjdGVkIG5vZGUgaGFzIGJlZW4gZGVsZXRlZCBmcm9tIHRoZSBlbnRpdGllcyBsaXN0LlBsZWFzZSBtYWtlIHN1cmUgaXQgaXMgYWRkZWQgaW4gdGhlIGVudGl0aWVzIGxpc3QgdG8gYXZvaWQgdGhlIHVuZXhwZWN0ZWQgYmVoYXZpb3IuIiksCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAiWWVzLCBDb250aW51ZSEhIgogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgICBfdGhpczE1LmxvYWRfc2xvdF92YXJpYWJsZSgpOwoKICAgICAgICAgICAgICBfdGhpczE1LmZpbHRlcl9hc2lzdGFuY2VfcmVzcG9uc2UoKTsKCiAgICAgICAgICAgICAgX3RoaXMxNS5yZW1vdmVfY3VycmVudF9ub2RlX2p1bXBfbmFtZShfdGhpczE1Lm5vZGVzX2xpc3QsIF90aGlzMTUubm9kZV9uYW1lKTsKCiAgICAgICAgICAgICAgJCgiI2FkZG5vZGVtb2RhbCIpLm1vZGFsKCJzaG93Iik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczE1LmxvYWRfc2xvdF92YXJpYWJsZSgpOwoKICAgICAgICAgIF90aGlzMTUuZmlsdGVyX2FzaXN0YW5jZV9yZXNwb25zZSgpOwoKICAgICAgICAgIF90aGlzMTUucmVtb3ZlX2N1cnJlbnRfbm9kZV9qdW1wX25hbWUoX3RoaXMxNS5ub2Rlc19saXN0LCBfdGhpczE1Lm5vZGVfbmFtZSk7CgogICAgICAgICAgJCgiI2FkZG5vZGVtb2RhbCIpLm1vZGFsKCJzaG93Iik7CiAgICAgICAgfQoKICAgICAgICBfdGhpczE1LnNlbGVjdGVkX2VudGl0eSA9ICIiOwogICAgICB9LCAxMDApOwogICAgfSwKICAgIGRlbGV0ZV9hc2lzdGFuY2VfcmVzcG9uc2VfYnlfaWQ6IGZ1bmN0aW9uIGRlbGV0ZV9hc2lzdGFuY2VfcmVzcG9uc2VfYnlfaWQoaWQpIHsKICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgIGlmIChpZCA9PT0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQpIHsKICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnNwbGljZShpLCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBlZGl0Tm9kZTogZnVuY3Rpb24gZWRpdE5vZGUoKSB7CiAgICAgIGlmICh0aGlzLm5vZGVfbmFtZSA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9lbnRlcl9uYW1lX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnRyaWdnZXJzLmxlbmd0aCA8IDEpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfYWRkX29uZV9jb25kaXRpb25fbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLnRyaWdnZXJzLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgdGhpcy50cmlnZ2Vycy5sZW5ndGg7IF9pKyspIHsKICAgICAgICAgIGlmICh0aGlzLnRyaWdnZXJzW19pXS50cmlnZ2VyX3ZhbHVlID09PSAiIiB8fCB0aGlzLnRyaWdnZXJzW19pXS50cmlnZ2VyX3ZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY29uZGl0aW9uX2Nhbm5vdF9ibGFua19tc2cxJyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMudHJpZ2dlcnNbX2ldLnRyaWdnZXJfdHlwZSA9PT0gImVudGl0eSIpIHsKICAgICAgICAgICAgaWYgKHRoaXMudHJpZ2dlcnNbX2ldLm9wZXJhbmQgPT09ICIiIHx8IHRoaXMudHJpZ2dlcnNbX2ldLm9wZXJhbmQgPT09IG51bGwpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY29uZGl0aW9uX2Nhbm5vdF9ibGFua19tc2cyJyksCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMudHJpZ2dlcnNbX2ldLm9wZXJhbmQgPT09ICJpcyIpIHsKICAgICAgICAgICAgICBpZiAodGhpcy50cmlnZ2Vyc1tfaV0uZW50aXR5X3ZhbHVlID09PSAiIiB8fCB0aGlzLnRyaWdnZXJzW19pXS5lbnRpdHlfdmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX2NvbmRpdGlvbl9jYW5ub3RfYmxhbmtfbXNnMycpLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzX3Nsb3QgJiYgdGhpcy5zbG90cy5sZW5ndGggPT0gMCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9hZGRfb25lX3Nsb3RfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNfc2xvdCAmJiB0aGlzLnNsb3RzLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBsID0gMDsgbCA8IHRoaXMuc2xvdHMubGVuZ3RoOyBsKyspIHsKICAgICAgICAgIHZhciBzbG90ID0gdGhpcy5zbG90c1tsXTsKCiAgICAgICAgICBpZiAoIUJvb2xlYW4oc2xvdC5zbG90KSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX2VudGl0eV9mb3Jfc2xvdF9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIUJvb2xlYW4oc2xvdC5yZXNwb25zZXMubGVuZ3RoKSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3Jlc3BvbnNlX3RvX3Nsb3RfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRoaXMuaXNfc2xvdCAmJiB0aGlzLnNsb3RzLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBfbCA9IDA7IF9sIDwgdGhpcy5zbG90cy5sZW5ndGg7IF9sKyspIHsKICAgICAgICAgIHZhciBfc2xvdCA9IHRoaXMuc2xvdHNbX2xdOwoKICAgICAgICAgIGZvciAoaSBpbiBfc2xvdC5yZXNwb25zZXMpIHsKICAgICAgICAgICAgdGhpcy5kZWxldGVfYXNpc3RhbmNlX3Jlc3BvbnNlX2J5X2lkKF9zbG90LnJlc3BvbnNlc1tpXSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLmFycmFuZ2VfaWRzX2Z1bmN0aW9uKCk7CiAgICAgICAgdGhpcy5zbG90cyA9IFtdOwogICAgICB9CgogICAgICBpZiAodGhpcy5tYW5hZ2VfaGFuZGxlcnMubGVuZ3RoID4gMCAmJiB0aGlzLmlzX3Nsb3QpIHsKICAgICAgICBmb3IgKHZhciBpbmQgPSAwOyBpbmQgPCB0aGlzLm1hbmFnZV9oYW5kbGVycy5sZW5ndGg7IGluZCsrKSB7CiAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF07CgogICAgICAgICAgaWYgKGhhbmRsZXIudHJpZ2dlcnMubGVuZ3RoIDwgMSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX2NvbmRpdGlvbl9mb3JfbWFuYWdlX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRsZXIudHJpZ2dlcnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBoYW5kbGVyLnRyaWdnZXJzLmxlbmd0aDsgX2kyKyspIHsKICAgICAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vyc1tfaTJdLnRyaWdnZXJfdmFsdWUgPT09ICIiIHx8IGhhbmRsZXIudHJpZ2dlcnNbX2kyXS50cmlnZ2VyX3ZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jYW5ub3RfYmxhbmtfaW5faGFuZGxlcl9tc2cxJyksCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKGhhbmRsZXIudHJpZ2dlcnNbX2kyXS50cmlnZ2VyX3R5cGUgPT09ICJlbnRpdHkiKSB7CiAgICAgICAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vyc1tfaTJdLm9wZXJhbmQgPT09ICIiIHx8IGhhbmRsZXIudHJpZ2dlcnNbX2kyXS5vcGVyYW5kID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY2Fubm90X2JsYW5rX2luX2hhbmRsZXJfbXNnMicpLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyLnRyaWdnZXJzW19pMl0ub3BlcmFuZCA9PT0gImlzIikgewogICAgICAgICAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vyc1tfaTJdLmVudGl0eV92YWx1ZSA9PT0gIiIgfHwgaGFuZGxlci50cmlnZ2Vyc1tfaTJdLmVudGl0eV92YWx1ZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jYW5ub3RfYmxhbmtfaW5faGFuZGxlcl9tc2czJyksCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChoYW5kbGVyLnJlc3BvbnNlcy5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfb25lX3Jlc3BfaGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlci5yZXNwb25zZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBmb3IgKHZhciBfaTMgPSAwOyBfaTMgPCBoYW5kbGVyLnJlc3BvbnNlcy5sZW5ndGg7IF9pMysrKSB7CiAgICAgICAgICAgICAgaWYgKGhhbmRsZXIucmVzcG9uc2VzW19pM10udHlwZSA9PT0gInRleHQiKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhhbmRsZXIucmVzcG9uc2VzW19pM10udmFsdWVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKGhhbmRsZXIucmVzcG9uc2VzW19pM10udmFsdWVzW2pdKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfdGV4dF9yZXNwX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlci5yZXNwb25zZXNbX2kzXS50eXBlID09PSAiaW1hZ2UiKSB7CiAgICAgICAgICAgICAgICBpZiAoQm9vbGVhbihoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfaW1nX3Jlc3BfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZWdfaW1hZ2UudGVzdChoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfdmFsaWRfaW1nX3VybF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlci5yZXNwb25zZXNbX2kzXS50eXBlID09PSAidmlkZW8iKSB7CiAgICAgICAgICAgICAgICBpZiAoQm9vbGVhbihoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfdmlkZW9fcmVzcF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlZ191cmwudGVzdChoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfdmFsaWRfdmlkZW9fdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLnR5cGUgPT09ICJjaG9pY2VzIikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgX2ogPSAwOyBfaiA8IGhhbmRsZXIucmVzcG9uc2VzW19pM10uY2hvaWNlcy5sZW5ndGg7IF9qKyspIHsKICAgICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oaGFuZGxlci5yZXNwb25zZXNbX2kzXS5jaG9pY2VzW19qXS50aXRsZSkgPT09IGZhbHNlIHx8IEJvb2xlYW4oaGFuZGxlci5yZXNwb25zZXNbX2kzXS5jaG9pY2VzW19qXS5wYXlsb2FkKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY2hvaWNlX3Jlc3BfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLnR5cGUgPT09ICJjYXJkIikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgX2oyID0gMDsgX2oyIDwgaGFuZGxlci5yZXNwb25zZXNbX2kzXS5jYXJkX2xpc3QubGVuZ3RoOyBfajIrKykgewogICAgICAgICAgICAgICAgICB2YXIgY2Fyb3VzZWwgPSBoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLmNhcmRfbGlzdFtfajJdOwoKICAgICAgICAgICAgICAgICAgaWYgKGNhcm91c2VsLmlzX2ltYWdlID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlci5yZXNwb25zZXNbX2kzXS5jYXJkX2xpc3RbX2oyXS52aWRlbyA9ICIiOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGhhbmRsZXIucmVzcG9uc2VzW19pM10uY2FyZF9saXN0W19qMl0uaW1hZ2UgPSAiIjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdmFyIGJ1dHRvbl9oYXNfdmFsdWUgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2Fyb3VzZWwuYnV0dG9ucy5sZW5ndGg7IGsrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChjYXJvdXNlbC5idXR0b25zW2tdLnRpdGxlICE9ICIiIHx8IGNhcm91c2VsLmJ1dHRvbnNba10udmFsdWUgIT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbl9oYXNfdmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKGNhcm91c2VsLnRpdGxlID09PSAiIiAmJiBjYXJvdXNlbC50ZXh0ID09PSAiIiAmJiBjYXJvdXNlbC5pbWFnZSA9PT0gIiIgJiYgY2Fyb3VzZWwudmlkZW8gPT09ICIiICYmIGJ1dHRvbl9oYXNfdmFsdWUgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX2NhcmRfZmlsbGVkX2Zvcl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmIChjYXJvdXNlbC5pbWFnZSAhPSAiIiAmJiB0aGlzLnJlZ19pbWFnZS50ZXN0KGNhcm91c2VsLmltYWdlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY2FyZF92YWxpZF9pbWdfdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKGNhcm91c2VsLnZpZGVvICE9ICIiICYmIHRoaXMucmVnX3VybC50ZXN0KGNhcm91c2VsLnZpZGVvKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY2FyZF92YWxpZF92aWRlb191cmxfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gMDsgZCA8IGNhcm91c2VsLmJ1dHRvbnMubGVuZ3RoOyBkKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwuYnV0dG9uc1tkXS50aXRsZSAhPSAiIiAmJiBjYXJvdXNlbC5idXR0b25zW2RdLnZhbHVlID09ICIiIHx8IGNhcm91c2VsLmJ1dHRvbnNbZF0udGl0bGUgPT0gIiIgJiYgY2Fyb3VzZWwuYnV0dG9uc1tkXS52YWx1ZSAhPSAiIikgewogICAgICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY2FyZF92YWxpZF9pbWdfdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmlzX3dlYmhvb2tfZGV0YWlscykgewogICAgICAgIHRoaXMuaXNfd2ViaG9vayA9IGZhbHNlOwogICAgICAgIHRoaXMud2ViaG9va19tYXBwaW5nID0ge307CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzX3dlYmhvb2spIHsKICAgICAgICBpZiAoIUJvb2xlYW4odGhpcy53ZWJob29rX2lkKSkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va19uYW1lX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICghQm9vbGVhbih0aGlzLndlYmhvb2tfdmFyaWFibGUpKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX3JldHVybl92YXJpYWJsZV9tc2cnKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIUJvb2xlYW4odGhpcy53ZWJob29rX21hcHBpbmcubGVuZ3RoKSkgey8vIFN3YWwoewogICAgICAgICAgLy8gICB0ZXh0OiAiQXRsZWFzdCBhZGQgb25lIHdlYmhvb2sgcGFyYW1ldGVyIiwKICAgICAgICAgIC8vICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgLy8gICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIC8vICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIC8vICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgLy8gICB0aW1lcjogODAwMCwKICAgICAgICAgIC8vIH0pOwogICAgICAgICAgLy8gcmV0dXJuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy53ZWJob29rX21hcHBpbmcubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgIGlmICghQm9vbGVhbih0aGlzLndlYmhvb2tfbWFwcGluZ1tpbmRleF0ua2V5KSB8fCAhQm9vbGVhbih0aGlzLndlYmhvb2tfbWFwcGluZ1tpbmRleF0udmFsdWUpKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfcGFyYV9lbXB0eV9tc2cxJyksCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNfbm90aWZpY2F0aW9uKSB7CiAgICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udHlwZSA9PSAiIiB8fCB0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnR5cGUgPT0gbnVsbCkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va19wYXJhX2VtcHR5X21zZzInKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS5zbG90ID09ICIiIHx8IHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0uc2xvdCA9PSBudWxsKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX25vdGlmaWNhdGlvbl90eXBlX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnRlbXBsYXRlX25hbWUgPT0gIiIgfHwgdGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS50ZW1wbGF0ZV9uYW1lID09IG51bGwpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfdGVtcGxhdGVfbmFtZV9tc2cnKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcy5sZW5ndGggPCAxKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX25vdGlmaWNhdGlvbl9mb3JfYm90X2Nhc2VzX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGNoZWNrX25vdGlmaWNhdGlvbl9zdWNjZXNzZnVsX3Jlc3BvbnNlID0gZmFsc2U7CiAgICAgICAgICB2YXIgY2hlY2tfbm90aWZpY2F0aW9uX3Vuc3VjY2Vzc2Z1bF9yZXNwb25zZSA9IGZhbHNlOwoKICAgICAgICAgIGZvciAodmFyIF9sMiA9IDA7IF9sMiA8IHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXMubGVuZ3RoOyBfbDIrKykgewogICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uX3Jlc3BvbnNlX2lkID0gdGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlc1tfbDJdOwoKICAgICAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW25vdGlmaWNhdGlvbl9yZXNwb25zZV9pZF0uY29uZGl0aW9uID09PSAiIXN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICAgICAgY2hlY2tfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfcmVzcG9uc2UgPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Vbbm90aWZpY2F0aW9uX3Jlc3BvbnNlX2lkXS5jb25kaXRpb24gPT09ICIhdW5zdWNjZXNzZnVsIikgewogICAgICAgICAgICAgIGNoZWNrX25vdGlmaWNhdGlvbl91bnN1Y2Nlc3NmdWxfcmVzcG9uc2UgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFCb29sZWFuKGNoZWNrX25vdGlmaWNhdGlvbl9zdWNjZXNzZnVsX3Jlc3BvbnNlKSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgaWYgKCFCb29sZWFuKGNoZWNrX25vdGlmaWNhdGlvbl91bnN1Y2Nlc3NmdWxfcmVzcG9uc2UpKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va19ub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgaW4gdGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcykgewogICAgICAgICAgdGhpcy5kZWxldGVfYXNpc3RhbmNlX3Jlc3BvbnNlX2J5X2lkKHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXNbaV0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5hcnJhbmdlX2lkc19mdW5jdGlvbigpOwogICAgICAgIHRoaXMubm90aWZpY2F0aW9ucyA9IHsKICAgICAgICAgIG5vdGlmeTogW3sKICAgICAgICAgICAgdHlwZTogIiIsCiAgICAgICAgICAgIHNsb3Q6ICIiLAogICAgICAgICAgICB0ZW1wbGF0ZV9pZDogIiIsCiAgICAgICAgICAgIHRlbXBsYXRlX25hbWU6ICIiCiAgICAgICAgICB9XSwKICAgICAgICAgIHJlc3BvbnNlczogW10KICAgICAgICB9OwogICAgICB9CgogICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoIDwgMSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX29uZV9yZXNwX3RvX25vZGVfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yICh2YXIgX2k0ID0gMDsgX2k0IDwgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoOyBfaTQrKykgewogICAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0udHlwZSA9PT0gInRleHQiKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9qMyA9IDA7IF9qMyA8IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0udmFsdWVzLmxlbmd0aDsgX2ozKyspIHsKICAgICAgICAgICAgICBpZiAoQm9vbGVhbih0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaTRdLnZhbHVlc1tfajNdKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfdGV4dF9yZXNwb25zZV9tc2cnKSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0udHlwZSA9PT0gImltYWdlIikgewogICAgICAgICAgICBpZiAoQm9vbGVhbih0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaTRdLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfaW1nX3Jlc3BvbnNlX21zZycpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLnJlZ19pbWFnZS50ZXN0KHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va192YWxpZF9pbWdfdXJsX21zZycpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS50eXBlID09PSAidmlkZW8iKSB7CiAgICAgICAgICAgIGlmIChCb29sZWFuKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va192aWRlb19yZXNwb25zZV9tc2cnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy5yZWdfdXJsLnRlc3QodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX3ZhbGlkX3ZpZGVvX3VybF9tc2cnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0udHlwZSA9PT0gImNob2ljZXMiKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9qNCA9IDA7IF9qNCA8IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0uY2hvaWNlcy5sZW5ndGg7IF9qNCsrKSB7CiAgICAgICAgICAgICAgaWYgKEJvb2xlYW4odGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5jaG9pY2VzW19qNF0udGl0bGUpID09PSBmYWxzZSB8fCBCb29sZWFuKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0uY2hvaWNlc1tfajRdLnBheWxvYWQpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va19jaG9pY2VfcmVzcG9uc2VfbXNnJyksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaTRdLnR5cGUgPT09ICJjYXJkIikgewogICAgICAgICAgICBmb3IgKHZhciBfajUgPSAwOyBfajUgPCB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaTRdLmNhcmRfbGlzdC5sZW5ndGg7IF9qNSsrKSB7CiAgICAgICAgICAgICAgdmFyIF9jYXJvdXNlbCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0uY2FyZF9saXN0W19qNV07CgogICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwuaXNfaW1hZ2UgPT09IHRydWUpIHsKICAgICAgICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0uY2FyZF9saXN0W19qNV0udmlkZW8gPSAiIjsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5jYXJkX2xpc3RbX2o1XS5pbWFnZSA9ICIiOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIF9idXR0b25faGFzX3ZhbHVlID0gZmFsc2U7CgogICAgICAgICAgICAgIGZvciAodmFyIF9rID0gMDsgX2sgPCBfY2Fyb3VzZWwuYnV0dG9ucy5sZW5ndGg7IF9rKyspIHsKICAgICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwuYnV0dG9uc1tfa10udGl0bGUgIT0gIiIgfHwgX2Nhcm91c2VsLmJ1dHRvbnNbX2tdLnZhbHVlICE9ICIiKSB7CiAgICAgICAgICAgICAgICAgIF9idXR0b25faGFzX3ZhbHVlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwudGl0bGUgPT09ICIiICYmIF9jYXJvdXNlbC50ZXh0ID09PSAiIiAmJiBfY2Fyb3VzZWwuaW1hZ2UgPT09ICIiICYmIF9jYXJvdXNlbC52aWRlbyA9PT0gIiIgJiYgX2J1dHRvbl9oYXNfdmFsdWUgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX2ZpbGxlZF9mb3JfaGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoX2Nhcm91c2VsLmltYWdlICE9ICIiICYmIHRoaXMucmVnX2ltYWdlLnRlc3QoX2Nhcm91c2VsLmltYWdlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfdmFsaWRfaW1nX3VybF9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwudmlkZW8gIT0gIiIgJiYgdGhpcy5yZWdfdXJsLnRlc3QoX2Nhcm91c2VsLnZpZGVvKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfdmFsaWRfdmlkZW9fdXJsX2hhbmRsZXJfbXNnMScpLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvciAodmFyIF9kID0gMDsgX2QgPCBfY2Fyb3VzZWwuYnV0dG9ucy5sZW5ndGg7IF9kKyspIHsKICAgICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwuYnV0dG9uc1tfZF0udGl0bGUgIT0gIiIgJiYgX2Nhcm91c2VsLmJ1dHRvbnNbX2RdLnZhbHVlID09ICIiIHx8IF9jYXJvdXNlbC5idXR0b25zW19kXS50aXRsZSA9PSAiIiAmJiBfY2Fyb3VzZWwuYnV0dG9uc1tfZF0udmFsdWUgIT0gIiIpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX3ZhbGlkX2ltZ191cmxfaGFuZGxlcl9tc2cxJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRoaXMubmV4dF9zdGVwLmJlaGF2aW9yKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfd2ViaG9va19uZXh0X3N0ZXBfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2F2ZV90aGVuX2Fzc2lzdGFudF9zaG91bGQgPT0gImp1bXBfdG8iICYmIHRoaXMuanVtcF90b19ub2RlX2lkID09ICIiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfd2ViaG9va19uZXh0X2lkX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzX3Nsb3QgJiYgdGhpcy5zbG90cy5sZW5ndGggIT0gMCkgewogICAgICAgIHRoaXMubm9kZV90eXBlID0gImZvcm0iOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubm9kZV90eXBlID0gImJhc2ljIjsKICAgICAgfQoKICAgICAgdmFyIHZtID0gdGhpczsKCiAgICAgIF9kZnModm0uZGF0YSk7CgogICAgICBmdW5jdGlvbiBfZGZzKG9sZE5vZGUpIHsKICAgICAgICBpZiAob2xkTm9kZS5jaGlsZHJlbiAmJiBvbGROb2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBvbGROb2RlLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIGlmICh2bS5ub2RlX2lkID09IG9sZE5vZGUuY2hpbGRyZW5baV0uaWQpIHsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLm5hbWUgPSB2bS5ub2RlX25hbWU7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5ub2RlX25hbWUgPSB2bS5ub2RlX3R5cGUgKyAiXyIgKyB2bS5ub2RlX25hbWU7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5ub2RlX3R5cGUgPSB2bS5ub2RlX3R5cGU7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5pc19yb290ID0gdm0uaXNfcm9vdCA/IHRydWUgOiBmYWxzZTsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLnJlc3BvbnNlcyA9IHZtLmFzc2lzdGFudF9yZXNwb25zZTsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLnNsb3Rfc2V0dGluZyA9IHZtLmlzX3Nsb3Q7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5ub3RpZmljYXRpb25fZW5hYmxlZCA9IHZtLmlzX25vdGlmaWNhdGlvbiwgb2xkTm9kZS5jaGlsZHJlbltpXS5zbG90cyA9IHZtLmlzX3Nsb3QgPyB2bS5zbG90cyA6IG51bGwsIG9sZE5vZGUuY2hpbGRyZW5baV0ubm90aWZpY2F0aW9ucyA9IHZtLmlzX25vdGlmaWNhdGlvbiA/IHZtLm5vdGlmaWNhdGlvbnMgOiBudWxsLCBvbGROb2RlLmNoaWxkcmVuW2ldLm1hbmFnZV9oYW5kbGVycyA9IHZtLm1hbmFnZV9oYW5kbGVycy5sZW5ndGggPiAwICYmIHZtLmlzX3Nsb3QgPyB2bS5tYW5hZ2VfaGFuZGxlcnMgOiBudWxsLCBvbGROb2RlLmNoaWxkcmVuW2ldLnRyaWdnZXJzID0gdm0udHJpZ2dlcnM7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5uZXh0X3N0ZXAgPSB2bS5uZXh0X3N0ZXA7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS53ZWJob29rX2lkID0gdm0uaXNfd2ViaG9vayA/IHZtLndlYmhvb2tfaWQgOiBudWxsOwogICAgICAgICAgICAgIG9sZE5vZGUuY2hpbGRyZW5baV0ud2ViaG9va19pbnRlZ3JhdGlvbiA9IHZtLmlzX3dlYmhvb2s7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS53ZWJob29rX21hcHBpbmcgPSB2bS5pc193ZWJob29rID8gdm0ud2ViaG9va19tYXBwaW5nIDogbnVsbDsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLndlYmhvb2tfcmV0dXJuX3ZhcmlhYmxlID0gdm0uaXNfd2ViaG9vayA/IHZtLndlYmhvb2tfdmFyaWFibGUgOiBudWxsOwogICAgICAgICAgICAgIG9sZE5vZGUuY2hpbGRyZW5baV0uZWRpdE5vZGVEaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9kZnMob2xkTm9kZS5jaGlsZHJlbltpXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodm0ubmV3X2NoaWxkX25vZGUpIHsKICAgICAgICB2bS5ub2Rlc19saXN0LnB1c2goW3sKICAgICAgICAgIGlkOiB2bS5ub2RlX2lkLAogICAgICAgICAgbmFtZTogdm0ubm9kZV9uYW1lCiAgICAgICAgfV0pOwogICAgICB9CgogICAgICBpZiAodm0ubmV3X2NoaWxkX25vZGUpIHsKICAgICAgICB2bS5wdXNoTmV3VHJlZSgiY2hpbGRub2RlIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdm0ucHVzaE5ld1RyZWUoImVkaXRub2RlIik7CiAgICAgIH0KCiAgICAgIHZtLm5ld19jaGlsZF9ub2RlID0gZmFsc2U7CiAgICAgIHZtLmlzX3Nob3dfZWRpdCA9IGZhbHNlOwogICAgICB2bS5lbXB0eV92YXJpYWJsZSgpOyAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYWRkX3RyaWdnZXJfYnRuIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CgogICAgICAkKCIjYWRkbm9kZW1vZGFsIikubW9kYWwoImhpZGUiKTsKICAgIH0sCiAgICBhZGROb2RlOiBmdW5jdGlvbiBhZGROb2RlKCkgewogICAgICBpZiAodGhpcy5ub2RlX25hbWUgPT0gIiIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9lbnRlcl9uYW1lX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnRyaWdnZXJzLmxlbmd0aCA8IDEpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9hZGRfb25lX2NvbmRpdGlvbl9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMudHJpZ2dlcnMubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIF9pNSA9IDA7IF9pNSA8IHRoaXMudHJpZ2dlcnMubGVuZ3RoOyBfaTUrKykgewogICAgICAgICAgaWYgKHRoaXMudHJpZ2dlcnNbX2k1XS50cmlnZ2VyX3ZhbHVlID09PSAiIiB8fCB0aGlzLnRyaWdnZXJzW19pNV0udHJpZ2dlcl92YWx1ZSA9PT0gbnVsbCkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfY29uZGl0aW9uX2Nhbm5vdF9ibGFua19tc2cxJyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMudHJpZ2dlcnNbX2k1XS50cmlnZ2VyX3R5cGUgPT09ICJlbnRpdHkiKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnRyaWdnZXJzW19pNV0ub3BlcmFuZCA9PT0gIiIgfHwgdGhpcy50cmlnZ2Vyc1tfaTVdLm9wZXJhbmQgPT09IG51bGwpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jb25kaXRpb25fY2Fubm90X2JsYW5rX21zZzInKSwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy50cmlnZ2Vyc1tfaTVdLm9wZXJhbmQgPT09ICJpcyIpIHsKICAgICAgICAgICAgICBpZiAodGhpcy50cmlnZ2Vyc1tfaTVdLmVudGl0eV92YWx1ZSA9PT0gIiIgfHwgdGhpcy50cmlnZ2Vyc1tfaTVdLmVudGl0eV92YWx1ZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jb25kaXRpb25fY2Fubm90X2JsYW5rX21zZzMnKSwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5pc19zbG90ICYmIHRoaXMuc2xvdHMubGVuZ3RoID09IDApIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9hZGRfb25lX3Nsb3RfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNfc2xvdCAmJiB0aGlzLnNsb3RzLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBsID0gMDsgbCA8IHRoaXMuc2xvdHMubGVuZ3RoOyBsKyspIHsKICAgICAgICAgIHZhciBzbG90ID0gdGhpcy5zbG90c1tsXTsKCiAgICAgICAgICBpZiAoIUJvb2xlYW4oc2xvdC5zbG90KSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfZW50aXR5X2Zvcl9zbG90X21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghQm9vbGVhbihzbG90LnJlc3BvbnNlcy5sZW5ndGgpKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9yZXNwb25zZV90b19zbG90X21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmlzX3Nsb3QgJiYgdGhpcy5zbG90cy5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yICh2YXIgX2wzID0gMDsgX2wzIDwgdGhpcy5zbG90cy5sZW5ndGg7IF9sMysrKSB7CiAgICAgICAgICB2YXIgX3Nsb3QyID0gdGhpcy5zbG90c1tfbDNdOwoKICAgICAgICAgIGZvciAoaSBpbiBfc2xvdDIucmVzcG9uc2VzKSB7CiAgICAgICAgICAgIHRoaXMuZGVsZXRlX2FzaXN0YW5jZV9yZXNwb25zZV9ieV9pZChfc2xvdDIucmVzcG9uc2VzW2ldKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuYXJyYW5nZV9pZHNfZnVuY3Rpb24oKTsKICAgICAgICB0aGlzLnNsb3RzID0gW107CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm1hbmFnZV9oYW5kbGVycy5sZW5ndGggPiAwICYmIHRoaXMuaXNfc2xvdCkgewogICAgICAgIGZvciAodmFyIGluZCA9IDA7IGluZCA8IHRoaXMubWFuYWdlX2hhbmRsZXJzLmxlbmd0aDsgaW5kKyspIHsKICAgICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXTsKCiAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vycy5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jb25kaXRpb25fZm9yX21hbmFnZV9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnRyaWdnZXJzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgZm9yICh2YXIgX2k2ID0gMDsgX2k2IDwgaGFuZGxlci50cmlnZ2Vycy5sZW5ndGg7IF9pNisrKSB7CiAgICAgICAgICAgICAgaWYgKGhhbmRsZXIudHJpZ2dlcnNbX2k2XS50cmlnZ2VyX3ZhbHVlID09PSAiIiB8fCBoYW5kbGVyLnRyaWdnZXJzW19pNl0udHJpZ2dlcl92YWx1ZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jYW5ub3RfYmxhbmtfaW5faGFuZGxlcl9tc2cxJyksCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKGhhbmRsZXIudHJpZ2dlcnNbX2k2XS50cmlnZ2VyX3R5cGUgPT09ICJlbnRpdHkiKSB7CiAgICAgICAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vyc1tfaTZdLm9wZXJhbmQgPT09ICIiIHx8IGhhbmRsZXIudHJpZ2dlcnNbX2k2XS5vcGVyYW5kID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jYW5ub3RfYmxhbmtfaW5faGFuZGxlcl9tc2cyJyksCiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIudHJpZ2dlcnNbX2k2XS5vcGVyYW5kID09PSAiaXMiKSB7CiAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyLnRyaWdnZXJzW19pNl0uZW50aXR5X3ZhbHVlID09PSAiIiB8fCBoYW5kbGVyLnRyaWdnZXJzW19pNl0uZW50aXR5X3ZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfY2Fubm90X2JsYW5rX2luX2hhbmRsZXJfbXNnMycpLAogICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoaGFuZGxlci5yZXNwb25zZXMubGVuZ3RoIDwgMSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfb25lX3Jlc3BfaGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlci5yZXNwb25zZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBmb3IgKHZhciBfaTcgPSAwOyBfaTcgPCBoYW5kbGVyLnJlc3BvbnNlcy5sZW5ndGg7IF9pNysrKSB7CiAgICAgICAgICAgICAgaWYgKGhhbmRsZXIucmVzcG9uc2VzW19pN10udHlwZSA9PT0gInRleHQiKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhhbmRsZXIucmVzcG9uc2VzW19pN10udmFsdWVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKGhhbmRsZXIucmVzcG9uc2VzW19pN10udmFsdWVzW2pdKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV90ZXh0X3Jlc3BfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlc1tfaTddLnR5cGUgPT09ICJpbWFnZSIpIHsKICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKGhhbmRsZXIucmVzcG9uc2VzW19pN10uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2ltZ19yZXNwX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVnX2ltYWdlLnRlc3QoaGFuZGxlci5yZXNwb25zZXNbX2k3XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfdmFsaWRfaW1nX3VybF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlci5yZXNwb25zZXNbX2k3XS50eXBlID09PSAidmlkZW8iKSB7CiAgICAgICAgICAgICAgICBpZiAoQm9vbGVhbihoYW5kbGVyLnJlc3BvbnNlc1tfaTddLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV92aWRlb19yZXNwX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVnX3VybC50ZXN0KGhhbmRsZXIucmVzcG9uc2VzW19pN10uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3ZhbGlkX3ZpZGVvX3VybF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlci5yZXNwb25zZXNbX2k3XS50eXBlID09PSAiY2hvaWNlcyIpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIF9qNiA9IDA7IF9qNiA8IGhhbmRsZXIucmVzcG9uc2VzW19pN10uY2hvaWNlcy5sZW5ndGg7IF9qNisrKSB7CiAgICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKGhhbmRsZXIucmVzcG9uc2VzW19pN10uY2hvaWNlc1tfajZdLnRpdGxlKSA9PT0gZmFsc2UgfHwgQm9vbGVhbihoYW5kbGVyLnJlc3BvbnNlc1tfaTddLmNob2ljZXNbX2o2XS5wYXlsb2FkKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jaG9pY2VfcmVzcF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRsZXIucmVzcG9uc2VzW19pN10udHlwZSA9PT0gImNhcmQiKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBfajcgPSAwOyBfajcgPCBoYW5kbGVyLnJlc3BvbnNlc1tfaTddLmNhcmRfbGlzdC5sZW5ndGg7IF9qNysrKSB7CiAgICAgICAgICAgICAgICAgIHZhciBjYXJvdXNlbCA9IGhhbmRsZXIucmVzcG9uc2VzW19pN10uY2FyZF9saXN0W19qN107CgogICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwuaXNfaW1hZ2UgPT09IHRydWUpIHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVyLnJlc3BvbnNlc1tfaTddLmNhcmRfbGlzdFtfajddLnZpZGVvID0gIiI7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlci5yZXNwb25zZXNbX2k3XS5jYXJkX2xpc3RbX2o3XS5pbWFnZSA9ICIiOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB2YXIgYnV0dG9uX2hhc192YWx1ZSA9IGZhbHNlOwoKICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjYXJvdXNlbC5idXR0b25zLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNhcm91c2VsLmJ1dHRvbnNba10udGl0bGUgIT0gIiIgfHwgY2Fyb3VzZWwuYnV0dG9uc1trXS52YWx1ZSAhPSAiIikgewogICAgICAgICAgICAgICAgICAgICAgYnV0dG9uX2hhc192YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwudGl0bGUgPT09ICIiICYmIGNhcm91c2VsLnRleHQgPT09ICIiICYmIGNhcm91c2VsLmltYWdlID09PSAiIiAmJiBjYXJvdXNlbC52aWRlbyA9PT0gIiIgJiYgYnV0dG9uX2hhc192YWx1ZSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jYXJkX2ZpbGxlZF9mb3JfaGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwuaW1hZ2UgIT0gIiIgJiYgdGhpcy5yZWdfaW1hZ2UudGVzdChjYXJvdXNlbC5pbWFnZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfY2FyZF92YWxpZF9pbWdfdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKGNhcm91c2VsLnZpZGVvICE9ICIiICYmIHRoaXMucmVnX3VybC50ZXN0KGNhcm91c2VsLnZpZGVvKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jYXJkX3ZhbGlkX3ZpZGVvX3VybF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgY2Fyb3VzZWwuYnV0dG9ucy5sZW5ndGg7IGQrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChjYXJvdXNlbC5idXR0b25zW2RdLnRpdGxlICE9ICIiICYmIGNhcm91c2VsLmJ1dHRvbnNbZF0udmFsdWUgPT0gIiIgfHwgY2Fyb3VzZWwuYnV0dG9uc1tkXS50aXRsZSA9PSAiIiAmJiBjYXJvdXNlbC5idXR0b25zW2RdLnZhbHVlICE9ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2NhcmRfdmFsaWRfaW1nX3VybF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5pc193ZWJob29rX2RldGFpbHMpIHsKICAgICAgICB0aGlzLmlzX3dlYmhvb2sgPSBmYWxzZTsKICAgICAgICB0aGlzLndlYmhvb2tfbWFwcGluZyA9IFtdOwogICAgICB9CgogICAgICBpZiAodGhpcy5pc193ZWJob29rKSB7CiAgICAgICAgaWYgKCFCb29sZWFuKHRoaXMud2ViaG9va19pZCkpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va19uYW1lX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICghQm9vbGVhbih0aGlzLndlYmhvb2tfdmFyaWFibGUpKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfcmV0dXJuX3ZhcmlhYmxlX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICghQm9vbGVhbih0aGlzLndlYmhvb2tfbWFwcGluZy5sZW5ndGgpKSB7Ly8gU3dhbCh7CiAgICAgICAgICAvLyAgIHRleHQ6ICJBdGxlYXN0IGFkZCBvbmUgd2ViaG9vayBwYXJhbWV0ZXIiLAogICAgICAgICAgLy8gICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAvLyAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgLy8gICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgLy8gICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAvLyAgIHRpbWVyOiA4MDAwLAogICAgICAgICAgLy8gfSk7CiAgICAgICAgICAvLyByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLndlYmhvb2tfbWFwcGluZy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgaWYgKCFCb29sZWFuKHRoaXMud2ViaG9va19tYXBwaW5nW2luZGV4XS5rZXkpIHx8ICFCb29sZWFuKHRoaXMud2ViaG9va19tYXBwaW5nW2luZGV4XS52YWx1ZSkpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX3BhcmFfZW1wdHlfbXNnMScpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzX25vdGlmaWNhdGlvbikgewogICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnR5cGUgPT0gIiIgfHwgdGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS50eXBlID09IG51bGwpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va19ub3RpZmljYXRpb25fdHlwZV9tc2cnKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS5zbG90ID09ICIiIHx8IHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0uc2xvdCA9PSBudWxsKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfZW50ZXJfbmFtZV9tc2cnKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS50ZW1wbGF0ZV9uYW1lID09ICIiIHx8IHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udGVtcGxhdGVfbmFtZSA9PSBudWxsKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfdGVtcGxhdGVfbmFtZV9tc2cnKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcy5sZW5ndGggPCAxKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfbm90aWZpY2F0aW9uX2Zvcl9ib3RfY2FzZXNfbXNnJyksCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgY2hlY2tfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfcmVzcG9uc2UgPSBmYWxzZTsKICAgICAgICAgIHZhciBjaGVja19ub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX3Jlc3BvbnNlID0gZmFsc2U7CgogICAgICAgICAgZm9yICh2YXIgX2w0ID0gMDsgX2w0IDwgdGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcy5sZW5ndGg7IF9sNCsrKSB7CiAgICAgICAgICAgIHZhciBub3RpZmljYXRpb25fcmVzcG9uc2VfaWQgPSB0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzW19sNF07CgogICAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Vbbm90aWZpY2F0aW9uX3Jlc3BvbnNlX2lkXS5jb25kaXRpb24gPT09ICIhc3VjY2Vzc2Z1bCIpIHsKICAgICAgICAgICAgICBjaGVja19ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF9yZXNwb25zZSA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtub3RpZmljYXRpb25fcmVzcG9uc2VfaWRdLmNvbmRpdGlvbiA9PT0gIiF1bnN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICAgICAgY2hlY2tfbm90aWZpY2F0aW9uX3Vuc3VjY2Vzc2Z1bF9yZXNwb25zZSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIUJvb2xlYW4oY2hlY2tfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfcmVzcG9uc2UpKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX25vdGlmaWNhdGlvbl9zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmICghQm9vbGVhbihjaGVja19ub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX3Jlc3BvbnNlKSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va19ub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgaW4gdGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcykgewogICAgICAgICAgdGhpcy5kZWxldGVfYXNpc3RhbmNlX3Jlc3BvbnNlX2J5X2lkKHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXNbaV0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5hcnJhbmdlX2lkc19mdW5jdGlvbigpOwogICAgICAgIHRoaXMubm90aWZpY2F0aW9ucyA9IHsKICAgICAgICAgIG5vdGlmeTogW3sKICAgICAgICAgICAgdHlwZTogIiIsCiAgICAgICAgICAgIHNsb3Q6ICIiLAogICAgICAgICAgICB0ZW1wbGF0ZV9pZDogIiIsCiAgICAgICAgICAgIHRlbXBsYXRlX25hbWU6ICIiCiAgICAgICAgICB9XSwKICAgICAgICAgIHJlc3BvbnNlczogW10KICAgICAgICB9OwogICAgICB9CgogICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoIDwgMSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfb25lX3Jlc3BfdG9fbm9kZV9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBfaTggPSAwOyBfaTggPCB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGg7IF9pOCsrKSB7CiAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS50eXBlID09PSAidGV4dCIpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2o4ID0gMDsgX2o4IDwgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS52YWx1ZXMubGVuZ3RoOyBfajgrKykgewogICAgICAgICAgICAgIGlmIChCb29sZWFuKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0udmFsdWVzW19qOF0pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX3RleHRfcmVzcG9uc2VfbXNnJyksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLnR5cGUgPT09ICJpbWFnZSIpIHsKICAgICAgICAgICAgaWYgKEJvb2xlYW4odGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfaW1nX3Jlc3BvbnNlX21zZycpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLnJlZ19pbWFnZS50ZXN0KHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX3ZhbGlkX2ltZ191cmxfbXNnJyksCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLnR5cGUgPT09ICJ2aWRlbyIpIHsKICAgICAgICAgICAgaWYgKEJvb2xlYW4odGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfdmlkZW9fcmVzcG9uc2VfbXNnJyksCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMucmVnX3VybC50ZXN0KHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX3ZhbGlkX3ZpZGVvX3VybF9tc2cnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0udHlwZSA9PT0gImNob2ljZXMiKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9qOSA9IDA7IF9qOSA8IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0uY2hvaWNlcy5sZW5ndGg7IF9qOSsrKSB7CiAgICAgICAgICAgICAgaWYgKEJvb2xlYW4odGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5jaG9pY2VzW19qOV0udGl0bGUpID09PSBmYWxzZSB8fCBCb29sZWFuKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0uY2hvaWNlc1tfajldLnBheWxvYWQpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX2Nob2ljZV9yZXNwb25zZV9tc2cnKSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0udHlwZSA9PT0gImNhcmQiKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9qMTAgPSAwOyBfajEwIDwgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5jYXJkX2xpc3QubGVuZ3RoOyBfajEwKyspIHsKICAgICAgICAgICAgICB2YXIgX2Nhcm91c2VsMiA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0uY2FyZF9saXN0W19qMTBdOwoKICAgICAgICAgICAgICBpZiAoX2Nhcm91c2VsMi5pc19pbWFnZSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5jYXJkX2xpc3RbX2oxMF0udmlkZW8gPSAiIjsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5jYXJkX2xpc3RbX2oxMF0uaW1hZ2UgPSAiIjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBfYnV0dG9uX2hhc192YWx1ZTIgPSBmYWxzZTsKCiAgICAgICAgICAgICAgZm9yICh2YXIgX2syID0gMDsgX2syIDwgX2Nhcm91c2VsMi5idXR0b25zLmxlbmd0aDsgX2syKyspIHsKICAgICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwyLmJ1dHRvbnNbX2syXS50aXRsZSAhPSAiIiB8fCBfY2Fyb3VzZWwyLmJ1dHRvbnNbX2syXS52YWx1ZSAhPSAiIikgewogICAgICAgICAgICAgICAgICBfYnV0dG9uX2hhc192YWx1ZTIgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKF9jYXJvdXNlbDIudGl0bGUgPT09ICIiICYmIF9jYXJvdXNlbDIudGV4dCA9PT0gIiIgJiYgX2Nhcm91c2VsMi5pbWFnZSA9PT0gIiIgJiYgX2Nhcm91c2VsMi52aWRlbyA9PT0gIiIgJiYgX2J1dHRvbl9oYXNfdmFsdWUyID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX2ZpbGxlZF9mb3JfaGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoX2Nhcm91c2VsMi5pbWFnZSAhPSAiIiAmJiB0aGlzLnJlZ19pbWFnZS50ZXN0KF9jYXJvdXNlbDIuaW1hZ2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX3ZhbGlkX2ltZ191cmxfaGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoX2Nhcm91c2VsMi52aWRlbyAhPSAiIiAmJiB0aGlzLnJlZ191cmwudGVzdChfY2Fyb3VzZWwyLnZpZGVvKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va192YWxpZF92aWRlb191cmxfaGFuZGxlcl9tc2cxJyksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZm9yICh2YXIgX2QyID0gMDsgX2QyIDwgX2Nhcm91c2VsMi5idXR0b25zLmxlbmd0aDsgX2QyKyspIHsKICAgICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwyLmJ1dHRvbnNbX2QyXS50aXRsZSAhPSAiIiAmJiBfY2Fyb3VzZWwyLmJ1dHRvbnNbX2QyXS52YWx1ZSA9PSAiIiB8fCBfY2Fyb3VzZWwyLmJ1dHRvbnNbX2QyXS50aXRsZSA9PSAiIiAmJiBfY2Fyb3VzZWwyLmJ1dHRvbnNbX2QyXS52YWx1ZSAhPSAiIikgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va192YWxpZF9pbWdfdXJsX2hhbmRsZXJfbXNnMScpLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCF0aGlzLm5leHRfc3RlcC5iZWhhdmlvcikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X3dlYmhvb2tfbmV4dF9zdGVwX21zZzEnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5zYXZlX3RoZW5fYXNzaXN0YW50X3Nob3VsZCA9PSAianVtcF90byIgJiYgdGhpcy5qdW1wX3RvX25vZGVfaWQgPT0gIiIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd193ZWJob29rX25leHRfaWRfbXNnMScpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzX3Nsb3QgJiYgdGhpcy5zbG90cy5sZW5ndGggIT0gMCkgewogICAgICAgIHRoaXMubm9kZV90eXBlID0gImZvcm0iOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubm9kZV90eXBlID0gImJhc2ljIjsKICAgICAgfQoKICAgICAgdmFyIG5ld190cmlnZ2VycyA9IHRoaXMudHJpZ2dlcnM7CiAgICAgIHZhciBuZXdfYXNzaXN0YW50X3Jlc3BvbnNlID0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2U7CiAgICAgIHZhciBuZXdfc2xvdHMgPSB0aGlzLnNsb3RzOwogICAgICB2YXIgd2ViaG9va19tYXBwaW5nID0gdGhpcy53ZWJob29rX21hcHBpbmc7CiAgICAgIHZhciBtYW5hZ2VfaGFuZGxlcnMgPSB0aGlzLm1hbmFnZV9oYW5kbGVyczsKICAgICAgdmFyIG5ld19uZXh0X3N0ZXAgPSB0aGlzLm5leHRfc3RlcDsKICAgICAgdmFyIG5vZGUgPSBuZXcgVHJlZU5vZGUoewogICAgICAgIG5hbWU6IHRoaXMubm9kZV9uYW1lLAogICAgICAgIG5vZGVfbmFtZTogdGhpcy5ub2RlX3R5cGUgKyAiXyIgKyB0aGlzLm5vZGVfbmFtZSwKICAgICAgICBub2RlX3R5cGU6IHRoaXMubm9kZV90eXBlLAogICAgICAgIGlzX2xlYWY6IGZhbHNlLAogICAgICAgIGlzX3Jvb3Q6IHRydWUsCiAgICAgICAgdHJpZ2dlcnM6IG5ld190cmlnZ2VycywKICAgICAgICByZXNwb25zZXM6IG5ld19hc3Npc3RhbnRfcmVzcG9uc2UsCiAgICAgICAgc2xvdF9zZXR0aW5nOiB0aGlzLmlzX3Nsb3QsCiAgICAgICAgbm90aWZpY2F0aW9uX2VuYWJsZWQ6IHRoaXMuaXNfbm90aWZpY2F0aW9uLAogICAgICAgIHNsb3RzOiB0aGlzLmlzX3Nsb3QgPyBuZXdfc2xvdHMgOiBudWxsLAogICAgICAgIG5vdGlmaWNhdGlvbnM6IHRoaXMuaXNfbm90aWZpY2F0aW9uID8gdGhpcy5ub3RpZmljYXRpb25zIDogbnVsbCwKICAgICAgICBuZXh0X3N0ZXA6IG5ld19uZXh0X3N0ZXAsCiAgICAgICAgd2ViaG9va19pbnRlZ3JhdGlvbjogdGhpcy5pc193ZWJob29rLAogICAgICAgIHdlYmhvb2tfaWQ6IHRoaXMuaXNfd2ViaG9vayA/IHRoaXMud2ViaG9va19pZCA6IG51bGwsCiAgICAgICAgd2ViaG9va19yZXR1cm5fdmFyaWFibGU6IHRoaXMuaXNfd2ViaG9vayA/IHRoaXMud2ViaG9va192YXJpYWJsZSA6ICIiLAogICAgICAgIHdlYmhvb2tfbWFwcGluZzogdGhpcy5pc193ZWJob29rID8gd2ViaG9va19tYXBwaW5nIDogbnVsbCwKICAgICAgICBlZGl0Tm9kZURpc2FibGVkOiB0cnVlLAogICAgICAgIG1hbmFnZV9oYW5kbGVyczogbWFuYWdlX2hhbmRsZXJzLmxlbmd0aCA+IDAgJiYgdGhpcy5pc19zbG90ID8gbWFuYWdlX2hhbmRsZXJzIDogbnVsbCAvLyBhZGRUcmVlTm9kZURpc2FibGVkOiB0cnVlLAogICAgICAgIC8vIGFkZExlYWZOb2RlRGlzYWJsZWQ6IHRydWUKCiAgICAgIH0pOwogICAgICBpZiAoIXRoaXMuZGF0YS5jaGlsZHJlbikgdGhpcy5kYXRhLmNoaWxkcmVuID0gW107CiAgICAgIHRoaXMuZGF0YS5hZGRDaGlsZHJlbihub2RlKTsKICAgICAgdGhpcy5ub2Rlc19saXN0LnB1c2goW3sKICAgICAgICBpZDogbm9kZS5pZCwKICAgICAgICBuYW1lOiBub2RlLm5hbWUKICAgICAgfV0pOwogICAgICB0aGlzLnB1c2hOZXdUcmVlKCJhZGRub2RlIik7CiAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFkZF90cmlnZ2VyX2J0biIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwoKICAgICAgJCgiI2FkZG5vZGVtb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICB9LAogICAgZW1wdHlfdmFyaWFibGU6IGZ1bmN0aW9uIGVtcHR5X3ZhcmlhYmxlKCkgewogICAgICB0aGlzLm5vZGVfaWQgPSAiIjsKICAgICAgdGhpcy5ub2RlX25hbWUgPSAiIjsKICAgICAgdGhpcy5ub2RlX3R5cGUgPSAiIjsKICAgICAgdGhpcy5pc19yb290ID0gZmFsc2U7CiAgICAgIHRoaXMuaXNfc2xvdCA9IGZhbHNlOwogICAgICB0aGlzLmlzX25vdGlmaWNhdGlvbiA9IGZhbHNlOwogICAgICB0aGlzLmlzX3dlYmhvb2sgPSBmYWxzZTsKICAgICAgdGhpcy53ZWJob29rX2lkID0gbnVsbDsKICAgICAgdGhpcy53ZWJob29rX3ZhcmlhYmxlID0gIiI7CiAgICAgIHRoaXMud2ViaG9va19tYXBwaW5nID0gW107CiAgICAgIHRoaXMudHJpZ2dlcnMgPSBbewogICAgICAgIHRyaWdnZXJfdHlwZTogIiIsCiAgICAgICAgdHJpZ2dlcl92YWx1ZTogIiIKICAgICAgfV07CiAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CiAgICAgIHRoaXMuZmlsdGVyZWRfYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CiAgICAgIHRoaXMuc2xvdHMgPSBbXTsKICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnMgPSBbXTsKICAgICAgdGhpcy5ub3RpZmljYXRpb25zID0gewogICAgICAgIG5vdGlmeTogW3sKICAgICAgICAgIHR5cGU6ICIiLAogICAgICAgICAgc2xvdDogIiIsCiAgICAgICAgICB0ZW1wbGF0ZV9pZDogIiIsCiAgICAgICAgICB0ZW1wbGF0ZV9uYW1lOiAiIgogICAgICAgIH1dLAogICAgICAgIHJlc3BvbnNlczogW10KICAgICAgfSwgdGhpcy5uZXh0X3N0ZXAgPSB7fTsKICAgICAgdGhpcy5zYXZlX3RoZW5fYXNzaXN0YW50X3Nob3VsZCA9ICIiOwogICAgICB0aGlzLmp1bXBfdG9fbm9kZV9pZCA9ICIiOwogICAgICB0aGlzLmlzX3Nob3dfZWRpdCA9IGZhbHNlOwogICAgICB0aGlzLnVwZGF0ZWRfbm9kZV9saXN0ID0gW107IC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhZGRfdHJpZ2dlcl9idG4iKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgIH0sCiAgICBwdXNoTmV3VHJlZTogZnVuY3Rpb24gcHVzaE5ld1RyZWUoZnJvbSkgewogICAgICB2YXIgX3RoaXMxNiA9IHRoaXM7CgogICAgICB2YXIgdm0gPSB0aGlzOwoKICAgICAgZnVuY3Rpb24gX2RmcyhvbGROb2RlKSB7CiAgICAgICAgdmFyIG5ld05vZGUgPSB7fTsKCiAgICAgICAgZm9yICh2YXIgayBpbiBvbGROb2RlKSB7CiAgICAgICAgICBpZiAoayAhPT0gImNoaWxkcmVuIiAmJiBrICE9PSAicGFyZW50IikgewogICAgICAgICAgICBuZXdOb2RlW2tdID0gb2xkTm9kZVtrXTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChvbGROb2RlLmNoaWxkcmVuICYmIG9sZE5vZGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgbmV3Tm9kZS5jaGlsZHJlbiA9IFtdOwoKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBvbGROb2RlLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIG5ld05vZGUuY2hpbGRyZW4ucHVzaChfZGZzKG9sZE5vZGUuY2hpbGRyZW5baV0pKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmV3Tm9kZS5jaGlsZHJlbiA9IFtdOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ld05vZGU7CiAgICAgIH0KCiAgICAgIHZtLm5ld1RyZWUgPSBfZGZzKHZtLmRhdGEpOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fZGlhbG9nX3RyZWUoKSwgewogICAgICAgIGNvbXBhbnlfaWQ6IHZtLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBjb21wYW55X25hbWU6IHZtLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgIGlzX3NhdmU6IHRydWUsCiAgICAgICAgbm9kZV9zdHJ1Y3R1cmU6IHZtLm5ld1RyZWUKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICQoIiNhZGRub2RlbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwoKICAgICAgICBpZiAoX3RoaXMxNi5hcGlfc3RhdHVzX2NvZGUuTk9ERV9TVFJVQ1RVUkVfU0FWRURfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIGlmIChmcm9tID09ICJhZGRub2RlIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgdGV4dDogX3RoaXMxNi50bHQoJ2RpYWxvZ19mbG93X25vZGVfYWRkZWRfbXNnJyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGZyb20gPT0gImNoaWxkbm9kZSIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIHRleHQ6IF90aGlzMTYudGx0KCdkaWFsb2dfZmxvd19jaGlsZF9ub2RlX2FkZGVkX21zZycpLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmIChmcm9tID09ICJlZGl0bm9kZSIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIHRleHQ6IF90aGlzMTYudGx0KCdkaWFsb2dfZmxvd19ub2RlX2VkaXRlZF9tc2cnKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAoZnJvbSA9PSAiZGVsZXRlbm9kZSIpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIHRleHQ6IF90aGlzMTYudGx0KCdkaWFsb2dfZmxvd19ub2RlX2RlbGV0ZWRfbXNnJyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgdGV4dDogX3RoaXMxNi50bHQoJ2RpYWxvZ19mbG93X2RpYWxvZ191cGRhdGVkX21zZycpLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoX3RoaXMxNi5hcGlfc3RhdHVzX2NvZGUuTk9ERV9TVFJVQ1RVUkVfTk9UX1NBVkVEX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXMxNi5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczE2LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXMuY2xvc2VfbW9kYWwoJ3NhdmVfY2hhbmdlc19idG4nKTsKICAgIH0sCiAgICB0ZXN0TmV3VHJlZTogZnVuY3Rpb24gdGVzdE5ld1RyZWUoKSB7CiAgICAgIHZhciB2bSA9IHRoaXM7CgogICAgICBmdW5jdGlvbiBfZGZzKG9sZE5vZGUpIHsKICAgICAgICB2YXIgbmV3Tm9kZSA9IHt9OwoKICAgICAgICBmb3IgKHZhciBrIGluIG9sZE5vZGUpIHsKICAgICAgICAgIGlmIChrICE9PSAiY2hpbGRyZW4iICYmIGsgIT09ICJwYXJlbnQiKSB7CiAgICAgICAgICAgIG5ld05vZGVba10gPSBvbGROb2RlW2tdOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKG9sZE5vZGUuY2hpbGRyZW4gJiYgb2xkTm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICBuZXdOb2RlLmNoaWxkcmVuID0gW107CgogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG9sZE5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgbmV3Tm9kZS5jaGlsZHJlbi5wdXNoKF9kZnMob2xkTm9kZS5jaGlsZHJlbltpXSkpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ld05vZGU7CiAgICAgIH0KCiAgICAgIHZtLm5ld1RyZWUgPSBfZGZzKHZtLmRhdGEpOwogICAgfSwKICAgIHJlbW92ZV9jdXJyZW50X25vZGVfanVtcF9uYW1lOiBmdW5jdGlvbiByZW1vdmVfY3VycmVudF9ub2RlX2p1bXBfbmFtZShhcnIsIHZhbHVlKSB7CiAgICAgIHZhciB1cGRhdGVfbGlzdCA9IGZhbHNlOwoKICAgICAgZm9yICh2YXIgX2k5ID0gMCwgbGVuID0gYXJyLmxlbmd0aDsgX2k5IDwgbGVuOyBfaTkrKykgewogICAgICAgIHZhciBmb3VuZCA9IGFycltfaTldLnNvbWUoZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgcmV0dXJuIHZhbC5uYW1lID09PSB2YWx1ZTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGZvdW5kID09IHRydWUpIHsKICAgICAgICAgIHRoaXMudXBkYXRlZF9ub2RlX2xpc3QgPSBhcnJbX2k5XS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmFtZSAhPT0gdmFsdWU7CiAgICAgICAgICB9KTsKICAgICAgICAgIHVwZGF0ZV9saXN0ID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHVwZGF0ZV9saXN0ID09PSBmYWxzZSkgewogICAgICAgIHRoaXMudXBkYXRlZF9ub2RlX2xpc3QgPSBbXTsKICAgICAgfQogICAgfSwKICAgIHNldF9uZXh0X3N0ZXA6IGZ1bmN0aW9uIHNldF9uZXh0X3N0ZXAoKSB7CiAgICAgIHRoaXMubmV4dF9zdGVwID0gewogICAgICAgIGJlaGF2aW9yOiB0aGlzLnNhdmVfdGhlbl9hc3Npc3RhbnRfc2hvdWxkLAogICAgICAgIG5vZGVfaWQ6IHRoaXMuc2F2ZV90aGVuX2Fzc2lzdGFudF9zaG91bGQgPT0gImp1bXBfdG8iID8gdGhpcy5qdW1wX3RvX25vZGVfaWQudG9TdHJpbmcoKSA6IG51bGwsCiAgICAgICAgc2VsZWN0b3I6IHRoaXMuc2F2ZV90aGVuX2Fzc2lzdGFudF9zaG91bGQgPT0gImp1bXBfdG8iID8gInJlc3BvbmQiIDogIndhaXRfZm9yX3VzZXJfaW5wdXQiCiAgICAgIH07CiAgICB9LAogICAgYWRkX3RvX3RyaWdnZXJzX2xpc3Q6IGZ1bmN0aW9uIGFkZF90b190cmlnZ2Vyc19saXN0KGZ1bmMsIGluZGV4KSB7CiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy50cmlnZ2Vycy5wdXNoKHsKICAgICAgICAgIHRyaWdnZXJfdHlwZTogIiIsCiAgICAgICAgICB0cmlnZ2VyX3ZhbHVlOiAiIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLnRyaWdnZXJzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIH0gLy8gaWYgKHRoaXMuaXNfcm9vdCAmJiB0aGlzLnRyaWdnZXJzLmxlbmd0aCA+IDApIHsKICAgICAgLy8gICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYWRkX3RyaWdnZXJfYnRuIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgLy8gfQoKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfY2hhbmdlX3RyaWdnZXJfdmFsdWU6IGZ1bmN0aW9uIG1hbmFnZV9oYW5kbGVyc19jaGFuZ2VfdHJpZ2dlcl92YWx1ZSh0eXBlLCBpbmRleCwgaW5kKSB7CiAgICAgIGlmICh0eXBlID09PSAiaW50ZW50IikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdLnRyaWdnZXJfdmFsdWUgPSAiIjsKICAgICAgICBkZWxldGUgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0ub3BlcmFuZDsKICAgICAgICBkZWxldGUgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0uZW50aXR5X3ZhbHVlOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJlbnRpdHkiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0udHJpZ2dlcl92YWx1ZSA9ICIiOwogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdLm9wZXJhbmQgPSAiIjsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWUgPSAiIjsKICAgICAgfQogICAgfSwKICAgIGNoYW5nZV90cmlnZ2VyX3ZhbHVlOiBmdW5jdGlvbiBjaGFuZ2VfdHJpZ2dlcl92YWx1ZSh0eXBlLCBpbmRleCkgewogICAgICBpZiAodHlwZSA9PT0gImludGVudCIpIHsKICAgICAgICB0aGlzLnRyaWdnZXJzW2luZGV4XS50cmlnZ2VyX3ZhbHVlID0gIiI7CiAgICAgICAgZGVsZXRlIHRoaXMudHJpZ2dlcnNbaW5kZXhdLm9wZXJhbmQ7CiAgICAgICAgZGVsZXRlIHRoaXMudHJpZ2dlcnNbaW5kZXhdLmVudGl0eV92YWx1ZTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAiZW50aXR5IikgewogICAgICAgIHRoaXMudHJpZ2dlcnNbaW5kZXhdLnRyaWdnZXJfdmFsdWUgPSAiIjsKICAgICAgICB0aGlzLnRyaWdnZXJzW2luZGV4XS5vcGVyYW5kID0gIiI7CiAgICAgICAgdGhpcy50cmlnZ2Vyc1tpbmRleF0uZW50aXR5X3ZhbHVlID0gIiI7CiAgICAgIH0KICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfY2hhbmdlX3RyaWdnZXJfdHlwZTogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2NoYW5nZV90cmlnZ2VyX3R5cGUodHlwZSwgdmFsdWUsIGluZGV4LCBpbmQpIHsKICAgICAgaWYgKHR5cGUgPT09ICJpbnRlbnQiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5uYW1lID0gIiMiICsgdmFsdWU7CiAgICAgICAgZGVsZXRlIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdLm9wZXJhbmQ7CiAgICAgICAgZGVsZXRlIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdLmVudGl0eV92YWx1ZTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAiZW50aXR5IikgewogICAgICAgIGlmICh2YWx1ZS5zdWJzdHJpbmcoMCwgMSkgPT09ICJAIikgewogICAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5uYW1lID0gIiMiICsgdmFsdWUuc3Vic3RyaW5nKDEsIHZhbHVlLmxlbmd0aCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ubmFtZSA9ICIjIiArIHZhbHVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuaXNfZW50aXR5X3R5cGVfc3lzX3BhdHRlcm4odmFsdWUpKSB7CiAgICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS5vcGVyYW5kID0gImFueSI7CiAgICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWUgPSAiIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0ub3BlcmFuZCA9ICIiOwogICAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0uZW50aXR5X3ZhbHVlID0gIiI7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY2hhbmdlX3RyaWdnZXJfdHlwZTogZnVuY3Rpb24gY2hhbmdlX3RyaWdnZXJfdHlwZSh0eXBlLCB2YWx1ZSwgaW5kZXgpIHsKICAgICAgLy8gQGNsaWNrPSJjaGFuZ2VfdHJpZ2dlcl90eXBlKHRyaWdnZXIudHJpZ2dlcl92YWx1ZSwgaW5kZXgpIgogICAgICAvLyBIZXJlIGFkZCBkZXRlY3Rpb24gb2Ygd2hldGhlciB0aGUgdmFsdWUgc2VsZWN0ZWQgaXMgaW50ZW50IG9yIGVudGl0eQogICAgICAvLyBpZiAoQm9vbGVhbih2YWx1ZS5lbnRpdHkpKSB7CiAgICAgIC8vICAgdGhpcy50cmlnZ2Vyc1tpbmRleF0udHJpZ2dlcl90eXBlID0gImVudGl0eSI7CiAgICAgIC8vIH0gZWxzZSB7CiAgICAgIC8vICAgdGhpcy50cmlnZ2Vyc1tpbmRleF0udHJpZ2dlcl90eXBlID0gImludGVudCI7CiAgICAgIC8vIH0KICAgICAgaWYgKHRoaXMuaXNfcm9vdCkgewogICAgICAgIHRoaXMudHJpZ2dlcnNbaW5kZXhdLnRyaWdnZXJfdHlwZSA9ICJpbnRlbnQiOwogICAgICB9CgogICAgICBpZiAodHlwZSA9PT0gImludGVudCIpIHsKICAgICAgICBkZWxldGUgdGhpcy50cmlnZ2Vyc1tpbmRleF0ub3BlcmFuZDsKICAgICAgICBkZWxldGUgdGhpcy50cmlnZ2Vyc1tpbmRleF0uZW50aXR5X3ZhbHVlOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJlbnRpdHkiKSB7CiAgICAgICAgaWYgKHRoaXMuaXNfZW50aXR5X3R5cGVfc3lzX3BhdHRlcm4odmFsdWUpKSB7CiAgICAgICAgICB0aGlzLnRyaWdnZXJzW2luZGV4XS5vcGVyYW5kID0gImFueSI7CiAgICAgICAgICB0aGlzLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWUgPSAiIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy50cmlnZ2Vyc1tpbmRleF0ub3BlcmFuZCA9ICIiOwogICAgICAgICAgdGhpcy50cmlnZ2Vyc1tpbmRleF0uZW50aXR5X3ZhbHVlID0gIiI7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2NoYW5nZV90cmlnZ2VyX2VudGl0eV92YWx1ZTogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2NoYW5nZV90cmlnZ2VyX2VudGl0eV92YWx1ZShvcGVyYW5kLCBpbmRleCwgaW5kKSB7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZtLiRzZXQodm0ubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnMsIGluZGV4LCB2bS5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0pOwogICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWUgPSAiIjsKICAgIH0sCiAgICBjaGFuZ2VfdHJpZ2dlcl9lbnRpdHlfdmFsdWU6IGZ1bmN0aW9uIGNoYW5nZV90cmlnZ2VyX2VudGl0eV92YWx1ZShvcGVyYW5kLCBpbmRleCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS4kc2V0KHZtLnRyaWdnZXJzLCBpbmRleCwgdm0udHJpZ2dlcnNbaW5kZXhdKTsKICAgICAgdGhpcy50cmlnZ2Vyc1tpbmRleF0uZW50aXR5X3ZhbHVlID0gIiI7CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX3NldF90cmlnZ2VyX2VudGl0eV92YWx1ZTogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX3NldF90cmlnZ2VyX2VudGl0eV92YWx1ZShlbnRpdHlfdmFsdWUsIGluZGV4LCBpbmQpIHsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdm0uJHNldCh2bS5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2VycywgaW5kZXgsIHZtLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XSk7CiAgICB9LAogICAgc2V0X3RyaWdnZXJfZW50aXR5X3ZhbHVlOiBmdW5jdGlvbiBzZXRfdHJpZ2dlcl9lbnRpdHlfdmFsdWUoZW50aXR5X3ZhbHVlLCBpbmRleCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS4kc2V0KHZtLnRyaWdnZXJzLCBpbmRleCwgdm0udHJpZ2dlcnNbaW5kZXhdKTsKICAgIH0sCiAgICBhZGRfdG9fd2ViaG9va19tYXBwaW5nOiBmdW5jdGlvbiBhZGRfdG9fd2ViaG9va19tYXBwaW5nKGZ1bmMsIGluZGV4KSB7CiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy53ZWJob29rX21hcHBpbmcucHVzaCh7CiAgICAgICAgICBrZXk6ICIiLAogICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMud2ViaG9va19tYXBwaW5nLnNwbGljZShpbmRleCwgMSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBzZXRfc2xvdF9zZXR0aW5nKGluZGV4LCBjaGVja19mb3IsIHNsb3QpIHsKICAgIC8vICAgdGhpcy5lZGl0X3Nsb3RfaW5kZXggPSBpbmRleDsKICAgIC8vICAgdGhpcy5lZGl0X3Nsb3RfY2hlY2tfZm9yID0gY2hlY2tfZm9yOwogICAgLy8gICB0aGlzLmVkaXRfc2xvdF9zbG90X3ZhcmlhYmxlID0gc2xvdDsKICAgIC8vIH0sCiAgICBzZXRfc2xvdF92YXJpYWJsZV9pbl9hc3Npc3RhbmNlX3Jlc3BvbnNlOiBmdW5jdGlvbiBzZXRfc2xvdF92YXJpYWJsZV9pbl9hc3Npc3RhbmNlX3Jlc3BvbnNlKGlkLCBzbG90KSB7CiAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLmlkID09PSBpZCkgewogICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLnJlY29nbml6ZXMgPSBzbG90OwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNldF9zbG90X2VudGl0eV92YXJpYWJsZTogZnVuY3Rpb24gc2V0X3Nsb3RfZW50aXR5X3ZhcmlhYmxlKGluZGV4LCBlbnRpdHkpIHsKICAgICAgZW50aXR5ID0gZW50aXR5LnNsaWNlKDEpOwogICAgICB0aGlzLnNsb3RzW2luZGV4XS5zbG90ID0gIiQiICsgZW50aXR5OwoKICAgICAgZm9yICh2YXIgX2kxMCA9IDA7IF9pMTAgPCB0aGlzLnNsb3RzW2luZGV4XS5yZXNwb25zZXMubGVuZ3RoOyBfaTEwKyspIHsKICAgICAgICB2YXIgaWQgPSB0aGlzLnNsb3RzW2luZGV4XS5yZXNwb25zZXNbX2kxMF07CiAgICAgICAgdmFyIHNsb3QgPSB0aGlzLnNsb3RzW2luZGV4XS5zbG90OwogICAgICAgIHRoaXMuc2V0X3Nsb3RfdmFyaWFibGVfaW5fYXNzaXN0YW5jZV9yZXNwb25zZShpZCwgc2xvdCk7CiAgICAgIH0KICAgIH0sCiAgICBzZXRfbm90aWZpY2F0aW9uc19ub3RpZnlfdGVtcGxhdGVfaWQ6IGZ1bmN0aW9uIHNldF9ub3RpZmljYXRpb25zX25vdGlmeV90ZW1wbGF0ZV9pZCh0ZW1wbGF0ZV9uYW1lKSB7CiAgICAgIHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udGVtcGxhdGVfaWQgPSB0aGlzLm5vdGlmaWNhdGlvbnNfbm90aWZ5X3RlbXBsYXRlX2xpc3QuZmlsdGVyKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgcmV0dXJuIG5hbWUudGVtcGxhdGVfbmFtZSA9PT0gdGVtcGxhdGVfbmFtZTsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChpZCkgewogICAgICAgIHJldHVybiBpZC50ZW1wbGF0ZV9pZDsKICAgICAgfSlbMF07CiAgICB9LAogICAgb25fb3Blbl93ZWJob29rX21vZGFsOiBmdW5jdGlvbiBvbl9vcGVuX3dlYmhvb2tfbW9kYWwodmFyaWFibGUpIHsKICAgICAgdGhpcy53ZWJob29rX2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwoKICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5yZWNvZ25pemVzID09IHZhcmlhYmxlKSB7CiAgICAgICAgICB0aGlzLndlYmhvb2tfYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2godGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG9uX2Nsb3NlX3dlYmhvb2tfbW9kYWw6IGZ1bmN0aW9uIG9uX2Nsb3NlX3dlYmhvb2tfbW9kYWwoKSB7CiAgICAgIHRoaXMud2ViaG9va19hc3Npc3RhbnRfcmVzcG9uc2UgPSBbXTsKICAgIH0sCiAgICBvbl9vcGVuX3Nsb3RzX21vZGFsOiBmdW5jdGlvbiBvbl9vcGVuX3Nsb3RzX21vZGFsKHNsb3QsIGluZGV4LCBjaGVja19mb3IpIHsKICAgICAgdGhpcy5lZGl0X3Nsb3RfaW5kZXggPSBpbmRleDsKICAgICAgdGhpcy5lZGl0X3Nsb3RfY2hlY2tfZm9yID0gY2hlY2tfZm9yOwogICAgICB0aGlzLmVkaXRfc2xvdF9zbG90X3ZhcmlhYmxlID0gc2xvdDsKICAgICAgdGhpcy51bmZpbGxlZF9zbG90X2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwogICAgICB0aGlzLnZhbGlkYXRpb25fc2xvdF9hc3Npc3RhbnRfcmVzcG9uc2UgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UpIHsKICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0ucmVjb2duaXplcyA9PSBzbG90ICYmIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmNvbmRpdGlvbiA9PT0gInVuZmlsbGVkX3Nsb3QiKSB7CiAgICAgICAgICB0aGlzLnVuZmlsbGVkX3Nsb3RfYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2godGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLnJlY29nbml6ZXMgPT0gc2xvdCAmJiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5jb25kaXRpb24gPT09ICJ2YWxpZGF0aW9uX3Jlc3BvbnNlIikgewogICAgICAgICAgdGhpcy52YWxpZGF0aW9uX3Nsb3RfYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2godGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5zZWFyY2hfZm9yX2VudGl0eV9oYXNfdmFsaWRhdGlvbihjaGVja19mb3IpOwogICAgfSwKICAgIG9uX2Nsb3NlX3Nsb3RzX21vZGFsOiBmdW5jdGlvbiBvbl9jbG9zZV9zbG90c19tb2RhbCgpIHsKICAgICAgdGhpcy51bmZpbGxlZF9zbG90X2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwogICAgICB0aGlzLnZhbGlkYXRpb25fc2xvdF9hc3Npc3RhbnRfcmVzcG9uc2UgPSBbXTsKICAgICAgdGhpcy5pc192YWxpZGF0aW9uX2VudGl0eSA9IGZhbHNlOwogICAgICB0aGlzLmVkaXRfc2xvdF9pbmRleCA9ICIiOwogICAgICB0aGlzLmVkaXRfc2xvdF9jaGVja19mb3IgPSAiIjsKICAgICAgdGhpcy5lZGl0X3Nsb3Rfc2xvdF92YXJpYWJsZSA9ICIiOwogICAgfSwKICAgIG9uX29wZW5fbm90aWZpY2F0aW9uX21vZGFsOiBmdW5jdGlvbiBvbl9vcGVuX25vdGlmaWNhdGlvbl9tb2RhbCgpIHsKICAgICAgdGhpcy5ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF9hc3Npc3RhbnRfcmVzcG9uc2UgPSBbXTsKICAgICAgdGhpcy5ub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwoKICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5yZWNvZ25pemVzID09ICJzdWNjZXNzZnVsIikgewogICAgICAgICAgdGhpcy5ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF9hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLnJlY29nbml6ZXMgPT0gInVuc3VjY2Vzc2Z1bCIpIHsKICAgICAgICAgIHRoaXMubm90aWZpY2F0aW9uX3Vuc3VjY2Vzc2Z1bF9hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgb25fY2xvc2VfbWFuYWdlX2hhbmRsZXJzOiBmdW5jdGlvbiBvbl9jbG9zZV9tYW5hZ2VfaGFuZGxlcnMoKSB7fSwKICAgIG9uX2Nsb3NlX25vdGlmaWNhdGlvbl9tb2RhbDogZnVuY3Rpb24gb25fY2xvc2Vfbm90aWZpY2F0aW9uX21vZGFsKCkgewogICAgICB0aGlzLm5vdGlmaWNhdGlvbl9zdWNjZXNzZnVsX2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwogICAgICB0aGlzLm5vdGlmaWNhdGlvbl91bnN1Y2Nlc3NmdWxfYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CiAgICB9LAogICAgd2ViaG9va190b19hc3Npc3RhbnRfcmVzcG9uc2U6IGZ1bmN0aW9uIHdlYmhvb2tfdG9fYXNzaXN0YW50X3Jlc3BvbnNlKGZ1bmMsIHdlYmhvb2ssIGluZGV4KSB7CiAgICAgIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgaW5kZXggPSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5maW5kSW5kZXgoZnVuY3Rpb24gKHgpIHsKICAgICAgICAgIHJldHVybiB4LmlkID09IGluZGV4OwogICAgICAgIH0pOwoKICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQgPT0gaW5kZXggJiYgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0ucmVjb2duaXplcyA9PSB3ZWJob29rKSB7CiAgICAgICAgICAgIC8vIHRoaXMuc2xvdHNbdGhpcy5lZGl0X3Nsb3RfaW5kZXhdLnJlc3BvbnNlcy5zcGxpY2UodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQsIDEpOwogICAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJ0ZXh0IikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aCwKICAgICAgICAgIHR5cGU6IHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSwKICAgICAgICAgIGNvbmRpdGlvbjogInVuZmlsbGVkIiwKICAgICAgICAgIHJlY29nbml6ZXM6IHdlYmhvb2ssCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgdmFsdWVzOiBbIiJdCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImltYWdlIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogImltYWdlIiwKICAgICAgICAgIGNvbmRpdGlvbjogInVuZmlsbGVkIiwKICAgICAgICAgIHJlY29nbml6ZXM6IHdlYmhvb2ssCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgc291cmNlOiAiIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJ2aWRlbyIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6ICJ2aWRlbyIsCiAgICAgICAgICBjb25kaXRpb246ICJ1bmZpbGxlZCIsCiAgICAgICAgICByZWNvZ25pemVzOiB3ZWJob29rLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHNvdXJjZTogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiY2hvaWNlcyIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6ICJjaG9pY2VzIiwKICAgICAgICAgIGNvbmRpdGlvbjogInVuZmlsbGVkIiwKICAgICAgICAgIHJlY29nbml6ZXM6IHdlYmhvb2ssCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgZGVzY3JpcHRpb246ICIiLAogICAgICAgICAgY2hvaWNlczogW3sKICAgICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICBwYXlsb2FkOiAiIgogICAgICAgICAgfV0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiY2FyZCIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6ICJjYXJkIiwKICAgICAgICAgIGNvbmRpdGlvbjogInVuZmlsbGVkIiwKICAgICAgICAgIHJlY29nbml6ZXM6IHdlYmhvb2ssCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgZGVzY3JpcHRpb246ICIiLAogICAgICAgICAgY2FyZF9saXN0OiBbewogICAgICAgICAgICBpbWFnZTogIiIsCiAgICAgICAgICAgIGlzX2ltYWdlOiB0cnVlLAogICAgICAgICAgICB2aWRlbzogIiIsCiAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICAgIGJ1dHRvbnM6IFt7CiAgICAgICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgIH1dCiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9CgogICAgICB0aGlzLmFycmFuZ2VfaWRzX2Z1bmN0aW9uKCk7CiAgICAgIHRoaXMub25fb3Blbl93ZWJob29rX21vZGFsKHdlYmhvb2spOwogICAgfSwKICAgIHJlbW92ZV9ub3RpZmljYXRpb25fdG9fYXNzaXN0YW50X3Jlc3BvbnNlOiBmdW5jdGlvbiByZW1vdmVfbm90aWZpY2F0aW9uX3RvX2Fzc2lzdGFudF9yZXNwb25zZShpbmRleCwgcmVjb2duaXplcykgewogICAgICBpbmRleCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGluZGV4OwogICAgICB9KTsKCiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UpIHsKICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQgPT0gaW5kZXggJiYgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0ucmVjb2duaXplcyA9PSByZWNvZ25pemVzKSB7CiAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5vbl9vcGVuX25vdGlmaWNhdGlvbl9tb2RhbCgpOwogICAgICB0aGlzLmFycmFuZ2VfaWRzX2Z1bmN0aW9uKCk7CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2FkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfbGlzdDogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2FkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfbGlzdChmdW5jLCBpbmQsIGluZGV4KSB7CiAgICAgIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAidGV4dCIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6IHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSwKICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHZhbHVlczogWyIiXQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJpbWFnZSIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6IHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSwKICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHNvdXJjZTogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAidmlkZW8iKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUsCiAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICBzb3VyY2U6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImNob2ljZXMiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUsCiAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICBkZXNjcmlwdGlvbjogIiIsCiAgICAgICAgICBjaG9pY2VzOiBbewogICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgIHBheWxvYWQ6ICIiCiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJjYXJkIikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlLAogICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgZGVzY3JpcHRpb246ICIiLAogICAgICAgICAgY2FyZF9saXN0OiBbewogICAgICAgICAgICBpbWFnZTogIiIsCiAgICAgICAgICAgIGlzX2ltYWdlOiB0cnVlLAogICAgICAgICAgICB2aWRlbzogIiIsCiAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICAgIGJ1dHRvbnM6IFt7CiAgICAgICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgIH1dCiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzX2FycmFuZ2VfaWRzX2Z1bmN0aW9uKGluZCk7CiAgICAgIH0KICAgIH0sCiAgICBhZGRfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfdG9fYXNzaXN0YW50X3Jlc3BvbnNlOiBmdW5jdGlvbiBhZGRfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfdG9fYXNzaXN0YW50X3Jlc3BvbnNlKHR5cGUpIHsKICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udHlwZSA9PSAiIiB8fCB0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnR5cGUgPT0gbnVsbCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X25vdGlmaWNhdGlvbl90eXBlX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnNsb3QgPT0gIiIgfHwgdGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS5zbG90ID09IG51bGwpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd192YXJpYWJsZV9uYW1lX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnRlbXBsYXRlX25hbWUgPT0gIiIgfHwgdGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS50ZW1wbGF0ZV9uYW1lID09IG51bGwpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd190ZW1wbGF0ZV9uYW1lX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gInRleHQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgICAgICBjb25kaXRpb246ICIhIiArIHR5cGUsCiAgICAgICAgICByZWNvZ25pemVzOiB0eXBlLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHZhbHVlczogWyIiXQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiaW1hZ2UiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiAiaW1hZ2UiLAogICAgICAgICAgY29uZGl0aW9uOiAiISIgKyB0eXBlLAogICAgICAgICAgcmVjb2duaXplczogdHlwZSwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICBzb3VyY2U6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJ2aWRlbyIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6ICJ2aWRlbyIsCiAgICAgICAgICBjb25kaXRpb246ICIhIiArIHR5cGUsCiAgICAgICAgICByZWNvZ25pemVzOiB0eXBlLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHNvdXJjZTogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImNob2ljZXMiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiAiY2hvaWNlcyIsCiAgICAgICAgICBjb25kaXRpb246ICIhIiArIHR5cGUsCiAgICAgICAgICByZWNvZ25pemVzOiB0eXBlLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgIGRlc2NyaXB0aW9uOiAiIiwKICAgICAgICAgIGNob2ljZXM6IFt7CiAgICAgICAgICAgIHR5cGU6ICJwb3N0YmFjayIsCiAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgcGF5bG9hZDogIiIKICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJjYXJkIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogImNhcmQiLAogICAgICAgICAgY29uZGl0aW9uOiAiISIgKyB0eXBlLAogICAgICAgICAgcmVjb2duaXplczogdHlwZSwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICBkZXNjcmlwdGlvbjogIiIsCiAgICAgICAgICBjYXJkX2xpc3Q6IFt7CiAgICAgICAgICAgIGltYWdlOiAiIiwKICAgICAgICAgICAgaXNfaW1hZ2U6IHRydWUsCiAgICAgICAgICAgIHZpZGVvOiAiIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgYnV0dG9uczogW3sKICAgICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgfV0KICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXMucHVzaCgodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoIC0gMSkudG9TdHJpbmcoKSk7CiAgICAgIHRoaXMub25fb3Blbl9ub3RpZmljYXRpb25fbW9kYWwoKTsKICAgIH0sCiAgICByZW1vdmVfc2xvdF90b19hc3Npc3RhbnRfcmVzcG9uc2U6IGZ1bmN0aW9uIHJlbW92ZV9zbG90X3RvX2Fzc2lzdGFudF9yZXNwb25zZShpbmRleCwgc2xvdCwgZnJvbSkgewogICAgICBpZiAoZnJvbSA9PSAic2xvdG1vZGFsIikgewogICAgICAgIGluZGV4ID0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UuZmluZEluZGV4KGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICByZXR1cm4geC5pZCA9PSBpbmRleDsKICAgICAgICB9KTsKCiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmlkID09IGluZGV4ICYmIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLnJlY29nbml6ZXMgPT0gc2xvdCkgewogICAgICAgICAgICAvLyB0aGlzLnNsb3RzW3RoaXMuZWRpdF9zbG90X2luZGV4XS5yZXNwb25zZXMuc3BsaWNlKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmlkLCAxKTsKICAgICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Uuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMub25fb3Blbl9zbG90c19tb2RhbChzbG90LCB0aGlzLmVkaXRfc2xvdF9pbmRleCwgdGhpcy5lZGl0X3Nsb3RfY2hlY2tfZm9yKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgaWQgPSBpbmRleDsKCiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmlkID09IGlkICYmIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLnJlY29nbml6ZXMgPT0gc2xvdCkgewogICAgICAgICAgICAvLyB0aGlzLnNsb3RzW2luZGV4XS5yZXNwb25zZXMuc3BsaWNlKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmlkLCAxKTsKICAgICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Uuc3BsaWNlKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLCAxKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuYXJyYW5nZV9pZHNfZnVuY3Rpb24oKTsKICAgIH0sCiAgICBhZGRfc2xvdF90b19hc3Npc3RhbnRfcmVzcG9uc2U6IGZ1bmN0aW9uIGFkZF9zbG90X3RvX2Fzc2lzdGFudF9yZXNwb25zZShmcm9tLCBpbmRleCwgY2hlY2tfZm9yLCBzbG90LCByZXNwb25zZSwgY29uZGl0aW9uX3R5cGUpIHsKICAgICAgaWYgKHNsb3QgPT0gIiIgfHwgc2xvdCA9PSBudWxsKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfYWRkX2VudGl0eV9maXJzdF9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoZnJvbSA9PSAidGV4dCIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgIGNvbmRpdGlvbjogInVuZmlsbGVkX3Nsb3QiLAogICAgICAgICAgcmVjb2duaXplczogc2xvdCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB2YWx1ZXM6IFtyZXNwb25zZV0KICAgICAgICB9KTsgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNoZWNrZm9jdXMiKS5kaXNhYmxlZCA9IHRydWU7CgogICAgICAgIHRoaXMuc2xvdHNbaW5kZXhdLnJlc3BvbnNlcyA9IFtdOwogICAgICAgIHRoaXMuc2xvdHNbaW5kZXhdLnJlc3BvbnNlcy5wdXNoKCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGggLSAxKS50b1N0cmluZygpKTsKICAgICAgICB0aGlzLm9uX29wZW5fc2xvdHNfbW9kYWwodGhpcy5lZGl0X3Nsb3Rfc2xvdF92YXJpYWJsZSwgdGhpcy5lZGl0X3Nsb3RfaW5kZXgsIHRoaXMuZWRpdF9zbG90X2NoZWNrX2Zvcik7CiAgICAgIH0KCiAgICAgIGlmIChmcm9tID09ICJBZGRidG4iKSB7CiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAidGV4dCIpIHsKICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgICAgY29uZGl0aW9uOiBjb25kaXRpb25fdHlwZSwKICAgICAgICAgICAgcmVjb2duaXplczogc2xvdCwKICAgICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgICAgdmFsdWVzOiBbIiJdCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiaW1hZ2UiKSB7CiAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgICB0eXBlOiAiaW1hZ2UiLAogICAgICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbl90eXBlLAogICAgICAgICAgICByZWNvZ25pemVzOiBzbG90LAogICAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgICBzb3VyY2U6ICIiCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAidmlkZW8iKSB7CiAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgICB0eXBlOiAidmlkZW8iLAogICAgICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbl90eXBlLAogICAgICAgICAgICByZWNvZ25pemVzOiBzbG90LAogICAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgICBzb3VyY2U6ICIiCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiY2hvaWNlcyIpIHsKICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICAgIHR5cGU6ICJjaG9pY2VzIiwKICAgICAgICAgICAgY29uZGl0aW9uOiBjb25kaXRpb25fdHlwZSwKICAgICAgICAgICAgcmVjb2duaXplczogc2xvdCwKICAgICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogIiIsCiAgICAgICAgICAgIGNob2ljZXM6IFt7CiAgICAgICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgICAgcGF5bG9hZDogIiIKICAgICAgICAgICAgfV0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJjYXJkIikgewogICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgICAgdHlwZTogImNhcmQiLAogICAgICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbl90eXBlLAogICAgICAgICAgICByZWNvZ25pemVzOiBzbG90LAogICAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAiIiwKICAgICAgICAgICAgY2FyZF9saXN0OiBbewogICAgICAgICAgICAgIGltYWdlOiAiIiwKICAgICAgICAgICAgICBpc19pbWFnZTogdHJ1ZSwKICAgICAgICAgICAgICB2aWRlbzogIiIsCiAgICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgICAgIGJ1dHRvbnM6IFt7CiAgICAgICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfV0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zbG90c1t0aGlzLmVkaXRfc2xvdF9pbmRleF0ucmVzcG9uc2VzLnB1c2goKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aCAtIDEpLnRvU3RyaW5nKCkpOwogICAgICAgIHRoaXMub25fb3Blbl9zbG90c19tb2RhbCh0aGlzLmVkaXRfc2xvdF9zbG90X3ZhcmlhYmxlLCB0aGlzLmVkaXRfc2xvdF9pbmRleCwgdGhpcy5lZGl0X3Nsb3RfY2hlY2tfZm9yKTsKICAgICAgfQogICAgfSwKICAgIGFkZF90b19zbG90c19saXN0OiBmdW5jdGlvbiBhZGRfdG9fc2xvdHNfbGlzdChmdW5jLCBpbmRleCwgcmVzcG9uc2VfaWQpIHsKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIpIHsKICAgICAgICB0aGlzLnNsb3RzLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuc2xvdHMubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICBjaGVja19mb3I6ICIiLAogICAgICAgICAgc2xvdDogIiIsCiAgICAgICAgICByZXNwb25zZXM6IFtdCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMuc2xvdHMuc3BsaWNlKGluZGV4LCAxKTsKCiAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZV9pZCkgewogICAgICAgICAgZm9yICh2YXIgaiBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgICAgICBpZiAocmVzcG9uc2VfaWRbaV0gPT0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Vbal0uaWQpIHsKICAgICAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuYXJyYW5nZV9pZHNfZnVuY3Rpb24oKTsKCiAgICAgICAgaWYgKHRoaXMuc2xvdHMgIT0gW10pIHsKICAgICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5zbG90cykgewogICAgICAgICAgICB0aGlzLnNsb3RzW2ldLmlkID0gaS50b1N0cmluZygpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG1hbmFnZV9oYW5kbGVyc19zZWxlY3RfcmVzcG9uc2VfdmFyaWF0aW9uOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfc2VsZWN0X3Jlc3BvbnNlX3ZhcmlhdGlvbihpbmRleCwgdmFyaWF0aW9uLCBpbmQpIHsKICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaW5kZXhdLnZhcmlhdGlvbiA9IHZhcmlhdGlvbjsKICAgIH0sCiAgICBzZWxlY3RfcmVzcG9uc2VfdmFyaWF0aW9uOiBmdW5jdGlvbiBzZWxlY3RfcmVzcG9uc2VfdmFyaWF0aW9uKGluZGV4LCB2YXJpYXRpb24pIHsKICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLnZhcmlhdGlvbiA9IHZhcmlhdGlvbjsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcl9hZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX3RleHRfbGlzdDogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJfYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV90ZXh0X2xpc3QoZnVuYywgaWQsIGluZCwgbnVtKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGlkOwogICAgICB9KTsKCiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaW5kZXhdLnZhbHVlcy5wdXNoKCIiKTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaW5kZXhdLnZhbHVlcy5zcGxpY2UobnVtLCAxKTsKICAgICAgfQogICAgfSwKICAgIGFkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfdGV4dF9saXN0OiBmdW5jdGlvbiBhZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX3RleHRfbGlzdChmdW5jLCBpZCwgbnVtKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGlkOwogICAgICB9KTsKCiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLnZhbHVlcy5wdXNoKCIiKTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLnZhbHVlcy5zcGxpY2UobnVtLCAxKTsKICAgICAgfQoKICAgICAgdGhpcy5maWx0ZXJfYXNpc3RhbmNlX3Jlc3BvbnNlKCk7CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2FkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2hvaWNlX2xpc3Q6IGZ1bmN0aW9uIG1hbmFnZV9oYW5kbGVyc19hZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX2Nob2ljZV9saXN0KGZ1bmMsIGlkLCBpbmQsIG51bSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5maW5kSW5kZXgoZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4geC5pZCA9PSBpZDsKICAgICAgfSk7CgogICAgICBpZiAoZnVuYyA9PSAiYWRkIikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzW2luZGV4XS5jaG9pY2VzLnB1c2goewogICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgIHBheWxvYWQ6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzW2luZGV4XS5jaG9pY2VzLnNwbGljZShudW0sIDEpOwogICAgICB9CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2FkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2Fyb3VzZWxfY2FyZF9idXR0b25fbGlzdDogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2FkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2Fyb3VzZWxfY2FyZF9idXR0b25fbGlzdChmdW5jLCBpZCwgaW5kLCBudW0sIGJ0bl9udW0pIHsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMuZmluZEluZGV4KGZ1bmN0aW9uICh4KSB7CiAgICAgICAgcmV0dXJuIHguaWQgPT0gaWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpbmRleF0uY2FyZF9saXN0W251bV0uYnV0dG9ucy5wdXNoKHsKICAgICAgICAgIHR5cGU6ICJwb3N0YmFjayIsCiAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaW5kZXhdLmNhcmRfbGlzdFtudW1dLmJ1dHRvbnMuc3BsaWNlKGJ0bl9udW0sIDEpOwogICAgICB9CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2FkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2Fyb3VzZWxfY2FyZF9saXN0OiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jYXJvdXNlbF9jYXJkX2xpc3QoZnVuYywgaWQsIGluZCwgbnVtKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGlkOwogICAgICB9KTsKCiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaW5kZXhdLmNhcmRfbGlzdC5wdXNoKHsKICAgICAgICAgIGltYWdlOiAiIiwKICAgICAgICAgIGlzX2ltYWdlOiB0cnVlLAogICAgICAgICAgdmlkZW86ICIiLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICBidXR0b25zOiBbewogICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgfV0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaW5kZXhdLmNhcmRfbGlzdC5zcGxpY2UobnVtLCAxKTsKICAgICAgfQogICAgfSwKICAgIGFkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2hvaWNlX2xpc3Q6IGZ1bmN0aW9uIGFkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2hvaWNlX2xpc3QoZnVuYywgaWQsIG51bSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5maW5kSW5kZXgoZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4geC5pZCA9PSBpZDsKICAgICAgfSk7CgogICAgICBpZiAoZnVuYyA9PSAiYWRkIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2luZGV4XS5jaG9pY2VzLnB1c2goewogICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgIHBheWxvYWQ6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2luZGV4XS5jaG9pY2VzLnNwbGljZShudW0sIDEpOwogICAgICB9CiAgICB9LAogICAgYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jYXJvdXNlbF9jYXJkX2J1dHRvbl9saXN0OiBmdW5jdGlvbiBhZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX2Nhcm91c2VsX2NhcmRfYnV0dG9uX2xpc3QoZnVuYywgaWQsIG51bSwgYnRuX251bSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5maW5kSW5kZXgoZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4geC5pZCA9PSBpZDsKICAgICAgfSk7CgogICAgICBpZiAoZnVuYyA9PSAiYWRkIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2luZGV4XS5jYXJkX2xpc3RbbnVtXS5idXR0b25zLnB1c2goewogICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpbmRleF0uY2FyZF9saXN0W251bV0uYnV0dG9ucy5zcGxpY2UoYnRuX251bSwgMSk7CiAgICAgIH0KICAgIH0sCiAgICBhZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX2Nhcm91c2VsX2NhcmRfbGlzdDogZnVuY3Rpb24gYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jYXJvdXNlbF9jYXJkX2xpc3QoZnVuYywgaWQsIG51bSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5maW5kSW5kZXgoZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4geC5pZCA9PSBpZDsKICAgICAgfSk7CgogICAgICBpZiAoZnVuYyA9PSAiYWRkIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2luZGV4XS5jYXJkX2xpc3QucHVzaCh7CiAgICAgICAgICBpbWFnZTogIiIsCiAgICAgICAgICBpc19pbWFnZTogdHJ1ZSwKICAgICAgICAgIHZpZGVvOiAiIiwKICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgYnV0dG9uczogW3sKICAgICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2luZGV4XS5jYXJkX2xpc3Quc3BsaWNlKG51bSwgMSk7CiAgICAgIH0KICAgIH0sCiAgICBhZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX2xpc3Q6IGZ1bmN0aW9uIGFkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfbGlzdChmdW5jLCBpZCkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5maW5kSW5kZXgoZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4geC5pZCA9PSBpZDsKICAgICAgfSk7CgogICAgICBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gInRleHQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUsCiAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB2YWx1ZXM6IFsiIl0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiaW1hZ2UiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUsCiAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICBzb3VyY2U6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gInZpZGVvIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlLAogICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgc291cmNlOiAiIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJjYXJkIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlLAogICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgY2FyZF9saXN0OiBbewogICAgICAgICAgICBpbWFnZTogIiIsCiAgICAgICAgICAgIGlzX2ltYWdlOiB0cnVlLAogICAgICAgICAgICB2aWRlbzogIiIsCiAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICAgIGJ1dHRvbnM6IFt7CiAgICAgICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgIH1dCiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJjaG9pY2VzIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlLAogICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgZGVzY3JpcHRpb246ICIiLAogICAgICAgICAgY2hvaWNlczogW3sKICAgICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICBwYXlsb2FkOiAiIgogICAgICAgICAgfV0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Uuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB0aGlzLmFycmFuZ2VfaWRzX2Z1bmN0aW9uKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuZmlsdGVyX2FzaXN0YW5jZV9yZXNwb25zZSgpOwogICAgfSwKICAgIGNoZWNrX2ZpcnN0X2NoYXI6IGZ1bmN0aW9uIGNoZWNrX2ZpcnN0X2NoYXIoZSkgewogICAgICB2YXIgdmFsID0gZS50YXJnZXQudmFsdWU7CiAgICAgIHRoaXMuc2hvd19pbnRlbnRfbGlzdCA9IGZhbHNlOwoKICAgICAgaWYgKHZhbC5sZW5ndGggPT0gMSkgewogICAgICAgIGlmICh2YWwgPT0gJy8nKSB7CiAgICAgICAgICB0aGlzLnNob3dfaW50ZW50X2xpc3QgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNob3dfaW50ZW50X2xpc3QgPSBmYWxzZTsKICAgICAgfQogICAgfQogIH0KfTs="},null]}