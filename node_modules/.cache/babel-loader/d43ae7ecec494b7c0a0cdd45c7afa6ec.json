{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Layout/TopNavbar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Layout/TopNavbar.vue","mtime":1643027096176},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiOwppbXBvcnQgX3R5cGVvZiBmcm9tICIvaG9tZS92aW1hbGVzaC9DRU5TRS9jaGF0Ym90LXBvcnRhbC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL2hvbWUvdmltYWxlc2gvQ0VOU0UvY2hhdGJvdC1wb3J0YWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOwppbXBvcnQgeyBidXMgfSBmcm9tICJAL3BvcnRhbC9tYWluIjsKaW1wb3J0IENvdW50cmllcyBmcm9tICJAL3BvcnRhbC9jb21wb25lbnRzL0NvdW50cmllcyI7CmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IGZpbmdlcnByaW50IGZyb20gIkAvcG9ydGFsL2NvbXBvbmVudHMvZmluZ2VycHJpbnQiOwppbXBvcnQgeyBzZXRUaW1lb3V0IH0gZnJvbSAidGltZXJzIjsKaW1wb3J0IE11bHRpc2VsZWN0IGZyb20gInZ1ZS1tdWx0aXNlbGVjdCI7CmltcG9ydCB7IHN0cmluZ1R5cGVBbm5vdGF0aW9uIH0gZnJvbSAiQGJhYmVsL3R5cGVzIjsKaW1wb3J0IHsgc3RyaW5naWZ5IH0gZnJvbSAicXVlcnlzdHJpbmciOwppbXBvcnQgeyBTb2NrZXQgfSBmcm9tICJwaG9lbml4LXNvY2tldCI7CmltcG9ydCBTd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwppbXBvcnQgVnVlUGhvbmVOdW1iZXJJbnB1dCBmcm9tICd2dWUtcGhvbmUtbnVtYmVyLWlucHV0JzsKaW1wb3J0ICd2dWUtcGhvbmUtbnVtYmVyLWlucHV0L2Rpc3QvdnVlLXBob25lLW51bWJlci1pbnB1dC5jc3MnOwppbXBvcnQgUGFzc3dvcmRWYWxpZGF0b3IgZnJvbSAiLi4vUGFnZXMvUGFzc3dvcmRWYWxpZGF0b3IudnVlIjsKaW1wb3J0IHBhZ2VfZ3VpZGUgZnJvbSAiQC9wb3J0YWwvbWl4aW5zL3BhZ2VfZ3VpZGUuanMiOwppbXBvcnQgcGF0aCBmcm9tICJwYXRoIjsKZXhwb3J0IGRlZmF1bHQgewogIG1peGluczogW3BhZ2VfZ3VpZGVdLAogIHByb3BzOiBbInRpdGxlIl0sCiAgY29tcG9uZW50czogewogICAgTXVsdGlzZWxlY3Q6IE11bHRpc2VsZWN0LAogICAgVnVlUGhvbmVOdW1iZXJJbnB1dDogVnVlUGhvbmVOdW1iZXJJbnB1dCwKICAgIFBhc3N3b3JkVmFsaWRhdG9yOiBQYXNzd29yZFZhbGlkYXRvcgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGludGVudF9kYXRhOiBudWxsLAogICAgICBjYWxsZGF0YTogIiIsCiAgICAgIG5ld19wYXNzd29yZDogIiIsCiAgICAgIG9sZF9wYXNzd29yZDogIiIsCiAgICAgIGNvbmZpcm1fcGFzc3dvcmQ6ICIiLAogICAgICBjb3JyZWN0X3Bhc3N3b3JkOiBmYWxzZSwKICAgICAgY29tcGFueV9uYW1lOiBudWxsLAogICAgICBjb21wYW55X2lkX3NlbGVjdGVkOiBudWxsLAogICAgICBjb21wYW5pZXM6IFtdLAogICAgICBjb3VudHJ5X2xpc3Q6IG51bGwsCiAgICAgIGNvbXBhbnlfaWQ6IFtdLAogICAgICB1c2VyX2NvbXBhbnk6IG51bGwsCiAgICAgIHRpY2tldHNfYmFyX2FjY2VzczogZmFsc2UsCiAgICAgIGludml0ZV9jb21wYW55X2VtYWlsOiBudWxsLAogICAgICBpbnZpdGVfY29tcGFueV9uYW1lOiBudWxsLAogICAgICBvbGRfZmlsZV9uYW1lOiBudWxsLAogICAgICBmaWxlX2xhYmVsOiAiQ2hvb3NlIGZpbGUiLAogICAgICBpc3N1ZTogIiIsCiAgICAgIGlzc3VlX2Rlc2NyaXB0aW9uOiAiIiwKICAgICAgaW1nX2ZpbGU6ICIiLAogICAgICBzcGlubmVyT246IGZhbHNlLAogICAgICBwaG90b19pbWdfdXJsOiAiIiwKICAgICAgZXhpc3RpbmdfZmlsZV9uYW1lOiBudWxsLAogICAgICB1c2VyX2NvdW50cnlfbmFtZTogewogICAgICAgIGNvZGU6ICIiLAogICAgICAgIG5hbWU6ICIiCiAgICAgIH0sCiAgICAgIHVzZXJfcGhvbmVfbnVtYmVyOiB0aGlzLiRzZXNzaW9uLmhhcygiUGhvbmVOdW1iZXIiKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJQaG9uZU51bWJlciIpIDogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnBob25lX25vIDogIiIsCiAgICAgIHVzZXJfZmlyc3RfbmFtZTogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJGaXJzdE5hbWUiKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VyRmlyc3ROYW1lIikgOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZmlyc3RfbmFtZSA6ICIiLAogICAgICB1c2VyX2xhc3RfbmFtZTogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJMYXN0TmFtZSIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJMYXN0TmFtZSIpIDogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxhc3RfbmFtZSA6ICIiLAogICAgICBjb21wYW55X3NlbGVjdGVkOiB0aGlzLiRzZXNzaW9uLmhhcygiQ29tcGFueU5hbWUiKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55TmFtZSIpIDogIlNlbGVjdCBBIENvbXBhbnkiLAogICAgICB1c2VyX2NvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSA6ICIiLAogICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsIDogIiIsCiAgICAgIHVzZXJfY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQgOiAiIiwKICAgICAgdXNlcl9yb2xlOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucm9sZSA6ICIiLAogICAgICB1c2VyX3R5cGU6IHRoaXMuJHNlc3Npb24uaGFzKCJVc2VySW5mb3JtYXRpb24iKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yZWdpc3RyYXRpb25fdHlwZSA6ICIiLAogICAgICBwaG9uZV9udW1iZXJfdmFsaWRpdHk6IC9cK1swLTldezksMTR9JC8sCiAgICAgIHJlZ19wd2Q6IC9eKD89LipbYS16XSkoPz0uKltBLVpdKSg/PS4qXGQpKD89LipbI0AkISUqPyZdKVtBLVphLXpcZCNAJCElKj8mXXs4LH0vLAogICAgICByZWdfZW1haWw6IC9eKFswLTlhLXpBLVpdKFstLlx3XSpbMC05YS16QS1aXSkqQChbMC05YS16QS1aXVstXHddKlswLTlhLXpBLVpdXC4pK1thLXpBLVpdezIsOX0pJC8sCiAgICAgIG5vdGlmaWNhdGlvbnM6IFtdLAogICAgICB0b19zaG93X25vdGlmaWNhdGlvbnM6IGZhbHNlLAogICAgICBzb2NrZXQ6IG51bGwsCiAgICAgIHNjaGVkdWxlcl9jaGFubmVsOiBudWxsLAogICAgICB0cmFpbmluZ19jaGFubmVsOiBudWxsLAogICAgICBwaG9uZU51bWJlcjogbnVsbCwKICAgICAgdG91cl9ndWlkZV9pY29uOiByZXF1aXJlKCJAL3BvcnRhbC9hc3NldHMvaW1nL2luZm9faWNvbi5zdmciKQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICB2YWxpZE9sZFBhc3N3b3JkOiBmdW5jdGlvbiB2YWxpZE9sZFBhc3N3b3JkKCkgewogICAgICBpZiAodGhpcy5yZWdfcHdkLnRlc3QodGhpcy5vbGRfcGFzc3dvcmQpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICJQYXNzd29yZCBtdXN0IGNvbnRhaW4gbWluaW11bSA4IGNoYXJhY3RlcnMsIGF0bGVhc3QgMSBVcHBlckNhc2UgQWxwaGFiZXQsIDEgTG93ZXJDYXNlIEFscGhhYmV0LCAxIE51bWJlciBhbmQgMSBTcGVjaWFsIENoYXJhY3RlciI7CiAgICAgIH0KICAgIH0sCiAgICB2YWxpZFBhc3N3b3JkOiBmdW5jdGlvbiB2YWxpZFBhc3N3b3JkKCkgewogICAgICBpZiAodGhpcy5yZWdfcHdkLnRlc3QodGhpcy5uZXdfcGFzc3dvcmQpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICJQYXNzd29yZCBtdXN0IGNvbnRhaW4gbWluaW11bSA4IGNoYXJhY3RlcnMsIGF0bGVhc3QgMSBVcHBlckNhc2UgQWxwaGFiZXQsIDEgTG93ZXJDYXNlIEFscGhhYmV0LCAxIE51bWJlciBhbmQgMSBTcGVjaWFsIENoYXJhY3RlciI7CiAgICAgIH0KICAgIH0sCiAgICB2YWxpZENvbmZpcm1QYXNzd29yZDogZnVuY3Rpb24gdmFsaWRDb25maXJtUGFzc3dvcmQoKSB7CiAgICAgIGlmICh0aGlzLmNvbmZpcm1fcGFzc3dvcmQgPT0gdGhpcy5uZXdfcGFzc3dvcmQpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIlBhc3N3b3JkcyBkbyBub3QgbWF0Y2giOwogICAgICB9CiAgICB9LAogICAgLy8gdmFsaWRQaG9uZU51bWJlcigpIHsKICAgIC8vICAgaWYgKAogICAgLy8gICAgIHRoaXMucGhvbmVfbnVtYmVyX3ZhbGlkaXR5LnRlc3QoCiAgICAvLyAgICAgICB0aGlzLnVzZXJfcGhvbmVfbnVtYmVyLnJlcGxhY2UoL1xzKy9nLCAiIikKICAgIC8vICAgICApCiAgICAvLyAgICkgewogICAgLy8gICAgIHJldHVybiB0cnVlOwogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIHJldHVybiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgcGhvbmUgbnVtYmVyIGluIHRoZSBmb3JtYXQ6ICtDb3VudHJ5Q29kZSBOdW1iZXIiOwogICAgLy8gICB9CiAgICAvLyB9LAogICAgdW5zZWVuX25vdGlmaWNhdGlvbnM6IGZ1bmN0aW9uIHVuc2Vlbl9ub3RpZmljYXRpb25zKCkgewogICAgICB2YXIgY291bnQgPSAwOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vdGlmaWNhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoIXRoaXMubm90aWZpY2F0aW9uc1tpXS5pc19jbGVhcikgewogICAgICAgICAgY291bnQrKzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBjb3VudDsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHRoaXMuY291bnRyeV9saXN0ID0gQ291bnRyaWVzOwoKICAgIGlmICh0aGlzLiRzZXNzaW9uLmhhcygicGhvdG9faW1nX3VybCIpKSB7CiAgICAgIHRoaXMucGhvdG9faW1nX3VybCA9IHRoaXMuJHNlc3Npb24uaGFzKCJVc2VySW5mb3JtYXRpb24iKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJwaG90b19pbWdfdXJsIikgOiAiIjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucGhvdG9faW1nX3VybCA9IHRoaXMuJHNlc3Npb24uaGFzKCJVc2VySW5mb3JtYXRpb24iKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5waG90b19pbWdfdXJsIDogIiI7CiAgICB9CgogICAgaWYgKHRoaXMuJHNlc3Npb24uaGFzKCJjb3VudHJ5X25hbWUiKSAmJiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikpIHsKICAgICAgdGhpcy51c2VyX2NvdW50cnlfbmFtZS5jb2RlID0gdGhpcy4kc2Vzc2lvbi5nZXQoImNvdW50cnlfbmFtZSIpOwogICAgICB2YXIgc2VsZWN0X2NvdW50cnkgPSB0aGlzLmNvdW50cnlfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKGNvdW50cnkpIHsKICAgICAgICByZXR1cm4gY291bnRyeS5jb2RlID09IF90aGlzLnVzZXJfY291bnRyeV9uYW1lLmNvZGU7CiAgICAgIH0pOwogICAgICB0aGlzLnVzZXJfY291bnRyeV9uYW1lLm5hbWUgPSBzZWxlY3RfY291bnRyeVswXS5uYW1lOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy51c2VyX2NvdW50cnlfbmFtZS5jb2RlID0gdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvdW50cnlfbmFtZSA6ICIiOwoKICAgICAgaWYgKHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb3VudHJ5X25hbWUgPT0gbnVsbCkgewogICAgICAgIHRoaXMudXNlcl9jb3VudHJ5X25hbWUuY29kZSA9ICIiOwogICAgICB9CgogICAgICBpZiAodGhpcy51c2VyX2NvdW50cnlfbmFtZS5jb2RlLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgX3NlbGVjdF9jb3VudHJ5ID0gdGhpcy5jb3VudHJ5X2xpc3QuZmlsdGVyKGZ1bmN0aW9uIChjb3VudHJ5KSB7CiAgICAgICAgICByZXR1cm4gY291bnRyeS5jb2RlID09IF90aGlzLnVzZXJfY291bnRyeV9uYW1lLmNvZGU7CiAgICAgICAgfSk7CgogICAgICAgIHRoaXMudXNlcl9jb3VudHJ5X25hbWUubmFtZSA9IF9zZWxlY3RfY291bnRyeVswXS5uYW1lOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMudXNlcl9yb2xlID09ICJBZG1pbiIpIHsKICAgICAgdGhpcy5jb21wYW55X3NlbGVjdGVkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSA6ICIiOwogICAgfQoKICAgIGlmICh0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucm9sZSA9PSAiU3VwZXJBZG1pbiIpIHsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuY29tcGFueV9saXN0X3VybCgpLCB7CiAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzLmNvbXBhbmllcyA9IHJlc3BvbnNlLmRhdGFbMF07CiAgICAgICAgX3RoaXMuY29tcGFueV9pZCA9IHJlc3BvbnNlLmRhdGFbMV07CiAgICAgIH0pOwogICAgfQoKICAgIGlmICh0aGlzLnVzZXJfZmlyc3RfbmFtZSA9PSBudWxsIHx8IHRoaXMudXNlcl9maXJzdF9uYW1lID09ICIiKSB7CiAgICAgIHRoaXMudXNlcl9maXJzdF9uYW1lID0gIkZpcnN0IjsKICAgICAgdGhpcy51c2VyX2xhc3RfbmFtZSA9ICJMYXN0IjsKICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIlVzZXJGaXJzdE5hbWUiLCB0aGlzLnVzZXJfZmlyc3RfbmFtZSk7CiAgICAgIHRoaXMuJHNlc3Npb24uc2V0KCJVc2VyTGFzdE5hbWUiLCB0aGlzLnVzZXJfbGFzdF9uYW1lKTsKICAgIH0KCiAgICB2YXIgbWVudXMgPSB0aGlzLiRzZXNzaW9uLmhhcygiQ2hhdGJvdE1lbnUiKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJDaGF0Ym90TWVudSIpIDogW107CiAgICB2YXIgdGlja2V0X2FjY2VzcyA9IG1lbnVzLmZpbHRlcihmdW5jdGlvbiAobWVudSkgewogICAgICByZXR1cm4gbWVudS5tYWluX21lbnUubmFtZSA9PSAiVGlja2V0cyI7CiAgICB9KTsKCiAgICBpZiAodGlja2V0X2FjY2Vzcy5sZW5ndGggPT0gMCkgewogICAgICB0aGlzLnRpY2tldHNfYmFyX2FjY2VzcyA9IGZhbHNlOwogICAgfSBlbHNlIGlmICh0aWNrZXRfYWNjZXNzLmxlbmd0aCA9PSAxKSB7CiAgICAgIHRoaXMudGlja2V0c19iYXJfYWNjZXNzID0gdHJ1ZTsKICAgIH0KCiAgICB2YXIgbm90aWZpY2F0aW9uc19hY2Nlc3MgPSBmYWxzZTsKCiAgICBmb3IgKHZhciBpID0gMCwgbiA9IG1lbnVzLmxlbmd0aDsgaSA8IG47IGkgKz0gMSkgewogICAgICBmb3IgKHZhciBqID0gMCwgbCA9IG1lbnVzW2ldLnN1Yl9tZW51X2xpc3QubGVuZ3RoOyBqIDwgbDsgaiArPSAxKSB7CiAgICAgICAgaWYgKG1lbnVzW2ldLnN1Yl9tZW51X2xpc3Rbal0ubmFtZSA9PSAiU2NoZWR1bGVyIikgewogICAgICAgICAgbm90aWZpY2F0aW9uc19hY2Nlc3MgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdGhpcy5zb2NrZXQgPSBuZXcgU29ja2V0KHByb2Nlc3MuZW52LlZVRV9BUFBfUFVTSF9OT1RJRklDQVRJT05TX1dFQlNPQ0tFVF9FTkRQT0lOVCwgewogICAgICBwYXJhbXM6IHsKICAgICAgICBub3RpZmljYXRpb25fdGVzdDogdHJ1ZQogICAgICB9CiAgICB9KTsKICAgIHRoaXMuc29ja2V0LmNvbm5lY3QoKTsKCiAgICBpZiAoQm9vbGVhbihub3RpZmljYXRpb25zX2FjY2VzcykpIHsKICAgICAgdGhpcy50b19zaG93X25vdGlmaWNhdGlvbnMgPSB0cnVlOyAvL05vdGlmaWNhdGlvbgoKICAgICAgdGhpcy5zY2hlZHVsZXJfY2hhbm5lbCA9IHRoaXMuc29ja2V0LmNoYW5uZWwoIm5vdGlmaWNhdGlvbl9jaGFubmVsOiIgKyB0aGlzLnVzZXJfY29tcGFueV9pZCk7CiAgICAgIHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwuam9pbigpOwogICAgICB0aGlzLnNjaGVkdWxlcl9jaGFubmVsLm9uKCJzaG93X25vdGlmaWNhdGlvbnMiLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UuaXNfcmVzcG9uc2UpIHsKICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX24gPSByZXNwb25zZS5kYXRhLmxlbmd0aDsgX2kgPCBfbjsgX2krKykgewogICAgICAgICAgICBfdGhpcy5ub3RpZmljYXRpb25zLnB1c2gocmVzcG9uc2UuZGF0YVtfaV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgX3RoaXMuc2NoZWR1bGVyX2NoYW5uZWwub2ZmKCJzaG93X25vdGlmaWNhdGlvbnMiKTsKICAgICAgfSk7CiAgICAgIHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwub24oIm5ld19ub3RpZmljYXRpb24iLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpcy5zaG93X25vdGlmaWNhdGlvbnMocmVzcG9uc2UuZGF0YSk7CgogICAgICAgIF90aGlzLm5vdGlmaWNhdGlvbnMudW5zaGlmdChyZXNwb25zZS5kYXRhKTsKICAgICAgfSk7CiAgICAgIHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwucHVzaCgic2hvd19ub3RpZmljYXRpb25zIiwgewogICAgICAgIG5lZWRfbm90aWZpY2F0aW9uczogdHJ1ZSwKICAgICAgICBlbWFpbF9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsCiAgICAgIH0pOwogICAgfQoKICAgIHRoaXMudHJhaW5pbmdfY2hhbm5lbCA9IHRoaXMuc29ja2V0LmNoYW5uZWwoInRyYWluaW5nX25vdGlmaWNhdGlvbl9jaGFubmVsOiIgKyB0aGlzLnVzZXJfY29tcGFueV9pZCk7CiAgICB0aGlzLnRyYWluaW5nX2NoYW5uZWwuam9pbigpOwogICAgdGhpcy50cmFpbmluZ19jaGFubmVsLm9uKCJzaG93X25vdGlmaWNhdGlvbnMiLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgaWYgKHJlc3BvbnNlLmlzX3Jlc3BvbnNlICYmIHJlc3BvbnNlLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIF9pMiA9IDAsIF9uMiA9IHJlc3BvbnNlLmRhdGEubGVuZ3RoOyBfaTIgPCBfbjI7IF9pMisrKSB7CiAgICAgICAgICBfdGhpcy5ub3RpZmljYXRpb25zLnB1c2goX29iamVjdFNwcmVhZCh7CiAgICAgICAgICAgIGRhdGU6IG1vbWVudChyZXNwb25zZS5kYXRhW19pMl0uSW5pdGlhdGVkT24sIFsiWVlZWS1NTS1ERCJdKS5mb3JtYXQoIkRvIE1NTSBZWVlZIikKICAgICAgICAgIH0sIHJlc3BvbnNlLmRhdGFbX2kyXSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgX3RoaXMudHJhaW5pbmdfY2hhbm5lbC5vZmYoInNob3dfbm90aWZpY2F0aW9ucyIpOwogICAgfSk7CiAgICB0aGlzLnRyYWluaW5nX2NoYW5uZWwub24oIm5ld19ub3RpZmljYXRpb24iLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgX3RoaXMuc2hvd19ub3RpZmljYXRpb25zKHJlc3BvbnNlLmRhdGEpOwoKICAgICAgX3RoaXMubm90aWZpY2F0aW9ucy51bnNoaWZ0KF9vYmplY3RTcHJlYWQoewogICAgICAgIGRhdGU6IG1vbWVudChyZXNwb25zZS5kYXRhLkluaXRpYXRlZE9uLCBbIllZWVktTU0tREQiXSkuZm9ybWF0KCJEbyBNTU0gWVlZWSIpCiAgICAgIH0sIHJlc3BvbnNlLmRhdGEpKTsKICAgIH0pOwogICAgdGhpcy50cmFpbmluZ19jaGFubmVsLnB1c2goInNob3dfbm90aWZpY2F0aW9ucyIsIHsKICAgICAgbmVlZF9ub3RpZmljYXRpb25zOiB0cnVlLAogICAgICBlbWFpbF9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsCiAgICB9KTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICBidXMuJG9uKCJMYXlvdXRIZWxwRGF0YSIsIGZ1bmN0aW9uIChkYXRhUGcpIHsKICAgICAgX3RoaXMyLmNhbGxkYXRhID0gZGF0YVBnOwogICAgfSk7IC8vIGJ1cy4kb24oJ1RhYnNMYXlvdXRJbmZvJywoZGF0YUZvcnRhYnMpID0+IHsKICAgIC8vICAgICAgICAgY29uc29sZS5sb2coZGF0YUZvcnRhYnMsImRhdGEgb2YgdGFiIHBhbmUiKTsKICAgIC8vICAgICAgICAgdGhpcy5jYWxsZGF0YSA9IGRhdGFGb3J0YWJzOwogICAgLy8gfSkKCiAgICBidXMuJG9uKCJzZW5kIGNvbXBhbnkgYXR0cmlidXRlcyIsIGZ1bmN0aW9uICgpIHsKICAgICAgYnVzLiRlbWl0KCJjb21wYW55IG5hbWUgYW5kIGNvbXBhbnkgaWQiLCBfdGhpczIuY29tcGFueV9uYW1lLCBfdGhpczIuY29tcGFueV9pZF9zZWxlY3RlZCk7CiAgICB9KTsKICAgIHRoaXMuJHJvb3QuJG9uKCJzaWduX291dCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMyLnNpZ25vdXRfYXBpKCk7CiAgICB9KTsKICAgICQoIi5kcm9wZG93bi10b2dnbGUiKS5kcm9wZG93bigpOwogIH0sCiAgbWV0aG9kczogewogICAgbGlzdGVuX2RhdGE6IGZ1bmN0aW9uIGxpc3Rlbl9kYXRhKCkgewogICAgICB0aGlzLmNhbGxkYXRhID0gdGhpcy4kcm91dGUucGF0aDsgLy90aGlzLmNvbXBfbmFtZSA9IHRoaXMuJHJvdXRlLm5hbWU7CiAgICAgIC8vIEVtaXR0aW5nIGEgY3VzdG9tLWV2ZW50IHZpYSB0aGUgRXZlbnQgQnVzCgogICAgICBidXMuJGVtaXQoIkVtaXR0aW5nX2RhdGEiLCB0aGlzLmNhbGxkYXRhKTsKICAgIH0sCiAgICBjaGVja19wYXNzd29yZDogZnVuY3Rpb24gY2hlY2tfcGFzc3dvcmQoY29ycmVjdFBhc3N3b3JkKSB7CiAgICAgIHRoaXMuY29ycmVjdF9wYXNzd29yZCA9IGNvcnJlY3RQYXNzd29yZDsKICAgIH0sCiAgICBlZGl0SW1hZ2U6IGZ1bmN0aW9uIGVkaXRJbWFnZShlKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIGltYWdlID0gZS50YXJnZXQuZmlsZXNbMF07CiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChpbWFnZSk7CgogICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczMucHJldmlld0ltYWdlID0gZS50YXJnZXQucmVzdWx0OwoKICAgICAgICBpZiAoX3RoaXMzLnBob3RvX2ltZ191cmwpIHsKICAgICAgICAgIF90aGlzMy5leGlzdGluZ19maWxlX25hbWUgPSBfdGhpczMucGhvdG9faW1nX3VybC5zcGxpdCgiLyIpWzRdOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZWRpdF9wcm9maWxlX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55bmFtZTogX3RoaXMzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgY29tcGFueWlkOiBfdGhpczMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgbGljZW5zZV9rZXk6IF90aGlzMy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgZW1haWw6IF90aGlzMy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgdG9rZW46IF90aGlzMy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHVwbG9hZF9waG90bzogIlRydWUiLAogICAgICAgICAgcHJvZmlsZV9pbWFnZTogX3RoaXMzLnByZXZpZXdJbWFnZS5zcGxpdCgiYmFzZTY0LCIpWzFdLAogICAgICAgICAgZmlsZV9uYW1lOiBpbWFnZS5uYW1lLAogICAgICAgICAgZXhpc3RpbmdfZmlsZV9uYW1lOiBfdGhpczMuZXhpc3RpbmdfZmlsZV9uYW1lCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KF90aGlzMy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzMy5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5Nc2cgPT0gIlBob3RvIFVwbG9hZGVkIFN1Y2Nlc3NmdWxseSIpIHsKICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIllvdXIgcGhvdG8gaGFzIGJlZW4gdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5Iik7CgogICAgICAgICAgICBfdGhpczMuJHNlc3Npb24uc2V0KCJwaG90b19pbWdfdXJsIiwgcmVzcG9uc2UuZGF0YS5JbWFnZVVybCk7CgogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBfdGhpczMuJHJvdXRlci5nbygpOwogICAgICAgICAgICB9LCA1MDAwKTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEgPT0gIkR1cGxpY2F0ZSBpbWFnZSIpIHsKICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoIlRoaXMgZmlsZSBuYW1lIGFscmVhZHkgZXhpc3RzLlBsZWFzZSByZW5hbWUgdGhlIGZpbGUiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiRXJyb3Igb2NjdXJlZCB3aGlsZSB1cGxvYWRpbmcgZmlsZSIpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9OwogICAgfSwKICAgIGNyZWF0ZUltYWdlOiBmdW5jdGlvbiBjcmVhdGVJbWFnZShmaWxlLCB0eXBlKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczQuYmxvZy5pbWdfZmlsZSA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdCgiYmFzZTY0LCIpWzFdOwogICAgICB9OwoKICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICB9LAogICAgcmFpc2VfdGlja2V0OiBmdW5jdGlvbiByYWlzZV90aWNrZXQoKSB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAodGhpcy4kcm91dGUubmFtZSA9PSAiVGlja2V0cyIpIHsKICAgICAgICAkKCIjdGlja2V0bW9kYWwiKS5tb2RhbCgic2hvdyIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIG5hbWU6ICJUaWNrZXRzIiwKICAgICAgICAgIHByb3BzOiB0cnVlLAogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIHJhaXNlX3RpY2tldDogIlRydWUiCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjbGVhcl9maWVsZHM6IGZ1bmN0aW9uIGNsZWFyX2ZpZWxkcygpIHsKICAgICAgdGhpcy5pbWdfZmlsZSA9ICIiOwogICAgICB0aGlzLmZpbGVfbGFiZWwgPSAiQ2hvb3NlIGZpbGUiOwogICAgICB0aGlzLmlzc3VlID0gIiI7CiAgICAgIHRoaXMuaXNzdWVfZGVzY3JpcHRpb24gPSAiIjsKICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgIH0sCiAgICBlbWFpbF9jbGFzczogZnVuY3Rpb24gZW1haWxfY2xhc3MoKSB7CiAgICAgIGlmICh0aGlzLnJlZ19lbWFpbC50ZXN0KHRoaXMuaW52aXRlX2NvbXBhbnlfZW1haWwpKSB7CiAgICAgICAgcmV0dXJuICJpcy12YWxpZCI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICJpcy1pbnZhbGlkIjsKICAgICAgfQogICAgfSwKICAgIGVkaXRfcHJvZmlsZV9hcGk6IGZ1bmN0aW9uIGVkaXRfcHJvZmlsZV9hcGkoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKCiAgICAgIGlmICghQm9vbGVhbih0aGlzLnBob25lTnVtYmVyKSkgewogICAgICAgIHRvYXN0ci53YXJuaW5nKCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBQaG9uZSBOdW1iZXIiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5waG9uZU51bWJlci5pc1ZhbGlkICE9IHRydWUpIHsKICAgICAgICB0b2FzdHIud2FybmluZygiUGxlYXNlIGVudGVyIGEgdmFsaWQgUGhvbmUgTnVtYmVyIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy51c2VyX2NvdW50cnlfbmFtZS5jb2RlICE9IG51bGwgJiYgdGhpcy51c2VyX2ZpcnN0X25hbWUgIT0gIiIgJiYgdGhpcy51c2VyX2ZpcnN0X25hbWUgIT0gIkYiICYmIHRoaXMudXNlcl9sYXN0X25hbWUgIT0gIiIgJiYgdGhpcy51c2VyX2xhc3RfbmFtZSAhPSAiTCIgLy90aGlzLnZhbGlkUGhvbmVOdW1iZXIgPT09IHRydWUKICAgICAgKSB7CiAgICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5lZGl0X3Byb2ZpbGVfdXJsKCksIHsKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIGZpcnN0X25hbWU6IHRoaXMudXNlcl9maXJzdF9uYW1lLAogICAgICAgICAgICBsYXN0X25hbWU6IHRoaXMudXNlcl9sYXN0X25hbWUsCiAgICAgICAgICAgIGNvdW50cnlfbmFtZTogdGhpcy51c2VyX2NvdW50cnlfbmFtZS5jb2RlLAogICAgICAgICAgICBwaG9uZV9udW1iZXI6IHRoaXMucGhvbmVOdW1iZXIuZm9ybWF0dGVkTnVtYmVyCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczUuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PSAiUHJvZmlsZSBVcGRhdGVkIikgewogICAgICAgICAgICAgIC8vIFN3YWwoewogICAgICAgICAgICAgIC8vICAgICB0aXRsZTogIlVwZGF0ZWQgU3VjY2Vzc2Z1bGx5ISEiLAogICAgICAgICAgICAgIC8vICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgLy8gICAgIHRleHQ6ICJZb3VyIHByb2ZpbGUgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkuIiwKICAgICAgICAgICAgICAvLyAgICAgdGltZXI6MjAwMCwKICAgICAgICAgICAgICAvLyAgIH0pOwogICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCJZb3VyIHByb2ZpbGUgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkuIik7CgogICAgICAgICAgICAgIF90aGlzNS4kc2Vzc2lvbi5zZXQoIlVzZXJGaXJzdE5hbWUiLCBfdGhpczUudXNlcl9maXJzdF9uYW1lKTsKCiAgICAgICAgICAgICAgX3RoaXM1LiRzZXNzaW9uLnNldCgiVXNlckxhc3ROYW1lIiwgX3RoaXM1LnVzZXJfbGFzdF9uYW1lKTsKCiAgICAgICAgICAgICAgX3RoaXM1LiRzZXNzaW9uLnNldCgiY291bnRyeV9uYW1lIiwgX3RoaXM1LnVzZXJfY291bnRyeV9uYW1lLmNvZGUpOwoKICAgICAgICAgICAgICBfdGhpczUuJHNlc3Npb24uc2V0KCJQaG9uZU51bWJlciIsIF90aGlzNS5waG9uZU51bWJlci5mb3JtYXR0ZWROdW1iZXIpOwoKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzNS4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgfSwgMjUwMCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICQoIiNlZGl0X3Byb2ZpbGVfbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICB0b2FzdHIuZXJyb3IoIlBsZWFzZSBlbnRlciBhbGwgdGhlIHJlcXVpcmVkIGZpZWxkcyIpOwogICAgICB9CiAgICB9LAogICAgY29tcGFueV9jaGFuZ2VkOiBmdW5jdGlvbiBjb21wYW55X2NoYW5nZWQoY29tcGFueSkgewogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgaWYgKGNvbXBhbnkgIT0gdGhpcy5jb21wYW55X3NlbGVjdGVkKSB7CiAgICAgICAgdGhpcy5jb21wYW55X3NlbGVjdGVkID0gY29tcGFueTsKCiAgICAgICAgaWYgKHRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55TmFtZSIpKSB7CiAgICAgICAgICB0aGlzLiRzZXNzaW9uLnJlbW92ZSgiQ29tcGFueU5hbWUiKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHNlc3Npb24uc2V0KCJDb21wYW55TmFtZSIsIHRoaXMuY29tcGFueV9zZWxlY3RlZCk7CgogICAgICAgIGlmICh0aGlzLiRzZXNzaW9uLmhhcygiQ29tcGFueUlkIikpIHsKICAgICAgICAgIHRoaXMuJHNlc3Npb24ucmVtb3ZlKCJDb21wYW55SWQiKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuJHNlc3Npb24uc2V0KCJDb21wYW55SWQiLCB0aGlzLmNvbXBhbnlfaWRbdGhpcy5jb21wYW5pZXMuaW5kZXhPZih0aGlzLmNvbXBhbnlfc2VsZWN0ZWQpXSk7CiAgICAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgIH0gZWxzZSB7fQogICAgfSwKICAgIHN1Ym1pdF9uZXdfcGFzc3dvcmQ6IGZ1bmN0aW9uIHN1Ym1pdF9uZXdfcGFzc3dvcmQoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKCiAgICAgIGlmICh0aGlzLm9sZF9wYXNzd29yZCAhPSAiIiAmJiB0aGlzLmNvcnJlY3RfcGFzc3dvcmQgPT0gdHJ1ZSAmJiB0aGlzLnZhbGlkQ29uZmlybVBhc3N3b3JkID09IHRydWUpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgdGV4dDogIlBsZWFzZSB3YWl0IHdoaWxlIHdlIHN1Ym1pdCB5b3VyIGRldGFpbHMiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdHlwZTogImluZm8iCiAgICAgICAgfSk7CiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLm5ld19wYXNzd29yZF91cmwoKSwgewogICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBvbGRfcGFzc3dvcmQ6IHRoaXMub2xkX3Bhc3N3b3JkLAogICAgICAgICAgbmV3X3Bhc3N3b3JkOiB0aGlzLm5ld19wYXNzd29yZCwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBkYXRlOiBkYXRlCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PSAiUGFzc3dvcmQgSW5jb3JyZWN0IikgewogICAgICAgICAgICB0b2FzdHIuZXJyb3IoIllvdXIgb2xkIHBhc3N3b3JkIGlzIGluY29ycmVjdCIpOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhID09ICJQYXNzd29yZCBSZXNldCIpIHsKICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIllvdXIgcGFzc3dvcmQgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkuIE5vdyB5b3UgY2FuIGxvZ2luIHdpdGggdGhlIG5ldyBwYXNzd29yZCIpOwogICAgICAgICAgICAkKCIjY2hhbmdlX3Bhc3N3b3JkX21vZGFsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgX3RoaXM2LiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgfSwgMjAwKTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT09ICJQYXNzd29yZCBJcyBTaW1pbGFyIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiAiWW91IGNhbm5vdCBzZXQgYSBwYXNzd29yZCB3aGljaCB3YXMgb25lIG9mIHlvdXIgb2xkIHBhc3N3b3Jkcy4gUGxlYXNlIFRyeSBBZ2FpbiIsCiAgICAgICAgICAgICAgdGltZXI6IDMwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09PSAiT0xEIFBBU1NXT1JEIERPRVNOJ1QgTUFUQ0giKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJZb3VyIG9sZCBwYXNzd29yZCBkb2VzIG5vdCBtYXRjaGVkLiBQbGVhc2UgVHJ5IEFnYWluIiwKICAgICAgICAgICAgICB0aW1lcjogMzAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJTb21lIEVycm9yIE9jY3VycmVkLiBQbGVhc2UgVHJ5IEFnYWluIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczYub2xkX3Bhc3N3b3JkID0gIiI7CiAgICAgICAgICBfdGhpczYubmV3X3Bhc3N3b3JkID0gIiI7CiAgICAgICAgICBfdGhpczYuY29uZmlybV9wYXNzd29yZCA9ICIiOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIEVudGVyIGFsbCByZXF1aXJlZCBmaWVsZHMiKTsKICAgICAgfQogICAgfSwKICAgIHBhc3N3b3JkX3RvZ2dsZTogZnVuY3Rpb24gcGFzc3dvcmRfdG9nZ2xlKGlkKSB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIHZhciBwYXNzd29yZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKCiAgICAgIGlmIChwYXNzd29yZC50eXBlID09ICJ0ZXh0IikgewogICAgICAgIHBhc3N3b3JkLnR5cGUgPSAicGFzc3dvcmQiOwogICAgICB9IGVsc2UgaWYgKHBhc3N3b3JkLnR5cGUgPT0gInBhc3N3b3JkIikgewogICAgICAgIHBhc3N3b3JkLnR5cGUgPSAidGV4dCI7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVfc3VwZXJhZG1pbjogZnVuY3Rpb24gdXBkYXRlX3N1cGVyYWRtaW4oZXZ0KSB7CiAgICAgIGlmIChldnQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuY29tcGFueV9uYW1lID0gZXZ0OwogICAgICAgIHRoaXMuY29tcGFueV9pZF9zZWxlY3RlZCA9IHRoaXMuY29tcGFueV9pZFt0aGlzLmNvbXBhbmllcy5pbmRleE9mKGV2dCldOwogICAgICAgIGJ1cy4kZW1pdCgiY29tcGFueSBhdHRyaWJ1dGVzIHVwZGF0ZWQiLCAiVHJ1ZSIpOwogICAgICB9CiAgICB9LAogICAgc2VuZF9pbnZpdGU6IGZ1bmN0aW9uIHNlbmRfaW52aXRlKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAodGhpcy5pbnZpdGVfY29tcGFueV9uYW1lID09ICIiKSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgYWxsIHRoZSByZXF1aXJlZCBmaWVsZHMiKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnJlZ19lbWFpbC50ZXN0KHRoaXMuaW52aXRlX2NvbXBhbnlfZW1haWwpID09IGZhbHNlKSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBlbWFpbCIpOwogICAgICB9IGVsc2UgewogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnJlZmVycmFsc191cmwoKSwgewogICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGludml0ZWRfY29tcGFueV9uYW1lOiB0aGlzLmludml0ZV9jb21wYW55X25hbWUsCiAgICAgICAgICBpbnZpdGVkX2NvbXBhbnlfZW1haWw6IHRoaXMuaW52aXRlX2NvbXBhbnlfZW1haWwKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJFbWFpbCBzZW50IHN1Y2Nlc3NmdWxseSIpIHsKICAgICAgICAgICAgYnVzLiRlbWl0KCJpbnZpdGVfdXBkYXRlIiwgImxvYWRlcl9vbiIpOwogICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhyZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KCiAgICAgICAgICAkKCIjaW52aXRlX21vZGFsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgIF90aGlzNy5pbnZpdGVfY29tcGFueV9uYW1lID0gIiI7CiAgICAgICAgICBfdGhpczcuaW52aXRlX2NvbXBhbnlfZW1haWwgPSAiIjsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHNpZ25vdXRfYXBpOiBmdW5jdGlvbiBzaWdub3V0X2FwaSgpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICBidXMuJGVtaXQoIkxvZ291dCBoYXMgYmVlbiBjbGlja2VkIiwgIlRydWUiKTsKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5jbGVhcl9hY2Nlc3NfdG9rZW5fdXJsKCksIHsKICAgICAgICBjb21wYW55bmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzOC5leGVjdXRlX3NpZ25vdXQoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzOC5leGVjdXRlX3NpZ25vdXQoKTsKICAgICAgfSk7CiAgICB9LAogICAgZXhlY3V0ZV9zaWdub3V0OiBmdW5jdGlvbiBleGVjdXRlX3NpZ25vdXQoKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgdmFyIGlzX3N1cGVyX2FkbWluID0gdGhpcy4kc2Vzc2lvbi5nZXQoImlzX3N1cGVyX2FkbWluIik7CgogICAgICBpZiAoaXNfc3VwZXJfYWRtaW4pIHsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5zdXBlcl9hZG1pbl9sb2dvdXQoKSwgewogICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgicnQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIlNpZ25lZCBPdXQhIiB8fCByZXNwb25zZS5kYXRhID09ICJzaWduIG91dCIgfHwgcmVzcG9uc2UuZGF0YSA9PSAidG9rZW4gaW52YWxpZCIgfHwgcmVzcG9uc2UuZGF0YSA9PSAiSW52YWxpZCBDcmVkZW50aWFscyIpIHsKICAgICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3VwZXJfYWRtaW5fYm90X2xvZ291dCgpLCB7CiAgICAgICAgICAgICAgY29tcGFueW5hbWU6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBjb21wYW55aWQ6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgIHVzZXJuYW1lOiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICB0b2tlbjogX3RoaXM5LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmIChfdGhpczkudG9fc2hvd19ub3RpZmljYXRpb25zKSB7CiAgICAgICAgICAgICAgICBfdGhpczkuc2NoZWR1bGVyX2NoYW5uZWwubGVhdmUoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF90aGlzOS50cmFpbmluZ19jaGFubmVsLmxlYXZlKCk7CgogICAgICAgICAgICAgIF90aGlzOS5zb2NrZXQuZGlzY29ubmVjdCgpOwoKICAgICAgICAgICAgICBfdGhpczkuJHNlc3Npb24uZGVzdHJveSgpOwoKICAgICAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICAgIF90aGlzOS4kcm9vdC4kZW1pdCgiQ2xlYXJfUmVmcmVzaF9Ub2tlbl9JbnRlcnZhbCIsIHsKICAgICAgICAgICAgICAgIGNsZWFyX2ludGVydmFsOiB0cnVlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGJ1cy4kZW1pdCgiTG9nZ2VkIG91dCIsICJUcnVlIik7CiAgICAgICAgICAgICAgYnVzLiRlbWl0KCJEaXNhYmxlIHRoZSBib3QgY2hhdCBub3ciLCAiVHJ1ZSIsICJMb2dnZWRvdXQiKTsKCiAgICAgICAgICAgICAgX3RoaXM5LiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICBuYW1lOiAiTG9naW4iCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBpZiAoX3RoaXM5LnRvX3Nob3dfbm90aWZpY2F0aW9ucykgewogICAgICAgICAgICAgICAgX3RoaXM5LnNjaGVkdWxlcl9jaGFubmVsLmxlYXZlKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczkudHJhaW5pbmdfY2hhbm5lbC5sZWF2ZSgpOwoKICAgICAgICAgICAgICBfdGhpczkuc29ja2V0LmRpc2Nvbm5lY3QoKTsKCiAgICAgICAgICAgICAgX3RoaXM5LiRzZXNzaW9uLmRlc3Ryb3koKTsKCiAgICAgICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgICBfdGhpczkuJHJvb3QuJGVtaXQoIkNsZWFyX1JlZnJlc2hfVG9rZW5fSW50ZXJ2YWwiLCB7CiAgICAgICAgICAgICAgICBjbGVhcl9pbnRlcnZhbDogdHJ1ZQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBidXMuJGVtaXQoIkxvZ2dlZCBvdXQiLCAiVHJ1ZSIpOwogICAgICAgICAgICAgIGJ1cy4kZW1pdCgiRGlzYWJsZSB0aGUgYm90IGNoYXQgbm93IiwgIlRydWUiLCAiTG9nZ2Vkb3V0Iik7CgogICAgICAgICAgICAgIF90aGlzOS4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgbmFtZTogIkxvZ2luIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnN1cGVyX2FkbWluX2JvdF9sb2dvdXQoKSwgewogICAgICAgICAgICAgIGNvbXBhbnluYW1lOiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgY29tcGFueWlkOiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICB1c2VybmFtZTogX3RoaXM5LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgdG9rZW46IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBpZiAoX3RoaXM5LnRvX3Nob3dfbm90aWZpY2F0aW9ucykgewogICAgICAgICAgICAgICAgX3RoaXM5LnNjaGVkdWxlcl9jaGFubmVsLmxlYXZlKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczkudHJhaW5pbmdfY2hhbm5lbC5sZWF2ZSgpOwoKICAgICAgICAgICAgICBfdGhpczkuc29ja2V0LmRpc2Nvbm5lY3QoKTsKCiAgICAgICAgICAgICAgX3RoaXM5LiRzZXNzaW9uLmRlc3Ryb3koKTsKCiAgICAgICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgICBfdGhpczkuJHJvb3QuJGVtaXQoIkNsZWFyX1JlZnJlc2hfVG9rZW5fSW50ZXJ2YWwiLCB7CiAgICAgICAgICAgICAgICBjbGVhcl9pbnRlcnZhbDogdHJ1ZQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBidXMuJGVtaXQoIkxvZ2dlZCBvdXQiLCAiVHJ1ZSIpOwogICAgICAgICAgICAgIGJ1cy4kZW1pdCgiRGlzYWJsZSB0aGUgYm90IGNoYXQgbm93IiwgIlRydWUiLCAiTG9nZ2Vkb3V0Iik7CgogICAgICAgICAgICAgIF90aGlzOS4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgbmFtZTogIkxvZ2luIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKF90aGlzOS50b19zaG93X25vdGlmaWNhdGlvbnMpIHsKICAgICAgICAgICAgICAgIF90aGlzOS5zY2hlZHVsZXJfY2hhbm5lbC5sZWF2ZSgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX3RoaXM5LnRyYWluaW5nX2NoYW5uZWwubGVhdmUoKTsKCiAgICAgICAgICAgICAgX3RoaXM5LnNvY2tldC5kaXNjb25uZWN0KCk7CgogICAgICAgICAgICAgIF90aGlzOS4kc2Vzc2lvbi5kZXN0cm95KCk7CgogICAgICAgICAgICAgIF90aGlzOS5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICAgICAgX3RoaXM5LiRyb290LiRlbWl0KCJDbGVhcl9SZWZyZXNoX1Rva2VuX0ludGVydmFsIiwgewogICAgICAgICAgICAgICAgY2xlYXJfaW50ZXJ2YWw6IHRydWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgYnVzLiRlbWl0KCJMb2dnZWQgb3V0IiwgIlRydWUiKTsKICAgICAgICAgICAgICBidXMuJGVtaXQoIkRpc2FibGUgdGhlIGJvdCBjaGF0IG5vdyIsICJUcnVlIiwgIkxvZ2dlZG91dCIpOwoKICAgICAgICAgICAgICBfdGhpczkuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICJMb2dpbiIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIF90aGlzOS5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoX3RoaXM5LnRvX3Nob3dfbm90aWZpY2F0aW9ucykgewogICAgICAgICAgICBfdGhpczkuc2NoZWR1bGVyX2NoYW5uZWwubGVhdmUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczkudHJhaW5pbmdfY2hhbm5lbC5sZWF2ZSgpOwoKICAgICAgICAgIF90aGlzOS5zb2NrZXQuZGlzY29ubmVjdCgpOwoKICAgICAgICAgIF90aGlzOS4kc2Vzc2lvbi5kZXN0cm95KCk7CgogICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgYnVzLiRlbWl0KCJMb2dnZWQgb3V0IiwgIlRydWUiKTsKICAgICAgICAgIGJ1cy4kZW1pdCgiRGlzYWJsZSB0aGUgYm90IGNoYXQgbm93IiwgIlRydWUiLCAiTG9nZ2Vkb3V0Iik7CgogICAgICAgICAgX3RoaXM5LiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICJMb2dpbiIKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnNpZ25vdXRfdXJsKCksIHsKICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoInJ0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJTaWduZWQgT3V0ISIgfHwgcmVzcG9uc2UuZGF0YSA9PSAic2lnbiBvdXQiIHx8IHJlc3BvbnNlLmRhdGEgPT0gInRva2VuIGludmFsaWQiIHx8IHJlc3BvbnNlLmRhdGEgPT0gIkludmFsaWQgQ3JlZGVudGlhbHMiKSB7CiAgICAgICAgICAgIGlmIChfdGhpczkudG9fc2hvd19ub3RpZmljYXRpb25zKSB7CiAgICAgICAgICAgICAgX3RoaXM5LnNjaGVkdWxlcl9jaGFubmVsLmxlYXZlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzOS50cmFpbmluZ19jaGFubmVsLmxlYXZlKCk7CgogICAgICAgICAgICBfdGhpczkuc29ja2V0LmRpc2Nvbm5lY3QoKTsKCiAgICAgICAgICAgIF90aGlzOS4kc2Vzc2lvbi5kZXN0cm95KCk7CgogICAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICBfdGhpczkuJHJvb3QuJGVtaXQoIkNsZWFyX1JlZnJlc2hfVG9rZW5fSW50ZXJ2YWwiLCB7CiAgICAgICAgICAgICAgY2xlYXJfaW50ZXJ2YWw6IHRydWUKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBidXMuJGVtaXQoIkxvZ2dlZCBvdXQiLCAiVHJ1ZSIpOwogICAgICAgICAgICBidXMuJGVtaXQoIkRpc2FibGUgdGhlIGJvdCBjaGF0IG5vdyIsICJUcnVlIiwgIkxvZ2dlZG91dCIpOwoKICAgICAgICAgICAgX3RoaXM5LiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogIkxvZ2luIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzOS5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoX3RoaXM5LnRvX3Nob3dfbm90aWZpY2F0aW9ucykgewogICAgICAgICAgICBfdGhpczkuc2NoZWR1bGVyX2NoYW5uZWwubGVhdmUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczkudHJhaW5pbmdfY2hhbm5lbC5sZWF2ZSgpOwoKICAgICAgICAgIF90aGlzOS5zb2NrZXQuZGlzY29ubmVjdCgpOwoKICAgICAgICAgIF90aGlzOS4kc2Vzc2lvbi5kZXN0cm95KCk7CgogICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgYnVzLiRlbWl0KCJMb2dnZWQgb3V0IiwgIlRydWUiKTsKICAgICAgICAgIGJ1cy4kZW1pdCgiRGlzYWJsZSB0aGUgYm90IGNoYXQgbm93IiwgIlRydWUiLCAiTG9nZ2Vkb3V0Iik7CgogICAgICAgICAgX3RoaXM5LiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6ICJMb2dpbiIKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8gdXBkYXRlX25vdGlmaWNhdGlvbnNfbGlzdCgpIHsKICAgIC8vICAgdGhpcy5zY2hlZHVsZXJfY2hhbm5lbC5wdXNoKCJzaG93X25vdGlmaWNhdGlvbnMiLCB7CiAgICAvLyAgICAgbmVlZF9ub3RpZmljYXRpb25zOiB0cnVlLAogICAgLy8gICAgIGVtYWlsX2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgIH0pOwogICAgLy8gfSwKICAgIHNlZW5fYWxsX25vdGlmaWNhdGlvbnM6IGZ1bmN0aW9uIHNlZW5fYWxsX25vdGlmaWNhdGlvbnMoKSB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIHZhciBsYXN0X2luZGV4ID0gdGhpcy5ub3RpZmljYXRpb25zLmxlbmd0aCAtIDE7CgogICAgICBpZiAobGFzdF9pbmRleCA+PSAwKSB7CiAgICAgICAgaWYgKHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwpIHsKICAgICAgICAgIHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwucHVzaCgibm90aWZpY2F0aW9uX3NlZW4iLCB7CiAgICAgICAgICAgIHJlcV9pZDogdGhpcy5ub3RpZmljYXRpb25zW2xhc3RfaW5kZXhdLmlkCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnRyYWluaW5nX2NoYW5uZWwpIHsKICAgICAgICAgIHRoaXMudHJhaW5pbmdfY2hhbm5lbC5wdXNoKCJub3RpZmljYXRpb25fc2VlbiIsIHsKICAgICAgICAgICAgcmVxX2lkOiB0aGlzLm5vdGlmaWNhdGlvbnNbbGFzdF9pbmRleF0uaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNsZWFyX2FsbF9ub3RpZmljYXRpb25zOiBmdW5jdGlvbiBjbGVhcl9hbGxfbm90aWZpY2F0aW9ucygpIHsKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIHZhciByZXFfbGlzdF9jbGVhcmVkID0gW107CiAgICAgIHZhciBub3RpZmljYXRpb25zX3RlbXBfbGlzdCA9IHRoaXMubm90aWZpY2F0aW9uczsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBub3RpZmljYXRpb25zX3RlbXBfbGlzdC5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgIGlmIChfdHlwZW9mKG5vdGlmaWNhdGlvbnNfdGVtcF9saXN0W2ldKSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnNbaV0uTm90aWZpY2F0aW9uaWQpIHsKICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXJfY2hhbm5lbC5wdXNoKCJub3RpZmljYXRpb25fY2xlYXJlZCIsIHsKICAgICAgICAgICAgICByZXFfaWQ6IHRoaXMubm90aWZpY2F0aW9uc1tpXS5pZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMudHJhaW5pbmdfY2hhbm5lbC5wdXNoKCJub3RpZmljYXRpb25fY2xlYXJlZCIsIHsKICAgICAgICAgICAgICByZXFfaWQ6IHRoaXMubm90aWZpY2F0aW9uc1tpXS5pZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXFfbGlzdF9jbGVhcmVkLnB1c2gobm90aWZpY2F0aW9uc190ZW1wX2xpc3RbaV0uaWQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ub3RpZmljYXRpb25zID0gbm90aWZpY2F0aW9uc190ZW1wX2xpc3QuZmlsdGVyKGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHsKICAgICAgICByZXR1cm4gcmVxX2xpc3RfY2xlYXJlZC5pbmNsdWRlcyhub3RpZmljYXRpb24uaWQpID09PSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgY2xlYXJfc2luZ2xlX25vdGlmaWNhdGlvbjogZnVuY3Rpb24gY2xlYXJfc2luZ2xlX25vdGlmaWNhdGlvbihyZXFfaWQsIGluZGV4KSB7CiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwoKICAgICAgaWYgKHJlcV9pZCAhPT0gbnVsbCkgewogICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnNbaW5kZXhdLk5vdGlmaWNhdGlvbmlkKSB7CiAgICAgICAgICB0aGlzLnNjaGVkdWxlcl9jaGFubmVsLnB1c2goIm5vdGlmaWNhdGlvbl9jbGVhcmVkIiwgewogICAgICAgICAgICByZXFfaWQ6IHJlcV9pZAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudHJhaW5pbmdfY2hhbm5lbC5wdXNoKCJub3RpZmljYXRpb25fY2xlYXJlZCIsIHsKICAgICAgICAgICAgcmVxX2lkOiByZXFfaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ub3RpZmljYXRpb25zLnNwbGljZShpbmRleCwgMSk7CiAgICAgIH0KICAgIH0sCiAgICBzaG93X25vdGlmaWNhdGlvbnM6IGZ1bmN0aW9uIHNob3dfbm90aWZpY2F0aW9ucyhkYXRhKSB7CiAgICAgIGlmIChkYXRhICE9IDEpIHsKICAgICAgICBpZiAoZGF0YS5Ob3RpZmljYXRpb25pZCkgewogICAgICAgICAgdmFyIGRhdGU7CiAgICAgICAgICB2YXIgbW9udGhOYW1lcyA9IFsiSmFuIiwgIkZlYiIsICJNYXIiLCAiQXByIiwgIk1heSIsICJKdW4iLCAiSnVsIiwgIkF1ZyIsICJTZXAiLCAiT2N0IiwgIk5vdiIsICJEZWMiXTsKICAgICAgICAgIGRhdGUgPSBkYXRhLnZpc2l0X2RhdGUuc3BsaXQoIiAiKVswXS5zcGxpdCgiLSIpWzJdICsgIiAiICsgbW9udGhOYW1lc1tkYXRhLnZpc2l0X2RhdGUuc3BsaXQoIiAiKVswXS5zcGxpdCgiLSIpWzFdIC0gMV0gKyAiICIgKyBkYXRhLnZpc2l0X2RhdGUuc3BsaXQoIiAiKVswXS5zcGxpdCgiLSIpWzBdOwogICAgICAgICAgdmFyIHRpbWU7CiAgICAgICAgICBkYXRhLnZpc2l0X3Nsb3Quc3BsaXQoIi0iKVswXTsKCiAgICAgICAgICBpZiAoZGF0YS52aXNpdF9zbG90LnNwbGl0KCItIilbMF0uc3BsaXQoIjoiKVswXSA8IDEyKSB7CiAgICAgICAgICAgIHRpbWUgPSBOdW1iZXIoZGF0YS52aXNpdF9zbG90LnNwbGl0KCItIilbMF0uc3BsaXQoIjoiKVswXSkgKyAiOjAwIGFtIjsKICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS52aXNpdF9zbG90LnNwbGl0KCItIilbMF0uc3BsaXQoIjoiKVswXSA9PSAxMikgewogICAgICAgICAgICB0aW1lID0gIjEyOjAwIHBtIjsKICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS52aXNpdF9zbG90LnNwbGl0KCItIilbMF0uc3BsaXQoIjoiKVswXSA+IDEyICYmIGRhdGEudmlzaXRfc2xvdC5zcGxpdCgiLSIpWzBdLnNwbGl0KCI6IilbMF0gPCAyNCkgewogICAgICAgICAgICB0aW1lID0gTnVtYmVyKGRhdGEudmlzaXRfc2xvdC5zcGxpdCgiLSIpWzBdLnNwbGl0KCI6IilbMF0pIC0gMTIgKyAiOjAwIHBtIjsKICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS52aXNpdF9zbG90LnNwbGl0KCItIilbMF0uc3BsaXQoIjoiKVswXSA9PSAyNCkgewogICAgICAgICAgICB0aW1lID0gIjEyOjAwIGFtIjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZGF0YS5Ob3RpZmljYXRpb25pZCA9PSAiQXBwb2ludG1lbnQgRGVsZXRlZCIpIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKGRhdGEudmlzaXRvcl9uYW1lICsgIiBoYXMgY2FuY2VsbGVkIGFuIGFwcG9pbnRtZW50IHNjaGVkdWxlZCBvbiAiICsgZGF0ZSArICIgYXQgIiArIHRpbWUpOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLk5vdGlmaWNhdGlvbmlkID09ICJBcHBvaW50bWVudCBDb25maXJtZWQiKSB7CiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKGRhdGEudmlzaXRvcl9uYW1lICsgIiBoYXMgY29uZmlybWVkIGFuIGFwcG9pbnRtZW50IHNjaGVkdWxlZCBvbiAiICsgZGF0ZSArICIgYXQgIiArIHRpbWUpOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLk5vdGlmaWNhdGlvbmlkID09ICJBcHBvaW50bWVudCBSZXNjaGVkdWxlZCIpIHsKICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoZGF0YS52aXNpdG9yX25hbWUgKyAiIGhhcyByZWNoZWR1bGVkIGFuIGFwcG9pbnRtZW50IG9uICIgKyBkYXRlICsgIiBhdCAiICsgdGltZSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuTm90aWZpY2F0aW9uaWQgPT0gIkFwcG9pbnRtZW50IFNjaGVkdWxlZCIpIHsKICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoZGF0YS52aXNpdG9yX25hbWUgKyAiIGhhcyBiZWVuIHNjaGVkdWxlZCBhbiBhcHBvaW50bWVudCBvbiAiICsgZGF0ZSArICIgYXQgIiArIHRpbWUpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZGF0YS5Nb2RlbFR5cGUgPT0gIkludGVudCxEaWFsb2d1ZSIpIHsKICAgICAgICAgIHZhciBkYXRlOwogICAgICAgICAgZGF0ZSA9IG1vbWVudChkYXRhLkluaXRpYXRlZE9uLCBbIllZWVktTU0tREQiXSkuZm9ybWF0KCJEbyBNTU0gWVlZWSIpOwoKICAgICAgICAgIGlmIChkYXRhLlRyYWluaW5nU3RhdHVzID09ICJGYWlsZWQiKSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiVGhlIHRyYWluaW5nIG9mIG1vZGVsIG9uICIuY29uY2F0KGRhdGUsICIgaGFzIGZhaWxlZC4gS2luZGx5IGNvbnRhY3QgdGhlIEFkbWluaXN0cmF0b3IgZm9yIGZ1cnRoZXIgZGV0YWlscy4iKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuVHJhaW5pbmdTdGF0dXMgPT0gIkNvbXBsZXRlZCIpIHsKICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIlRoZSB0cmFpbmluZyBvZiBhIG5ldyBtb2RlbCBpbml0aWF0ZWQgb24gIi5jb25jYXQoZGF0ZSwgIiBoYXMgYmVlbiBjb21wbGV0ZWQgc3VjY2VzZnVsbHkuIikpOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLlRyYWluaW5nU3RhdHVzID09ICJTdGFydGVkIikgewogICAgICAgICAgICB0b2FzdHIuaW5mbygiQSBuZXcgcmVxdWVzdCBmb3IgdHJhaW5pbmcgb2YgbW9kZWwgaGFzIGJlZW4gaW5pdGlhdGVkIG9uICIuY29uY2F0KGRhdGUsICIuIikpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZGF0YS5Nb2RlbFR5cGUpIHsKICAgICAgICAgIHZhciBkYXRlOwogICAgICAgICAgZGF0ZSA9IG1vbWVudChkYXRhLkluaXRpYXRlZE9uLCBbIllZWVktTU0tREQiXSkuZm9ybWF0KCJEbyBNTU0gWVlZWSIpOwoKICAgICAgICAgIGlmIChkYXRhLlRyYWluaW5nU3RhdHVzID09ICJGYWlsZWQiKSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiVGhlIHRyYWluaW5nIG9mICIuY29uY2F0KGRhdGEuTW9kZWxUeXBlLCAiIG1vZGVsIG9uICIpLmNvbmNhdChkYXRlLCAiIGhhcyBmYWlsZWQuIEtpbmRseSBjb250YWN0IHRoZSBBZG1pbmlzdHJhdG9yIGZvciBmdXJ0aGVyIGRldGFpbHMuIikpOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLlRyYWluaW5nU3RhdHVzID09ICJDb21wbGV0ZWQiKSB7CiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCJUaGUgdHJhaW5pbmcgb2YgYSBuZXcgIi5jb25jYXQoZGF0YS5Nb2RlbFR5cGUsICIgbW9kZWwgaW5pdGlhdGVkIG9uICIpLmNvbmNhdChkYXRlLCAiIGhhcyBiZWVuIGNvbXBsZXRlZCBzdWNjZXNmdWxseS4iKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuVHJhaW5pbmdTdGF0dXMgPT0gIlN0YXJ0ZWQiKSB7CiAgICAgICAgICAgIHRvYXN0ci5pbmZvKCJBIG5ldyByZXF1ZXN0IGZvciB0cmFpbmluZyBvZiAiLmNvbmNhdChkYXRhLk1vZGVsVHlwZSwgIiBtb2RlbCBoYXMgYmVlbiBpbml0aWF0ZWQgb24gIikuY29uY2F0KGRhdGUsICIuIikpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHN0YXJ0X3RvdXI6IGZ1bmN0aW9uIHN0YXJ0X3RvdXIoKSB7CiAgICAgIHRoaXMuJHJvb3QuJGVtaXQoInNob3dfdG91cl9ndWlkZSIsIHRydWUpOwogICAgfSwKICAgIGdlbmVyYXRlX2VtYWlsX3dpemFyZDogZnVuY3Rpb24gZ2VuZXJhdGVfZW1haWxfd2l6YXJkKG1vZGVsVHlwZSwgaW5pdGlhdGVkT24pIHsKICAgICAgdmFyIHVzZXJuYW1lID0gIiIuY29uY2F0KHRoaXMudXNlcl9maXJzdF9uYW1lLCAiICIpLmNvbmNhdCh0aGlzLnVzZXJfbGFzdF9uYW1lKTsKICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CgogICAgICBpZiAobW9kZWxUeXBlID09ICJJbnRlbnQsRGlhbG9ndWUiKSB7CiAgICAgICAgYS5ocmVmID0gIm1haWx0bzphZG1pbkBjZW5zZS5haT9zdWJqZWN0PUNoYXRib3QgbW9kZWwgdHJhaW5pbmcgZmFpbGVkIG9uICIuY29uY2F0KGluaXRpYXRlZE9uLCAiLiZib2R5PUhpIENlbnNlIFRlYW0sJTBEJTBBLCBUaGUgY2hhdGJvdCBtb2RlbCB0cmFpbmluZyBoYXMgZmFpbGVkLiBUaGUgU3lzdGVtIEFkbWluIHdpbGwgbG9vayBpbnRvIHRoaXMgYW5kIGdldCBiYWNrIHRvIHlvdS4lMEQlMEFUaGFua3MsJTBEJTBBIikuY29uY2F0KHVzZXJuYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhLmhyZWYgPSAibWFpbHRvOmFkbWluQGNlbnNlLmFpP3N1YmplY3Q9Ii5jb25jYXQobW9kZWxUeXBlLCAiIG1vZGVsIHRyYWluaW5nIGZhaWxlZCBvbiAiKS5jb25jYXQoaW5pdGlhdGVkT24sICIuJmJvZHk9SGkgQ2Vuc2UgVGVhbSwlMEQlMEEsIFRoZSAiKS5jb25jYXQobW9kZWxUeXBlLCAiIG1vZGVsIHRyYWluaW5nIGhhcyBmYWlsZWQuIFRoZSBTeXN0ZW0gQWRtaW4gd2lsbCBsb29rIGludG8gdGhpcyBhbmQgZ2V0IGJhY2sgdG8geW91LiUwRCUwQVRoYW5rcywlMEQlMEEiKS5jb25jYXQodXNlcm5hbWUpOwogICAgICB9CgogICAgICBhLmNsaWNrKCk7CiAgICB9CiAgfQp9Ow=="},null]}