{"remainingRequest":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js!/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Account/Billing.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Account/Billing.vue","mtime":1663910265446},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybCI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBTd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IGNvdW50cmllcyBmcm9tICJAL3BvcnRhbC9jb21wb25lbnRzL0NvdW50cmllcyI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCB7IGJ1cyB9IGZyb20gIkAvcG9ydGFsL21haW4iOwppbXBvcnQgYXBpX2NhbGxzIGZyb20gIkAvcG9ydGFsL2FwaV9jYWxscyI7CmltcG9ydCBBcmVhQ2hhcnQgZnJvbSAiQC9wb3J0YWwvY29tcG9uZW50cy9BcmVhQ2hhcnQudnVlIjsKaW1wb3J0IE11bHRpc2VsZWN0IGZyb20gInZ1ZS1tdWx0aXNlbGVjdCI7IC8vIGltcG9ydCB7IFN0cmlwZUNoZWNrb3V0IH0gZnJvbSAiQHZ1ZS1zdHJpcGUvdnVlLXN0cmlwZSI7CgppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7CmltcG9ydCB7IHVwZGF0ZV9zaWRlYmFyX21lbnUsIHVwZGF0ZV9yZXN0cmljdGlvbl9saXN0IH0gZnJvbSAiQC9wb3J0YWwvbWl4aW5zIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJCaWxsaW5nIiwKICBjb21wb25lbnRzOiB7CiAgICBBcmVhQ2hhcnQ6IEFyZWFDaGFydCwKICAgIE11bHRpc2VsZWN0OiBNdWx0aXNlbGVjdCAvLyBTdHJpcGVDaGVja291dCwKCiAgfSwKICBtaXhpbnM6IFt1cGRhdGVfc2lkZWJhcl9tZW51LCB1cGRhdGVfcmVzdHJpY3Rpb25fbGlzdF0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNlbGVjdF9zdWJzY3JpcHRpb25fcGxhbjogWyJTaWx2ZXIiLCAiR29sZCIsICJQbGFudGludW0iLCAiRW50ZXJwcmlzZSJdLAogICAgICBzZWxlY3RlZF9zdWJzY3JpcHRpb246ICIiLAogICAgICBzdWJzY3JpcHRpb25faWQ6ICIiLAogICAgICBwbGFuX2lkOiAiIiwKICAgICAgY3VzdG9tZXJfaWQ6ICIiLAogICAgICBwbGFuX3BlcmlvZDogWyJNb250aGx5IiwgIlllYXJseSJdLAogICAgICBzZWxlY3RlZF9wZXJpb2Q6ICIiLAogICAgICBvcmRlcl9pZDogIiIsCiAgICAgIGFtb3VudDogIiIsCiAgICAgIHBheV9zdWNjZXNzX2RhdGE6IHt9LAogICAgICBzdWJzY3JpcHRpb25fYnRuX2Rpc2FibGU6IGZhbHNlLAogICAgICBjb3VudHJ5X2xpc3Q6IGNvdW50cmllcywKICAgICAgcGF5bWVudGlkOiAiIiwKICAgICAgYmFyQ2hhcnQ6ICIiLAogICAgICBiYWNrZ3JvdW5kQ29sb3I6IFsiI2U2N2UyMiIsICIjMTZhMDg1IiwgIiMyOTgwYjkiXSwKICAgICAgbGFiZWxzOiBbIkV4Y2hhbmdlIG9mIE1lc3NhZ2VzIiwgIkV4ZWN1dGlvbiBvZiBUYXNrcyIsICJBdWRpby9WaWRlbyBJbnRlcmFjdGlvbiIsICJTdG9yYWdlIl0sCiAgICAgIGNvbXBhbnlpZDogbnVsbCwKICAgICAgY29tcGFueW5hbWU6IG51bGwsCiAgICAgIGNvdW50cnlfbmFtZTogIiIsCiAgICAgIHBheW1lbnRfY3VycmVuY3k6ICIiLAogICAgICB2YWx1ZV9jdXJyZW5jeV90b3BfdXA6ICIiLAogICAgICB2YWx1ZV9jdXJyZW5jeV9zdWJzY3JpcHRpb246ICIiLAogICAgICBJTlI6IFszNTAwLCA3MDAwLCAxNDAwMCwgMzUwMDBdLAogICAgICBVU0Q6IFs1MCwgMTAwLCAyMDAsIDUwMF0sCiAgICAgIGNvbW1vbl9jdXJyZW5jeTogW10sCiAgICAgIGN1cnJlbmN5X2Ftb3VudDogbnVsbCwKICAgICAgdG9wX3VwX2Ftb3VudDogbnVsbCwKICAgICAgcGllY2hhcnRfZGF0YTogW10sCiAgICAgIHVzZXJfcm9sZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUsCiAgICAgIGNvbmN1cnJlbnRfdXNlcnNfbW9udGg6ICIiLAogICAgICBDb25jdXJyZW50X1VzZXJzX0RhdGE6IHsKICAgICAgICBsYWJlbHM6IFtdLAogICAgICAgIGRhdGE6IFtdCiAgICAgIH0sCiAgICAgIG1vbnRoczogWyJKYW4iLCAiRmViIiwgIk1hciIsICJBcHIiLCAiTWF5IiwgIkp1bmUiLCAiSnVseSIsICJBdWciLCAiU2VwdCIsICJPY3QiLCAiTm92IiwgIkRlYyJdLAogICAgICBpbnZvaWNlX2RldGFpbHM6IFtdLAogICAgICBpbnZvaWNlX2RldGFpbHNfY29weTogW10sCiAgICAgIHRvdGFsX3llYXI6IFtdLAogICAgICB5ZWFyX3NlbGVjdGVkOiAiIiwKICAgICAgc3Bpbm5lck9uOiBmYWxzZSwKICAgICAgLy9oYXJzaAogICAgICBjb21tb25fY3VycmVuY3kyOiBbXSwKICAgICAgSU5SMjogWzM1MDAsIDcwMDAsIDE0MDAwLCAzNTAwMF0sCiAgICAgIFVTRDI6IFsxMDAsIDMwMCwgNTAwXSwKICAgICAgcmV0YWlsX3Nob3BpZnlfY29tcGFueTogZmFsc2UsCiAgICAgIC8vIGFkZG9uX3BsYW5zOiBbCiAgICAgIC8vICAgewogICAgICAvLyAgICAgICAiVHlwZSI6ICJTbXNBZGRPbiIsCiAgICAgIC8vICAgICAgICJQcmljZSI6IDE1LjAsCiAgICAgIC8vICAgICAgICJTZXJ2aWNlIjogIlNNUyIsCiAgICAgIC8vICAgICAgICJQcmljZU9wdGlvbnMiOiBbCiAgICAgIC8vICAgICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgICAgInByaWNlIjogMTUuMCwKICAgICAgLy8gICAgICAgICAgICAgICAiY3VycmVuY3kiOiAidXNkIiwKICAgICAgLy8gICAgICAgICAgICAgICAiaWQiOiAiMTI0MjU2NDgzMjU0MTQzNTM0MTMyMzUyMzQxMzQiLAogICAgICAvLyAgICAgICAgICAgICAgICJ0eXBlIjogInVzIiwKICAgICAgLy8gICAgICAgICAgICAgICAiY291bnQiOiAxMDAwLAogICAgICAvLyAgICAgICAgICAgICAgICJrZXkiOiAic21zX2NvdW50LmFkZF9vbi51cyIsCiAgICAgIC8vICAgICAgICAgICAgICAgImxhYmVsIjogIiQxNSAoMTAwMCBzbXMgZm9yIFVTIHJlZ2lvbikiCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICAgICJwcmljZSI6IDE1LjAsCiAgICAgIC8vICAgICAgICAgICAgICAgImN1cnJlbmN5IjogInVzZCIsCiAgICAgIC8vICAgICAgICAgICAgICAgImlkIjogIjEyNDI1NjQ4MzI1NDE0MzUzNDEzMjM1MjM0MTM0IiwKICAgICAgLy8gICAgICAgICAgICAgICAidHlwZSI6ICJub25fdXMiLAogICAgICAvLyAgICAgICAgICAgICAgICJjb3VudCI6IDUwMCwKICAgICAgLy8gICAgICAgICAgICAgICAia2V5IjogInNtc19jb3VudC5hZGRfb24ubm9uX3VzIiwKICAgICAgLy8gICAgICAgICAgICAgICAibGFiZWwiOiAiJDE1ICg1MDAgc21zIGZvciBOb24tVVMgcmVnaW9uKSIKICAgICAgLy8gICAgICAgICAgIH0KICAgICAgLy8gICAgICAgXSwKICAgICAgLy8gICAgICAgIk9wdGlvbnMiOiBbCiAgICAgIC8vICAgICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgICAgInR5cGUiOiAidXMiLAogICAgICAvLyAgICAgICAgICAgICAgICJjb3VudCI6IDEwMDAKICAgICAgLy8gICAgICAgICAgIH0sCiAgICAgIC8vICAgICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgICAgInR5cGUiOiAibm9uX3VzIiwKICAgICAgLy8gICAgICAgICAgICAgICAiY291bnQiOiA1MDAKICAgICAgLy8gICAgICAgICAgIH0KICAgICAgLy8gICAgICAgXSwKICAgICAgLy8gICAgICAgIklzQWN0aXZlIjogdHJ1ZSwKICAgICAgLy8gICAgICAgIklzQWRkT24iOiB0cnVlCiAgICAgIC8vICAgfSwKICAgICAgLy8gICB7CiAgICAgIC8vICAgICAgICJUeXBlIjogIkNvbnZlcnNhdGlvbkFkZE9uIiwKICAgICAgLy8gICAgICAgIlNlcnZpY2UiOiAiV2hhdHNhcHBDb252ZXJzYXRpb24iLAogICAgICAvLyAgICAgICAiUHJpY2VPcHRpb25zIjogWwogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICAgICJwcmljZSI6IDI5LjAsCiAgICAgIC8vICAgICAgICAgICAgICAgImN1cnJlbmN5IjogInVzZCIsCiAgICAgIC8vICAgICAgICAgICAgICAgImlkIjogIjEyNDI1NjQ4MzI1NDE0MzUzNDEzMjM1MjM0MTM0IiwKICAgICAgLy8gICAgICAgICAgICAgICAidHlwZSI6ICJjb252ZXJzYXRpb25zIiwKICAgICAgLy8gICAgICAgICAgICAgICAiY291bnQiOiAyMDAwLAogICAgICAvLyAgICAgICAgICAgICAgICJrZXkiOiAid2hhdHNhcHBfY29udmVyc2F0aW9uc19jb3VudC5hZGRfb24iLAogICAgICAvLyAgICAgICAgICAgICAgICJsYWJlbCI6ICIkMjkgKDIwMDAgY29udmVyc2F0aW9ucykiCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICAgICJwcmljZSI6IDIwMDAuMCwKICAgICAgLy8gICAgICAgICAgICAgICAiY3VycmVuY3kiOiAiaW5yIiwKICAgICAgLy8gICAgICAgICAgICAgICAiaWQiOiAiMTI0MjU2NDgzMjU0MTQzNjM0NTI5MjA4NDUyMzQiLAogICAgICAvLyAgICAgICAgICAgICAgICJ0eXBlIjogImNvbnZlcnNhdGlvbnMiLAogICAgICAvLyAgICAgICAgICAgICAgICJjb3VudCI6IDIwMDAsCiAgICAgIC8vICAgICAgICAgICAgICAgImtleSI6ICJ3aGF0c2FwcF9jb252ZXJzYXRpb25zX2NvdW50LmFkZF9vbiIsCiAgICAgIC8vICAgICAgICAgICAgICAgImxhYmVsIjogIuKCuTIwMDAgKDIwMDAgY29udmVyc2F0aW9ucykiCiAgICAgIC8vICAgICAgICAgICB9CiAgICAgIC8vICAgICAgIF0sCiAgICAgIC8vICAgICAgICJJc0FjdGl2ZSI6IHRydWUsCiAgICAgIC8vICAgICAgICJJc0FkZE9uIjogdHJ1ZQogICAgICAvLyAgIH0KICAgICAgLy8gXSwKICAgICAgLy8gcGxhbnM6IFsKICAgICAgLy8gewogICAgICAvLyAgICAgIlR5cGUiIDogIlN0YXJ0ZXIiLAogICAgICAvLyAgICAgIklzQWN0aXZlIiA6IHRydWUsCiAgICAgIC8vICAgICAiUHJpY2VPcHRpb25zIiA6IFsgCiAgICAgIC8vICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICAicHJpY2UiIDogMjkuMCwKICAgICAgLy8gICAgICAgICAgICAgImN1cnJlbmN5IiA6ICJ1c2QiLAogICAgICAvLyAgICAgICAgICAgICAicHJpY2VfaWQiIDogInByaWNlXzFKelp5MkdUWjdKZG1WdXN5VXFqT3RqNyIsCiAgICAgIC8vICAgICAgICAgICAgICJuaWNrbmFtZSIgOiAiU3RhcnRlci1UZXN0IiwKICAgICAgLy8gICAgICAgICAgICAgImxhYmVsIiA6ICIkMjkvbW9udGgiLAogICAgICAvLyAgICAgICAgICAgICAidHlwZSIgOiAibW9udGhseSIKICAgICAgLy8gICAgICAgICB9LCAKICAgICAgLy8gICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgICJwcmljZSIgOiAyMDAwLjAsCiAgICAgIC8vICAgICAgICAgICAgICJjdXJyZW5jeSIgOiAiaW5yIiwKICAgICAgLy8gICAgICAgICAgICAgInByaWNlX2lkIiA6ICJwcmljZV8xS2RZT1BHVFo3SmRtVnVzRFl0VDNyeTgiLAogICAgICAvLyAgICAgICAgICAgICAibmlja25hbWUiIDogIlN0YXJ0ZXItVGVzdC1JTlIiLAogICAgICAvLyAgICAgICAgICAgICAibGFiZWwiIDogIuKCuTIwMDAvbW9udGgiLAogICAgICAvLyAgICAgICAgICAgICAidHlwZSIgOiAibW9udGhseSIKICAgICAgLy8gICAgICAgICB9LCAKICAgICAgLy8gICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgICJwcmljZSIgOiAyOTAuMCwKICAgICAgLy8gICAgICAgICAgICAgImN1cnJlbmN5IiA6ICJ1c2QiLAogICAgICAvLyAgICAgICAgICAgICAicHJpY2VfaWQiIDogInByaWNlXzFLMjhqSkdUWjdKZG1WdXNhSGhLNHRPRiIsCiAgICAgIC8vICAgICAgICAgICAgICJuaWNrbmFtZSIgOiAiU3RhcnRlci1UZXN0LVllYXJseSIsCiAgICAgIC8vICAgICAgICAgICAgICJsYWJlbCIgOiAiJDI5MC95ZWFybHkiLAogICAgICAvLyAgICAgICAgICAgICAidHlwZSIgOiAieWVhcmx5IgogICAgICAvLyAgICAgICAgIH0sIAogICAgICAvLyAgICAgICAgIHsKICAgICAgLy8gICAgICAgICAgICAgInByaWNlIiA6IDIwMDAwLjAsCiAgICAgIC8vICAgICAgICAgICAgICJjdXJyZW5jeSIgOiAiaW5yIiwKICAgICAgLy8gICAgICAgICAgICAgInByaWNlX2lkIiA6ICJwcmljZV8xS2RZVDRHVFo3SmRtVnVzWTRuRVRHSEgiLAogICAgICAvLyAgICAgICAgICAgICAibmlja25hbWUiIDogIlN0YXJ0ZXItVGVzdC1ZZWFybHktSU5SIiwKICAgICAgLy8gICAgICAgICAgICAgImxhYmVsIiA6ICLigrkyMDAwMC95ZWFybHkiLAogICAgICAvLyAgICAgICAgICAgICAidHlwZSIgOiAieWVhcmx5IgogICAgICAvLyAgICAgICAgIH0KICAgICAgLy8gICAgIF0sICAgIAogICAgICAvLyB9LAogICAgICAvLyB7CiAgICAgIC8vICAgICAiVHlwZSIgOiAiUHJlbWl1bSIsCiAgICAgIC8vICAgICAiUHJpY2VPcHRpb25zIiA6IFsgCiAgICAgIC8vICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICAicHJpY2UiIDogOTkuMCwKICAgICAgLy8gICAgICAgICAgICAgImN1cnJlbmN5IiA6ICJ1c2QiLAogICAgICAvLyAgICAgICAgICAgICAicHJpY2VfaWQiIDogInByaWNlXzFKelp5akdUWjdKZG1WdXMyS0hkTDhYRSIsCiAgICAgIC8vICAgICAgICAgICAgICJuaWNrbmFtZSIgOiAiUHJlbWl1bS1UZXN0IiwKICAgICAgLy8gICAgICAgICAgICAgImxhYmVsIiA6ICIkOTkvbW9udGgiLAogICAgICAvLyAgICAgICAgICAgICAidHlwZSIgOiAibW9udGhseSIKICAgICAgLy8gICAgICAgICB9LCAKICAgICAgLy8gICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgICJwcmljZSIgOiA3MDAwLjAsCiAgICAgIC8vICAgICAgICAgICAgICJjdXJyZW5jeSIgOiAiaW5yIiwKICAgICAgLy8gICAgICAgICAgICAgInByaWNlX2lkIiA6ICJwcmljZV8xS2RZU0VHVFo3SmRtVnVzWndLVEFVVjYiLAogICAgICAvLyAgICAgICAgICAgICAibmlja25hbWUiIDogIlByZW1pdW0tVGVzdC1JTlIiLAogICAgICAvLyAgICAgICAgICAgICAibGFiZWwiIDogIuKCuTcwMDAvbW9udGgiLAogICAgICAvLyAgICAgICAgICAgICAidHlwZSIgOiAibW9udGhseSIKICAgICAgLy8gICAgICAgICB9LCAKICAgICAgLy8gICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgICJwcmljZSIgOiA5OTAuMCwKICAgICAgLy8gICAgICAgICAgICAgImN1cnJlbmN5IiA6ICJ1c2QiLAogICAgICAvLyAgICAgICAgICAgICAicHJpY2VfaWQiIDogInByaWNlXzFLMjhoVEdUWjdKZG1WdXMxd1djdDlQVCIsCiAgICAgIC8vICAgICAgICAgICAgICJuaWNrbmFtZSIgOiAiUHJlbWl1bS1UZXN0LVllYXJseSIsCiAgICAgIC8vICAgICAgICAgICAgICJsYWJlbCIgOiAiJDk5MC95ZWFyIiwKICAgICAgLy8gICAgICAgICAgICAgInR5cGUiIDogInllYXJseSIKICAgICAgLy8gICAgICAgICB9LCAKICAgICAgLy8gICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgICJwcmljZSIgOiA3MDAwMC4wLAogICAgICAvLyAgICAgICAgICAgICAiY3VycmVuY3kiIDogImluciIsCiAgICAgIC8vICAgICAgICAgICAgICJwcmljZV9pZCIgOiAicHJpY2VfMUtkWVRaR1RaN0pkbVZ1c1NKSWNFR256IiwKICAgICAgLy8gICAgICAgICAgICAgIm5pY2tuYW1lIiA6ICJQcmVtaXVtLVRlc3QtWWVhcmx5LUlOUiIsCiAgICAgIC8vICAgICAgICAgICAgICJsYWJlbCIgOiAi4oK5NzAwMDAveWVhciIsCiAgICAgIC8vICAgICAgICAgICAgICJ0eXBlIiA6ICJ5ZWFybHkiCiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyAgICAgXSwKICAgICAgLy8gfV0sCiAgICAgIHJldGFpbF9zaG9waWZ5X3N1YnNjcmlwdGlvbl9wbGFuczogWy8vIHsKICAgICAgLy8gICBuYW1lOiAiRnJlZSIsCiAgICAgIC8vICAgaXNfY2hhcmdlYWJsZTogZmFsc2UsCiAgICAgIC8vIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAiU3RhcnRlciIsCiAgICAgICAgbGFiZWw6ICJTdGFydGVyICgkMjkvbW9udGggb3IgJDI5MC95ZWFyKSIsCiAgICAgICAgaXNfY2hhcmdlYWJsZTogdHJ1ZSwKICAgICAgICBtb250aGx5X2NoYXJnZTogMjksCiAgICAgICAgYW5udWFsX2NoYXJnZTogewogICAgICAgICAgcGVyX21vbnRoX2VmZmVjdGl2ZTogMjQuMTcsCiAgICAgICAgICBhY3R1YWxfY2hhcmdlOiAyOTAKICAgICAgICB9LAogICAgICAgIGN1cnJlbmN5OiAidXNkIgogICAgICB9LCB7CiAgICAgICAgbmFtZTogIlByZW1pdW0iLAogICAgICAgIGxhYmVsOiAiUHJlbWl1bSAoJDk5L21vbnRoIG9yICQ5OTAveWVhcikiLAogICAgICAgIGlzX2NoYXJnZWFibGU6IHRydWUsCiAgICAgICAgbW9udGhseV9jaGFyZ2U6IDk5LAogICAgICAgIGFubnVhbF9jaGFyZ2U6IHsKICAgICAgICAgIHBlcl9tb250aF9lZmZlY3RpdmU6IDgyLjUsCiAgICAgICAgICBhY3R1YWxfY2hhcmdlOiA5OTAKICAgICAgICB9LAogICAgICAgIGN1cnJlbmN5OiAidXNkIgogICAgICB9LCB7CiAgICAgICAgbmFtZTogIlN0YXJ0ZXIiLAogICAgICAgIGxhYmVsOiAiU3RhcnRlciAo4oK5MjAwMC9tb250aCBvciDigrkyMDAwMC95ZWFyKSIsCiAgICAgICAgaXNfY2hhcmdlYWJsZTogdHJ1ZSwKICAgICAgICBtb250aGx5X2NoYXJnZTogMjAwMCwKICAgICAgICBhbm51YWxfY2hhcmdlOiB7CiAgICAgICAgICBwZXJfbW9udGhfZWZmZWN0aXZlOiAyNC4xNywKICAgICAgICAgIGFjdHVhbF9jaGFyZ2U6IDIwMDAwCiAgICAgICAgfSwKICAgICAgICBjdXJyZW5jeTogImluciIKICAgICAgfSwgewogICAgICAgIG5hbWU6ICJQcmVtaXVtIiwKICAgICAgICBsYWJlbDogIlByZW1pdW0gKOKCuTcwMDAvbW9udGggb3Ig4oK5NzAwMDAveWVhcikiLAogICAgICAgIGlzX2NoYXJnZWFibGU6IHRydWUsCiAgICAgICAgbW9udGhseV9jaGFyZ2U6IDcwMDAsCiAgICAgICAgYW5udWFsX2NoYXJnZTogewogICAgICAgICAgcGVyX21vbnRoX2VmZmVjdGl2ZTogODIuNSwKICAgICAgICAgIGFjdHVhbF9jaGFyZ2U6IDcwMDAwCiAgICAgICAgfSwKICAgICAgICBjdXJyZW5jeTogImluciIKICAgICAgfSwgewogICAgICAgIG5hbWU6ICJXaGF0c0FwcCIsCiAgICAgICAgbGFiZWw6ICJXaGF0c0FwcCAoJDI5L21vbnRoKSIsCiAgICAgICAgaXNfY2hhcmdlYWJsZTogdHJ1ZSwKICAgICAgICBtb250aGx5X2NoYXJnZTogMjksCiAgICAgICAgY3VycmVuY3k6ICJ1c2QiCiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAiV2hhdHNBcHAiLAogICAgICAgIGxhYmVsOiAiV2hhdHNBcHAgKOKCuTIwMDAvbW9udGgpIiwKICAgICAgICBpc19jaGFyZ2VhYmxlOiB0cnVlLAogICAgICAgIG1vbnRobHlfY2hhcmdlOiAyMDAwLAogICAgICAgIGN1cnJlbmN5OiAiaW5yIgogICAgICB9XSwKICAgICAgcmV0YWlsX3BsYW5fY3VycmVudDogbnVsbCwKICAgICAgcGF5bWVudF90eXBlczogWyJBbm51YWwiLCAiTW9udGhseSJdLAogICAgICByZXRhaWxfcGF5bWVudF90eXBlOiBudWxsLAogICAgICBzdHJpcGVfc3Vic2NyaXB0aW9uX3BsYW5zOiBudWxsLAogICAgICBzdHJpcGVfc3Vic2NyaXB0aW9uX3BsYW5zX2RldGFpbHM6IHt9LAogICAgICBzdHJpcGVfYWRkb25fcGxhbnM6IFtdLAogICAgICBzaG93X3N1YnNjcmlwdGlvbjogZmFsc2UsCiAgICAgIHNlbGVjdGVkX2FkZG9uX3BsYW46IG51bGwsCiAgICAgIGhpZGVfYnV0dG9uOiAnRnJlZScsCiAgICAgIGNyZWRpdHNfYmFsYW5jZTogbnVsbCwKICAgICAgcmV0YWlsX3dlYl9mcmFtZXdvcms6IHRoaXMuJHNlc3Npb24uZ2V0KCJyZXRhaWxfd2ViX2ZyYW1ld29yayIpLAogICAgICBzaG9wX2Jhc2VfY3VycmVuY3k6ICd1c2QnLAogICAgICBhY2NlcHRhYmxlX3Nob3BfYmFzZV9jdXJyZW5jaWVzOiBbJ0lOUicsICdVU0QnLCAnaW5yJywgJ3VzZCddLAogICAgICBzdHJpcGVfYWRkb25fdHlwZTogW10sCiAgICAgIHNlbGVjdGVkX2FkZG9uX3R5cGU6IG51bGwKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB0aGlzLnJldGFpbF93ZWJfZnJhbWV3b3JrID0gdGhpcy4kc2Vzc2lvbi5nZXQoInJldGFpbF93ZWJfZnJhbWV3b3JrIik7CiAgICB0aGlzLmNvdW50cnlfbGlzdCA9IGNvdW50cmllczsKCiAgICBpZiAoIXRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55SWQiKSAmJiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucm9sZSA9PSAiU3VwZXJBZG1pbiIpIHsKICAgICAgdG9hc3RyLndhcm5pbmcodGx0KCdiaWxsaW5nX3NlbGVjdF9jb21wYW55X25hbWVfbXNnJykpOwogICAgfQoKICAgIGlmICh0aGlzLnVzZXJfcm9sZSA9PSAiU3VwZXJBZG1pbiIpIHsKICAgICAgaWYgKHRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55SWQiKSkgewogICAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlJZCIpOwogICAgICAgIHRoaXMuY29tcGFueW5hbWUgPSB0aGlzLiRzZXNzaW9uLmdldCgiQ29tcGFueU5hbWUiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkOwogICAgICAgIHRoaXMuY29tcGFueW5hbWUgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgIH0KCiAgICBpZiAodGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvdW50cnlfbmFtZSA9PSAiIiAmJiAhdGhpcy4kc2Vzc2lvbi5oYXMoImNvdW50cnlfbmFtZSIpKSB7fSBlbHNlIHsKICAgICAgYXhpb3MuZ2V0KGFwaV9jYWxscy5iaWxsaW5nX2ludm9pY2UoKSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzLmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXMudG90YWxfeWVhciA9IHJlc3BvbnNlLmRhdGEuZGF0YS5ZZWFyTGlzdDsKICAgICAgICAgIF90aGlzLnllYXJfc2VsZWN0ZWQgPSBfdGhpcy50b3RhbF95ZWFyWzBdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmJpbGxpbmdfaW52b2ljZSgpLCB7CiAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICBkb3dubG9hZF9maWxlOiBmYWxzZSwKICAgICAgICB5ZWFyOiB0aGlzLnllYXJfc2VsZWN0ZWQKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzLmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXMuaW52b2ljZV9kZXRhaWxzID0gcmVzcG9uc2UuZGF0YS5kYXRhLkJ1Y2tldF9saXN0OwoKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX3RoaXMuaW52b2ljZV9kZXRhaWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIF90aGlzLmludm9pY2VfZGV0YWlsc19jb3B5W2ldID0gX3RoaXMuaW52b2ljZV9kZXRhaWxzW2ldLnNsaWNlKDgpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0gLy8gY29uc29sZS5sb2codGhpcy5pbnZvaWNlX2RldGFpbHNfY29weSk7CgogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKGUsICdycicpOwoKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgdmFyIGlzX3Nob3BpZnkgPSB0aGlzLnJldGFpbF93ZWJfZnJhbWV3b3JrOwoKICAgIGlmIChCb29sZWFuKGlzX3Nob3BpZnkpICYmIGlzX3Nob3BpZnkgPT09ICJzaG9waWZ5IikgewogICAgICB0aGlzLnJldGFpbF9zaG9waWZ5X2NvbXBhbnkgPSB0cnVlOwogICAgfQoKICAgIHRoaXMuZ2V0X3Nob3BfYmFzZV9jdXJyZW5jeSgpOwogICAgdGhpcy5jaGVja19hZGRvbnNfYmFsYW5jZSgpOwogIH0sCiAgd2F0Y2g6IHsKICAgIHNlbGVjdGVkX2FkZG9uX3BsYW46IGZ1bmN0aW9uIHNlbGVjdGVkX2FkZG9uX3BsYW4oKSB7CiAgICAgIHRoaXMuc3RyaXBlX2FkZG9uX3R5cGUgPSBbXTsKICAgICAgdGhpcy5zZWxlY3RlZF9hZGRvbl90eXBlID0gbnVsbDsKCiAgICAgIGlmICh0aGlzLnNlbGVjdGVkX2FkZG9uX3BsYW4gIT09IG51bGwpIHsKICAgICAgICB0aGlzLnN0cmlwZV9hZGRvbl90eXBlID0gdGhpcy5zZWxlY3RlZF9hZGRvbl9wbGFuLk9wdGlvbnM7CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICB0aGlzLmdldF9wbGFuc19mcm9tX2RiKCk7IC8vIEdldCBwbGFucyBmcm9tIGRiCgogICAgdGhpcy5nZXRfYWRkb25fZGV0YWlscygpOyAvLyBHZXQgQWRkIE9ucyBmcm9tIGNlbnNlIGRiCgogICAgdGhpcy5nZXRfY3VycmVudF9zdWJzY3JpcHRpb25fZGV0YWlscygpOyAvLyBnZXQgc3Vic2NyaXB0aW9uIGRldGFpbHMgZnJvbSBjZW5zZV9kYgoKICAgIGlmICh0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY291bnRyeV9uYW1lID09ICIiICYmICF0aGlzLiRzZXNzaW9uLmhhcygiY291bnRyeV9uYW1lIikpIHsKICAgICAgJCgiI2NvdW50cnltb2RhbCIpLm1vZGFsKHsKICAgICAgICBiYWNrZHJvcDogInN0YXRpYyIKICAgICAgfSkub24oImhpZGRlbi5icy5tb2RhbCIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKCFfdGhpczIuJHNlc3Npb24uaGFzKCJjb3VudHJ5X25hbWUiKSkgewogICAgICAgICAgJCgiI2NvdW50cnltb2RhbCIpLm1vZGFsKCJoaWRlIik7CgogICAgICAgICAgX3RoaXMyLiRyb3V0ZXIucHVzaCgiL2JvdC9kYXNoYm9hcmQiKTsKCiAgICAgICAgICBfdGhpczIuJHJvb3QuJGVtaXQoImNoYW5nZV9zaWRlYmFyX21haW5fbWVudSIsICJEYXNoYm9hcmQiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNoZWNrX3JldGFpbF9wYXltZW50X3R5cGVfZGlzYWJsZWQ6IGZ1bmN0aW9uIGNoZWNrX3JldGFpbF9wYXltZW50X3R5cGVfZGlzYWJsZWQoKSB7CiAgICAgIGlmIChCb29sZWFuKHRoaXMucmV0YWlsX3BsYW5fY3VycmVudCkgJiYgdGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50LmlzX2NoYXJnZWFibGUgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICByZXRhaWxfcGF5bWVudF9wbGFjZWhvbGRlcjogZnVuY3Rpb24gcmV0YWlsX3BheW1lbnRfcGxhY2Vob2xkZXIoKSB7CiAgICAgIGlmICh0aGlzLmNoZWNrX3JldGFpbF9wYXltZW50X3R5cGVfZGlzYWJsZWQpIHsKICAgICAgICByZXR1cm4gdGhpcy50bHQoJ25vX2JpbGxpbmdfY3ljbGVfbXNnJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLnRsdCgncGlja19vbmVfbXNnJyk7CiAgICB9LAogICAgY3VycmVudF9yZXRhaWxfcGxhbl9jaGFyZ2VzOiBmdW5jdGlvbiBjdXJyZW50X3JldGFpbF9wbGFuX2NoYXJnZXMoKSB7CiAgICAgIC8vIGlmKHRoaXMucmV0YWlsX3Nob3BpZnlfY29tcGFueSkgewogICAgICByZXR1cm4gQm9vbGVhbih0aGlzLnJldGFpbF9wbGFuX2N1cnJlbnQpID8gdGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50LmlzX2NoYXJnZWFibGUgPyAiJCIuY29uY2F0KHRoaXMucmV0YWlsX3BsYW5fY3VycmVudC5tb250aGx5X2NoYXJnZSwgIi9tb250aCAgb3IgJCIpLmNvbmNhdCh0aGlzLnJldGFpbF9wbGFuX2N1cnJlbnQuYW5udWFsX2NoYXJnZS5wZXJfbW9udGhfZWZmZWN0aXZlLCAiL21vbnRoIGJpbGxlZCBhdCAkIikuY29uY2F0KHRoaXMucmV0YWlsX3BsYW5fY3VycmVudC5hbm51YWxfY2hhcmdlLmFjdHVhbF9jaGFyZ2UsICIgb25jZSBwZXIgeWVhciIpIDogbnVsbCA6IG51bGw7IC8vIH0gZWxzZSB7CiAgICAgIC8vICAgcmV0dXJuIEJvb2xlYW4odGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50KQogICAgICAvLyAgID8gdGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50LmlzX2NoYXJnZWFibGUKICAgICAgLy8gICAgID8gYCQke3RoaXMucmV0YWlsX3BsYW5fY3VycmVudC5tb250aGx5X2NoYXJnZX0vbW9udGhgCiAgICAgIC8vICAgICA6IG51bGwKICAgICAgLy8gICA6IG51bGw7CiAgICAgIC8vIH0KICAgIH0sCiAgICBjaGVja19yZXRhaWxfc2hvcGlmeV9mb3JtX3ZhbGlkYXRpb25zOiBmdW5jdGlvbiBjaGVja19yZXRhaWxfc2hvcGlmeV9mb3JtX3ZhbGlkYXRpb25zKCkgewogICAgICBpZiAodGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50ICE9PSBudWxsICYmIHRoaXMucmV0YWlsX3BheW1lbnRfdHlwZSAhPT0gbnVsbCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgaWYgKHRoaXMucmV0YWlsX3BsYW5fY3VycmVudCAhPT0gbnVsbCAmJiB0aGlzLnJldGFpbF9wYXltZW50X3R5cGUgPT0gbnVsbCAmJiB0aGlzLnJldGFpbF9wbGFuX2N1cnJlbnQuaXNfY2hhcmdlYWJsZSA9PT0gZmFsc2UpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIGZpcnN0X3N0ZXA6IGZ1bmN0aW9uIGZpcnN0X3N0ZXAoKSB7CiAgICAgIGlmICh0aGlzLnN0cmlwZV9zdWJzY3JpcHRpb25fcGxhbnMpIHsKICAgICAgICByZXR1cm4gdGhpcy5zdHJpcGVfc3Vic2NyaXB0aW9uX3BsYW5zLmZpbHRlcihmdW5jdGlvbiAocGxhbnMpIHsKICAgICAgICAgIHJldHVybiBwbGFucy5UeXBlICE9PSAnRnJlZSc7CiAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChwbGFucykgewogICAgICAgICAgcmV0dXJuIHBsYW5zLlR5cGU7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CiAgICB9LAogICAgcmV0YWlsX3Nob3BpZnlfc3Vic2NyaXB0aW9uX3BsYW5zX2N1c3RvbV9jdXJyZW5jeTogZnVuY3Rpb24gcmV0YWlsX3Nob3BpZnlfc3Vic2NyaXB0aW9uX3BsYW5zX2N1c3RvbV9jdXJyZW5jeSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5zdHJpcGVfc3Vic2NyaXB0aW9uX3BsYW5zX2RldGFpbHMuc3Vic2NyaXB0aW9uX3R5cGUgIT09ICdQcmVtaXVtJykgewogICAgICAgIHJldHVybiB0aGlzLnJldGFpbF9zaG9waWZ5X3N1YnNjcmlwdGlvbl9wbGFucy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmN1cnJlbmN5ID09PSBfdGhpczMuc2hvcF9iYXNlX2N1cnJlbmN5OwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLnJldGFpbF9zaG9waWZ5X3N1YnNjcmlwdGlvbl9wbGFucy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmN1cnJlbmN5ID09PSBfdGhpczMuc2hvcF9iYXNlX2N1cnJlbmN5ICYmIChpdGVtLm5hbWUgPT09ICJTdGFydGVyIiB8fCBpdGVtLm5hbWUgPT09ICJXaGF0c0FwcCIpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8gcmV0YWlsX3Nob3BpZnlfc3Vic2NyaXB0aW9uX3BsYW5zX2NoZWNrX2N1cnJlbnRwbGFuKCl7CiAgICAvLyAgIGlmKHRoaXMuc3RyaXBlX3N1YnNjcmlwdGlvbl9wbGFuc19kZXRhaWxzLnN1YnNjcmlwdGlvbl90eXBlICE9PSAnUHJlbWl1bScpewogICAgLy8gICAgIHJldHVybiB0aGlzLnJldGFpbF9zaG9waWZ5X3N1YnNjcmlwdGlvbl9wbGFucwogICAgLy8gICB9ZWxzZXsKICAgIC8vICAgICByZXR1cm4gdGhpcy5yZXRhaWxfc2hvcGlmeV9zdWJzY3JpcHRpb25fcGxhbnMuZmlsdGVyKChpdGVtKSA9PiAgaXRlbS5uYW1lID09PSAiU3RhcnRlciIpCiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICBzZWNvbmRfc3RlcDogZnVuY3Rpb24gc2Vjb25kX3N0ZXAoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIHRlbXAgPSBbXTsKCiAgICAgIGlmICh0aGlzLnN0cmlwZV9zdWJzY3JpcHRpb25fcGxhbnMgJiYgdGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50KSB7CiAgICAgICAgdGVtcCA9IHRoaXMuc3RyaXBlX3N1YnNjcmlwdGlvbl9wbGFucy5maWx0ZXIoZnVuY3Rpb24gKHBsYW5zKSB7CiAgICAgICAgICByZXR1cm4gcGxhbnMuVHlwZSA9PSBfdGhpczQucmV0YWlsX3BsYW5fY3VycmVudDsKICAgICAgICB9KTsKICAgICAgICB2YXIgc29ydGVkID0gdGVtcFswXS5QcmljZU9wdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChhYmMpIHsKICAgICAgICAgIHJldHVybiBhYmMuY3VycmVuY3kgPT09IF90aGlzNC5zaG9wX2Jhc2VfY3VycmVuY3k7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHNvcnRlZDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRlbXA7CiAgICB9LAogICAgZmlyc3Rfc3RlcF9hZGRvbl9wbGFuczogZnVuY3Rpb24gZmlyc3Rfc3RlcF9hZGRvbl9wbGFucygpIHsKICAgICAgaWYgKHRoaXMuc3RyaXBlX2FkZG9uX3BsYW5zKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc3RyaXBlX2FkZG9uX3BsYW5zLm1hcChmdW5jdGlvbiAocGxhbnMpIHsKICAgICAgICAgIHJldHVybiBwbGFucy5UeXBlOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2Vjb25kX3N0ZXBfYWRkb25fcGxhbnM6IGZ1bmN0aW9uIHNlY29uZF9zdGVwX2FkZG9uX3BsYW5zKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIC8vIGNvbnNvbGUubG9nKCJzZWxlY3RlZF9hZGRvbl9wbGFuIix0aGlzLnNlbGVjdGVkX2FkZG9uX3BsYW4pOwogICAgICBpZiAodGhpcy5zZWxlY3RlZF9hZGRvbl9wbGFuKSB7CiAgICAgICAgdmFyIGNoZWNrID0gdGhpcy5zZWxlY3RlZF9hZGRvbl9wbGFuWydQcmljZU9wdGlvbnMnXS5maWx0ZXIoZnVuY3Rpb24gKHBsYW4pIHsKICAgICAgICAgIHJldHVybiBwbGFuLmN1cnJlbmN5ID09IF90aGlzNS5zaG9wX2Jhc2VfY3VycmVuY3k7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGNoZWNrOwogICAgICB9CgogICAgICByZXR1cm4gW107CiAgICB9LAogICAgcmV0YWlsX3BheW1lbnRfdHlwZXM6IGZ1bmN0aW9uIHJldGFpbF9wYXltZW50X3R5cGVzKCkgewogICAgICBpZiAodGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50ID09IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5wYXltZW50X3R5cGVzOwogICAgICB9IGVsc2UgaWYgKHRoaXMucmV0YWlsX3BsYW5fY3VycmVudC5uYW1lID09IHRoaXMuc3RyaXBlX3N1YnNjcmlwdGlvbl9wbGFuc19kZXRhaWxzLnN1YnNjcmlwdGlvbl90eXBlKSB7CiAgICAgICAgdmFyIHN1Yl90eXBlID0gdGhpcy5zdHJpcGVfc3Vic2NyaXB0aW9uX3BsYW5zX2RldGFpbHMuc3Vic2NyaXB0aW9uX3BlcmlvZCA9PSAnWWVhcmx5JyA/ICdBbm51YWwnIDogJ01vbnRobHknOwogICAgICAgIHJldHVybiB0aGlzLnBheW1lbnRfdHlwZXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gaXRlbSAhPSBzdWJfdHlwZTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnJldGFpbF9wbGFuX2N1cnJlbnQubmFtZSA9PSAnV2hhdHNBcHAnKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucGF5bWVudF90eXBlcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtICE9ICdBbm51YWwnOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLnBheW1lbnRfdHlwZXM7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIG5hbWVXaXRoTGFuZyAoeyB0eXBlLCBjb3VudCB9KSB7CiAgICAvLyAgIHJldHVybiBgJHt0eXBlfSAke3RoaXMuc2VsZWN0ZWRfYWRkb25fcGxhbi5TZXJ2aWNlfVske2NvdW50fV1gCiAgICAvLyB9LAogICAgLy8gbmFtZXdpdGhQcmljZSh7bmFtZSxQcmljZX0pewogICAgLy8gICByZXR1cm4gYCR7bmFtZX0gKCQke1ByaWNlfSlgCiAgICAvLyB9LAogICAgc2hvd19zd2FsX25vdGlmaWNhdGlvbjogZnVuY3Rpb24gc2hvd19zd2FsX25vdGlmaWNhdGlvbigpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICBTd2FsLmZpcmUoewogICAgICAgIHRpdGxlOiB0aGlzLnRsdCgnYmlsbGluZ19zd2FsX2FsZXJ0X21zZycpLAogICAgICAgIHRleHQ6IHRoaXMudGx0KCdiaWxsaW5nX3Vuc3Vic2NyaWJlX3BsYW5fbXNnJyksCiAgICAgICAgaWNvbjogJ3dhcm5pbmcnLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAnIzMwODVkNicsCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICcjZDMzJywKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ2JpbGxpbmdfc3dhbF95ZXNfYnRuJykKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSA9PSB0cnVlKSB7CiAgICAgICAgICBfdGhpczYudXBkYXRlX3N1YnNjcmlwdGlvbl9wbGFuX2ZyZWUoKTsKCiAgICAgICAgICBTd2FsLmZpcmUoX3RoaXM2LnRsdCgnYmlsbGluZ19zd2FsX3Vuc3Vic2NyaWJlZF9tc2cnKSwgX3RoaXM2LnRsdCgnYmlsbGluZ19zdWJzY3JpYmVfY2FuY2VsX21zZycpLCAnc3VjY2VzcycpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZ2V0X3N1YnNjcmlwdGlvbl92YWxpZF90aWxsOiBmdW5jdGlvbiBnZXRfc3Vic2NyaXB0aW9uX3ZhbGlkX3RpbGwoc3ViX2RhdGUpIHsKICAgICAgcmV0dXJuIG1vbWVudC51dGMoc3ViX2RhdGUpLmZvcm1hdCgiRG8gTU1NTSBZWVlZIik7CiAgICB9LAogICAgdXBkYXRlX3N1YnNjcmlwdGlvbl9wbGFuX2ZyZWU6IGZ1bmN0aW9uIHVwZGF0ZV9zdWJzY3JpcHRpb25fcGxhbl9mcmVlKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnN0cmlwZV9wYXltZW50X2dhdGV3YXkoKSwgewogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICB1bnN1YnNjcmliZV9wbGFuOiB0cnVlLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczcuYXBpX3N0YXR1c19jb2RlLkRBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICB2YXIgbWVzc2FnZSA9IHJlc3BvbnNlLmRhdGEuZGF0YS5Vc2VyTWVudTsKCiAgICAgICAgICBfdGhpczcudXBkYXRlX3NpZGViYXJfbWVudShtZXNzYWdlKTsKCiAgICAgICAgICBfdGhpczcuJHJvb3QuJGVtaXQoIlNpZGVCYXJNZW51VXBkYXRlZCIsIHRydWUpOyAvLyAgY29uc29sZS5sb2coInVwZGF0ZSBzdWNjZXNzZnVsbHkiKQoKCiAgICAgICAgICBfdGhpczcudXBkYXRlX3Jlc3RyaWN0aW9uX2xpc3QocmVzcG9uc2UuZGF0YS5kYXRhLlJlc3RyaWN0aW9uTGlzdCwgcmVzcG9uc2UuZGF0YS5kYXRhLlN1YnNjcmliZWRQbGFuKTsKCiAgICAgICAgICBfdGhpczcuZ2V0X2N1cnJlbnRfc3Vic2NyaXB0aW9uX2RldGFpbHMoKTsKCiAgICAgICAgICBfdGhpczcuJHJvdXRlci5wdXNoKCIvYm90L3N1YnNjcmlwdGlvbi1yZW5ld2FsIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAvLyB0aXRsZTogdGhpcy50bHQoJ2JpbGxpbmdfZXJyb3Jfb2NjdXJyZWRfbXNnOScpLAogICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXM3LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZ2V0X3BsYW5zX2Zyb21fZGI6IGZ1bmN0aW9uIGdldF9wbGFuc19mcm9tX2RiKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3RyaXBlX3BheW1lbnRfZ2F0ZXdheSgpLCB7CiAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIGdldF9wbGFuc19mcm9tX2RiOiB0cnVlCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gX3RoaXM4LmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXM4LnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgX3RoaXM4LnN0cmlwZV9zdWJzY3JpcHRpb25fcGxhbnMgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICBfdGhpczguc2hvd19zdWJzY3JpcHRpb24gPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczguc3RyaXBlX3N1YnNjcmlwdGlvbl9wbGFuc19kZXRhaWxzID0gW107CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzOC5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6IF90aGlzOC50bHQoJ2JpbGxpbmdfZXJyb3Jfb2NjdXJyZWRfbXNnMicpLAogICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRfY3VycmVudF9zdWJzY3JpcHRpb25fZGV0YWlsczogZnVuY3Rpb24gZ2V0X2N1cnJlbnRfc3Vic2NyaXB0aW9uX2RldGFpbHMoKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5zdHJpcGVfcGF5bWVudF9nYXRld2F5KCksIHsKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgZ2V0X2FjdGl2ZV9wbGFuOiB0cnVlCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gX3RoaXM5LmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgX3RoaXM5LnN0cmlwZV9zdWJzY3JpcHRpb25fcGxhbnNfZGV0YWlscyA9IHJlc3BvbnNlLmRhdGEuZGF0YS5EYXRhLmN1cnJlbnRfc3Vic2NyaXB0aW9uOwogICAgICAgICAgX3RoaXM5LmhpZGVfYnV0dG9uID0gcmVzcG9uc2UuZGF0YS5kYXRhLkRhdGEuY3VycmVudF9zdWJzY3JpcHRpb24uc3Vic2NyaXB0aW9uX3R5cGU7CiAgICAgICAgICBfdGhpczkuc2hvd19zdWJzY3JpcHRpb24gPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczkuc3RyaXBlX3N1YnNjcmlwdGlvbl9wbGFuc19kZXRhaWxzID0gW107CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgY29uc29sZS5sb2coZSwgJ2VlZScpOwogICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogX3RoaXM5LnRsdCgnYmlsbGluZ19lcnJvcl9vY2N1cnJlZF9tc2cyJyksCiAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIGdldF9jdXJyZW50X3N1YnNjcmlwdGlvbigpIHsKICAgIC8vICAgYXhpb3MKICAgIC8vICAgICAucG9zdChhcGlfY2FsbHMucmF6b3JwYXlfY29tbXVuY2F0aW9uKCksIHsKICAgIC8vICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgLy8gICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgLy8gICAgICAgaXNfZ2V0OiB0cnVlLAogICAgLy8gICAgIH0pCiAgICAvLyAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAvLyAgICAgICAvLyBjb25zb2xlLmxvZygiQ1VSUkVOVCBQTEFOIERFVEFJTFMiLHJlc3BvbnNlKTsKICAgIC8vICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09IG51bGwpIHsKICAgIC8vICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25fYnRuX2Rpc2FibGUgPSB0cnVlOwogICAgLy8gICAgICAgICBTd2FsKHsKICAgIC8vICAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ2JpbGxpbmdfbm9fYWN0aXZlX3N1YnNjcmlwdGlvbl9tc2cxJyksCiAgICAvLyAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgIC8vICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgIC8vICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgdGltZXI6IDIwMDAsCiAgICAvLyAgICAgICAgIH0pOwogICAgLy8gICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLk1TRyA9PSAiQ3VycmVudCBTdWJzY3JpcHRpb24gUGxhbiIpIHsKICAgIC8vICAgICAgICAgdGhpcy5zZWxlY3RlZF9zdWJzY3JpcHRpb24gPQogICAgLy8gICAgICAgICAgIHJlc3BvbnNlLmRhdGEuc3Vic2NyaXB0aW9uLnN1YnNjcmlwdGlvbl90eXBlOwogICAgLy8gICAgICAgICB0aGlzLnNlbGVjdGVkX3BlcmlvZCA9IHJlc3BvbnNlLmRhdGEuc3Vic2NyaXB0aW9uLnBlcmlvZDsKICAgIC8vICAgICAgICAgdGhpcy5jdXN0b21lcl9pZCA9IHJlc3BvbnNlLmRhdGEuY3VzdG9tZXJfaWQ7CiAgICAvLyAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uX2J0bl9kaXNhYmxlID0gZmFsc2U7CiAgICAvLyAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJObyBBY3RpdmUgU3Vic2NyaXB0aW9uIHBsYW4gZm91bmQiKSB7CiAgICAvLyAgICAgICAgIHRoaXMuY3VzdG9tZXJfaWQgPSByZXNwb25zZS5kYXRhLmN1c3RvbWVyX2lkOwogICAgLy8gICAgICAgICBTd2FsKHsKICAgIC8vICAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ2JpbGxpbmdfbm9fYWN0aXZlX3N1YnNjcmlwdGlvbl9tc2cyJyksCiAgICAvLyAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgLy8gICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgLy8gICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICB0aW1lcjogMjAwMCwKICAgIC8vICAgICAgICAgfSk7CiAgICAvLyAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uX2J0bl9kaXNhYmxlID0gdHJ1ZTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgICB9KQogICAgLy8gICAgIC5jYXRjaCgoZSkgPT4gewogICAgLy8gICAgICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgIC8vICAgICAgIGlmICgKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICkgewogICAgLy8gICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0pOwogICAgLy8gfSwKICAgIGNoZWNrX2FkZG9uc19iYWxhbmNlOiBmdW5jdGlvbiBjaGVja19hZGRvbnNfYmFsYW5jZSgpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5jaGVja19hZGRvbnNfYmFsYW5jZSgpLCB7CiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGNoZWNrX2JhbGFuY2U6IHRydWUKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICBfdGhpczEwLnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczEwLmFwaV9zdGF0dXNfY29kZS5DSEVDS19CQUxBTkNFLk1TR19DT0RFKSB7CiAgICAgICAgICBpZiAoQm9vbGVhbihyZXNwb25zZS5kYXRhLmRhdGEuY3JlZGl0cy5zbXNfY291bnQpID09IHRydWUpIHsKICAgICAgICAgICAgdmFyIHNtc19jb3VudCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5jcmVkaXRzLnNtc19jb3VudDsKICAgICAgICAgICAgX3RoaXMxMC5jcmVkaXRzX2JhbGFuY2UgPSBzbXNfY291bnQ7IC8vIHRoaXMuY3JlZGl0c19iYWxhbmNlID0gdGhpcy50bHQoJ2N1cnJlbnRfc21zX2NyZWRpdF90ZXh0JykgKyAiPHN0cm9uZz4gIisgdGhpcy50bHQoJ2N1cnJlbnRfc21zX2NyZWRpdF90ZXh0MicpICsgIjogIiArIHNtc19jb3VudC51cyArICIgfCAiICsgdGhpcy50bHQoJ2N1cnJlbnRfc21zX2NyZWRpdF90ZXh0MycpICsgIjogIiArIHNtc19jb3VudC5ub25fdXMgKyAiPC9zdHJvbmc+IgogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMTAuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXMxMC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdldF9hZGRvbl9kZXRhaWxzOiBmdW5jdGlvbiBnZXRfYWRkb25fZGV0YWlscygpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3RyaXBlX3BheW1lbnRfZ2F0ZXdheSgpLCB7CiAgICAgICAgZ2V0X2FkZF9vbnM6IHRydWUKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczExLmFwaV9zdGF0dXNfY29kZS5OT19BRERfT05TX0ZPVU5ELk1TR19DT0RFKSB7CiAgICAgICAgICBfdGhpczExLnN0cmlwZV9hZGRvbl9wbGFucyA9IFtdOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczExLmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSkgewogICAgICAgICAgaWYgKEJvb2xlYW4ocmVzcG9uc2UuZGF0YS5kYXRhKSAhPSBmYWxzZSkgewogICAgICAgICAgICBfdGhpczExLnN0cmlwZV9hZGRvbl9wbGFucyA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiBfdGhpczExLnRsdCgnYmlsbGluZ19lcnJvcl9vY2N1cnJlZF9tc2czJyksCiAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIGdldF9zdWJzY3JpcHRpb25fZGV0YWlscygpIHsKICAgIC8vICAgYXhpb3MKICAgIC8vICAgICAucG9zdChhcGlfY2FsbHMuc3RyaXBlX3BheW1lbnRfZ2F0ZXdheSgpLCB7CiAgICAvLyAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgIC8vICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgIC8vICAgICAgIGdldF9wbGFuczogdHJ1ZSwKICAgIC8vICAgICB9KQogICAgLy8gICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgLy8gICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgICBpZiAoCiAgICAvLyAgICAgICAgIHJlc3BvbnNlLmRhdGEuU3RhdHVzID09PSAiU3VjY2VzcyIgJiYKICAgIC8vICAgICAgICAgcmVzcG9uc2UuZGF0YS5EYXRhLmRhdGEubGVuZ3RoID4gMAogICAgLy8gICAgICAgKSB7CiAgICAvLyAgICAgICAgIHRoaXMuc3RyaXBlX3N1YnNjcmlwdGlvbl9wbGFucyA9IHJlc3BvbnNlLmRhdGEuRGF0YS5kYXRhOwogICAgLy8gICAgICAgfSBlbHNlIHsKICAgIC8vICAgICAgICAgdGhpcy5zdHJpcGVfc3Vic2NyaXB0aW9uX3BsYW5zID0gW107CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSkKICAgIC8vICAgICAuY2F0Y2goKGUpID0+IHsKICAgIC8vICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgLy8gICAgICAgU3dhbC5maXJlKHsKICAgIC8vICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdiaWxsaW5nX2Vycm9yX29jY3VycmVkX21zZzQnKSwKICAgIC8vICAgICAgICAgdHlwZTogImVycm9yIiwKICAgIC8vICAgICAgIH0pOwogICAgLy8gICAgIH0pOwogICAgLy8gfSwKICAgIGNhbmNlbF9zdWJzY3JpcHRpb246IGZ1bmN0aW9uIGNhbmNlbF9zdWJzY3JpcHRpb24oKSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnJhem9ycGF5X2NvbW11bmNhdGlvbigpLCB7CiAgICAgICAgaXNfY2FuY2VsOiB0cnVlLAogICAgICAgIHN1YnNjcmlwdGlvbl9pZDogdGhpcy5zdWJzY3JpcHRpb25faWQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczEyLmFwaV9zdGF0dXNfY29kZS5TVUJTQ1JJUFRJT05fQ0FOQ0VMX1NVQ0NFU1MuTVNHX0NPREUpIHsKICAgICAgICAgIF90aGlzMTIuc3Vic2NyaXB0aW9uX2J0bl9kaXNhYmxlID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiBfdGhpczEyLnRsdCgnYmlsbGluZ19pbnRlcm5hbF9zZXJ2ZXJfbXNnMScpLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiAyMDAwCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXMxMi5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczEyLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY3JlYXRlX2N1c3RvbWVyOiBmdW5jdGlvbiBjcmVhdGVfY3VzdG9tZXIoKSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnNlbGVjdGVkX3N1YnNjcmlwdGlvbiA9PSAiIiB8fCB0aGlzLnNlbGVjdGVkX3BlcmlvZCA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdHlwZTogImluZm8iLAogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2JpbGxpbmdfc3Vic2NyaWJlX3BsYW5fcGVyaW9kX21zZycpLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBlcmlvZCA9IHRoaXMuc2VsZWN0ZWRfcGVyaW9kLnRvTG93ZXJDYXNlKCk7CgogICAgICBmb3IgKHZhciBpIGluIHRoaXMuc3Vic2NyaXB0aW9uX3BsYW5zKSB7CiAgICAgICAgaWYgKHBlcmlvZCA9PSB0aGlzLnN1YnNjcmlwdGlvbl9wbGFuc1tpXS5wZXJpb2QpIHsKICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkX3N1YnNjcmlwdGlvbiA9PSB0aGlzLnN1YnNjcmlwdGlvbl9wbGFuc1tpXS5pdGVtLm5hbWUpIHsKICAgICAgICAgICAgdGhpcy5wbGFuX2lkID0gdGhpcy5zdWJzY3JpcHRpb25fcGxhbnNbaV0uaWQ7IC8vIGNvbnNvbGUubG9nKCJQTEFOIE5BTUU6IiwgdGhpcy5zdWJzY3JpcHRpb25fcGxhbnNbaV0uaXRlbS5uYW1lKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIlBMQU4gSUQ6IiwgdGhpcy5zdWJzY3JpcHRpb25fcGxhbnNbaV0uaWQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMucGxhbl9pZCA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdiaWxsaW5nX3BsYW5fbm90X2ZvdW5kX21zZycpLAogICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdiaWxsaW5nX2NvbnRhY3RfY2Vuc2VfYWRtaW5fbXNnJyksCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuY3VzdG9tZXJfaWQgPT0gIiIpIHsKICAgICAgICB2YXIgY3VzdF9kYXRhID0gewogICAgICAgICAgbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbnRhY3Q6ICIiLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIG5vdGVzOiB7CiAgICAgICAgICAgIEV4dHJhOiAiRGV0YWlscyByZWxhdGVkIHRvIGN1c3RvbWVyIgogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMucmF6b3JwYXlfY29tbXVuY2F0aW9uKCksIHsKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgY3JlYXRlX2N1c3RvbWVyX2lkOiB0cnVlLAogICAgICAgICAgZGF0YTogY3VzdF9kYXRhCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChkYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzMTMuYXBpX3N0YXR1c19jb2RlLlNUQVRVU19TVUNDRVNTLk1TR19DT0RFKSB7CiAgICAgICAgICAgIHZhciBjdXN0b21lcl9kZXRhaWwgPSByZXNwb25zZS5kYXRhLmRhdGEuQ3VzdG9tZXJfRGV0YWlsOwogICAgICAgICAgICBfdGhpczEzLmN1c3RvbWVyX2lkID0gcmVzcG9uc2UuZGF0YS5kYXRhLkN1c3RvbWVyX0RldGFpbC5pZDsgLy8gY29uc29sZS5sb2coImN1c3RvbWVyIGlkIix0aGlzLmN1c3RvbWVyX2lkKTsKCiAgICAgICAgICAgIF90aGlzMTMuY3JlYXRlX3N1YnNjcmlwdGlvbihfdGhpczEzLnBsYW5faWQsIF90aGlzMTMuY3VzdG9tZXJfaWQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6IF90aGlzMTMudGx0KCdiaWxsaW5nX2ludGVybmFsX3NlcnZlcl9tc2cyJyksCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0ZXh0OiBfdGhpczEzLnRsdCgnYmlsbGluZ19lcnJvcl9jcmVhdGluZ19jdXN0X2lkX21zZycpLAogICAgICAgICAgICAgIHRpbWVyOiAyMDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXMxMy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNyZWF0ZV9zdWJzY3JpcHRpb24odGhpcy5wbGFuX2lkLCB0aGlzLmN1c3RvbWVyX2lkKTsKICAgICAgfQogICAgfSwKICAgIGNyZWF0ZV9zdWJzY3JpcHRpb246IGZ1bmN0aW9uIGNyZWF0ZV9zdWJzY3JpcHRpb24ocGxhbl9pZCwgY3VzdG9tZXJfaWQpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgICAgdmFyIHN1Yl9kYXRhID0gewogICAgICAgIHBsYW5faWQ6IHBsYW5faWQsCiAgICAgICAgY3VzdG9tZXJfaWQ6IGN1c3RvbWVyX2lkCiAgICAgIH07CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnJhem9ycGF5X2NvbW11bmNhdGlvbigpLCB7CiAgICAgICAgY3JlYXRlX3N1YnNjcmlwdGlvbjogdHJ1ZSwKICAgICAgICBkYXRhOiBzdWJfZGF0YQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzMTQuYXBpX3N0YXR1c19jb2RlLlNUQVRVU19TVUNDRVNTLk1TR19DT0RFKSB7CiAgICAgICAgICBfdGhpczE0LnN1YnNjcmlwdGlvbl9pZCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5TdWJzY3JpcHRpb25fRGV0YWlsLmlkOyAvLyBjb25zb2xlLmxvZygiU3Vic2NyaXB0aW9uIGlkIiwgcmVzcG9uc2UpOwoKICAgICAgICAgIF90aGlzMTQuc3RhcnRfcGF5bWVudChfdGhpczE0LnN1YnNjcmlwdGlvbl9pZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogX3RoaXMxNC50bHQoJ2JpbGxpbmdfaW50ZXJuYWxfc2VydmVyX21zZzMnKSwKICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgdGV4dDogX3RoaXMxNC50bHQoJ2JpbGxpbmdfZXJyb3JfY3JlYXRpbmdfc3Vic2NyaXB0aW9uX21zZycpLAogICAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXMxNC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHN0YXJ0X3BheW1lbnQ6IGZ1bmN0aW9uIHN0YXJ0X3BheW1lbnQoc3Vic2NyaXB0aW9uX2lkKSB7CiAgICAgIHZhciB2bSA9IHRoaXM7IC8vIHN0YXJ0X3BheW1lbnQoKXsKICAgICAgLy8gICB2YXIgdm0gPSB0aGlzOwogICAgICAvLyAgIHZhciBkYXRhID0gewogICAgICAvLyAgICAgb3JkZXJfYW1vdW50OiA1MDAwMCwKICAgICAgLy8gICAgIG9yZGVyX2N1cnJlbmN5OiAnSU5SJywKICAgICAgLy8gICAgIG9yZGVyX3JlY2VpcHQ6ICdvcmRlcl9yY3B0aWRfMTEnLAogICAgICAvLyAgICAgcGF5bWVudF9jYXB0dXJlOiAxLAogICAgICAvLyAgICAgbm90ZXM6IHsnU2hpcHBpbmcgYWRkcmVzcyc6ICdCb21tYW5haGFsbGksIEJhbmdhbG9yZSd9CiAgICAgIC8vICAgfQogICAgICAvLyAgIGF4aW9zLgogICAgICAvLyAgICAgcG9zdCgKICAgICAgLy8gICAgICAgYXBpX2NhbGxzLnJhem9ycGF5X2NvbW11bmNhdGlvbigpLAogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgZ2VuZXJhdGVfb3JkZXJfaWQ6IHRydWUsCiAgICAgIC8vICAgICAgICAgZGF0YTogZGF0YQogICAgICAvLyAgICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAvLyAgICAgICBpZihyZXNwb25zZS5kYXRhLk1TRyA9PSAiT3JkZXIgSUQgY3JlYXRlZCIpewogICAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEuT3JkZXJfRGV0YWlsKTsKICAgICAgLy8gICAgICAgICB2bS5vcmRlcl9pZCA9IHJlc3BvbnNlLmRhdGEuT3JkZXJfRGV0YWlsLmlkOwogICAgICAvLyAgICAgICAgIHZtLmFtb3VudCA9IHJlc3BvbnNlLmRhdGEuT3JkZXJfRGV0YWlsLmFtb3VudDsKICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZygicmVhY2hlZCIpOwoKICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAga2V5OiBwcm9jZXNzLmVudi5WVUVfQVBQX1JBWk9SUEFZX0tFWSwKICAgICAgICAvLyBFbnRlciB0aGUgS2V5IElEIGdlbmVyYXRlZCBmcm9tIHRoZSBEYXNoYm9hcmQKICAgICAgICBzdWJzY3JpcHRpb25faWQ6IHN1YnNjcmlwdGlvbl9pZCwKICAgICAgICAvLyBZb3UgZG9udCBuZWVkIGFtb3VudC9jdXJyZW5jeS9vcmRlcl9pZCB3aGVuIHN1Ym1pdHRpbmcgc3Vic2NyaXB0aW9uIGlkCiAgICAgICAgLy8gImFtb3VudCI6IHRoaXMuYW1vdW50LCAvLyBBbW91bnQgaXMgaW4gY3VycmVuY3kgc3VidW5pdHMuIERlZmF1bHQgY3VycmVuY3kgaXMgSU5SLiBIZW5jZSwgNTAwMDAgcmVmZXJzIHRvIDUwMDAwIHBhaXNlCiAgICAgICAgLy8gImN1cnJlbmN5IjogIklOUiIsCiAgICAgICAgbmFtZTogIkNlbnNlIEFJIiwKICAgICAgICBkZXNjcmlwdGlvbjogIlRlc3QgVHJhbnNhY3Rpb24iLAogICAgICAgIGltYWdlOiByZXF1aXJlKCJAL3BvcnRhbC9hc3NldHMvaW1nL2NlbnNlX2xvZ28ucG5nIiksCiAgICAgICAgLy8gIm9yZGVyX2lkIjogdGhpcy5vcmRlcl9pZCwgLy9UaGlzIGlzIGEgc2FtcGxlIE9yZGVyIElELiBQYXNzIHRoZSBgaWRgIG9idGFpbmVkIGluIHRoZSByZXNwb25zZSBvZiBTdGVwIDEKICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKHJlc3BvbnNlKSB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygiRklOQUwgUEFZIiwgcmVzcG9uc2UpOwogICAgICAgICAgdmFyIHJhem9ycGF5X3BheW1lbnRfaWQgPSByZXNwb25zZS5yYXpvcnBheV9wYXltZW50X2lkOyAvLyB2YXIgcmF6b3JwYXlfb3JkZXJfaWQgPSByZXNwb25zZS5yYXpvcnBheV9vcmRlcl9pZDsKCiAgICAgICAgICB2YXIgcmF6b3JwYXlfc3Vic2NyaXB0aW9uX2lkID0gcmVzcG9uc2UucmF6b3JwYXlfc3Vic2NyaXB0aW9uX2lkOwogICAgICAgICAgdmFyIHJhem9ycGF5X3NpZ25hdHVyZSA9IHJlc3BvbnNlLnJhem9ycGF5X3NpZ25hdHVyZTsKICAgICAgICAgIHZtLnBheV9zdWNjZXNzX2RhdGEgPSB7fTsKICAgICAgICAgIHZtLnBheV9zdWNjZXNzX2RhdGEgPSB7CiAgICAgICAgICAgIHJhem9ycGF5X3BheW1lbnRfaWQ6IHJhem9ycGF5X3BheW1lbnRfaWQsCiAgICAgICAgICAgIC8vIHJhem9ycGF5X29yZGVyX2lkOiByYXpvcnBheV9vcmRlcl9pZCwKICAgICAgICAgICAgcmF6b3JwYXlfc3Vic2NyaXB0aW9uX2lkOiByYXpvcnBheV9zdWJzY3JpcHRpb25faWQsCiAgICAgICAgICAgIHJhem9ycGF5X3NpZ25hdHVyZTogcmF6b3JwYXlfc2lnbmF0dXJlLAogICAgICAgICAgICByYXpvcnBheV9jdXN0b21lcl9pZDogdm0uY3VzdG9tZXJfaWQsCiAgICAgICAgICAgIC8vIG9yZGVyX2lkOiB0aGlzLm9yZGVyX2lkLAogICAgICAgICAgICBzdWJzY3JpcHRpb25fc3RhdHVzOiAiYWN0aXZlIiwKICAgICAgICAgICAgc3Vic2NyaXB0aW9uX2lkOiB2bS5zdWJzY3JpcHRpb25faWQsCiAgICAgICAgICAgIHBsYW5faWQ6IHZtLnBsYW5faWQsCiAgICAgICAgICAgIHN1YnNjcmlwdGlvbl90eXBlOiB2bS5zZWxlY3RlZF9zdWJzY3JpcHRpb24sCiAgICAgICAgICAgIHN1YnNjcmlwdGlvbl9wZXJpb2Q6IHZtLnNlbGVjdGVkX3BlcmlvZAogICAgICAgICAgfTsgLy8gY29uc29sZS5sb2coIlBBWU1FTlQgU1VDQ0VTUyBEQVRBIix2bS5wYXlfc3VjY2Vzc19kYXRhKTsKCiAgICAgICAgICBpZiAoT2JqZWN0LmtleXModm0ucGF5X3N1Y2Nlc3NfZGF0YSkubGVuZ3RoICE9IDApIHsKICAgICAgICAgICAgdm0uYWRkX2RldGFpbHNfdG9fc2VydmVyKHZtLnBheV9zdWNjZXNzX2RhdGEpOwogICAgICAgICAgfSBlbHNlIHsvLyBjb25zb2xlLmxvZygiVHJhbnNhY3Rpb24gZGlkIG5vdCBzdWNjZWVkIik7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAvLyAicHJlZmlsbCI6IHsKICAgICAgICAvLyAgICAgIm5hbWUiOiAiR2F1cmF2IEt1bWFyIiwKICAgICAgICAvLyAgICAgImVtYWlsIjogImdhdXJhdi5rdW1hckBleGFtcGxlLmNvbSIsCiAgICAgICAgLy8gICAgICJjb250YWN0IjogIis5MTk4NzY1NDMyMTAiCiAgICAgICAgLy8gfSwKICAgICAgICBub3RlczogewogICAgICAgICAgYWRkcmVzczogIlJhem9ycGF5IENvcnBvcmF0ZSBPZmZpY2UiCiAgICAgICAgfSwKICAgICAgICB0aGVtZTogewogICAgICAgICAgY29sb3I6ICIjMzM5OWNjIgogICAgICAgIH0KICAgICAgfTsKICAgICAgdmFyIHJ6cDEgPSBuZXcgUmF6b3JwYXkob3B0aW9ucyk7CiAgICAgIHJ6cDEub24oInBheW1lbnQuZmFpbGVkIiwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coImVycm9yIiwgcmVzcG9uc2UpOwogICAgICAgIGFsZXJ0KHJlc3BvbnNlLmVycm9yLmNvZGUpOwogICAgICAgIGFsZXJ0KHJlc3BvbnNlLmVycm9yLmRlc2NyaXB0aW9uKTsKICAgICAgICBhbGVydChyZXNwb25zZS5lcnJvci5zb3VyY2UpOwogICAgICAgIGFsZXJ0KHJlc3BvbnNlLmVycm9yLnN0ZXApOwogICAgICAgIGFsZXJ0KHJlc3BvbnNlLmVycm9yLnJlYXNvbik7CiAgICAgICAgYWxlcnQocmVzcG9uc2UuZXJyb3IubWV0YWRhdGEub3JkZXJfaWQpOwogICAgICAgIGFsZXJ0KHJlc3BvbnNlLmVycm9yLm1ldGFkYXRhLnBheW1lbnRfaWQpOwogICAgICB9KTsKICAgICAgcnpwMS5vcGVuKCk7IC8vIH0KICAgICAgLy8gfSkKICAgICAgLy8gLmNhdGNoKChlKSA9PiB7CiAgICAgIC8vICAgdGhpcy5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgLy8gICAgIGlmICgKICAgICAgLy8gICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAvLyAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAgIC8vICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgICAgLy8gICAgICkgewogICAgICAvLyAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAvLyAgICAgfQogICAgICAvLyAgIH0pOwogICAgfSwKICAgIGFkZF9kZXRhaWxzX3RvX3NlcnZlcjogZnVuY3Rpb24gYWRkX2RldGFpbHNfdG9fc2VydmVyKGRhdGEpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgaWYgKGRhdGEgIT0gbnVsbCkgewogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnJhem9ycGF5X2NvbW11bmNhdGlvbigpLCB7CiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIHZlcmlmeV9zdWJzY3JpcHRpb246IHRydWUsCiAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzMTUuYXBpX3N0YXR1c19jb2RlLlNVQlNDUklQVElPTl9WRVJJRklDQVRJT05fU1VDQ0VTUy5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogX3RoaXMxNS50bHQoJ2JpbGxpbmdfc3Vic2NyaXB0aW9uX3JlZ2lzdGVyX21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX3RoaXMxNS5wYXlfc3VjY2Vzc19kYXRhID0ge307CiAgICAgICAgICAgIF90aGlzMTUuc3Vic2NyaXB0aW9uX2J0bl9kaXNhYmxlID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogX3RoaXMxNS50bHQoJ2JpbGxpbmdfaW50ZXJuYWxfc2VydmVyX21zZzQnKSwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRleHQ6IF90aGlzMTUudGx0KCdiaWxsaW5nX2Vycm9yX29jY3VyX3N1YnNjcmlwdGlvbl9tc2cnKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX3RoaXMxNS5wYXlfc3VjY2Vzc19kYXRhID0ge307CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICBfdGhpczE1LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8gdG9nZ2xlX2NoYW5nZSh2YWx1ZSkgewogICAgLy8gICBpZiAodmFsdWUgPT0gIklOUiIpIHsKICAgIC8vICAgICB0aGlzLmNvbW1vbl9jdXJyZW5jeSA9IHRoaXMuSU5SOwogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIHRoaXMuY29tbW9uX2N1cnJlbmN5ID0gdGhpcy5VU0Q7CiAgICAvLyAgIH0KICAgIC8vICAgaWYgKHZhbHVlID09ICJJTlIiKSB7CiAgICAvLyAgICAgdGhpcy5jb21tb25fY3VycmVuY3kyID0gdGhpcy5JTlIyOwogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIHRoaXMuY29tbW9uX2N1cnJlbmN5MiA9IHRoaXMuVVNEMjsKICAgIC8vICAgfQogICAgLy8gfSwKICAgIGRvd25sb2FkX2ludm9pY2U6IGZ1bmN0aW9uIGRvd25sb2FkX2ludm9pY2UobnVtKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MoewogICAgICAgIG1ldGhvZDogInBvc3QiLAogICAgICAgIHVybDogYXBpX2NhbGxzLmJpbGxpbmdfaW52b2ljZSgpLAogICAgICAgIHJlc3BvbnNlVHlwZTogImJsb2IiLAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIGRvd25sb2FkX2ZpbGU6IHRydWUsCiAgICAgICAgICBmaWxlX25hbWU6IHRoaXMuaW52b2ljZV9kZXRhaWxzW251bV0KICAgICAgICB9LAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzMTYuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzMTYuYXBpX3N0YXR1c19jb2RlLklOVEVSTkFMX1NFUlZFUl9FUlJPUi5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXMxNi5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIHRvYXN0ci5lcnJvcihfdGhpczE2LnRsdCgnYmlsbGluZ19kb3dubG9hZF9pbnZvaWNlX21zZycpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMxNi5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbcmVzcG9uc2UuZGF0YS5kYXRhXSkpOwogICAgICAgICAgdmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICBsaW5rLmhyZWYgPSB1cmw7CiAgICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgiZG93bmxvYWQiLCAiQXNoaXNoIiArICIucGRmIik7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgICAgICAgbGluay5jbGljaygpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzMTYuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjYWxsX3BheW1lbnQ6IGZ1bmN0aW9uIGNhbGxfcGF5bWVudCh0eXBlKSB7CiAgICAgIHZhciBfdGhpczE3ID0gdGhpczsKCiAgICAgIHZhciBkID0gbmV3IERhdGUoKTsgLy8gY29uc29sZS5sb2coZCk7CgogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2YXIgb3B0aW9ucyA9IHt9OwoKICAgICAgaWYgKHR5cGUgPT0gImNvdW50cnlfc2VsZWN0ZWQiKSB7CiAgICAgICAgaWYgKHRoaXMuY291bnRyeV9uYW1lLmNvZGUgPT0gIiIpIHsKICAgICAgICAgIGFsZXJ0KHRoaXMudGx0KCdiaWxsaW5nX3NlbGVjdF9jb3VudHJ5X21zZycpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZWRpdF9wcm9maWxlX3VybCgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBmaXJzdF9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZmlyc3RfbmFtZSwKICAgICAgICAgICAgbGFzdF9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGFzdF9uYW1lLAogICAgICAgICAgICBjb3VudHJ5X25hbWU6IHRoaXMuY291bnRyeV9uYW1lLmNvZGUsCiAgICAgICAgICAgIHBob25lX251bWJlcjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnBob25lX25vCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczE3LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gX3RoaXMxNy5hcGlfc3RhdHVzX2NvZGUuUFJPRklMRV9VUERBVEVELk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgLy8gICBTd2FsKHsKICAgICAgICAgICAgICAvLyAgIHRpdGxlOiAiVXBkYXRlZCBTdWNjZXNzZnVsbHkhISIsCiAgICAgICAgICAgICAgLy8gICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgLy8gICB0ZXh0OiAiWW91ciBwcm9maWxlIGhhcyBiZWVuIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LiIsCiAgICAgICAgICAgICAgLy8gICB0aW1lcjoyMDAwLAogICAgICAgICAgICAgIC8vIH0pOwogICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKF90aGlzMTcudGx0KCdiaWxsaW5nX3Byb2ZpbGVfdXBkYXRlZF9tc2cnKSk7CgogICAgICAgICAgICAgIF90aGlzMTcuJHNlc3Npb24uc2V0KCJjb3VudHJ5X25hbWUiLCBfdGhpczE3LmNvdW50cnlfbmFtZS5jb2RlKTsKCiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBfdGhpczE3LiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICB9LCAyNTAwKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJCgiI2NvdW50cnltb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICBfdGhpczE3LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0LmlubmVyVGV4dCA9PSAiUGF5IikgewogICAgICAgIGlmICh0aGlzLnZhbHVlX2N1cnJlbmN5X3RvcF91cCA9PSAiIikgewogICAgICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCdiaWxsaW5nX3NlbGVjdF9hbW91bnRfbXNnMScpKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGF5bWVudF9jdXJyZW5jeSA9PSAiSU5SIikgewogICAgICAgICAgdGhpcy52YWx1ZV9jdXJyZW5jeV90b3BfdXAgPSB0aGlzLnZhbHVlX2N1cnJlbmN5X3RvcF91cC5zbGljZSgyLCAtMTApOwogICAgICAgICAgdGhpcy5jdXJyZW5jeV9hbW91bnQgPSB0aGlzLnZhbHVlX2N1cnJlbmN5X3RvcF91cCAqIDExODsKICAgICAgICAgIHRoaXMudG9wX3VwX2Ftb3VudCA9IHRoaXMudmFsdWVfY3VycmVuY3lfdG9wX3VwOwoKICAgICAgICAgIGlmICh0aGlzLnBheW1lbnRfY3VycmVuY3kgPT0gIklOUiIpIHsKICAgICAgICAgICAgdGhpcy50b3BfdXBfYW1vdW50IC89IDcwOwogICAgICAgICAgfQoKICAgICAgICAgIHBheV9hbW91bnQodGhpcy5jdXJyZW5jeV9hbW91bnQsIHRoaXMucGF5bWVudF9jdXJyZW5jeSwgIlRvcCBVcCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnZhbHVlX2N1cnJlbmN5X3RvcF91cCA9IHRoaXMudmFsdWVfY3VycmVuY3lfdG9wX3VwLnNsaWNlKDIpOwogICAgICAgICAgdGhpcy5jdXJyZW5jeV9hbW91bnQgPSB0aGlzLnZhbHVlX2N1cnJlbmN5X3RvcF91cCAqIDEwMDsKICAgICAgICAgIHRoaXMudG9wX3VwX2Ftb3VudCA9IHRoaXMudmFsdWVfY3VycmVuY3lfdG9wX3VwOwogICAgICAgICAgcGF5X2Ftb3VudCh0aGlzLmN1cnJlbmN5X2Ftb3VudCwgdGhpcy5wYXltZW50X2N1cnJlbmN5LCAiVG9wIFVwIik7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5pbm5lclRleHQgPT0gIlN1YnNjcmliZSIpIHsKICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CgogICAgICAgIGlmICh0aGlzLnZhbHVlX2N1cnJlbmN5X3N1YnNjcmlwdGlvbiA9PSAiIikgewogICAgICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCdiaWxsaW5nX3NlbGVjdF9hbW91bnRfbXNnMicpKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGF5bWVudF9jdXJyZW5jeSA9PSAiSU5SIikgewogICAgICAgICAgdGhpcy52YWx1ZV9jdXJyZW5jeV9zdWJzY3JpcHRpb24gPSB0aGlzLnZhbHVlX2N1cnJlbmN5X3N1YnNjcmlwdGlvbi5zbGljZSgyLCAtMTApOwogICAgICAgICAgdGhpcy5jdXJyZW5jeV9hbW91bnQgPSB0aGlzLnZhbHVlX2N1cnJlbmN5X3N1YnNjcmlwdGlvbiAqIDExODsKICAgICAgICAgIHRoaXMudG9wX3VwX2Ftb3VudCA9IHRoaXMudmFsdWVfY3VycmVuY3lfc3Vic2NyaXB0aW9uOwoKICAgICAgICAgIGlmICh0aGlzLnBheW1lbnRfY3VycmVuY3kgPT0gIklOUiIpIHsKICAgICAgICAgICAgdGhpcy50b3BfdXBfYW1vdW50IC89IDcwOwogICAgICAgICAgfQoKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmJpbGxpbmdfc3Vic2NyaXB0aW9uX3VybCgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBQbGFuQW1vdW50OiB0aGlzLnRvcF91cF9hbW91bnQKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLlN1YnNjcmlwdGlvbklkKSB7CiAgICAgICAgICAgICAgcGF5X2Ftb3VudChyZXNwb25zZS5kYXRhLlN1YnNjcmlwdGlvbklkLCAiIiwgIlN1YnNjcmliZSIpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuRXJyb3IpIHsKICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IocmVzcG9uc2UuZGF0YS5FcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICAgIF90aGlzMTcuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnZhbHVlX2N1cnJlbmN5X3N1YnNjcmlwdGlvbiA9IHRoaXMudmFsdWVfY3VycmVuY3lfc3Vic2NyaXB0aW9uLnNsaWNlKDIpOwogICAgICAgICAgdGhpcy5jdXJyZW5jeV9hbW91bnQgPSB0aGlzLnZhbHVlX2N1cnJlbmN5X3N1YnNjcmlwdGlvbiAqIDEwMDsKICAgICAgICAgIHRoaXMudG9wX3VwX2Ftb3VudCA9IHRoaXMudmFsdWVfY3VycmVuY3lfc3Vic2NyaXB0aW9uOwogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuYmlsbGluZ19zdWJzY3JpcHRpb25fdXJsKCksIHsKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfYm90bmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIFBsYW5BbW91bnQ6IHRoaXMuY3VycmVuY3lfYW1vdW50CiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczE3LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuU3Vic2NyaXB0aW9uSWQpIHsKICAgICAgICAgICAgICBwYXlfYW1vdW50KHJlc3BvbnNlLmRhdGEuU3Vic2NyaXB0aW9uSWQsICIiLCAiU3Vic2NyaWJlIik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5FcnJvcikgewogICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihyZXNwb25zZS5kYXRhLkVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgX3RoaXMxNy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBwYXlfYW1vdW50KGFtb3VudCwgY3VycmVuY3lfdHlwZSwgcGF5bWVudF90eXBlKSB7CiAgICAgICAgaWYgKHBheW1lbnRfdHlwZSA9PSAiU3Vic2NyaWJlIikgewogICAgICAgICAgb3B0aW9ucyA9IHsKICAgICAgICAgICAga2V5OiAicnpwX3Rlc3RfU25EVGFQbm5jZmxpRHQiLAogICAgICAgICAgICBzdWJzY3JpcHRpb25faWQ6IGFtb3VudCwKICAgICAgICAgICAgLy9UaGlzIGlzIGFjdHVhbGx5IHN1YnNjcmlwdGlvbiBJRAogICAgICAgICAgICAvLyBzdWJzY3JpcHRpb25fY2FyZF9jaGFuZ2U6IDEsCiAgICAgICAgICAgIG5hbWU6ICJDZW5zZSBBSSIsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAiSW5zdGlsbCBJbnRlbGxpZ2VuY2UiLAogICAgICAgICAgICBpbWFnZTogIi9pbWcvY2Vuc2VfaW1hZ2UucG5nIiwKICAgICAgICAgICAgLy8gQ09NUEFOWSBMT0dPCiAgICAgICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZS5yYXpvcnBheV9wYXltZW50X2lkKTsKICAgICAgICAgICAgICAvLyB2YXIgY29udGFjdCA9ICQoJyNjb250YWN0W3R5cGU9InRlbCJdJykudmFsdWU7CiAgICAgICAgICAgICAgLy8gdmFyIGVtYWlsID0gJCgnI2VtYWlsW3R5cGU9ImVtYWlsIl0nKS52YWx1ZTsKICAgICAgICAgICAgICB2bS5wYXltZW50aWQgPSByZXNwb25zZS5yYXpvcnBheV9wYXltZW50X2lkOwogICAgICAgICAgICAgIHZtLnZhbHVlX2N1cnJlbmN5X3N1YnNjcmlwdGlvbiA9ICIiOwogICAgICAgICAgICB9LAogICAgICAgICAgICBwcmVmaWxsOiB7CiAgICAgICAgICAgICAgbmFtZTogIiIsCiAgICAgICAgICAgICAgLy8gcGFzcyBjdXN0b21lciBuYW1lCiAgICAgICAgICAgICAgZW1haWw6ICIiLAogICAgICAgICAgICAgIC8vIGN1c3RvbWVyIGVtYWlsCiAgICAgICAgICAgICAgY29udGFjdDogIiIgLy9jdXN0b21lciBwaG9uZSBuby4KCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5vdGVzOiB7CiAgICAgICAgICAgICAgYWRkcmVzczogImFkZHJlc3MiIC8vY3VzdG9tZXIgYWRkcmVzcwoKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdGhlbWU6IHsKICAgICAgICAgICAgICBjb2xvcjogIiMyODM3NzciIC8vIHNjcmVlbiBjb2xvcgoKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICAgIGxvYWRfY2hlY2tvdXQoKTsKICAgICAgICB9IGVsc2UgaWYgKHBheW1lbnRfdHlwZSA9PSAiUGF5IikgewogICAgICAgICAgb3B0aW9ucyA9IHsKICAgICAgICAgICAga2V5OiAicnpwX3Rlc3RfU25EVGFQbm5jZmxpRHQiLAogICAgICAgICAgICBhbW91bnQ6IGFtb3VudCwKICAgICAgICAgICAgLy8gRXhhbXBsZTogMjAwMCBwYWlzZSA9IElOUiAyMAogICAgICAgICAgICBjdXJyZW5jeTogY3VycmVuY3lfdHlwZSwKICAgICAgICAgICAgbmFtZTogIkNlbnNlIEFJIiwKICAgICAgICAgICAgZGVzY3JpcHRpb246ICJJbnN0aWxsIEludGVsbGlnZW5jZSIsCiAgICAgICAgICAgIGltYWdlOiAiL2ltZy9jZW5zZV9pbWFnZS5wbmciLAogICAgICAgICAgICAvLyBDT01QQU5ZIExPR08KICAgICAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihyZXNwb25zZSkgewogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlLnJhem9ycGF5X3BheW1lbnRfaWQpOwogICAgICAgICAgICAgIHZhciBjb250YWN0ID0gJCgnI2NvbnRhY3RbdHlwZT0idGVsIl0nKS52YWx1ZTsKICAgICAgICAgICAgICB2YXIgZW1haWwgPSAkKCcjZW1haWxbdHlwZT0iZW1haWwiXScpLnZhbHVlOwogICAgICAgICAgICAgIHZtLnBheW1lbnRpZCA9IHJlc3BvbnNlLnJhem9ycGF5X3BheW1lbnRfaWQ7CiAgICAgICAgICAgICAgdm0udmFsdWVfY3VycmVuY3lfdG9wX3VwID0gIiI7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHByZWZpbGw6IHsKICAgICAgICAgICAgICBuYW1lOiAiIiwKICAgICAgICAgICAgICAvLyBwYXNzIGN1c3RvbWVyIG5hbWUKICAgICAgICAgICAgICBlbWFpbDogIiIsCiAgICAgICAgICAgICAgLy8gY3VzdG9tZXIgZW1haWwKICAgICAgICAgICAgICBjb250YWN0OiAiIiAvL2N1c3RvbWVyIHBob25lIG5vLgoKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbm90ZXM6IHsKICAgICAgICAgICAgICBhZGRyZXNzOiAiYWRkcmVzcyIgLy9jdXN0b21lciBhZGRyZXNzCgogICAgICAgICAgICB9LAogICAgICAgICAgICB0aGVtZTogewogICAgICAgICAgICAgIGNvbG9yOiAiIzI4Mzc3NyIgLy8gc2NyZWVuIGNvbG9yCgogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgbG9hZF9jaGVja291dCgpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gbG9hZF9jaGVja291dCgpIHsKICAgICAgICB2YXIgcnpwMSA9IG5ldyBSYXpvcnBheShvcHRpb25zKTsKICAgICAgICByenAxLm9wZW4oKTsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9CiAgICB9LAogICAgY2hlY2tfcmV0YWlsX3BsYW46IGZ1bmN0aW9uIGNoZWNrX3JldGFpbF9wbGFuKHZhbHVlLCBpZCkgewogICAgICB0aGlzLnJldGFpbF9wYXltZW50X3R5cGUgPSBudWxsOwogICAgfSwKICAgIHN1YnNjcmliZV9yZXRhaWxfcGxhbjogZnVuY3Rpb24gc3Vic2NyaWJlX3JldGFpbF9wbGFuKCkgewogICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CgogICAgICAvLyBsZXQgc3Vic2NyaXB0aW9uX2RhdGEgPSB7CiAgICAgIC8vICAgc3Vic2NyaXB0aW9uX3BsYW46IHRoaXMucmV0YWlsX3BsYW5fY3VycmVudCwKICAgICAgLy8gICBiaWxsaW5nX2N5Y2xlOiB0aGlzLnJldGFpbF9wYXltZW50X3R5cGUsCiAgICAgIC8vIH07CiAgICAgIGlmICh0aGlzLmNoZWNrX3JldGFpbF9zaG9waWZ5X2Zvcm1fdmFsaWRhdGlvbnMpIHsKICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3Vic2NyaWJlX3Nob3BpZnlfYmlsbGluZygpLCB7CiAgICAgICAgICBzdWJzY3JpcHRpb25fcGxhbjogdGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50LAogICAgICAgICAgYmlsbGluZ19jeWNsZTogdGhpcy5yZXRhaWxfcGF5bWVudF90eXBlLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICBpc19wYWlkX3BsYW46IHRoaXMucmV0YWlsX3BsYW5fY3VycmVudC5pc19jaGFyZ2VhYmxlLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbAogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczE4LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzMTguYXBpX3N0YXR1c19jb2RlLlNUQVRVU19TVUNDRVNTX01PREVMUy5NU0dfQ09ERSkgewogICAgICAgICAgICBpZiAoX3RoaXMxOC5yZXRhaWxfcGF5bWVudF90eXBlID09ICJBbm51YWwiKSB7CiAgICAgICAgICAgICAgaWYgKEJvb2xlYW4ocmVzcG9uc2UuZGF0YS5kYXRhKSAmJiBCb29sZWFuKHJlc3BvbnNlLmRhdGEuZGF0YS5kYXRhLmFwcFN1YnNjcmlwdGlvbkNyZWF0ZSkpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0aXRsZTogX3RoaXMxOC50bHQoJ2JpbGxpbmdfcmVkaXJlY3Rfc2hvcGlmeV9tZXJjaGFudF9tc2cnKSwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0eXBlOiAiaW5mbyIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gcmVzcG9uc2UuZGF0YS5kYXRhLmRhdGEuYXBwU3Vic2NyaXB0aW9uQ3JlYXRlLmNvbmZpcm1hdGlvblVybDsKICAgICAgICAgICAgICAgIH0sIDEwMDApOwoKICAgICAgICAgICAgICAgIF90aGlzMTguJHJvb3QuJGVtaXQoIkRhc2hib2FyZFNpZGViYXJEaXNhYmxlIiwgZmFsc2UpOwoKICAgICAgICAgICAgICAgIF90aGlzMTguJHNlc3Npb24uc2V0KCJTZXR0aW5nVG9wbmF2YmFyRGlzYWJsZSIsIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMxOC5yZXRhaWxfcGF5bWVudF90eXBlID09ICJNb250aGx5IikgewogICAgICAgICAgICAgIGlmIChCb29sZWFuKHJlc3BvbnNlLmRhdGEuZGF0YS5jb25maXJtYXRpb25fdXJsKSkgewogICAgICAgICAgICAgICAgLy8gU3dhbCh7CiAgICAgICAgICAgICAgICAvLyAgIHRpdGxlOiAiUGxlYXNlIHdhaXQgd2hpbGUgd2UgcmVkaXJlY3QgWW91IHRvIHRoZSBTaG9waWZ5IE1lcmNoYW50IFVJISIsCiAgICAgICAgICAgICAgICAvLyAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgLy8gICB0eXBlOiAiaW5mbyIsCiAgICAgICAgICAgICAgICAvLyAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgLy8gICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UKICAgICAgICAgICAgICAgIC8vIH0pCiAgICAgICAgICAgICAgICBfdGhpczE4LiRyb290LiRlbWl0KCJEYXNoYm9hcmRTaWRlYmFyRGlzYWJsZSIsIGZhbHNlKTsKCiAgICAgICAgICAgICAgICBfdGhpczE4LiRzZXNzaW9uLnNldCgiU2V0dGluZ1RvcG5hdmJhckRpc2FibGUiLCBmYWxzZSk7CgogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHJlc3BvbnNlLmRhdGEuZGF0YS5jb25maXJtYXRpb25fdXJsOwogICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0aXRsZTogX3RoaXMxOC50bHQoJ2JpbGxpbmdfZXJyb3Jfb2NjdXJyZWRfbXNnNScpLAogICAgICAgICAgICAgICAgICB0ZXh0OiBfdGhpczE4LnRsdCgnYmlsbGluZ19zd2FsX3RyeV9hZ2Fpbl9tc2cxJyksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMxOC5yZXRhaWxfcGxhbl9jdXJyZW50LmlzX2NoYXJnZWFibGUgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogX3RoaXMxOC50bHQoJ2JpbGxpbmdfc3dhbF9zdWNjZXNzX21zZycpLAogICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgdGV4dDogX3RoaXMxOC50bHQoJ2JpbGxpbmdfc3Vic2NyaWJlX2ZyZWVfcGxhbl9tc2cnKQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgX3RoaXMxOC5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiBfdGhpczE4LnRsdCgnYmlsbGluZ19lcnJvcl9vY2N1cnJlZF9tc2c2JyksCiAgICAgICAgICAgIHRleHQ6IF90aGlzMTgudGx0KCdiaWxsaW5nX3N3YWxfdHJ5X2FnYWluX21zZzInKSwKICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdiaWxsaW5nX3NlbGVjdF9hbGxfcmVxdWlyZWRfdmFsdWVfbXNnJyksCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAzMDAwCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBzdWJtaXRfc3RyaXBlX2NoZWNrb3V0OiBmdW5jdGlvbiBzdWJtaXRfc3RyaXBlX2NoZWNrb3V0KCkgewogICAgICB2YXIgX3RoaXMxOSA9IHRoaXM7CgogICAgICBpZiAodGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50ICE9PSBudWxsICYmIHRoaXMucmV0YWlsX3BheW1lbnRfdHlwZSAhPT0gbnVsbCkgewogICAgICAgIC8vIGxldCBjaG9zZW5fcGxhbl9kYXRhID0gdGhpcy5yZXRhaWxfcGF5bWVudF90eXBlPT09Ik1vbnRobHkiIHx8IHRoaXMucmV0YWlsX3BsYW5fY3VycmVudC5uYW1lPT09IldoYXRzQXBwIiA/IHRoaXMuc3RyaXBlX3N1YnNjcmlwdGlvbl9wbGFucy5maW5kKChpdGVtID0+IChpdGVtLmFtb3VudC8xMDAgPT09IHRoaXMucmV0YWlsX3BsYW5fY3VycmVudC5tb250aGx5X2NoYXJnZSkgJiYgKGl0ZW0uY3VycmVuY3kgPT09IHRoaXMuc2hvcF9iYXNlX2N1cnJlbmN5KSkpICA6IHRoaXMuc3RyaXBlX3N1YnNjcmlwdGlvbl9wbGFucy5maW5kKChpdGVtID0+IChpdGVtLmFtb3VudC8xMDAgPT09IHRoaXMucmV0YWlsX3BsYW5fY3VycmVudC5hbm51YWxfY2hhcmdlLmFjdHVhbF9jaGFyZ2UpICYmICAoaXRlbS5jdXJyZW5jeSA9PT0gdGhpcy5zaG9wX2Jhc2VfY3VycmVuY3kpKSkgCiAgICAgICAgLy8gY29uc29sZS5sb2coInJldGFpbF9wYXltZW50X3R5cGUiLHRoaXMucmV0YWlsX3BheW1lbnRfdHlwZSk7CiAgICAgICAgdmFyIGNob3Nlbl9wbGFuX2RhdGEgPSB7CiAgICAgICAgICAicGxhbl9uYW1lIjogdGhpcy5yZXRhaWxfcGxhbl9jdXJyZW50LAogICAgICAgICAgInR5cGUiOiB0aGlzLnJldGFpbF9wYXltZW50X3R5cGUudHlwZSwKICAgICAgICAgICJuaWNrbmFtZSI6IHRoaXMucmV0YWlsX3BheW1lbnRfdHlwZS5uaWNrbmFtZSwKICAgICAgICAgICJwcmljZSI6IHRoaXMucmV0YWlsX3BheW1lbnRfdHlwZS5wcmljZSwKICAgICAgICAgICJjdXJyZW5jeSI6IHRoaXMucmV0YWlsX3BheW1lbnRfdHlwZS5jdXJyZW5jeSwKICAgICAgICAgICJpZCI6IHRoaXMucmV0YWlsX3BheW1lbnRfdHlwZS5wcmljZV9pZAogICAgICAgIH07CiAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnN0cmlwZV9wYXltZW50X2dhdGV3YXkoKSwgewogICAgICAgICAgZ2VuZXJhdGVfbmV3X3JlcXVlc3Q6IHRydWUsCiAgICAgICAgICBjaG9zZW5fcGxhbl9kYXRhOiBjaG9zZW5fcGxhbl9kYXRhLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICByZXF1ZXN0X3R5cGU6ICJQbGFuIiwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXMxOS5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczE5LmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSkgewogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSByZXNwb25zZS5kYXRhLmRhdGE7CgogICAgICAgICAgICBfdGhpczE5LiRyb290LiRlbWl0KCJEYXNoYm9hcmRTaWRlYmFyRGlzYWJsZSIsIGZhbHNlKTsKCiAgICAgICAgICAgIF90aGlzMTkuJHNlc3Npb24uc2V0KCJTZXR0aW5nVG9wbmF2YmFyRGlzYWJsZSIsIGZhbHNlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIC8vIHRpdGxlOiB0aGlzLnRsdCgnYmlsbGluZ19lcnJvcl9vY2N1cnJlZF9tc2c3JyksCiAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSAvLyBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKTsKCiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIF90aGlzMTkuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogX3RoaXMxOS50bHQoJ2JpbGxpbmdfZXJyb3Jfb2NjdXJyZWRfbXNnOCcpLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgnYmlsbGluZ19zZWxlY3RfYWxsX2ZpZWxkX21zZycpLAogICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBzdWJtaXRfc3RyaXBlX2FkZG9uX2NoZWNrb3V0OiBmdW5jdGlvbiBzdWJtaXRfc3RyaXBlX2FkZG9uX2NoZWNrb3V0KCkgewogICAgICB2YXIgX3RoaXMyMCA9IHRoaXM7CgogICAgICBpZiAodGhpcy5zZWxlY3RlZF9hZGRvbl90eXBlID09PSBudWxsIHx8IHRoaXMuc2VsZWN0ZWRfYWRkb25fcGxhbiA9PT0gbnVsbCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdiaWxsaW5nX3NlbGVjdF9hbGxfZmllbGRfbXNnMScpLAogICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGNob3Nlbl9wbGFuX2RhdGEgPSB7CiAgICAgICAgInBsYW5fbmFtZSI6IHRoaXMuc2VsZWN0ZWRfYWRkb25fcGxhbi5UeXBlLAogICAgICAgICJwcmljZSI6IHRoaXMuc2VsZWN0ZWRfYWRkb25fdHlwZS5wcmljZSwKICAgICAgICAiY3VycmVuY3kiOiB0aGlzLnNlbGVjdGVkX2FkZG9uX3R5cGUuY3VycmVuY3ksCiAgICAgICAgImlkIjogdGhpcy5zZWxlY3RlZF9hZGRvbl90eXBlLnByaWNlX2lkCiAgICAgIH07CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3RyaXBlX3BheW1lbnRfZ2F0ZXdheSgpLCB7CiAgICAgICAgZ2VuZXJhdGVfbmV3X3JlcXVlc3Q6IHRydWUsCiAgICAgICAgY2hvc2VuX3BsYW5fZGF0YTogY2hvc2VuX3BsYW5fZGF0YSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgcmVxdWVzdF90eXBlOiAiQWRkT24iCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMyMC5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gX3RoaXMyMC5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEUuTVNHX0NPREUpIHsKICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIC8vIHRpdGxlOiB0aGlzLnRsdCgnYmlsbGluZ19lcnJvcl9vY2N1cnJlZF9tc2c5JyksCiAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9IC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEpOwoKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczIwLnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgIFN3YWwoewogICAgICAgICAgdGl0bGU6IF90aGlzMjAudGx0KCdiaWxsaW5nX2Vycm9yX29jY3VycmVkX21zZzEwJyksCiAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldF9zaG9wX2Jhc2VfY3VycmVuY3k6IGZ1bmN0aW9uIGdldF9zaG9wX2Jhc2VfY3VycmVuY3koKSB7CiAgICAgIHZhciBfdGhpczIxID0gdGhpczsKCiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnByb2R1Y3Rfc2V0dGluZ3MoKSwgewogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgaXNfZ2V0OiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgd2ViX2ZyYW1ld29yayA9IF90aGlzMjEucmV0YWlsX3dlYl9mcmFtZXdvcms7CgogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgIT0gX3RoaXMyMS5hcGlfc3RhdHVzX2NvZGUuSU5URVJOQUxfU0VSVkVSX0VSUk9SLk1TR19DT0RFICYmIHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSAhPSBfdGhpczIxLmFwaV9zdGF0dXNfY29kZS5OT19EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXMyMS5zaG9wX2Jhc2VfY3VycmVuY3kgPSByZXNwb25zZS5kYXRhLmRhdGFbd2ViX2ZyYW1ld29yayArICdfZGV0YWlscyddLmJhc2VfY3VycmVuY3kudmFsdWU7CiAgICAgICAgICBfdGhpczIxLnNob3BfYmFzZV9jdXJyZW5jeSA9IF90aGlzMjEuYWNjZXB0YWJsZV9zaG9wX2Jhc2VfY3VycmVuY2llcy5pbmNsdWRlcyhfdGhpczIxLnNob3BfYmFzZV9jdXJyZW5jeSkgPyBfdGhpczIxLnNob3BfYmFzZV9jdXJyZW5jeS50b0xvd2VyQ2FzZSgpIDogJ3VzZCc7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMjEuc2hvcF9iYXNlX2N1cnJlbmN5ID0gJ3VzZCc7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},null]}