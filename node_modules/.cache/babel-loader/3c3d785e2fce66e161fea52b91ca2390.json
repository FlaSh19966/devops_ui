{"remainingRequest":"/home/vimalesh/Elixir/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/Elixir/chatbot-portal/node_modules/eslint-loader/index.js??ref--13-0!/home/vimalesh/Elixir/chatbot-portal/src/portal/Chatbot/Dashboard/Layout/intro.js","dependencies":[{"path":"/home/vimalesh/Elixir/chatbot-portal/src/portal/Chatbot/Dashboard/Layout/intro.js","mtime":1643027096176},{"path":"/home/vimalesh/Elixir/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Elixir/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Elixir/chatbot-portal/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2giKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiKTsKCnZhciBfdHlwZW9mMiA9IHJlcXVpcmUoIi9ob21lL3ZpbWFsZXNoL0VsaXhpci9jaGF0Ym90LXBvcnRhbC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy90eXBlb2YiKTsKCi8qIQogKiBJbnRyby5qcyB2My4wLjEKICogaHR0cHM6Ly9naXRodWIuY29tL3VzYWJsaWNhL2ludHJvLmpzCiAqCiAqIENvcHlyaWdodCAoQykgMjAxNy0yMDIwIEFmc2hpbiBNZWhyYWJhbmkgKEBhZnNoaW5tZWgpLgogKiBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vdXNhYmxpY2EvaW50cm8uanMvbWFzdGVyL2xpY2Vuc2UubWQKICoKICogRGF0ZTogU2F0LCAxNyBPY3QgMjAyMCAxMDozNjoyMCBHTVQKICovCnZhciBfcmVxdWlyZSA9IHJlcXVpcmUoImQzIiksCiAgICBpbWFnZSA9IF9yZXF1aXJlLmltYWdlOwoKKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHsKICAodHlwZW9mIGV4cG9ydHMgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mMihleHBvcnRzKSkgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOiB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOiAoZ2xvYmFsID0gZ2xvYmFsIHx8IHNlbGYsIGdsb2JhbC5pbnRyb0pzID0gZmFjdG9yeSgpKTsKfSkodGhpcywgZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7CgogICAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsKICAgICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgICAgcmV0dXJuIHR5cGVvZiBvYmo7CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOwogICAgICB9OwogICAgfQoKICAgIHJldHVybiBfdHlwZW9mKG9iaik7CiAgfQogIC8qKgogICAqIE92ZXJ3cml0ZXMgb2JqMSdzIHZhbHVlcyB3aXRoIG9iajIncyBhbmQgYWRkcyBvYmoyJ3MgaWYgbm9uIGV4aXN0ZW50IGluIG9iajEKICAgKiB2aWE6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTcxMjUxL2hvdy1jYW4taS1tZXJnZS1wcm9wZXJ0aWVzLW9mLXR3by1qYXZhc2NyaXB0LW9iamVjdHMtZHluYW1pY2FsbHkKICAgKgogICAqIEBwYXJhbSBvYmoxCiAgICogQHBhcmFtIG9iajIKICAgKiBAcmV0dXJucyBvYmozIGEgbmV3IG9iamVjdCBiYXNlZCBvbiBvYmoxIGFuZCBvYmoyCiAgICovCgoKICBmdW5jdGlvbiBtZXJnZU9wdGlvbnMob2JqMSwgb2JqMikgewogICAgdmFyIG9iajMgPSB7fTsKICAgIHZhciBhdHRybmFtZTsKCiAgICBmb3IgKGF0dHJuYW1lIGluIG9iajEpIHsKICAgICAgb2JqM1thdHRybmFtZV0gPSBvYmoxW2F0dHJuYW1lXTsKICAgIH0KCiAgICBmb3IgKGF0dHJuYW1lIGluIG9iajIpIHsKICAgICAgb2JqM1thdHRybmFtZV0gPSBvYmoyW2F0dHJuYW1lXTsKICAgIH0KCiAgICByZXR1cm4gb2JqMzsKICB9CiAgLyoqCiAgICogTWFyayBhbnkgb2JqZWN0IHdpdGggYW4gaW5jcmVtZW50aW5nIG51bWJlcgogICAqIHVzZWQgZm9yIGtlZXBpbmcgdHJhY2sgb2Ygb2JqZWN0cwogICAqCiAgICogQHBhcmFtIE9iamVjdCBvYmogICBBbnkgb2JqZWN0IG9yIERPTSBFbGVtZW50CiAgICogQHBhcmFtIFN0cmluZyBrZXkKICAgKiBAcmV0dXJuIE9iamVjdAogICAqLwoKCiAgdmFyIHN0YW1wID0gZnVuY3Rpb24gKCkgewogICAgdmFyIGtleXMgPSB7fTsKICAgIHJldHVybiBmdW5jdGlvbiBzdGFtcChvYmopIHsKICAgICAgdmFyIGtleSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogImludHJvanMtc3RhbXAiOyAvLyBlYWNoIGdyb3VwIGluY3JlbWVudHMgZnJvbSAwCgogICAgICBrZXlzW2tleV0gPSBrZXlzW2tleV0gfHwgMDsgLy8gc3RhbXAgb25seSBvbmNlIHBlciBvYmplY3QKCiAgICAgIGlmIChvYmpba2V5XSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gaW5jcmVtZW50IGtleSBmb3IgZWFjaCBuZXcgb2JqZWN0CiAgICAgICAgb2JqW2tleV0gPSBrZXlzW2tleV0rKzsKICAgICAgfQoKICAgICAgcmV0dXJuIG9ialtrZXldOwogICAgfTsKICB9KCk7CiAgLyoqCiAgICogSXRlcmF0ZXMgYXJyYXlzCiAgICoKICAgKiBAcGFyYW0ge0FycmF5fSBhcnIKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmb3JFYWNoRm5jCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY29tcGxldGVGbmMKICAgKiBAcmV0dXJuIHtOdWxsfQogICAqLwoKCiAgZnVuY3Rpb24gZm9yRWFjaChhcnIsIGZvckVhY2hGbmMsIGNvbXBsZXRlRm5jKSB7CiAgICAvLyBpbiBjYXNlIGFyciBpcyBhbiBlbXB0eSBxdWVyeSBzZWxlY3RvciBub2RlIGxpc3QKICAgIGlmIChhcnIpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFyci5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgIGZvckVhY2hGbmMoYXJyW2ldLCBpKTsKICAgICAgfQogICAgfQoKICAgIGlmICh0eXBlb2YgY29tcGxldGVGbmMgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgY29tcGxldGVGbmMoKTsKICAgIH0KICB9CiAgLyoqCiAgICogUmVtb3ZlIGEgY2xhc3MgZnJvbSBhbiBlbGVtZW50CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9yZW1vdmVDbGFzcwogICAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50CiAgICogQHBhcmFtIHtSZWdFeHB8U3RyaW5nfSBjbGFzc05hbWVSZWdleCBjYW4gYmUgcmVnZXggb3Igc3RyaW5nCiAgICogQHJldHVybnMgbnVsbAogICAqLwoKCiAgZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lUmVnZXgpIHsKICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgU1ZHRWxlbWVudCkgewogICAgICB2YXIgcHJlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoImNsYXNzIikgfHwgIiI7CiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCJjbGFzcyIsIHByZS5yZXBsYWNlKGNsYXNzTmFtZVJlZ2V4LCAiIikucmVwbGFjZSgvXlxzK3xccyskL2csICIiKSk7CiAgICB9IGVsc2UgewogICAgICBlbGVtZW50LmNsYXNzTmFtZSA9IGVsZW1lbnQuY2xhc3NOYW1lLnJlcGxhY2UoY2xhc3NOYW1lUmVnZXgsICIiKS5yZXBsYWNlKC9eXHMrfFxzKyQvZywgIiIpOwogICAgfQogIH0KICAvKioKICAgKiBET01FdmVudCBIYW5kbGVzIGFsbCBET00gZXZlbnRzCiAgICoKICAgKiBtZXRob2RzOgogICAqCiAgICogb24gLSBhZGQgZXZlbnQgaGFuZGxlcgogICAqIG9mZiAtIHJlbW92ZSBldmVudAogICAqLwoKCiAgdmFyIERPTUV2ZW50ID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gRE9NRXZlbnQoKSB7CiAgICAgIHZhciBldmVudHNfa2V5ID0gImludHJvanNfZXZlbnQiOwogICAgICAvKioKICAgICAgICogR2V0cyBhIHVuaXF1ZSBJRCBmb3IgYW4gZXZlbnQgbGlzdGVuZXIKICAgICAgICoKICAgICAgICogQHBhcmFtIG9iaiBPYmplY3QKICAgICAgICogQHBhcmFtIHR5cGUgZXZlbnQgdHlwZQogICAgICAgKiBAcGFyYW0gbGlzdGVuZXIgRnVuY3Rpb24KICAgICAgICogQHBhcmFtIGNvbnRleHQgT2JqZWN0CiAgICAgICAqIEByZXR1cm4gU3RyaW5nCiAgICAgICAqLwoKICAgICAgdGhpcy5faWQgPSBmdW5jdGlvbiAob2JqLCB0eXBlLCBsaXN0ZW5lciwgY29udGV4dCkgewogICAgICAgIHJldHVybiB0eXBlICsgc3RhbXAobGlzdGVuZXIpICsgKGNvbnRleHQgPyAiXyIuY29uY2F0KHN0YW1wKGNvbnRleHQpKSA6ICIiKTsKICAgICAgfTsKICAgICAgLyoqCiAgICAgICAqIEFkZHMgZXZlbnQgbGlzdGVuZXIKICAgICAgICoKICAgICAgICogQHBhcmFtIG9iaiBPYmplY3Qgb2JqCiAgICAgICAqIEBwYXJhbSB0eXBlIFN0cmluZwogICAgICAgKiBAcGFyYW0gbGlzdGVuZXIgRnVuY3Rpb24KICAgICAgICogQHBhcmFtIGNvbnRleHQgT2JqZWN0CiAgICAgICAqIEBwYXJhbSB1c2VDYXB0dXJlIEJvb2xlYW4KICAgICAgICogQHJldHVybiBudWxsCiAgICAgICAqLwoKCiAgICAgIHRoaXMub24gPSBmdW5jdGlvbiAob2JqLCB0eXBlLCBsaXN0ZW5lciwgY29udGV4dCwgdXNlQ2FwdHVyZSkgewogICAgICAgIHZhciBpZCA9IHRoaXMuX2lkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgogICAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gaGFuZGxlcihlKSB7CiAgICAgICAgICByZXR1cm4gbGlzdGVuZXIuY2FsbChjb250ZXh0IHx8IG9iaiwgZSB8fCB3aW5kb3cuZXZlbnQpOwogICAgICAgIH07CgogICAgICAgIGlmICgiYWRkRXZlbnRMaXN0ZW5lciIgaW4gb2JqKSB7CiAgICAgICAgICBvYmouYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyLCB1c2VDYXB0dXJlKTsKICAgICAgICB9IGVsc2UgaWYgKCJhdHRhY2hFdmVudCIgaW4gb2JqKSB7CiAgICAgICAgICBvYmouYXR0YWNoRXZlbnQoIm9uIi5jb25jYXQodHlwZSksIGhhbmRsZXIpOwogICAgICAgIH0KCiAgICAgICAgb2JqW2V2ZW50c19rZXldID0gb2JqW2V2ZW50c19rZXldIHx8IHt9OwogICAgICAgIG9ialtldmVudHNfa2V5XVtpZF0gPSBoYW5kbGVyOwogICAgICB9OwogICAgICAvKioKICAgICAgICogUmVtb3ZlcyBldmVudCBsaXN0ZW5lcgogICAgICAgKgogICAgICAgKiBAcGFyYW0gb2JqIE9iamVjdAogICAgICAgKiBAcGFyYW0gdHlwZSBTdHJpbmcKICAgICAgICogQHBhcmFtIGxpc3RlbmVyIEZ1bmN0aW9uCiAgICAgICAqIEBwYXJhbSBjb250ZXh0IE9iamVjdAogICAgICAgKiBAcGFyYW0gdXNlQ2FwdHVyZSBCb29sZWFuCiAgICAgICAqIEByZXR1cm4gbnVsbAogICAgICAgKi8KCgogICAgICB0aGlzLm9mZiA9IGZ1bmN0aW9uIChvYmosIHR5cGUsIGxpc3RlbmVyLCBjb250ZXh0LCB1c2VDYXB0dXJlKSB7CiAgICAgICAgdmFyIGlkID0gdGhpcy5faWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCiAgICAgICAgdmFyIGhhbmRsZXIgPSBvYmpbZXZlbnRzX2tleV0gJiYgb2JqW2V2ZW50c19rZXldW2lkXTsKCiAgICAgICAgaWYgKCFoYW5kbGVyKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoInJlbW92ZUV2ZW50TGlzdGVuZXIiIGluIG9iaikgewogICAgICAgICAgb2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlciwgdXNlQ2FwdHVyZSk7CiAgICAgICAgfSBlbHNlIGlmICgiZGV0YWNoRXZlbnQiIGluIG9iaikgewogICAgICAgICAgb2JqLmRldGFjaEV2ZW50KCJvbiIuY29uY2F0KHR5cGUpLCBoYW5kbGVyKTsKICAgICAgICB9CgogICAgICAgIG9ialtldmVudHNfa2V5XVtpZF0gPSBudWxsOwogICAgICB9OwogICAgfQoKICAgIHJldHVybiBuZXcgRE9NRXZlbnQoKTsKICB9KCk7CiAgLyoqCiAgICogQXBwZW5kIGEgY2xhc3MgdG8gYW4gZWxlbWVudAogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfYWRkQ2xhc3MKICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudAogICAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc05hbWUKICAgKiBAcmV0dXJucyBudWxsCiAgICovCgoKICBmdW5jdGlvbiBhZGRDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpIHsKICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgU1ZHRWxlbWVudCkgewogICAgICAvLyBzdmcKICAgICAgdmFyIHByZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpIHx8ICIiOwogICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgiY2xhc3MiLCAiIi5jb25jYXQocHJlLCAiICIpLmNvbmNhdChjbGFzc05hbWUpKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChlbGVtZW50LmNsYXNzTGlzdCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gY2hlY2sgZm9yIG1vZGVybiBjbGFzc0xpc3QgcHJvcGVydHkKICAgICAgICB2YXIgY2xhc3NlcyA9IGNsYXNzTmFtZS5zcGxpdCgiICIpOwogICAgICAgIGZvckVhY2goY2xhc3NlcywgZnVuY3Rpb24gKGNscykgewogICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNscyk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoIWVsZW1lbnQuY2xhc3NOYW1lLm1hdGNoKGNsYXNzTmFtZSkpIHsKICAgICAgICAvLyBjaGVjayBpZiBlbGVtZW50IGRvZXNuJ3QgYWxyZWFkeSBoYXZlIGNsYXNzTmFtZQogICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lICs9ICIgIi5jb25jYXQoY2xhc3NOYW1lKTsKICAgICAgfQogICAgfQogIH0KICAvKioKICAgKiBHZXQgYW4gZWxlbWVudCBDU1MgcHJvcGVydHkgb24gdGhlIHBhZ2UKICAgKiBUaGFua3MgdG8gSmF2YVNjcmlwdCBLaXQ6IGh0dHA6Ly93d3cuamF2YXNjcmlwdGtpdC5jb20vZGh0bWx0dXRvcnMvZGh0bWxjYXNjYWRlNC5zaHRtbAogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfZ2V0UHJvcFZhbHVlCiAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQKICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcE5hbWUKICAgKiBAcmV0dXJucyBzdHJpbmcgcHJvcGVydHkgdmFsdWUKICAgKi8KCgogIGZ1bmN0aW9uIGdldFByb3BWYWx1ZShlbGVtZW50LCBwcm9wTmFtZSkgewogICAgdmFyIHByb3BWYWx1ZSA9ICIiOwoKICAgIGlmIChlbGVtZW50LmN1cnJlbnRTdHlsZSkgewogICAgICAvL0lFCiAgICAgIHByb3BWYWx1ZSA9IGVsZW1lbnQuY3VycmVudFN0eWxlW3Byb3BOYW1lXTsKICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuZGVmYXVsdFZpZXcgJiYgZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSkgewogICAgICAvL090aGVycwogICAgICBwcm9wVmFsdWUgPSBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQsIG51bGwpLmdldFByb3BlcnR5VmFsdWUocHJvcE5hbWUpOwogICAgfSAvL1ByZXZlbnQgZXhjZXB0aW9uIGluIElFCgoKICAgIGlmIChwcm9wVmFsdWUgJiYgcHJvcFZhbHVlLnRvTG93ZXJDYXNlKSB7CiAgICAgIHJldHVybiBwcm9wVmFsdWUudG9Mb3dlckNhc2UoKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBwcm9wVmFsdWU7CiAgICB9CiAgfQogIC8qKgogICAqIFRvIHNldCB0aGUgc2hvdyBlbGVtZW50CiAgICogVGhpcyBmdW5jdGlvbiBzZXQgYSByZWxhdGl2ZSAoaW4gbW9zdCBjYXNlcykgcG9zaXRpb24gYW5kIGNoYW5nZXMgdGhlIHotaW5kZXgKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3NldFNob3dFbGVtZW50CiAgICogQHBhcmFtIHtPYmplY3R9IHRhcmdldEVsZW1lbnQKICAgKi8KCgogIGZ1bmN0aW9uIHNldFNob3dFbGVtZW50KF9yZWYpIHsKICAgIHZhciBlbGVtZW50ID0gX3JlZi5lbGVtZW50OwogICAgdmFyIHBhcmVudEVsbTsgLy8gd2UgbmVlZCB0byBhZGQgdGhpcyBzaG93IGVsZW1lbnQgY2xhc3MgdG8gdGhlIHBhcmVudCBvZiBTVkcgZWxlbWVudHMKICAgIC8vIGJlY2F1c2UgdGhlIFNWRyBlbGVtZW50cyBjYW4ndCBoYXZlIGluZGVwZW5kZW50IHotaW5kZXgKCiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIFNWR0VsZW1lbnQpIHsKICAgICAgcGFyZW50RWxtID0gZWxlbWVudC5wYXJlbnROb2RlOwoKICAgICAgd2hpbGUgKGVsZW1lbnQucGFyZW50Tm9kZSAhPT0gbnVsbCkgewogICAgICAgIGlmICghcGFyZW50RWxtLnRhZ05hbWUgfHwgcGFyZW50RWxtLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gImJvZHkiKSBicmVhazsKCiAgICAgICAgaWYgKHBhcmVudEVsbS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJzdmciKSB7CiAgICAgICAgICBhZGRDbGFzcyhwYXJlbnRFbG0sICJpbnRyb2pzLXNob3dFbGVtZW50IGludHJvanMtcmVsYXRpdmVQb3NpdGlvbiIpOwogICAgICAgIH0KCiAgICAgICAgcGFyZW50RWxtID0gcGFyZW50RWxtLnBhcmVudE5vZGU7CiAgICAgIH0KICAgIH0KCiAgICBhZGRDbGFzcyhlbGVtZW50LCAiaW50cm9qcy1zaG93RWxlbWVudCIpOwogICAgdmFyIGN1cnJlbnRFbGVtZW50UG9zaXRpb24gPSBnZXRQcm9wVmFsdWUoZWxlbWVudCwgInBvc2l0aW9uIik7CgogICAgaWYgKGN1cnJlbnRFbGVtZW50UG9zaXRpb24gIT09ICJhYnNvbHV0ZSIgJiYgY3VycmVudEVsZW1lbnRQb3NpdGlvbiAhPT0gInJlbGF0aXZlIiAmJiBjdXJyZW50RWxlbWVudFBvc2l0aW9uICE9PSAiZml4ZWQiKSB7CiAgICAgIC8vY2hhbmdlIHRvIG5ldyBpbnRybyBpdGVtCiAgICAgIGFkZENsYXNzKGVsZW1lbnQsICJpbnRyb2pzLXJlbGF0aXZlUG9zaXRpb24iKTsKICAgIH0KCiAgICBwYXJlbnRFbG0gPSBlbGVtZW50LnBhcmVudE5vZGU7CgogICAgd2hpbGUgKHBhcmVudEVsbSAhPT0gbnVsbCkgewogICAgICBpZiAoIXBhcmVudEVsbS50YWdOYW1lIHx8IHBhcmVudEVsbS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJib2R5IikgYnJlYWs7IC8vZml4IFRoZSBTdGFja2luZyBDb250ZXh0IHByb2JsZW0uCiAgICAgIC8vTW9yZSBkZXRhaWw6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0d1aWRlL0NTUy9VbmRlcnN0YW5kaW5nX3pfaW5kZXgvVGhlX3N0YWNraW5nX2NvbnRleHQKCiAgICAgIHZhciB6SW5kZXggPSBnZXRQcm9wVmFsdWUocGFyZW50RWxtLCAiei1pbmRleCIpOwogICAgICB2YXIgb3BhY2l0eSA9IHBhcnNlRmxvYXQoZ2V0UHJvcFZhbHVlKHBhcmVudEVsbSwgIm9wYWNpdHkiKSk7CiAgICAgIHZhciB0cmFuc2Zvcm0gPSBnZXRQcm9wVmFsdWUocGFyZW50RWxtLCAidHJhbnNmb3JtIikgfHwgZ2V0UHJvcFZhbHVlKHBhcmVudEVsbSwgIi13ZWJraXQtdHJhbnNmb3JtIikgfHwgZ2V0UHJvcFZhbHVlKHBhcmVudEVsbSwgIi1tb3otdHJhbnNmb3JtIikgfHwgZ2V0UHJvcFZhbHVlKHBhcmVudEVsbSwgIi1tcy10cmFuc2Zvcm0iKSB8fCBnZXRQcm9wVmFsdWUocGFyZW50RWxtLCAiLW8tdHJhbnNmb3JtIik7CgogICAgICBpZiAoL1swLTldKy8udGVzdCh6SW5kZXgpIHx8IG9wYWNpdHkgPCAxIHx8IHRyYW5zZm9ybSAhPT0gIm5vbmUiICYmIHRyYW5zZm9ybSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgYWRkQ2xhc3MocGFyZW50RWxtLCAiaW50cm9qcy1maXhQYXJlbnQiKTsKICAgICAgfQoKICAgICAgcGFyZW50RWxtID0gcGFyZW50RWxtLnBhcmVudE5vZGU7CiAgICB9CiAgfQogIC8qKgogICAqIHNjcm9sbCBhIHNjcm9sbGFibGUgZWxlbWVudCB0byBhIGNoaWxkIGVsZW1lbnQKICAgKgogICAqIEBwYXJhbSBFbGVtZW50IHBhcmVudAogICAqIEBwYXJhbSBFbGVtZW50IGVsZW1lbnQKICAgKiBAcmV0dXJuIE51bGwKICAgKi8KCgogIGZ1bmN0aW9uIHNjcm9sbFBhcmVudFRvRWxlbWVudChwYXJlbnQsIF9yZWYpIHsKICAgIHZhciBvZmZzZXRUb3AgPSBfcmVmLm9mZnNldFRvcDsKICAgIHBhcmVudC5zY3JvbGxUb3AgPSBvZmZzZXRUb3AgLSBwYXJlbnQub2Zmc2V0VG9wOwogIH0KICAvKioKICAgKiBGaW5kIHRoZSBuZWFyZXN0IHNjcm9sbGFibGUgcGFyZW50CiAgICogY29waWVkIGZyb20gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzU5Mzk4ODYvZmluZC1maXJzdC1zY3JvbGxhYmxlLXBhcmVudAogICAqCiAgICogQHBhcmFtIEVsZW1lbnQgZWxlbWVudAogICAqIEByZXR1cm4gRWxlbWVudAogICAqLwoKCiAgZnVuY3Rpb24gZ2V0U2Nyb2xsUGFyZW50KGVsZW1lbnQpIHsKICAgIHZhciBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpOwogICAgdmFyIGV4Y2x1ZGVTdGF0aWNQYXJlbnQgPSBzdHlsZS5wb3NpdGlvbiA9PT0gImFic29sdXRlIjsKICAgIHZhciBvdmVyZmxvd1JlZ2V4ID0gLyhhdXRvfHNjcm9sbCkvOwogICAgaWYgKHN0eWxlLnBvc2l0aW9uID09PSAiZml4ZWQiKSByZXR1cm4gZG9jdW1lbnQuYm9keTsKCiAgICBmb3IgKHZhciBwYXJlbnQgPSBlbGVtZW50OyBwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudDspIHsKICAgICAgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShwYXJlbnQpOwoKICAgICAgaWYgKGV4Y2x1ZGVTdGF0aWNQYXJlbnQgJiYgc3R5bGUucG9zaXRpb24gPT09ICJzdGF0aWMiKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChvdmVyZmxvd1JlZ2V4LnRlc3Qoc3R5bGUub3ZlcmZsb3cgKyBzdHlsZS5vdmVyZmxvd1kgKyBzdHlsZS5vdmVyZmxvd1gpKSByZXR1cm4gcGFyZW50OwogICAgfQoKICAgIHJldHVybiBkb2N1bWVudC5ib2R5OwogIH0KICAvKioKICAgKiBQcm92aWRlcyBhIGNyb3NzLWJyb3dzZXIgd2F5IHRvIGdldCB0aGUgc2NyZWVuIGRpbWVuc2lvbnMKICAgKiB2aWE6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTg2NDQ2Ny9pbnRlcm5ldC1leHBsb3Jlci1pbm5lcmhlaWdodAogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfZ2V0V2luU2l6ZQogICAqIEByZXR1cm5zIHtPYmplY3R9IHdpZHRoIGFuZCBoZWlnaHQgYXR0cmlidXRlcwogICAqLwoKCiAgZnVuY3Rpb24gZ2V0V2luU2l6ZSgpIHsKICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLAogICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICB2YXIgRCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogRC5jbGllbnRXaWR0aCwKICAgICAgICBoZWlnaHQ6IEQuY2xpZW50SGVpZ2h0CiAgICAgIH07CiAgICB9CiAgfQogIC8qKgogICAqIENoZWNrIHRvIHNlZSBpZiB0aGUgZWxlbWVudCBpcyBpbiB0aGUgdmlld3BvcnQgb3Igbm90CiAgICogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjM5OTkvaG93LXRvLXRlbGwtaWYtYS1kb20tZWxlbWVudC1pcy12aXNpYmxlLWluLXRoZS1jdXJyZW50LXZpZXdwb3J0CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9lbGVtZW50SW5WaWV3cG9ydAogICAqIEBwYXJhbSB7T2JqZWN0fSBlbAogICAqLwoKCiAgZnVuY3Rpb24gZWxlbWVudEluVmlld3BvcnQoZWwpIHsKICAgIHZhciByZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICByZXR1cm4gcmVjdC50b3AgPj0gMCAmJiByZWN0LmxlZnQgPj0gMCAmJiByZWN0LmJvdHRvbSArIDgwIDw9IHdpbmRvdy5pbm5lckhlaWdodCAmJiAvLyBhZGQgODAgdG8gZ2V0IHRoZSB0ZXh0IHJpZ2h0CiAgICByZWN0LnJpZ2h0IDw9IHdpbmRvdy5pbm5lcldpZHRoOwogIH0KICAvKioKICAgKiBUbyBjaGFuZ2UgdGhlIHNjcm9sbCBvZiBgd2luZG93YCBhZnRlciBoaWdobGlnaHRpbmcgYW4gZWxlbWVudAogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfc2Nyb2xsVG8KICAgKiBAcGFyYW0ge1N0cmluZ30gc2Nyb2xsVG8KICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0RWxlbWVudAogICAqIEBwYXJhbSB7T2JqZWN0fSB0b29sdGlwTGF5ZXIKICAgKi8KCgogIGZ1bmN0aW9uIHNjcm9sbFRvKHNjcm9sbFRvLCBfcmVmLCB0b29sdGlwTGF5ZXIpIHsKICAgIHZhciBlbGVtZW50ID0gX3JlZi5lbGVtZW50OwogICAgaWYgKHNjcm9sbFRvID09PSAib2ZmIikgcmV0dXJuOwogICAgdmFyIHJlY3Q7CiAgICBpZiAoIXRoaXMuX29wdGlvbnMuc2Nyb2xsVG9FbGVtZW50KSByZXR1cm47CgogICAgaWYgKHNjcm9sbFRvID09PSAidG9vbHRpcCIpIHsKICAgICAgcmVjdCA9IHRvb2x0aXBMYXllci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgfQoKICAgIGlmICghZWxlbWVudEluVmlld3BvcnQoZWxlbWVudCkpIHsKICAgICAgdmFyIHdpbkhlaWdodCA9IGdldFdpblNpemUoKS5oZWlnaHQ7CiAgICAgIHZhciB0b3AgPSByZWN0LmJvdHRvbSAtIChyZWN0LmJvdHRvbSAtIHJlY3QudG9wKTsgLy8gVE9ETyAoYWZzaGlubSk6IGRvIHdlIG5lZWQgc2Nyb2xsIHBhZGRpbmcgbm93PwogICAgICAvLyBJIGhhdmUgY2hhbmdlZCB0aGUgc2Nyb2xsIG9wdGlvbiBhbmQgbm93IGl0IHNjcm9sbHMgdGhlIHdpbmRvdyB0bwogICAgICAvLyB0aGUgY2VudGVyIG9mIHRoZSB0YXJnZXQgZWxlbWVudCBvciB0b29sdGlwLgoKICAgICAgaWYgKHRvcCA8IDAgfHwgZWxlbWVudC5jbGllbnRIZWlnaHQgPiB3aW5IZWlnaHQpIHsKICAgICAgICB3aW5kb3cuc2Nyb2xsQnkoMCwgcmVjdC50b3AgLSAod2luSGVpZ2h0IC8gMiAtIHJlY3QuaGVpZ2h0IC8gMikgLSB0aGlzLl9vcHRpb25zLnNjcm9sbFBhZGRpbmcpOyAvLyAzMHB4IHBhZGRpbmcgZnJvbSBlZGdlIHRvIGxvb2sgbmljZQogICAgICAgIC8vU2Nyb2xsIGRvd24KICAgICAgfSBlbHNlIHsKICAgICAgICB3aW5kb3cuc2Nyb2xsQnkoMCwgcmVjdC50b3AgLSAod2luSGVpZ2h0IC8gMiAtIHJlY3QuaGVpZ2h0IC8gMikgKyB0aGlzLl9vcHRpb25zLnNjcm9sbFBhZGRpbmcpOyAvLyAzMHB4IHBhZGRpbmcgZnJvbSBlZGdlIHRvIGxvb2sgbmljZQogICAgICB9CiAgICB9CiAgfQogIC8qKgogICAqIFNldHRpbmcgYW5jaG9ycyB0byBiZWhhdmUgbGlrZSBidXR0b25zCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9zZXRBbmNob3JBc0J1dHRvbgogICAqLwoKCiAgZnVuY3Rpb24gc2V0QW5jaG9yQXNCdXR0b24oYW5jaG9yKSB7CiAgICBhbmNob3Iuc2V0QXR0cmlidXRlKCJyb2xlIiwgImJ1dHRvbiIpOwogICAgYW5jaG9yLnRhYkluZGV4ID0gMDsKICB9CiAgLyoqCiAgICogR2V0IGFuIGVsZW1lbnQgcG9zaXRpb24gb24gdGhlIHBhZ2UKICAgKiBUaGFua3MgdG8gYG1lb3V3YDogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNDQyNDc0LzM3NTk2NgogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfZ2V0T2Zmc2V0CiAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQKICAgKiBAcmV0dXJucyBFbGVtZW50J3MgcG9zaXRpb24gaW5mbwogICAqLwoKCiAgZnVuY3Rpb24gZ2V0T2Zmc2V0KGVsZW1lbnQpIHsKICAgIHZhciBib2R5ID0gZG9jdW1lbnQuYm9keTsKICAgIHZhciBkb2NFbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgIHZhciBzY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jRWwuc2Nyb2xsVG9wIHx8IGJvZHkuc2Nyb2xsVG9wOwogICAgdmFyIHNjcm9sbExlZnQgPSB3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jRWwuc2Nyb2xsTGVmdCB8fCBib2R5LnNjcm9sbExlZnQ7CiAgICB2YXIgeCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICByZXR1cm4gewogICAgICB0b3A6IHgudG9wICsgc2Nyb2xsVG9wLAogICAgICB3aWR0aDogeC53aWR0aCwKICAgICAgaGVpZ2h0OiB4LmhlaWdodCwKICAgICAgbGVmdDogeC5sZWZ0ICsgc2Nyb2xsTGVmdAogICAgfTsKICB9CiAgLyoqCiAgICogQ2hlY2tzIHRvIHNlZSBpZiB0YXJnZXQgZWxlbWVudCAob3IgcGFyZW50cykgcG9zaXRpb24gaXMgZml4ZWQgb3Igbm90CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9pc0ZpeGVkCiAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQKICAgKiBAcmV0dXJucyBCb29sZWFuCiAgICovCgoKICBmdW5jdGlvbiBpc0ZpeGVkKGVsZW1lbnQpIHsKICAgIHZhciBwID0gZWxlbWVudC5wYXJlbnROb2RlOwoKICAgIGlmICghcCB8fCBwLm5vZGVOYW1lID09PSAiSFRNTCIpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmIChnZXRQcm9wVmFsdWUoZWxlbWVudCwgInBvc2l0aW9uIikgPT09ICJmaXhlZCIpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGlzRml4ZWQocCk7CiAgfQogIC8qKgogICAqIFVwZGF0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIGhlbHBlciBsYXllciBvbiB0aGUgc2NyZWVuCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9zZXRIZWxwZXJMYXllclBvc2l0aW9uCiAgICogQHBhcmFtIHtPYmplY3R9IGhlbHBlckxheWVyCiAgICovCgoKICBmdW5jdGlvbiBzZXRIZWxwZXJMYXllclBvc2l0aW9uKGhlbHBlckxheWVyKSB7CiAgICBpZiAoaGVscGVyTGF5ZXIpIHsKICAgICAgLy9wcmV2ZW50IGVycm9yIHdoZW4gYHRoaXMuX2N1cnJlbnRTdGVwYCBpbiB1bmRlZmluZWQKICAgICAgaWYgKCF0aGlzLl9pbnRyb0l0ZW1zW3RoaXMuX2N1cnJlbnRTdGVwXSkgcmV0dXJuOwogICAgICB2YXIgY3VycmVudEVsZW1lbnQgPSB0aGlzLl9pbnRyb0l0ZW1zW3RoaXMuX2N1cnJlbnRTdGVwXTsKICAgICAgdmFyIGVsZW1lbnRQb3NpdGlvbiA9IGdldE9mZnNldChjdXJyZW50RWxlbWVudC5lbGVtZW50KTsKICAgICAgdmFyIHdpZHRoSGVpZ2h0UGFkZGluZyA9IHRoaXMuX29wdGlvbnMuaGVscGVyRWxlbWVudFBhZGRpbmc7IC8vIElmIHRoZSB0YXJnZXQgZWxlbWVudCBpcyBmaXhlZCwgdGhlIHRvb2x0aXAgc2hvdWxkIGJlIGZpeGVkIGFzIHdlbGwuCiAgICAgIC8vIE90aGVyd2lzZSwgcmVtb3ZlIGEgZml4ZWQgY2xhc3MgdGhhdCBtYXkgYmUgbGVmdCBvdmVyIGZyb20gdGhlIHByZXZpb3VzCiAgICAgIC8vIHN0ZXAuCgogICAgICBpZiAoaXNGaXhlZChjdXJyZW50RWxlbWVudC5lbGVtZW50KSkgewogICAgICAgIGFkZENsYXNzKGhlbHBlckxheWVyLCAiaW50cm9qcy1maXhlZFRvb2x0aXAiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZW1vdmVDbGFzcyhoZWxwZXJMYXllciwgImludHJvanMtZml4ZWRUb29sdGlwIik7CiAgICAgIH0KCiAgICAgIGlmIChjdXJyZW50RWxlbWVudC5wb3NpdGlvbiA9PT0gImZsb2F0aW5nIikgewogICAgICAgIHdpZHRoSGVpZ2h0UGFkZGluZyA9IDA7CiAgICAgIH0gLy9zZXQgbmV3IHBvc2l0aW9uIHRvIGhlbHBlciBsYXllcgoKCiAgICAgIGhlbHBlckxheWVyLnN0eWxlLmNzc1RleHQgPSAid2lkdGg6ICIuY29uY2F0KGVsZW1lbnRQb3NpdGlvbi53aWR0aCArIHdpZHRoSGVpZ2h0UGFkZGluZywgInB4OyBoZWlnaHQ6IikuY29uY2F0KGVsZW1lbnRQb3NpdGlvbi5oZWlnaHQgKyB3aWR0aEhlaWdodFBhZGRpbmcsICJweDsgdG9wOiIpLmNvbmNhdChlbGVtZW50UG9zaXRpb24udG9wIC0gd2lkdGhIZWlnaHRQYWRkaW5nIC8gMiwgInB4O2xlZnQ6ICIpLmNvbmNhdChlbGVtZW50UG9zaXRpb24ubGVmdCAtIHdpZHRoSGVpZ2h0UGFkZGluZyAvIDIsICJweDsiKTsKICAgIH0KICB9CiAgLyoqCiAgICogU2V0IHRvb2x0aXAgbGVmdCBzbyBpdCBkb2Vzbid0IGdvIG9mZiB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgd2luZG93CiAgICoKICAgKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSwgaWYgdG9vbHRpcExheWVyU3R5bGVMZWZ0IGlzIG9rLiAgZmFsc2UsIG90aGVyd2lzZS4KICAgKi8KCgogIGZ1bmN0aW9uIGNoZWNrUmlnaHQodGFyZ2V0T2Zmc2V0LCB0b29sdGlwTGF5ZXJTdHlsZUxlZnQsIHRvb2x0aXBPZmZzZXQsIHdpbmRvd1NpemUsIHRvb2x0aXBMYXllcikgewogICAgaWYgKHRhcmdldE9mZnNldC5sZWZ0ICsgdG9vbHRpcExheWVyU3R5bGVMZWZ0ICsgdG9vbHRpcE9mZnNldC53aWR0aCA+IHdpbmRvd1NpemUud2lkdGgpIHsKICAgICAgLy8gb2ZmIHRoZSByaWdodCBzaWRlIG9mIHRoZSB3aW5kb3cKICAgICAgdG9vbHRpcExheWVyLmxlZnQgPSAiIi5jb25jYXQod2luZG93U2l6ZS53aWR0aCAtIHRvb2x0aXBPZmZzZXQud2lkdGggLSB0YXJnZXRPZmZzZXQubGVmdCwgInB4Iik7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICB0b29sdGlwTGF5ZXIubGVmdCA9ICIiLmNvbmNhdCh0b29sdGlwTGF5ZXJTdHlsZUxlZnQsICJweCIpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIC8qKgogICAqIFNldCB0b29sdGlwIHJpZ2h0IHNvIGl0IGRvZXNuJ3QgZ28gb2ZmIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIHdpbmRvdwogICAqCiAgICogQHJldHVybiBib29sZWFuIHRydWUsIGlmIHRvb2x0aXBMYXllclN0eWxlUmlnaHQgaXMgb2suICBmYWxzZSwgb3RoZXJ3aXNlLgogICAqLwoKCiAgZnVuY3Rpb24gY2hlY2tMZWZ0KHRhcmdldE9mZnNldCwgdG9vbHRpcExheWVyU3R5bGVSaWdodCwgdG9vbHRpcE9mZnNldCwgdG9vbHRpcExheWVyKSB7CiAgICBpZiAodGFyZ2V0T2Zmc2V0LmxlZnQgKyB0YXJnZXRPZmZzZXQud2lkdGggLSB0b29sdGlwTGF5ZXJTdHlsZVJpZ2h0IC0gdG9vbHRpcE9mZnNldC53aWR0aCA8IDApIHsKICAgICAgLy8gb2ZmIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIHdpbmRvdwogICAgICB0b29sdGlwTGF5ZXIuc3R5bGUubGVmdCA9ICIiLmNvbmNhdCgtdGFyZ2V0T2Zmc2V0LmxlZnQsICJweCIpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdG9vbHRpcExheWVyLnN0eWxlLnJpZ2h0ID0gIiIuY29uY2F0KHRvb2x0aXBMYXllclN0eWxlUmlnaHQsICJweCIpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIC8qKgogICAqIFJlbW92ZSBhbiBlbnRyeSBmcm9tIGEgc3RyaW5nIGFycmF5IGlmIGl0J3MgdGhlcmUsIGRvZXMgbm90aGluZyBpZiBpdCBpc24ndCB0aGVyZS4KICAgKgogICAqIEBwYXJhbSB7QXJyYXl9IHN0cmluZ0FycmF5CiAgICogQHBhcmFtIHtTdHJpbmd9IHN0cmluZ1RvUmVtb3ZlCiAgICovCgoKICBmdW5jdGlvbiByZW1vdmVFbnRyeShzdHJpbmdBcnJheSwgc3RyaW5nVG9SZW1vdmUpIHsKICAgIGlmIChzdHJpbmdBcnJheS5pbmNsdWRlcyhzdHJpbmdUb1JlbW92ZSkpIHsKICAgICAgc3RyaW5nQXJyYXkuc3BsaWNlKHN0cmluZ0FycmF5LmluZGV4T2Yoc3RyaW5nVG9SZW1vdmUpLCAxKTsKICAgIH0KICB9CiAgLyoqCiAgICogYXV0by1kZXRlcm1pbmUgYWxpZ25tZW50CiAgICogQHBhcmFtIHtJbnRlZ2VyfSAgb2Zmc2V0TGVmdAogICAqIEBwYXJhbSB7SW50ZWdlcn0gIHRvb2x0aXBXaWR0aAogICAqIEBwYXJhbSB7T2JqZWN0fSAgIHdpbmRvd1NpemUKICAgKiBAcGFyYW0ge1N0cmluZ30gICBkZXNpcmVkQWxpZ25tZW50CiAgICogQHJldHVybiB7U3RyaW5nfSAgY2FsY3VsYXRlZEFsaWdubWVudAogICAqLwoKCiAgZnVuY3Rpb24gX2RldGVybWluZUF1dG9BbGlnbm1lbnQob2Zmc2V0TGVmdCwgdG9vbHRpcFdpZHRoLCBfcmVmLCBkZXNpcmVkQWxpZ25tZW50KSB7CiAgICB2YXIgd2lkdGggPSBfcmVmLndpZHRoOwogICAgdmFyIGhhbGZUb29sdGlwV2lkdGggPSB0b29sdGlwV2lkdGggLyAyOwogICAgdmFyIHdpbldpZHRoID0gTWF0aC5taW4od2lkdGgsIHdpbmRvdy5zY3JlZW4ud2lkdGgpOwogICAgdmFyIHBvc3NpYmxlQWxpZ25tZW50cyA9IFsiLWxlZnQtYWxpZ25lZCIsICItbWlkZGxlLWFsaWduZWQiLCAiLXJpZ2h0LWFsaWduZWQiXTsKICAgIHZhciBjYWxjdWxhdGVkQWxpZ25tZW50ID0gIiI7IC8vIHZhbGlkIGxlZnQgbXVzdCBiZSBhdCBsZWFzdCBhIHRvb2x0aXBXaWR0aAogICAgLy8gYXdheSBmcm9tIHJpZ2h0IHNpZGUKCiAgICBpZiAod2luV2lkdGggLSBvZmZzZXRMZWZ0IDwgdG9vbHRpcFdpZHRoKSB7CiAgICAgIHJlbW92ZUVudHJ5KHBvc3NpYmxlQWxpZ25tZW50cywgIi1sZWZ0LWFsaWduZWQiKTsKICAgIH0gLy8gdmFsaWQgbWlkZGxlIG11c3QgYmUgYXQgbGVhc3QgaGFsZgogICAgLy8gd2lkdGggYXdheSBmcm9tIGJvdGggc2lkZXMKCgogICAgaWYgKG9mZnNldExlZnQgPCBoYWxmVG9vbHRpcFdpZHRoIHx8IHdpbldpZHRoIC0gb2Zmc2V0TGVmdCA8IGhhbGZUb29sdGlwV2lkdGgpIHsKICAgICAgcmVtb3ZlRW50cnkocG9zc2libGVBbGlnbm1lbnRzLCAiLW1pZGRsZS1hbGlnbmVkIik7CiAgICB9IC8vIHZhbGlkIHJpZ2h0IG11c3QgYmUgYXQgbGVhc3QgYSB0b29sdGlwV2lkdGgKICAgIC8vIHdpZHRoIGF3YXkgZnJvbSBsZWZ0IHNpZGUKCgogICAgaWYgKG9mZnNldExlZnQgPCB0b29sdGlwV2lkdGgpIHsKICAgICAgcmVtb3ZlRW50cnkocG9zc2libGVBbGlnbm1lbnRzLCAiLXJpZ2h0LWFsaWduZWQiKTsKICAgIH0KCiAgICBpZiAocG9zc2libGVBbGlnbm1lbnRzLmxlbmd0aCkgewogICAgICBpZiAocG9zc2libGVBbGlnbm1lbnRzLmluY2x1ZGVzKGRlc2lyZWRBbGlnbm1lbnQpKSB7CiAgICAgICAgLy8gdGhlIGRlc2lyZWQgYWxpZ25tZW50IGlzIHZhbGlkCiAgICAgICAgY2FsY3VsYXRlZEFsaWdubWVudCA9IGRlc2lyZWRBbGlnbm1lbnQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gcGljayB0aGUgZmlyc3QgdmFsaWQgcG9zaXRpb24sIGluIG9yZGVyCiAgICAgICAgY2FsY3VsYXRlZEFsaWdubWVudCA9IHBvc3NpYmxlQWxpZ25tZW50c1swXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gaWYgc2NyZWVuIHdpZHRoIGlzIHRvbyBzbWFsbAogICAgICAvLyBmb3IgQU5ZIGFsaWdubWVudCwgbWlkZGxlIGlzCiAgICAgIC8vIHByb2JhYmx5IHRoZSBiZXN0IGZvciB2aXNpYmlsaXR5CiAgICAgIGNhbGN1bGF0ZWRBbGlnbm1lbnQgPSAiLW1pZGRsZS1hbGlnbmVkIjsKICAgIH0KCiAgICByZXR1cm4gY2FsY3VsYXRlZEFsaWdubWVudDsKICB9CiAgLyoqCiAgICogRGV0ZXJtaW5lcyB0aGUgcG9zaXRpb24gb2YgdGhlIHRvb2x0aXAgYmFzZWQgb24gdGhlIHBvc2l0aW9uIHByZWNlZGVuY2UgYW5kIGF2YWlsYWJpbGl0eQogICAqIG9mIHNjcmVlbiBzcGFjZS4KICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSAgICB0YXJnZXRFbGVtZW50CiAgICogQHBhcmFtIHtPYmplY3R9ICAgIHRvb2x0aXBMYXllcgogICAqIEBwYXJhbSB7U3RyaW5nfSAgICBkZXNpcmVkVG9vbHRpcFBvc2l0aW9uCiAgICogQHJldHVybiB7U3RyaW5nfSAgIGNhbGN1bGF0ZWRQb3NpdGlvbgogICAqLwoKCiAgZnVuY3Rpb24gX2RldGVybWluZUF1dG9Qb3NpdGlvbih0YXJnZXRFbGVtZW50LCB0b29sdGlwTGF5ZXIsIGRlc2lyZWRUb29sdGlwUG9zaXRpb24pIHsKICAgIC8vIFRha2UgYSBjbG9uZSBvZiBwb3NpdGlvbiBwcmVjZWRlbmNlLiBUaGVzZSB3aWxsIGJlIHRoZSBhdmFpbGFibGUKICAgIHZhciBwb3NzaWJsZVBvc2l0aW9ucyA9IHRoaXMuX29wdGlvbnMucG9zaXRpb25QcmVjZWRlbmNlLnNsaWNlKCk7CgogICAgdmFyIHdpbmRvd1NpemUgPSBnZXRXaW5TaXplKCk7CiAgICB2YXIgdG9vbHRpcEhlaWdodCA9IGdldE9mZnNldCh0b29sdGlwTGF5ZXIpLmhlaWdodCArIDEwOwogICAgdmFyIHRvb2x0aXBXaWR0aCA9IGdldE9mZnNldCh0b29sdGlwTGF5ZXIpLndpZHRoICsgMjA7CiAgICB2YXIgdGFyZ2V0RWxlbWVudFJlY3QgPSB0YXJnZXRFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyAvLyBJZiB3ZSBjaGVjayBhbGwgdGhlIHBvc3NpYmxlIGFyZWFzLCBhbmQgdGhlcmUgYXJlIG5vIHZhbGlkIHBsYWNlcyBmb3IgdGhlIHRvb2x0aXAsIHRoZSBlbGVtZW50CiAgICAvLyBtdXN0IHRha2UgdXAgbW9zdCBvZiB0aGUgc2NyZWVuIHJlYWwgZXN0YXRlLiBTaG93IHRoZSB0b29sdGlwIGZsb2F0aW5nIGluIHRoZSBtaWRkbGUgb2YgdGhlIHNjcmVlbi4KCiAgICB2YXIgY2FsY3VsYXRlZFBvc2l0aW9uID0gImZsb2F0aW5nIjsKICAgIC8qCiAgICAgKiBhdXRvIGRldGVybWluZSBwb3NpdGlvbgogICAgICovCiAgICAvLyBDaGVjayBmb3Igc3BhY2UgYmVsb3cKCiAgICBpZiAodGFyZ2V0RWxlbWVudFJlY3QuYm90dG9tICsgdG9vbHRpcEhlaWdodCA+IHdpbmRvd1NpemUuaGVpZ2h0KSB7CiAgICAgIHJlbW92ZUVudHJ5KHBvc3NpYmxlUG9zaXRpb25zLCAiYm90dG9tIik7CiAgICB9IC8vIENoZWNrIGZvciBzcGFjZSBhYm92ZQoKCiAgICBpZiAodGFyZ2V0RWxlbWVudFJlY3QudG9wIC0gdG9vbHRpcEhlaWdodCA8IDApIHsKICAgICAgcmVtb3ZlRW50cnkocG9zc2libGVQb3NpdGlvbnMsICJ0b3AiKTsKICAgIH0gLy8gQ2hlY2sgZm9yIHNwYWNlIHRvIHRoZSByaWdodAoKCiAgICBpZiAodGFyZ2V0RWxlbWVudFJlY3QucmlnaHQgKyB0b29sdGlwV2lkdGggPiB3aW5kb3dTaXplLndpZHRoKSB7CiAgICAgIHJlbW92ZUVudHJ5KHBvc3NpYmxlUG9zaXRpb25zLCAicmlnaHQiKTsKICAgIH0gLy8gQ2hlY2sgZm9yIHNwYWNlIHRvIHRoZSBsZWZ0CgoKICAgIGlmICh0YXJnZXRFbGVtZW50UmVjdC5sZWZ0IC0gdG9vbHRpcFdpZHRoIDwgMCkgewogICAgICByZW1vdmVFbnRyeShwb3NzaWJsZVBvc2l0aW9ucywgImxlZnQiKTsKICAgIH0gLy8gQHZhciB7U3RyaW5nfSAgZXg6ICdyaWdodC1hbGlnbmVkJwoKCiAgICB2YXIgZGVzaXJlZEFsaWdubWVudCA9IGZ1bmN0aW9uIChwb3MpIHsKICAgICAgdmFyIGh5cGhlbkluZGV4ID0gcG9zLmluZGV4T2YoIi0iKTsKCiAgICAgIGlmIChoeXBoZW5JbmRleCAhPT0gLTEpIHsKICAgICAgICAvLyBoYXMgYWxpZ25tZW50CiAgICAgICAgcmV0dXJuIHBvcy5zdWJzdHIoaHlwaGVuSW5kZXgpOwogICAgICB9CgogICAgICByZXR1cm4gIiI7CiAgICB9KGRlc2lyZWRUb29sdGlwUG9zaXRpb24gfHwgIiIpOyAvLyBzdHJpcCBhbGlnbm1lbnQgZnJvbSBwb3NpdGlvbgoKCiAgICBpZiAoZGVzaXJlZFRvb2x0aXBQb3NpdGlvbikgewogICAgICAvLyBleDogImJvdHRvbS1yaWdodC1hbGlnbmVkIgogICAgICAvLyBzaG91bGQgcmV0dXJuICdib3R0b20nCiAgICAgIGRlc2lyZWRUb29sdGlwUG9zaXRpb24gPSBkZXNpcmVkVG9vbHRpcFBvc2l0aW9uLnNwbGl0KCItIilbMF07CiAgICB9CgogICAgaWYgKHBvc3NpYmxlUG9zaXRpb25zLmxlbmd0aCkgewogICAgICBpZiAoZGVzaXJlZFRvb2x0aXBQb3NpdGlvbiAhPT0gImF1dG8iICYmIHBvc3NpYmxlUG9zaXRpb25zLmluY2x1ZGVzKGRlc2lyZWRUb29sdGlwUG9zaXRpb24pKSB7CiAgICAgICAgLy8gSWYgdGhlIHJlcXVlc3RlZCBwb3NpdGlvbiBpcyBpbiB0aGUgbGlzdCwgY2hvb3NlIHRoYXQKICAgICAgICBjYWxjdWxhdGVkUG9zaXRpb24gPSBkZXNpcmVkVG9vbHRpcFBvc2l0aW9uOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFBpY2sgdGhlIGZpcnN0IHZhbGlkIHBvc2l0aW9uLCBpbiBvcmRlcgogICAgICAgIGNhbGN1bGF0ZWRQb3NpdGlvbiA9IHBvc3NpYmxlUG9zaXRpb25zWzBdOwogICAgICB9CiAgICB9IC8vIG9ubHkgdG9wIGFuZCBib3R0b20gcG9zaXRpb25zIGhhdmUgb3B0aW9uYWwgYWxpZ25tZW50cwoKCiAgICBpZiAoWyJ0b3AiLCAiYm90dG9tIl0uaW5jbHVkZXMoY2FsY3VsYXRlZFBvc2l0aW9uKSkgewogICAgICBjYWxjdWxhdGVkUG9zaXRpb24gKz0gX2RldGVybWluZUF1dG9BbGlnbm1lbnQodGFyZ2V0RWxlbWVudFJlY3QubGVmdCwgdG9vbHRpcFdpZHRoLCB3aW5kb3dTaXplLCBkZXNpcmVkQWxpZ25tZW50KTsKICAgIH0KCiAgICByZXR1cm4gY2FsY3VsYXRlZFBvc2l0aW9uOwogIH0KICAvKioKICAgKiBSZW5kZXIgdG9vbHRpcCBib3ggaW4gdGhlIHBhZ2UKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgcGxhY2VUb29sdGlwCiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFyZ2V0RWxlbWVudAogICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRvb2x0aXBMYXllcgogICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGFycm93TGF5ZXIKICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBoZWxwZXJOdW1iZXJMYXllcgogICAqIEBwYXJhbSB7Qm9vbGVhbn0gaGludE1vZGUKICAgKi8KCgogIGZ1bmN0aW9uIHBsYWNlVG9vbHRpcCh0YXJnZXRFbGVtZW50LCB0b29sdGlwTGF5ZXIsIGFycm93TGF5ZXIsIGhlbHBlck51bWJlckxheWVyLCBoaW50TW9kZSkgewogICAgdmFyIHRvb2x0aXBDc3NDbGFzcyA9ICIiOwogICAgdmFyIGN1cnJlbnRTdGVwT2JqOwogICAgdmFyIHRvb2x0aXBPZmZzZXQ7CiAgICB2YXIgdGFyZ2V0T2Zmc2V0OwogICAgdmFyIHdpbmRvd1NpemU7CiAgICB2YXIgY3VycmVudFRvb2x0aXBQb3NpdGlvbjsKICAgIGhpbnRNb2RlID0gaGludE1vZGUgfHwgZmFsc2U7IC8vcmVzZXQgdGhlIG9sZCBzdHlsZQoKICAgIHRvb2x0aXBMYXllci5zdHlsZS50b3AgPSBudWxsOwogICAgdG9vbHRpcExheWVyLnN0eWxlLnJpZ2h0ID0gbnVsbDsKICAgIHRvb2x0aXBMYXllci5zdHlsZS5ib3R0b20gPSBudWxsOwogICAgdG9vbHRpcExheWVyLnN0eWxlLmxlZnQgPSBudWxsOwogICAgdG9vbHRpcExheWVyLnN0eWxlLm1hcmdpbkxlZnQgPSBudWxsOwogICAgdG9vbHRpcExheWVyLnN0eWxlLm1hcmdpblRvcCA9IG51bGw7CiAgICBhcnJvd0xheWVyLnN0eWxlLmRpc3BsYXkgPSAiaW5oZXJpdCI7CgogICAgaWYgKHR5cGVvZiBoZWxwZXJOdW1iZXJMYXllciAhPT0gInVuZGVmaW5lZCIgJiYgaGVscGVyTnVtYmVyTGF5ZXIgIT09IG51bGwpIHsKICAgICAgaGVscGVyTnVtYmVyTGF5ZXIuc3R5bGUudG9wID0gbnVsbDsKICAgICAgaGVscGVyTnVtYmVyTGF5ZXIuc3R5bGUubGVmdCA9IG51bGw7CiAgICB9IC8vcHJldmVudCBlcnJvciB3aGVuIGB0aGlzLl9jdXJyZW50U3RlcGAgaXMgdW5kZWZpbmVkCgoKICAgIGlmICghdGhpcy5faW50cm9JdGVtc1t0aGlzLl9jdXJyZW50U3RlcF0pIHJldHVybjsgLy9pZiB3ZSBoYXZlIGEgY3VzdG9tIGNzcyBjbGFzcyBmb3IgZWFjaCBzdGVwCgogICAgY3VycmVudFN0ZXBPYmogPSB0aGlzLl9pbnRyb0l0ZW1zW3RoaXMuX2N1cnJlbnRTdGVwXTsKCiAgICBpZiAodHlwZW9mIGN1cnJlbnRTdGVwT2JqLnRvb2x0aXBDbGFzcyA9PT0gInN0cmluZyIpIHsKICAgICAgdG9vbHRpcENzc0NsYXNzID0gY3VycmVudFN0ZXBPYmoudG9vbHRpcENsYXNzOwogICAgfSBlbHNlIHsKICAgICAgdG9vbHRpcENzc0NsYXNzID0gdGhpcy5fb3B0aW9ucy50b29sdGlwQ2xhc3M7CiAgICB9CgogICAgdG9vbHRpcExheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLXRvb2x0aXAgIi5jb25jYXQodG9vbHRpcENzc0NsYXNzKS5yZXBsYWNlKC9eXHMrfFxzKyQvZywgIiIpOwogICAgdG9vbHRpcExheWVyLnNldEF0dHJpYnV0ZSgicm9sZSIsICJkaWFsb2ciKTsKICAgIGN1cnJlbnRUb29sdGlwUG9zaXRpb24gPSB0aGlzLl9pbnRyb0l0ZW1zW3RoaXMuX2N1cnJlbnRTdGVwXS5wb3NpdGlvbjsgLy8gRmxvYXRpbmcgaXMgYWx3YXlzIHZhbGlkLCBubyBwb2ludCBpbiBjYWxjdWxhdGluZwoKICAgIGlmIChjdXJyZW50VG9vbHRpcFBvc2l0aW9uICE9PSAiZmxvYXRpbmciKSB7Ly8gY3VycmVudFRvb2x0aXBQb3NpdGlvbiA9IF9kZXRlcm1pbmVBdXRvUG9zaXRpb24uY2FsbCh0aGlzLCB0YXJnZXRFbGVtZW50LCB0b29sdGlwTGF5ZXIsIGN1cnJlbnRUb29sdGlwUG9zaXRpb24pOwogICAgfQoKICAgIHZhciB0b29sdGlwTGF5ZXJTdHlsZUxlZnQ7CiAgICB0YXJnZXRPZmZzZXQgPSBnZXRPZmZzZXQodGFyZ2V0RWxlbWVudCk7CiAgICB0b29sdGlwT2Zmc2V0ID0gZ2V0T2Zmc2V0KHRvb2x0aXBMYXllcik7CiAgICB3aW5kb3dTaXplID0gZ2V0V2luU2l6ZSgpOwogICAgYWRkQ2xhc3ModG9vbHRpcExheWVyLCAiaW50cm9qcy0iLmNvbmNhdChjdXJyZW50VG9vbHRpcFBvc2l0aW9uKSk7CgogICAgc3dpdGNoIChjdXJyZW50VG9vbHRpcFBvc2l0aW9uKSB7CiAgICAgIGNhc2UgInRvcC1yaWdodC1hbGlnbmVkIjoKICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IGJvdHRvbS1yaWdodCI7CiAgICAgICAgdmFyIHRvb2x0aXBMYXllclN0eWxlUmlnaHQgPSAwOwogICAgICAgIGNoZWNrTGVmdCh0YXJnZXRPZmZzZXQsIHRvb2x0aXBMYXllclN0eWxlUmlnaHQsIHRvb2x0aXBPZmZzZXQsIHRvb2x0aXBMYXllcik7CiAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLmJvdHRvbSA9ICIiLmNvbmNhdCh0YXJnZXRPZmZzZXQuaGVpZ2h0ICsgMjAsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAidG9wLW1pZGRsZS1hbGlnbmVkIjoKICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IGJvdHRvbS1taWRkbGUiOwogICAgICAgIHZhciB0b29sdGlwTGF5ZXJTdHlsZUxlZnRSaWdodCA9IHRhcmdldE9mZnNldC53aWR0aCAvIDIgLSB0b29sdGlwT2Zmc2V0LndpZHRoIC8gMjsgLy8gYSBmaXggZm9yIG1pZGRsZSBhbGlnbmVkIGhpbnRzCgogICAgICAgIGlmIChoaW50TW9kZSkgewogICAgICAgICAgdG9vbHRpcExheWVyU3R5bGVMZWZ0UmlnaHQgKz0gNTsKICAgICAgICB9CgogICAgICAgIGlmIChjaGVja0xlZnQodGFyZ2V0T2Zmc2V0LCB0b29sdGlwTGF5ZXJTdHlsZUxlZnRSaWdodCwgdG9vbHRpcE9mZnNldCwgdG9vbHRpcExheWVyKSkgewogICAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLnJpZ2h0ID0gbnVsbDsKICAgICAgICAgIGNoZWNrUmlnaHQodGFyZ2V0T2Zmc2V0LCB0b29sdGlwTGF5ZXJTdHlsZUxlZnRSaWdodCwgdG9vbHRpcE9mZnNldCwgd2luZG93U2l6ZSwgdG9vbHRpcExheWVyKTsKICAgICAgICB9CgogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5ib3R0b20gPSAiIi5jb25jYXQodGFyZ2V0T2Zmc2V0LmhlaWdodCArIDIwLCAicHgiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgInRvcC1sZWZ0LWFsaWduZWQiOiAvLyB0b3AtbGVmdC1hbGlnbmVkIGlzIHRoZSBzYW1lIGFzIHRoZSBkZWZhdWx0IHRvcAoKICAgICAgY2FzZSAidG9wIjoKICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IGJvdHRvbSI7CiAgICAgICAgdG9vbHRpcExheWVyU3R5bGVMZWZ0ID0gaGludE1vZGUgPyAwIDogMTU7CiAgICAgICAgY2hlY2tSaWdodCh0YXJnZXRPZmZzZXQsIHRvb2x0aXBMYXllclN0eWxlTGVmdCwgdG9vbHRpcE9mZnNldCwgd2luZG93U2l6ZSwgdG9vbHRpcExheWVyKTsKICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUuYm90dG9tID0gIiIuY29uY2F0KHRhcmdldE9mZnNldC5oZWlnaHQgKyAyMCwgInB4Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJyaWdodCI6CiAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLmxlZnQgPSAiIi5jb25jYXQodGFyZ2V0T2Zmc2V0LndpZHRoICsgMjAgKyA2MywgInB4Iik7CiAgICAgICAgdmFyIGltYWdlTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKTsKICAgICAgICBpbWFnZUxheWVyLnNyYyA9ICIvaW1nL0dyb3VwMy5zdmciOwogICAgICAgIHZhciBwYXJlbnRfZGl2X2Zvcl9pbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b20tYXJyb3ctaW1hZ2UtY2Vuc2UiKTsKCiAgICAgICAgaWYgKHRhcmdldE9mZnNldC50b3AgKyB0b29sdGlwT2Zmc2V0LmhlaWdodCA+IHdpbmRvd1NpemUuaGVpZ2h0KSB7CiAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIHJpZ2h0IHdvdWxkIGhhdmUgZmFsbGVuIGJlbG93IHRoZSBib3R0b20gb2YgdGhlIHNjcmVlbi4KICAgICAgICAgIC8vIE1vZGlmeSBzbyB0aGF0IHRoZSBib3R0b20gb2YgdGhlIHRvb2x0aXAgY29ubmVjdHMgd2l0aCB0aGUgdGFyZ2V0CiAgICAgICAgICAvLyBhcnJvd0xheWVyLmFwcGVuZENoaWxkKGltYWdlTGF5ZXIpOwogICAgICAgICAgLy8gcGFyZW50X2Rpdl9mb3JfaW1hZ2UuYXBwZW5kQ2hpbGQoaW1hZ2VMYXllcik7CiAgICAgICAgICBwYXJlbnRfZGl2X2Zvcl9pbWFnZS5zdHlsZS5wb3NpdGlvbiA9ICJyZWxhdGl2ZSI7CiAgICAgICAgICBwYXJlbnRfZGl2X2Zvcl9pbWFnZS5zdHlsZS5sZWZ0ID0gIi02N3B4IjsKICAgICAgICAgIHBhcmVudF9kaXZfZm9yX2ltYWdlLnN0eWxlLnRvcCA9ICIiLmNvbmNhdCh0YXJnZXRPZmZzZXQuaGVpZ2h0IC0gMTAsICJweCIpOwogICAgICAgICAgYXJyb3dMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy1hcnJvdyBsZWZ0LWJvdHRvbSI7CiAgICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUudG9wID0gIi0iLmNvbmNhdCh0b29sdGlwT2Zmc2V0LmhlaWdodCAtIHRhcmdldE9mZnNldC5oZWlnaHQgLSAyMCwgInB4Iik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIGFycm93TGF5ZXIuYXBwZW5kQ2hpbGQoaW1hZ2VMYXllcik7CiAgICAgICAgICAvLyBwYXJlbnRfZGl2X2Zvcl9pbWFnZS5hcHBlbmRDaGlsZChpbWFnZUxheWVyKTsKICAgICAgICAgIHBhcmVudF9kaXZfZm9yX2ltYWdlLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKICAgICAgICAgIHBhcmVudF9kaXZfZm9yX2ltYWdlLnN0eWxlLmxlZnQgPSAiLTY3cHgiOwogICAgICAgICAgcGFyZW50X2Rpdl9mb3JfaW1hZ2Uuc3R5bGUudG9wID0gIiIuY29uY2F0KHRhcmdldE9mZnNldC5oZWlnaHQgLSAxMCwgInB4Iik7IC8vIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3cgbGVmdCI7CgogICAgICAgICAgYXJyb3dMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy1hcnJvdyBsZWZ0LWJvdHRvbSI7CiAgICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUudG9wID0gIi0iLmNvbmNhdCh0b29sdGlwT2Zmc2V0LmhlaWdodCAtIHRhcmdldE9mZnNldC5oZWlnaHQgLSAyMCwgInB4Iik7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImxlZnQiOgogICAgICAgIGlmICghaGludE1vZGUgJiYgdGhpcy5fb3B0aW9ucy5zaG93U3RlcE51bWJlcnMgPT09IHRydWUpIHsKICAgICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS50b3AgPSAiMTVweCI7CiAgICAgICAgfQoKICAgICAgICBpZiAodGFyZ2V0T2Zmc2V0LnRvcCArIHRvb2x0aXBPZmZzZXQuaGVpZ2h0ID4gd2luZG93U2l6ZS5oZWlnaHQpIHsKICAgICAgICAgIC8vIEluIHRoaXMgY2FzZSwgbGVmdCB3b3VsZCBoYXZlIGZhbGxlbiBiZWxvdyB0aGUgYm90dG9tIG9mIHRoZSBzY3JlZW4uCiAgICAgICAgICAvLyBNb2RpZnkgc28gdGhhdCB0aGUgYm90dG9tIG9mIHRoZSB0b29sdGlwIGNvbm5lY3RzIHdpdGggdGhlIHRhcmdldAogICAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLnRvcCA9ICItIi5jb25jYXQodG9vbHRpcE9mZnNldC5oZWlnaHQgLSB0YXJnZXRPZmZzZXQuaGVpZ2h0IC0gMjAsICJweCIpOwogICAgICAgICAgYXJyb3dMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy1hcnJvdyByaWdodC1ib3R0b20iOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IHJpZ2h0IjsKICAgICAgICB9CgogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5yaWdodCA9ICIiLmNvbmNhdCh0YXJnZXRPZmZzZXQud2lkdGggKyAyMCwgInB4Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJmbG9hdGluZyI6CiAgICAgICAgYXJyb3dMYXllci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOyAvL3dlIGhhdmUgdG8gYWRqdXN0IHRoZSB0b3AgYW5kIGxlZnQgb2YgbGF5ZXIgbWFudWFsbHkgZm9yIGludHJvIGl0ZW1zIHdpdGhvdXQgZWxlbWVudAoKICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUubGVmdCA9ICI1MCUiOwogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS50b3AgPSAiNTAlIjsKICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUubWFyZ2luTGVmdCA9ICItIi5jb25jYXQodG9vbHRpcE9mZnNldC53aWR0aCAvIDIsICJweCIpOwogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5tYXJnaW5Ub3AgPSAiLSIuY29uY2F0KHRvb2x0aXBPZmZzZXQuaGVpZ2h0IC8gMiwgInB4Iik7CgogICAgICAgIGlmICh0eXBlb2YgaGVscGVyTnVtYmVyTGF5ZXIgIT09ICJ1bmRlZmluZWQiICYmIGhlbHBlck51bWJlckxheWVyICE9PSBudWxsKSB7CiAgICAgICAgICBoZWxwZXJOdW1iZXJMYXllci5zdHlsZS5sZWZ0ID0gIi0iLmNvbmNhdCh0b29sdGlwT2Zmc2V0LndpZHRoIC8gMiArIDE4LCAicHgiKTsKICAgICAgICAgIGhlbHBlck51bWJlckxheWVyLnN0eWxlLnRvcCA9ICItIi5jb25jYXQodG9vbHRpcE9mZnNldC5oZWlnaHQgLyAyICsgMTgsICJweCIpOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJib3R0b20tcmlnaHQtYWxpZ25lZCI6CiAgICAgICAgYXJyb3dMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy1hcnJvdyB0b3AtcmlnaHQiOwogICAgICAgIHRvb2x0aXBMYXllclN0eWxlUmlnaHQgPSAwOwogICAgICAgIGNoZWNrTGVmdCh0YXJnZXRPZmZzZXQsIHRvb2x0aXBMYXllclN0eWxlUmlnaHQsIHRvb2x0aXBPZmZzZXQsIHRvb2x0aXBMYXllcik7CiAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLnRvcCA9ICIiLmNvbmNhdCh0YXJnZXRPZmZzZXQuaGVpZ2h0ICsgMjAsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiYm90dG9tLW1pZGRsZS1hbGlnbmVkIjoKICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IHRvcC1taWRkbGUiOwogICAgICAgIHRvb2x0aXBMYXllclN0eWxlTGVmdFJpZ2h0ID0gdGFyZ2V0T2Zmc2V0LndpZHRoIC8gMiAtIHRvb2x0aXBPZmZzZXQud2lkdGggLyAyOyAvLyBhIGZpeCBmb3IgbWlkZGxlIGFsaWduZWQgaGludHMKCiAgICAgICAgaWYgKGhpbnRNb2RlKSB7CiAgICAgICAgICB0b29sdGlwTGF5ZXJTdHlsZUxlZnRSaWdodCArPSA1OwogICAgICAgIH0KCiAgICAgICAgaWYgKGNoZWNrTGVmdCh0YXJnZXRPZmZzZXQsIHRvb2x0aXBMYXllclN0eWxlTGVmdFJpZ2h0LCB0b29sdGlwT2Zmc2V0LCB0b29sdGlwTGF5ZXIpKSB7CiAgICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUucmlnaHQgPSBudWxsOwogICAgICAgICAgY2hlY2tSaWdodCh0YXJnZXRPZmZzZXQsIHRvb2x0aXBMYXllclN0eWxlTGVmdFJpZ2h0LCB0b29sdGlwT2Zmc2V0LCB3aW5kb3dTaXplLCB0b29sdGlwTGF5ZXIpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGdldF9sZWZ0X29mZnNldCA9IE1hdGgubWF4KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCk7CiAgICAgICAgdmFyIGdldF90b3Bfb2Zmc2V0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDsgLy8gdG9vbHRpcExheWVyLnN0eWxlLnRvcCA9ICIiLmNvbmNhdCh0YXJnZXRPZmZzZXQuaGVpZ2h0ICsgMjAsICJweCIpOwoKICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUudG9wID0gIiIuY29uY2F0KGdldF90b3Bfb2Zmc2V0IC8gMi4zLCAicHgiKTsKICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUubGVmdCA9ICIiLmNvbmNhdChnZXRfbGVmdF9vZmZzZXQgLyAyLjUsICJweCIpOwogICAgICAgIGJyZWFrOwogICAgICAvLyBjYXNlICdib3R0b20tbGVmdC1hbGlnbmVkJzoKICAgICAgLy8gQm90dG9tLWxlZnQtYWxpZ25lZCBpcyB0aGUgc2FtZSBhcyB0aGUgZGVmYXVsdCBib3R0b20KICAgICAgLy8gY2FzZSAnYm90dG9tJzoKICAgICAgLy8gQm90dG9tIGdvaW5nIHRvIGZvbGxvdyB0aGUgZGVmYXVsdCBiZWhhdmlvcgoKICAgICAgZGVmYXVsdDoKICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IHRvcCI7CiAgICAgICAgdG9vbHRpcExheWVyU3R5bGVMZWZ0ID0gMDsKICAgICAgICBjaGVja1JpZ2h0KHRhcmdldE9mZnNldCwgdG9vbHRpcExheWVyU3R5bGVMZWZ0LCB0b29sdGlwT2Zmc2V0LCB3aW5kb3dTaXplLCB0b29sdGlwTGF5ZXIpOwogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS50b3AgPSAiIi5jb25jYXQodGFyZ2V0T2Zmc2V0LmhlaWdodCArIDIwLCAicHgiKTsKICAgIH0KICB9CiAgLyoqCiAgICogVG8gcmVtb3ZlIGFsbCBzaG93IGVsZW1lbnQocykKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3JlbW92ZVNob3dFbGVtZW50CiAgICovCgoKICBmdW5jdGlvbiByZW1vdmVTaG93RWxlbWVudCgpIHsKICAgIHZhciBlbG1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtc2hvd0VsZW1lbnQiKTsKICAgIGZvckVhY2goZWxtcywgZnVuY3Rpb24gKGVsbSkgewogICAgICByZW1vdmVDbGFzcyhlbG0sIC9pbnRyb2pzLVthLXpBLVpdKy9nKTsKICAgIH0pOwogIH0KICAvKioKICAgKiBHZXRzIHRoZSBjdXJyZW50IHByb2dyZXNzIHBlcmNlbnRhZ2UKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2dldFByb2dyZXNzCiAgICogQHJldHVybnMgY3VycmVudCBwcm9ncmVzcyBwZXJjZW50YWdlCiAgICovCgoKICBmdW5jdGlvbiBfZ2V0UHJvZ3Jlc3MoKSB7CiAgICAvLyBTdGVwcyBhcmUgMCBpbmRleGVkCiAgICB2YXIgY3VycmVudFN0ZXAgPSBwYXJzZUludCh0aGlzLl9jdXJyZW50U3RlcCArIDEsIDEwKTsKICAgIHJldHVybiBjdXJyZW50U3RlcCAvIHRoaXMuX2ludHJvSXRlbXMubGVuZ3RoICogMTAwOwogIH0KICAvKioKICAgKiBBZGQgZGlzYWJsZWludGVyYWN0aW9uIGxheWVyIGFuZCBhZGp1c3QgdGhlIHNpemUgYW5kIHBvc2l0aW9uIG9mIHRoZSBsYXllcgogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfZGlzYWJsZUludGVyYWN0aW9uCiAgICovCgoKICBmdW5jdGlvbiBfZGlzYWJsZUludGVyYWN0aW9uKCkgewogICAgdmFyIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtZGlzYWJsZUludGVyYWN0aW9uIik7CgogICAgaWYgKGRpc2FibGVJbnRlcmFjdGlvbkxheWVyID09PSBudWxsKSB7CiAgICAgIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWRpc2FibGVJbnRlcmFjdGlvbiI7CgogICAgICB0aGlzLl90YXJnZXRFbGVtZW50LmFwcGVuZENoaWxkKGRpc2FibGVJbnRlcmFjdGlvbkxheWVyKTsKICAgIH0KCiAgICBzZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwodGhpcywgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIpOwogIH0KICAvKioKICAgKiBTaG93IGFuIGVsZW1lbnQgb24gdGhlIHBhZ2UKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3Nob3dFbGVtZW50CiAgICogQHBhcmFtIHtPYmplY3R9IHRhcmdldEVsZW1lbnQKICAgKi8KCgogIGZ1bmN0aW9uIF9zaG93RWxlbWVudCh0YXJnZXRFbGVtZW50KSB7CiAgICBpZiAodHlwZW9mIHRoaXMuX2ludHJvQ2hhbmdlQ2FsbGJhY2sgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHRoaXMuX2ludHJvQ2hhbmdlQ2FsbGJhY2suY2FsbCh0aGlzLCB0YXJnZXRFbGVtZW50LmVsZW1lbnQpOwogICAgfQoKICAgIHZhciBzZWxmID0gdGhpczsKICAgIHZhciBvbGRIZWxwZXJMYXllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhlbHBlckxheWVyIik7CiAgICB2YXIgb2xkUmVmZXJlbmNlTGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy10b29sdGlwUmVmZXJlbmNlTGF5ZXIiKTsKICAgIHZhciBoaWdobGlnaHRDbGFzcyA9ICJpbnRyb2pzLWhlbHBlckxheWVyIjsKICAgIHZhciBuZXh0VG9vbHRpcEJ1dHRvbjsKICAgIHZhciBwcmV2VG9vbHRpcEJ1dHRvbjsKICAgIHZhciBza2lwVG9vbHRpcEJ1dHRvbjsKICAgIHZhciBzY3JvbGxQYXJlbnQ7IC8vY2hlY2sgZm9yIGEgY3VycmVudCBzdGVwIGhpZ2hsaWdodCBjbGFzcwoKICAgIGlmICh0eXBlb2YgdGFyZ2V0RWxlbWVudC5oaWdobGlnaHRDbGFzcyA9PT0gInN0cmluZyIpIHsKICAgICAgaGlnaGxpZ2h0Q2xhc3MgKz0gIiAiLmNvbmNhdCh0YXJnZXRFbGVtZW50LmhpZ2hsaWdodENsYXNzKTsKICAgIH0gLy9jaGVjayBmb3Igb3B0aW9ucyBoaWdobGlnaHQgY2xhc3MKCgogICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLmhpZ2hsaWdodENsYXNzID09PSAic3RyaW5nIikgewogICAgICBoaWdobGlnaHRDbGFzcyArPSAiICIuY29uY2F0KHRoaXMuX29wdGlvbnMuaGlnaGxpZ2h0Q2xhc3MpOwogICAgfQoKICAgIGlmIChvbGRIZWxwZXJMYXllciAhPT0gbnVsbCkgewogICAgICB2YXIgb2xkSGVscGVyTnVtYmVyTGF5ZXIgPSBvbGRSZWZlcmVuY2VMYXllci5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1oZWxwZXJOdW1iZXJMYXllciIpOwogICAgICB2YXIgb2xkdG9vbHRpcExheWVyID0gb2xkUmVmZXJlbmNlTGF5ZXIucXVlcnlTZWxlY3RvcigiLmludHJvanMtdG9vbHRpcHRleHQiKTsKICAgICAgdmFyIG9sZEFycm93TGF5ZXIgPSBvbGRSZWZlcmVuY2VMYXllci5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1hcnJvdyIpOwogICAgICB2YXIgb2xkdG9vbHRpcENvbnRhaW5lciA9IG9sZFJlZmVyZW5jZUxheWVyLnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLXRvb2x0aXAiKTsKICAgICAgc2tpcFRvb2x0aXBCdXR0b24gPSBvbGRSZWZlcmVuY2VMYXllci5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1za2lwYnV0dG9uIik7CiAgICAgIHByZXZUb29sdGlwQnV0dG9uID0gb2xkUmVmZXJlbmNlTGF5ZXIucXVlcnlTZWxlY3RvcigiLmludHJvanMtcHJldmJ1dHRvbiIpOwogICAgICBuZXh0VG9vbHRpcEJ1dHRvbiA9IG9sZFJlZmVyZW5jZUxheWVyLnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLW5leHRidXR0b24iKTsgLy91cGRhdGUgb3IgcmVzZXQgdGhlIGhlbHBlciBoaWdobGlnaHQgY2xhc3MKCiAgICAgIG9sZEhlbHBlckxheWVyLmNsYXNzTmFtZSA9IGhpZ2hsaWdodENsYXNzOyAvL2hpZGUgdGhlIHRvb2x0aXAKCiAgICAgIGlmIChkb2N1bWVudC5jb250YWlucyhkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGFiZWxfZGlzcGxheV9kaXYiKSkpIHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGFiZWxfZGlzcGxheV9kaXYiKS5yZW1vdmUoKTsKICAgICAgfQoKICAgICAgaWYgKHRhcmdldEVsZW1lbnQubGFiZWxEaXNwbGF5ICE9PSAiV0VMQ09NRSIpIHsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY3VzdG9tLWFycm93LWltYWdlLWNlbnNlIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbS1hcnJvdy1pbWFnZS1jZW5zZSIpLnN0eWxlLm9wYWNpdHkgPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b20tYXJyb3ctaW1hZ2UtY2Vuc2UiKS5zdHlsZS5vcGFjaXR5ID0gMDsKICAgICAgfQoKICAgICAgdmFyIGxhYmVsX2Rpc3BsYXlfZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGxhYmVsX2Rpc3BsYXlfZGl2LmlkID0gImxhYmVsX2Rpc3BsYXlfZGl2IjsKICAgICAgbGFiZWxfZGlzcGxheV9kaXYuc3R5bGUuY29sb3IgPSAiI0ZGRkZGRiI7CiAgICAgIGxhYmVsX2Rpc3BsYXlfZGl2LnN0eWxlLnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICBsYWJlbF9kaXNwbGF5X2Rpdi5zdHlsZS5tYXJnaW5Ub3AgPSAiMC41cmVtIjsKICAgICAgbGFiZWxfZGlzcGxheV9kaXYuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5sYWJlbERpc3BsYXk7CiAgICAgIG9sZEhlbHBlckxheWVyLmFwcGVuZENoaWxkKGxhYmVsX2Rpc3BsYXlfZGl2KTsgLy8gb2xkSGVscGVyTGF5ZXIuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5sYWJlbERpc3BsYXk7CgogICAgICBvbGR0b29sdGlwQ29udGFpbmVyLnN0eWxlLm9wYWNpdHkgPSAwOwogICAgICBvbGR0b29sdGlwQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgogICAgICBpZiAob2xkSGVscGVyTnVtYmVyTGF5ZXIgIT09IG51bGwpIHsKICAgICAgICB2YXIgbGFzdEludHJvSXRlbSA9IHRoaXMuX2ludHJvSXRlbXNbdGFyZ2V0RWxlbWVudC5zdGVwIC0gMiA+PSAwID8gdGFyZ2V0RWxlbWVudC5zdGVwIC0gMiA6IDBdOwoKICAgICAgICBpZiAobGFzdEludHJvSXRlbSAhPT0gbnVsbCAmJiB0aGlzLl9kaXJlY3Rpb24gPT09ICJmb3J3YXJkIiAmJiBsYXN0SW50cm9JdGVtLnBvc2l0aW9uID09PSAiZmxvYXRpbmciIHx8IHRoaXMuX2RpcmVjdGlvbiA9PT0gImJhY2t3YXJkIiAmJiB0YXJnZXRFbGVtZW50LnBvc2l0aW9uID09PSAiZmxvYXRpbmciKSB7CiAgICAgICAgICBvbGRIZWxwZXJOdW1iZXJMYXllci5zdHlsZS5vcGFjaXR5ID0gMDsKICAgICAgICB9CiAgICAgIH0gLy8gc2Nyb2xsIHRvIGVsZW1lbnQKCgogICAgICBzY3JvbGxQYXJlbnQgPSBnZXRTY3JvbGxQYXJlbnQodGFyZ2V0RWxlbWVudC5lbGVtZW50KTsKCiAgICAgIGlmIChzY3JvbGxQYXJlbnQgIT09IGRvY3VtZW50LmJvZHkpIHsKICAgICAgICAvLyB0YXJnZXQgaXMgd2l0aGluIGEgc2Nyb2xsYWJsZSBlbGVtZW50CiAgICAgICAgc2Nyb2xsUGFyZW50VG9FbGVtZW50KHNjcm9sbFBhcmVudCwgdGFyZ2V0RWxlbWVudC5lbGVtZW50KTsKICAgICAgfSAvLyBzZXQgbmV3IHBvc2l0aW9uIHRvIGhlbHBlciBsYXllcgoKCiAgICAgIHNldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbChzZWxmLCBvbGRIZWxwZXJMYXllcik7CiAgICAgIHNldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbChzZWxmLCBvbGRSZWZlcmVuY2VMYXllcik7IC8vcmVtb3ZlIGBpbnRyb2pzLWZpeFBhcmVudGAgY2xhc3MgZnJvbSB0aGUgZWxlbWVudHMKCiAgICAgIHZhciBmaXhQYXJlbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtZml4UGFyZW50Iik7CiAgICAgIGZvckVhY2goZml4UGFyZW50cywgZnVuY3Rpb24gKHBhcmVudCkgewogICAgICAgIHJlbW92ZUNsYXNzKHBhcmVudCwgL2ludHJvanMtZml4UGFyZW50L2cpOwogICAgICB9KTsgLy9yZW1vdmUgb2xkIGNsYXNzZXMgaWYgdGhlIGVsZW1lbnQgc3RpbGwgZXhpc3QKCiAgICAgIHJlbW92ZVNob3dFbGVtZW50KCk7IC8vd2Ugc2hvdWxkIHdhaXQgdW50aWwgdGhlIENTUzMgdHJhbnNpdGlvbiBpcyBjb21wZXRlZCAoaXQncyAwLjMgc2VjKSB0byBwcmV2ZW50IGluY29ycmVjdCBgaGVpZ2h0YCBhbmQgYHdpZHRoYCBjYWxjdWxhdGlvbgoKICAgICAgaWYgKHNlbGYuX2xhc3RTaG93RWxlbWVudFRpbWVyKSB7CiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChzZWxmLl9sYXN0U2hvd0VsZW1lbnRUaW1lcik7CiAgICAgIH0KCiAgICAgIHNlbGYuX2xhc3RTaG93RWxlbWVudFRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIC8vc2V0IGN1cnJlbnQgc3RlcCB0byB0aGUgbGFiZWwKICAgICAgICBpZiAob2xkSGVscGVyTnVtYmVyTGF5ZXIgIT09IG51bGwpIHsKICAgICAgICAgIG9sZEhlbHBlck51bWJlckxheWVyLmlubmVySFRNTCA9IHRhcmdldEVsZW1lbnQuc3RlcDsKICAgICAgICB9IC8vc2V0IGN1cnJlbnQgdG9vbHRpcCB0ZXh0CgoKICAgICAgICB2YXIgdG9vbHRpcEhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImg1Iik7CiAgICAgICAgdG9vbHRpcEhlYWRlci5zdHlsZS5jb2xvciA9ICIjMjgzODc3IjsKICAgICAgICB0b29sdGlwSGVhZGVyLnN0eWxlLmZvbnRGYW1pbHkgPSAicnViaWsiOwogICAgICAgIHRvb2x0aXBIZWFkZXIuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5sYWJlbERpc3BsYXk7CiAgICAgICAgdmFyIHRvb2x0aXBCb2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgdG9vbHRpcEJvZHkuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5pbnRybzsKICAgICAgICBvbGR0b29sdGlwTGF5ZXIuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgb2xkdG9vbHRpcExheWVyLnN0eWxlLm1heFdpZHRoID0gIiI7CiAgICAgICAgb2xkdG9vbHRpcExheWVyLnN0eWxlLm1pbldpZHRoID0gIjQ2MHB4IjsgLy8gdG9vbHRpcFRleHRMYXllci5zdHlsZS5tYXhXaWR0aCA9ICIzMDBweCI7CiAgICAgICAgLy8gb2xkdG9vbHRpcExheWVyLmlubmVySFRNTCA9IHRhcmdldEVsZW1lbnQuaW50cm87IC8vc2V0IHRoZSB0b29sdGlwIHBvc2l0aW9uCgogICAgICAgIG9sZHRvb2x0aXBMYXllci5hcHBlbmRDaGlsZCh0b29sdGlwSGVhZGVyKTsKICAgICAgICBvbGR0b29sdGlwTGF5ZXIuYXBwZW5kQ2hpbGQodG9vbHRpcEJvZHkpOwogICAgICAgIG9sZHRvb2x0aXBMYXllci5zdHlsZS5tYXJnaW5Cb3R0b20gPSAiLTEuNTJyZW0iOwogICAgICAgIG9sZHRvb2x0aXBDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgb2xkdG9vbHRpcExheWVyLnN0eWxlLnBhZGRpbmdMZWZ0ID0gIjFyZW0iOyAvLyBvbGR0b29sdGlwQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAibWF4LXdpZHRoOiA3MDBweCAhaW1wb3J0YW50IjsgCgogICAgICAgIHBsYWNlVG9vbHRpcC5jYWxsKHNlbGYsIHRhcmdldEVsZW1lbnQuZWxlbWVudCwgb2xkdG9vbHRpcENvbnRhaW5lciwgb2xkQXJyb3dMYXllciwgb2xkSGVscGVyTnVtYmVyTGF5ZXIpOyAvL2NoYW5nZSBhY3RpdmUgYnVsbGV0CgogICAgICAgIGlmIChzZWxmLl9vcHRpb25zLnNob3dCdWxsZXRzKSB7CiAgICAgICAgICBvbGRSZWZlcmVuY2VMYXllci5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1idWxsZXRzIGxpID4gYS5hY3RpdmUiKS5jbGFzc05hbWUgPSAiIjsKICAgICAgICAgIG9sZFJlZmVyZW5jZUxheWVyLnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWJ1bGxldHMgbGkgPiBhW2RhdGEtc3RlcG51bWJlcj1cIiIuY29uY2F0KHRhcmdldEVsZW1lbnQuc3RlcCwgIlwiXSIpKS5jbGFzc05hbWUgPSAiYWN0aXZlIjsKICAgICAgICB9IC8vIG9sZFJlZmVyZW5jZUxheWVyLnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLXByb2dyZXNzIC5pbnRyb2pzLXByb2dyZXNzYmFyIikuc3R5bGUuY3NzVGV4dCA9ICJ3aWR0aDoiLmNvbmNhdChfZ2V0UHJvZ3Jlc3MuY2FsbChzZWxmKSwgIiU7Iik7CiAgICAgICAgLy8gb2xkUmVmZXJlbmNlTGF5ZXIucXVlcnlTZWxlY3RvcigiLmludHJvanMtcHJvZ3Jlc3MgLmludHJvanMtcHJvZ3Jlc3NiYXIiKS5zZXRBdHRyaWJ1dGUoImFyaWEtdmFsdWVub3ciLCBfZ2V0UHJvZ3Jlc3MuY2FsbChzZWxmKSk7IC8vc2hvdyB0aGUgdG9vbHRpcAoKCiAgICAgICAgb2xkdG9vbHRpcENvbnRhaW5lci5zdHlsZS5vcGFjaXR5ID0gMTsKICAgICAgICBpZiAob2xkSGVscGVyTnVtYmVyTGF5ZXIpIG9sZEhlbHBlck51bWJlckxheWVyLnN0eWxlLm9wYWNpdHkgPSAxOyAvL3Jlc2V0IGJ1dHRvbiBmb2N1cwoKICAgICAgICBpZiAodHlwZW9mIHNraXBUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBza2lwVG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCAmJiAvaW50cm9qcy1kb25lYnV0dG9uL2dpLnRlc3Qoc2tpcFRvb2x0aXBCdXR0b24uY2xhc3NOYW1lKSkgewogICAgICAgICAgLy8gc2tpcCBidXR0b24gaXMgbm93ICJkb25lIiBidXR0b24KICAgICAgICAgIHNraXBUb29sdGlwQnV0dG9uLmZvY3VzKCk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbmV4dFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIG5leHRUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgICAvL3N0aWxsIGluIHRoZSB0b3VyLCBmb2N1cyBvbiBuZXh0CiAgICAgICAgICBuZXh0VG9vbHRpcEJ1dHRvbi5mb2N1cygpOwogICAgICAgIH0gLy8gY2hhbmdlIHRoZSBzY3JvbGwgb2YgdGhlIHdpbmRvdywgaWYgbmVlZGVkCgoKICAgICAgICBzY3JvbGxUby5jYWxsKHNlbGYsIHRhcmdldEVsZW1lbnQuc2Nyb2xsVG8sIHRhcmdldEVsZW1lbnQsIG9sZHRvb2x0aXBMYXllcik7CiAgICAgIH0sIDM1MCk7IC8vIGVuZCBvZiBvbGQgZWxlbWVudCBpZi1lbHNlIGNvbmRpdGlvbgogICAgfSBlbHNlIHsKICAgICAgdmFyIGhlbHBlckxheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHZhciByZWZlcmVuY2VMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB2YXIgYXJyb3dMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB2YXIgdG9vbHRpcExheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHZhciB0b29sdGlwVGV4dExheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHZhciBidWxsZXRzTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdmFyIHByb2dyZXNzTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdmFyIGJ1dHRvbnNMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB2YXIgaW1hZ2VMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpOwogICAgICBpbWFnZUxheWVyLnNyYyA9ICIvaW1nL0dyb3VwMy5zdmciOwogICAgICBpbWFnZUxheWVyLmlkID0gImN1c3RvbS1hcnJvdy1pbWFnZS1jZW5zZSI7CiAgICAgIGltYWdlTGF5ZXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgaGVscGVyTGF5ZXIuY2xhc3NOYW1lID0gaGlnaGxpZ2h0Q2xhc3M7CiAgICAgIHJlZmVyZW5jZUxheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLXRvb2x0aXBSZWZlcmVuY2VMYXllciI7IC8vIHNjcm9sbCB0byBlbGVtZW50CgogICAgICBzY3JvbGxQYXJlbnQgPSBnZXRTY3JvbGxQYXJlbnQodGFyZ2V0RWxlbWVudC5lbGVtZW50KTsKCiAgICAgIGlmIChzY3JvbGxQYXJlbnQgIT09IGRvY3VtZW50LmJvZHkpIHsKICAgICAgICAvLyB0YXJnZXQgaXMgd2l0aGluIGEgc2Nyb2xsYWJsZSBlbGVtZW50CiAgICAgICAgc2Nyb2xsUGFyZW50VG9FbGVtZW50KHNjcm9sbFBhcmVudCwgdGFyZ2V0RWxlbWVudC5lbGVtZW50KTsKICAgICAgfSAvL3NldCBuZXcgcG9zaXRpb24gdG8gaGVscGVyIGxheWVyCgoKICAgICAgc2V0SGVscGVyTGF5ZXJQb3NpdGlvbi5jYWxsKHNlbGYsIGhlbHBlckxheWVyKTsKICAgICAgc2V0SGVscGVyTGF5ZXJQb3NpdGlvbi5jYWxsKHNlbGYsIHJlZmVyZW5jZUxheWVyKTsgLy9hZGQgaGVscGVyIGxheWVyIHRvIHRhcmdldCBlbGVtZW50CgogICAgICB0aGlzLl90YXJnZXRFbGVtZW50LmFwcGVuZENoaWxkKGhlbHBlckxheWVyKTsgLy8gdGhpcy5fdGFyZ2V0RWxlbWVudC5hcHBlbmRDaGlsZChpbWFnZUxheWVyKTsKCgogICAgICB0aGlzLl90YXJnZXRFbGVtZW50LmFwcGVuZENoaWxkKHJlZmVyZW5jZUxheWVyKTsKCiAgICAgIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3ciOwogICAgICB0b29sdGlwVGV4dExheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLXRvb2x0aXB0ZXh0IjsKICAgICAgdmFyIHRvb2x0aXBIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJoNSIpOwogICAgICB0b29sdGlwSGVhZGVyLnN0eWxlLmNvbG9yID0gIiMyODM4NzciOwogICAgICB0b29sdGlwSGVhZGVyLmlubmVySFRNTCA9ICJXRUxDT01FIjsKICAgICAgdmFyIHRvb2x0aXBCb2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHRvb2x0aXBCb2R5LmlubmVySFRNTCA9IHRhcmdldEVsZW1lbnQuaW50cm87CiAgICAgIHRvb2x0aXBUZXh0TGF5ZXIuaW5uZXJIVE1MID0gIiI7CiAgICAgIHRvb2x0aXBUZXh0TGF5ZXIuc3R5bGUubWluV2lkdGggPSAiNTAwcHgiOwogICAgICB0b29sdGlwVGV4dExheWVyLnN0eWxlLm1heFdpZHRoID0gIjMwMHB4IjsKICAgICAgdG9vbHRpcFRleHRMYXllci5hcHBlbmRDaGlsZCh0b29sdGlwSGVhZGVyKTsKICAgICAgdG9vbHRpcFRleHRMYXllci5hcHBlbmRDaGlsZCh0b29sdGlwQm9keSk7CiAgICAgIHRvb2x0aXBUZXh0TGF5ZXIuc3R5bGUubWFyZ2luQm90dG9tID0gIjAiOyAvLyB0b29sdGlwVGV4dExheWVyLmlubmVySFRNTCA9IHRhcmdldEVsZW1lbnQuaW50cm87CiAgICAgIC8vIHZhciBsYWJlbF9kaXNwbGF5X2RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAvLyBsYWJlbF9kaXNwbGF5X2Rpdi5pZCA9ICJsYWJlbF9kaXNwbGF5X2RpdiI7CiAgICAgIC8vIGxhYmVsX2Rpc3BsYXlfZGl2LnN0eWxlLmNvbG9yID0gIiNGRkZGRkYiOwogICAgICAvLyBsYWJlbF9kaXNwbGF5X2Rpdi5zdHlsZS50ZXh0QWxpZ24gPSAiY2VudGVyIjsKICAgICAgLy8gbGFiZWxfZGlzcGxheV9kaXYuc3R5bGUubWFyZ2luVG9wID0gIjAuNXJlbSI7CiAgICAgIC8vIGxhYmVsX2Rpc3BsYXlfZGl2LmlubmVySFRNTCA9IHRhcmdldEVsZW1lbnQubGFiZWxEaXNwbGF5OwogICAgICAvLyBoZWxwZXJMYXllci5hcHBlbmRDaGlsZChsYWJlbF9kaXNwbGF5X2Rpdik7CiAgICAgIC8vIGhlbHBlckxheWVyLmlubmVySFRNTCA9IHRhcmdldEVsZW1lbnQubGFiZWxEaXNwbGF5OwoKICAgICAgYnVsbGV0c0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWJ1bGxldHMiOwoKICAgICAgaWYgKHRoaXMuX29wdGlvbnMuc2hvd0J1bGxldHMgPT09IGZhbHNlKSB7CiAgICAgICAgYnVsbGV0c0xheWVyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIH0KCiAgICAgIHZhciB1bENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInVsIik7CiAgICAgIHVsQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgicm9sZSIsICJ0YWJsaXN0Iik7CgogICAgICB2YXIgYW5jaG9yQ2xpY2sgPSBmdW5jdGlvbiBhbmNob3JDbGljaygpIHsKICAgICAgICBzZWxmLmdvVG9TdGVwKHRoaXMuZ2V0QXR0cmlidXRlKCJkYXRhLXN0ZXBudW1iZXIiKSk7CiAgICAgIH07CgogICAgICBmb3JFYWNoKHRoaXMuX2ludHJvSXRlbXMsIGZ1bmN0aW9uIChfcmVmLCBpKSB7CiAgICAgICAgdmFyIHN0ZXAgPSBfcmVmLnN0ZXA7CiAgICAgICAgdmFyIGlubmVyTGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaSIpOwogICAgICAgIHZhciBhbmNob3JMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgIGlubmVyTGkuc2V0QXR0cmlidXRlKCJyb2xlIiwgInByZXNlbnRhdGlvbiIpOwogICAgICAgIGFuY2hvckxpbmsuc2V0QXR0cmlidXRlKCJyb2xlIiwgInRhYiIpOwogICAgICAgIGFuY2hvckxpbmsub25jbGljayA9IGFuY2hvckNsaWNrOwoKICAgICAgICBpZiAoaSA9PT0gdGFyZ2V0RWxlbWVudC5zdGVwIC0gMSkgewogICAgICAgICAgYW5jaG9yTGluay5jbGFzc05hbWUgPSAiYWN0aXZlIjsKICAgICAgICB9CgogICAgICAgIHNldEFuY2hvckFzQnV0dG9uKGFuY2hvckxpbmspOwogICAgICAgIGFuY2hvckxpbmsuaW5uZXJIVE1MID0gIiZuYnNwOyI7CiAgICAgICAgYW5jaG9yTGluay5zZXRBdHRyaWJ1dGUoImRhdGEtc3RlcG51bWJlciIsIHN0ZXApOwogICAgICAgIGlubmVyTGkuYXBwZW5kQ2hpbGQoYW5jaG9yTGluayk7CiAgICAgICAgdWxDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5uZXJMaSk7CiAgICAgIH0pOwogICAgICBidWxsZXRzTGF5ZXIuYXBwZW5kQ2hpbGQodWxDb250YWluZXIpOwogICAgICBwcm9ncmVzc0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLXByb2dyZXNzIjsKCiAgICAgIGlmICh0aGlzLl9vcHRpb25zLnNob3dQcm9ncmVzcyA9PT0gZmFsc2UpIHsKICAgICAgICBwcm9ncmVzc0xheWVyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIH0KCiAgICAgIHZhciBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBwcm9ncmVzc0Jhci5jbGFzc05hbWUgPSAiaW50cm9qcy1wcm9ncmVzc2JhciI7CiAgICAgIHByb2dyZXNzQmFyLnNldEF0dHJpYnV0ZSgicm9sZSIsICJwcm9ncmVzcyIpOwogICAgICBwcm9ncmVzc0Jhci5zZXRBdHRyaWJ1dGUoImFyaWEtdmFsdWVtaW4iLCAwKTsKICAgICAgcHJvZ3Jlc3NCYXIuc2V0QXR0cmlidXRlKCJhcmlhLXZhbHVlbWF4IiwgMTAwKTsKICAgICAgcHJvZ3Jlc3NCYXIuc2V0QXR0cmlidXRlKCJhcmlhLXZhbHVlbm93IiwgX2dldFByb2dyZXNzLmNhbGwodGhpcykpOwogICAgICBwcm9ncmVzc0Jhci5zdHlsZS5jc3NUZXh0ID0gIndpZHRoOiIuY29uY2F0KF9nZXRQcm9ncmVzcy5jYWxsKHRoaXMpLCAiJTsiKTsKICAgICAgcHJvZ3Jlc3NMYXllci5hcHBlbmRDaGlsZChwcm9ncmVzc0Jhcik7CiAgICAgIGJ1dHRvbnNMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy10b29sdGlwYnV0dG9ucyI7CgogICAgICBpZiAodGhpcy5fb3B0aW9ucy5zaG93QnV0dG9ucyA9PT0gZmFsc2UpIHsKICAgICAgICBidXR0b25zTGF5ZXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfQoKICAgICAgdG9vbHRpcExheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLXRvb2x0aXAiOyAvLyB0b29sdGlwTGF5ZXIuc3R5bGUuY3NzVGV4dCA9ICJtYXgtd2lkdGg6IDMwMHB4ICFpbXBvcnRhbnQiOyAKCiAgICAgIHRvb2x0aXBMYXllci5hcHBlbmRDaGlsZCh0b29sdGlwVGV4dExheWVyKTsKICAgICAgdG9vbHRpcExheWVyLmFwcGVuZENoaWxkKGltYWdlTGF5ZXIpOyAvLyB0b29sdGlwTGF5ZXIuYXBwZW5kQ2hpbGQoYnVsbGV0c0xheWVyKTsKICAgICAgLy8gdG9vbHRpcExheWVyLmFwcGVuZENoaWxkKHByb2dyZXNzTGF5ZXIpOyAvL2FkZCBoZWxwZXIgbGF5ZXIgbnVtYmVyCgogICAgICB2YXIgaGVscGVyTnVtYmVyTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7CgogICAgICBpZiAodGhpcy5fb3B0aW9ucy5zaG93U3RlcE51bWJlcnMgPT09IHRydWUpIHsKICAgICAgICBoZWxwZXJOdW1iZXJMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy1oZWxwZXJOdW1iZXJMYXllciI7CiAgICAgICAgaGVscGVyTnVtYmVyTGF5ZXIuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5zdGVwOwogICAgICAgIHJlZmVyZW5jZUxheWVyLmFwcGVuZENoaWxkKGhlbHBlck51bWJlckxheWVyKTsKICAgICAgfQoKICAgICAgdG9vbHRpcExheWVyLmFwcGVuZENoaWxkKGFycm93TGF5ZXIpOwogICAgICByZWZlcmVuY2VMYXllci5hcHBlbmRDaGlsZCh0b29sdGlwTGF5ZXIpOyAvL25leHQgYnV0dG9uCgogICAgICBuZXh0VG9vbHRpcEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKCiAgICAgIG5leHRUb29sdGlwQnV0dG9uLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHNlbGYuX2ludHJvSXRlbXMubGVuZ3RoIC0gMSAhPT0gc2VsZi5fY3VycmVudFN0ZXApIHsKICAgICAgICAgIG5leHRTdGVwLmNhbGwoc2VsZik7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgc2V0QW5jaG9yQXNCdXR0b24obmV4dFRvb2x0aXBCdXR0b24pOwogICAgICBuZXh0VG9vbHRpcEJ1dHRvbi5pbm5lckhUTUwgPSB0aGlzLl9vcHRpb25zLm5leHRMYWJlbDsgLy9wcmV2aW91cyBidXR0b24KCiAgICAgIHByZXZUb29sdGlwQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICBwcmV2VG9vbHRpcEJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoKICAgICAgcHJldlRvb2x0aXBCdXR0b24ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoc2VsZi5fY3VycmVudFN0ZXAgIT09IDApIHsKICAgICAgICAgIHByZXZpb3VzU3RlcC5jYWxsKHNlbGYpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHNldEFuY2hvckFzQnV0dG9uKHByZXZUb29sdGlwQnV0dG9uKTsKICAgICAgcHJldlRvb2x0aXBCdXR0b24uaW5uZXJIVE1MID0gdGhpcy5fb3B0aW9ucy5wcmV2TGFiZWw7IC8vc2tpcCBidXR0b24KCiAgICAgIHNraXBUb29sdGlwQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICBza2lwVG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLXNraXBidXR0b24gIik7CiAgICAgIHNldEFuY2hvckFzQnV0dG9uKHNraXBUb29sdGlwQnV0dG9uKTsKICAgICAgc2tpcFRvb2x0aXBCdXR0b24uaW5uZXJIVE1MID0gdGhpcy5fb3B0aW9ucy5za2lwTGFiZWw7CgogICAgICBza2lwVG9vbHRpcEJ1dHRvbi5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChzZWxmLl9pbnRyb0l0ZW1zLmxlbmd0aCAtIDEgPT09IHNlbGYuX2N1cnJlbnRTdGVwICYmIHR5cGVvZiBzZWxmLl9pbnRyb0NvbXBsZXRlQ2FsbGJhY2sgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgIHNlbGYuX2ludHJvQ29tcGxldGVDYWxsYmFjay5jYWxsKHNlbGYpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR5cGVvZiBzZWxmLl9pbnRyb1NraXBDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgc2VsZi5faW50cm9Ta2lwQ2FsbGJhY2suY2FsbChzZWxmKTsKICAgICAgICB9CgogICAgICAgIGV4aXRJbnRyby5jYWxsKHNlbGYsIHNlbGYuX3RhcmdldEVsZW1lbnQpOwogICAgICB9OwoKICAgICAgYnV0dG9uc0xheWVyLmFwcGVuZENoaWxkKHNraXBUb29sdGlwQnV0dG9uKTsgLy9pbiBvcmRlciB0byBwcmV2ZW50IGRpc3BsYXlpbmcgbmV4dC9wcmV2aW91cyBidXR0b24gYWx3YXlzCgogICAgICBpZiAodGhpcy5faW50cm9JdGVtcy5sZW5ndGggPiAxKSB7CiAgICAgICAgYnV0dG9uc0xheWVyLmFwcGVuZENoaWxkKHByZXZUb29sdGlwQnV0dG9uKTsKICAgICAgICBidXR0b25zTGF5ZXIuYXBwZW5kQ2hpbGQobmV4dFRvb2x0aXBCdXR0b24pOwogICAgICB9CgogICAgICB0b29sdGlwTGF5ZXIuYXBwZW5kQ2hpbGQoYnV0dG9uc0xheWVyKTsgLy9zZXQgcHJvcGVyIHBvc2l0aW9uCgogICAgICBwbGFjZVRvb2x0aXAuY2FsbChzZWxmLCB0YXJnZXRFbGVtZW50LmVsZW1lbnQsIHRvb2x0aXBMYXllciwgYXJyb3dMYXllciwgaGVscGVyTnVtYmVyTGF5ZXIpOyAvLyBjaGFuZ2UgdGhlIHNjcm9sbCBvZiB0aGUgd2luZG93LCBpZiBuZWVkZWQKCiAgICAgIHNjcm9sbFRvLmNhbGwodGhpcywgdGFyZ2V0RWxlbWVudC5zY3JvbGxUbywgdGFyZ2V0RWxlbWVudCwgdG9vbHRpcExheWVyKTsgLy9lbmQgb2YgbmV3IGVsZW1lbnQgaWYtZWxzZSBjb25kaXRpb24KICAgIH0gLy8gcmVtb3ZpbmcgcHJldmlvdXMgZGlzYWJsZSBpbnRlcmFjdGlvbiBsYXllcgoKCiAgICB2YXIgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIgPSBzZWxmLl90YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWRpc2FibGVJbnRlcmFjdGlvbiIpOwoKICAgIGlmIChkaXNhYmxlSW50ZXJhY3Rpb25MYXllcikgewogICAgICBkaXNhYmxlSW50ZXJhY3Rpb25MYXllci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRpc2FibGVJbnRlcmFjdGlvbkxheWVyKTsKICAgIH0gLy9kaXNhYmxlIGludGVyYWN0aW9uCgoKICAgIGlmICh0YXJnZXRFbGVtZW50LmRpc2FibGVJbnRlcmFjdGlvbikgewogICAgICBfZGlzYWJsZUludGVyYWN0aW9uLmNhbGwoc2VsZik7CiAgICB9IC8vIHdoZW4gaXQncyB0aGUgZmlyc3Qgc3RlcCBvZiB0b3VyCgoKICAgIGlmICh0aGlzLl9jdXJyZW50U3RlcCA9PT0gMCAmJiB0aGlzLl9pbnRyb0l0ZW1zLmxlbmd0aCA+IDEpIHsKICAgICAgaWYgKHR5cGVvZiBza2lwVG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgc2tpcFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICBza2lwVG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLXNraXBidXR0b24iKTsKICAgICAgICBza2lwVG9vbHRpcEJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIG5leHRUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICAgIG5leHRUb29sdGlwQnV0dG9uLmNsYXNzTmFtZSA9ICIiLmNvbmNhdCh0aGlzLl9vcHRpb25zLmJ1dHRvbkNsYXNzLCAiIGludHJvanMtbmV4dGJ1dHRvbiIpOwogICAgICB9CgogICAgICBpZiAodGhpcy5fb3B0aW9ucy5oaWRlUHJldiA9PT0gdHJ1ZSkgewogICAgICAgIGlmICh0eXBlb2YgcHJldlRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHByZXZUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgICBwcmV2VG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLXByZXZidXR0b24gaW50cm9qcy1oaWRkZW4iKTsKICAgICAgICB9CgogICAgICAgIGlmICh0eXBlb2YgbmV4dFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIG5leHRUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgICBhZGRDbGFzcyhuZXh0VG9vbHRpcEJ1dHRvbiwgImludHJvanMtZnVsbGJ1dHRvbiIpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodHlwZW9mIHByZXZUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBwcmV2VG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICAgICAgcHJldlRvb2x0aXBCdXR0b24uY2xhc3NOYW1lID0gIiIuY29uY2F0KHRoaXMuX29wdGlvbnMuYnV0dG9uQ2xhc3MsICIgaW50cm9qcy1wcmV2YnV0dG9uIGludHJvanMtZGlzYWJsZWQiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2Ygc2tpcFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHNraXBUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgc2tpcFRvb2x0aXBCdXR0b24uaW5uZXJIVE1MID0gdGhpcy5fb3B0aW9ucy5za2lwTGFiZWw7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodGhpcy5faW50cm9JdGVtcy5sZW5ndGggLSAxID09PSB0aGlzLl9jdXJyZW50U3RlcCB8fCB0aGlzLl9pbnRyb0l0ZW1zLmxlbmd0aCA9PT0gMSkgewogICAgICAvLyBsYXN0IHN0ZXAgb2YgdG91cgogICAgICBpZiAodHlwZW9mIHNraXBUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBza2lwVG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICAgIHNraXBUb29sdGlwQnV0dG9uLmlubmVySFRNTCA9IHRoaXMuX29wdGlvbnMuZG9uZUxhYmVsOyAvLyBhZGRpbmcgZG9uZWJ1dHRvbiBjbGFzcyBpbiBhZGRpdGlvbiB0byBza2lwYnV0dG9uCgogICAgICAgIHNraXBUb29sdGlwQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgICAgICBhZGRDbGFzcyhza2lwVG9vbHRpcEJ1dHRvbiwgImludHJvanMtZG9uZWJ1dHRvbiIpOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIHByZXZUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBwcmV2VG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICAgIHByZXZUb29sdGlwQnV0dG9uLmNsYXNzTmFtZSA9ICIiLmNvbmNhdCh0aGlzLl9vcHRpb25zLmJ1dHRvbkNsYXNzLCAiIGludHJvanMtcHJldmJ1dHRvbiIpOwogICAgICB9CgogICAgICBpZiAodGhpcy5fb3B0aW9ucy5oaWRlTmV4dCA9PT0gdHJ1ZSkgewogICAgICAgIGlmICh0eXBlb2YgbmV4dFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIG5leHRUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgICBuZXh0VG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLW5leHRidXR0b24gaW50cm9qcy1oaWRkZW4iKTsKICAgICAgICB9CgogICAgICAgIGlmICh0eXBlb2YgcHJldlRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHByZXZUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgICBhZGRDbGFzcyhwcmV2VG9vbHRpcEJ1dHRvbiwgImludHJvanMtZnVsbGJ1dHRvbiIpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodHlwZW9mIG5leHRUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICAgICAgbmV4dFRvb2x0aXBCdXR0b24uY2xhc3NOYW1lID0gIiIuY29uY2F0KHRoaXMuX29wdGlvbnMuYnV0dG9uQ2xhc3MsICIgaW50cm9qcy1uZXh0YnV0dG9uIGludHJvanMtZGlzYWJsZWQiKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIHN0ZXBzIGJldHdlZW4gc3RhcnQgYW5kIGVuZAogICAgICBpZiAodHlwZW9mIHNraXBUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBza2lwVG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICAgIHNraXBUb29sdGlwQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgc2tpcFRvb2x0aXBCdXR0b24uY2xhc3NOYW1lID0gIiIuY29uY2F0KHRoaXMuX29wdGlvbnMuYnV0dG9uQ2xhc3MsICIgaW50cm9qcy1za2lwYnV0dG9uIik7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgcHJldlRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHByZXZUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgcHJldlRvb2x0aXBCdXR0b24uY2xhc3NOYW1lID0gIiIuY29uY2F0KHRoaXMuX29wdGlvbnMuYnV0dG9uQ2xhc3MsICIgaW50cm9qcy1wcmV2YnV0dG9uIik7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgbmV4dFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIG5leHRUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgbmV4dFRvb2x0aXBCdXR0b24uY2xhc3NOYW1lID0gIiIuY29uY2F0KHRoaXMuX29wdGlvbnMuYnV0dG9uQ2xhc3MsICIgaW50cm9qcy1uZXh0YnV0dG9uIik7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2Ygc2tpcFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHNraXBUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgc2tpcFRvb2x0aXBCdXR0b24uaW5uZXJIVE1MID0gdGhpcy5fb3B0aW9ucy5za2lwTGFiZWw7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodHlwZW9mIHByZXZUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBwcmV2VG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICBwcmV2VG9vbHRpcEJ1dHRvbi5zZXRBdHRyaWJ1dGUoInJvbGUiLCAiYnV0dG9uIik7CiAgICB9CgogICAgaWYgKHR5cGVvZiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgbmV4dFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgbmV4dFRvb2x0aXBCdXR0b24uc2V0QXR0cmlidXRlKCJyb2xlIiwgImJ1dHRvbiIpOwogICAgfQoKICAgIGlmICh0eXBlb2Ygc2tpcFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHNraXBUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgIHNraXBUb29sdGlwQnV0dG9uLnNldEF0dHJpYnV0ZSgicm9sZSIsICJidXR0b24iKTsKICAgIH0gLy9TZXQgZm9jdXMgb24gIm5leHQiIGJ1dHRvbiwgc28gdGhhdCBoaXR0aW5nIEVudGVyIGFsd2F5cyBtb3ZlcyB5b3Ugb250byB0aGUgbmV4dCBzdGVwCgoKICAgIGlmICh0eXBlb2YgbmV4dFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIG5leHRUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgIG5leHRUb29sdGlwQnV0dG9uLmZvY3VzKCk7CiAgICB9CgogICAgc2V0U2hvd0VsZW1lbnQodGFyZ2V0RWxlbWVudCk7CgogICAgaWYgKHR5cGVvZiB0aGlzLl9pbnRyb0FmdGVyQ2hhbmdlQ2FsbGJhY2sgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHRoaXMuX2ludHJvQWZ0ZXJDaGFuZ2VDYWxsYmFjay5jYWxsKHRoaXMsIHRhcmdldEVsZW1lbnQuZWxlbWVudCk7CiAgICB9CiAgfQogIC8qKgogICAqIEdvIHRvIHNwZWNpZmljIHN0ZXAgb2YgaW50cm9kdWN0aW9uCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9nb1RvU3RlcAogICAqLwoKCiAgZnVuY3Rpb24gZ29Ub1N0ZXAoc3RlcCkgewogICAgLy9iZWNhdXNlIHN0ZXBzIHN0YXJ0cyB3aXRoIHplcm8KICAgIHRoaXMuX2N1cnJlbnRTdGVwID0gc3RlcCAtIDI7CgogICAgaWYgKHR5cGVvZiB0aGlzLl9pbnRyb0l0ZW1zICE9PSAidW5kZWZpbmVkIikgewogICAgICBuZXh0U3RlcC5jYWxsKHRoaXMpOwogICAgfQogIH0KICAvKioKICAgKiBHbyB0byB0aGUgc3BlY2lmaWMgc3RlcCBvZiBpbnRyb2R1Y3Rpb24gd2l0aCB0aGUgZXhwbGljaXQgW2RhdGEtc3RlcF0gbnVtYmVyCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9nb1RvU3RlcE51bWJlcgogICAqLwoKCiAgZnVuY3Rpb24gZ29Ub1N0ZXBOdW1iZXIoc3RlcCkgewogICAgdGhpcy5fY3VycmVudFN0ZXBOdW1iZXIgPSBzdGVwOwoKICAgIGlmICh0eXBlb2YgdGhpcy5faW50cm9JdGVtcyAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgbmV4dFN0ZXAuY2FsbCh0aGlzKTsKICAgIH0KICB9CiAgLyoqCiAgICogR28gdG8gbmV4dCBzdGVwIG9uIGludHJvCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9uZXh0U3RlcAogICAqLwoKCiAgZnVuY3Rpb24gbmV4dFN0ZXAoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHRoaXMuX2RpcmVjdGlvbiA9ICJmb3J3YXJkIjsKCiAgICBpZiAodHlwZW9mIHRoaXMuX2N1cnJlbnRTdGVwTnVtYmVyICE9PSAidW5kZWZpbmVkIikgewogICAgICBmb3JFYWNoKHRoaXMuX2ludHJvSXRlbXMsIGZ1bmN0aW9uIChfcmVmLCBpKSB7CiAgICAgICAgdmFyIHN0ZXAgPSBfcmVmLnN0ZXA7CgogICAgICAgIGlmIChzdGVwID09PSBfdGhpcy5fY3VycmVudFN0ZXBOdW1iZXIpIHsKICAgICAgICAgIF90aGlzLl9jdXJyZW50U3RlcCA9IGkgLSAxOwogICAgICAgICAgX3RoaXMuX2N1cnJlbnRTdGVwTnVtYmVyID0gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgaWYgKHR5cGVvZiB0aGlzLl9jdXJyZW50U3RlcCA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgdGhpcy5fY3VycmVudFN0ZXAgPSAwOwogICAgfSBlbHNlIHsKICAgICAgKyt0aGlzLl9jdXJyZW50U3RlcDsKICAgIH0KCiAgICB2YXIgbmV4dFN0ZXAgPSB0aGlzLl9pbnRyb0l0ZW1zW3RoaXMuX2N1cnJlbnRTdGVwXTsKICAgIHZhciBjb250aW51ZVN0ZXAgPSB0cnVlOwoKICAgIGlmICh0eXBlb2YgdGhpcy5faW50cm9CZWZvcmVDaGFuZ2VDYWxsYmFjayAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgY29udGludWVTdGVwID0gdGhpcy5faW50cm9CZWZvcmVDaGFuZ2VDYWxsYmFjay5jYWxsKHRoaXMsIG5leHRTdGVwLmVsZW1lbnQpOwogICAgfSAvLyBpZiBgb25iZWZvcmVjaGFuZ2VgIHJldHVybmVkIGBmYWxzZWAsIHN0b3AgZGlzcGxheWluZyB0aGUgZWxlbWVudAoKCiAgICBpZiAoY29udGludWVTdGVwID09PSBmYWxzZSkgewogICAgICAtLXRoaXMuX2N1cnJlbnRTdGVwOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHRoaXMuX2ludHJvSXRlbXMubGVuZ3RoIDw9IHRoaXMuX2N1cnJlbnRTdGVwKSB7CiAgICAgIC8vZW5kIG9mIHRoZSBpbnRybwogICAgICAvL2NoZWNrIGlmIGFueSBjYWxsYmFjayBpcyBkZWZpbmVkCiAgICAgIGlmICh0eXBlb2YgdGhpcy5faW50cm9Db21wbGV0ZUNhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faW50cm9Db21wbGV0ZUNhbGxiYWNrLmNhbGwodGhpcyk7CiAgICAgIH0KCiAgICAgIGV4aXRJbnRyby5jYWxsKHRoaXMsIHRoaXMuX3RhcmdldEVsZW1lbnQpOwogICAgICByZXR1cm47CiAgICB9CgogICAgX3Nob3dFbGVtZW50LmNhbGwodGhpcywgbmV4dFN0ZXApOwogIH0KICAvKioKICAgKiBHbyB0byBwcmV2aW91cyBzdGVwIG9uIGludHJvCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9wcmV2aW91c1N0ZXAKICAgKi8KCgogIGZ1bmN0aW9uIHByZXZpb3VzU3RlcCgpIHsKICAgIHRoaXMuX2RpcmVjdGlvbiA9ICJiYWNrd2FyZCI7CgogICAgaWYgKHRoaXMuX2N1cnJlbnRTdGVwID09PSAwKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAtLXRoaXMuX2N1cnJlbnRTdGVwOwogICAgdmFyIG5leHRTdGVwID0gdGhpcy5faW50cm9JdGVtc1t0aGlzLl9jdXJyZW50U3RlcF07CiAgICB2YXIgY29udGludWVTdGVwID0gdHJ1ZTsKCiAgICBpZiAodHlwZW9mIHRoaXMuX2ludHJvQmVmb3JlQ2hhbmdlQ2FsbGJhY2sgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGNvbnRpbnVlU3RlcCA9IHRoaXMuX2ludHJvQmVmb3JlQ2hhbmdlQ2FsbGJhY2suY2FsbCh0aGlzLCBuZXh0U3RlcC5lbGVtZW50KTsKICAgIH0gLy8gaWYgYG9uYmVmb3JlY2hhbmdlYCByZXR1cm5lZCBgZmFsc2VgLCBzdG9wIGRpc3BsYXlpbmcgdGhlIGVsZW1lbnQKCgogICAgaWYgKGNvbnRpbnVlU3RlcCA9PT0gZmFsc2UpIHsKICAgICAgKyt0aGlzLl9jdXJyZW50U3RlcDsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIF9zaG93RWxlbWVudC5jYWxsKHRoaXMsIG5leHRTdGVwKTsKICB9CiAgLyoqCiAgICogUmV0dXJucyB0aGUgY3VycmVudCBzdGVwIG9mIHRoZSBpbnRybwogICAqCiAgICogQHJldHVybnMge2Jvb2xlYW59CiAgICovCgoKICBmdW5jdGlvbiBjdXJyZW50U3RlcCgpIHsKICAgIHJldHVybiB0aGlzLl9jdXJyZW50U3RlcDsKICB9CiAgLyoqCiAgICogb24ga2V5Q29kZToKICAgKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvS2V5Ym9hcmRFdmVudC9rZXlDb2RlCiAgICogVGhpcyBmZWF0dXJlIGhhcyBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgV2ViIHN0YW5kYXJkcy4KICAgKiBUaG91Z2ggc29tZSBicm93c2VycyBtYXkgc3RpbGwgc3VwcG9ydCBpdCwgaXQgaXMgaW4KICAgKiB0aGUgcHJvY2VzcyBvZiBiZWluZyBkcm9wcGVkLgogICAqIEluc3RlYWQsIHlvdSBzaG91bGQgdXNlIEtleWJvYXJkRXZlbnQuY29kZSwKICAgKiBpZiBpdCdzIGltcGxlbWVudGVkLgogICAqCiAgICogalF1ZXJ5J3MgYXBwcm9hY2ggaXMgdG8gdGVzdCBmb3IKICAgKiAgICgxKSBlLndoaWNoLCB0aGVuCiAgICogICAoMikgZS5jaGFyQ29kZSwgdGhlbgogICAqICAgKDMpIGUua2V5Q29kZQogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5L2Jsb2IvYTZiMDcwNTI5NGQzMzZhZTJmNjNmNzI3NmRlMGRhMTE5NTQ5NTM2My9zcmMvZXZlbnQuanMjTDYzOAogICAqCiAgICogQHBhcmFtIHR5cGUgdmFyCiAgICogQHJldHVybiB0eXBlCiAgICovCgoKICBmdW5jdGlvbiBvbktleURvd24oZSkgewogICAgdmFyIGNvZGUgPSBlLmNvZGUgPT09IG51bGwgPyBlLndoaWNoIDogZS5jb2RlOyAvLyBpZiBjb2RlL2Uud2hpY2ggaXMgbnVsbAoKICAgIGlmIChjb2RlID09PSBudWxsKSB7CiAgICAgIGNvZGUgPSBlLmNoYXJDb2RlID09PSBudWxsID8gZS5rZXlDb2RlIDogZS5jaGFyQ29kZTsKICAgIH0KCiAgICBpZiAoKGNvZGUgPT09ICJFc2NhcGUiIHx8IGNvZGUgPT09IDI3KSAmJiB0aGlzLl9vcHRpb25zLmV4aXRPbkVzYyA9PT0gdHJ1ZSkgewogICAgICAvL2VzY2FwZSBrZXkgcHJlc3NlZCwgZXhpdCB0aGUgaW50cm8KICAgICAgLy9jaGVjayBpZiBleGl0IGNhbGxiYWNrIGlzIGRlZmluZWQKICAgICAgZXhpdEludHJvLmNhbGwodGhpcywgdGhpcy5fdGFyZ2V0RWxlbWVudCk7CiAgICB9IGVsc2UgaWYgKGNvZGUgPT09ICJBcnJvd0xlZnQiIHx8IGNvZGUgPT09IDM3KSB7CiAgICAgIC8vbGVmdCBhcnJvdwogICAgICBwcmV2aW91c1N0ZXAuY2FsbCh0aGlzKTsKICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gIkFycm93UmlnaHQiIHx8IGNvZGUgPT09IDM5KSB7CiAgICAgIC8vcmlnaHQgYXJyb3cKICAgICAgbmV4dFN0ZXAuY2FsbCh0aGlzKTsKICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gIkVudGVyIiB8fCBjb2RlID09PSAxMykgewogICAgICAvL3NyY0VsZW1lbnQgPT09IGllCiAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CgogICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5jbGFzc05hbWUubWF0Y2goImludHJvanMtcHJldmJ1dHRvbiIpKSB7CiAgICAgICAgLy91c2VyIGhpdCBlbnRlciB3aGlsZSBmb2N1c2luZyBvbiBwcmV2aW91cyBidXR0b24KICAgICAgICBwcmV2aW91c1N0ZXAuY2FsbCh0aGlzKTsKICAgICAgfSBlbHNlIGlmICh0YXJnZXQgJiYgdGFyZ2V0LmNsYXNzTmFtZS5tYXRjaCgiaW50cm9qcy1za2lwYnV0dG9uIikpIHsKICAgICAgICAvL3VzZXIgaGl0IGVudGVyIHdoaWxlIGZvY3VzaW5nIG9uIHNraXAgYnV0dG9uCiAgICAgICAgaWYgKHRoaXMuX2ludHJvSXRlbXMubGVuZ3RoIC0gMSA9PT0gdGhpcy5fY3VycmVudFN0ZXAgJiYgdHlwZW9mIHRoaXMuX2ludHJvQ29tcGxldGVDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgdGhpcy5faW50cm9Db21wbGV0ZUNhbGxiYWNrLmNhbGwodGhpcyk7CiAgICAgICAgfQoKICAgICAgICBleGl0SW50cm8uY2FsbCh0aGlzLCB0aGlzLl90YXJnZXRFbGVtZW50KTsKICAgICAgfSBlbHNlIGlmICh0YXJnZXQgJiYgdGFyZ2V0LmdldEF0dHJpYnV0ZSgiZGF0YS1zdGVwbnVtYmVyIikpIHsKICAgICAgICAvLyB1c2VyIGhpdCBlbnRlciB3aGlsZSBmb2N1c2luZyBvbiBzdGVwIGJ1bGxldAogICAgICAgIHRhcmdldC5jbGljaygpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vZGVmYXVsdCBiZWhhdmlvciBmb3IgcmVzcG9uZGluZyB0byBlbnRlcgogICAgICAgIG5leHRTdGVwLmNhbGwodGhpcyk7CiAgICAgIH0gLy9wcmV2ZW50IGRlZmF1bHQgYmVoYXZpb3VyIG9uIGhpdHRpbmcgRW50ZXIsIHRvIHByZXZlbnQgc3RlcHMgYmVpbmcgc2tpcHBlZCBpbiBzb21lIGJyb3dzZXJzCgoKICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfQogIC8qCiAgICogbWFrZXMgYSBjb3B5IG9mIHRoZSBvYmplY3QKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9jbG9uZU9iamVjdAogICAqLwoKCiAgZnVuY3Rpb24gY2xvbmVPYmplY3Qob2JqZWN0KSB7CiAgICBpZiAob2JqZWN0ID09PSBudWxsIHx8IF90eXBlb2Yob2JqZWN0KSAhPT0gIm9iamVjdCIgfHwgdHlwZW9mIG9iamVjdC5ub2RlVHlwZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgcmV0dXJuIG9iamVjdDsKICAgIH0KCiAgICB2YXIgdGVtcCA9IHt9OwoKICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHsKICAgICAgaWYgKHR5cGVvZiB3aW5kb3cualF1ZXJ5ICE9PSAidW5kZWZpbmVkIiAmJiBvYmplY3Rba2V5XSBpbnN0YW5jZW9mIHdpbmRvdy5qUXVlcnkpIHsKICAgICAgICB0ZW1wW2tleV0gPSBvYmplY3Rba2V5XTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZW1wW2tleV0gPSBjbG9uZU9iamVjdChvYmplY3Rba2V5XSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGVtcDsKICB9CiAgLyoqCiAgICogR2V0IGEgcXVlcnlzZWxlY3RvciB3aXRoaW4gdGhlIGhpbnQgd3JhcHBlcgogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IHNlbGVjdG9yCiAgICogQHJldHVybiB7Tm9kZUxpc3R8QXJyYXl9CiAgICovCgoKICBmdW5jdGlvbiBoaW50UXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikgewogICAgdmFyIGhpbnRzV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhpbnRzIik7CiAgICByZXR1cm4gaGludHNXcmFwcGVyID8gaGludHNXcmFwcGVyLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpIDogW107CiAgfQogIC8qKgogICAqIEhpZGUgYSBoaW50CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIGhpZGVIaW50CiAgICovCgoKICBmdW5jdGlvbiBoaWRlSGludChzdGVwSWQpIHsKICAgIHZhciBoaW50ID0gaGludFF1ZXJ5U2VsZWN0b3JBbGwoIi5pbnRyb2pzLWhpbnRbZGF0YS1zdGVwPVwiIi5jb25jYXQoc3RlcElkLCAiXCJdIikpWzBdOwogICAgcmVtb3ZlSGludFRvb2x0aXAuY2FsbCh0aGlzKTsKCiAgICBpZiAoaGludCkgewogICAgICBhZGRDbGFzcyhoaW50LCAiaW50cm9qcy1oaWRlaGludCIpOwogICAgfSAvLyBjYWxsIHRoZSBjYWxsYmFjayBmdW5jdGlvbiAoaWYgYW55KQoKCiAgICBpZiAodHlwZW9mIHRoaXMuX2hpbnRDbG9zZUNhbGxiYWNrICE9PSAidW5kZWZpbmVkIikgewogICAgICB0aGlzLl9oaW50Q2xvc2VDYWxsYmFjay5jYWxsKHRoaXMsIHN0ZXBJZCk7CiAgICB9CiAgfQogIC8qKgogICAqIEhpZGUgYWxsIGhpbnRzCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIGhpZGVIaW50cwogICAqLwoKCiAgZnVuY3Rpb24gaGlkZUhpbnRzKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgaGludHMgPSBoaW50UXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtaGludCIpOwogICAgZm9yRWFjaChoaW50cywgZnVuY3Rpb24gKGhpbnQpIHsKICAgICAgaGlkZUhpbnQuY2FsbChfdGhpcywgaGludC5nZXRBdHRyaWJ1dGUoImRhdGEtc3RlcCIpKTsKICAgIH0pOwogIH0KICAvKioKICAgKiBTaG93IGFsbCBoaW50cwogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfc2hvd0hpbnRzCiAgICovCgoKICBmdW5jdGlvbiBzaG93SGludHMoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICB2YXIgaGludHMgPSBoaW50UXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtaGludCIpOwoKICAgIGlmIChoaW50cyAmJiBoaW50cy5sZW5ndGgpIHsKICAgICAgZm9yRWFjaChoaW50cywgZnVuY3Rpb24gKGhpbnQpIHsKICAgICAgICBzaG93SGludC5jYWxsKF90aGlzMiwgaGludC5nZXRBdHRyaWJ1dGUoImRhdGEtc3RlcCIpKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBwb3B1bGF0ZUhpbnRzLmNhbGwodGhpcywgdGhpcy5fdGFyZ2V0RWxlbWVudCk7CiAgICB9CiAgfQogIC8qKgogICAqIFNob3cgYSBoaW50CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIHNob3dIaW50CiAgICovCgoKICBmdW5jdGlvbiBzaG93SGludChzdGVwSWQpIHsKICAgIHZhciBoaW50ID0gaGludFF1ZXJ5U2VsZWN0b3JBbGwoIi5pbnRyb2pzLWhpbnRbZGF0YS1zdGVwPVwiIi5jb25jYXQoc3RlcElkLCAiXCJdIikpWzBdOwoKICAgIGlmIChoaW50KSB7CiAgICAgIHJlbW92ZUNsYXNzKGhpbnQsIC9pbnRyb2pzLWhpZGVoaW50L2cpOwogICAgfQogIH0KICAvKioKICAgKiBSZW1vdmVzIGFsbCBoaW50IGVsZW1lbnRzIG9uIHRoZSBwYWdlCiAgICogVXNlZnVsIHdoZW4geW91IHdhbnQgdG8gZGVzdHJveSB0aGUgZWxlbWVudHMgYW5kIGFkZCB0aGVtIGFnYWluIChlLmcuIGEgbW9kYWwgb3IgcG9wdXApCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIHJlbW92ZUhpbnRzCiAgICovCgoKICBmdW5jdGlvbiByZW1vdmVIaW50cygpIHsKICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgIHZhciBoaW50cyA9IGhpbnRRdWVyeVNlbGVjdG9yQWxsKCIuaW50cm9qcy1oaW50Iik7CiAgICBmb3JFYWNoKGhpbnRzLCBmdW5jdGlvbiAoaGludCkgewogICAgICByZW1vdmVIaW50LmNhbGwoX3RoaXMzLCBoaW50LmdldEF0dHJpYnV0ZSgiZGF0YS1zdGVwIikpOwogICAgfSk7CiAgfQogIC8qKgogICAqIFJlbW92ZSBvbmUgc2luZ2xlIGhpbnQgZWxlbWVudCBmcm9tIHRoZSBwYWdlCiAgICogVXNlZnVsIHdoZW4geW91IHdhbnQgdG8gZGVzdHJveSB0aGUgZWxlbWVudCBhbmQgYWRkIHRoZW0gYWdhaW4gKGUuZy4gYSBtb2RhbCBvciBwb3B1cCkKICAgKiBVc2UgcmVtb3ZlSGludHMgaWYgeW91IHdhbnQgdG8gcmVtb3ZlIGFsbCBlbGVtZW50cy4KICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgcmVtb3ZlSGludAogICAqLwoKCiAgZnVuY3Rpb24gcmVtb3ZlSGludChzdGVwSWQpIHsKICAgIHZhciBoaW50ID0gaGludFF1ZXJ5U2VsZWN0b3JBbGwoIi5pbnRyb2pzLWhpbnRbZGF0YS1zdGVwPVwiIi5jb25jYXQoc3RlcElkLCAiXCJdIikpWzBdOwoKICAgIGlmIChoaW50KSB7CiAgICAgIGhpbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChoaW50KTsKICAgIH0KICB9CiAgLyoqCiAgICogQWRkIGFsbCBhdmFpbGFibGUgaGludHMgdG8gdGhlIHBhZ2UKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgYWRkSGludHMKICAgKi8KCgogIGZ1bmN0aW9uIGFkZEhpbnRzKCkgewogICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIGhpbnRzV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhpbnRzIik7CgogICAgaWYgKGhpbnRzV3JhcHBlciA9PT0gbnVsbCkgewogICAgICBoaW50c1dyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgaGludHNXcmFwcGVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWhpbnRzIjsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbiBldmVudCBoYW5kbGVyIHVuaXF1ZSB0byB0aGUgaGludCBpdGVyYXRpb24KICAgICAqCiAgICAgKiBAcGFyYW0ge0ludGVnZXJ9IGkKICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufQogICAgICovCgoKICAgIHZhciBnZXRIaW50Q2xpY2sgPSBmdW5jdGlvbiBnZXRIaW50Q2xpY2soaSkgewogICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgZXZ0ID0gZSA/IGUgOiB3aW5kb3cuZXZlbnQ7CgogICAgICAgIGlmIChldnQuc3RvcFByb3BhZ2F0aW9uKSB7CiAgICAgICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoZXZ0LmNhbmNlbEJ1YmJsZSAhPT0gbnVsbCkgewogICAgICAgICAgZXZ0LmNhbmNlbEJ1YmJsZSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBzaG93SGludERpYWxvZy5jYWxsKHNlbGYsIGkpOwogICAgICB9OwogICAgfTsKCiAgICBmb3JFYWNoKHRoaXMuX2ludHJvSXRlbXMsIGZ1bmN0aW9uIChpdGVtLCBpKSB7CiAgICAgIC8vIGF2b2lkIGFwcGVuZCBhIGhpbnQgdHdpY2UKICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhpbnRbZGF0YS1zdGVwPVwiIi5jb25jYXQoaSwgIlwiXSIpKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGhpbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgIHNldEFuY2hvckFzQnV0dG9uKGhpbnQpOwogICAgICBoaW50Lm9uY2xpY2sgPSBnZXRIaW50Q2xpY2soaSk7CiAgICAgIGhpbnQuY2xhc3NOYW1lID0gImludHJvanMtaGludCI7CgogICAgICBpZiAoIWl0ZW0uaGludEFuaW1hdGlvbikgewogICAgICAgIGFkZENsYXNzKGhpbnQsICJpbnRyb2pzLWhpbnQtbm8tYW5pbSIpOwogICAgICB9IC8vIGhpbnQncyBwb3NpdGlvbiBzaG91bGQgYmUgZml4ZWQgaWYgdGhlIHRhcmdldCBlbGVtZW50J3MgcG9zaXRpb24gaXMgZml4ZWQKCgogICAgICBpZiAoaXNGaXhlZChpdGVtLmVsZW1lbnQpKSB7CiAgICAgICAgYWRkQ2xhc3MoaGludCwgImludHJvanMtZml4ZWRoaW50Iik7CiAgICAgIH0KCiAgICAgIHZhciBoaW50RG90ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGhpbnREb3QuY2xhc3NOYW1lID0gImludHJvanMtaGludC1kb3QiOwogICAgICB2YXIgaGludFB1bHNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGhpbnRQdWxzZS5jbGFzc05hbWUgPSAiaW50cm9qcy1oaW50LXB1bHNlIjsKICAgICAgaGludC5hcHBlbmRDaGlsZChoaW50RG90KTsKICAgICAgaGludC5hcHBlbmRDaGlsZChoaW50UHVsc2UpOwogICAgICBoaW50LnNldEF0dHJpYnV0ZSgiZGF0YS1zdGVwIiwgaSk7IC8vIHdlIHN3YXAgdGhlIGhpbnQgZWxlbWVudCB3aXRoIHRhcmdldCBlbGVtZW50CiAgICAgIC8vIGJlY2F1c2UgX3NldEhlbHBlckxheWVyUG9zaXRpb24gdXNlcyBgZWxlbWVudGAgcHJvcGVydHkKCiAgICAgIGl0ZW0udGFyZ2V0RWxlbWVudCA9IGl0ZW0uZWxlbWVudDsKICAgICAgaXRlbS5lbGVtZW50ID0gaGludDsgLy8gYWxpZ24gdGhlIGhpbnQgcG9zaXRpb24KCiAgICAgIGFsaWduSGludFBvc2l0aW9uLmNhbGwoX3RoaXM0LCBpdGVtLmhpbnRQb3NpdGlvbiwgaGludCwgaXRlbS50YXJnZXRFbGVtZW50KTsKICAgICAgaGludHNXcmFwcGVyLmFwcGVuZENoaWxkKGhpbnQpOwogICAgfSk7IC8vIGFkZGluZyB0aGUgaGludHMgd3JhcHBlcgoKICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaGludHNXcmFwcGVyKTsgLy8gY2FsbCB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gKGlmIGFueSkKCiAgICBpZiAodHlwZW9mIHRoaXMuX2hpbnRzQWRkZWRDYWxsYmFjayAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgdGhpcy5faGludHNBZGRlZENhbGxiYWNrLmNhbGwodGhpcyk7CiAgICB9CiAgfQogIC8qKgogICAqIEFsaWducyBoaW50IHBvc2l0aW9uCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIGFsaWduSGludFBvc2l0aW9uCiAgICogQHBhcmFtIHtTdHJpbmd9IHBvc2l0aW9uCiAgICogQHBhcmFtIHtPYmplY3R9IGhpbnQKICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudAogICAqLwoKCiAgZnVuY3Rpb24gYWxpZ25IaW50UG9zaXRpb24ocG9zaXRpb24sIF9yZWYsIGVsZW1lbnQpIHsKICAgIHZhciBzdHlsZSA9IF9yZWYuc3R5bGU7IC8vIGdldC9jYWxjdWxhdGUgb2Zmc2V0IG9mIHRhcmdldCBlbGVtZW50CgogICAgdmFyIG9mZnNldCA9IGdldE9mZnNldC5jYWxsKHRoaXMsIGVsZW1lbnQpOwogICAgdmFyIGljb25XaWR0aCA9IDIwOwogICAgdmFyIGljb25IZWlnaHQgPSAyMDsgLy8gYWxpZ24gdGhlIGhpbnQgZWxlbWVudAoKICAgIHN3aXRjaCAocG9zaXRpb24pIHsKICAgICAgZGVmYXVsdDoKICAgICAgY2FzZSAidG9wLWxlZnQiOgogICAgICAgIHN0eWxlLmxlZnQgPSAiIi5jb25jYXQob2Zmc2V0LmxlZnQsICJweCIpOwogICAgICAgIHN0eWxlLnRvcCA9ICIiLmNvbmNhdChvZmZzZXQudG9wLCAicHgiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgInRvcC1yaWdodCI6CiAgICAgICAgc3R5bGUubGVmdCA9ICIiLmNvbmNhdChvZmZzZXQubGVmdCArIG9mZnNldC53aWR0aCAtIGljb25XaWR0aCwgInB4Iik7CiAgICAgICAgc3R5bGUudG9wID0gIiIuY29uY2F0KG9mZnNldC50b3AsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiYm90dG9tLWxlZnQiOgogICAgICAgIHN0eWxlLmxlZnQgPSAiIi5jb25jYXQob2Zmc2V0LmxlZnQsICJweCIpOwogICAgICAgIHN0eWxlLnRvcCA9ICIiLmNvbmNhdChvZmZzZXQudG9wICsgb2Zmc2V0LmhlaWdodCAtIGljb25IZWlnaHQsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiYm90dG9tLXJpZ2h0IjoKICAgICAgICBzdHlsZS5sZWZ0ID0gIiIuY29uY2F0KG9mZnNldC5sZWZ0ICsgb2Zmc2V0LndpZHRoIC0gaWNvbldpZHRoLCAicHgiKTsKICAgICAgICBzdHlsZS50b3AgPSAiIi5jb25jYXQob2Zmc2V0LnRvcCArIG9mZnNldC5oZWlnaHQgLSBpY29uSGVpZ2h0LCAicHgiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgIm1pZGRsZS1sZWZ0IjoKICAgICAgICBzdHlsZS5sZWZ0ID0gIiIuY29uY2F0KG9mZnNldC5sZWZ0LCAicHgiKTsKICAgICAgICBzdHlsZS50b3AgPSAiIi5jb25jYXQob2Zmc2V0LnRvcCArIChvZmZzZXQuaGVpZ2h0IC0gaWNvbkhlaWdodCkgLyAyLCAicHgiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgIm1pZGRsZS1yaWdodCI6CiAgICAgICAgc3R5bGUubGVmdCA9ICIiLmNvbmNhdChvZmZzZXQubGVmdCArIG9mZnNldC53aWR0aCAtIGljb25XaWR0aCwgInB4Iik7CiAgICAgICAgc3R5bGUudG9wID0gIiIuY29uY2F0KG9mZnNldC50b3AgKyAob2Zmc2V0LmhlaWdodCAtIGljb25IZWlnaHQpIC8gMiwgInB4Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJtaWRkbGUtbWlkZGxlIjoKICAgICAgICBzdHlsZS5sZWZ0ID0gIiIuY29uY2F0KG9mZnNldC5sZWZ0ICsgKG9mZnNldC53aWR0aCAtIGljb25XaWR0aCkgLyAyLCAicHgiKTsKICAgICAgICBzdHlsZS50b3AgPSAiIi5jb25jYXQob2Zmc2V0LnRvcCArIChvZmZzZXQuaGVpZ2h0IC0gaWNvbkhlaWdodCkgLyAyLCAicHgiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImJvdHRvbS1taWRkbGUiOgogICAgICAgIHN0eWxlLmxlZnQgPSAiIi5jb25jYXQob2Zmc2V0LmxlZnQgKyAob2Zmc2V0LndpZHRoIC0gaWNvbldpZHRoKSAvIDIsICJweCIpOwogICAgICAgIHN0eWxlLnRvcCA9ICIiLmNvbmNhdChvZmZzZXQudG9wICsgb2Zmc2V0LmhlaWdodCAtIGljb25IZWlnaHQsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAidG9wLW1pZGRsZSI6CiAgICAgICAgc3R5bGUubGVmdCA9ICIiLmNvbmNhdChvZmZzZXQubGVmdCArIChvZmZzZXQud2lkdGggLSBpY29uV2lkdGgpIC8gMiwgInB4Iik7CiAgICAgICAgc3R5bGUudG9wID0gIiIuY29uY2F0KG9mZnNldC50b3AsICJweCIpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KICAvKioKICAgKiBUcmlnZ2VycyB3aGVuIHVzZXIgY2xpY2tzIG9uIHRoZSBoaW50IGVsZW1lbnQKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3Nob3dIaW50RGlhbG9nCiAgICogQHBhcmFtIHtOdW1iZXJ9IHN0ZXBJZAogICAqLwoKCiAgZnVuY3Rpb24gc2hvd0hpbnREaWFsb2coc3RlcElkKSB7CiAgICB2YXIgaGludEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1oaW50W2RhdGEtc3RlcD1cIiIuY29uY2F0KHN0ZXBJZCwgIlwiXSIpKTsKICAgIHZhciBpdGVtID0gdGhpcy5faW50cm9JdGVtc1tzdGVwSWRdOyAvLyBjYWxsIHRoZSBjYWxsYmFjayBmdW5jdGlvbiAoaWYgYW55KQoKICAgIGlmICh0eXBlb2YgdGhpcy5faGludENsaWNrQ2FsbGJhY2sgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHRoaXMuX2hpbnRDbGlja0NhbGxiYWNrLmNhbGwodGhpcywgaGludEVsZW1lbnQsIGl0ZW0sIHN0ZXBJZCk7CiAgICB9IC8vIHJlbW92ZSBhbGwgb3BlbiB0b29sdGlwcwoKCiAgICB2YXIgcmVtb3ZlZFN0ZXAgPSByZW1vdmVIaW50VG9vbHRpcC5jYWxsKHRoaXMpOyAvLyB0byB0b2dnbGUgdGhlIHRvb2x0aXAKCiAgICBpZiAocGFyc2VJbnQocmVtb3ZlZFN0ZXAsIDEwKSA9PT0gc3RlcElkKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgdG9vbHRpcExheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICB2YXIgdG9vbHRpcFRleHRMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgdmFyIGFycm93TGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIHZhciByZWZlcmVuY2VMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgdG9vbHRpcExheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLXRvb2x0aXAiOwoKICAgIHRvb2x0aXBMYXllci5vbmNsaWNrID0gZnVuY3Rpb24gKGUpIHsKICAgICAgLy9JRTkgJiBPdGhlciBCcm93c2VycwogICAgICBpZiAoZS5zdG9wUHJvcGFnYXRpb24pIHsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9IC8vSUU4IGFuZCBMb3dlcgogICAgICBlbHNlIHsKICAgICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTsKICAgICAgICB9CiAgICB9OwoKICAgIHRvb2x0aXBUZXh0TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtdG9vbHRpcHRleHQiOwogICAgdmFyIHRvb2x0aXBXcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgicCIpOwogICAgdG9vbHRpcFdyYXBwZXIuaW5uZXJIVE1MID0gaXRlbS5oaW50OwogICAgdmFyIGNsb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgY2xvc2VCdXR0b24uY2xhc3NOYW1lID0gdGhpcy5fb3B0aW9ucy5idXR0b25DbGFzczsKICAgIGNsb3NlQnV0dG9uLnNldEF0dHJpYnV0ZSgicm9sZSIsICJidXR0b24iKTsKICAgIGNsb3NlQnV0dG9uLmlubmVySFRNTCA9IHRoaXMuX29wdGlvbnMuaGludEJ1dHRvbkxhYmVsOwogICAgY2xvc2VCdXR0b24ub25jbGljayA9IGhpZGVIaW50LmJpbmQodGhpcywgc3RlcElkKTsKICAgIHRvb2x0aXBUZXh0TGF5ZXIuYXBwZW5kQ2hpbGQodG9vbHRpcFdyYXBwZXIpOwogICAgdG9vbHRpcFRleHRMYXllci5hcHBlbmRDaGlsZChjbG9zZUJ1dHRvbik7CiAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IjsKICAgIHRvb2x0aXBMYXllci5hcHBlbmRDaGlsZChhcnJvd0xheWVyKTsKICAgIHRvb2x0aXBMYXllci5hcHBlbmRDaGlsZCh0b29sdGlwVGV4dExheWVyKTsgLy8gc2V0IGN1cnJlbnQgc3RlcCBmb3IgX3BsYWNlVG9vbHRpcCBmdW5jdGlvbgoKICAgIHRoaXMuX2N1cnJlbnRTdGVwID0gaGludEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXN0ZXAiKTsgLy8gYWxpZ24gcmVmZXJlbmNlIGxheWVyIHBvc2l0aW9uCgogICAgcmVmZXJlbmNlTGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtdG9vbHRpcFJlZmVyZW5jZUxheWVyIGludHJvanMtaGludFJlZmVyZW5jZSI7CiAgICByZWZlcmVuY2VMYXllci5zZXRBdHRyaWJ1dGUoImRhdGEtc3RlcCIsIGhpbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1zdGVwIikpOwogICAgc2V0SGVscGVyTGF5ZXJQb3NpdGlvbi5jYWxsKHRoaXMsIHJlZmVyZW5jZUxheWVyKTsKICAgIHJlZmVyZW5jZUxheWVyLmFwcGVuZENoaWxkKHRvb2x0aXBMYXllcik7CiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHJlZmVyZW5jZUxheWVyKTsgLy9zZXQgcHJvcGVyIHBvc2l0aW9uCgogICAgcGxhY2VUb29sdGlwLmNhbGwodGhpcywgaGludEVsZW1lbnQsIHRvb2x0aXBMYXllciwgYXJyb3dMYXllciwgbnVsbCwgdHJ1ZSk7CiAgfQogIC8qKgogICAqIFJlbW92ZXMgb3BlbiBoaW50ICh0b29sdGlwIGhpbnQpCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9yZW1vdmVIaW50VG9vbHRpcAogICAqLwoKCiAgZnVuY3Rpb24gcmVtb3ZlSGludFRvb2x0aXAoKSB7CiAgICB2YXIgdG9vbHRpcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhpbnRSZWZlcmVuY2UiKTsKCiAgICBpZiAodG9vbHRpcCkgewogICAgICB2YXIgc3RlcCA9IHRvb2x0aXAuZ2V0QXR0cmlidXRlKCJkYXRhLXN0ZXAiKTsKICAgICAgdG9vbHRpcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvb2x0aXApOwogICAgICByZXR1cm4gc3RlcDsKICAgIH0KICB9CiAgLyoqCiAgICogU3RhcnQgcGFyc2luZyBoaW50IGl0ZW1zCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0RWxtCiAgICogQG1ldGhvZCBfc3RhcnRIaW50CiAgICovCgoKICBmdW5jdGlvbiBwb3B1bGF0ZUhpbnRzKHRhcmdldEVsbSkgewogICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgdGhpcy5faW50cm9JdGVtcyA9IFtdOwoKICAgIGlmICh0aGlzLl9vcHRpb25zLmhpbnRzKSB7CiAgICAgIGZvckVhY2godGhpcy5fb3B0aW9ucy5oaW50cywgZnVuY3Rpb24gKGhpbnQpIHsKICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSBjbG9uZU9iamVjdChoaW50KTsKCiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50SXRlbS5lbGVtZW50ID09PSAic3RyaW5nIikgewogICAgICAgICAgLy9ncmFiIHRoZSBlbGVtZW50IHdpdGggZ2l2ZW4gc2VsZWN0b3IgZnJvbSB0aGUgcGFnZQogICAgICAgICAgY3VycmVudEl0ZW0uZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY3VycmVudEl0ZW0uZWxlbWVudCk7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50SXRlbS5oaW50UG9zaXRpb24gPSBjdXJyZW50SXRlbS5oaW50UG9zaXRpb24gfHwgX3RoaXM1Ll9vcHRpb25zLmhpbnRQb3NpdGlvbjsKICAgICAgICBjdXJyZW50SXRlbS5oaW50QW5pbWF0aW9uID0gY3VycmVudEl0ZW0uaGludEFuaW1hdGlvbiB8fCBfdGhpczUuX29wdGlvbnMuaGludEFuaW1hdGlvbjsKCiAgICAgICAgaWYgKGN1cnJlbnRJdGVtLmVsZW1lbnQgIT09IG51bGwpIHsKICAgICAgICAgIF90aGlzNS5faW50cm9JdGVtcy5wdXNoKGN1cnJlbnRJdGVtKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGhpbnRzID0gdGFyZ2V0RWxtLnF1ZXJ5U2VsZWN0b3JBbGwoIipbZGF0YS1oaW50XSIpOwoKICAgICAgaWYgKCFoaW50cyB8fCAhaGludHMubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vZmlyc3QgYWRkIGludHJvIGl0ZW1zIHdpdGggZGF0YS1zdGVwCgoKICAgICAgZm9yRWFjaChoaW50cywgZnVuY3Rpb24gKGN1cnJlbnRFbGVtZW50KSB7CiAgICAgICAgLy8gaGludCBhbmltYXRpb24KICAgICAgICB2YXIgaGludEFuaW1hdGlvbiA9IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1oaW50YW5pbWF0aW9uIik7CgogICAgICAgIGlmIChoaW50QW5pbWF0aW9uKSB7CiAgICAgICAgICBoaW50QW5pbWF0aW9uID0gaGludEFuaW1hdGlvbiA9PT0gInRydWUiOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoaW50QW5pbWF0aW9uID0gX3RoaXM1Ll9vcHRpb25zLmhpbnRBbmltYXRpb247CiAgICAgICAgfQoKICAgICAgICBfdGhpczUuX2ludHJvSXRlbXMucHVzaCh7CiAgICAgICAgICBlbGVtZW50OiBjdXJyZW50RWxlbWVudCwKICAgICAgICAgIGhpbnQ6IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1oaW50IiksCiAgICAgICAgICBoaW50UG9zaXRpb246IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1oaW50cG9zaXRpb24iKSB8fCBfdGhpczUuX29wdGlvbnMuaGludFBvc2l0aW9uLAogICAgICAgICAgaGludEFuaW1hdGlvbjogaGludEFuaW1hdGlvbiwKICAgICAgICAgIHRvb2x0aXBDbGFzczogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXRvb2x0aXBjbGFzcyIpLAogICAgICAgICAgcG9zaXRpb246IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1wb3NpdGlvbiIpIHx8IF90aGlzNS5fb3B0aW9ucy50b29sdGlwUG9zaXRpb24KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgYWRkSGludHMuY2FsbCh0aGlzKTsKICAgIC8qCiAgICB0b2RvOgogICAgdGhlc2UgZXZlbnRzIHNob3VsZCBiZSByZW1vdmVkIGF0IHNvbWUgcG9pbnQKICAgICovCgogICAgRE9NRXZlbnQub24oZG9jdW1lbnQsICJjbGljayIsIHJlbW92ZUhpbnRUb29sdGlwLCB0aGlzLCBmYWxzZSk7CiAgICBET01FdmVudC5vbih3aW5kb3csICJyZXNpemUiLCByZUFsaWduSGludHMsIHRoaXMsIHRydWUpOwogIH0KICAvKioKICAgKiBSZS1hbGlnbnMgYWxsIGhpbnQgZWxlbWVudHMKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3JlQWxpZ25IaW50cwogICAqLwoKCiAgZnVuY3Rpb24gcmVBbGlnbkhpbnRzKCkgewogICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgZm9yRWFjaCh0aGlzLl9pbnRyb0l0ZW1zLCBmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgdmFyIHRhcmdldEVsZW1lbnQgPSBfcmVmMi50YXJnZXRFbGVtZW50LAogICAgICAgICAgaGludFBvc2l0aW9uID0gX3JlZjIuaGludFBvc2l0aW9uLAogICAgICAgICAgZWxlbWVudCA9IF9yZWYyLmVsZW1lbnQ7CgogICAgICBpZiAodHlwZW9mIHRhcmdldEVsZW1lbnQgPT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBhbGlnbkhpbnRQb3NpdGlvbi5jYWxsKF90aGlzNiwgaGludFBvc2l0aW9uLCBlbGVtZW50LCB0YXJnZXRFbGVtZW50KTsKICAgIH0pOwogIH0KICAvKioKICAgKiBVcGRhdGUgcGxhY2VtZW50IG9mIHRoZSBpbnRybyBvYmplY3RzIG9uIHRoZSBzY3JlZW4KICAgKiBAYXBpIHByaXZhdGUKICAgKi8KCgogIGZ1bmN0aW9uIHJlZnJlc2goKSB7CiAgICAvLyByZS1hbGlnbiBpbnRyb3MKICAgIHNldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbCh0aGlzLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1oZWxwZXJMYXllciIpKTsKICAgIHNldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbCh0aGlzLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy10b29sdGlwUmVmZXJlbmNlTGF5ZXIiKSk7CiAgICBzZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwodGhpcywgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtZGlzYWJsZUludGVyYWN0aW9uIikpOyAvLyByZS1hbGlnbiB0b29sdGlwCgogICAgaWYgKHRoaXMuX2N1cnJlbnRTdGVwICE9PSB1bmRlZmluZWQgJiYgdGhpcy5fY3VycmVudFN0ZXAgIT09IG51bGwpIHsKICAgICAgdmFyIG9sZEhlbHBlck51bWJlckxheWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtaGVscGVyTnVtYmVyTGF5ZXIiKTsKICAgICAgdmFyIG9sZEFycm93TGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1hcnJvdyIpOwogICAgICB2YXIgb2xkdG9vbHRpcENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLXRvb2x0aXAiKTsKICAgICAgcGxhY2VUb29sdGlwLmNhbGwodGhpcywgdGhpcy5faW50cm9JdGVtc1t0aGlzLl9jdXJyZW50U3RlcF0uZWxlbWVudCwgb2xkdG9vbHRpcENvbnRhaW5lciwgb2xkQXJyb3dMYXllciwgb2xkSGVscGVyTnVtYmVyTGF5ZXIpOwogICAgfSAvL3JlLWFsaWduIGhpbnRzCgoKICAgIHJlQWxpZ25IaW50cy5jYWxsKHRoaXMpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICBmdW5jdGlvbiBvblJlc2l6ZSgpIHsKICAgIHJlZnJlc2guY2FsbCh0aGlzKTsKICB9CiAgLyoqCiAgICogRXhpdCBmcm9tIGludHJvCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9leGl0SW50cm8KICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0RWxlbWVudAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gZm9yY2UgLSBTZXR0aW5nIHRvIGB0cnVlYCB3aWxsIHNraXAgdGhlIHJlc3VsdCBvZiBiZWZvcmVFeGl0IGNhbGxiYWNrCiAgICovCgoKICBmdW5jdGlvbiBleGl0SW50cm8odGFyZ2V0RWxlbWVudCwgZm9yY2UpIHsKICAgIHZhciBjb250aW51ZUV4aXQgPSB0cnVlOyAvLyBjYWxsaW5nIG9uYmVmb3JlZXhpdCBjYWxsYmFjawogICAgLy8KICAgIC8vIElmIHRoaXMgY2FsbGJhY2sgcmV0dXJuIGBmYWxzZWAsIGl0IHdvdWxkIGhhbHQgdGhlIHByb2Nlc3MKCiAgICBpZiAodGhpcy5faW50cm9CZWZvcmVFeGl0Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewogICAgICBjb250aW51ZUV4aXQgPSB0aGlzLl9pbnRyb0JlZm9yZUV4aXRDYWxsYmFjay5jYWxsKHRoaXMpOwogICAgfSAvLyBza2lwIHRoaXMgY2hlY2sgaWYgYGZvcmNlYCBwYXJhbWV0ZXIgaXMgYHRydWVgCiAgICAvLyBvdGhlcndpc2UsIGlmIGBvbmJlZm9yZWV4aXRgIHJldHVybmVkIGBmYWxzZWAsIGRvbid0IGV4aXQgdGhlIGludHJvCgoKICAgIGlmICghZm9yY2UgJiYgY29udGludWVFeGl0ID09PSBmYWxzZSkgcmV0dXJuOyAvL3JlbW92ZSBvdmVybGF5IGxheWVycyBmcm9tIHRoZSBwYWdlCgogICAgdmFyIG92ZXJsYXlMYXllcnMgPSB0YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIi5pbnRyb2pzLW92ZXJsYXkiKTsKCiAgICBpZiAob3ZlcmxheUxheWVycyAmJiBvdmVybGF5TGF5ZXJzLmxlbmd0aCkgewogICAgICBmb3JFYWNoKG92ZXJsYXlMYXllcnMsIGZ1bmN0aW9uIChvdmVybGF5TGF5ZXIpIHsKICAgICAgICBvdmVybGF5TGF5ZXIuc3R5bGUub3BhY2l0eSA9IDA7CiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKHRoaXMucGFyZW50Tm9kZSkgewogICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcyk7CiAgICAgICAgICB9CiAgICAgICAgfS5iaW5kKG92ZXJsYXlMYXllciksIDUwMCk7CiAgICAgIH0pOwogICAgfSAvL3JlbW92ZSBhbGwgaGVscGVyIGxheWVycwoKCiAgICB2YXIgaGVscGVyTGF5ZXIgPSB0YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhlbHBlckxheWVyIik7CgogICAgaWYgKGhlbHBlckxheWVyKSB7CiAgICAgIGhlbHBlckxheWVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaGVscGVyTGF5ZXIpOwogICAgfQoKICAgIHZhciByZWZlcmVuY2VMYXllciA9IHRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtdG9vbHRpcFJlZmVyZW5jZUxheWVyIik7CgogICAgaWYgKHJlZmVyZW5jZUxheWVyKSB7CiAgICAgIHJlZmVyZW5jZUxheWVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocmVmZXJlbmNlTGF5ZXIpOwogICAgfSAvL3JlbW92ZSBkaXNhYmxlSW50ZXJhY3Rpb25MYXllcgoKCiAgICB2YXIgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIgPSB0YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWRpc2FibGVJbnRlcmFjdGlvbiIpOwoKICAgIGlmIChkaXNhYmxlSW50ZXJhY3Rpb25MYXllcikgewogICAgICBkaXNhYmxlSW50ZXJhY3Rpb25MYXllci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRpc2FibGVJbnRlcmFjdGlvbkxheWVyKTsKICAgIH0gLy9yZW1vdmUgaW50cm8gZmxvYXRpbmcgZWxlbWVudAoKCiAgICB2YXIgZmxvYXRpbmdFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanNGbG9hdGluZ0VsZW1lbnQiKTsKCiAgICBpZiAoZmxvYXRpbmdFbGVtZW50KSB7CiAgICAgIGZsb2F0aW5nRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGZsb2F0aW5nRWxlbWVudCk7CiAgICB9CgogICAgcmVtb3ZlU2hvd0VsZW1lbnQoKTsgLy9yZW1vdmUgYGludHJvanMtZml4UGFyZW50YCBjbGFzcyBmcm9tIHRoZSBlbGVtZW50cwoKICAgIHZhciBmaXhQYXJlbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtZml4UGFyZW50Iik7CiAgICBmb3JFYWNoKGZpeFBhcmVudHMsIGZ1bmN0aW9uIChwYXJlbnQpIHsKICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50LCAvaW50cm9qcy1maXhQYXJlbnQvZyk7CiAgICB9KTsgLy9jbGVhbiBsaXN0ZW5lcnMKCiAgICBET01FdmVudC5vZmYod2luZG93LCAia2V5ZG93biIsIG9uS2V5RG93biwgdGhpcywgdHJ1ZSk7CiAgICBET01FdmVudC5vZmYod2luZG93LCAicmVzaXplIiwgb25SZXNpemUsIHRoaXMsIHRydWUpOyAvL2NoZWNrIGlmIGFueSBjYWxsYmFjayBpcyBkZWZpbmVkCgogICAgaWYgKHRoaXMuX2ludHJvRXhpdENhbGxiYWNrICE9PSB1bmRlZmluZWQpIHsKICAgICAgdGhpcy5faW50cm9FeGl0Q2FsbGJhY2suY2FsbCh0aGlzKTsKICAgIH0gLy9zZXQgdGhlIHN0ZXAgdG8gemVybwoKCiAgICB0aGlzLl9jdXJyZW50U3RlcCA9IHVuZGVmaW5lZDsKICB9CiAgLyoqCiAgICogQWRkIG92ZXJsYXkgbGF5ZXIgdG8gdGhlIHBhZ2UKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2FkZE92ZXJsYXlMYXllcgogICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRFbG0KICAgKi8KCgogIGZ1bmN0aW9uIGFkZE92ZXJsYXlMYXllcih0YXJnZXRFbG0pIHsKICAgIHZhciBvdmVybGF5TGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIHZhciBzdHlsZVRleHQgPSAiIjsKICAgIHZhciBzZWxmID0gdGhpczsgLy9zZXQgY3NzIGNsYXNzIG5hbWUKCiAgICBvdmVybGF5TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtb3ZlcmxheSI7IC8vY2hlY2sgaWYgdGhlIHRhcmdldCBlbGVtZW50IGlzIGJvZHksIHdlIHNob3VsZCBjYWxjdWxhdGUgdGhlIHNpemUgb2Ygb3ZlcmxheSBsYXllciBpbiBhIGJldHRlciB3YXkKCiAgICBpZiAoIXRhcmdldEVsbS50YWdOYW1lIHx8IHRhcmdldEVsbS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJib2R5IikgewogICAgICBzdHlsZVRleHQgKz0gInRvcDogMDtib3R0b206IDA7IGxlZnQ6IDA7cmlnaHQ6IDA7cG9zaXRpb246IGZpeGVkOyI7CiAgICAgIG92ZXJsYXlMYXllci5zdHlsZS5jc3NUZXh0ID0gc3R5bGVUZXh0OwogICAgfSBlbHNlIHsKICAgICAgLy9zZXQgb3ZlcmxheSBsYXllciBwb3NpdGlvbgogICAgICB2YXIgZWxlbWVudFBvc2l0aW9uID0gZ2V0T2Zmc2V0KHRhcmdldEVsbSk7CgogICAgICBpZiAoZWxlbWVudFBvc2l0aW9uKSB7CiAgICAgICAgc3R5bGVUZXh0ICs9ICJ3aWR0aDogIi5jb25jYXQoZWxlbWVudFBvc2l0aW9uLndpZHRoLCAicHg7IGhlaWdodDoiKS5jb25jYXQoZWxlbWVudFBvc2l0aW9uLmhlaWdodCwgInB4OyB0b3A6IikuY29uY2F0KGVsZW1lbnRQb3NpdGlvbi50b3AsICJweDtsZWZ0OiAiKS5jb25jYXQoZWxlbWVudFBvc2l0aW9uLmxlZnQsICJweDsiKTsKICAgICAgICBvdmVybGF5TGF5ZXIuc3R5bGUuY3NzVGV4dCA9IHN0eWxlVGV4dDsKICAgICAgfQogICAgfQoKICAgIHRhcmdldEVsbS5hcHBlbmRDaGlsZChvdmVybGF5TGF5ZXIpOwoKICAgIG92ZXJsYXlMYXllci5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoc2VsZi5fb3B0aW9ucy5leGl0T25PdmVybGF5Q2xpY2sgPT09IHRydWUpIHsKICAgICAgICBleGl0SW50cm8uY2FsbChzZWxmLCB0YXJnZXRFbG0pOwogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgc3R5bGVUZXh0ICs9ICJvcGFjaXR5OiAiLmNvbmNhdChzZWxmLl9vcHRpb25zLm92ZXJsYXlPcGFjaXR5LnRvU3RyaW5nKCksICI7Iik7CiAgICAgIG92ZXJsYXlMYXllci5zdHlsZS5jc3NUZXh0ID0gc3R5bGVUZXh0OwogICAgfSwgMTApOwogICAgcmV0dXJuIHRydWU7CiAgfQogIC8qKgogICAqIEluaXRpYXRlIGEgbmV3IGludHJvZHVjdGlvbi9ndWlkZSBmcm9tIGFuIGVsZW1lbnQgaW4gdGhlIHBhZ2UKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2ludHJvRm9yRWxlbWVudAogICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRFbG0KICAgKiBAcGFyYW0ge1N0cmluZ30gZ3JvdXAKICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gU3VjY2VzcyBvciBub3Q/CiAgICovCgoKICBmdW5jdGlvbiBpbnRyb0ZvckVsZW1lbnQodGFyZ2V0RWxtLCBncm91cCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgYWxsSW50cm9TdGVwcyA9IHRhcmdldEVsbS5xdWVyeVNlbGVjdG9yQWxsKCIqW2RhdGEtaW50cm9dIik7CiAgICB2YXIgaW50cm9JdGVtcyA9IFtdOwoKICAgIGlmICh0aGlzLl9vcHRpb25zLnN0ZXBzKSB7CiAgICAgIC8vdXNlIHN0ZXBzIHBhc3NlZCBwcm9ncmFtbWF0aWNhbGx5CiAgICAgIGZvckVhY2godGhpcy5fb3B0aW9ucy5zdGVwcywgZnVuY3Rpb24gKHN0ZXApIHsKICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSBjbG9uZU9iamVjdChzdGVwKTsgLy9zZXQgdGhlIHN0ZXAKCiAgICAgICAgY3VycmVudEl0ZW0uc3RlcCA9IGludHJvSXRlbXMubGVuZ3RoICsgMTsgLy91c2UgcXVlcnlTZWxlY3RvciBmdW5jdGlvbiBvbmx5IHdoZW4gZGV2ZWxvcGVyIHVzZWQgQ1NTIHNlbGVjdG9yCgogICAgICAgIGlmICh0eXBlb2YgY3VycmVudEl0ZW0uZWxlbWVudCA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIC8vZ3JhYiB0aGUgZWxlbWVudCB3aXRoIGdpdmVuIHNlbGVjdG9yIGZyb20gdGhlIHBhZ2UKICAgICAgICAgIGN1cnJlbnRJdGVtLmVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGN1cnJlbnRJdGVtLmVsZW1lbnQpOwogICAgICAgIH0gLy9pbnRybyB3aXRob3V0IGVsZW1lbnQKCgogICAgICAgIGlmICh0eXBlb2YgY3VycmVudEl0ZW0uZWxlbWVudCA9PT0gInVuZGVmaW5lZCIgfHwgY3VycmVudEl0ZW0uZWxlbWVudCA9PT0gbnVsbCkgewogICAgICAgICAgdmFyIGZsb2F0aW5nRWxlbWVudFF1ZXJ5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanNGbG9hdGluZ0VsZW1lbnQiKTsKCiAgICAgICAgICBpZiAoZmxvYXRpbmdFbGVtZW50UXVlcnkgPT09IG51bGwpIHsKICAgICAgICAgICAgZmxvYXRpbmdFbGVtZW50UXVlcnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgICAgZmxvYXRpbmdFbGVtZW50UXVlcnkuY2xhc3NOYW1lID0gImludHJvanNGbG9hdGluZ0VsZW1lbnQiOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZsb2F0aW5nRWxlbWVudFF1ZXJ5KTsKICAgICAgICAgIH0KCiAgICAgICAgICBjdXJyZW50SXRlbS5lbGVtZW50ID0gZmxvYXRpbmdFbGVtZW50UXVlcnk7CiAgICAgICAgICBjdXJyZW50SXRlbS5wb3NpdGlvbiA9ICJmbG9hdGluZyI7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50SXRlbS5zY3JvbGxUbyA9IGN1cnJlbnRJdGVtLnNjcm9sbFRvIHx8IF90aGlzLl9vcHRpb25zLnNjcm9sbFRvOwoKICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnRJdGVtLmRpc2FibGVJbnRlcmFjdGlvbiA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIGN1cnJlbnRJdGVtLmRpc2FibGVJbnRlcmFjdGlvbiA9IF90aGlzLl9vcHRpb25zLmRpc2FibGVJbnRlcmFjdGlvbjsKICAgICAgICB9CgogICAgICAgIGlmIChjdXJyZW50SXRlbS5lbGVtZW50ICE9PSBudWxsKSB7CiAgICAgICAgICBpbnRyb0l0ZW1zLnB1c2goY3VycmVudEl0ZW0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICAvL3VzZSBzdGVwcyBmcm9tIGRhdGEtKiBhbm5vdGF0aW9ucwogICAgICB2YXIgZWxtc0xlbmd0aCA9IGFsbEludHJvU3RlcHMubGVuZ3RoOwogICAgICB2YXIgZGlzYWJsZUludGVyYWN0aW9uOyAvL2lmIHRoZXJlJ3Mgbm8gZWxlbWVudCB0byBpbnRybwoKICAgICAgaWYgKGVsbXNMZW5ndGggPCAxKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBmb3JFYWNoKGFsbEludHJvU3RlcHMsIGZ1bmN0aW9uIChjdXJyZW50RWxlbWVudCkgewogICAgICAgIC8vIFBSICM4MAogICAgICAgIC8vIHN0YXJ0IGludHJvIGZvciBncm91cHMgb2YgZWxlbWVudHMKICAgICAgICBpZiAoZ3JvdXAgJiYgY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLWludHJvLWdyb3VwIikgIT09IGdyb3VwKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyBza2lwIGhpZGRlbiBlbGVtZW50cwoKCiAgICAgICAgaWYgKGN1cnJlbnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPT09ICJub25lIikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0ZXAgPSBwYXJzZUludChjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtc3RlcCIpLCAxMCk7CgogICAgICAgIGlmICh0eXBlb2YgY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLWRpc2FibGUtaW50ZXJhY3Rpb24iKSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIGRpc2FibGVJbnRlcmFjdGlvbiA9ICEhY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLWRpc2FibGUtaW50ZXJhY3Rpb24iKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uID0gX3RoaXMuX29wdGlvbnMuZGlzYWJsZUludGVyYWN0aW9uOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0ZXAgPiAwKSB7CiAgICAgICAgICBpbnRyb0l0ZW1zW3N0ZXAgLSAxXSA9IHsKICAgICAgICAgICAgZWxlbWVudDogY3VycmVudEVsZW1lbnQsCiAgICAgICAgICAgIGludHJvOiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtaW50cm8iKSwKICAgICAgICAgICAgc3RlcDogcGFyc2VJbnQoY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXN0ZXAiKSwgMTApLAogICAgICAgICAgICB0b29sdGlwQ2xhc3M6IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS10b29sdGlwY2xhc3MiKSwKICAgICAgICAgICAgaGlnaGxpZ2h0Q2xhc3M6IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1oaWdobGlnaHRjbGFzcyIpLAogICAgICAgICAgICBwb3NpdGlvbjogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXBvc2l0aW9uIikgfHwgX3RoaXMuX29wdGlvbnMudG9vbHRpcFBvc2l0aW9uLAogICAgICAgICAgICBzY3JvbGxUbzogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXNjcm9sbHRvIikgfHwgX3RoaXMuX29wdGlvbnMuc2Nyb2xsVG8sCiAgICAgICAgICAgIGRpc2FibGVJbnRlcmFjdGlvbjogZGlzYWJsZUludGVyYWN0aW9uCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7IC8vbmV4dCBhZGQgaW50cm8gaXRlbXMgd2l0aG91dCBkYXRhLXN0ZXAKICAgICAgLy90b2RvOiB3ZSBuZWVkIGEgY2xlYW51cCBoZXJlLCB0d28gbG9vcHMgYXJlIHJlZHVuZGFudAoKICAgICAgdmFyIF9uZXh0U3RlcCA9IDA7CiAgICAgIGZvckVhY2goYWxsSW50cm9TdGVwcywgZnVuY3Rpb24gKGN1cnJlbnRFbGVtZW50KSB7CiAgICAgICAgLy8gUFIgIzgwCiAgICAgICAgLy8gc3RhcnQgaW50cm8gZm9yIGdyb3VwcyBvZiBlbGVtZW50cwogICAgICAgIGlmIChncm91cCAmJiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtaW50cm8tZ3JvdXAiKSAhPT0gZ3JvdXApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtc3RlcCIpID09PSBudWxsKSB7CiAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICBpZiAodHlwZW9mIGludHJvSXRlbXNbX25leHRTdGVwXSA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBfbmV4dFN0ZXArKzsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0eXBlb2YgY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLWRpc2FibGUtaW50ZXJhY3Rpb24iKSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uID0gISFjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtZGlzYWJsZS1pbnRlcmFjdGlvbiIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uID0gX3RoaXMuX29wdGlvbnMuZGlzYWJsZUludGVyYWN0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGludHJvSXRlbXNbX25leHRTdGVwXSA9IHsKICAgICAgICAgICAgZWxlbWVudDogY3VycmVudEVsZW1lbnQsCiAgICAgICAgICAgIGludHJvOiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtaW50cm8iKSwKICAgICAgICAgICAgc3RlcDogX25leHRTdGVwICsgMSwKICAgICAgICAgICAgdG9vbHRpcENsYXNzOiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtdG9vbHRpcGNsYXNzIiksCiAgICAgICAgICAgIGhpZ2hsaWdodENsYXNzOiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtaGlnaGxpZ2h0Y2xhc3MiKSwKICAgICAgICAgICAgcG9zaXRpb246IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1wb3NpdGlvbiIpIHx8IF90aGlzLl9vcHRpb25zLnRvb2x0aXBQb3NpdGlvbiwKICAgICAgICAgICAgc2Nyb2xsVG86IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1zY3JvbGx0byIpIHx8IF90aGlzLl9vcHRpb25zLnNjcm9sbFRvLAogICAgICAgICAgICBkaXNhYmxlSW50ZXJhY3Rpb246IGRpc2FibGVJbnRlcmFjdGlvbgogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSAvL3JlbW92aW5nIHVuZGVmaW5lZC9udWxsIGVsZW1lbnRzCgoKICAgIHZhciB0ZW1wSW50cm9JdGVtcyA9IFtdOwoKICAgIGZvciAodmFyIHogPSAwOyB6IDwgaW50cm9JdGVtcy5sZW5ndGg7IHorKykgewogICAgICBpZiAoaW50cm9JdGVtc1t6XSkgewogICAgICAgIC8vIGNvcHkgbm9uLWZhbHN5IHZhbHVlcyB0byB0aGUgZW5kIG9mIHRoZSBhcnJheQogICAgICAgIHRlbXBJbnRyb0l0ZW1zLnB1c2goaW50cm9JdGVtc1t6XSk7CiAgICAgIH0KICAgIH0KCiAgICBpbnRyb0l0ZW1zID0gdGVtcEludHJvSXRlbXM7IC8vT2ssIHNvcnQgYWxsIGl0ZW1zIHdpdGggZ2l2ZW4gc3RlcHMKCiAgICBpbnRyb0l0ZW1zLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgcmV0dXJuIGEuc3RlcCAtIGIuc3RlcDsKICAgIH0pOyAvL3NldCBpdCB0byB0aGUgaW50cm9KcyBvYmplY3QKCiAgICB0aGlzLl9pbnRyb0l0ZW1zID0gaW50cm9JdGVtczsgLy9hZGQgb3ZlcmxheSBsYXllciB0byB0aGUgcGFnZQoKICAgIGlmIChhZGRPdmVybGF5TGF5ZXIuY2FsbCh0aGlzLCB0YXJnZXRFbG0pKSB7CiAgICAgIC8vdGhlbiwgc3RhcnQgdGhlIHNob3cKICAgICAgbmV4dFN0ZXAuY2FsbCh0aGlzKTsKCiAgICAgIGlmICh0aGlzLl9vcHRpb25zLmtleWJvYXJkTmF2aWdhdGlvbikgewogICAgICAgIERPTUV2ZW50Lm9uKHdpbmRvdywgImtleWRvd24iLCBvbktleURvd24sIHRoaXMsIHRydWUpOwogICAgICB9IC8vZm9yIHdpbmRvdyByZXNpemUKCgogICAgICBET01FdmVudC5vbih3aW5kb3csICJyZXNpemUiLCBvblJlc2l6ZSwgdGhpcywgdHJ1ZSk7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgdmFyIHZlcnNpb24gPSAiMy4wLjEiOwogIC8qKgogICAqIEludHJvSnMgbWFpbiBjbGFzcwogICAqCiAgICogQGNsYXNzIEludHJvSnMKICAgKi8KCiAgZnVuY3Rpb24gSW50cm9KcyhvYmopIHsKICAgIHRoaXMuX3RhcmdldEVsZW1lbnQgPSBvYmo7CiAgICB0aGlzLl9pbnRyb0l0ZW1zID0gW107CiAgICB0aGlzLl9vcHRpb25zID0gewogICAgICAvKiBMYWJlbCBEaXNwbGF5IHRvIGJlIFNob3duIGluIHRoZSBoaWdobGlnaHRlZCBkaXYgKi8KICAgICAgbGFiZWxEaXNwbGF5OiAiIiwKCiAgICAgIC8qIE5leHQgYnV0dG9uIGxhYmVsIGluIHRvb2x0aXAgYm94ICovCiAgICAgIG5leHRMYWJlbDogIk5leHQgJnJhcnI7IiwKCiAgICAgIC8qIFByZXZpb3VzIGJ1dHRvbiBsYWJlbCBpbiB0b29sdGlwIGJveCAqLwogICAgICBwcmV2TGFiZWw6ICImbGFycjsgQmFjayIsCgogICAgICAvKiBTa2lwIGJ1dHRvbiBsYWJlbCBpbiB0b29sdGlwIGJveCAqLwogICAgICBza2lwTGFiZWw6ICJTa2lwIiwKCiAgICAgIC8qIERvbmUgYnV0dG9uIGxhYmVsIGluIHRvb2x0aXAgYm94ICovCiAgICAgIGRvbmVMYWJlbDogIkRvbmUiLAoKICAgICAgLyogSGlkZSBwcmV2aW91cyBidXR0b24gaW4gdGhlIGZpcnN0IHN0ZXA/IE90aGVyd2lzZSwgaXQgd2lsbCBiZSBkaXNhYmxlZCBidXR0b24uICovCiAgICAgIGhpZGVQcmV2OiBmYWxzZSwKCiAgICAgIC8qIEhpZGUgbmV4dCBidXR0b24gaW4gdGhlIGxhc3Qgc3RlcD8gT3RoZXJ3aXNlLCBpdCB3aWxsIGJlIGRpc2FibGVkIGJ1dHRvbi4gKi8KICAgICAgaGlkZU5leHQ6IGZhbHNlLAoKICAgICAgLyogRGVmYXVsdCB0b29sdGlwIGJveCBwb3NpdGlvbiAqLwogICAgICB0b29sdGlwUG9zaXRpb246ICJib3R0b20iLAoKICAgICAgLyogTmV4dCBDU1MgY2xhc3MgZm9yIHRvb2x0aXAgYm94ZXMgKi8KICAgICAgdG9vbHRpcENsYXNzOiAiIiwKCiAgICAgIC8qIENTUyBjbGFzcyB0aGF0IGlzIGFkZGVkIHRvIHRoZSBoZWxwZXJMYXllciAqLwogICAgICBoaWdobGlnaHRDbGFzczogIiIsCgogICAgICAvKiBDbG9zZSBpbnRyb2R1Y3Rpb24gd2hlbiBwcmVzc2luZyBFc2NhcGUgYnV0dG9uPyAqLwogICAgICBleGl0T25Fc2M6IHRydWUsCgogICAgICAvKiBDbG9zZSBpbnRyb2R1Y3Rpb24gd2hlbiBjbGlja2luZyBvbiBvdmVybGF5IGxheWVyPyAqLwogICAgICBleGl0T25PdmVybGF5Q2xpY2s6IHRydWUsCgogICAgICAvKiBTaG93IHN0ZXAgbnVtYmVycyBpbiBpbnRyb2R1Y3Rpb24/ICovCiAgICAgIHNob3dTdGVwTnVtYmVyczogdHJ1ZSwKCiAgICAgIC8qIExldCB1c2VyIHVzZSBrZXlib2FyZCB0byBuYXZpZ2F0ZSB0aGUgdG91cj8gKi8KICAgICAga2V5Ym9hcmROYXZpZ2F0aW9uOiB0cnVlLAoKICAgICAgLyogU2hvdyB0b3VyIGNvbnRyb2wgYnV0dG9ucz8gKi8KICAgICAgc2hvd0J1dHRvbnM6IHRydWUsCgogICAgICAvKiBTaG93IHRvdXIgYnVsbGV0cz8gKi8KICAgICAgc2hvd0J1bGxldHM6IHRydWUsCgogICAgICAvKiBTaG93IHRvdXIgcHJvZ3Jlc3M/ICovCiAgICAgIHNob3dQcm9ncmVzczogZmFsc2UsCgogICAgICAvKiBTY3JvbGwgdG8gaGlnaGxpZ2h0ZWQgZWxlbWVudD8gKi8KICAgICAgc2Nyb2xsVG9FbGVtZW50OiB0cnVlLAoKICAgICAgLyoKICAgICAgICogU2hvdWxkIHdlIHNjcm9sbCB0aGUgdG9vbHRpcCBvciB0YXJnZXQgZWxlbWVudD8KICAgICAgICoKICAgICAgICogT3B0aW9ucyBhcmU6ICdlbGVtZW50JyBvciAndG9vbHRpcCcKICAgICAgICovCiAgICAgIHNjcm9sbFRvOiAiZWxlbWVudCIsCgogICAgICAvKiBQYWRkaW5nIHRvIGFkZCBhZnRlciBzY3JvbGxpbmcgd2hlbiBlbGVtZW50IGlzIG5vdCBpbiB0aGUgdmlld3BvcnQgKGluIHBpeGVscykgKi8KICAgICAgc2Nyb2xsUGFkZGluZzogMzAsCgogICAgICAvKiBTZXQgdGhlIG92ZXJsYXkgb3BhY2l0eSAqLwogICAgICBvdmVybGF5T3BhY2l0eTogMC44LAoKICAgICAgLyogUHJlY2VkZW5jZSBvZiBwb3NpdGlvbnMsIHdoZW4gYXV0byBpcyBlbmFibGVkICovCiAgICAgIHBvc2l0aW9uUHJlY2VkZW5jZTogWyJib3R0b20iLCAidG9wIiwgInJpZ2h0IiwgImxlZnQiXSwKCiAgICAgIC8qIERpc2FibGUgYW4gaW50ZXJhY3Rpb24gd2l0aCBlbGVtZW50PyAqLwogICAgICBkaXNhYmxlSW50ZXJhY3Rpb246IGZhbHNlLAoKICAgICAgLyogU2V0IGhvdyBtdWNoIHBhZGRpbmcgdG8gYmUgdXNlZCBhcm91bmQgaGVscGVyIGVsZW1lbnQgKi8KICAgICAgaGVscGVyRWxlbWVudFBhZGRpbmc6IDEwLAoKICAgICAgLyogRGVmYXVsdCBoaW50IHBvc2l0aW9uICovCiAgICAgIGhpbnRQb3NpdGlvbjogInRvcC1taWRkbGUiLAoKICAgICAgLyogSGludCBidXR0b24gbGFiZWwgKi8KICAgICAgaGludEJ1dHRvbkxhYmVsOiAiR290IGl0IiwKCiAgICAgIC8qIEFkZGluZyBhbmltYXRpb24gdG8gaGludHM/ICovCiAgICAgIGhpbnRBbmltYXRpb246IHRydWUsCgogICAgICAvKiBhZGRpdGlvbmFsIGNsYXNzZXMgdG8gcHV0IG9uIHRoZSBidXR0b25zICovCiAgICAgIGJ1dHRvbkNsYXNzOiAiaW50cm9qcy1idXR0b24iCiAgICB9OwogIH0KCiAgdmFyIGludHJvSnMgPSBmdW5jdGlvbiBpbnRyb0pzKHRhcmdldEVsbSkgewogICAgdmFyIGluc3RhbmNlOwoKICAgIGlmIChfdHlwZW9mKHRhcmdldEVsbSkgPT09ICJvYmplY3QiKSB7CiAgICAgIC8vT2ssIGNyZWF0ZSBhIG5ldyBpbnN0YW5jZQogICAgICBpbnN0YW5jZSA9IG5ldyBJbnRyb0pzKHRhcmdldEVsbSk7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiB0YXJnZXRFbG0gPT09ICJzdHJpbmciKSB7CiAgICAgIC8vc2VsZWN0IHRoZSB0YXJnZXQgZWxlbWVudCB3aXRoIHF1ZXJ5IHNlbGVjdG9yCiAgICAgIHZhciB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXRFbG0pOwoKICAgICAgaWYgKHRhcmdldEVsZW1lbnQpIHsKICAgICAgICBpbnN0YW5jZSA9IG5ldyBJbnRyb0pzKHRhcmdldEVsZW1lbnQpOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiVGhlcmUgaXMgbm8gZWxlbWVudCB3aXRoIGdpdmVuIHNlbGVjdG9yLiIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpbnN0YW5jZSA9IG5ldyBJbnRyb0pzKGRvY3VtZW50LmJvZHkpOwogICAgfSAvLyBhZGQgaW5zdGFuY2UgdG8gbGlzdCBvZiBfaW5zdGFuY2VzCiAgICAvLyBwYXNzaW5nIGdyb3VwIHRvIHN0YW1wIHRvIGluY3JlbWVudAogICAgLy8gZnJvbSAwIG9ud2FyZCBzb21ld2hhdCByZWxpYWJseQoKCiAgICBpbnRyb0pzLmluc3RhbmNlc1tzdGFtcChpbnN0YW5jZSwgImludHJvanMtaW5zdGFuY2UiKV0gPSBpbnN0YW5jZTsKICAgIHJldHVybiBpbnN0YW5jZTsKICB9OwogIC8qKgogICAqIEN1cnJlbnQgSW50cm9KcyB2ZXJzaW9uCiAgICoKICAgKiBAcHJvcGVydHkgdmVyc2lvbgogICAqIEB0eXBlIFN0cmluZwogICAqLwoKCiAgaW50cm9Kcy52ZXJzaW9uID0gdmVyc2lvbjsKICAvKioKICAgKiBrZXktdmFsIG9iamVjdCBoZWxwZXIgZm9yIGludHJvSnMgaW5zdGFuY2VzCiAgICoKICAgKiBAcHJvcGVydHkgaW5zdGFuY2VzCiAgICogQHR5cGUgT2JqZWN0CiAgICovCgogIGludHJvSnMuaW5zdGFuY2VzID0ge307IC8vUHJvdG90eXBlCgogIGludHJvSnMuZm4gPSBJbnRyb0pzLnByb3RvdHlwZSA9IHsKICAgIGNsb25lOiBmdW5jdGlvbiBjbG9uZSgpIHsKICAgICAgcmV0dXJuIG5ldyBJbnRyb0pzKHRoaXMpOwogICAgfSwKICAgIHNldE9wdGlvbjogZnVuY3Rpb24gc2V0T3B0aW9uKG9wdGlvbiwgdmFsdWUpIHsKICAgICAgdGhpcy5fb3B0aW9uc1tvcHRpb25dID0gdmFsdWU7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHNldE9wdGlvbnM6IGZ1bmN0aW9uIHNldE9wdGlvbnMob3B0aW9ucykgewogICAgICB0aGlzLl9vcHRpb25zID0gbWVyZ2VPcHRpb25zKHRoaXMuX29wdGlvbnMsIG9wdGlvbnMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBzdGFydDogZnVuY3Rpb24gc3RhcnQoZ3JvdXApIHsKICAgICAgaW50cm9Gb3JFbGVtZW50LmNhbGwodGhpcywgdGhpcy5fdGFyZ2V0RWxlbWVudCwgZ3JvdXApOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBnb1RvU3RlcDogZnVuY3Rpb24gZ29Ub1N0ZXAkMShzdGVwKSB7CiAgICAgIGdvVG9TdGVwLmNhbGwodGhpcywgc3RlcCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGFkZFN0ZXA6IGZ1bmN0aW9uIGFkZFN0ZXAob3B0aW9ucykgewogICAgICBpZiAoIXRoaXMuX29wdGlvbnMuc3RlcHMpIHsKICAgICAgICB0aGlzLl9vcHRpb25zLnN0ZXBzID0gW107CiAgICAgIH0KCiAgICAgIHRoaXMuX29wdGlvbnMuc3RlcHMucHVzaChvcHRpb25zKTsKCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGFkZFN0ZXBzOiBmdW5jdGlvbiBhZGRTdGVwcyhzdGVwcykgewogICAgICBpZiAoIXN0ZXBzLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHN0ZXBzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgIHRoaXMuYWRkU3RlcChzdGVwc1tpbmRleF0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBnb1RvU3RlcE51bWJlcjogZnVuY3Rpb24gZ29Ub1N0ZXBOdW1iZXIkMShzdGVwKSB7CiAgICAgIGdvVG9TdGVwTnVtYmVyLmNhbGwodGhpcywgc3RlcCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIG5leHRTdGVwOiBmdW5jdGlvbiBuZXh0U3RlcCQxKCkgewogICAgICBuZXh0U3RlcC5jYWxsKHRoaXMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBwcmV2aW91c1N0ZXA6IGZ1bmN0aW9uIHByZXZpb3VzU3RlcCQxKCkgewogICAgICBwcmV2aW91c1N0ZXAuY2FsbCh0aGlzKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgY3VycmVudFN0ZXA6IGZ1bmN0aW9uIGN1cnJlbnRTdGVwJDEoKSB7CiAgICAgIHJldHVybiBjdXJyZW50U3RlcC5jYWxsKHRoaXMpOwogICAgfSwKICAgIGV4aXQ6IGZ1bmN0aW9uIGV4aXQoZm9yY2UpIHsKICAgICAgZXhpdEludHJvLmNhbGwodGhpcywgdGhpcy5fdGFyZ2V0RWxlbWVudCwgZm9yY2UpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICByZWZyZXNoOiBmdW5jdGlvbiByZWZyZXNoJDEoKSB7CiAgICAgIHJlZnJlc2guY2FsbCh0aGlzKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgb25iZWZvcmVjaGFuZ2U6IGZ1bmN0aW9uIG9uYmVmb3JlY2hhbmdlKHByb3ZpZGVkQ2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faW50cm9CZWZvcmVDaGFuZ2VDYWxsYmFjayA9IHByb3ZpZGVkQ2FsbGJhY2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQcm92aWRlZCBjYWxsYmFjayBmb3Igb25iZWZvcmVjaGFuZ2Ugd2FzIG5vdCBhIGZ1bmN0aW9uIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIG9uY2hhbmdlOiBmdW5jdGlvbiBvbmNoYW5nZShwcm92aWRlZENhbGxiYWNrKSB7CiAgICAgIGlmICh0eXBlb2YgcHJvdmlkZWRDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMuX2ludHJvQ2hhbmdlQ2FsbGJhY2sgPSBwcm92aWRlZENhbGxiYWNrOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uY2hhbmdlIHdhcyBub3QgYSBmdW5jdGlvbi4iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgb25hZnRlcmNoYW5nZTogZnVuY3Rpb24gb25hZnRlcmNoYW5nZShwcm92aWRlZENhbGxiYWNrKSB7CiAgICAgIGlmICh0eXBlb2YgcHJvdmlkZWRDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMuX2ludHJvQWZ0ZXJDaGFuZ2VDYWxsYmFjayA9IHByb3ZpZGVkQ2FsbGJhY2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQcm92aWRlZCBjYWxsYmFjayBmb3Igb25hZnRlcmNoYW5nZSB3YXMgbm90IGEgZnVuY3Rpb24iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgb25jb21wbGV0ZTogZnVuY3Rpb24gb25jb21wbGV0ZShwcm92aWRlZENhbGxiYWNrKSB7CiAgICAgIGlmICh0eXBlb2YgcHJvdmlkZWRDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMuX2ludHJvQ29tcGxldGVDYWxsYmFjayA9IHByb3ZpZGVkQ2FsbGJhY2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQcm92aWRlZCBjYWxsYmFjayBmb3Igb25jb21wbGV0ZSB3YXMgbm90IGEgZnVuY3Rpb24uIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIG9uaGludHNhZGRlZDogZnVuY3Rpb24gb25oaW50c2FkZGVkKHByb3ZpZGVkQ2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faGludHNBZGRlZENhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbmhpbnRzYWRkZWQgd2FzIG5vdCBhIGZ1bmN0aW9uLiIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBvbmhpbnRjbGljazogZnVuY3Rpb24gb25oaW50Y2xpY2socHJvdmlkZWRDYWxsYmFjaykgewogICAgICBpZiAodHlwZW9mIHByb3ZpZGVkQ2FsbGJhY2sgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB0aGlzLl9oaW50Q2xpY2tDYWxsYmFjayA9IHByb3ZpZGVkQ2FsbGJhY2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQcm92aWRlZCBjYWxsYmFjayBmb3Igb25oaW50Y2xpY2sgd2FzIG5vdCBhIGZ1bmN0aW9uLiIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBvbmhpbnRjbG9zZTogZnVuY3Rpb24gb25oaW50Y2xvc2UocHJvdmlkZWRDYWxsYmFjaykgewogICAgICBpZiAodHlwZW9mIHByb3ZpZGVkQ2FsbGJhY2sgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB0aGlzLl9oaW50Q2xvc2VDYWxsYmFjayA9IHByb3ZpZGVkQ2FsbGJhY2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQcm92aWRlZCBjYWxsYmFjayBmb3Igb25oaW50Y2xvc2Ugd2FzIG5vdCBhIGZ1bmN0aW9uLiIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBvbmV4aXQ6IGZ1bmN0aW9uIG9uZXhpdChwcm92aWRlZENhbGxiYWNrKSB7CiAgICAgIGlmICh0eXBlb2YgcHJvdmlkZWRDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMuX2ludHJvRXhpdENhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbmV4aXQgd2FzIG5vdCBhIGZ1bmN0aW9uLiIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBvbnNraXA6IGZ1bmN0aW9uIG9uc2tpcChwcm92aWRlZENhbGxiYWNrKSB7CiAgICAgIGlmICh0eXBlb2YgcHJvdmlkZWRDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMuX2ludHJvU2tpcENhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbnNraXAgd2FzIG5vdCBhIGZ1bmN0aW9uLiIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBvbmJlZm9yZWV4aXQ6IGZ1bmN0aW9uIG9uYmVmb3JlZXhpdChwcm92aWRlZENhbGxiYWNrKSB7CiAgICAgIGlmICh0eXBlb2YgcHJvdmlkZWRDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMuX2ludHJvQmVmb3JlRXhpdENhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbmJlZm9yZWV4aXQgd2FzIG5vdCBhIGZ1bmN0aW9uLiIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBhZGRIaW50czogZnVuY3Rpb24gYWRkSGludHMoKSB7CiAgICAgIHBvcHVsYXRlSGludHMuY2FsbCh0aGlzLCB0aGlzLl90YXJnZXRFbGVtZW50KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgaGlkZUhpbnQ6IGZ1bmN0aW9uIGhpZGVIaW50JDEoc3RlcElkKSB7CiAgICAgIGhpZGVIaW50LmNhbGwodGhpcywgc3RlcElkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgaGlkZUhpbnRzOiBmdW5jdGlvbiBoaWRlSGludHMkMSgpIHsKICAgICAgaGlkZUhpbnRzLmNhbGwodGhpcyk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHNob3dIaW50OiBmdW5jdGlvbiBzaG93SGludCQxKHN0ZXBJZCkgewogICAgICBzaG93SGludC5jYWxsKHRoaXMsIHN0ZXBJZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHNob3dIaW50czogZnVuY3Rpb24gc2hvd0hpbnRzJDEoKSB7CiAgICAgIHNob3dIaW50cy5jYWxsKHRoaXMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICByZW1vdmVIaW50czogZnVuY3Rpb24gcmVtb3ZlSGludHMkMSgpIHsKICAgICAgcmVtb3ZlSGludHMuY2FsbCh0aGlzKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgcmVtb3ZlSGludDogZnVuY3Rpb24gcmVtb3ZlSGludCQxKHN0ZXBJZCkgewogICAgICByZW1vdmVIaW50KCkuY2FsbCh0aGlzLCBzdGVwSWQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBzaG93SGludERpYWxvZzogZnVuY3Rpb24gc2hvd0hpbnREaWFsb2ckMShzdGVwSWQpIHsKICAgICAgc2hvd0hpbnREaWFsb2cuY2FsbCh0aGlzLCBzdGVwSWQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwogIHJldHVybiBpbnRyb0pzOwp9KTs="},{"version":3,"sources":["/home/vimalesh/Elixir/chatbot-portal/src/portal/Chatbot/Dashboard/Layout/intro.js"],"names":["require","image","global","factory","exports","module","define","amd","self","introJs","_typeof","obj","Symbol","iterator","constructor","prototype","mergeOptions","obj1","obj2","obj3","attrname","stamp","keys","key","arguments","length","undefined","forEach","arr","forEachFnc","completeFnc","i","len","removeClass","element","classNameRegex","SVGElement","pre","getAttribute","setAttribute","replace","className","DOMEvent","events_key","_id","type","listener","context","concat","on","useCapture","id","apply","handler","e","call","window","event","addEventListener","attachEvent","off","removeEventListener","detachEvent","addClass","classList","classes","split","cls","add","match","getPropValue","propName","propValue","currentStyle","document","defaultView","getComputedStyle","getPropertyValue","toLowerCase","setShowElement","_ref","parentElm","parentNode","tagName","currentElementPosition","zIndex","opacity","parseFloat","transform","test","scrollParentToElement","parent","offsetTop","scrollTop","getScrollParent","style","excludeStaticParent","position","overflowRegex","body","parentElement","overflow","overflowY","overflowX","getWinSize","innerWidth","width","height","innerHeight","D","documentElement","clientWidth","clientHeight","elementInViewport","el","rect","getBoundingClientRect","top","left","bottom","right","scrollTo","tooltipLayer","_options","scrollToElement","winHeight","scrollBy","scrollPadding","setAnchorAsButton","anchor","tabIndex","getOffset","docEl","pageYOffset","scrollLeft","pageXOffset","x","isFixed","p","nodeName","setHelperLayerPosition","helperLayer","_introItems","_currentStep","currentElement","elementPosition","widthHeightPadding","helperElementPadding","cssText","checkRight","targetOffset","tooltipLayerStyleLeft","tooltipOffset","windowSize","checkLeft","tooltipLayerStyleRight","removeEntry","stringArray","stringToRemove","includes","splice","indexOf","_determineAutoAlignment","offsetLeft","tooltipWidth","desiredAlignment","halfTooltipWidth","winWidth","Math","min","screen","possibleAlignments","calculatedAlignment","_determineAutoPosition","targetElement","desiredTooltipPosition","possiblePositions","positionPrecedence","slice","tooltipHeight","targetElementRect","calculatedPosition","pos","hyphenIndex","substr","placeTooltip","arrowLayer","helperNumberLayer","hintMode","tooltipCssClass","currentStepObj","currentTooltipPosition","marginLeft","marginTop","display","tooltipClass","tooltipLayerStyleLeftRight","imageLayer","createElement","src","parent_div_for_image","getElementById","showStepNumbers","get_left_offset","max","get_top_offset","removeShowElement","elms","querySelectorAll","elm","_getProgress","currentStep","parseInt","_disableInteraction","disableInteractionLayer","querySelector","_targetElement","appendChild","_showElement","_introChangeCallback","oldHelperLayer","oldReferenceLayer","highlightClass","nextTooltipButton","prevTooltipButton","skipTooltipButton","scrollParent","oldHelperNumberLayer","oldtooltipLayer","oldArrowLayer","oldtooltipContainer","contains","remove","labelDisplay","label_display_div","color","textAlign","innerHTML","lastIntroItem","step","_direction","fixParents","_lastShowElementTimer","clearTimeout","setTimeout","tooltipHeader","fontFamily","tooltipBody","intro","maxWidth","minWidth","marginBottom","paddingLeft","showBullets","focus","referenceLayer","tooltipTextLayer","bulletsLayer","progressLayer","buttonsLayer","ulContainer","anchorClick","goToStep","innerLi","anchorLink","onclick","showProgress","progressBar","showButtons","nextStep","nextLabel","previousStep","prevLabel","buttonClass","skipLabel","_introCompleteCallback","_introSkipCallback","exitIntro","removeChild","disableInteraction","hidePrev","doneLabel","hideNext","_introAfterChangeCallback","goToStepNumber","_currentStepNumber","_this","continueStep","_introBeforeChangeCallback","onKeyDown","code","which","charCode","keyCode","exitOnEsc","target","srcElement","click","preventDefault","returnValue","cloneObject","object","nodeType","temp","jQuery","hintQuerySelectorAll","selector","hintsWrapper","hideHint","stepId","hint","removeHintTooltip","_hintCloseCallback","hideHints","hints","showHints","_this2","showHint","populateHints","removeHints","_this3","removeHint","addHints","_this4","getHintClick","evt","stopPropagation","cancelBubble","showHintDialog","item","hintAnimation","hintDot","hintPulse","alignHintPosition","hintPosition","_hintsAddedCallback","offset","iconWidth","iconHeight","hintElement","_hintClickCallback","removedStep","tooltipWrapper","closeButton","hintButtonLabel","bind","tooltip","targetElm","_this5","currentItem","push","tooltipPosition","reAlignHints","_this6","_ref2","refresh","onResize","force","continueExit","_introBeforeExitCallback","overlayLayers","overlayLayer","floatingElement","_introExitCallback","addOverlayLayer","styleText","exitOnOverlayClick","overlayOpacity","toString","introForElement","group","allIntroSteps","introItems","steps","floatingElementQuery","elmsLength","_nextStep","tempIntroItems","z","sort","a","b","keyboardNavigation","version","IntroJs","instance","Error","instances","fn","clone","setOption","option","value","setOptions","options","start","goToStep$1","addStep","addSteps","index","goToStepNumber$1","nextStep$1","previousStep$1","currentStep$1","exit","refresh$1","onbeforechange","providedCallback","onchange","onafterchange","oncomplete","onhintsadded","onhintclick","onhintclose","onexit","onskip","onbeforeexit","hideHint$1","hideHints$1","showHint$1","showHints$1","removeHints$1","removeHint$1","showHintDialog$1"],"mappings":"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","sourcesContent":["/*!\n * Intro.js v3.0.1\n * https://github.com/usablica/intro.js\n *\n * Copyright (C) 2017-2020 Afshin Mehrabani (@afshinmeh).\n * https://raw.githubusercontent.com/usablica/intro.js/master/license.md\n *\n * Date: Sat, 17 Oct 2020 10:36:20 GMT\n */\n\nconst { image } = require(\"d3\");\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.introJs = factory());\n}(this, (function () { 'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  /**\n   * Overwrites obj1's values with obj2's and adds obj2's if non existent in obj1\n   * via: http://stackoverflow.com/questions/171251/how-can-i-merge-properties-of-two-javascript-objects-dynamically\n   *\n   * @param obj1\n   * @param obj2\n   * @returns obj3 a new object based on obj1 and obj2\n   */\n  function mergeOptions(obj1, obj2) {\n    var obj3 = {};\n    var attrname;\n\n    for (attrname in obj1) {\n      obj3[attrname] = obj1[attrname];\n    }\n\n    for (attrname in obj2) {\n      obj3[attrname] = obj2[attrname];\n    }\n\n    return obj3;\n  }\n\n  /**\n   * Mark any object with an incrementing number\n   * used for keeping track of objects\n   *\n   * @param Object obj   Any object or DOM Element\n   * @param String key\n   * @return Object\n   */\n  var stamp = function () {\n    var keys = {};\n    return function stamp(obj) {\n      var key = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"introjs-stamp\";\n      // each group increments from 0\n      keys[key] = keys[key] || 0; // stamp only once per object\n\n      if (obj[key] === undefined) {\n        // increment key for each new object\n        obj[key] = keys[key]++;\n      }\n\n      return obj[key];\n    };\n  }();\n\n  /**\n   * Iterates arrays\n   *\n   * @param {Array} arr\n   * @param {Function} forEachFnc\n   * @param {Function} completeFnc\n   * @return {Null}\n   */\n  function forEach(arr, forEachFnc, completeFnc) {\n    // in case arr is an empty query selector node list\n    if (arr) {\n      for (var i = 0, len = arr.length; i < len; i++) {\n        forEachFnc(arr[i], i);\n      }\n    }\n\n    if (typeof completeFnc === \"function\") {\n      completeFnc();\n    }\n  }\n\n  /**\n   * Remove a class from an element\n   *\n   * @api private\n   * @method _removeClass\n   * @param {Object} element\n   * @param {RegExp|String} classNameRegex can be regex or string\n   * @returns null\n   */\n  function removeClass(element, classNameRegex) {\n    if (element instanceof SVGElement) {\n      var pre = element.getAttribute(\"class\") || \"\";\n      element.setAttribute(\"class\", pre.replace(classNameRegex, \"\").replace(/^\\s+|\\s+$/g, \"\"));\n    } else {\n      element.className = element.className.replace(classNameRegex, \"\").replace(/^\\s+|\\s+$/g, \"\");\n    }\n  }\n\n  /**\n   * DOMEvent Handles all DOM events\n   *\n   * methods:\n   *\n   * on - add event handler\n   * off - remove event\n   */\n\n  var DOMEvent = function () {\n    function DOMEvent() {\n      var events_key = \"introjs_event\";\n      /**\n       * Gets a unique ID for an event listener\n       *\n       * @param obj Object\n       * @param type event type\n       * @param listener Function\n       * @param context Object\n       * @return String\n       */\n\n      this._id = function (obj, type, listener, context) {\n        return type + stamp(listener) + (context ? \"_\".concat(stamp(context)) : \"\");\n      };\n      /**\n       * Adds event listener\n       *\n       * @param obj Object obj\n       * @param type String\n       * @param listener Function\n       * @param context Object\n       * @param useCapture Boolean\n       * @return null\n       */\n\n\n      this.on = function (obj, type, listener, context, useCapture) {\n        var id = this._id.apply(this, arguments);\n\n        var handler = function handler(e) {\n          return listener.call(context || obj, e || window.event);\n        };\n\n        if (\"addEventListener\" in obj) {\n          obj.addEventListener(type, handler, useCapture);\n        } else if (\"attachEvent\" in obj) {\n          obj.attachEvent(\"on\".concat(type), handler);\n        }\n\n        obj[events_key] = obj[events_key] || {};\n        obj[events_key][id] = handler;\n      };\n      /**\n       * Removes event listener\n       *\n       * @param obj Object\n       * @param type String\n       * @param listener Function\n       * @param context Object\n       * @param useCapture Boolean\n       * @return null\n       */\n\n\n      this.off = function (obj, type, listener, context, useCapture) {\n        var id = this._id.apply(this, arguments);\n\n        var handler = obj[events_key] && obj[events_key][id];\n\n        if (!handler) {\n          return;\n        }\n\n        if (\"removeEventListener\" in obj) {\n          obj.removeEventListener(type, handler, useCapture);\n        } else if (\"detachEvent\" in obj) {\n          obj.detachEvent(\"on\".concat(type), handler);\n        }\n\n        obj[events_key][id] = null;\n      };\n    }\n\n    return new DOMEvent();\n  }();\n\n  /**\n   * Append a class to an element\n   *\n   * @api private\n   * @method _addClass\n   * @param {Object} element\n   * @param {String} className\n   * @returns null\n   */\n\n  function addClass(element, className) {\n    if (element instanceof SVGElement) {\n      // svg\n      var pre = element.getAttribute(\"class\") || \"\";\n      element.setAttribute(\"class\", \"\".concat(pre, \" \").concat(className));\n    } else {\n      if (element.classList !== undefined) {\n        // check for modern classList property\n        var classes = className.split(\" \");\n        forEach(classes, function (cls) {\n          element.classList.add(cls);\n        });\n      } else if (!element.className.match(className)) {\n        // check if element doesn't already have className\n        element.className += \" \".concat(className);\n      }\n    }\n  }\n\n  /**\n   * Get an element CSS property on the page\n   * Thanks to JavaScript Kit: http://www.javascriptkit.com/dhtmltutors/dhtmlcascade4.shtml\n   *\n   * @api private\n   * @method _getPropValue\n   * @param {Object} element\n   * @param {String} propName\n   * @returns string property value\n   */\n  function getPropValue(element, propName) {\n    var propValue = \"\";\n\n    if (element.currentStyle) {\n      //IE\n      propValue = element.currentStyle[propName];\n    } else if (document.defaultView && document.defaultView.getComputedStyle) {\n      //Others\n      propValue = document.defaultView.getComputedStyle(element, null).getPropertyValue(propName);\n    } //Prevent exception in IE\n\n\n    if (propValue && propValue.toLowerCase) {\n      return propValue.toLowerCase();\n    } else {\n      return propValue;\n    }\n  }\n\n  /**\n   * To set the show element\n   * This function set a relative (in most cases) position and changes the z-index\n   *\n   * @api private\n   * @method _setShowElement\n   * @param {Object} targetElement\n   */\n\n  function setShowElement(_ref) {\n    var element = _ref.element;\n    var parentElm; // we need to add this show element class to the parent of SVG elements\n    // because the SVG elements can't have independent z-index\n\n    if (element instanceof SVGElement) {\n      parentElm = element.parentNode;\n\n      while (element.parentNode !== null) {\n        if (!parentElm.tagName || parentElm.tagName.toLowerCase() === \"body\") break;\n\n        if (parentElm.tagName.toLowerCase() === \"svg\") {\n          addClass(parentElm, \"introjs-showElement introjs-relativePosition\");\n        }\n\n        parentElm = parentElm.parentNode;\n      }\n    }\n\n    addClass(element, \"introjs-showElement\");\n    var currentElementPosition = getPropValue(element, \"position\");\n\n    if (currentElementPosition !== \"absolute\" && currentElementPosition !== \"relative\" && currentElementPosition !== \"fixed\") {\n      //change to new intro item\n      addClass(element, \"introjs-relativePosition\");\n    }\n\n    parentElm = element.parentNode;\n\n    while (parentElm !== null) {\n      if (!parentElm.tagName || parentElm.tagName.toLowerCase() === \"body\") break; //fix The Stacking Context problem.\n      //More detail: https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Understanding_z_index/The_stacking_context\n\n      var zIndex = getPropValue(parentElm, \"z-index\");\n      var opacity = parseFloat(getPropValue(parentElm, \"opacity\"));\n      var transform = getPropValue(parentElm, \"transform\") || getPropValue(parentElm, \"-webkit-transform\") || getPropValue(parentElm, \"-moz-transform\") || getPropValue(parentElm, \"-ms-transform\") || getPropValue(parentElm, \"-o-transform\");\n\n      if (/[0-9]+/.test(zIndex) || opacity < 1 || transform !== \"none\" && transform !== undefined) {\n        addClass(parentElm, \"introjs-fixParent\");\n      }\n\n      parentElm = parentElm.parentNode;\n    }\n  }\n\n  /**\n   * scroll a scrollable element to a child element\n   *\n   * @param Element parent\n   * @param Element element\n   * @return Null\n   */\n  function scrollParentToElement(parent, _ref) {\n    var offsetTop = _ref.offsetTop;\n    parent.scrollTop = offsetTop - parent.offsetTop;\n  }\n\n  /**\n   * Find the nearest scrollable parent\n   * copied from https://stackoverflow.com/questions/35939886/find-first-scrollable-parent\n   *\n   * @param Element element\n   * @return Element\n   */\n  function getScrollParent(element) {\n    var style = window.getComputedStyle(element);\n    var excludeStaticParent = style.position === \"absolute\";\n    var overflowRegex = /(auto|scroll)/;\n    if (style.position === \"fixed\") return document.body;\n\n    for (var parent = element; parent = parent.parentElement;) {\n      style = window.getComputedStyle(parent);\n\n      if (excludeStaticParent && style.position === \"static\") {\n        continue;\n      }\n\n      if (overflowRegex.test(style.overflow + style.overflowY + style.overflowX)) return parent;\n    }\n\n    return document.body;\n  }\n\n  /**\n   * Provides a cross-browser way to get the screen dimensions\n   * via: http://stackoverflow.com/questions/5864467/internet-explorer-innerheight\n   *\n   * @api private\n   * @method _getWinSize\n   * @returns {Object} width and height attributes\n   */\n  function getWinSize() {\n    if (window.innerWidth !== undefined) {\n      return {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    } else {\n      var D = document.documentElement;\n      return {\n        width: D.clientWidth,\n        height: D.clientHeight\n      };\n    }\n  }\n\n  /**\n   * Check to see if the element is in the viewport or not\n   * http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport\n   *\n   * @api private\n   * @method _elementInViewport\n   * @param {Object} el\n   */\n  function elementInViewport(el) {\n    var rect = el.getBoundingClientRect();\n    return rect.top >= 0 && rect.left >= 0 && rect.bottom + 80 <= window.innerHeight && // add 80 to get the text right\n    rect.right <= window.innerWidth;\n  }\n\n  /**\n   * To change the scroll of `window` after highlighting an element\n   *\n   * @api private\n   * @method _scrollTo\n   * @param {String} scrollTo\n   * @param {Object} targetElement\n   * @param {Object} tooltipLayer\n   */\n\n  function scrollTo(scrollTo, _ref, tooltipLayer) {\n    var element = _ref.element;\n    if (scrollTo === \"off\") return;\n    var rect;\n    if (!this._options.scrollToElement) return;\n\n    if (scrollTo === \"tooltip\") {\n      rect = tooltipLayer.getBoundingClientRect();\n    } else {\n      rect = element.getBoundingClientRect();\n    }\n\n    if (!elementInViewport(element)) {\n      var winHeight = getWinSize().height;\n      var top = rect.bottom - (rect.bottom - rect.top); // TODO (afshinm): do we need scroll padding now?\n      // I have changed the scroll option and now it scrolls the window to\n      // the center of the target element or tooltip.\n\n      if (top < 0 || element.clientHeight > winHeight) {\n        window.scrollBy(0, rect.top - (winHeight / 2 - rect.height / 2) - this._options.scrollPadding); // 30px padding from edge to look nice\n        //Scroll down\n      } else {\n        window.scrollBy(0, rect.top - (winHeight / 2 - rect.height / 2) + this._options.scrollPadding); // 30px padding from edge to look nice\n      }\n    }\n  }\n\n  /**\n   * Setting anchors to behave like buttons\n   *\n   * @api private\n   * @method _setAnchorAsButton\n   */\n  function setAnchorAsButton(anchor) {\n    anchor.setAttribute(\"role\", \"button\");\n    anchor.tabIndex = 0;\n  }\n\n  /**\n   * Get an element position on the page\n   * Thanks to `meouw`: http://stackoverflow.com/a/442474/375966\n   *\n   * @api private\n   * @method _getOffset\n   * @param {Object} element\n   * @returns Element's position info\n   */\n  function getOffset(element) {\n    var body = document.body;\n    var docEl = document.documentElement;\n    var scrollTop = window.pageYOffset || docEl.scrollTop || body.scrollTop;\n    var scrollLeft = window.pageXOffset || docEl.scrollLeft || body.scrollLeft;\n    var x = element.getBoundingClientRect();\n    return {\n      top: x.top + scrollTop,\n      width: x.width,\n      height: x.height,\n      left: x.left + scrollLeft\n    };\n  }\n\n  /**\n   * Checks to see if target element (or parents) position is fixed or not\n   *\n   * @api private\n   * @method _isFixed\n   * @param {Object} element\n   * @returns Boolean\n   */\n\n  function isFixed(element) {\n    var p = element.parentNode;\n\n    if (!p || p.nodeName === \"HTML\") {\n      return false;\n    }\n\n    if (getPropValue(element, \"position\") === \"fixed\") {\n      return true;\n    }\n\n    return isFixed(p);\n  }\n\n  /**\n   * Update the position of the helper layer on the screen\n   *\n   * @api private\n   * @method _setHelperLayerPosition\n   * @param {Object} helperLayer\n   */\n\n  function setHelperLayerPosition(helperLayer) {\n    if (helperLayer) {\n      //prevent error when `this._currentStep` in undefined\n      if (!this._introItems[this._currentStep]) return;\n      var currentElement = this._introItems[this._currentStep];\n      var elementPosition = getOffset(currentElement.element);\n      var widthHeightPadding = this._options.helperElementPadding; // If the target element is fixed, the tooltip should be fixed as well.\n      // Otherwise, remove a fixed class that may be left over from the previous\n      // step.\n\n      if (isFixed(currentElement.element)) {\n        addClass(helperLayer, \"introjs-fixedTooltip\");\n      } else {\n        removeClass(helperLayer, \"introjs-fixedTooltip\");\n      }\n\n      if (currentElement.position === \"floating\") {\n        widthHeightPadding = 0;\n      } //set new position to helper layer\n\n      helperLayer.style.cssText = \"width: \".concat(elementPosition.width + widthHeightPadding, \"px; height:\").concat(elementPosition.height + widthHeightPadding, \"px; top:\").concat(elementPosition.top - widthHeightPadding / 2, \"px;left: \").concat(elementPosition.left - widthHeightPadding / 2, \"px;\");\n    }\n  }\n\n  /**\n   * Set tooltip left so it doesn't go off the right side of the window\n   *\n   * @return boolean true, if tooltipLayerStyleLeft is ok.  false, otherwise.\n   */\n  function checkRight(targetOffset, tooltipLayerStyleLeft, tooltipOffset, windowSize, tooltipLayer) {\n    if (targetOffset.left + tooltipLayerStyleLeft + tooltipOffset.width > windowSize.width) {\n      // off the right side of the window\n      tooltipLayer.left = \"\".concat(windowSize.width - tooltipOffset.width - targetOffset.left, \"px\");\n      return false;\n    }\n\n    tooltipLayer.left = \"\".concat(tooltipLayerStyleLeft, \"px\");\n    return true;\n  }\n\n  /**\n   * Set tooltip right so it doesn't go off the left side of the window\n   *\n   * @return boolean true, if tooltipLayerStyleRight is ok.  false, otherwise.\n   */\n  function checkLeft(targetOffset, tooltipLayerStyleRight, tooltipOffset, tooltipLayer) {\n    if (targetOffset.left + targetOffset.width - tooltipLayerStyleRight - tooltipOffset.width < 0) {\n      // off the left side of the window\n      tooltipLayer.style.left = \"\".concat(-targetOffset.left, \"px\");\n      return false;\n    }\n\n    tooltipLayer.style.right = \"\".concat(tooltipLayerStyleRight, \"px\");\n    return true;\n  }\n\n  /**\n   * Remove an entry from a string array if it's there, does nothing if it isn't there.\n   *\n   * @param {Array} stringArray\n   * @param {String} stringToRemove\n   */\n  function removeEntry(stringArray, stringToRemove) {\n    if (stringArray.includes(stringToRemove)) {\n      stringArray.splice(stringArray.indexOf(stringToRemove), 1);\n    }\n  }\n\n  /**\n   * auto-determine alignment\n   * @param {Integer}  offsetLeft\n   * @param {Integer}  tooltipWidth\n   * @param {Object}   windowSize\n   * @param {String}   desiredAlignment\n   * @return {String}  calculatedAlignment\n   */\n\n  function _determineAutoAlignment(offsetLeft, tooltipWidth, _ref, desiredAlignment) {\n    var width = _ref.width;\n    var halfTooltipWidth = tooltipWidth / 2;\n    var winWidth = Math.min(width, window.screen.width);\n    var possibleAlignments = [\"-left-aligned\", \"-middle-aligned\", \"-right-aligned\"];\n    var calculatedAlignment = \"\"; // valid left must be at least a tooltipWidth\n    // away from right side\n\n    if (winWidth - offsetLeft < tooltipWidth) {\n      removeEntry(possibleAlignments, \"-left-aligned\");\n    } // valid middle must be at least half\n    // width away from both sides\n\n\n    if (offsetLeft < halfTooltipWidth || winWidth - offsetLeft < halfTooltipWidth) {\n      removeEntry(possibleAlignments, \"-middle-aligned\");\n    } // valid right must be at least a tooltipWidth\n    // width away from left side\n\n\n    if (offsetLeft < tooltipWidth) {\n      removeEntry(possibleAlignments, \"-right-aligned\");\n    }\n\n    if (possibleAlignments.length) {\n      if (possibleAlignments.includes(desiredAlignment)) {\n        // the desired alignment is valid\n        calculatedAlignment = desiredAlignment;\n      } else {\n        // pick the first valid position, in order\n        calculatedAlignment = possibleAlignments[0];\n      }\n    } else {\n      // if screen width is too small\n      // for ANY alignment, middle is\n      // probably the best for visibility\n      calculatedAlignment = \"-middle-aligned\";\n    }\n\n    return calculatedAlignment;\n  }\n  /**\n   * Determines the position of the tooltip based on the position precedence and availability\n   * of screen space.\n   *\n   * @param {Object}    targetElement\n   * @param {Object}    tooltipLayer\n   * @param {String}    desiredTooltipPosition\n   * @return {String}   calculatedPosition\n   */\n\n\n  function _determineAutoPosition(targetElement, tooltipLayer, desiredTooltipPosition) {\n    // Take a clone of position precedence. These will be the available\n    var possiblePositions = this._options.positionPrecedence.slice();\n\n    var windowSize = getWinSize();\n    var tooltipHeight = getOffset(tooltipLayer).height + 10;\n    var tooltipWidth = getOffset(tooltipLayer).width + 20;\n    var targetElementRect = targetElement.getBoundingClientRect(); // If we check all the possible areas, and there are no valid places for the tooltip, the element\n    // must take up most of the screen real estate. Show the tooltip floating in the middle of the screen.\n\n    var calculatedPosition = \"floating\";\n    /*\n     * auto determine position\n     */\n    // Check for space below\n\n    if (targetElementRect.bottom + tooltipHeight > windowSize.height) {\n      removeEntry(possiblePositions, \"bottom\");\n    } // Check for space above\n\n\n    if (targetElementRect.top - tooltipHeight < 0) {\n      removeEntry(possiblePositions, \"top\");\n    } // Check for space to the right\n\n\n    if (targetElementRect.right + tooltipWidth > windowSize.width) {\n      removeEntry(possiblePositions, \"right\");\n    } // Check for space to the left\n\n\n    if (targetElementRect.left - tooltipWidth < 0) {\n      removeEntry(possiblePositions, \"left\");\n    } // @var {String}  ex: 'right-aligned'\n\n\n    var desiredAlignment = function (pos) {\n      var hyphenIndex = pos.indexOf(\"-\");\n\n      if (hyphenIndex !== -1) {\n        // has alignment\n        return pos.substr(hyphenIndex);\n      }\n\n      return \"\";\n    }(desiredTooltipPosition || \"\"); // strip alignment from position\n\n\n    if (desiredTooltipPosition) {\n      // ex: \"bottom-right-aligned\"\n      // should return 'bottom'\n      desiredTooltipPosition = desiredTooltipPosition.split(\"-\")[0];\n    }\n\n    if (possiblePositions.length) {\n      if (desiredTooltipPosition !== \"auto\" && possiblePositions.includes(desiredTooltipPosition)) {\n        // If the requested position is in the list, choose that\n        calculatedPosition = desiredTooltipPosition;\n      } else {\n        // Pick the first valid position, in order\n        calculatedPosition = possiblePositions[0];\n      }\n    } // only top and bottom positions have optional alignments\n\n\n    if ([\"top\", \"bottom\"].includes(calculatedPosition)) {\n      calculatedPosition += _determineAutoAlignment(targetElementRect.left, tooltipWidth, windowSize, desiredAlignment);\n    }\n\n    return calculatedPosition;\n  }\n  /**\n   * Render tooltip box in the page\n   *\n   * @api private\n   * @method placeTooltip\n   * @param {HTMLElement} targetElement\n   * @param {HTMLElement} tooltipLayer\n   * @param {HTMLElement} arrowLayer\n   * @param {HTMLElement} helperNumberLayer\n   * @param {Boolean} hintMode\n   */\n\n\n  function placeTooltip(targetElement, tooltipLayer, arrowLayer, helperNumberLayer, hintMode) {\n    var tooltipCssClass = \"\";\n    var currentStepObj;\n    var tooltipOffset;\n    var targetOffset;\n    var windowSize;\n    var currentTooltipPosition;\n    hintMode = hintMode || false; //reset the old style\n\n    tooltipLayer.style.top = null;\n    tooltipLayer.style.right = null;\n    tooltipLayer.style.bottom = null;\n    tooltipLayer.style.left = null;\n    tooltipLayer.style.marginLeft = null;\n    tooltipLayer.style.marginTop = null;\n    arrowLayer.style.display = \"inherit\";\n\n    if (typeof helperNumberLayer !== \"undefined\" && helperNumberLayer !== null) {\n      helperNumberLayer.style.top = null;\n      helperNumberLayer.style.left = null;\n    } //prevent error when `this._currentStep` is undefined\n\n\n    if (!this._introItems[this._currentStep]) return; //if we have a custom css class for each step\n\n    currentStepObj = this._introItems[this._currentStep];\n\n    if (typeof currentStepObj.tooltipClass === \"string\") {\n      tooltipCssClass = currentStepObj.tooltipClass;\n    } else {\n      tooltipCssClass = this._options.tooltipClass;\n    }\n\n    tooltipLayer.className = \"introjs-tooltip \".concat(tooltipCssClass).replace(/^\\s+|\\s+$/g, \"\");\n    tooltipLayer.setAttribute(\"role\", \"dialog\");\n    currentTooltipPosition = this._introItems[this._currentStep].position; // Floating is always valid, no point in calculating\n    if (currentTooltipPosition !== \"floating\") {\n      // currentTooltipPosition = _determineAutoPosition.call(this, targetElement, tooltipLayer, currentTooltipPosition);\n    }\n\n    var tooltipLayerStyleLeft;\n    targetOffset = getOffset(targetElement);\n    tooltipOffset = getOffset(tooltipLayer);\n    windowSize = getWinSize();\n    addClass(tooltipLayer, \"introjs-\".concat(currentTooltipPosition));\n    switch (currentTooltipPosition) {\n      case \"top-right-aligned\":\n        arrowLayer.className = \"introjs-arrow bottom-right\";\n        var tooltipLayerStyleRight = 0;\n        checkLeft(targetOffset, tooltipLayerStyleRight, tooltipOffset, tooltipLayer);\n        tooltipLayer.style.bottom = \"\".concat(targetOffset.height + 20, \"px\");\n        break;\n\n      case \"top-middle-aligned\":\n        arrowLayer.className = \"introjs-arrow bottom-middle\";\n        var tooltipLayerStyleLeftRight = targetOffset.width / 2 - tooltipOffset.width / 2; // a fix for middle aligned hints\n\n        if (hintMode) {\n          tooltipLayerStyleLeftRight += 5;\n        }\n\n        if (checkLeft(targetOffset, tooltipLayerStyleLeftRight, tooltipOffset, tooltipLayer)) {\n          tooltipLayer.style.right = null;\n          checkRight(targetOffset, tooltipLayerStyleLeftRight, tooltipOffset, windowSize, tooltipLayer);\n        }\n\n        tooltipLayer.style.bottom = \"\".concat(targetOffset.height + 20, \"px\");\n        break;\n\n      case \"top-left-aligned\": // top-left-aligned is the same as the default top\n\n      case \"top\":\n        arrowLayer.className = \"introjs-arrow bottom\";\n        tooltipLayerStyleLeft = hintMode ? 0 : 15;\n        checkRight(targetOffset, tooltipLayerStyleLeft, tooltipOffset, windowSize, tooltipLayer);\n        tooltipLayer.style.bottom = \"\".concat(targetOffset.height + 20, \"px\");\n        break;\n\n      case \"right\":\n        tooltipLayer.style.left = \"\".concat(targetOffset.width + 20 + 63, \"px\");\n        var imageLayer = document.createElement(\"img\");\n        imageLayer.src= \"/img/Group3.svg\";\n        var parent_div_for_image = document.getElementById(\"custom-arrow-image-cense\");\n        if (targetOffset.top + tooltipOffset.height > windowSize.height) {\n          // In this case, right would have fallen below the bottom of the screen.\n          // Modify so that the bottom of the tooltip connects with the target\n          // arrowLayer.appendChild(imageLayer);\n          // parent_div_for_image.appendChild(imageLayer);\n          parent_div_for_image.style.position = \"relative\";\n          parent_div_for_image.style.left = \"-67px\";\n          parent_div_for_image.style.top = \"\".concat(targetOffset.height - 10, \"px\");\n          arrowLayer.className = \"introjs-arrow left-bottom\";\n          tooltipLayer.style.top = \"-\".concat(tooltipOffset.height - targetOffset.height - 20, \"px\");\n        } else {\n          // arrowLayer.appendChild(imageLayer);\n          // parent_div_for_image.appendChild(imageLayer);\n          parent_div_for_image.style.position = \"relative\";\n          parent_div_for_image.style.left = \"-67px\";\n          parent_div_for_image.style.top = \"\".concat(targetOffset.height - 10, \"px\");\n          // arrowLayer.className = \"introjs-arrow left\";\n          arrowLayer.className = \"introjs-arrow left-bottom\";\n          tooltipLayer.style.top = \"-\".concat(tooltipOffset.height - targetOffset.height - 20, \"px\");\n        }\n\n        break;\n\n      case \"left\":\n        if (!hintMode && this._options.showStepNumbers === true) {\n          tooltipLayer.style.top = \"15px\";\n        }\n\n        if (targetOffset.top + tooltipOffset.height > windowSize.height) {\n          // In this case, left would have fallen below the bottom of the screen.\n          // Modify so that the bottom of the tooltip connects with the target\n          tooltipLayer.style.top = \"-\".concat(tooltipOffset.height - targetOffset.height - 20, \"px\");\n          arrowLayer.className = \"introjs-arrow right-bottom\";\n        } else {\n          arrowLayer.className = \"introjs-arrow right\";\n        }\n\n        tooltipLayer.style.right = \"\".concat(targetOffset.width + 20, \"px\");\n        break;\n\n      case \"floating\":\n        arrowLayer.style.display = \"none\"; //we have to adjust the top and left of layer manually for intro items without element\n\n        tooltipLayer.style.left = \"50%\";\n        tooltipLayer.style.top = \"50%\";\n        tooltipLayer.style.marginLeft = \"-\".concat(tooltipOffset.width / 2, \"px\");\n        tooltipLayer.style.marginTop = \"-\".concat(tooltipOffset.height / 2, \"px\");\n\n        if (typeof helperNumberLayer !== \"undefined\" && helperNumberLayer !== null) {\n          helperNumberLayer.style.left = \"-\".concat(tooltipOffset.width / 2 + 18, \"px\");\n          helperNumberLayer.style.top = \"-\".concat(tooltipOffset.height / 2 + 18, \"px\");\n        }\n\n        break;\n\n      case \"bottom-right-aligned\":\n        arrowLayer.className = \"introjs-arrow top-right\";\n        tooltipLayerStyleRight = 0;\n        checkLeft(targetOffset, tooltipLayerStyleRight, tooltipOffset, tooltipLayer);\n        tooltipLayer.style.top = \"\".concat(targetOffset.height + 20, \"px\");\n        break;\n\n      case \"bottom-middle-aligned\":\n        arrowLayer.className = \"introjs-arrow top-middle\";\n        tooltipLayerStyleLeftRight = targetOffset.width / 2 - tooltipOffset.width / 2; // a fix for middle aligned hints\n\n        if (hintMode) {\n          tooltipLayerStyleLeftRight += 5;\n        }\n\n        if (checkLeft(targetOffset, tooltipLayerStyleLeftRight, tooltipOffset, tooltipLayer)) {\n          tooltipLayer.style.right = null;\n          checkRight(targetOffset, tooltipLayerStyleLeftRight, tooltipOffset, windowSize, tooltipLayer);\n        }\n        var get_left_offset  = Math.max(\n          document.documentElement.clientWidth\n        );\n\n        var get_top_offset = document.documentElement.clientHeight;\n\n        // tooltipLayer.style.top = \"\".concat(targetOffset.height + 20, \"px\");\n        tooltipLayer.style.top = \"\".concat((get_top_offset / 2.3), \"px\");\n        tooltipLayer.style.left = \"\".concat((get_left_offset / 2.5), \"px\");\n        break;\n      // case 'bottom-left-aligned':\n      // Bottom-left-aligned is the same as the default bottom\n      // case 'bottom':\n      // Bottom going to follow the default behavior\n\n      default:\n        arrowLayer.className = \"introjs-arrow top\";\n        tooltipLayerStyleLeft = 0;\n        checkRight(targetOffset, tooltipLayerStyleLeft, tooltipOffset, windowSize, tooltipLayer);\n        tooltipLayer.style.top = \"\".concat(targetOffset.height + 20, \"px\");\n    }\n  }\n\n  /**\n   * To remove all show element(s)\n   *\n   * @api private\n   * @method _removeShowElement\n   */\n\n  function removeShowElement() {\n    var elms = document.querySelectorAll(\".introjs-showElement\");\n    forEach(elms, function (elm) {\n      removeClass(elm, /introjs-[a-zA-Z]+/g);\n    });\n  }\n\n  /**\n   * Gets the current progress percentage\n   *\n   * @api private\n   * @method _getProgress\n   * @returns current progress percentage\n   */\n\n  function _getProgress() {\n    // Steps are 0 indexed\n    var currentStep = parseInt(this._currentStep + 1, 10);\n    return currentStep / this._introItems.length * 100;\n  }\n  /**\n   * Add disableinteraction layer and adjust the size and position of the layer\n   *\n   * @api private\n   * @method _disableInteraction\n   */\n\n\n  function _disableInteraction() {\n    var disableInteractionLayer = document.querySelector(\".introjs-disableInteraction\");\n\n    if (disableInteractionLayer === null) {\n      disableInteractionLayer = document.createElement(\"div\");\n      disableInteractionLayer.className = \"introjs-disableInteraction\";\n\n      this._targetElement.appendChild(disableInteractionLayer);\n    }\n\n    setHelperLayerPosition.call(this, disableInteractionLayer);\n  }\n  /**\n   * Show an element on the page\n   *\n   * @api private\n   * @method _showElement\n   * @param {Object} targetElement\n   */\n\n\n  function _showElement(targetElement) {\n    if (typeof this._introChangeCallback !== \"undefined\") {\n      this._introChangeCallback.call(this, targetElement.element);\n    }\n\n    var self = this;\n    var oldHelperLayer = document.querySelector(\".introjs-helperLayer\");\n    var oldReferenceLayer = document.querySelector(\".introjs-tooltipReferenceLayer\");\n    var highlightClass = \"introjs-helperLayer\";\n    var nextTooltipButton;\n    var prevTooltipButton;\n    var skipTooltipButton;\n    var scrollParent; //check for a current step highlight class\n\n    if (typeof targetElement.highlightClass === \"string\") {\n      highlightClass += \" \".concat(targetElement.highlightClass);\n    } //check for options highlight class\n\n\n    if (typeof this._options.highlightClass === \"string\") {\n      highlightClass += \" \".concat(this._options.highlightClass);\n    }\n\n    if (oldHelperLayer !== null) {\n      var oldHelperNumberLayer = oldReferenceLayer.querySelector(\".introjs-helperNumberLayer\");\n      var oldtooltipLayer = oldReferenceLayer.querySelector(\".introjs-tooltiptext\");\n      var oldArrowLayer = oldReferenceLayer.querySelector(\".introjs-arrow\");\n      var oldtooltipContainer = oldReferenceLayer.querySelector(\".introjs-tooltip\");\n      skipTooltipButton = oldReferenceLayer.querySelector(\".introjs-skipbutton\");\n      prevTooltipButton = oldReferenceLayer.querySelector(\".introjs-prevbutton\");\n      nextTooltipButton = oldReferenceLayer.querySelector(\".introjs-nextbutton\"); //update or reset the helper highlight class\n\n      oldHelperLayer.className = highlightClass; //hide the tooltip\n      if (document.contains(document.getElementById(\"label_display_div\"))) {\n        document.getElementById(\"label_display_div\").remove();\n      } \n      if(targetElement.labelDisplay !== \"WELCOME\"){\n        document.getElementById(\"custom-arrow-image-cense\").style.display = \"block\";\n        document.getElementById(\"custom-arrow-image-cense\").style.opacity = 1;\n      } else {\n        document.getElementById(\"custom-arrow-image-cense\").style.opacity = 0;\n      }\n      var label_display_div = document.createElement(\"div\");\n      label_display_div.id = \"label_display_div\";\n      label_display_div.style.color = \"#FFFFFF\";\n      label_display_div.style.textAlign = \"center\";\n      label_display_div.style.marginTop = \"0.5rem\";\n      label_display_div.innerHTML = targetElement.labelDisplay;\n      oldHelperLayer.appendChild(label_display_div);\n\n      // oldHelperLayer.innerHTML = targetElement.labelDisplay;\n      oldtooltipContainer.style.opacity = 0;\n      oldtooltipContainer.style.display = \"none\";\n\n      if (oldHelperNumberLayer !== null) {\n        var lastIntroItem = this._introItems[targetElement.step - 2 >= 0 ? targetElement.step - 2 : 0];\n\n        if (lastIntroItem !== null && this._direction === \"forward\" && lastIntroItem.position === \"floating\" || this._direction === \"backward\" && targetElement.position === \"floating\") {\n          oldHelperNumberLayer.style.opacity = 0;\n        }\n      } // scroll to element\n\n\n      scrollParent = getScrollParent(targetElement.element);\n\n      if (scrollParent !== document.body) {\n        // target is within a scrollable element\n        scrollParentToElement(scrollParent, targetElement.element);\n      } // set new position to helper layer\n\n\n      setHelperLayerPosition.call(self, oldHelperLayer);\n      setHelperLayerPosition.call(self, oldReferenceLayer); //remove `introjs-fixParent` class from the elements\n\n      var fixParents = document.querySelectorAll(\".introjs-fixParent\");\n      forEach(fixParents, function (parent) {\n        removeClass(parent, /introjs-fixParent/g);\n      }); //remove old classes if the element still exist\n\n      removeShowElement(); //we should wait until the CSS3 transition is competed (it's 0.3 sec) to prevent incorrect `height` and `width` calculation\n\n      if (self._lastShowElementTimer) {\n        window.clearTimeout(self._lastShowElementTimer);\n      }\n\n      self._lastShowElementTimer = window.setTimeout(function () {\n        //set current step to the label\n        if (oldHelperNumberLayer !== null) {\n          oldHelperNumberLayer.innerHTML = targetElement.step;\n        } //set current tooltip text\n\n        var tooltipHeader = document.createElement(\"h5\");\n        tooltipHeader.style.color = \"#283877\";\n        tooltipHeader.style.fontFamily = \"rubik\";\n        tooltipHeader.innerHTML = targetElement.labelDisplay;\n        var tooltipBody = document.createElement(\"div\");\n        tooltipBody.innerHTML = targetElement.intro;\n        oldtooltipLayer.innerHTML = \"\";\n        oldtooltipLayer.style.maxWidth = \"\";\n        oldtooltipLayer.style.minWidth = \"460px\";\n        // tooltipTextLayer.style.maxWidth = \"300px\";\n        // oldtooltipLayer.innerHTML = targetElement.intro; //set the tooltip position\n        oldtooltipLayer.appendChild(tooltipHeader);\n        oldtooltipLayer.appendChild(tooltipBody);\n        oldtooltipLayer.style.marginBottom = \"-1.52rem\";\n        oldtooltipContainer.style.display = \"block\";\n        oldtooltipLayer.style.paddingLeft= \"1rem\";  \n        // oldtooltipContainer.style.cssText = \"max-width: 700px !important\"; \n        placeTooltip.call(self, targetElement.element, oldtooltipContainer, oldArrowLayer, oldHelperNumberLayer); //change active bullet\n\n        if (self._options.showBullets) {\n          oldReferenceLayer.querySelector(\".introjs-bullets li > a.active\").className = \"\";\n          oldReferenceLayer.querySelector(\".introjs-bullets li > a[data-stepnumber=\\\"\".concat(targetElement.step, \"\\\"]\")).className = \"active\";\n        }\n\n        // oldReferenceLayer.querySelector(\".introjs-progress .introjs-progressbar\").style.cssText = \"width:\".concat(_getProgress.call(self), \"%;\");\n        // oldReferenceLayer.querySelector(\".introjs-progress .introjs-progressbar\").setAttribute(\"aria-valuenow\", _getProgress.call(self)); //show the tooltip\n\n        oldtooltipContainer.style.opacity = 1;\n        if (oldHelperNumberLayer) oldHelperNumberLayer.style.opacity = 1; //reset button focus\n\n        if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null && /introjs-donebutton/gi.test(skipTooltipButton.className)) {\n          // skip button is now \"done\" button\n          skipTooltipButton.focus();\n        } else if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n          //still in the tour, focus on next\n          nextTooltipButton.focus();\n        } // change the scroll of the window, if needed\n\n\n        scrollTo.call(self, targetElement.scrollTo, targetElement, oldtooltipLayer);\n      }, 350); // end of old element if-else condition\n    } else {\n      var helperLayer = document.createElement(\"div\");\n      var referenceLayer = document.createElement(\"div\");\n      var arrowLayer = document.createElement(\"div\");\n      var tooltipLayer = document.createElement(\"div\");\n      var tooltipTextLayer = document.createElement(\"div\");\n      var bulletsLayer = document.createElement(\"div\");\n      var progressLayer = document.createElement(\"div\");\n      var buttonsLayer = document.createElement(\"div\");\n      var imageLayer = document.createElement(\"img\");\n      imageLayer.src= \"/img/Group3.svg\";\n      imageLayer.id = \"custom-arrow-image-cense\";\n      imageLayer.style.display = \"none\";\n      helperLayer.className = highlightClass;\n      referenceLayer.className = \"introjs-tooltipReferenceLayer\"; // scroll to element\n\n      scrollParent = getScrollParent(targetElement.element);\n\n      if (scrollParent !== document.body) {\n        // target is within a scrollable element\n        scrollParentToElement(scrollParent, targetElement.element);\n      } //set new position to helper layer\n\n\n      setHelperLayerPosition.call(self, helperLayer);\n      setHelperLayerPosition.call(self, referenceLayer); //add helper layer to target element\n\n      this._targetElement.appendChild(helperLayer);\n      // this._targetElement.appendChild(imageLayer);\n\n      this._targetElement.appendChild(referenceLayer);\n\n      arrowLayer.className = \"introjs-arrow\";\n      tooltipTextLayer.className = \"introjs-tooltiptext\";\n      var tooltipHeader = document.createElement(\"h5\");\n      tooltipHeader.style.color = \"#283877\";\n      tooltipHeader.innerHTML = \"WELCOME\";\n      var tooltipBody = document.createElement(\"div\");\n      tooltipBody.innerHTML = targetElement.intro;\n      tooltipTextLayer.innerHTML = \"\";\n      tooltipTextLayer.style.minWidth = \"500px\";\n      tooltipTextLayer.style.maxWidth = \"300px\";\n      tooltipTextLayer.appendChild(tooltipHeader);\n      tooltipTextLayer.appendChild(tooltipBody);\n      tooltipTextLayer.style.marginBottom = \"0\";\n      // tooltipTextLayer.innerHTML = targetElement.intro;\n      // var label_display_div = document.createElement(\"div\");\n      // label_display_div.id = \"label_display_div\";\n      // label_display_div.style.color = \"#FFFFFF\";\n      // label_display_div.style.textAlign = \"center\";\n      // label_display_div.style.marginTop = \"0.5rem\";\n      // label_display_div.innerHTML = targetElement.labelDisplay;\n      // helperLayer.appendChild(label_display_div);\n      // helperLayer.innerHTML = targetElement.labelDisplay;\n      bulletsLayer.className = \"introjs-bullets\";\n\n      if (this._options.showBullets === false) {\n        bulletsLayer.style.display = \"none\";\n      }\n\n      var ulContainer = document.createElement(\"ul\");\n      ulContainer.setAttribute(\"role\", \"tablist\");\n\n      var anchorClick = function anchorClick() {\n        self.goToStep(this.getAttribute(\"data-stepnumber\"));\n      };\n\n      forEach(this._introItems, function (_ref, i) {\n        var step = _ref.step;\n        var innerLi = document.createElement(\"li\");\n        var anchorLink = document.createElement(\"a\");\n        innerLi.setAttribute(\"role\", \"presentation\");\n        anchorLink.setAttribute(\"role\", \"tab\");\n        anchorLink.onclick = anchorClick;\n\n        if (i === targetElement.step - 1) {\n          anchorLink.className = \"active\";\n        }\n\n        setAnchorAsButton(anchorLink);\n        anchorLink.innerHTML = \"&nbsp;\";\n        anchorLink.setAttribute(\"data-stepnumber\", step);\n        innerLi.appendChild(anchorLink);\n        ulContainer.appendChild(innerLi);\n      });\n      bulletsLayer.appendChild(ulContainer);\n      progressLayer.className = \"introjs-progress\";\n\n      if (this._options.showProgress === false) {\n        progressLayer.style.display = \"none\";\n      }\n\n      var progressBar = document.createElement(\"div\");\n      progressBar.className = \"introjs-progressbar\";\n      progressBar.setAttribute(\"role\", \"progress\");\n      progressBar.setAttribute(\"aria-valuemin\", 0);\n      progressBar.setAttribute(\"aria-valuemax\", 100);\n      progressBar.setAttribute(\"aria-valuenow\", _getProgress.call(this));\n      progressBar.style.cssText = \"width:\".concat(_getProgress.call(this), \"%;\");\n      progressLayer.appendChild(progressBar);\n      buttonsLayer.className = \"introjs-tooltipbuttons\";\n\n      if (this._options.showButtons === false) {\n        buttonsLayer.style.display = \"none\";\n      }\n\n      tooltipLayer.className = \"introjs-tooltip\";\n      // tooltipLayer.style.cssText = \"max-width: 300px !important\"; \n      tooltipLayer.appendChild(tooltipTextLayer);\n      tooltipLayer.appendChild(imageLayer);\n      // tooltipLayer.appendChild(bulletsLayer);\n      // tooltipLayer.appendChild(progressLayer); //add helper layer number\n\n      var helperNumberLayer = document.createElement(\"span\");\n\n      if (this._options.showStepNumbers === true) {\n        helperNumberLayer.className = \"introjs-helperNumberLayer\";\n        helperNumberLayer.innerHTML = targetElement.step;\n        referenceLayer.appendChild(helperNumberLayer);\n      }\n\n      tooltipLayer.appendChild(arrowLayer);\n      referenceLayer.appendChild(tooltipLayer); //next button\n\n      nextTooltipButton = document.createElement(\"a\");\n\n      nextTooltipButton.onclick = function () {\n        if (self._introItems.length - 1 !== self._currentStep) {\n          nextStep.call(self);\n        }\n      };\n\n      setAnchorAsButton(nextTooltipButton);\n      nextTooltipButton.innerHTML = this._options.nextLabel; //previous button\n\n      prevTooltipButton = document.createElement(\"a\");\n      prevTooltipButton.style.display = \"none\";\n      prevTooltipButton.onclick = function () {\n        if (self._currentStep !== 0) {\n          previousStep.call(self);\n        }\n      };\n\n      setAnchorAsButton(prevTooltipButton);\n      prevTooltipButton.innerHTML = this._options.prevLabel; //skip button\n\n      skipTooltipButton = document.createElement(\"a\");\n      skipTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-skipbutton \");\n      setAnchorAsButton(skipTooltipButton);\n      skipTooltipButton.innerHTML = this._options.skipLabel;\n\n      skipTooltipButton.onclick = function () {\n        if (self._introItems.length - 1 === self._currentStep && typeof self._introCompleteCallback === \"function\") {\n          self._introCompleteCallback.call(self);\n        }\n\n        if (typeof self._introSkipCallback === \"function\") {\n          self._introSkipCallback.call(self);\n        }\n\n        exitIntro.call(self, self._targetElement);\n      };\n\n      buttonsLayer.appendChild(skipTooltipButton); //in order to prevent displaying next/previous button always\n\n      if (this._introItems.length > 1) {\n        buttonsLayer.appendChild(prevTooltipButton);\n        buttonsLayer.appendChild(nextTooltipButton);\n      }\n\n      tooltipLayer.appendChild(buttonsLayer); //set proper position\n\n      placeTooltip.call(self, targetElement.element, tooltipLayer, arrowLayer, helperNumberLayer); // change the scroll of the window, if needed\n\n      scrollTo.call(this, targetElement.scrollTo, targetElement, tooltipLayer); //end of new element if-else condition\n    } // removing previous disable interaction layer\n\n\n    var disableInteractionLayer = self._targetElement.querySelector(\".introjs-disableInteraction\");\n\n    if (disableInteractionLayer) {\n      disableInteractionLayer.parentNode.removeChild(disableInteractionLayer);\n    } //disable interaction\n\n\n    if (targetElement.disableInteraction) {\n      _disableInteraction.call(self);\n    } // when it's the first step of tour\n\n\n    if (this._currentStep === 0 && this._introItems.length > 1) {\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-skipbutton\");\n        skipTooltipButton.style.display=\"none\";\n      }\n\n      if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n        nextTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-nextbutton\");\n      }\n\n      if (this._options.hidePrev === true) {\n        if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n          prevTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-prevbutton introjs-hidden\");\n        }\n\n        if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n          addClass(nextTooltipButton, \"introjs-fullbutton\");\n        }\n      } else {\n        if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n          prevTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-prevbutton introjs-disabled\");\n        }\n      }\n\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.innerHTML = this._options.skipLabel;\n      }\n    } else if (this._introItems.length - 1 === this._currentStep || this._introItems.length === 1) {\n      // last step of tour\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.innerHTML = this._options.doneLabel; // adding donebutton class in addition to skipbutton\n        skipTooltipButton.style.display=\"inline-block\";\n\n        addClass(skipTooltipButton, \"introjs-donebutton\");\n      }\n\n      if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n        prevTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-prevbutton\");\n      }\n\n      if (this._options.hideNext === true) {\n        if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n          nextTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-nextbutton introjs-hidden\");\n        }\n\n        if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n          addClass(prevTooltipButton, \"introjs-fullbutton\");\n        }\n      } else {\n        if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n          nextTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-nextbutton introjs-disabled\");\n        }\n      }\n    } else {\n      // steps between start and end\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.style.display=\"none\";\n        skipTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-skipbutton\");\n      }\n\n      if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n        prevTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-prevbutton\");\n      }\n\n      if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n        nextTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-nextbutton\");\n      }\n\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.innerHTML = this._options.skipLabel;\n      }\n    }\n\n    if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n      prevTooltipButton.setAttribute(\"role\", \"button\");\n    }\n\n    if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n      nextTooltipButton.setAttribute(\"role\", \"button\");\n    }\n\n    if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n      skipTooltipButton.setAttribute(\"role\", \"button\");\n    } //Set focus on \"next\" button, so that hitting Enter always moves you onto the next step\n\n\n    if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n      nextTooltipButton.focus();\n    }\n\n    setShowElement(targetElement);\n\n    if (typeof this._introAfterChangeCallback !== \"undefined\") {\n      this._introAfterChangeCallback.call(this, targetElement.element);\n    }\n  }\n\n  /**\n   * Go to specific step of introduction\n   *\n   * @api private\n   * @method _goToStep\n   */\n\n  function goToStep(step) {\n    //because steps starts with zero\n    this._currentStep = step - 2;\n\n    if (typeof this._introItems !== \"undefined\") {\n      nextStep.call(this);\n    }\n  }\n  /**\n   * Go to the specific step of introduction with the explicit [data-step] number\n   *\n   * @api private\n   * @method _goToStepNumber\n   */\n\n  function goToStepNumber(step) {\n    this._currentStepNumber = step;\n\n    if (typeof this._introItems !== \"undefined\") {\n      nextStep.call(this);\n    }\n  }\n  /**\n   * Go to next step on intro\n   *\n   * @api private\n   * @method _nextStep\n   */\n\n  function nextStep() {\n    var _this = this;\n\n    this._direction = \"forward\";\n\n    if (typeof this._currentStepNumber !== \"undefined\") {\n      forEach(this._introItems, function (_ref, i) {\n        var step = _ref.step;\n\n        if (step === _this._currentStepNumber) {\n          _this._currentStep = i - 1;\n          _this._currentStepNumber = undefined;\n        }\n      });\n    }\n\n    if (typeof this._currentStep === \"undefined\") {\n      this._currentStep = 0;\n    } else {\n      ++this._currentStep;\n    }\n\n    var nextStep = this._introItems[this._currentStep];\n    var continueStep = true;\n\n    if (typeof this._introBeforeChangeCallback !== \"undefined\") {\n      continueStep = this._introBeforeChangeCallback.call(this, nextStep.element);\n    } // if `onbeforechange` returned `false`, stop displaying the element\n\n\n    if (continueStep === false) {\n      --this._currentStep;\n      return false;\n    }\n\n    if (this._introItems.length <= this._currentStep) {\n      //end of the intro\n      //check if any callback is defined\n      if (typeof this._introCompleteCallback === \"function\") {\n        this._introCompleteCallback.call(this);\n      }\n\n      exitIntro.call(this, this._targetElement);\n      return;\n    }\n\n    _showElement.call(this, nextStep);\n  }\n  /**\n   * Go to previous step on intro\n   *\n   * @api private\n   * @method _previousStep\n   */\n\n  function previousStep() {\n    this._direction = \"backward\";\n\n    if (this._currentStep === 0) {\n      return false;\n    }\n\n    --this._currentStep;\n    var nextStep = this._introItems[this._currentStep];\n    var continueStep = true;\n\n    if (typeof this._introBeforeChangeCallback !== \"undefined\") {\n      continueStep = this._introBeforeChangeCallback.call(this, nextStep.element);\n    } // if `onbeforechange` returned `false`, stop displaying the element\n\n\n    if (continueStep === false) {\n      ++this._currentStep;\n      return false;\n    }\n\n    _showElement.call(this, nextStep);\n  }\n  /**\n   * Returns the current step of the intro\n   *\n   * @returns {boolean}\n   */\n\n  function currentStep() {\n    return this._currentStep;\n  }\n\n  /**\n   * on keyCode:\n   * https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode\n   * This feature has been removed from the Web standards.\n   * Though some browsers may still support it, it is in\n   * the process of being dropped.\n   * Instead, you should use KeyboardEvent.code,\n   * if it's implemented.\n   *\n   * jQuery's approach is to test for\n   *   (1) e.which, then\n   *   (2) e.charCode, then\n   *   (3) e.keyCode\n   * https://github.com/jquery/jquery/blob/a6b0705294d336ae2f63f7276de0da1195495363/src/event.js#L638\n   *\n   * @param type var\n   * @return type\n   */\n\n  function onKeyDown(e) {\n    var code = e.code === null ? e.which : e.code; // if code/e.which is null\n\n    if (code === null) {\n      code = e.charCode === null ? e.keyCode : e.charCode;\n    }\n\n    if ((code === \"Escape\" || code === 27) && this._options.exitOnEsc === true) {\n      //escape key pressed, exit the intro\n      //check if exit callback is defined\n      exitIntro.call(this, this._targetElement);\n    } else if (code === \"ArrowLeft\" || code === 37) {\n      //left arrow\n      previousStep.call(this);\n    } else if (code === \"ArrowRight\" || code === 39) {\n      //right arrow\n      nextStep.call(this);\n    } else if (code === \"Enter\" || code === 13) {\n      //srcElement === ie\n      var target = e.target || e.srcElement;\n\n      if (target && target.className.match(\"introjs-prevbutton\")) {\n        //user hit enter while focusing on previous button\n        previousStep.call(this);\n      } else if (target && target.className.match(\"introjs-skipbutton\")) {\n        //user hit enter while focusing on skip button\n        if (this._introItems.length - 1 === this._currentStep && typeof this._introCompleteCallback === \"function\") {\n          this._introCompleteCallback.call(this);\n        }\n\n        exitIntro.call(this, this._targetElement);\n      } else if (target && target.getAttribute(\"data-stepnumber\")) {\n        // user hit enter while focusing on step bullet\n        target.click();\n      } else {\n        //default behavior for responding to enter\n        nextStep.call(this);\n      } //prevent default behaviour on hitting Enter, to prevent steps being skipped in some browsers\n\n\n      if (e.preventDefault) {\n        e.preventDefault();\n      } else {\n        e.returnValue = false;\n      }\n    }\n  }\n\n  /*\n   * makes a copy of the object\n   * @api private\n   * @method _cloneObject\n   */\n  function cloneObject(object) {\n    if (object === null || _typeof(object) !== \"object\" || typeof object.nodeType !== \"undefined\") {\n      return object;\n    }\n\n    var temp = {};\n\n    for (var key in object) {\n      if (typeof window.jQuery !== \"undefined\" && object[key] instanceof window.jQuery) {\n        temp[key] = object[key];\n      } else {\n        temp[key] = cloneObject(object[key]);\n      }\n    }\n\n    return temp;\n  }\n\n  /**\n   * Get a queryselector within the hint wrapper\n   *\n   * @param {String} selector\n   * @return {NodeList|Array}\n   */\n\n  function hintQuerySelectorAll(selector) {\n    var hintsWrapper = document.querySelector(\".introjs-hints\");\n    return hintsWrapper ? hintsWrapper.querySelectorAll(selector) : [];\n  }\n  /**\n   * Hide a hint\n   *\n   * @api private\n   * @method hideHint\n   */\n\n  function hideHint(stepId) {\n    var hint = hintQuerySelectorAll(\".introjs-hint[data-step=\\\"\".concat(stepId, \"\\\"]\"))[0];\n    removeHintTooltip.call(this);\n\n    if (hint) {\n      addClass(hint, \"introjs-hidehint\");\n    } // call the callback function (if any)\n\n\n    if (typeof this._hintCloseCallback !== \"undefined\") {\n      this._hintCloseCallback.call(this, stepId);\n    }\n  }\n  /**\n   * Hide all hints\n   *\n   * @api private\n   * @method hideHints\n   */\n\n  function hideHints() {\n    var _this = this;\n\n    var hints = hintQuerySelectorAll(\".introjs-hint\");\n    forEach(hints, function (hint) {\n      hideHint.call(_this, hint.getAttribute(\"data-step\"));\n    });\n  }\n  /**\n   * Show all hints\n   *\n   * @api private\n   * @method _showHints\n   */\n\n  function showHints() {\n    var _this2 = this;\n\n    var hints = hintQuerySelectorAll(\".introjs-hint\");\n\n    if (hints && hints.length) {\n      forEach(hints, function (hint) {\n        showHint.call(_this2, hint.getAttribute(\"data-step\"));\n      });\n    } else {\n      populateHints.call(this, this._targetElement);\n    }\n  }\n  /**\n   * Show a hint\n   *\n   * @api private\n   * @method showHint\n   */\n\n  function showHint(stepId) {\n    var hint = hintQuerySelectorAll(\".introjs-hint[data-step=\\\"\".concat(stepId, \"\\\"]\"))[0];\n\n    if (hint) {\n      removeClass(hint, /introjs-hidehint/g);\n    }\n  }\n  /**\n   * Removes all hint elements on the page\n   * Useful when you want to destroy the elements and add them again (e.g. a modal or popup)\n   *\n   * @api private\n   * @method removeHints\n   */\n\n  function removeHints() {\n    var _this3 = this;\n\n    var hints = hintQuerySelectorAll(\".introjs-hint\");\n    forEach(hints, function (hint) {\n      removeHint.call(_this3, hint.getAttribute(\"data-step\"));\n    });\n  }\n  /**\n   * Remove one single hint element from the page\n   * Useful when you want to destroy the element and add them again (e.g. a modal or popup)\n   * Use removeHints if you want to remove all elements.\n   *\n   * @api private\n   * @method removeHint\n   */\n\n  function removeHint(stepId) {\n    var hint = hintQuerySelectorAll(\".introjs-hint[data-step=\\\"\".concat(stepId, \"\\\"]\"))[0];\n\n    if (hint) {\n      hint.parentNode.removeChild(hint);\n    }\n  }\n  /**\n   * Add all available hints to the page\n   *\n   * @api private\n   * @method addHints\n   */\n\n  function addHints() {\n    var _this4 = this;\n\n    var self = this;\n    var hintsWrapper = document.querySelector(\".introjs-hints\");\n\n    if (hintsWrapper === null) {\n      hintsWrapper = document.createElement(\"div\");\n      hintsWrapper.className = \"introjs-hints\";\n    }\n    /**\n     * Returns an event handler unique to the hint iteration\n     *\n     * @param {Integer} i\n     * @return {Function}\n     */\n\n\n    var getHintClick = function getHintClick(i) {\n      return function (e) {\n        var evt = e ? e : window.event;\n\n        if (evt.stopPropagation) {\n          evt.stopPropagation();\n        }\n\n        if (evt.cancelBubble !== null) {\n          evt.cancelBubble = true;\n        }\n\n        showHintDialog.call(self, i);\n      };\n    };\n\n    forEach(this._introItems, function (item, i) {\n      // avoid append a hint twice\n      if (document.querySelector(\".introjs-hint[data-step=\\\"\".concat(i, \"\\\"]\"))) {\n        return;\n      }\n\n      var hint = document.createElement(\"a\");\n      setAnchorAsButton(hint);\n      hint.onclick = getHintClick(i);\n      hint.className = \"introjs-hint\";\n\n      if (!item.hintAnimation) {\n        addClass(hint, \"introjs-hint-no-anim\");\n      } // hint's position should be fixed if the target element's position is fixed\n\n\n      if (isFixed(item.element)) {\n        addClass(hint, \"introjs-fixedhint\");\n      }\n\n      var hintDot = document.createElement(\"div\");\n      hintDot.className = \"introjs-hint-dot\";\n      var hintPulse = document.createElement(\"div\");\n      hintPulse.className = \"introjs-hint-pulse\";\n      hint.appendChild(hintDot);\n      hint.appendChild(hintPulse);\n      hint.setAttribute(\"data-step\", i); // we swap the hint element with target element\n      // because _setHelperLayerPosition uses `element` property\n\n      item.targetElement = item.element;\n      item.element = hint; // align the hint position\n\n      alignHintPosition.call(_this4, item.hintPosition, hint, item.targetElement);\n      hintsWrapper.appendChild(hint);\n    }); // adding the hints wrapper\n\n    document.body.appendChild(hintsWrapper); // call the callback function (if any)\n\n    if (typeof this._hintsAddedCallback !== \"undefined\") {\n      this._hintsAddedCallback.call(this);\n    }\n  }\n  /**\n   * Aligns hint position\n   *\n   * @api private\n   * @method alignHintPosition\n   * @param {String} position\n   * @param {Object} hint\n   * @param {Object} element\n   */\n\n  function alignHintPosition(position, _ref, element) {\n    var style = _ref.style;\n    // get/calculate offset of target element\n    var offset = getOffset.call(this, element);\n    var iconWidth = 20;\n    var iconHeight = 20; // align the hint element\n\n    switch (position) {\n      default:\n      case \"top-left\":\n        style.left = \"\".concat(offset.left, \"px\");\n        style.top = \"\".concat(offset.top, \"px\");\n        break;\n\n      case \"top-right\":\n        style.left = \"\".concat(offset.left + offset.width - iconWidth, \"px\");\n        style.top = \"\".concat(offset.top, \"px\");\n        break;\n\n      case \"bottom-left\":\n        style.left = \"\".concat(offset.left, \"px\");\n        style.top = \"\".concat(offset.top + offset.height - iconHeight, \"px\");\n        break;\n\n      case \"bottom-right\":\n        style.left = \"\".concat(offset.left + offset.width - iconWidth, \"px\");\n        style.top = \"\".concat(offset.top + offset.height - iconHeight, \"px\");\n        break;\n\n      case \"middle-left\":\n        style.left = \"\".concat(offset.left, \"px\");\n        style.top = \"\".concat(offset.top + (offset.height - iconHeight) / 2, \"px\");\n        break;\n\n      case \"middle-right\":\n        style.left = \"\".concat(offset.left + offset.width - iconWidth, \"px\");\n        style.top = \"\".concat(offset.top + (offset.height - iconHeight) / 2, \"px\");\n        break;\n\n      case \"middle-middle\":\n        style.left = \"\".concat(offset.left + (offset.width - iconWidth) / 2, \"px\");\n        style.top = \"\".concat(offset.top + (offset.height - iconHeight) / 2, \"px\");\n        break;\n\n      case \"bottom-middle\":\n        style.left = \"\".concat(offset.left + (offset.width - iconWidth) / 2, \"px\");\n        style.top = \"\".concat(offset.top + offset.height - iconHeight, \"px\");\n        break;\n\n      case \"top-middle\":\n        style.left = \"\".concat(offset.left + (offset.width - iconWidth) / 2, \"px\");\n        style.top = \"\".concat(offset.top, \"px\");\n        break;\n    }\n  }\n  /**\n   * Triggers when user clicks on the hint element\n   *\n   * @api private\n   * @method _showHintDialog\n   * @param {Number} stepId\n   */\n\n  function showHintDialog(stepId) {\n    var hintElement = document.querySelector(\".introjs-hint[data-step=\\\"\".concat(stepId, \"\\\"]\"));\n    var item = this._introItems[stepId]; // call the callback function (if any)\n\n    if (typeof this._hintClickCallback !== \"undefined\") {\n      this._hintClickCallback.call(this, hintElement, item, stepId);\n    } // remove all open tooltips\n\n\n    var removedStep = removeHintTooltip.call(this); // to toggle the tooltip\n\n    if (parseInt(removedStep, 10) === stepId) {\n      return;\n    }\n\n    var tooltipLayer = document.createElement(\"div\");\n    var tooltipTextLayer = document.createElement(\"div\");\n    var arrowLayer = document.createElement(\"div\");\n    var referenceLayer = document.createElement(\"div\");\n    tooltipLayer.className = \"introjs-tooltip\";\n\n    tooltipLayer.onclick = function (e) {\n      //IE9 & Other Browsers\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      } //IE8 and Lower\n      else {\n          e.cancelBubble = true;\n        }\n    };\n\n    tooltipTextLayer.className = \"introjs-tooltiptext\";\n    var tooltipWrapper = document.createElement(\"p\");\n    tooltipWrapper.innerHTML = item.hint;\n    var closeButton = document.createElement(\"a\");\n    closeButton.className = this._options.buttonClass;\n    closeButton.setAttribute(\"role\", \"button\");\n    closeButton.innerHTML = this._options.hintButtonLabel;\n    closeButton.onclick = hideHint.bind(this, stepId);\n    tooltipTextLayer.appendChild(tooltipWrapper);\n    tooltipTextLayer.appendChild(closeButton);\n    arrowLayer.className = \"introjs-arrow\";\n    tooltipLayer.appendChild(arrowLayer);\n    tooltipLayer.appendChild(tooltipTextLayer); // set current step for _placeTooltip function\n\n    this._currentStep = hintElement.getAttribute(\"data-step\"); // align reference layer position\n\n    referenceLayer.className = \"introjs-tooltipReferenceLayer introjs-hintReference\";\n    referenceLayer.setAttribute(\"data-step\", hintElement.getAttribute(\"data-step\"));\n    setHelperLayerPosition.call(this, referenceLayer);\n    referenceLayer.appendChild(tooltipLayer);\n    document.body.appendChild(referenceLayer); //set proper position\n\n    placeTooltip.call(this, hintElement, tooltipLayer, arrowLayer, null, true);\n  }\n  /**\n   * Removes open hint (tooltip hint)\n   *\n   * @api private\n   * @method _removeHintTooltip\n   */\n\n  function removeHintTooltip() {\n    var tooltip = document.querySelector(\".introjs-hintReference\");\n\n    if (tooltip) {\n      var step = tooltip.getAttribute(\"data-step\");\n      tooltip.parentNode.removeChild(tooltip);\n      return step;\n    }\n  }\n  /**\n   * Start parsing hint items\n   *\n   * @api private\n   * @param {Object} targetElm\n   * @method _startHint\n   */\n\n  function populateHints(targetElm) {\n    var _this5 = this;\n\n    this._introItems = [];\n\n    if (this._options.hints) {\n      forEach(this._options.hints, function (hint) {\n        var currentItem = cloneObject(hint);\n\n        if (typeof currentItem.element === \"string\") {\n          //grab the element with given selector from the page\n          currentItem.element = document.querySelector(currentItem.element);\n        }\n\n        currentItem.hintPosition = currentItem.hintPosition || _this5._options.hintPosition;\n        currentItem.hintAnimation = currentItem.hintAnimation || _this5._options.hintAnimation;\n\n        if (currentItem.element !== null) {\n          _this5._introItems.push(currentItem);\n        }\n      });\n    } else {\n      var hints = targetElm.querySelectorAll(\"*[data-hint]\");\n\n      if (!hints || !hints.length) {\n        return false;\n      } //first add intro items with data-step\n\n\n      forEach(hints, function (currentElement) {\n        // hint animation\n        var hintAnimation = currentElement.getAttribute(\"data-hintanimation\");\n\n        if (hintAnimation) {\n          hintAnimation = hintAnimation === \"true\";\n        } else {\n          hintAnimation = _this5._options.hintAnimation;\n        }\n\n        _this5._introItems.push({\n          element: currentElement,\n          hint: currentElement.getAttribute(\"data-hint\"),\n          hintPosition: currentElement.getAttribute(\"data-hintposition\") || _this5._options.hintPosition,\n          hintAnimation: hintAnimation,\n          tooltipClass: currentElement.getAttribute(\"data-tooltipclass\"),\n          position: currentElement.getAttribute(\"data-position\") || _this5._options.tooltipPosition\n        });\n      });\n    }\n\n    addHints.call(this);\n    /*\n    todo:\n    these events should be removed at some point\n    */\n\n    DOMEvent.on(document, \"click\", removeHintTooltip, this, false);\n    DOMEvent.on(window, \"resize\", reAlignHints, this, true);\n  }\n  /**\n   * Re-aligns all hint elements\n   *\n   * @api private\n   * @method _reAlignHints\n   */\n\n  function reAlignHints() {\n    var _this6 = this;\n\n    forEach(this._introItems, function (_ref2) {\n      var targetElement = _ref2.targetElement,\n          hintPosition = _ref2.hintPosition,\n          element = _ref2.element;\n\n      if (typeof targetElement === \"undefined\") {\n        return;\n      }\n\n      alignHintPosition.call(_this6, hintPosition, element, targetElement);\n    });\n  }\n\n  /**\n   * Update placement of the intro objects on the screen\n   * @api private\n   */\n\n  function refresh() {\n    // re-align intros\n    setHelperLayerPosition.call(this, document.querySelector(\".introjs-helperLayer\"));\n    setHelperLayerPosition.call(this, document.querySelector(\".introjs-tooltipReferenceLayer\"));\n    setHelperLayerPosition.call(this, document.querySelector(\".introjs-disableInteraction\")); // re-align tooltip\n\n    if (this._currentStep !== undefined && this._currentStep !== null) {\n      var oldHelperNumberLayer = document.querySelector(\".introjs-helperNumberLayer\");\n      var oldArrowLayer = document.querySelector(\".introjs-arrow\");\n      var oldtooltipContainer = document.querySelector(\".introjs-tooltip\");\n      placeTooltip.call(this, this._introItems[this._currentStep].element, oldtooltipContainer, oldArrowLayer, oldHelperNumberLayer);\n    } //re-align hints\n\n\n    reAlignHints.call(this);\n    return this;\n  }\n\n  function onResize() {\n    refresh.call(this);\n  }\n\n  /**\n   * Exit from intro\n   *\n   * @api private\n   * @method _exitIntro\n   * @param {Object} targetElement\n   * @param {Boolean} force - Setting to `true` will skip the result of beforeExit callback\n   */\n\n  function exitIntro(targetElement, force) {\n    var continueExit = true; // calling onbeforeexit callback\n    //\n    // If this callback return `false`, it would halt the process\n\n    if (this._introBeforeExitCallback !== undefined) {\n      continueExit = this._introBeforeExitCallback.call(this);\n    } // skip this check if `force` parameter is `true`\n    // otherwise, if `onbeforeexit` returned `false`, don't exit the intro\n\n\n    if (!force && continueExit === false) return; //remove overlay layers from the page\n\n    var overlayLayers = targetElement.querySelectorAll(\".introjs-overlay\");\n\n    if (overlayLayers && overlayLayers.length) {\n      forEach(overlayLayers, function (overlayLayer) {\n        overlayLayer.style.opacity = 0;\n        window.setTimeout(function () {\n          if (this.parentNode) {\n            this.parentNode.removeChild(this);\n          }\n        }.bind(overlayLayer), 500);\n      });\n    } //remove all helper layers\n\n\n    var helperLayer = targetElement.querySelector(\".introjs-helperLayer\");\n\n    if (helperLayer) {\n      helperLayer.parentNode.removeChild(helperLayer);\n    }\n\n    var referenceLayer = targetElement.querySelector(\".introjs-tooltipReferenceLayer\");\n\n    if (referenceLayer) {\n      referenceLayer.parentNode.removeChild(referenceLayer);\n    } //remove disableInteractionLayer\n\n\n    var disableInteractionLayer = targetElement.querySelector(\".introjs-disableInteraction\");\n\n    if (disableInteractionLayer) {\n      disableInteractionLayer.parentNode.removeChild(disableInteractionLayer);\n    } //remove intro floating element\n\n\n    var floatingElement = document.querySelector(\".introjsFloatingElement\");\n\n    if (floatingElement) {\n      floatingElement.parentNode.removeChild(floatingElement);\n    }\n\n    removeShowElement(); //remove `introjs-fixParent` class from the elements\n\n    var fixParents = document.querySelectorAll(\".introjs-fixParent\");\n    forEach(fixParents, function (parent) {\n      removeClass(parent, /introjs-fixParent/g);\n    }); //clean listeners\n\n    DOMEvent.off(window, \"keydown\", onKeyDown, this, true);\n    DOMEvent.off(window, \"resize\", onResize, this, true); //check if any callback is defined\n\n    if (this._introExitCallback !== undefined) {\n      this._introExitCallback.call(this);\n    } //set the step to zero\n\n\n    this._currentStep = undefined;\n  }\n\n  /**\n   * Add overlay layer to the page\n   *\n   * @api private\n   * @method _addOverlayLayer\n   * @param {Object} targetElm\n   */\n\n  function addOverlayLayer(targetElm) {\n    var overlayLayer = document.createElement(\"div\");\n    var styleText = \"\";\n    var self = this; //set css class name\n\n    overlayLayer.className = \"introjs-overlay\"; //check if the target element is body, we should calculate the size of overlay layer in a better way\n\n    if (!targetElm.tagName || targetElm.tagName.toLowerCase() === \"body\") {\n      styleText += \"top: 0;bottom: 0; left: 0;right: 0;position: fixed;\";\n      overlayLayer.style.cssText = styleText;\n    } else {\n      //set overlay layer position\n      var elementPosition = getOffset(targetElm);\n\n      if (elementPosition) {\n        styleText += \"width: \".concat(elementPosition.width, \"px; height:\").concat(elementPosition.height, \"px; top:\").concat(elementPosition.top, \"px;left: \").concat(elementPosition.left, \"px;\");\n        overlayLayer.style.cssText = styleText;\n      }\n    }\n\n    targetElm.appendChild(overlayLayer);\n\n    overlayLayer.onclick = function () {\n      if (self._options.exitOnOverlayClick === true) {\n        exitIntro.call(self, targetElm);\n      }\n    };\n\n    window.setTimeout(function () {\n      styleText += \"opacity: \".concat(self._options.overlayOpacity.toString(), \";\");\n      overlayLayer.style.cssText = styleText;\n    }, 10);\n    return true;\n  }\n\n  /**\n   * Initiate a new introduction/guide from an element in the page\n   *\n   * @api private\n   * @method _introForElement\n   * @param {Object} targetElm\n   * @param {String} group\n   * @returns {Boolean} Success or not?\n   */\n\n  function introForElement(targetElm, group) {\n    var _this = this;\n\n    var allIntroSteps = targetElm.querySelectorAll(\"*[data-intro]\");\n    var introItems = [];\n\n    if (this._options.steps) {\n      //use steps passed programmatically\n      forEach(this._options.steps, function (step) {\n        var currentItem = cloneObject(step); //set the step\n\n        currentItem.step = introItems.length + 1; //use querySelector function only when developer used CSS selector\n\n        if (typeof currentItem.element === \"string\") {\n          //grab the element with given selector from the page\n          currentItem.element = document.querySelector(currentItem.element);\n        } //intro without element\n\n\n        if (typeof currentItem.element === \"undefined\" || currentItem.element === null) {\n          var floatingElementQuery = document.querySelector(\".introjsFloatingElement\");\n\n          if (floatingElementQuery === null) {\n            floatingElementQuery = document.createElement(\"div\");\n            floatingElementQuery.className = \"introjsFloatingElement\";\n            document.body.appendChild(floatingElementQuery);\n          }\n\n          currentItem.element = floatingElementQuery;\n          currentItem.position = \"floating\";\n        }\n\n        currentItem.scrollTo = currentItem.scrollTo || _this._options.scrollTo;\n\n        if (typeof currentItem.disableInteraction === \"undefined\") {\n          currentItem.disableInteraction = _this._options.disableInteraction;\n        }\n\n        if (currentItem.element !== null) {\n          introItems.push(currentItem);\n        }\n      });\n    } else {\n      //use steps from data-* annotations\n      var elmsLength = allIntroSteps.length;\n      var disableInteraction; //if there's no element to intro\n\n      if (elmsLength < 1) {\n        return false;\n      }\n\n      forEach(allIntroSteps, function (currentElement) {\n        // PR #80\n        // start intro for groups of elements\n        if (group && currentElement.getAttribute(\"data-intro-group\") !== group) {\n          return;\n        } // skip hidden elements\n\n\n        if (currentElement.style.display === \"none\") {\n          return;\n        }\n\n        var step = parseInt(currentElement.getAttribute(\"data-step\"), 10);\n\n        if (typeof currentElement.getAttribute(\"data-disable-interaction\") !== \"undefined\") {\n          disableInteraction = !!currentElement.getAttribute(\"data-disable-interaction\");\n        } else {\n          disableInteraction = _this._options.disableInteraction;\n        }\n\n        if (step > 0) {\n          introItems[step - 1] = {\n            element: currentElement,\n            intro: currentElement.getAttribute(\"data-intro\"),\n            step: parseInt(currentElement.getAttribute(\"data-step\"), 10),\n            tooltipClass: currentElement.getAttribute(\"data-tooltipclass\"),\n            highlightClass: currentElement.getAttribute(\"data-highlightclass\"),\n            position: currentElement.getAttribute(\"data-position\") || _this._options.tooltipPosition,\n            scrollTo: currentElement.getAttribute(\"data-scrollto\") || _this._options.scrollTo,\n            disableInteraction: disableInteraction\n          };\n        }\n      }); //next add intro items without data-step\n      //todo: we need a cleanup here, two loops are redundant\n\n      var _nextStep = 0;\n      forEach(allIntroSteps, function (currentElement) {\n        // PR #80\n        // start intro for groups of elements\n        if (group && currentElement.getAttribute(\"data-intro-group\") !== group) {\n          return;\n        }\n\n        if (currentElement.getAttribute(\"data-step\") === null) {\n          while (true) {\n            if (typeof introItems[_nextStep] === \"undefined\") {\n              break;\n            } else {\n              _nextStep++;\n            }\n          }\n\n          if (typeof currentElement.getAttribute(\"data-disable-interaction\") !== \"undefined\") {\n            disableInteraction = !!currentElement.getAttribute(\"data-disable-interaction\");\n          } else {\n            disableInteraction = _this._options.disableInteraction;\n          }\n\n          introItems[_nextStep] = {\n            element: currentElement,\n            intro: currentElement.getAttribute(\"data-intro\"),\n            step: _nextStep + 1,\n            tooltipClass: currentElement.getAttribute(\"data-tooltipclass\"),\n            highlightClass: currentElement.getAttribute(\"data-highlightclass\"),\n            position: currentElement.getAttribute(\"data-position\") || _this._options.tooltipPosition,\n            scrollTo: currentElement.getAttribute(\"data-scrollto\") || _this._options.scrollTo,\n            disableInteraction: disableInteraction\n          };\n        }\n      });\n    } //removing undefined/null elements\n\n\n    var tempIntroItems = [];\n\n    for (var z = 0; z < introItems.length; z++) {\n      if (introItems[z]) {\n        // copy non-falsy values to the end of the array\n        tempIntroItems.push(introItems[z]);\n      }\n    }\n\n    introItems = tempIntroItems; //Ok, sort all items with given steps\n\n    introItems.sort(function (a, b) {\n      return a.step - b.step;\n    }); //set it to the introJs object\n\n    this._introItems = introItems; //add overlay layer to the page\n\n    if (addOverlayLayer.call(this, targetElm)) {\n      //then, start the show\n      nextStep.call(this);\n\n      if (this._options.keyboardNavigation) {\n        DOMEvent.on(window, \"keydown\", onKeyDown, this, true);\n      } //for window resize\n\n\n      DOMEvent.on(window, \"resize\", onResize, this, true);\n    }\n\n    return false;\n  }\n\n  var version = \"3.0.1\";\n\n  /**\n   * IntroJs main class\n   *\n   * @class IntroJs\n   */\n\n  function IntroJs(obj) {\n    this._targetElement = obj;\n    this._introItems = [];\n    this._options = {\n      /* Label Display to be Shown in the highlighted div */\n      labelDisplay: \"\",\n\n      /* Next button label in tooltip box */\n      nextLabel: \"Next &rarr;\",\n\n      /* Previous button label in tooltip box */\n      prevLabel: \"&larr; Back\",\n\n      /* Skip button label in tooltip box */\n      skipLabel: \"Skip\",\n\n      /* Done button label in tooltip box */\n      doneLabel: \"Done\",\n\n      /* Hide previous button in the first step? Otherwise, it will be disabled button. */\n      hidePrev: false,\n\n      /* Hide next button in the last step? Otherwise, it will be disabled button. */\n      hideNext: false,\n\n      /* Default tooltip box position */\n      tooltipPosition: \"bottom\",\n\n      /* Next CSS class for tooltip boxes */\n      tooltipClass: \"\",\n\n      /* CSS class that is added to the helperLayer */\n      highlightClass: \"\",\n\n      /* Close introduction when pressing Escape button? */\n      exitOnEsc: true,\n\n      /* Close introduction when clicking on overlay layer? */\n      exitOnOverlayClick: true,\n\n      /* Show step numbers in introduction? */\n      showStepNumbers: true,\n\n      /* Let user use keyboard to navigate the tour? */\n      keyboardNavigation: true,\n\n      /* Show tour control buttons? */\n      showButtons: true,\n\n      /* Show tour bullets? */\n      showBullets: true,\n\n      /* Show tour progress? */\n      showProgress: false,\n\n      /* Scroll to highlighted element? */\n      scrollToElement: true,\n\n      /*\n       * Should we scroll the tooltip or target element?\n       *\n       * Options are: 'element' or 'tooltip'\n       */\n      scrollTo: \"element\",\n\n      /* Padding to add after scrolling when element is not in the viewport (in pixels) */\n      scrollPadding: 30,\n\n      /* Set the overlay opacity */\n      overlayOpacity: 0.8,\n\n      /* Precedence of positions, when auto is enabled */\n      positionPrecedence: [\"bottom\", \"top\", \"right\", \"left\"],\n\n      /* Disable an interaction with element? */\n      disableInteraction: false,\n\n      /* Set how much padding to be used around helper element */\n      helperElementPadding: 10,\n\n      /* Default hint position */\n      hintPosition: \"top-middle\",\n\n      /* Hint button label */\n      hintButtonLabel: \"Got it\",\n\n      /* Adding animation to hints? */\n      hintAnimation: true,\n\n      /* additional classes to put on the buttons */\n      buttonClass: \"introjs-button\"\n    };\n  }\n\n  var introJs = function introJs(targetElm) {\n    var instance;\n\n    if (_typeof(targetElm) === \"object\") {\n      //Ok, create a new instance\n      instance = new IntroJs(targetElm);\n    } else if (typeof targetElm === \"string\") {\n      //select the target element with query selector\n      var targetElement = document.querySelector(targetElm);\n\n      if (targetElement) {\n        instance = new IntroJs(targetElement);\n      } else {\n        throw new Error(\"There is no element with given selector.\");\n      }\n    } else {\n      instance = new IntroJs(document.body);\n    } // add instance to list of _instances\n    // passing group to stamp to increment\n    // from 0 onward somewhat reliably\n\n\n    introJs.instances[stamp(instance, \"introjs-instance\")] = instance;\n    return instance;\n  };\n  /**\n   * Current IntroJs version\n   *\n   * @property version\n   * @type String\n   */\n\n\n  introJs.version = version;\n  /**\n   * key-val object helper for introJs instances\n   *\n   * @property instances\n   * @type Object\n   */\n\n  introJs.instances = {}; //Prototype\n\n  introJs.fn = IntroJs.prototype = {\n    clone: function clone() {\n      return new IntroJs(this);\n    },\n    setOption: function setOption(option, value) {\n      this._options[option] = value;\n      return this;\n    },\n    setOptions: function setOptions(options) {\n      this._options = mergeOptions(this._options, options);\n      return this;\n    },\n    start: function start(group) {\n      introForElement.call(this, this._targetElement, group);\n      return this;\n    },\n    goToStep: function goToStep$1(step) {\n      goToStep.call(this, step);\n\n      return this;\n    },\n    addStep: function addStep(options) {\n      if (!this._options.steps) {\n        this._options.steps = [];\n      }\n\n      this._options.steps.push(options);\n\n      return this;\n    },\n    addSteps: function addSteps(steps) {\n      if (!steps.length) return;\n\n      for (var index = 0; index < steps.length; index++) {\n        this.addStep(steps[index]);\n      }\n\n      return this;\n    },\n    goToStepNumber: function goToStepNumber$1(step) {\n      goToStepNumber.call(this, step);\n\n      return this;\n    },\n    nextStep: function nextStep$1() {\n      nextStep.call(this);\n\n      return this;\n    },\n    previousStep: function previousStep$1() {\n      previousStep.call(this);\n\n      return this;\n    },\n    currentStep: function currentStep$1() {\n      return currentStep.call(this);\n    },\n    exit: function exit(force) {\n      exitIntro.call(this, this._targetElement, force);\n      return this;\n    },\n    refresh: function refresh$1() {\n      refresh.call(this);\n\n      return this;\n    },\n    onbeforechange: function onbeforechange(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introBeforeChangeCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onbeforechange was not a function\");\n      }\n\n      return this;\n    },\n    onchange: function onchange(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introChangeCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onchange was not a function.\");\n      }\n\n      return this;\n    },\n    onafterchange: function onafterchange(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introAfterChangeCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onafterchange was not a function\");\n      }\n\n      return this;\n    },\n    oncomplete: function oncomplete(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introCompleteCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for oncomplete was not a function.\");\n      }\n\n      return this;\n    },\n    onhintsadded: function onhintsadded(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._hintsAddedCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onhintsadded was not a function.\");\n      }\n\n      return this;\n    },\n    onhintclick: function onhintclick(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._hintClickCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onhintclick was not a function.\");\n      }\n\n      return this;\n    },\n    onhintclose: function onhintclose(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._hintCloseCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onhintclose was not a function.\");\n      }\n\n      return this;\n    },\n    onexit: function onexit(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introExitCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onexit was not a function.\");\n      }\n\n      return this;\n    },\n    onskip: function onskip(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introSkipCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onskip was not a function.\");\n      }\n\n      return this;\n    },\n    onbeforeexit: function onbeforeexit(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introBeforeExitCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onbeforeexit was not a function.\");\n      }\n\n      return this;\n    },\n    addHints: function addHints() {\n      populateHints.call(this, this._targetElement);\n      return this;\n    },\n    hideHint: function hideHint$1(stepId) {\n      hideHint.call(this, stepId);\n\n      return this;\n    },\n    hideHints: function hideHints$1() {\n      hideHints.call(this);\n\n      return this;\n    },\n    showHint: function showHint$1(stepId) {\n      showHint.call(this, stepId);\n\n      return this;\n    },\n    showHints: function showHints$1() {\n      showHints.call(this);\n\n      return this;\n    },\n    removeHints: function removeHints$1() {\n      removeHints.call(this);\n\n      return this;\n    },\n    removeHint: function removeHint$1(stepId) {\n      removeHint().call(this, stepId);\n\n      return this;\n    },\n    showHintDialog: function showHintDialog$1(stepId) {\n      showHintDialog.call(this, stepId);\n\n      return this;\n    }\n  };\n\n  return introJs;\n\n})));\n"]}]}