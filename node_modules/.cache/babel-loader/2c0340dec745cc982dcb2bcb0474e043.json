{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/eslint-loader/index.js??ref--13-0!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Layout/intro.js","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Layout/intro.js","mtime":1643027096176},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2giKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiKTsKCnZhciBfdHlwZW9mMiA9IHJlcXVpcmUoIi9ob21lL3ZpbWFsZXNoL0NFTlNFL2NoYXRib3QtcG9ydGFsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL3R5cGVvZiIpOwoKLyohCiAqIEludHJvLmpzIHYzLjAuMQogKiBodHRwczovL2dpdGh1Yi5jb20vdXNhYmxpY2EvaW50cm8uanMKICoKICogQ29weXJpZ2h0IChDKSAyMDE3LTIwMjAgQWZzaGluIE1laHJhYmFuaSAoQGFmc2hpbm1laCkuCiAqIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS91c2FibGljYS9pbnRyby5qcy9tYXN0ZXIvbGljZW5zZS5tZAogKgogKiBEYXRlOiBTYXQsIDE3IE9jdCAyMDIwIDEwOjM2OjIwIEdNVAogKi8KdmFyIF9yZXF1aXJlID0gcmVxdWlyZSgiZDMiKSwKICAgIGltYWdlID0gX3JlcXVpcmUuaW1hZ2U7CgooZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkgewogICh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YyKGV4cG9ydHMpKSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6IHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6IChnbG9iYWwgPSBnbG9iYWwgfHwgc2VsZiwgZ2xvYmFsLmludHJvSnMgPSBmYWN0b3J5KCkpOwp9KSh0aGlzLCBmdW5jdGlvbiAoKSB7CiAgJ3VzZSBzdHJpY3QnOwoKICBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsKCiAgICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgewogICAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgICByZXR1cm4gdHlwZW9mIG9iajsKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7CiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIF90eXBlb2Yob2JqKTsKICB9CiAgLyoqCiAgICogT3ZlcndyaXRlcyBvYmoxJ3MgdmFsdWVzIHdpdGggb2JqMidzIGFuZCBhZGRzIG9iajIncyBpZiBub24gZXhpc3RlbnQgaW4gb2JqMQogICAqIHZpYTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xNzEyNTEvaG93LWNhbi1pLW1lcmdlLXByb3BlcnRpZXMtb2YtdHdvLWphdmFzY3JpcHQtb2JqZWN0cy1keW5hbWljYWxseQogICAqCiAgICogQHBhcmFtIG9iajEKICAgKiBAcGFyYW0gb2JqMgogICAqIEByZXR1cm5zIG9iajMgYSBuZXcgb2JqZWN0IGJhc2VkIG9uIG9iajEgYW5kIG9iajIKICAgKi8KCgogIGZ1bmN0aW9uIG1lcmdlT3B0aW9ucyhvYmoxLCBvYmoyKSB7CiAgICB2YXIgb2JqMyA9IHt9OwogICAgdmFyIGF0dHJuYW1lOwoKICAgIGZvciAoYXR0cm5hbWUgaW4gb2JqMSkgewogICAgICBvYmozW2F0dHJuYW1lXSA9IG9iajFbYXR0cm5hbWVdOwogICAgfQoKICAgIGZvciAoYXR0cm5hbWUgaW4gb2JqMikgewogICAgICBvYmozW2F0dHJuYW1lXSA9IG9iajJbYXR0cm5hbWVdOwogICAgfQoKICAgIHJldHVybiBvYmozOwogIH0KICAvKioKICAgKiBNYXJrIGFueSBvYmplY3Qgd2l0aCBhbiBpbmNyZW1lbnRpbmcgbnVtYmVyCiAgICogdXNlZCBmb3Iga2VlcGluZyB0cmFjayBvZiBvYmplY3RzCiAgICoKICAgKiBAcGFyYW0gT2JqZWN0IG9iaiAgIEFueSBvYmplY3Qgb3IgRE9NIEVsZW1lbnQKICAgKiBAcGFyYW0gU3RyaW5nIGtleQogICAqIEByZXR1cm4gT2JqZWN0CiAgICovCgoKICB2YXIgc3RhbXAgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIga2V5cyA9IHt9OwogICAgcmV0dXJuIGZ1bmN0aW9uIHN0YW1wKG9iaikgewogICAgICB2YXIga2V5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAiaW50cm9qcy1zdGFtcCI7IC8vIGVhY2ggZ3JvdXAgaW5jcmVtZW50cyBmcm9tIDAKCiAgICAgIGtleXNba2V5XSA9IGtleXNba2V5XSB8fCAwOyAvLyBzdGFtcCBvbmx5IG9uY2UgcGVyIG9iamVjdAoKICAgICAgaWYgKG9ialtrZXldID09PSB1bmRlZmluZWQpIHsKICAgICAgICAvLyBpbmNyZW1lbnQga2V5IGZvciBlYWNoIG5ldyBvYmplY3QKICAgICAgICBvYmpba2V5XSA9IGtleXNba2V5XSsrOwogICAgICB9CgogICAgICByZXR1cm4gb2JqW2tleV07CiAgICB9OwogIH0oKTsKICAvKioKICAgKiBJdGVyYXRlcyBhcnJheXMKICAgKgogICAqIEBwYXJhbSB7QXJyYXl9IGFycgogICAqIEBwYXJhbSB7RnVuY3Rpb259IGZvckVhY2hGbmMKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb21wbGV0ZUZuYwogICAqIEByZXR1cm4ge051bGx9CiAgICovCgoKICBmdW5jdGlvbiBmb3JFYWNoKGFyciwgZm9yRWFjaEZuYywgY29tcGxldGVGbmMpIHsKICAgIC8vIGluIGNhc2UgYXJyIGlzIGFuIGVtcHR5IHF1ZXJ5IHNlbGVjdG9yIG5vZGUgbGlzdAogICAgaWYgKGFycikgewogICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgZm9yRWFjaEZuYyhhcnJbaV0sIGkpOwogICAgICB9CiAgICB9CgogICAgaWYgKHR5cGVvZiBjb21wbGV0ZUZuYyA9PT0gImZ1bmN0aW9uIikgewogICAgICBjb21wbGV0ZUZuYygpOwogICAgfQogIH0KICAvKioKICAgKiBSZW1vdmUgYSBjbGFzcyBmcm9tIGFuIGVsZW1lbnQKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3JlbW92ZUNsYXNzCiAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQKICAgKiBAcGFyYW0ge1JlZ0V4cHxTdHJpbmd9IGNsYXNzTmFtZVJlZ2V4IGNhbiBiZSByZWdleCBvciBzdHJpbmcKICAgKiBAcmV0dXJucyBudWxsCiAgICovCgoKICBmdW5jdGlvbiByZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWVSZWdleCkgewogICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBTVkdFbGVtZW50KSB7CiAgICAgIHZhciBwcmUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgiY2xhc3MiKSB8fCAiIjsKICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgcHJlLnJlcGxhY2UoY2xhc3NOYW1lUmVnZXgsICIiKS5yZXBsYWNlKC9eXHMrfFxzKyQvZywgIiIpKTsKICAgIH0gZWxzZSB7CiAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWUucmVwbGFjZShjbGFzc05hbWVSZWdleCwgIiIpLnJlcGxhY2UoL15ccyt8XHMrJC9nLCAiIik7CiAgICB9CiAgfQogIC8qKgogICAqIERPTUV2ZW50IEhhbmRsZXMgYWxsIERPTSBldmVudHMKICAgKgogICAqIG1ldGhvZHM6CiAgICoKICAgKiBvbiAtIGFkZCBldmVudCBoYW5kbGVyCiAgICogb2ZmIC0gcmVtb3ZlIGV2ZW50CiAgICovCgoKICB2YXIgRE9NRXZlbnQgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBET01FdmVudCgpIHsKICAgICAgdmFyIGV2ZW50c19rZXkgPSAiaW50cm9qc19ldmVudCI7CiAgICAgIC8qKgogICAgICAgKiBHZXRzIGEgdW5pcXVlIElEIGZvciBhbiBldmVudCBsaXN0ZW5lcgogICAgICAgKgogICAgICAgKiBAcGFyYW0gb2JqIE9iamVjdAogICAgICAgKiBAcGFyYW0gdHlwZSBldmVudCB0eXBlCiAgICAgICAqIEBwYXJhbSBsaXN0ZW5lciBGdW5jdGlvbgogICAgICAgKiBAcGFyYW0gY29udGV4dCBPYmplY3QKICAgICAgICogQHJldHVybiBTdHJpbmcKICAgICAgICovCgogICAgICB0aGlzLl9pZCA9IGZ1bmN0aW9uIChvYmosIHR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KSB7CiAgICAgICAgcmV0dXJuIHR5cGUgKyBzdGFtcChsaXN0ZW5lcikgKyAoY29udGV4dCA/ICJfIi5jb25jYXQoc3RhbXAoY29udGV4dCkpIDogIiIpOwogICAgICB9OwogICAgICAvKioKICAgICAgICogQWRkcyBldmVudCBsaXN0ZW5lcgogICAgICAgKgogICAgICAgKiBAcGFyYW0gb2JqIE9iamVjdCBvYmoKICAgICAgICogQHBhcmFtIHR5cGUgU3RyaW5nCiAgICAgICAqIEBwYXJhbSBsaXN0ZW5lciBGdW5jdGlvbgogICAgICAgKiBAcGFyYW0gY29udGV4dCBPYmplY3QKICAgICAgICogQHBhcmFtIHVzZUNhcHR1cmUgQm9vbGVhbgogICAgICAgKiBAcmV0dXJuIG51bGwKICAgICAgICovCgoKICAgICAgdGhpcy5vbiA9IGZ1bmN0aW9uIChvYmosIHR5cGUsIGxpc3RlbmVyLCBjb250ZXh0LCB1c2VDYXB0dXJlKSB7CiAgICAgICAgdmFyIGlkID0gdGhpcy5faWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCiAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKGUpIHsKICAgICAgICAgIHJldHVybiBsaXN0ZW5lci5jYWxsKGNvbnRleHQgfHwgb2JqLCBlIHx8IHdpbmRvdy5ldmVudCk7CiAgICAgICAgfTsKCiAgICAgICAgaWYgKCJhZGRFdmVudExpc3RlbmVyIiBpbiBvYmopIHsKICAgICAgICAgIG9iai5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIsIHVzZUNhcHR1cmUpOwogICAgICAgIH0gZWxzZSBpZiAoImF0dGFjaEV2ZW50IiBpbiBvYmopIHsKICAgICAgICAgIG9iai5hdHRhY2hFdmVudCgib24iLmNvbmNhdCh0eXBlKSwgaGFuZGxlcik7CiAgICAgICAgfQoKICAgICAgICBvYmpbZXZlbnRzX2tleV0gPSBvYmpbZXZlbnRzX2tleV0gfHwge307CiAgICAgICAgb2JqW2V2ZW50c19rZXldW2lkXSA9IGhhbmRsZXI7CiAgICAgIH07CiAgICAgIC8qKgogICAgICAgKiBSZW1vdmVzIGV2ZW50IGxpc3RlbmVyCiAgICAgICAqCiAgICAgICAqIEBwYXJhbSBvYmogT2JqZWN0CiAgICAgICAqIEBwYXJhbSB0eXBlIFN0cmluZwogICAgICAgKiBAcGFyYW0gbGlzdGVuZXIgRnVuY3Rpb24KICAgICAgICogQHBhcmFtIGNvbnRleHQgT2JqZWN0CiAgICAgICAqIEBwYXJhbSB1c2VDYXB0dXJlIEJvb2xlYW4KICAgICAgICogQHJldHVybiBudWxsCiAgICAgICAqLwoKCiAgICAgIHRoaXMub2ZmID0gZnVuY3Rpb24gKG9iaiwgdHlwZSwgbGlzdGVuZXIsIGNvbnRleHQsIHVzZUNhcHR1cmUpIHsKICAgICAgICB2YXIgaWQgPSB0aGlzLl9pZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoKICAgICAgICB2YXIgaGFuZGxlciA9IG9ialtldmVudHNfa2V5XSAmJiBvYmpbZXZlbnRzX2tleV1baWRdOwoKICAgICAgICBpZiAoIWhhbmRsZXIpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICgicmVtb3ZlRXZlbnRMaXN0ZW5lciIgaW4gb2JqKSB7CiAgICAgICAgICBvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyLCB1c2VDYXB0dXJlKTsKICAgICAgICB9IGVsc2UgaWYgKCJkZXRhY2hFdmVudCIgaW4gb2JqKSB7CiAgICAgICAgICBvYmouZGV0YWNoRXZlbnQoIm9uIi5jb25jYXQodHlwZSksIGhhbmRsZXIpOwogICAgICAgIH0KCiAgICAgICAgb2JqW2V2ZW50c19rZXldW2lkXSA9IG51bGw7CiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIG5ldyBET01FdmVudCgpOwogIH0oKTsKICAvKioKICAgKiBBcHBlbmQgYSBjbGFzcyB0byBhbiBlbGVtZW50CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9hZGRDbGFzcwogICAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50CiAgICogQHBhcmFtIHtTdHJpbmd9IGNsYXNzTmFtZQogICAqIEByZXR1cm5zIG51bGwKICAgKi8KCgogIGZ1bmN0aW9uIGFkZENsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkgewogICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBTVkdFbGVtZW50KSB7CiAgICAgIC8vIHN2ZwogICAgICB2YXIgcHJlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoImNsYXNzIikgfHwgIiI7CiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCJjbGFzcyIsICIiLmNvbmNhdChwcmUsICIgIikuY29uY2F0KGNsYXNzTmFtZSkpOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAvLyBjaGVjayBmb3IgbW9kZXJuIGNsYXNzTGlzdCBwcm9wZXJ0eQogICAgICAgIHZhciBjbGFzc2VzID0gY2xhc3NOYW1lLnNwbGl0KCIgIik7CiAgICAgICAgZm9yRWFjaChjbGFzc2VzLCBmdW5jdGlvbiAoY2xzKSB7CiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xzKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICghZWxlbWVudC5jbGFzc05hbWUubWF0Y2goY2xhc3NOYW1lKSkgewogICAgICAgIC8vIGNoZWNrIGlmIGVsZW1lbnQgZG9lc24ndCBhbHJlYWR5IGhhdmUgY2xhc3NOYW1lCiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgKz0gIiAiLmNvbmNhdChjbGFzc05hbWUpOwogICAgICB9CiAgICB9CiAgfQogIC8qKgogICAqIEdldCBhbiBlbGVtZW50IENTUyBwcm9wZXJ0eSBvbiB0aGUgcGFnZQogICAqIFRoYW5rcyB0byBKYXZhU2NyaXB0IEtpdDogaHR0cDovL3d3dy5qYXZhc2NyaXB0a2l0LmNvbS9kaHRtbHR1dG9ycy9kaHRtbGNhc2NhZGU0LnNodG1sCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9nZXRQcm9wVmFsdWUKICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudAogICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wTmFtZQogICAqIEByZXR1cm5zIHN0cmluZyBwcm9wZXJ0eSB2YWx1ZQogICAqLwoKCiAgZnVuY3Rpb24gZ2V0UHJvcFZhbHVlKGVsZW1lbnQsIHByb3BOYW1lKSB7CiAgICB2YXIgcHJvcFZhbHVlID0gIiI7CgogICAgaWYgKGVsZW1lbnQuY3VycmVudFN0eWxlKSB7CiAgICAgIC8vSUUKICAgICAgcHJvcFZhbHVlID0gZWxlbWVudC5jdXJyZW50U3R5bGVbcHJvcE5hbWVdOwogICAgfSBlbHNlIGlmIChkb2N1bWVudC5kZWZhdWx0VmlldyAmJiBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKSB7CiAgICAgIC8vT3RoZXJzCiAgICAgIHByb3BWYWx1ZSA9IGRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZShwcm9wTmFtZSk7CiAgICB9IC8vUHJldmVudCBleGNlcHRpb24gaW4gSUUKCgogICAgaWYgKHByb3BWYWx1ZSAmJiBwcm9wVmFsdWUudG9Mb3dlckNhc2UpIHsKICAgICAgcmV0dXJuIHByb3BWYWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHByb3BWYWx1ZTsKICAgIH0KICB9CiAgLyoqCiAgICogVG8gc2V0IHRoZSBzaG93IGVsZW1lbnQKICAgKiBUaGlzIGZ1bmN0aW9uIHNldCBhIHJlbGF0aXZlIChpbiBtb3N0IGNhc2VzKSBwb3NpdGlvbiBhbmQgY2hhbmdlcyB0aGUgei1pbmRleAogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfc2V0U2hvd0VsZW1lbnQKICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0RWxlbWVudAogICAqLwoKCiAgZnVuY3Rpb24gc2V0U2hvd0VsZW1lbnQoX3JlZikgewogICAgdmFyIGVsZW1lbnQgPSBfcmVmLmVsZW1lbnQ7CiAgICB2YXIgcGFyZW50RWxtOyAvLyB3ZSBuZWVkIHRvIGFkZCB0aGlzIHNob3cgZWxlbWVudCBjbGFzcyB0byB0aGUgcGFyZW50IG9mIFNWRyBlbGVtZW50cwogICAgLy8gYmVjYXVzZSB0aGUgU1ZHIGVsZW1lbnRzIGNhbid0IGhhdmUgaW5kZXBlbmRlbnQgei1pbmRleAoKICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgU1ZHRWxlbWVudCkgewogICAgICBwYXJlbnRFbG0gPSBlbGVtZW50LnBhcmVudE5vZGU7CgogICAgICB3aGlsZSAoZWxlbWVudC5wYXJlbnROb2RlICE9PSBudWxsKSB7CiAgICAgICAgaWYgKCFwYXJlbnRFbG0udGFnTmFtZSB8fCBwYXJlbnRFbG0udGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiYm9keSIpIGJyZWFrOwoKICAgICAgICBpZiAocGFyZW50RWxtLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gInN2ZyIpIHsKICAgICAgICAgIGFkZENsYXNzKHBhcmVudEVsbSwgImludHJvanMtc2hvd0VsZW1lbnQgaW50cm9qcy1yZWxhdGl2ZVBvc2l0aW9uIik7CiAgICAgICAgfQoKICAgICAgICBwYXJlbnRFbG0gPSBwYXJlbnRFbG0ucGFyZW50Tm9kZTsKICAgICAgfQogICAgfQoKICAgIGFkZENsYXNzKGVsZW1lbnQsICJpbnRyb2pzLXNob3dFbGVtZW50Iik7CiAgICB2YXIgY3VycmVudEVsZW1lbnRQb3NpdGlvbiA9IGdldFByb3BWYWx1ZShlbGVtZW50LCAicG9zaXRpb24iKTsKCiAgICBpZiAoY3VycmVudEVsZW1lbnRQb3NpdGlvbiAhPT0gImFic29sdXRlIiAmJiBjdXJyZW50RWxlbWVudFBvc2l0aW9uICE9PSAicmVsYXRpdmUiICYmIGN1cnJlbnRFbGVtZW50UG9zaXRpb24gIT09ICJmaXhlZCIpIHsKICAgICAgLy9jaGFuZ2UgdG8gbmV3IGludHJvIGl0ZW0KICAgICAgYWRkQ2xhc3MoZWxlbWVudCwgImludHJvanMtcmVsYXRpdmVQb3NpdGlvbiIpOwogICAgfQoKICAgIHBhcmVudEVsbSA9IGVsZW1lbnQucGFyZW50Tm9kZTsKCiAgICB3aGlsZSAocGFyZW50RWxtICE9PSBudWxsKSB7CiAgICAgIGlmICghcGFyZW50RWxtLnRhZ05hbWUgfHwgcGFyZW50RWxtLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gImJvZHkiKSBicmVhazsgLy9maXggVGhlIFN0YWNraW5nIENvbnRleHQgcHJvYmxlbS4KICAgICAgLy9Nb3JlIGRldGFpbDogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvR3VpZGUvQ1NTL1VuZGVyc3RhbmRpbmdfel9pbmRleC9UaGVfc3RhY2tpbmdfY29udGV4dAoKICAgICAgdmFyIHpJbmRleCA9IGdldFByb3BWYWx1ZShwYXJlbnRFbG0sICJ6LWluZGV4Iik7CiAgICAgIHZhciBvcGFjaXR5ID0gcGFyc2VGbG9hdChnZXRQcm9wVmFsdWUocGFyZW50RWxtLCAib3BhY2l0eSIpKTsKICAgICAgdmFyIHRyYW5zZm9ybSA9IGdldFByb3BWYWx1ZShwYXJlbnRFbG0sICJ0cmFuc2Zvcm0iKSB8fCBnZXRQcm9wVmFsdWUocGFyZW50RWxtLCAiLXdlYmtpdC10cmFuc2Zvcm0iKSB8fCBnZXRQcm9wVmFsdWUocGFyZW50RWxtLCAiLW1vei10cmFuc2Zvcm0iKSB8fCBnZXRQcm9wVmFsdWUocGFyZW50RWxtLCAiLW1zLXRyYW5zZm9ybSIpIHx8IGdldFByb3BWYWx1ZShwYXJlbnRFbG0sICItby10cmFuc2Zvcm0iKTsKCiAgICAgIGlmICgvWzAtOV0rLy50ZXN0KHpJbmRleCkgfHwgb3BhY2l0eSA8IDEgfHwgdHJhbnNmb3JtICE9PSAibm9uZSIgJiYgdHJhbnNmb3JtICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBhZGRDbGFzcyhwYXJlbnRFbG0sICJpbnRyb2pzLWZpeFBhcmVudCIpOwogICAgICB9CgogICAgICBwYXJlbnRFbG0gPSBwYXJlbnRFbG0ucGFyZW50Tm9kZTsKICAgIH0KICB9CiAgLyoqCiAgICogc2Nyb2xsIGEgc2Nyb2xsYWJsZSBlbGVtZW50IHRvIGEgY2hpbGQgZWxlbWVudAogICAqCiAgICogQHBhcmFtIEVsZW1lbnQgcGFyZW50CiAgICogQHBhcmFtIEVsZW1lbnQgZWxlbWVudAogICAqIEByZXR1cm4gTnVsbAogICAqLwoKCiAgZnVuY3Rpb24gc2Nyb2xsUGFyZW50VG9FbGVtZW50KHBhcmVudCwgX3JlZikgewogICAgdmFyIG9mZnNldFRvcCA9IF9yZWYub2Zmc2V0VG9wOwogICAgcGFyZW50LnNjcm9sbFRvcCA9IG9mZnNldFRvcCAtIHBhcmVudC5vZmZzZXRUb3A7CiAgfQogIC8qKgogICAqIEZpbmQgdGhlIG5lYXJlc3Qgc2Nyb2xsYWJsZSBwYXJlbnQKICAgKiBjb3BpZWQgZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zNTkzOTg4Ni9maW5kLWZpcnN0LXNjcm9sbGFibGUtcGFyZW50CiAgICoKICAgKiBAcGFyYW0gRWxlbWVudCBlbGVtZW50CiAgICogQHJldHVybiBFbGVtZW50CiAgICovCgoKICBmdW5jdGlvbiBnZXRTY3JvbGxQYXJlbnQoZWxlbWVudCkgewogICAgdmFyIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7CiAgICB2YXIgZXhjbHVkZVN0YXRpY1BhcmVudCA9IHN0eWxlLnBvc2l0aW9uID09PSAiYWJzb2x1dGUiOwogICAgdmFyIG92ZXJmbG93UmVnZXggPSAvKGF1dG98c2Nyb2xsKS87CiAgICBpZiAoc3R5bGUucG9zaXRpb24gPT09ICJmaXhlZCIpIHJldHVybiBkb2N1bWVudC5ib2R5OwoKICAgIGZvciAodmFyIHBhcmVudCA9IGVsZW1lbnQ7IHBhcmVudCA9IHBhcmVudC5wYXJlbnRFbGVtZW50OykgewogICAgICBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHBhcmVudCk7CgogICAgICBpZiAoZXhjbHVkZVN0YXRpY1BhcmVudCAmJiBzdHlsZS5wb3NpdGlvbiA9PT0gInN0YXRpYyIpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYgKG92ZXJmbG93UmVnZXgudGVzdChzdHlsZS5vdmVyZmxvdyArIHN0eWxlLm92ZXJmbG93WSArIHN0eWxlLm92ZXJmbG93WCkpIHJldHVybiBwYXJlbnQ7CiAgICB9CgogICAgcmV0dXJuIGRvY3VtZW50LmJvZHk7CiAgfQogIC8qKgogICAqIFByb3ZpZGVzIGEgY3Jvc3MtYnJvd3NlciB3YXkgdG8gZ2V0IHRoZSBzY3JlZW4gZGltZW5zaW9ucwogICAqIHZpYTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy81ODY0NDY3L2ludGVybmV0LWV4cGxvcmVyLWlubmVyaGVpZ2h0CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9nZXRXaW5TaXplCiAgICogQHJldHVybnMge09iamVjdH0gd2lkdGggYW5kIGhlaWdodCBhdHRyaWJ1dGVzCiAgICovCgoKICBmdW5jdGlvbiBnZXRXaW5TaXplKCkgewogICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGgsCiAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBEID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwogICAgICByZXR1cm4gewogICAgICAgIHdpZHRoOiBELmNsaWVudFdpZHRoLAogICAgICAgIGhlaWdodDogRC5jbGllbnRIZWlnaHQKICAgICAgfTsKICAgIH0KICB9CiAgLyoqCiAgICogQ2hlY2sgdG8gc2VlIGlmIHRoZSBlbGVtZW50IGlzIGluIHRoZSB2aWV3cG9ydCBvciBub3QKICAgKiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyMzk5OS9ob3ctdG8tdGVsbC1pZi1hLWRvbS1lbGVtZW50LWlzLXZpc2libGUtaW4tdGhlLWN1cnJlbnQtdmlld3BvcnQKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2VsZW1lbnRJblZpZXdwb3J0CiAgICogQHBhcmFtIHtPYmplY3R9IGVsCiAgICovCgoKICBmdW5jdGlvbiBlbGVtZW50SW5WaWV3cG9ydChlbCkgewogICAgdmFyIHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIHJldHVybiByZWN0LnRvcCA+PSAwICYmIHJlY3QubGVmdCA+PSAwICYmIHJlY3QuYm90dG9tICsgODAgPD0gd2luZG93LmlubmVySGVpZ2h0ICYmIC8vIGFkZCA4MCB0byBnZXQgdGhlIHRleHQgcmlnaHQKICAgIHJlY3QucmlnaHQgPD0gd2luZG93LmlubmVyV2lkdGg7CiAgfQogIC8qKgogICAqIFRvIGNoYW5nZSB0aGUgc2Nyb2xsIG9mIGB3aW5kb3dgIGFmdGVyIGhpZ2hsaWdodGluZyBhbiBlbGVtZW50CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9zY3JvbGxUbwogICAqIEBwYXJhbSB7U3RyaW5nfSBzY3JvbGxUbwogICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRFbGVtZW50CiAgICogQHBhcmFtIHtPYmplY3R9IHRvb2x0aXBMYXllcgogICAqLwoKCiAgZnVuY3Rpb24gc2Nyb2xsVG8oc2Nyb2xsVG8sIF9yZWYsIHRvb2x0aXBMYXllcikgewogICAgdmFyIGVsZW1lbnQgPSBfcmVmLmVsZW1lbnQ7CiAgICBpZiAoc2Nyb2xsVG8gPT09ICJvZmYiKSByZXR1cm47CiAgICB2YXIgcmVjdDsKICAgIGlmICghdGhpcy5fb3B0aW9ucy5zY3JvbGxUb0VsZW1lbnQpIHJldHVybjsKCiAgICBpZiAoc2Nyb2xsVG8gPT09ICJ0b29sdGlwIikgewogICAgICByZWN0ID0gdG9vbHRpcExheWVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgfSBlbHNlIHsKICAgICAgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICB9CgogICAgaWYgKCFlbGVtZW50SW5WaWV3cG9ydChlbGVtZW50KSkgewogICAgICB2YXIgd2luSGVpZ2h0ID0gZ2V0V2luU2l6ZSgpLmhlaWdodDsKICAgICAgdmFyIHRvcCA9IHJlY3QuYm90dG9tIC0gKHJlY3QuYm90dG9tIC0gcmVjdC50b3ApOyAvLyBUT0RPIChhZnNoaW5tKTogZG8gd2UgbmVlZCBzY3JvbGwgcGFkZGluZyBub3c/CiAgICAgIC8vIEkgaGF2ZSBjaGFuZ2VkIHRoZSBzY3JvbGwgb3B0aW9uIGFuZCBub3cgaXQgc2Nyb2xscyB0aGUgd2luZG93IHRvCiAgICAgIC8vIHRoZSBjZW50ZXIgb2YgdGhlIHRhcmdldCBlbGVtZW50IG9yIHRvb2x0aXAuCgogICAgICBpZiAodG9wIDwgMCB8fCBlbGVtZW50LmNsaWVudEhlaWdodCA+IHdpbkhlaWdodCkgewogICAgICAgIHdpbmRvdy5zY3JvbGxCeSgwLCByZWN0LnRvcCAtICh3aW5IZWlnaHQgLyAyIC0gcmVjdC5oZWlnaHQgLyAyKSAtIHRoaXMuX29wdGlvbnMuc2Nyb2xsUGFkZGluZyk7IC8vIDMwcHggcGFkZGluZyBmcm9tIGVkZ2UgdG8gbG9vayBuaWNlCiAgICAgICAgLy9TY3JvbGwgZG93bgogICAgICB9IGVsc2UgewogICAgICAgIHdpbmRvdy5zY3JvbGxCeSgwLCByZWN0LnRvcCAtICh3aW5IZWlnaHQgLyAyIC0gcmVjdC5oZWlnaHQgLyAyKSArIHRoaXMuX29wdGlvbnMuc2Nyb2xsUGFkZGluZyk7IC8vIDMwcHggcGFkZGluZyBmcm9tIGVkZ2UgdG8gbG9vayBuaWNlCiAgICAgIH0KICAgIH0KICB9CiAgLyoqCiAgICogU2V0dGluZyBhbmNob3JzIHRvIGJlaGF2ZSBsaWtlIGJ1dHRvbnMKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3NldEFuY2hvckFzQnV0dG9uCiAgICovCgoKICBmdW5jdGlvbiBzZXRBbmNob3JBc0J1dHRvbihhbmNob3IpIHsKICAgIGFuY2hvci5zZXRBdHRyaWJ1dGUoInJvbGUiLCAiYnV0dG9uIik7CiAgICBhbmNob3IudGFiSW5kZXggPSAwOwogIH0KICAvKioKICAgKiBHZXQgYW4gZWxlbWVudCBwb3NpdGlvbiBvbiB0aGUgcGFnZQogICAqIFRoYW5rcyB0byBgbWVvdXdgOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80NDI0NzQvMzc1OTY2CiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9nZXRPZmZzZXQKICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudAogICAqIEByZXR1cm5zIEVsZW1lbnQncyBwb3NpdGlvbiBpbmZvCiAgICovCgoKICBmdW5jdGlvbiBnZXRPZmZzZXQoZWxlbWVudCkgewogICAgdmFyIGJvZHkgPSBkb2N1bWVudC5ib2R5OwogICAgdmFyIGRvY0VsID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwogICAgdmFyIHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2NFbC5zY3JvbGxUb3AgfHwgYm9keS5zY3JvbGxUb3A7CiAgICB2YXIgc2Nyb2xsTGVmdCA9IHdpbmRvdy5wYWdlWE9mZnNldCB8fCBkb2NFbC5zY3JvbGxMZWZ0IHx8IGJvZHkuc2Nyb2xsTGVmdDsKICAgIHZhciB4ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIHJldHVybiB7CiAgICAgIHRvcDogeC50b3AgKyBzY3JvbGxUb3AsCiAgICAgIHdpZHRoOiB4LndpZHRoLAogICAgICBoZWlnaHQ6IHguaGVpZ2h0LAogICAgICBsZWZ0OiB4LmxlZnQgKyBzY3JvbGxMZWZ0CiAgICB9OwogIH0KICAvKioKICAgKiBDaGVja3MgdG8gc2VlIGlmIHRhcmdldCBlbGVtZW50IChvciBwYXJlbnRzKSBwb3NpdGlvbiBpcyBmaXhlZCBvciBub3QKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2lzRml4ZWQKICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudAogICAqIEByZXR1cm5zIEJvb2xlYW4KICAgKi8KCgogIGZ1bmN0aW9uIGlzRml4ZWQoZWxlbWVudCkgewogICAgdmFyIHAgPSBlbGVtZW50LnBhcmVudE5vZGU7CgogICAgaWYgKCFwIHx8IHAubm9kZU5hbWUgPT09ICJIVE1MIikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKGdldFByb3BWYWx1ZShlbGVtZW50LCAicG9zaXRpb24iKSA9PT0gImZpeGVkIikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gaXNGaXhlZChwKTsKICB9CiAgLyoqCiAgICogVXBkYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgaGVscGVyIGxheWVyIG9uIHRoZSBzY3JlZW4KICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3NldEhlbHBlckxheWVyUG9zaXRpb24KICAgKiBAcGFyYW0ge09iamVjdH0gaGVscGVyTGF5ZXIKICAgKi8KCgogIGZ1bmN0aW9uIHNldEhlbHBlckxheWVyUG9zaXRpb24oaGVscGVyTGF5ZXIpIHsKICAgIGlmIChoZWxwZXJMYXllcikgewogICAgICAvL3ByZXZlbnQgZXJyb3Igd2hlbiBgdGhpcy5fY3VycmVudFN0ZXBgIGluIHVuZGVmaW5lZAogICAgICBpZiAoIXRoaXMuX2ludHJvSXRlbXNbdGhpcy5fY3VycmVudFN0ZXBdKSByZXR1cm47CiAgICAgIHZhciBjdXJyZW50RWxlbWVudCA9IHRoaXMuX2ludHJvSXRlbXNbdGhpcy5fY3VycmVudFN0ZXBdOwogICAgICB2YXIgZWxlbWVudFBvc2l0aW9uID0gZ2V0T2Zmc2V0KGN1cnJlbnRFbGVtZW50LmVsZW1lbnQpOwogICAgICB2YXIgd2lkdGhIZWlnaHRQYWRkaW5nID0gdGhpcy5fb3B0aW9ucy5oZWxwZXJFbGVtZW50UGFkZGluZzsgLy8gSWYgdGhlIHRhcmdldCBlbGVtZW50IGlzIGZpeGVkLCB0aGUgdG9vbHRpcCBzaG91bGQgYmUgZml4ZWQgYXMgd2VsbC4KICAgICAgLy8gT3RoZXJ3aXNlLCByZW1vdmUgYSBmaXhlZCBjbGFzcyB0aGF0IG1heSBiZSBsZWZ0IG92ZXIgZnJvbSB0aGUgcHJldmlvdXMKICAgICAgLy8gc3RlcC4KCiAgICAgIGlmIChpc0ZpeGVkKGN1cnJlbnRFbGVtZW50LmVsZW1lbnQpKSB7CiAgICAgICAgYWRkQ2xhc3MoaGVscGVyTGF5ZXIsICJpbnRyb2pzLWZpeGVkVG9vbHRpcCIpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlbW92ZUNsYXNzKGhlbHBlckxheWVyLCAiaW50cm9qcy1maXhlZFRvb2x0aXAiKTsKICAgICAgfQoKICAgICAgaWYgKGN1cnJlbnRFbGVtZW50LnBvc2l0aW9uID09PSAiZmxvYXRpbmciKSB7CiAgICAgICAgd2lkdGhIZWlnaHRQYWRkaW5nID0gMDsKICAgICAgfSAvL3NldCBuZXcgcG9zaXRpb24gdG8gaGVscGVyIGxheWVyCgoKICAgICAgaGVscGVyTGF5ZXIuc3R5bGUuY3NzVGV4dCA9ICJ3aWR0aDogIi5jb25jYXQoZWxlbWVudFBvc2l0aW9uLndpZHRoICsgd2lkdGhIZWlnaHRQYWRkaW5nLCAicHg7IGhlaWdodDoiKS5jb25jYXQoZWxlbWVudFBvc2l0aW9uLmhlaWdodCArIHdpZHRoSGVpZ2h0UGFkZGluZywgInB4OyB0b3A6IikuY29uY2F0KGVsZW1lbnRQb3NpdGlvbi50b3AgLSB3aWR0aEhlaWdodFBhZGRpbmcgLyAyLCAicHg7bGVmdDogIikuY29uY2F0KGVsZW1lbnRQb3NpdGlvbi5sZWZ0IC0gd2lkdGhIZWlnaHRQYWRkaW5nIC8gMiwgInB4OyIpOwogICAgfQogIH0KICAvKioKICAgKiBTZXQgdG9vbHRpcCBsZWZ0IHNvIGl0IGRvZXNuJ3QgZ28gb2ZmIHRoZSByaWdodCBzaWRlIG9mIHRoZSB3aW5kb3cKICAgKgogICAqIEByZXR1cm4gYm9vbGVhbiB0cnVlLCBpZiB0b29sdGlwTGF5ZXJTdHlsZUxlZnQgaXMgb2suICBmYWxzZSwgb3RoZXJ3aXNlLgogICAqLwoKCiAgZnVuY3Rpb24gY2hlY2tSaWdodCh0YXJnZXRPZmZzZXQsIHRvb2x0aXBMYXllclN0eWxlTGVmdCwgdG9vbHRpcE9mZnNldCwgd2luZG93U2l6ZSwgdG9vbHRpcExheWVyKSB7CiAgICBpZiAodGFyZ2V0T2Zmc2V0LmxlZnQgKyB0b29sdGlwTGF5ZXJTdHlsZUxlZnQgKyB0b29sdGlwT2Zmc2V0LndpZHRoID4gd2luZG93U2l6ZS53aWR0aCkgewogICAgICAvLyBvZmYgdGhlIHJpZ2h0IHNpZGUgb2YgdGhlIHdpbmRvdwogICAgICB0b29sdGlwTGF5ZXIubGVmdCA9ICIiLmNvbmNhdCh3aW5kb3dTaXplLndpZHRoIC0gdG9vbHRpcE9mZnNldC53aWR0aCAtIHRhcmdldE9mZnNldC5sZWZ0LCAicHgiKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHRvb2x0aXBMYXllci5sZWZ0ID0gIiIuY29uY2F0KHRvb2x0aXBMYXllclN0eWxlTGVmdCwgInB4Iik7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgLyoqCiAgICogU2V0IHRvb2x0aXAgcmlnaHQgc28gaXQgZG9lc24ndCBnbyBvZmYgdGhlIGxlZnQgc2lkZSBvZiB0aGUgd2luZG93CiAgICoKICAgKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSwgaWYgdG9vbHRpcExheWVyU3R5bGVSaWdodCBpcyBvay4gIGZhbHNlLCBvdGhlcndpc2UuCiAgICovCgoKICBmdW5jdGlvbiBjaGVja0xlZnQodGFyZ2V0T2Zmc2V0LCB0b29sdGlwTGF5ZXJTdHlsZVJpZ2h0LCB0b29sdGlwT2Zmc2V0LCB0b29sdGlwTGF5ZXIpIHsKICAgIGlmICh0YXJnZXRPZmZzZXQubGVmdCArIHRhcmdldE9mZnNldC53aWR0aCAtIHRvb2x0aXBMYXllclN0eWxlUmlnaHQgLSB0b29sdGlwT2Zmc2V0LndpZHRoIDwgMCkgewogICAgICAvLyBvZmYgdGhlIGxlZnQgc2lkZSBvZiB0aGUgd2luZG93CiAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5sZWZ0ID0gIiIuY29uY2F0KC10YXJnZXRPZmZzZXQubGVmdCwgInB4Iik7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICB0b29sdGlwTGF5ZXIuc3R5bGUucmlnaHQgPSAiIi5jb25jYXQodG9vbHRpcExheWVyU3R5bGVSaWdodCwgInB4Iik7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgLyoqCiAgICogUmVtb3ZlIGFuIGVudHJ5IGZyb20gYSBzdHJpbmcgYXJyYXkgaWYgaXQncyB0aGVyZSwgZG9lcyBub3RoaW5nIGlmIGl0IGlzbid0IHRoZXJlLgogICAqCiAgICogQHBhcmFtIHtBcnJheX0gc3RyaW5nQXJyYXkKICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyaW5nVG9SZW1vdmUKICAgKi8KCgogIGZ1bmN0aW9uIHJlbW92ZUVudHJ5KHN0cmluZ0FycmF5LCBzdHJpbmdUb1JlbW92ZSkgewogICAgaWYgKHN0cmluZ0FycmF5LmluY2x1ZGVzKHN0cmluZ1RvUmVtb3ZlKSkgewogICAgICBzdHJpbmdBcnJheS5zcGxpY2Uoc3RyaW5nQXJyYXkuaW5kZXhPZihzdHJpbmdUb1JlbW92ZSksIDEpOwogICAgfQogIH0KICAvKioKICAgKiBhdXRvLWRldGVybWluZSBhbGlnbm1lbnQKICAgKiBAcGFyYW0ge0ludGVnZXJ9ICBvZmZzZXRMZWZ0CiAgICogQHBhcmFtIHtJbnRlZ2VyfSAgdG9vbHRpcFdpZHRoCiAgICogQHBhcmFtIHtPYmplY3R9ICAgd2luZG93U2l6ZQogICAqIEBwYXJhbSB7U3RyaW5nfSAgIGRlc2lyZWRBbGlnbm1lbnQKICAgKiBAcmV0dXJuIHtTdHJpbmd9ICBjYWxjdWxhdGVkQWxpZ25tZW50CiAgICovCgoKICBmdW5jdGlvbiBfZGV0ZXJtaW5lQXV0b0FsaWdubWVudChvZmZzZXRMZWZ0LCB0b29sdGlwV2lkdGgsIF9yZWYsIGRlc2lyZWRBbGlnbm1lbnQpIHsKICAgIHZhciB3aWR0aCA9IF9yZWYud2lkdGg7CiAgICB2YXIgaGFsZlRvb2x0aXBXaWR0aCA9IHRvb2x0aXBXaWR0aCAvIDI7CiAgICB2YXIgd2luV2lkdGggPSBNYXRoLm1pbih3aWR0aCwgd2luZG93LnNjcmVlbi53aWR0aCk7CiAgICB2YXIgcG9zc2libGVBbGlnbm1lbnRzID0gWyItbGVmdC1hbGlnbmVkIiwgIi1taWRkbGUtYWxpZ25lZCIsICItcmlnaHQtYWxpZ25lZCJdOwogICAgdmFyIGNhbGN1bGF0ZWRBbGlnbm1lbnQgPSAiIjsgLy8gdmFsaWQgbGVmdCBtdXN0IGJlIGF0IGxlYXN0IGEgdG9vbHRpcFdpZHRoCiAgICAvLyBhd2F5IGZyb20gcmlnaHQgc2lkZQoKICAgIGlmICh3aW5XaWR0aCAtIG9mZnNldExlZnQgPCB0b29sdGlwV2lkdGgpIHsKICAgICAgcmVtb3ZlRW50cnkocG9zc2libGVBbGlnbm1lbnRzLCAiLWxlZnQtYWxpZ25lZCIpOwogICAgfSAvLyB2YWxpZCBtaWRkbGUgbXVzdCBiZSBhdCBsZWFzdCBoYWxmCiAgICAvLyB3aWR0aCBhd2F5IGZyb20gYm90aCBzaWRlcwoKCiAgICBpZiAob2Zmc2V0TGVmdCA8IGhhbGZUb29sdGlwV2lkdGggfHwgd2luV2lkdGggLSBvZmZzZXRMZWZ0IDwgaGFsZlRvb2x0aXBXaWR0aCkgewogICAgICByZW1vdmVFbnRyeShwb3NzaWJsZUFsaWdubWVudHMsICItbWlkZGxlLWFsaWduZWQiKTsKICAgIH0gLy8gdmFsaWQgcmlnaHQgbXVzdCBiZSBhdCBsZWFzdCBhIHRvb2x0aXBXaWR0aAogICAgLy8gd2lkdGggYXdheSBmcm9tIGxlZnQgc2lkZQoKCiAgICBpZiAob2Zmc2V0TGVmdCA8IHRvb2x0aXBXaWR0aCkgewogICAgICByZW1vdmVFbnRyeShwb3NzaWJsZUFsaWdubWVudHMsICItcmlnaHQtYWxpZ25lZCIpOwogICAgfQoKICAgIGlmIChwb3NzaWJsZUFsaWdubWVudHMubGVuZ3RoKSB7CiAgICAgIGlmIChwb3NzaWJsZUFsaWdubWVudHMuaW5jbHVkZXMoZGVzaXJlZEFsaWdubWVudCkpIHsKICAgICAgICAvLyB0aGUgZGVzaXJlZCBhbGlnbm1lbnQgaXMgdmFsaWQKICAgICAgICBjYWxjdWxhdGVkQWxpZ25tZW50ID0gZGVzaXJlZEFsaWdubWVudDsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBwaWNrIHRoZSBmaXJzdCB2YWxpZCBwb3NpdGlvbiwgaW4gb3JkZXIKICAgICAgICBjYWxjdWxhdGVkQWxpZ25tZW50ID0gcG9zc2libGVBbGlnbm1lbnRzWzBdOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBpZiBzY3JlZW4gd2lkdGggaXMgdG9vIHNtYWxsCiAgICAgIC8vIGZvciBBTlkgYWxpZ25tZW50LCBtaWRkbGUgaXMKICAgICAgLy8gcHJvYmFibHkgdGhlIGJlc3QgZm9yIHZpc2liaWxpdHkKICAgICAgY2FsY3VsYXRlZEFsaWdubWVudCA9ICItbWlkZGxlLWFsaWduZWQiOwogICAgfQoKICAgIHJldHVybiBjYWxjdWxhdGVkQWxpZ25tZW50OwogIH0KICAvKioKICAgKiBEZXRlcm1pbmVzIHRoZSBwb3NpdGlvbiBvZiB0aGUgdG9vbHRpcCBiYXNlZCBvbiB0aGUgcG9zaXRpb24gcHJlY2VkZW5jZSBhbmQgYXZhaWxhYmlsaXR5CiAgICogb2Ygc2NyZWVuIHNwYWNlLgogICAqCiAgICogQHBhcmFtIHtPYmplY3R9ICAgIHRhcmdldEVsZW1lbnQKICAgKiBAcGFyYW0ge09iamVjdH0gICAgdG9vbHRpcExheWVyCiAgICogQHBhcmFtIHtTdHJpbmd9ICAgIGRlc2lyZWRUb29sdGlwUG9zaXRpb24KICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgY2FsY3VsYXRlZFBvc2l0aW9uCiAgICovCgoKICBmdW5jdGlvbiBfZGV0ZXJtaW5lQXV0b1Bvc2l0aW9uKHRhcmdldEVsZW1lbnQsIHRvb2x0aXBMYXllciwgZGVzaXJlZFRvb2x0aXBQb3NpdGlvbikgewogICAgLy8gVGFrZSBhIGNsb25lIG9mIHBvc2l0aW9uIHByZWNlZGVuY2UuIFRoZXNlIHdpbGwgYmUgdGhlIGF2YWlsYWJsZQogICAgdmFyIHBvc3NpYmxlUG9zaXRpb25zID0gdGhpcy5fb3B0aW9ucy5wb3NpdGlvblByZWNlZGVuY2Uuc2xpY2UoKTsKCiAgICB2YXIgd2luZG93U2l6ZSA9IGdldFdpblNpemUoKTsKICAgIHZhciB0b29sdGlwSGVpZ2h0ID0gZ2V0T2Zmc2V0KHRvb2x0aXBMYXllcikuaGVpZ2h0ICsgMTA7CiAgICB2YXIgdG9vbHRpcFdpZHRoID0gZ2V0T2Zmc2V0KHRvb2x0aXBMYXllcikud2lkdGggKyAyMDsKICAgIHZhciB0YXJnZXRFbGVtZW50UmVjdCA9IHRhcmdldEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7IC8vIElmIHdlIGNoZWNrIGFsbCB0aGUgcG9zc2libGUgYXJlYXMsIGFuZCB0aGVyZSBhcmUgbm8gdmFsaWQgcGxhY2VzIGZvciB0aGUgdG9vbHRpcCwgdGhlIGVsZW1lbnQKICAgIC8vIG11c3QgdGFrZSB1cCBtb3N0IG9mIHRoZSBzY3JlZW4gcmVhbCBlc3RhdGUuIFNob3cgdGhlIHRvb2x0aXAgZmxvYXRpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgc2NyZWVuLgoKICAgIHZhciBjYWxjdWxhdGVkUG9zaXRpb24gPSAiZmxvYXRpbmciOwogICAgLyoKICAgICAqIGF1dG8gZGV0ZXJtaW5lIHBvc2l0aW9uCiAgICAgKi8KICAgIC8vIENoZWNrIGZvciBzcGFjZSBiZWxvdwoKICAgIGlmICh0YXJnZXRFbGVtZW50UmVjdC5ib3R0b20gKyB0b29sdGlwSGVpZ2h0ID4gd2luZG93U2l6ZS5oZWlnaHQpIHsKICAgICAgcmVtb3ZlRW50cnkocG9zc2libGVQb3NpdGlvbnMsICJib3R0b20iKTsKICAgIH0gLy8gQ2hlY2sgZm9yIHNwYWNlIGFib3ZlCgoKICAgIGlmICh0YXJnZXRFbGVtZW50UmVjdC50b3AgLSB0b29sdGlwSGVpZ2h0IDwgMCkgewogICAgICByZW1vdmVFbnRyeShwb3NzaWJsZVBvc2l0aW9ucywgInRvcCIpOwogICAgfSAvLyBDaGVjayBmb3Igc3BhY2UgdG8gdGhlIHJpZ2h0CgoKICAgIGlmICh0YXJnZXRFbGVtZW50UmVjdC5yaWdodCArIHRvb2x0aXBXaWR0aCA+IHdpbmRvd1NpemUud2lkdGgpIHsKICAgICAgcmVtb3ZlRW50cnkocG9zc2libGVQb3NpdGlvbnMsICJyaWdodCIpOwogICAgfSAvLyBDaGVjayBmb3Igc3BhY2UgdG8gdGhlIGxlZnQKCgogICAgaWYgKHRhcmdldEVsZW1lbnRSZWN0LmxlZnQgLSB0b29sdGlwV2lkdGggPCAwKSB7CiAgICAgIHJlbW92ZUVudHJ5KHBvc3NpYmxlUG9zaXRpb25zLCAibGVmdCIpOwogICAgfSAvLyBAdmFyIHtTdHJpbmd9ICBleDogJ3JpZ2h0LWFsaWduZWQnCgoKICAgIHZhciBkZXNpcmVkQWxpZ25tZW50ID0gZnVuY3Rpb24gKHBvcykgewogICAgICB2YXIgaHlwaGVuSW5kZXggPSBwb3MuaW5kZXhPZigiLSIpOwoKICAgICAgaWYgKGh5cGhlbkluZGV4ICE9PSAtMSkgewogICAgICAgIC8vIGhhcyBhbGlnbm1lbnQKICAgICAgICByZXR1cm4gcG9zLnN1YnN0cihoeXBoZW5JbmRleCk7CiAgICAgIH0KCiAgICAgIHJldHVybiAiIjsKICAgIH0oZGVzaXJlZFRvb2x0aXBQb3NpdGlvbiB8fCAiIik7IC8vIHN0cmlwIGFsaWdubWVudCBmcm9tIHBvc2l0aW9uCgoKICAgIGlmIChkZXNpcmVkVG9vbHRpcFBvc2l0aW9uKSB7CiAgICAgIC8vIGV4OiAiYm90dG9tLXJpZ2h0LWFsaWduZWQiCiAgICAgIC8vIHNob3VsZCByZXR1cm4gJ2JvdHRvbScKICAgICAgZGVzaXJlZFRvb2x0aXBQb3NpdGlvbiA9IGRlc2lyZWRUb29sdGlwUG9zaXRpb24uc3BsaXQoIi0iKVswXTsKICAgIH0KCiAgICBpZiAocG9zc2libGVQb3NpdGlvbnMubGVuZ3RoKSB7CiAgICAgIGlmIChkZXNpcmVkVG9vbHRpcFBvc2l0aW9uICE9PSAiYXV0byIgJiYgcG9zc2libGVQb3NpdGlvbnMuaW5jbHVkZXMoZGVzaXJlZFRvb2x0aXBQb3NpdGlvbikpIHsKICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdGVkIHBvc2l0aW9uIGlzIGluIHRoZSBsaXN0LCBjaG9vc2UgdGhhdAogICAgICAgIGNhbGN1bGF0ZWRQb3NpdGlvbiA9IGRlc2lyZWRUb29sdGlwUG9zaXRpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gUGljayB0aGUgZmlyc3QgdmFsaWQgcG9zaXRpb24sIGluIG9yZGVyCiAgICAgICAgY2FsY3VsYXRlZFBvc2l0aW9uID0gcG9zc2libGVQb3NpdGlvbnNbMF07CiAgICAgIH0KICAgIH0gLy8gb25seSB0b3AgYW5kIGJvdHRvbSBwb3NpdGlvbnMgaGF2ZSBvcHRpb25hbCBhbGlnbm1lbnRzCgoKICAgIGlmIChbInRvcCIsICJib3R0b20iXS5pbmNsdWRlcyhjYWxjdWxhdGVkUG9zaXRpb24pKSB7CiAgICAgIGNhbGN1bGF0ZWRQb3NpdGlvbiArPSBfZGV0ZXJtaW5lQXV0b0FsaWdubWVudCh0YXJnZXRFbGVtZW50UmVjdC5sZWZ0LCB0b29sdGlwV2lkdGgsIHdpbmRvd1NpemUsIGRlc2lyZWRBbGlnbm1lbnQpOwogICAgfQoKICAgIHJldHVybiBjYWxjdWxhdGVkUG9zaXRpb247CiAgfQogIC8qKgogICAqIFJlbmRlciB0b29sdGlwIGJveCBpbiB0aGUgcGFnZQogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBwbGFjZVRvb2x0aXAKICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXRFbGVtZW50CiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdG9vbHRpcExheWVyCiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gYXJyb3dMYXllcgogICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGhlbHBlck51bWJlckxheWVyCiAgICogQHBhcmFtIHtCb29sZWFufSBoaW50TW9kZQogICAqLwoKCiAgZnVuY3Rpb24gcGxhY2VUb29sdGlwKHRhcmdldEVsZW1lbnQsIHRvb2x0aXBMYXllciwgYXJyb3dMYXllciwgaGVscGVyTnVtYmVyTGF5ZXIsIGhpbnRNb2RlKSB7CiAgICB2YXIgdG9vbHRpcENzc0NsYXNzID0gIiI7CiAgICB2YXIgY3VycmVudFN0ZXBPYmo7CiAgICB2YXIgdG9vbHRpcE9mZnNldDsKICAgIHZhciB0YXJnZXRPZmZzZXQ7CiAgICB2YXIgd2luZG93U2l6ZTsKICAgIHZhciBjdXJyZW50VG9vbHRpcFBvc2l0aW9uOwogICAgaGludE1vZGUgPSBoaW50TW9kZSB8fCBmYWxzZTsgLy9yZXNldCB0aGUgb2xkIHN0eWxlCgogICAgdG9vbHRpcExheWVyLnN0eWxlLnRvcCA9IG51bGw7CiAgICB0b29sdGlwTGF5ZXIuc3R5bGUucmlnaHQgPSBudWxsOwogICAgdG9vbHRpcExheWVyLnN0eWxlLmJvdHRvbSA9IG51bGw7CiAgICB0b29sdGlwTGF5ZXIuc3R5bGUubGVmdCA9IG51bGw7CiAgICB0b29sdGlwTGF5ZXIuc3R5bGUubWFyZ2luTGVmdCA9IG51bGw7CiAgICB0b29sdGlwTGF5ZXIuc3R5bGUubWFyZ2luVG9wID0gbnVsbDsKICAgIGFycm93TGF5ZXIuc3R5bGUuZGlzcGxheSA9ICJpbmhlcml0IjsKCiAgICBpZiAodHlwZW9mIGhlbHBlck51bWJlckxheWVyICE9PSAidW5kZWZpbmVkIiAmJiBoZWxwZXJOdW1iZXJMYXllciAhPT0gbnVsbCkgewogICAgICBoZWxwZXJOdW1iZXJMYXllci5zdHlsZS50b3AgPSBudWxsOwogICAgICBoZWxwZXJOdW1iZXJMYXllci5zdHlsZS5sZWZ0ID0gbnVsbDsKICAgIH0gLy9wcmV2ZW50IGVycm9yIHdoZW4gYHRoaXMuX2N1cnJlbnRTdGVwYCBpcyB1bmRlZmluZWQKCgogICAgaWYgKCF0aGlzLl9pbnRyb0l0ZW1zW3RoaXMuX2N1cnJlbnRTdGVwXSkgcmV0dXJuOyAvL2lmIHdlIGhhdmUgYSBjdXN0b20gY3NzIGNsYXNzIGZvciBlYWNoIHN0ZXAKCiAgICBjdXJyZW50U3RlcE9iaiA9IHRoaXMuX2ludHJvSXRlbXNbdGhpcy5fY3VycmVudFN0ZXBdOwoKICAgIGlmICh0eXBlb2YgY3VycmVudFN0ZXBPYmoudG9vbHRpcENsYXNzID09PSAic3RyaW5nIikgewogICAgICB0b29sdGlwQ3NzQ2xhc3MgPSBjdXJyZW50U3RlcE9iai50b29sdGlwQ2xhc3M7CiAgICB9IGVsc2UgewogICAgICB0b29sdGlwQ3NzQ2xhc3MgPSB0aGlzLl9vcHRpb25zLnRvb2x0aXBDbGFzczsKICAgIH0KCiAgICB0b29sdGlwTGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtdG9vbHRpcCAiLmNvbmNhdCh0b29sdGlwQ3NzQ2xhc3MpLnJlcGxhY2UoL15ccyt8XHMrJC9nLCAiIik7CiAgICB0b29sdGlwTGF5ZXIuc2V0QXR0cmlidXRlKCJyb2xlIiwgImRpYWxvZyIpOwogICAgY3VycmVudFRvb2x0aXBQb3NpdGlvbiA9IHRoaXMuX2ludHJvSXRlbXNbdGhpcy5fY3VycmVudFN0ZXBdLnBvc2l0aW9uOyAvLyBGbG9hdGluZyBpcyBhbHdheXMgdmFsaWQsIG5vIHBvaW50IGluIGNhbGN1bGF0aW5nCgogICAgaWYgKGN1cnJlbnRUb29sdGlwUG9zaXRpb24gIT09ICJmbG9hdGluZyIpIHsvLyBjdXJyZW50VG9vbHRpcFBvc2l0aW9uID0gX2RldGVybWluZUF1dG9Qb3NpdGlvbi5jYWxsKHRoaXMsIHRhcmdldEVsZW1lbnQsIHRvb2x0aXBMYXllciwgY3VycmVudFRvb2x0aXBQb3NpdGlvbik7CiAgICB9CgogICAgdmFyIHRvb2x0aXBMYXllclN0eWxlTGVmdDsKICAgIHRhcmdldE9mZnNldCA9IGdldE9mZnNldCh0YXJnZXRFbGVtZW50KTsKICAgIHRvb2x0aXBPZmZzZXQgPSBnZXRPZmZzZXQodG9vbHRpcExheWVyKTsKICAgIHdpbmRvd1NpemUgPSBnZXRXaW5TaXplKCk7CiAgICBhZGRDbGFzcyh0b29sdGlwTGF5ZXIsICJpbnRyb2pzLSIuY29uY2F0KGN1cnJlbnRUb29sdGlwUG9zaXRpb24pKTsKCiAgICBzd2l0Y2ggKGN1cnJlbnRUb29sdGlwUG9zaXRpb24pIHsKICAgICAgY2FzZSAidG9wLXJpZ2h0LWFsaWduZWQiOgogICAgICAgIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3cgYm90dG9tLXJpZ2h0IjsKICAgICAgICB2YXIgdG9vbHRpcExheWVyU3R5bGVSaWdodCA9IDA7CiAgICAgICAgY2hlY2tMZWZ0KHRhcmdldE9mZnNldCwgdG9vbHRpcExheWVyU3R5bGVSaWdodCwgdG9vbHRpcE9mZnNldCwgdG9vbHRpcExheWVyKTsKICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUuYm90dG9tID0gIiIuY29uY2F0KHRhcmdldE9mZnNldC5oZWlnaHQgKyAyMCwgInB4Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJ0b3AtbWlkZGxlLWFsaWduZWQiOgogICAgICAgIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3cgYm90dG9tLW1pZGRsZSI7CiAgICAgICAgdmFyIHRvb2x0aXBMYXllclN0eWxlTGVmdFJpZ2h0ID0gdGFyZ2V0T2Zmc2V0LndpZHRoIC8gMiAtIHRvb2x0aXBPZmZzZXQud2lkdGggLyAyOyAvLyBhIGZpeCBmb3IgbWlkZGxlIGFsaWduZWQgaGludHMKCiAgICAgICAgaWYgKGhpbnRNb2RlKSB7CiAgICAgICAgICB0b29sdGlwTGF5ZXJTdHlsZUxlZnRSaWdodCArPSA1OwogICAgICAgIH0KCiAgICAgICAgaWYgKGNoZWNrTGVmdCh0YXJnZXRPZmZzZXQsIHRvb2x0aXBMYXllclN0eWxlTGVmdFJpZ2h0LCB0b29sdGlwT2Zmc2V0LCB0b29sdGlwTGF5ZXIpKSB7CiAgICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUucmlnaHQgPSBudWxsOwogICAgICAgICAgY2hlY2tSaWdodCh0YXJnZXRPZmZzZXQsIHRvb2x0aXBMYXllclN0eWxlTGVmdFJpZ2h0LCB0b29sdGlwT2Zmc2V0LCB3aW5kb3dTaXplLCB0b29sdGlwTGF5ZXIpOwogICAgICAgIH0KCiAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLmJvdHRvbSA9ICIiLmNvbmNhdCh0YXJnZXRPZmZzZXQuaGVpZ2h0ICsgMjAsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAidG9wLWxlZnQtYWxpZ25lZCI6IC8vIHRvcC1sZWZ0LWFsaWduZWQgaXMgdGhlIHNhbWUgYXMgdGhlIGRlZmF1bHQgdG9wCgogICAgICBjYXNlICJ0b3AiOgogICAgICAgIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3cgYm90dG9tIjsKICAgICAgICB0b29sdGlwTGF5ZXJTdHlsZUxlZnQgPSBoaW50TW9kZSA/IDAgOiAxNTsKICAgICAgICBjaGVja1JpZ2h0KHRhcmdldE9mZnNldCwgdG9vbHRpcExheWVyU3R5bGVMZWZ0LCB0b29sdGlwT2Zmc2V0LCB3aW5kb3dTaXplLCB0b29sdGlwTGF5ZXIpOwogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5ib3R0b20gPSAiIi5jb25jYXQodGFyZ2V0T2Zmc2V0LmhlaWdodCArIDIwLCAicHgiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgInJpZ2h0IjoKICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUubGVmdCA9ICIiLmNvbmNhdCh0YXJnZXRPZmZzZXQud2lkdGggKyAyMCArIDYzLCAicHgiKTsKICAgICAgICB2YXIgaW1hZ2VMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpOwogICAgICAgIGltYWdlTGF5ZXIuc3JjID0gIi9pbWcvR3JvdXAzLnN2ZyI7CiAgICAgICAgdmFyIHBhcmVudF9kaXZfZm9yX2ltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbS1hcnJvdy1pbWFnZS1jZW5zZSIpOwoKICAgICAgICBpZiAodGFyZ2V0T2Zmc2V0LnRvcCArIHRvb2x0aXBPZmZzZXQuaGVpZ2h0ID4gd2luZG93U2l6ZS5oZWlnaHQpIHsKICAgICAgICAgIC8vIEluIHRoaXMgY2FzZSwgcmlnaHQgd291bGQgaGF2ZSBmYWxsZW4gYmVsb3cgdGhlIGJvdHRvbSBvZiB0aGUgc2NyZWVuLgogICAgICAgICAgLy8gTW9kaWZ5IHNvIHRoYXQgdGhlIGJvdHRvbSBvZiB0aGUgdG9vbHRpcCBjb25uZWN0cyB3aXRoIHRoZSB0YXJnZXQKICAgICAgICAgIC8vIGFycm93TGF5ZXIuYXBwZW5kQ2hpbGQoaW1hZ2VMYXllcik7CiAgICAgICAgICAvLyBwYXJlbnRfZGl2X2Zvcl9pbWFnZS5hcHBlbmRDaGlsZChpbWFnZUxheWVyKTsKICAgICAgICAgIHBhcmVudF9kaXZfZm9yX2ltYWdlLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKICAgICAgICAgIHBhcmVudF9kaXZfZm9yX2ltYWdlLnN0eWxlLmxlZnQgPSAiLTY3cHgiOwogICAgICAgICAgcGFyZW50X2Rpdl9mb3JfaW1hZ2Uuc3R5bGUudG9wID0gIiIuY29uY2F0KHRhcmdldE9mZnNldC5oZWlnaHQgLSAxMCwgInB4Iik7CiAgICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IGxlZnQtYm90dG9tIjsKICAgICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS50b3AgPSAiLSIuY29uY2F0KHRvb2x0aXBPZmZzZXQuaGVpZ2h0IC0gdGFyZ2V0T2Zmc2V0LmhlaWdodCAtIDIwLCAicHgiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gYXJyb3dMYXllci5hcHBlbmRDaGlsZChpbWFnZUxheWVyKTsKICAgICAgICAgIC8vIHBhcmVudF9kaXZfZm9yX2ltYWdlLmFwcGVuZENoaWxkKGltYWdlTGF5ZXIpOwogICAgICAgICAgcGFyZW50X2Rpdl9mb3JfaW1hZ2Uuc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOwogICAgICAgICAgcGFyZW50X2Rpdl9mb3JfaW1hZ2Uuc3R5bGUubGVmdCA9ICItNjdweCI7CiAgICAgICAgICBwYXJlbnRfZGl2X2Zvcl9pbWFnZS5zdHlsZS50b3AgPSAiIi5jb25jYXQodGFyZ2V0T2Zmc2V0LmhlaWdodCAtIDEwLCAicHgiKTsgLy8gYXJyb3dMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy1hcnJvdyBsZWZ0IjsKCiAgICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IGxlZnQtYm90dG9tIjsKICAgICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS50b3AgPSAiLSIuY29uY2F0KHRvb2x0aXBPZmZzZXQuaGVpZ2h0IC0gdGFyZ2V0T2Zmc2V0LmhlaWdodCAtIDIwLCAicHgiKTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAibGVmdCI6CiAgICAgICAgaWYgKCFoaW50TW9kZSAmJiB0aGlzLl9vcHRpb25zLnNob3dTdGVwTnVtYmVycyA9PT0gdHJ1ZSkgewogICAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLnRvcCA9ICIxNXB4IjsKICAgICAgICB9CgogICAgICAgIGlmICh0YXJnZXRPZmZzZXQudG9wICsgdG9vbHRpcE9mZnNldC5oZWlnaHQgPiB3aW5kb3dTaXplLmhlaWdodCkgewogICAgICAgICAgLy8gSW4gdGhpcyBjYXNlLCBsZWZ0IHdvdWxkIGhhdmUgZmFsbGVuIGJlbG93IHRoZSBib3R0b20gb2YgdGhlIHNjcmVlbi4KICAgICAgICAgIC8vIE1vZGlmeSBzbyB0aGF0IHRoZSBib3R0b20gb2YgdGhlIHRvb2x0aXAgY29ubmVjdHMgd2l0aCB0aGUgdGFyZ2V0CiAgICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUudG9wID0gIi0iLmNvbmNhdCh0b29sdGlwT2Zmc2V0LmhlaWdodCAtIHRhcmdldE9mZnNldC5oZWlnaHQgLSAyMCwgInB4Iik7CiAgICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IHJpZ2h0LWJvdHRvbSI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3cgcmlnaHQiOwogICAgICAgIH0KCiAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLnJpZ2h0ID0gIiIuY29uY2F0KHRhcmdldE9mZnNldC53aWR0aCArIDIwLCAicHgiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImZsb2F0aW5nIjoKICAgICAgICBhcnJvd0xheWVyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7IC8vd2UgaGF2ZSB0byBhZGp1c3QgdGhlIHRvcCBhbmQgbGVmdCBvZiBsYXllciBtYW51YWxseSBmb3IgaW50cm8gaXRlbXMgd2l0aG91dCBlbGVtZW50CgogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5sZWZ0ID0gIjUwJSI7CiAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLnRvcCA9ICI1MCUiOwogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5tYXJnaW5MZWZ0ID0gIi0iLmNvbmNhdCh0b29sdGlwT2Zmc2V0LndpZHRoIC8gMiwgInB4Iik7CiAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLm1hcmdpblRvcCA9ICItIi5jb25jYXQodG9vbHRpcE9mZnNldC5oZWlnaHQgLyAyLCAicHgiKTsKCiAgICAgICAgaWYgKHR5cGVvZiBoZWxwZXJOdW1iZXJMYXllciAhPT0gInVuZGVmaW5lZCIgJiYgaGVscGVyTnVtYmVyTGF5ZXIgIT09IG51bGwpIHsKICAgICAgICAgIGhlbHBlck51bWJlckxheWVyLnN0eWxlLmxlZnQgPSAiLSIuY29uY2F0KHRvb2x0aXBPZmZzZXQud2lkdGggLyAyICsgMTgsICJweCIpOwogICAgICAgICAgaGVscGVyTnVtYmVyTGF5ZXIuc3R5bGUudG9wID0gIi0iLmNvbmNhdCh0b29sdGlwT2Zmc2V0LmhlaWdodCAvIDIgKyAxOCwgInB4Iik7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgImJvdHRvbS1yaWdodC1hbGlnbmVkIjoKICAgICAgICBhcnJvd0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWFycm93IHRvcC1yaWdodCI7CiAgICAgICAgdG9vbHRpcExheWVyU3R5bGVSaWdodCA9IDA7CiAgICAgICAgY2hlY2tMZWZ0KHRhcmdldE9mZnNldCwgdG9vbHRpcExheWVyU3R5bGVSaWdodCwgdG9vbHRpcE9mZnNldCwgdG9vbHRpcExheWVyKTsKICAgICAgICB0b29sdGlwTGF5ZXIuc3R5bGUudG9wID0gIiIuY29uY2F0KHRhcmdldE9mZnNldC5oZWlnaHQgKyAyMCwgInB4Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJib3R0b20tbWlkZGxlLWFsaWduZWQiOgogICAgICAgIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3cgdG9wLW1pZGRsZSI7CiAgICAgICAgdG9vbHRpcExheWVyU3R5bGVMZWZ0UmlnaHQgPSB0YXJnZXRPZmZzZXQud2lkdGggLyAyIC0gdG9vbHRpcE9mZnNldC53aWR0aCAvIDI7IC8vIGEgZml4IGZvciBtaWRkbGUgYWxpZ25lZCBoaW50cwoKICAgICAgICBpZiAoaGludE1vZGUpIHsKICAgICAgICAgIHRvb2x0aXBMYXllclN0eWxlTGVmdFJpZ2h0ICs9IDU7CiAgICAgICAgfQoKICAgICAgICBpZiAoY2hlY2tMZWZ0KHRhcmdldE9mZnNldCwgdG9vbHRpcExheWVyU3R5bGVMZWZ0UmlnaHQsIHRvb2x0aXBPZmZzZXQsIHRvb2x0aXBMYXllcikpIHsKICAgICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5yaWdodCA9IG51bGw7CiAgICAgICAgICBjaGVja1JpZ2h0KHRhcmdldE9mZnNldCwgdG9vbHRpcExheWVyU3R5bGVMZWZ0UmlnaHQsIHRvb2x0aXBPZmZzZXQsIHdpbmRvd1NpemUsIHRvb2x0aXBMYXllcik7CiAgICAgICAgfQoKICAgICAgICB2YXIgZ2V0X2xlZnRfb2Zmc2V0ID0gTWF0aC5tYXgoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKTsKICAgICAgICB2YXIgZ2V0X3RvcF9vZmZzZXQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0OyAvLyB0b29sdGlwTGF5ZXIuc3R5bGUudG9wID0gIiIuY29uY2F0KHRhcmdldE9mZnNldC5oZWlnaHQgKyAyMCwgInB4Iik7CgogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS50b3AgPSAiIi5jb25jYXQoZ2V0X3RvcF9vZmZzZXQgLyAyLjMsICJweCIpOwogICAgICAgIHRvb2x0aXBMYXllci5zdHlsZS5sZWZ0ID0gIiIuY29uY2F0KGdldF9sZWZ0X29mZnNldCAvIDIuNSwgInB4Iik7CiAgICAgICAgYnJlYWs7CiAgICAgIC8vIGNhc2UgJ2JvdHRvbS1sZWZ0LWFsaWduZWQnOgogICAgICAvLyBCb3R0b20tbGVmdC1hbGlnbmVkIGlzIHRoZSBzYW1lIGFzIHRoZSBkZWZhdWx0IGJvdHRvbQogICAgICAvLyBjYXNlICdib3R0b20nOgogICAgICAvLyBCb3R0b20gZ29pbmcgdG8gZm9sbG93IHRoZSBkZWZhdWx0IGJlaGF2aW9yCgogICAgICBkZWZhdWx0OgogICAgICAgIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3cgdG9wIjsKICAgICAgICB0b29sdGlwTGF5ZXJTdHlsZUxlZnQgPSAwOwogICAgICAgIGNoZWNrUmlnaHQodGFyZ2V0T2Zmc2V0LCB0b29sdGlwTGF5ZXJTdHlsZUxlZnQsIHRvb2x0aXBPZmZzZXQsIHdpbmRvd1NpemUsIHRvb2x0aXBMYXllcik7CiAgICAgICAgdG9vbHRpcExheWVyLnN0eWxlLnRvcCA9ICIiLmNvbmNhdCh0YXJnZXRPZmZzZXQuaGVpZ2h0ICsgMjAsICJweCIpOwogICAgfQogIH0KICAvKioKICAgKiBUbyByZW1vdmUgYWxsIHNob3cgZWxlbWVudChzKQogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfcmVtb3ZlU2hvd0VsZW1lbnQKICAgKi8KCgogIGZ1bmN0aW9uIHJlbW92ZVNob3dFbGVtZW50KCkgewogICAgdmFyIGVsbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIuaW50cm9qcy1zaG93RWxlbWVudCIpOwogICAgZm9yRWFjaChlbG1zLCBmdW5jdGlvbiAoZWxtKSB7CiAgICAgIHJlbW92ZUNsYXNzKGVsbSwgL2ludHJvanMtW2EtekEtWl0rL2cpOwogICAgfSk7CiAgfQogIC8qKgogICAqIEdldHMgdGhlIGN1cnJlbnQgcHJvZ3Jlc3MgcGVyY2VudGFnZQogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfZ2V0UHJvZ3Jlc3MKICAgKiBAcmV0dXJucyBjdXJyZW50IHByb2dyZXNzIHBlcmNlbnRhZ2UKICAgKi8KCgogIGZ1bmN0aW9uIF9nZXRQcm9ncmVzcygpIHsKICAgIC8vIFN0ZXBzIGFyZSAwIGluZGV4ZWQKICAgIHZhciBjdXJyZW50U3RlcCA9IHBhcnNlSW50KHRoaXMuX2N1cnJlbnRTdGVwICsgMSwgMTApOwogICAgcmV0dXJuIGN1cnJlbnRTdGVwIC8gdGhpcy5faW50cm9JdGVtcy5sZW5ndGggKiAxMDA7CiAgfQogIC8qKgogICAqIEFkZCBkaXNhYmxlaW50ZXJhY3Rpb24gbGF5ZXIgYW5kIGFkanVzdCB0aGUgc2l6ZSBhbmQgcG9zaXRpb24gb2YgdGhlIGxheWVyCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9kaXNhYmxlSW50ZXJhY3Rpb24KICAgKi8KCgogIGZ1bmN0aW9uIF9kaXNhYmxlSW50ZXJhY3Rpb24oKSB7CiAgICB2YXIgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1kaXNhYmxlSW50ZXJhY3Rpb24iKTsKCiAgICBpZiAoZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIgPT09IG51bGwpIHsKICAgICAgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtZGlzYWJsZUludGVyYWN0aW9uIjsKCiAgICAgIHRoaXMuX3RhcmdldEVsZW1lbnQuYXBwZW5kQ2hpbGQoZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIpOwogICAgfQoKICAgIHNldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbCh0aGlzLCBkaXNhYmxlSW50ZXJhY3Rpb25MYXllcik7CiAgfQogIC8qKgogICAqIFNob3cgYW4gZWxlbWVudCBvbiB0aGUgcGFnZQogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfc2hvd0VsZW1lbnQKICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0RWxlbWVudAogICAqLwoKCiAgZnVuY3Rpb24gX3Nob3dFbGVtZW50KHRhcmdldEVsZW1lbnQpIHsKICAgIGlmICh0eXBlb2YgdGhpcy5faW50cm9DaGFuZ2VDYWxsYmFjayAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgdGhpcy5faW50cm9DaGFuZ2VDYWxsYmFjay5jYWxsKHRoaXMsIHRhcmdldEVsZW1lbnQuZWxlbWVudCk7CiAgICB9CgogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIG9sZEhlbHBlckxheWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtaGVscGVyTGF5ZXIiKTsKICAgIHZhciBvbGRSZWZlcmVuY2VMYXllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLXRvb2x0aXBSZWZlcmVuY2VMYXllciIpOwogICAgdmFyIGhpZ2hsaWdodENsYXNzID0gImludHJvanMtaGVscGVyTGF5ZXIiOwogICAgdmFyIG5leHRUb29sdGlwQnV0dG9uOwogICAgdmFyIHByZXZUb29sdGlwQnV0dG9uOwogICAgdmFyIHNraXBUb29sdGlwQnV0dG9uOwogICAgdmFyIHNjcm9sbFBhcmVudDsgLy9jaGVjayBmb3IgYSBjdXJyZW50IHN0ZXAgaGlnaGxpZ2h0IGNsYXNzCgogICAgaWYgKHR5cGVvZiB0YXJnZXRFbGVtZW50LmhpZ2hsaWdodENsYXNzID09PSAic3RyaW5nIikgewogICAgICBoaWdobGlnaHRDbGFzcyArPSAiICIuY29uY2F0KHRhcmdldEVsZW1lbnQuaGlnaGxpZ2h0Q2xhc3MpOwogICAgfSAvL2NoZWNrIGZvciBvcHRpb25zIGhpZ2hsaWdodCBjbGFzcwoKCiAgICBpZiAodHlwZW9mIHRoaXMuX29wdGlvbnMuaGlnaGxpZ2h0Q2xhc3MgPT09ICJzdHJpbmciKSB7CiAgICAgIGhpZ2hsaWdodENsYXNzICs9ICIgIi5jb25jYXQodGhpcy5fb3B0aW9ucy5oaWdobGlnaHRDbGFzcyk7CiAgICB9CgogICAgaWYgKG9sZEhlbHBlckxheWVyICE9PSBudWxsKSB7CiAgICAgIHZhciBvbGRIZWxwZXJOdW1iZXJMYXllciA9IG9sZFJlZmVyZW5jZUxheWVyLnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhlbHBlck51bWJlckxheWVyIik7CiAgICAgIHZhciBvbGR0b29sdGlwTGF5ZXIgPSBvbGRSZWZlcmVuY2VMYXllci5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy10b29sdGlwdGV4dCIpOwogICAgICB2YXIgb2xkQXJyb3dMYXllciA9IG9sZFJlZmVyZW5jZUxheWVyLnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWFycm93Iik7CiAgICAgIHZhciBvbGR0b29sdGlwQ29udGFpbmVyID0gb2xkUmVmZXJlbmNlTGF5ZXIucXVlcnlTZWxlY3RvcigiLmludHJvanMtdG9vbHRpcCIpOwogICAgICBza2lwVG9vbHRpcEJ1dHRvbiA9IG9sZFJlZmVyZW5jZUxheWVyLnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLXNraXBidXR0b24iKTsKICAgICAgcHJldlRvb2x0aXBCdXR0b24gPSBvbGRSZWZlcmVuY2VMYXllci5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1wcmV2YnV0dG9uIik7CiAgICAgIG5leHRUb29sdGlwQnV0dG9uID0gb2xkUmVmZXJlbmNlTGF5ZXIucXVlcnlTZWxlY3RvcigiLmludHJvanMtbmV4dGJ1dHRvbiIpOyAvL3VwZGF0ZSBvciByZXNldCB0aGUgaGVscGVyIGhpZ2hsaWdodCBjbGFzcwoKICAgICAgb2xkSGVscGVyTGF5ZXIuY2xhc3NOYW1lID0gaGlnaGxpZ2h0Q2xhc3M7IC8vaGlkZSB0aGUgdG9vbHRpcAoKICAgICAgaWYgKGRvY3VtZW50LmNvbnRhaW5zKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsYWJlbF9kaXNwbGF5X2RpdiIpKSkgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsYWJlbF9kaXNwbGF5X2RpdiIpLnJlbW92ZSgpOwogICAgICB9CgogICAgICBpZiAodGFyZ2V0RWxlbWVudC5sYWJlbERpc3BsYXkgIT09ICJXRUxDT01FIikgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b20tYXJyb3ctaW1hZ2UtY2Vuc2UiKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY3VzdG9tLWFycm93LWltYWdlLWNlbnNlIikuc3R5bGUub3BhY2l0eSA9IDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbS1hcnJvdy1pbWFnZS1jZW5zZSIpLnN0eWxlLm9wYWNpdHkgPSAwOwogICAgICB9CgogICAgICB2YXIgbGFiZWxfZGlzcGxheV9kaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgbGFiZWxfZGlzcGxheV9kaXYuaWQgPSAibGFiZWxfZGlzcGxheV9kaXYiOwogICAgICBsYWJlbF9kaXNwbGF5X2Rpdi5zdHlsZS5jb2xvciA9ICIjRkZGRkZGIjsKICAgICAgbGFiZWxfZGlzcGxheV9kaXYuc3R5bGUudGV4dEFsaWduID0gImNlbnRlciI7CiAgICAgIGxhYmVsX2Rpc3BsYXlfZGl2LnN0eWxlLm1hcmdpblRvcCA9ICIwLjVyZW0iOwogICAgICBsYWJlbF9kaXNwbGF5X2Rpdi5pbm5lckhUTUwgPSB0YXJnZXRFbGVtZW50LmxhYmVsRGlzcGxheTsKICAgICAgb2xkSGVscGVyTGF5ZXIuYXBwZW5kQ2hpbGQobGFiZWxfZGlzcGxheV9kaXYpOyAvLyBvbGRIZWxwZXJMYXllci5pbm5lckhUTUwgPSB0YXJnZXRFbGVtZW50LmxhYmVsRGlzcGxheTsKCiAgICAgIG9sZHRvb2x0aXBDb250YWluZXIuc3R5bGUub3BhY2l0eSA9IDA7CiAgICAgIG9sZHRvb2x0aXBDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCiAgICAgIGlmIChvbGRIZWxwZXJOdW1iZXJMYXllciAhPT0gbnVsbCkgewogICAgICAgIHZhciBsYXN0SW50cm9JdGVtID0gdGhpcy5faW50cm9JdGVtc1t0YXJnZXRFbGVtZW50LnN0ZXAgLSAyID49IDAgPyB0YXJnZXRFbGVtZW50LnN0ZXAgLSAyIDogMF07CgogICAgICAgIGlmIChsYXN0SW50cm9JdGVtICE9PSBudWxsICYmIHRoaXMuX2RpcmVjdGlvbiA9PT0gImZvcndhcmQiICYmIGxhc3RJbnRyb0l0ZW0ucG9zaXRpb24gPT09ICJmbG9hdGluZyIgfHwgdGhpcy5fZGlyZWN0aW9uID09PSAiYmFja3dhcmQiICYmIHRhcmdldEVsZW1lbnQucG9zaXRpb24gPT09ICJmbG9hdGluZyIpIHsKICAgICAgICAgIG9sZEhlbHBlck51bWJlckxheWVyLnN0eWxlLm9wYWNpdHkgPSAwOwogICAgICAgIH0KICAgICAgfSAvLyBzY3JvbGwgdG8gZWxlbWVudAoKCiAgICAgIHNjcm9sbFBhcmVudCA9IGdldFNjcm9sbFBhcmVudCh0YXJnZXRFbGVtZW50LmVsZW1lbnQpOwoKICAgICAgaWYgKHNjcm9sbFBhcmVudCAhPT0gZG9jdW1lbnQuYm9keSkgewogICAgICAgIC8vIHRhcmdldCBpcyB3aXRoaW4gYSBzY3JvbGxhYmxlIGVsZW1lbnQKICAgICAgICBzY3JvbGxQYXJlbnRUb0VsZW1lbnQoc2Nyb2xsUGFyZW50LCB0YXJnZXRFbGVtZW50LmVsZW1lbnQpOwogICAgICB9IC8vIHNldCBuZXcgcG9zaXRpb24gdG8gaGVscGVyIGxheWVyCgoKICAgICAgc2V0SGVscGVyTGF5ZXJQb3NpdGlvbi5jYWxsKHNlbGYsIG9sZEhlbHBlckxheWVyKTsKICAgICAgc2V0SGVscGVyTGF5ZXJQb3NpdGlvbi5jYWxsKHNlbGYsIG9sZFJlZmVyZW5jZUxheWVyKTsgLy9yZW1vdmUgYGludHJvanMtZml4UGFyZW50YCBjbGFzcyBmcm9tIHRoZSBlbGVtZW50cwoKICAgICAgdmFyIGZpeFBhcmVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIuaW50cm9qcy1maXhQYXJlbnQiKTsKICAgICAgZm9yRWFjaChmaXhQYXJlbnRzLCBmdW5jdGlvbiAocGFyZW50KSB7CiAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50LCAvaW50cm9qcy1maXhQYXJlbnQvZyk7CiAgICAgIH0pOyAvL3JlbW92ZSBvbGQgY2xhc3NlcyBpZiB0aGUgZWxlbWVudCBzdGlsbCBleGlzdAoKICAgICAgcmVtb3ZlU2hvd0VsZW1lbnQoKTsgLy93ZSBzaG91bGQgd2FpdCB1bnRpbCB0aGUgQ1NTMyB0cmFuc2l0aW9uIGlzIGNvbXBldGVkIChpdCdzIDAuMyBzZWMpIHRvIHByZXZlbnQgaW5jb3JyZWN0IGBoZWlnaHRgIGFuZCBgd2lkdGhgIGNhbGN1bGF0aW9uCgogICAgICBpZiAoc2VsZi5fbGFzdFNob3dFbGVtZW50VGltZXIpIHsKICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHNlbGYuX2xhc3RTaG93RWxlbWVudFRpbWVyKTsKICAgICAgfQoKICAgICAgc2VsZi5fbGFzdFNob3dFbGVtZW50VGltZXIgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgLy9zZXQgY3VycmVudCBzdGVwIHRvIHRoZSBsYWJlbAogICAgICAgIGlmIChvbGRIZWxwZXJOdW1iZXJMYXllciAhPT0gbnVsbCkgewogICAgICAgICAgb2xkSGVscGVyTnVtYmVyTGF5ZXIuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5zdGVwOwogICAgICAgIH0gLy9zZXQgY3VycmVudCB0b29sdGlwIHRleHQKCgogICAgICAgIHZhciB0b29sdGlwSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaDUiKTsKICAgICAgICB0b29sdGlwSGVhZGVyLnN0eWxlLmNvbG9yID0gIiMyODM4NzciOwogICAgICAgIHRvb2x0aXBIZWFkZXIuc3R5bGUuZm9udEZhbWlseSA9ICJydWJpayI7CiAgICAgICAgdG9vbHRpcEhlYWRlci5pbm5lckhUTUwgPSB0YXJnZXRFbGVtZW50LmxhYmVsRGlzcGxheTsKICAgICAgICB2YXIgdG9vbHRpcEJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICB0b29sdGlwQm9keS5pbm5lckhUTUwgPSB0YXJnZXRFbGVtZW50LmludHJvOwogICAgICAgIG9sZHRvb2x0aXBMYXllci5pbm5lckhUTUwgPSAiIjsKICAgICAgICBvbGR0b29sdGlwTGF5ZXIuc3R5bGUubWF4V2lkdGggPSAiIjsKICAgICAgICBvbGR0b29sdGlwTGF5ZXIuc3R5bGUubWluV2lkdGggPSAiNDYwcHgiOyAvLyB0b29sdGlwVGV4dExheWVyLnN0eWxlLm1heFdpZHRoID0gIjMwMHB4IjsKICAgICAgICAvLyBvbGR0b29sdGlwTGF5ZXIuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5pbnRybzsgLy9zZXQgdGhlIHRvb2x0aXAgcG9zaXRpb24KCiAgICAgICAgb2xkdG9vbHRpcExheWVyLmFwcGVuZENoaWxkKHRvb2x0aXBIZWFkZXIpOwogICAgICAgIG9sZHRvb2x0aXBMYXllci5hcHBlbmRDaGlsZCh0b29sdGlwQm9keSk7CiAgICAgICAgb2xkdG9vbHRpcExheWVyLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICItMS41MnJlbSI7CiAgICAgICAgb2xkdG9vbHRpcENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBvbGR0b29sdGlwTGF5ZXIuc3R5bGUucGFkZGluZ0xlZnQgPSAiMXJlbSI7IC8vIG9sZHRvb2x0aXBDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICJtYXgtd2lkdGg6IDcwMHB4ICFpbXBvcnRhbnQiOyAKCiAgICAgICAgcGxhY2VUb29sdGlwLmNhbGwoc2VsZiwgdGFyZ2V0RWxlbWVudC5lbGVtZW50LCBvbGR0b29sdGlwQ29udGFpbmVyLCBvbGRBcnJvd0xheWVyLCBvbGRIZWxwZXJOdW1iZXJMYXllcik7IC8vY2hhbmdlIGFjdGl2ZSBidWxsZXQKCiAgICAgICAgaWYgKHNlbGYuX29wdGlvbnMuc2hvd0J1bGxldHMpIHsKICAgICAgICAgIG9sZFJlZmVyZW5jZUxheWVyLnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWJ1bGxldHMgbGkgPiBhLmFjdGl2ZSIpLmNsYXNzTmFtZSA9ICIiOwogICAgICAgICAgb2xkUmVmZXJlbmNlTGF5ZXIucXVlcnlTZWxlY3RvcigiLmludHJvanMtYnVsbGV0cyBsaSA+IGFbZGF0YS1zdGVwbnVtYmVyPVwiIi5jb25jYXQodGFyZ2V0RWxlbWVudC5zdGVwLCAiXCJdIikpLmNsYXNzTmFtZSA9ICJhY3RpdmUiOwogICAgICAgIH0gLy8gb2xkUmVmZXJlbmNlTGF5ZXIucXVlcnlTZWxlY3RvcigiLmludHJvanMtcHJvZ3Jlc3MgLmludHJvanMtcHJvZ3Jlc3NiYXIiKS5zdHlsZS5jc3NUZXh0ID0gIndpZHRoOiIuY29uY2F0KF9nZXRQcm9ncmVzcy5jYWxsKHNlbGYpLCAiJTsiKTsKICAgICAgICAvLyBvbGRSZWZlcmVuY2VMYXllci5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1wcm9ncmVzcyAuaW50cm9qcy1wcm9ncmVzc2JhciIpLnNldEF0dHJpYnV0ZSgiYXJpYS12YWx1ZW5vdyIsIF9nZXRQcm9ncmVzcy5jYWxsKHNlbGYpKTsgLy9zaG93IHRoZSB0b29sdGlwCgoKICAgICAgICBvbGR0b29sdGlwQ29udGFpbmVyLnN0eWxlLm9wYWNpdHkgPSAxOwogICAgICAgIGlmIChvbGRIZWxwZXJOdW1iZXJMYXllcikgb2xkSGVscGVyTnVtYmVyTGF5ZXIuc3R5bGUub3BhY2l0eSA9IDE7IC8vcmVzZXQgYnV0dG9uIGZvY3VzCgogICAgICAgIGlmICh0eXBlb2Ygc2tpcFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHNraXBUb29sdGlwQnV0dG9uICE9PSBudWxsICYmIC9pbnRyb2pzLWRvbmVidXR0b24vZ2kudGVzdChza2lwVG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUpKSB7CiAgICAgICAgICAvLyBza2lwIGJ1dHRvbiBpcyBub3cgImRvbmUiIGJ1dHRvbgogICAgICAgICAgc2tpcFRvb2x0aXBCdXR0b24uZm9jdXMoKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgbmV4dFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICAgIC8vc3RpbGwgaW4gdGhlIHRvdXIsIGZvY3VzIG9uIG5leHQKICAgICAgICAgIG5leHRUb29sdGlwQnV0dG9uLmZvY3VzKCk7CiAgICAgICAgfSAvLyBjaGFuZ2UgdGhlIHNjcm9sbCBvZiB0aGUgd2luZG93LCBpZiBuZWVkZWQKCgogICAgICAgIHNjcm9sbFRvLmNhbGwoc2VsZiwgdGFyZ2V0RWxlbWVudC5zY3JvbGxUbywgdGFyZ2V0RWxlbWVudCwgb2xkdG9vbHRpcExheWVyKTsKICAgICAgfSwgMzUwKTsgLy8gZW5kIG9mIG9sZCBlbGVtZW50IGlmLWVsc2UgY29uZGl0aW9uCiAgICB9IGVsc2UgewogICAgICB2YXIgaGVscGVyTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdmFyIHJlZmVyZW5jZUxheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHZhciBhcnJvd0xheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHZhciB0b29sdGlwTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdmFyIHRvb2x0aXBUZXh0TGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdmFyIGJ1bGxldHNMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB2YXIgcHJvZ3Jlc3NMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB2YXIgYnV0dG9uc0xheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHZhciBpbWFnZUxheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW1nIik7CiAgICAgIGltYWdlTGF5ZXIuc3JjID0gIi9pbWcvR3JvdXAzLnN2ZyI7CiAgICAgIGltYWdlTGF5ZXIuaWQgPSAiY3VzdG9tLWFycm93LWltYWdlLWNlbnNlIjsKICAgICAgaW1hZ2VMYXllci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBoZWxwZXJMYXllci5jbGFzc05hbWUgPSBoaWdobGlnaHRDbGFzczsKICAgICAgcmVmZXJlbmNlTGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtdG9vbHRpcFJlZmVyZW5jZUxheWVyIjsgLy8gc2Nyb2xsIHRvIGVsZW1lbnQKCiAgICAgIHNjcm9sbFBhcmVudCA9IGdldFNjcm9sbFBhcmVudCh0YXJnZXRFbGVtZW50LmVsZW1lbnQpOwoKICAgICAgaWYgKHNjcm9sbFBhcmVudCAhPT0gZG9jdW1lbnQuYm9keSkgewogICAgICAgIC8vIHRhcmdldCBpcyB3aXRoaW4gYSBzY3JvbGxhYmxlIGVsZW1lbnQKICAgICAgICBzY3JvbGxQYXJlbnRUb0VsZW1lbnQoc2Nyb2xsUGFyZW50LCB0YXJnZXRFbGVtZW50LmVsZW1lbnQpOwogICAgICB9IC8vc2V0IG5ldyBwb3NpdGlvbiB0byBoZWxwZXIgbGF5ZXIKCgogICAgICBzZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwoc2VsZiwgaGVscGVyTGF5ZXIpOwogICAgICBzZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwoc2VsZiwgcmVmZXJlbmNlTGF5ZXIpOyAvL2FkZCBoZWxwZXIgbGF5ZXIgdG8gdGFyZ2V0IGVsZW1lbnQKCiAgICAgIHRoaXMuX3RhcmdldEVsZW1lbnQuYXBwZW5kQ2hpbGQoaGVscGVyTGF5ZXIpOyAvLyB0aGlzLl90YXJnZXRFbGVtZW50LmFwcGVuZENoaWxkKGltYWdlTGF5ZXIpOwoKCiAgICAgIHRoaXMuX3RhcmdldEVsZW1lbnQuYXBwZW5kQ2hpbGQocmVmZXJlbmNlTGF5ZXIpOwoKICAgICAgYXJyb3dMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy1hcnJvdyI7CiAgICAgIHRvb2x0aXBUZXh0TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtdG9vbHRpcHRleHQiOwogICAgICB2YXIgdG9vbHRpcEhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImg1Iik7CiAgICAgIHRvb2x0aXBIZWFkZXIuc3R5bGUuY29sb3IgPSAiIzI4Mzg3NyI7CiAgICAgIHRvb2x0aXBIZWFkZXIuaW5uZXJIVE1MID0gIldFTENPTUUiOwogICAgICB2YXIgdG9vbHRpcEJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdG9vbHRpcEJvZHkuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5pbnRybzsKICAgICAgdG9vbHRpcFRleHRMYXllci5pbm5lckhUTUwgPSAiIjsKICAgICAgdG9vbHRpcFRleHRMYXllci5zdHlsZS5taW5XaWR0aCA9ICI1MDBweCI7CiAgICAgIHRvb2x0aXBUZXh0TGF5ZXIuc3R5bGUubWF4V2lkdGggPSAiMzAwcHgiOwogICAgICB0b29sdGlwVGV4dExheWVyLmFwcGVuZENoaWxkKHRvb2x0aXBIZWFkZXIpOwogICAgICB0b29sdGlwVGV4dExheWVyLmFwcGVuZENoaWxkKHRvb2x0aXBCb2R5KTsKICAgICAgdG9vbHRpcFRleHRMYXllci5zdHlsZS5tYXJnaW5Cb3R0b20gPSAiMCI7IC8vIHRvb2x0aXBUZXh0TGF5ZXIuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5pbnRybzsKICAgICAgLy8gdmFyIGxhYmVsX2Rpc3BsYXlfZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIC8vIGxhYmVsX2Rpc3BsYXlfZGl2LmlkID0gImxhYmVsX2Rpc3BsYXlfZGl2IjsKICAgICAgLy8gbGFiZWxfZGlzcGxheV9kaXYuc3R5bGUuY29sb3IgPSAiI0ZGRkZGRiI7CiAgICAgIC8vIGxhYmVsX2Rpc3BsYXlfZGl2LnN0eWxlLnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICAvLyBsYWJlbF9kaXNwbGF5X2Rpdi5zdHlsZS5tYXJnaW5Ub3AgPSAiMC41cmVtIjsKICAgICAgLy8gbGFiZWxfZGlzcGxheV9kaXYuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5sYWJlbERpc3BsYXk7CiAgICAgIC8vIGhlbHBlckxheWVyLmFwcGVuZENoaWxkKGxhYmVsX2Rpc3BsYXlfZGl2KTsKICAgICAgLy8gaGVscGVyTGF5ZXIuaW5uZXJIVE1MID0gdGFyZ2V0RWxlbWVudC5sYWJlbERpc3BsYXk7CgogICAgICBidWxsZXRzTGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYnVsbGV0cyI7CgogICAgICBpZiAodGhpcy5fb3B0aW9ucy5zaG93QnVsbGV0cyA9PT0gZmFsc2UpIHsKICAgICAgICBidWxsZXRzTGF5ZXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfQoKICAgICAgdmFyIHVsQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidWwiKTsKICAgICAgdWxDb250YWluZXIuc2V0QXR0cmlidXRlKCJyb2xlIiwgInRhYmxpc3QiKTsKCiAgICAgIHZhciBhbmNob3JDbGljayA9IGZ1bmN0aW9uIGFuY2hvckNsaWNrKCkgewogICAgICAgIHNlbGYuZ29Ub1N0ZXAodGhpcy5nZXRBdHRyaWJ1dGUoImRhdGEtc3RlcG51bWJlciIpKTsKICAgICAgfTsKCiAgICAgIGZvckVhY2godGhpcy5faW50cm9JdGVtcywgZnVuY3Rpb24gKF9yZWYsIGkpIHsKICAgICAgICB2YXIgc3RlcCA9IF9yZWYuc3RlcDsKICAgICAgICB2YXIgaW5uZXJMaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpIik7CiAgICAgICAgdmFyIGFuY2hvckxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgaW5uZXJMaS5zZXRBdHRyaWJ1dGUoInJvbGUiLCAicHJlc2VudGF0aW9uIik7CiAgICAgICAgYW5jaG9yTGluay5zZXRBdHRyaWJ1dGUoInJvbGUiLCAidGFiIik7CiAgICAgICAgYW5jaG9yTGluay5vbmNsaWNrID0gYW5jaG9yQ2xpY2s7CgogICAgICAgIGlmIChpID09PSB0YXJnZXRFbGVtZW50LnN0ZXAgLSAxKSB7CiAgICAgICAgICBhbmNob3JMaW5rLmNsYXNzTmFtZSA9ICJhY3RpdmUiOwogICAgICAgIH0KCiAgICAgICAgc2V0QW5jaG9yQXNCdXR0b24oYW5jaG9yTGluayk7CiAgICAgICAgYW5jaG9yTGluay5pbm5lckhUTUwgPSAiJm5ic3A7IjsKICAgICAgICBhbmNob3JMaW5rLnNldEF0dHJpYnV0ZSgiZGF0YS1zdGVwbnVtYmVyIiwgc3RlcCk7CiAgICAgICAgaW5uZXJMaS5hcHBlbmRDaGlsZChhbmNob3JMaW5rKTsKICAgICAgICB1bENvbnRhaW5lci5hcHBlbmRDaGlsZChpbm5lckxpKTsKICAgICAgfSk7CiAgICAgIGJ1bGxldHNMYXllci5hcHBlbmRDaGlsZCh1bENvbnRhaW5lcik7CiAgICAgIHByb2dyZXNzTGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtcHJvZ3Jlc3MiOwoKICAgICAgaWYgKHRoaXMuX29wdGlvbnMuc2hvd1Byb2dyZXNzID09PSBmYWxzZSkgewogICAgICAgIHByb2dyZXNzTGF5ZXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgfQoKICAgICAgdmFyIHByb2dyZXNzQmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHByb2dyZXNzQmFyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLXByb2dyZXNzYmFyIjsKICAgICAgcHJvZ3Jlc3NCYXIuc2V0QXR0cmlidXRlKCJyb2xlIiwgInByb2dyZXNzIik7CiAgICAgIHByb2dyZXNzQmFyLnNldEF0dHJpYnV0ZSgiYXJpYS12YWx1ZW1pbiIsIDApOwogICAgICBwcm9ncmVzc0Jhci5zZXRBdHRyaWJ1dGUoImFyaWEtdmFsdWVtYXgiLCAxMDApOwogICAgICBwcm9ncmVzc0Jhci5zZXRBdHRyaWJ1dGUoImFyaWEtdmFsdWVub3ciLCBfZ2V0UHJvZ3Jlc3MuY2FsbCh0aGlzKSk7CiAgICAgIHByb2dyZXNzQmFyLnN0eWxlLmNzc1RleHQgPSAid2lkdGg6Ii5jb25jYXQoX2dldFByb2dyZXNzLmNhbGwodGhpcyksICIlOyIpOwogICAgICBwcm9ncmVzc0xheWVyLmFwcGVuZENoaWxkKHByb2dyZXNzQmFyKTsKICAgICAgYnV0dG9uc0xheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLXRvb2x0aXBidXR0b25zIjsKCiAgICAgIGlmICh0aGlzLl9vcHRpb25zLnNob3dCdXR0b25zID09PSBmYWxzZSkgewogICAgICAgIGJ1dHRvbnNMYXllci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICB9CgogICAgICB0b29sdGlwTGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtdG9vbHRpcCI7IC8vIHRvb2x0aXBMYXllci5zdHlsZS5jc3NUZXh0ID0gIm1heC13aWR0aDogMzAwcHggIWltcG9ydGFudCI7IAoKICAgICAgdG9vbHRpcExheWVyLmFwcGVuZENoaWxkKHRvb2x0aXBUZXh0TGF5ZXIpOwogICAgICB0b29sdGlwTGF5ZXIuYXBwZW5kQ2hpbGQoaW1hZ2VMYXllcik7IC8vIHRvb2x0aXBMYXllci5hcHBlbmRDaGlsZChidWxsZXRzTGF5ZXIpOwogICAgICAvLyB0b29sdGlwTGF5ZXIuYXBwZW5kQ2hpbGQocHJvZ3Jlc3NMYXllcik7IC8vYWRkIGhlbHBlciBsYXllciBudW1iZXIKCiAgICAgIHZhciBoZWxwZXJOdW1iZXJMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTsKCiAgICAgIGlmICh0aGlzLl9vcHRpb25zLnNob3dTdGVwTnVtYmVycyA9PT0gdHJ1ZSkgewogICAgICAgIGhlbHBlck51bWJlckxheWVyLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWhlbHBlck51bWJlckxheWVyIjsKICAgICAgICBoZWxwZXJOdW1iZXJMYXllci5pbm5lckhUTUwgPSB0YXJnZXRFbGVtZW50LnN0ZXA7CiAgICAgICAgcmVmZXJlbmNlTGF5ZXIuYXBwZW5kQ2hpbGQoaGVscGVyTnVtYmVyTGF5ZXIpOwogICAgICB9CgogICAgICB0b29sdGlwTGF5ZXIuYXBwZW5kQ2hpbGQoYXJyb3dMYXllcik7CiAgICAgIHJlZmVyZW5jZUxheWVyLmFwcGVuZENoaWxkKHRvb2x0aXBMYXllcik7IC8vbmV4dCBidXR0b24KCiAgICAgIG5leHRUb29sdGlwQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwoKICAgICAgbmV4dFRvb2x0aXBCdXR0b24ub25jbGljayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoc2VsZi5faW50cm9JdGVtcy5sZW5ndGggLSAxICE9PSBzZWxmLl9jdXJyZW50U3RlcCkgewogICAgICAgICAgbmV4dFN0ZXAuY2FsbChzZWxmKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBzZXRBbmNob3JBc0J1dHRvbihuZXh0VG9vbHRpcEJ1dHRvbik7CiAgICAgIG5leHRUb29sdGlwQnV0dG9uLmlubmVySFRNTCA9IHRoaXMuX29wdGlvbnMubmV4dExhYmVsOyAvL3ByZXZpb3VzIGJ1dHRvbgoKICAgICAgcHJldlRvb2x0aXBCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgIHByZXZUb29sdGlwQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgogICAgICBwcmV2VG9vbHRpcEJ1dHRvbi5vbmNsaWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChzZWxmLl9jdXJyZW50U3RlcCAhPT0gMCkgewogICAgICAgICAgcHJldmlvdXNTdGVwLmNhbGwoc2VsZik7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgc2V0QW5jaG9yQXNCdXR0b24ocHJldlRvb2x0aXBCdXR0b24pOwogICAgICBwcmV2VG9vbHRpcEJ1dHRvbi5pbm5lckhUTUwgPSB0aGlzLl9vcHRpb25zLnByZXZMYWJlbDsgLy9za2lwIGJ1dHRvbgoKICAgICAgc2tpcFRvb2x0aXBCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgIHNraXBUb29sdGlwQnV0dG9uLmNsYXNzTmFtZSA9ICIiLmNvbmNhdCh0aGlzLl9vcHRpb25zLmJ1dHRvbkNsYXNzLCAiIGludHJvanMtc2tpcGJ1dHRvbiAiKTsKICAgICAgc2V0QW5jaG9yQXNCdXR0b24oc2tpcFRvb2x0aXBCdXR0b24pOwogICAgICBza2lwVG9vbHRpcEJ1dHRvbi5pbm5lckhUTUwgPSB0aGlzLl9vcHRpb25zLnNraXBMYWJlbDsKCiAgICAgIHNraXBUb29sdGlwQnV0dG9uLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHNlbGYuX2ludHJvSXRlbXMubGVuZ3RoIC0gMSA9PT0gc2VsZi5fY3VycmVudFN0ZXAgJiYgdHlwZW9mIHNlbGYuX2ludHJvQ29tcGxldGVDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgc2VsZi5faW50cm9Db21wbGV0ZUNhbGxiYWNrLmNhbGwoc2VsZik7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIHNlbGYuX2ludHJvU2tpcENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICBzZWxmLl9pbnRyb1NraXBDYWxsYmFjay5jYWxsKHNlbGYpOwogICAgICAgIH0KCiAgICAgICAgZXhpdEludHJvLmNhbGwoc2VsZiwgc2VsZi5fdGFyZ2V0RWxlbWVudCk7CiAgICAgIH07CgogICAgICBidXR0b25zTGF5ZXIuYXBwZW5kQ2hpbGQoc2tpcFRvb2x0aXBCdXR0b24pOyAvL2luIG9yZGVyIHRvIHByZXZlbnQgZGlzcGxheWluZyBuZXh0L3ByZXZpb3VzIGJ1dHRvbiBhbHdheXMKCiAgICAgIGlmICh0aGlzLl9pbnRyb0l0ZW1zLmxlbmd0aCA+IDEpIHsKICAgICAgICBidXR0b25zTGF5ZXIuYXBwZW5kQ2hpbGQocHJldlRvb2x0aXBCdXR0b24pOwogICAgICAgIGJ1dHRvbnNMYXllci5hcHBlbmRDaGlsZChuZXh0VG9vbHRpcEJ1dHRvbik7CiAgICAgIH0KCiAgICAgIHRvb2x0aXBMYXllci5hcHBlbmRDaGlsZChidXR0b25zTGF5ZXIpOyAvL3NldCBwcm9wZXIgcG9zaXRpb24KCiAgICAgIHBsYWNlVG9vbHRpcC5jYWxsKHNlbGYsIHRhcmdldEVsZW1lbnQuZWxlbWVudCwgdG9vbHRpcExheWVyLCBhcnJvd0xheWVyLCBoZWxwZXJOdW1iZXJMYXllcik7IC8vIGNoYW5nZSB0aGUgc2Nyb2xsIG9mIHRoZSB3aW5kb3csIGlmIG5lZWRlZAoKICAgICAgc2Nyb2xsVG8uY2FsbCh0aGlzLCB0YXJnZXRFbGVtZW50LnNjcm9sbFRvLCB0YXJnZXRFbGVtZW50LCB0b29sdGlwTGF5ZXIpOyAvL2VuZCBvZiBuZXcgZWxlbWVudCBpZi1lbHNlIGNvbmRpdGlvbgogICAgfSAvLyByZW1vdmluZyBwcmV2aW91cyBkaXNhYmxlIGludGVyYWN0aW9uIGxheWVyCgoKICAgIHZhciBkaXNhYmxlSW50ZXJhY3Rpb25MYXllciA9IHNlbGYuX3RhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtZGlzYWJsZUludGVyYWN0aW9uIik7CgogICAgaWYgKGRpc2FibGVJbnRlcmFjdGlvbkxheWVyKSB7CiAgICAgIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIpOwogICAgfSAvL2Rpc2FibGUgaW50ZXJhY3Rpb24KCgogICAgaWYgKHRhcmdldEVsZW1lbnQuZGlzYWJsZUludGVyYWN0aW9uKSB7CiAgICAgIF9kaXNhYmxlSW50ZXJhY3Rpb24uY2FsbChzZWxmKTsKICAgIH0gLy8gd2hlbiBpdCdzIHRoZSBmaXJzdCBzdGVwIG9mIHRvdXIKCgogICAgaWYgKHRoaXMuX2N1cnJlbnRTdGVwID09PSAwICYmIHRoaXMuX2ludHJvSXRlbXMubGVuZ3RoID4gMSkgewogICAgICBpZiAodHlwZW9mIHNraXBUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBza2lwVG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICAgIHNraXBUb29sdGlwQnV0dG9uLmNsYXNzTmFtZSA9ICIiLmNvbmNhdCh0aGlzLl9vcHRpb25zLmJ1dHRvbkNsYXNzLCAiIGludHJvanMtc2tpcGJ1dHRvbiIpOwogICAgICAgIHNraXBUb29sdGlwQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgbmV4dFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIG5leHRUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgbmV4dFRvb2x0aXBCdXR0b24uY2xhc3NOYW1lID0gIiIuY29uY2F0KHRoaXMuX29wdGlvbnMuYnV0dG9uQ2xhc3MsICIgaW50cm9qcy1uZXh0YnV0dG9uIik7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9vcHRpb25zLmhpZGVQcmV2ID09PSB0cnVlKSB7CiAgICAgICAgaWYgKHR5cGVvZiBwcmV2VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgcHJldlRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICAgIHByZXZUb29sdGlwQnV0dG9uLmNsYXNzTmFtZSA9ICIiLmNvbmNhdCh0aGlzLl9vcHRpb25zLmJ1dHRvbkNsYXNzLCAiIGludHJvanMtcHJldmJ1dHRvbiBpbnRyb2pzLWhpZGRlbiIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR5cGVvZiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgbmV4dFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICAgIGFkZENsYXNzKG5leHRUb29sdGlwQnV0dG9uLCAiaW50cm9qcy1mdWxsYnV0dG9uIik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0eXBlb2YgcHJldlRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHByZXZUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgICBwcmV2VG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLXByZXZidXR0b24gaW50cm9qcy1kaXNhYmxlZCIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBza2lwVG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgc2tpcFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICBza2lwVG9vbHRpcEJ1dHRvbi5pbm5lckhUTUwgPSB0aGlzLl9vcHRpb25zLnNraXBMYWJlbDsKICAgICAgfQogICAgfSBlbHNlIGlmICh0aGlzLl9pbnRyb0l0ZW1zLmxlbmd0aCAtIDEgPT09IHRoaXMuX2N1cnJlbnRTdGVwIHx8IHRoaXMuX2ludHJvSXRlbXMubGVuZ3RoID09PSAxKSB7CiAgICAgIC8vIGxhc3Qgc3RlcCBvZiB0b3VyCiAgICAgIGlmICh0eXBlb2Ygc2tpcFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHNraXBUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgc2tpcFRvb2x0aXBCdXR0b24uaW5uZXJIVE1MID0gdGhpcy5fb3B0aW9ucy5kb25lTGFiZWw7IC8vIGFkZGluZyBkb25lYnV0dG9uIGNsYXNzIGluIGFkZGl0aW9uIHRvIHNraXBidXR0b24KCiAgICAgICAgc2tpcFRvb2x0aXBCdXR0b24uc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUtYmxvY2siOwogICAgICAgIGFkZENsYXNzKHNraXBUb29sdGlwQnV0dG9uLCAiaW50cm9qcy1kb25lYnV0dG9uIik7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgcHJldlRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHByZXZUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgcHJldlRvb2x0aXBCdXR0b24uY2xhc3NOYW1lID0gIiIuY29uY2F0KHRoaXMuX29wdGlvbnMuYnV0dG9uQ2xhc3MsICIgaW50cm9qcy1wcmV2YnV0dG9uIik7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9vcHRpb25zLmhpZGVOZXh0ID09PSB0cnVlKSB7CiAgICAgICAgaWYgKHR5cGVvZiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgbmV4dFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICAgIG5leHRUb29sdGlwQnV0dG9uLmNsYXNzTmFtZSA9ICIiLmNvbmNhdCh0aGlzLl9vcHRpb25zLmJ1dHRvbkNsYXNzLCAiIGludHJvanMtbmV4dGJ1dHRvbiBpbnRyb2pzLWhpZGRlbiIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR5cGVvZiBwcmV2VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgcHJldlRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICAgIGFkZENsYXNzKHByZXZUb29sdGlwQnV0dG9uLCAiaW50cm9qcy1mdWxsYnV0dG9uIik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0eXBlb2YgbmV4dFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIG5leHRUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgICBuZXh0VG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLW5leHRidXR0b24gaW50cm9qcy1kaXNhYmxlZCIpOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gc3RlcHMgYmV0d2VlbiBzdGFydCBhbmQgZW5kCiAgICAgIGlmICh0eXBlb2Ygc2tpcFRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHNraXBUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgICAgc2tpcFRvb2x0aXBCdXR0b24uc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICBza2lwVG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLXNraXBidXR0b24iKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBwcmV2VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgcHJldlRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICBwcmV2VG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLXByZXZidXR0b24iKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgbmV4dFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICBuZXh0VG9vbHRpcEJ1dHRvbi5jbGFzc05hbWUgPSAiIi5jb25jYXQodGhpcy5fb3B0aW9ucy5idXR0b25DbGFzcywgIiBpbnRyb2pzLW5leHRidXR0b24iKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBza2lwVG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgc2tpcFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgICBza2lwVG9vbHRpcEJ1dHRvbi5pbm5lckhUTUwgPSB0aGlzLl9vcHRpb25zLnNraXBMYWJlbDsKICAgICAgfQogICAgfQoKICAgIGlmICh0eXBlb2YgcHJldlRvb2x0aXBCdXR0b24gIT09ICJ1bmRlZmluZWQiICYmIHByZXZUb29sdGlwQnV0dG9uICE9PSBudWxsKSB7CiAgICAgIHByZXZUb29sdGlwQnV0dG9uLnNldEF0dHJpYnV0ZSgicm9sZSIsICJidXR0b24iKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIG5leHRUb29sdGlwQnV0dG9uICE9PSAidW5kZWZpbmVkIiAmJiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gbnVsbCkgewogICAgICBuZXh0VG9vbHRpcEJ1dHRvbi5zZXRBdHRyaWJ1dGUoInJvbGUiLCAiYnV0dG9uIik7CiAgICB9CgogICAgaWYgKHR5cGVvZiBza2lwVG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgc2tpcFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgc2tpcFRvb2x0aXBCdXR0b24uc2V0QXR0cmlidXRlKCJyb2xlIiwgImJ1dHRvbiIpOwogICAgfSAvL1NldCBmb2N1cyBvbiAibmV4dCIgYnV0dG9uLCBzbyB0aGF0IGhpdHRpbmcgRW50ZXIgYWx3YXlzIG1vdmVzIHlvdSBvbnRvIHRoZSBuZXh0IHN0ZXAKCgogICAgaWYgKHR5cGVvZiBuZXh0VG9vbHRpcEJ1dHRvbiAhPT0gInVuZGVmaW5lZCIgJiYgbmV4dFRvb2x0aXBCdXR0b24gIT09IG51bGwpIHsKICAgICAgbmV4dFRvb2x0aXBCdXR0b24uZm9jdXMoKTsKICAgIH0KCiAgICBzZXRTaG93RWxlbWVudCh0YXJnZXRFbGVtZW50KTsKCiAgICBpZiAodHlwZW9mIHRoaXMuX2ludHJvQWZ0ZXJDaGFuZ2VDYWxsYmFjayAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgdGhpcy5faW50cm9BZnRlckNoYW5nZUNhbGxiYWNrLmNhbGwodGhpcywgdGFyZ2V0RWxlbWVudC5lbGVtZW50KTsKICAgIH0KICB9CiAgLyoqCiAgICogR28gdG8gc3BlY2lmaWMgc3RlcCBvZiBpbnRyb2R1Y3Rpb24KICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2dvVG9TdGVwCiAgICovCgoKICBmdW5jdGlvbiBnb1RvU3RlcChzdGVwKSB7CiAgICAvL2JlY2F1c2Ugc3RlcHMgc3RhcnRzIHdpdGggemVybwogICAgdGhpcy5fY3VycmVudFN0ZXAgPSBzdGVwIC0gMjsKCiAgICBpZiAodHlwZW9mIHRoaXMuX2ludHJvSXRlbXMgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIG5leHRTdGVwLmNhbGwodGhpcyk7CiAgICB9CiAgfQogIC8qKgogICAqIEdvIHRvIHRoZSBzcGVjaWZpYyBzdGVwIG9mIGludHJvZHVjdGlvbiB3aXRoIHRoZSBleHBsaWNpdCBbZGF0YS1zdGVwXSBudW1iZXIKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2dvVG9TdGVwTnVtYmVyCiAgICovCgoKICBmdW5jdGlvbiBnb1RvU3RlcE51bWJlcihzdGVwKSB7CiAgICB0aGlzLl9jdXJyZW50U3RlcE51bWJlciA9IHN0ZXA7CgogICAgaWYgKHR5cGVvZiB0aGlzLl9pbnRyb0l0ZW1zICE9PSAidW5kZWZpbmVkIikgewogICAgICBuZXh0U3RlcC5jYWxsKHRoaXMpOwogICAgfQogIH0KICAvKioKICAgKiBHbyB0byBuZXh0IHN0ZXAgb24gaW50cm8KICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX25leHRTdGVwCiAgICovCgoKICBmdW5jdGlvbiBuZXh0U3RlcCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdGhpcy5fZGlyZWN0aW9uID0gImZvcndhcmQiOwoKICAgIGlmICh0eXBlb2YgdGhpcy5fY3VycmVudFN0ZXBOdW1iZXIgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGZvckVhY2godGhpcy5faW50cm9JdGVtcywgZnVuY3Rpb24gKF9yZWYsIGkpIHsKICAgICAgICB2YXIgc3RlcCA9IF9yZWYuc3RlcDsKCiAgICAgICAgaWYgKHN0ZXAgPT09IF90aGlzLl9jdXJyZW50U3RlcE51bWJlcikgewogICAgICAgICAgX3RoaXMuX2N1cnJlbnRTdGVwID0gaSAtIDE7CiAgICAgICAgICBfdGhpcy5fY3VycmVudFN0ZXBOdW1iZXIgPSB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICBpZiAodHlwZW9mIHRoaXMuX2N1cnJlbnRTdGVwID09PSAidW5kZWZpbmVkIikgewogICAgICB0aGlzLl9jdXJyZW50U3RlcCA9IDA7CiAgICB9IGVsc2UgewogICAgICArK3RoaXMuX2N1cnJlbnRTdGVwOwogICAgfQoKICAgIHZhciBuZXh0U3RlcCA9IHRoaXMuX2ludHJvSXRlbXNbdGhpcy5fY3VycmVudFN0ZXBdOwogICAgdmFyIGNvbnRpbnVlU3RlcCA9IHRydWU7CgogICAgaWYgKHR5cGVvZiB0aGlzLl9pbnRyb0JlZm9yZUNoYW5nZUNhbGxiYWNrICE9PSAidW5kZWZpbmVkIikgewogICAgICBjb250aW51ZVN0ZXAgPSB0aGlzLl9pbnRyb0JlZm9yZUNoYW5nZUNhbGxiYWNrLmNhbGwodGhpcywgbmV4dFN0ZXAuZWxlbWVudCk7CiAgICB9IC8vIGlmIGBvbmJlZm9yZWNoYW5nZWAgcmV0dXJuZWQgYGZhbHNlYCwgc3RvcCBkaXNwbGF5aW5nIHRoZSBlbGVtZW50CgoKICAgIGlmIChjb250aW51ZVN0ZXAgPT09IGZhbHNlKSB7CiAgICAgIC0tdGhpcy5fY3VycmVudFN0ZXA7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodGhpcy5faW50cm9JdGVtcy5sZW5ndGggPD0gdGhpcy5fY3VycmVudFN0ZXApIHsKICAgICAgLy9lbmQgb2YgdGhlIGludHJvCiAgICAgIC8vY2hlY2sgaWYgYW55IGNhbGxiYWNrIGlzIGRlZmluZWQKICAgICAgaWYgKHR5cGVvZiB0aGlzLl9pbnRyb0NvbXBsZXRlQ2FsbGJhY2sgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB0aGlzLl9pbnRyb0NvbXBsZXRlQ2FsbGJhY2suY2FsbCh0aGlzKTsKICAgICAgfQoKICAgICAgZXhpdEludHJvLmNhbGwodGhpcywgdGhpcy5fdGFyZ2V0RWxlbWVudCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBfc2hvd0VsZW1lbnQuY2FsbCh0aGlzLCBuZXh0U3RlcCk7CiAgfQogIC8qKgogICAqIEdvIHRvIHByZXZpb3VzIHN0ZXAgb24gaW50cm8KICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3ByZXZpb3VzU3RlcAogICAqLwoKCiAgZnVuY3Rpb24gcHJldmlvdXNTdGVwKCkgewogICAgdGhpcy5fZGlyZWN0aW9uID0gImJhY2t3YXJkIjsKCiAgICBpZiAodGhpcy5fY3VycmVudFN0ZXAgPT09IDApIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC0tdGhpcy5fY3VycmVudFN0ZXA7CiAgICB2YXIgbmV4dFN0ZXAgPSB0aGlzLl9pbnRyb0l0ZW1zW3RoaXMuX2N1cnJlbnRTdGVwXTsKICAgIHZhciBjb250aW51ZVN0ZXAgPSB0cnVlOwoKICAgIGlmICh0eXBlb2YgdGhpcy5faW50cm9CZWZvcmVDaGFuZ2VDYWxsYmFjayAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgY29udGludWVTdGVwID0gdGhpcy5faW50cm9CZWZvcmVDaGFuZ2VDYWxsYmFjay5jYWxsKHRoaXMsIG5leHRTdGVwLmVsZW1lbnQpOwogICAgfSAvLyBpZiBgb25iZWZvcmVjaGFuZ2VgIHJldHVybmVkIGBmYWxzZWAsIHN0b3AgZGlzcGxheWluZyB0aGUgZWxlbWVudAoKCiAgICBpZiAoY29udGludWVTdGVwID09PSBmYWxzZSkgewogICAgICArK3RoaXMuX2N1cnJlbnRTdGVwOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgX3Nob3dFbGVtZW50LmNhbGwodGhpcywgbmV4dFN0ZXApOwogIH0KICAvKioKICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHN0ZXAgb2YgdGhlIGludHJvCiAgICoKICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0KICAgKi8KCgogIGZ1bmN0aW9uIGN1cnJlbnRTdGVwKCkgewogICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRTdGVwOwogIH0KICAvKioKICAgKiBvbiBrZXlDb2RlOgogICAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9LZXlib2FyZEV2ZW50L2tleUNvZGUKICAgKiBUaGlzIGZlYXR1cmUgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBXZWIgc3RhbmRhcmRzLgogICAqIFRob3VnaCBzb21lIGJyb3dzZXJzIG1heSBzdGlsbCBzdXBwb3J0IGl0LCBpdCBpcyBpbgogICAqIHRoZSBwcm9jZXNzIG9mIGJlaW5nIGRyb3BwZWQuCiAgICogSW5zdGVhZCwgeW91IHNob3VsZCB1c2UgS2V5Ym9hcmRFdmVudC5jb2RlLAogICAqIGlmIGl0J3MgaW1wbGVtZW50ZWQuCiAgICoKICAgKiBqUXVlcnkncyBhcHByb2FjaCBpcyB0byB0ZXN0IGZvcgogICAqICAgKDEpIGUud2hpY2gsIHRoZW4KICAgKiAgICgyKSBlLmNoYXJDb2RlLCB0aGVuCiAgICogICAoMykgZS5rZXlDb2RlCiAgICogaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvYmxvYi9hNmIwNzA1Mjk0ZDMzNmFlMmY2M2Y3Mjc2ZGUwZGExMTk1NDk1MzYzL3NyYy9ldmVudC5qcyNMNjM4CiAgICoKICAgKiBAcGFyYW0gdHlwZSB2YXIKICAgKiBAcmV0dXJuIHR5cGUKICAgKi8KCgogIGZ1bmN0aW9uIG9uS2V5RG93bihlKSB7CiAgICB2YXIgY29kZSA9IGUuY29kZSA9PT0gbnVsbCA/IGUud2hpY2ggOiBlLmNvZGU7IC8vIGlmIGNvZGUvZS53aGljaCBpcyBudWxsCgogICAgaWYgKGNvZGUgPT09IG51bGwpIHsKICAgICAgY29kZSA9IGUuY2hhckNvZGUgPT09IG51bGwgPyBlLmtleUNvZGUgOiBlLmNoYXJDb2RlOwogICAgfQoKICAgIGlmICgoY29kZSA9PT0gIkVzY2FwZSIgfHwgY29kZSA9PT0gMjcpICYmIHRoaXMuX29wdGlvbnMuZXhpdE9uRXNjID09PSB0cnVlKSB7CiAgICAgIC8vZXNjYXBlIGtleSBwcmVzc2VkLCBleGl0IHRoZSBpbnRybwogICAgICAvL2NoZWNrIGlmIGV4aXQgY2FsbGJhY2sgaXMgZGVmaW5lZAogICAgICBleGl0SW50cm8uY2FsbCh0aGlzLCB0aGlzLl90YXJnZXRFbGVtZW50KTsKICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gIkFycm93TGVmdCIgfHwgY29kZSA9PT0gMzcpIHsKICAgICAgLy9sZWZ0IGFycm93CiAgICAgIHByZXZpb3VzU3RlcC5jYWxsKHRoaXMpOwogICAgfSBlbHNlIGlmIChjb2RlID09PSAiQXJyb3dSaWdodCIgfHwgY29kZSA9PT0gMzkpIHsKICAgICAgLy9yaWdodCBhcnJvdwogICAgICBuZXh0U3RlcC5jYWxsKHRoaXMpOwogICAgfSBlbHNlIGlmIChjb2RlID09PSAiRW50ZXIiIHx8IGNvZGUgPT09IDEzKSB7CiAgICAgIC8vc3JjRWxlbWVudCA9PT0gaWUKICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKCiAgICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0LmNsYXNzTmFtZS5tYXRjaCgiaW50cm9qcy1wcmV2YnV0dG9uIikpIHsKICAgICAgICAvL3VzZXIgaGl0IGVudGVyIHdoaWxlIGZvY3VzaW5nIG9uIHByZXZpb3VzIGJ1dHRvbgogICAgICAgIHByZXZpb3VzU3RlcC5jYWxsKHRoaXMpOwogICAgICB9IGVsc2UgaWYgKHRhcmdldCAmJiB0YXJnZXQuY2xhc3NOYW1lLm1hdGNoKCJpbnRyb2pzLXNraXBidXR0b24iKSkgewogICAgICAgIC8vdXNlciBoaXQgZW50ZXIgd2hpbGUgZm9jdXNpbmcgb24gc2tpcCBidXR0b24KICAgICAgICBpZiAodGhpcy5faW50cm9JdGVtcy5sZW5ndGggLSAxID09PSB0aGlzLl9jdXJyZW50U3RlcCAmJiB0eXBlb2YgdGhpcy5faW50cm9Db21wbGV0ZUNhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICB0aGlzLl9pbnRyb0NvbXBsZXRlQ2FsbGJhY2suY2FsbCh0aGlzKTsKICAgICAgICB9CgogICAgICAgIGV4aXRJbnRyby5jYWxsKHRoaXMsIHRoaXMuX3RhcmdldEVsZW1lbnQpOwogICAgICB9IGVsc2UgaWYgKHRhcmdldCAmJiB0YXJnZXQuZ2V0QXR0cmlidXRlKCJkYXRhLXN0ZXBudW1iZXIiKSkgewogICAgICAgIC8vIHVzZXIgaGl0IGVudGVyIHdoaWxlIGZvY3VzaW5nIG9uIHN0ZXAgYnVsbGV0CiAgICAgICAgdGFyZ2V0LmNsaWNrKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy9kZWZhdWx0IGJlaGF2aW9yIGZvciByZXNwb25kaW5nIHRvIGVudGVyCiAgICAgICAgbmV4dFN0ZXAuY2FsbCh0aGlzKTsKICAgICAgfSAvL3ByZXZlbnQgZGVmYXVsdCBiZWhhdmlvdXIgb24gaGl0dGluZyBFbnRlciwgdG8gcHJldmVudCBzdGVwcyBiZWluZyBza2lwcGVkIGluIHNvbWUgYnJvd3NlcnMKCgogICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CiAgLyoKICAgKiBtYWtlcyBhIGNvcHkgb2YgdGhlIG9iamVjdAogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2Nsb25lT2JqZWN0CiAgICovCgoKICBmdW5jdGlvbiBjbG9uZU9iamVjdChvYmplY3QpIHsKICAgIGlmIChvYmplY3QgPT09IG51bGwgfHwgX3R5cGVvZihvYmplY3QpICE9PSAib2JqZWN0IiB8fCB0eXBlb2Ygb2JqZWN0Lm5vZGVUeXBlICE9PSAidW5kZWZpbmVkIikgewogICAgICByZXR1cm4gb2JqZWN0OwogICAgfQoKICAgIHZhciB0ZW1wID0ge307CgogICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkgewogICAgICBpZiAodHlwZW9mIHdpbmRvdy5qUXVlcnkgIT09ICJ1bmRlZmluZWQiICYmIG9iamVjdFtrZXldIGluc3RhbmNlb2Ygd2luZG93LmpRdWVyeSkgewogICAgICAgIHRlbXBba2V5XSA9IG9iamVjdFtrZXldOwogICAgICB9IGVsc2UgewogICAgICAgIHRlbXBba2V5XSA9IGNsb25lT2JqZWN0KG9iamVjdFtrZXldKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0ZW1wOwogIH0KICAvKioKICAgKiBHZXQgYSBxdWVyeXNlbGVjdG9yIHdpdGhpbiB0aGUgaGludCB3cmFwcGVyCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gc2VsZWN0b3IKICAgKiBAcmV0dXJuIHtOb2RlTGlzdHxBcnJheX0KICAgKi8KCgogIGZ1bmN0aW9uIGhpbnRRdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSB7CiAgICB2YXIgaGludHNXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtaGludHMiKTsKICAgIHJldHVybiBoaW50c1dyYXBwZXIgPyBoaW50c1dyYXBwZXIucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikgOiBbXTsKICB9CiAgLyoqCiAgICogSGlkZSBhIGhpbnQKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgaGlkZUhpbnQKICAgKi8KCgogIGZ1bmN0aW9uIGhpZGVIaW50KHN0ZXBJZCkgewogICAgdmFyIGhpbnQgPSBoaW50UXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtaGludFtkYXRhLXN0ZXA9XCIiLmNvbmNhdChzdGVwSWQsICJcIl0iKSlbMF07CiAgICByZW1vdmVIaW50VG9vbHRpcC5jYWxsKHRoaXMpOwoKICAgIGlmIChoaW50KSB7CiAgICAgIGFkZENsYXNzKGhpbnQsICJpbnRyb2pzLWhpZGVoaW50Iik7CiAgICB9IC8vIGNhbGwgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIChpZiBhbnkpCgoKICAgIGlmICh0eXBlb2YgdGhpcy5faGludENsb3NlQ2FsbGJhY2sgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHRoaXMuX2hpbnRDbG9zZUNhbGxiYWNrLmNhbGwodGhpcywgc3RlcElkKTsKICAgIH0KICB9CiAgLyoqCiAgICogSGlkZSBhbGwgaGludHMKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgaGlkZUhpbnRzCiAgICovCgoKICBmdW5jdGlvbiBoaWRlSGludHMoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHZhciBoaW50cyA9IGhpbnRRdWVyeVNlbGVjdG9yQWxsKCIuaW50cm9qcy1oaW50Iik7CiAgICBmb3JFYWNoKGhpbnRzLCBmdW5jdGlvbiAoaGludCkgewogICAgICBoaWRlSGludC5jYWxsKF90aGlzLCBoaW50LmdldEF0dHJpYnV0ZSgiZGF0YS1zdGVwIikpOwogICAgfSk7CiAgfQogIC8qKgogICAqIFNob3cgYWxsIGhpbnRzCiAgICoKICAgKiBAYXBpIHByaXZhdGUKICAgKiBAbWV0aG9kIF9zaG93SGludHMKICAgKi8KCgogIGZ1bmN0aW9uIHNob3dIaW50cygpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIHZhciBoaW50cyA9IGhpbnRRdWVyeVNlbGVjdG9yQWxsKCIuaW50cm9qcy1oaW50Iik7CgogICAgaWYgKGhpbnRzICYmIGhpbnRzLmxlbmd0aCkgewogICAgICBmb3JFYWNoKGhpbnRzLCBmdW5jdGlvbiAoaGludCkgewogICAgICAgIHNob3dIaW50LmNhbGwoX3RoaXMyLCBoaW50LmdldEF0dHJpYnV0ZSgiZGF0YS1zdGVwIikpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHBvcHVsYXRlSGludHMuY2FsbCh0aGlzLCB0aGlzLl90YXJnZXRFbGVtZW50KTsKICAgIH0KICB9CiAgLyoqCiAgICogU2hvdyBhIGhpbnQKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2Qgc2hvd0hpbnQKICAgKi8KCgogIGZ1bmN0aW9uIHNob3dIaW50KHN0ZXBJZCkgewogICAgdmFyIGhpbnQgPSBoaW50UXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtaGludFtkYXRhLXN0ZXA9XCIiLmNvbmNhdChzdGVwSWQsICJcIl0iKSlbMF07CgogICAgaWYgKGhpbnQpIHsKICAgICAgcmVtb3ZlQ2xhc3MoaGludCwgL2ludHJvanMtaGlkZWhpbnQvZyk7CiAgICB9CiAgfQogIC8qKgogICAqIFJlbW92ZXMgYWxsIGhpbnQgZWxlbWVudHMgb24gdGhlIHBhZ2UKICAgKiBVc2VmdWwgd2hlbiB5b3Ugd2FudCB0byBkZXN0cm95IHRoZSBlbGVtZW50cyBhbmQgYWRkIHRoZW0gYWdhaW4gKGUuZy4gYSBtb2RhbCBvciBwb3B1cCkKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgcmVtb3ZlSGludHMKICAgKi8KCgogIGZ1bmN0aW9uIHJlbW92ZUhpbnRzKCkgewogICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgdmFyIGhpbnRzID0gaGludFF1ZXJ5U2VsZWN0b3JBbGwoIi5pbnRyb2pzLWhpbnQiKTsKICAgIGZvckVhY2goaGludHMsIGZ1bmN0aW9uIChoaW50KSB7CiAgICAgIHJlbW92ZUhpbnQuY2FsbChfdGhpczMsIGhpbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXN0ZXAiKSk7CiAgICB9KTsKICB9CiAgLyoqCiAgICogUmVtb3ZlIG9uZSBzaW5nbGUgaGludCBlbGVtZW50IGZyb20gdGhlIHBhZ2UKICAgKiBVc2VmdWwgd2hlbiB5b3Ugd2FudCB0byBkZXN0cm95IHRoZSBlbGVtZW50IGFuZCBhZGQgdGhlbSBhZ2FpbiAoZS5nLiBhIG1vZGFsIG9yIHBvcHVwKQogICAqIFVzZSByZW1vdmVIaW50cyBpZiB5b3Ugd2FudCB0byByZW1vdmUgYWxsIGVsZW1lbnRzLgogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCByZW1vdmVIaW50CiAgICovCgoKICBmdW5jdGlvbiByZW1vdmVIaW50KHN0ZXBJZCkgewogICAgdmFyIGhpbnQgPSBoaW50UXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtaGludFtkYXRhLXN0ZXA9XCIiLmNvbmNhdChzdGVwSWQsICJcIl0iKSlbMF07CgogICAgaWYgKGhpbnQpIHsKICAgICAgaGludC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGhpbnQpOwogICAgfQogIH0KICAvKioKICAgKiBBZGQgYWxsIGF2YWlsYWJsZSBoaW50cyB0byB0aGUgcGFnZQogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBhZGRIaW50cwogICAqLwoKCiAgZnVuY3Rpb24gYWRkSGludHMoKSB7CiAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICB2YXIgaGludHNXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtaGludHMiKTsKCiAgICBpZiAoaGludHNXcmFwcGVyID09PSBudWxsKSB7CiAgICAgIGhpbnRzV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBoaW50c1dyYXBwZXIuY2xhc3NOYW1lID0gImludHJvanMtaGludHMiOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFuIGV2ZW50IGhhbmRsZXIgdW5pcXVlIHRvIHRoZSBoaW50IGl0ZXJhdGlvbgogICAgICoKICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gaQogICAgICogQHJldHVybiB7RnVuY3Rpb259CiAgICAgKi8KCgogICAgdmFyIGdldEhpbnRDbGljayA9IGZ1bmN0aW9uIGdldEhpbnRDbGljayhpKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciBldnQgPSBlID8gZSA6IHdpbmRvdy5ldmVudDsKCiAgICAgICAgaWYgKGV2dC5zdG9wUHJvcGFnYXRpb24pIHsKICAgICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICB9CgogICAgICAgIGlmIChldnQuY2FuY2VsQnViYmxlICE9PSBudWxsKSB7CiAgICAgICAgICBldnQuY2FuY2VsQnViYmxlID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHNob3dIaW50RGlhbG9nLmNhbGwoc2VsZiwgaSk7CiAgICAgIH07CiAgICB9OwoKICAgIGZvckVhY2godGhpcy5faW50cm9JdGVtcywgZnVuY3Rpb24gKGl0ZW0sIGkpIHsKICAgICAgLy8gYXZvaWQgYXBwZW5kIGEgaGludCB0d2ljZQogICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtaGludFtkYXRhLXN0ZXA9XCIiLmNvbmNhdChpLCAiXCJdIikpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgaGludCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgc2V0QW5jaG9yQXNCdXR0b24oaGludCk7CiAgICAgIGhpbnQub25jbGljayA9IGdldEhpbnRDbGljayhpKTsKICAgICAgaGludC5jbGFzc05hbWUgPSAiaW50cm9qcy1oaW50IjsKCiAgICAgIGlmICghaXRlbS5oaW50QW5pbWF0aW9uKSB7CiAgICAgICAgYWRkQ2xhc3MoaGludCwgImludHJvanMtaGludC1uby1hbmltIik7CiAgICAgIH0gLy8gaGludCdzIHBvc2l0aW9uIHNob3VsZCBiZSBmaXhlZCBpZiB0aGUgdGFyZ2V0IGVsZW1lbnQncyBwb3NpdGlvbiBpcyBmaXhlZAoKCiAgICAgIGlmIChpc0ZpeGVkKGl0ZW0uZWxlbWVudCkpIHsKICAgICAgICBhZGRDbGFzcyhoaW50LCAiaW50cm9qcy1maXhlZGhpbnQiKTsKICAgICAgfQoKICAgICAgdmFyIGhpbnREb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgaGludERvdC5jbGFzc05hbWUgPSAiaW50cm9qcy1oaW50LWRvdCI7CiAgICAgIHZhciBoaW50UHVsc2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgaGludFB1bHNlLmNsYXNzTmFtZSA9ICJpbnRyb2pzLWhpbnQtcHVsc2UiOwogICAgICBoaW50LmFwcGVuZENoaWxkKGhpbnREb3QpOwogICAgICBoaW50LmFwcGVuZENoaWxkKGhpbnRQdWxzZSk7CiAgICAgIGhpbnQuc2V0QXR0cmlidXRlKCJkYXRhLXN0ZXAiLCBpKTsgLy8gd2Ugc3dhcCB0aGUgaGludCBlbGVtZW50IHdpdGggdGFyZ2V0IGVsZW1lbnQKICAgICAgLy8gYmVjYXVzZSBfc2V0SGVscGVyTGF5ZXJQb3NpdGlvbiB1c2VzIGBlbGVtZW50YCBwcm9wZXJ0eQoKICAgICAgaXRlbS50YXJnZXRFbGVtZW50ID0gaXRlbS5lbGVtZW50OwogICAgICBpdGVtLmVsZW1lbnQgPSBoaW50OyAvLyBhbGlnbiB0aGUgaGludCBwb3NpdGlvbgoKICAgICAgYWxpZ25IaW50UG9zaXRpb24uY2FsbChfdGhpczQsIGl0ZW0uaGludFBvc2l0aW9uLCBoaW50LCBpdGVtLnRhcmdldEVsZW1lbnQpOwogICAgICBoaW50c1dyYXBwZXIuYXBwZW5kQ2hpbGQoaGludCk7CiAgICB9KTsgLy8gYWRkaW5nIHRoZSBoaW50cyB3cmFwcGVyCgogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChoaW50c1dyYXBwZXIpOyAvLyBjYWxsIHRoZSBjYWxsYmFjayBmdW5jdGlvbiAoaWYgYW55KQoKICAgIGlmICh0eXBlb2YgdGhpcy5faGludHNBZGRlZENhbGxiYWNrICE9PSAidW5kZWZpbmVkIikgewogICAgICB0aGlzLl9oaW50c0FkZGVkQ2FsbGJhY2suY2FsbCh0aGlzKTsKICAgIH0KICB9CiAgLyoqCiAgICogQWxpZ25zIGhpbnQgcG9zaXRpb24KICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgYWxpZ25IaW50UG9zaXRpb24KICAgKiBAcGFyYW0ge1N0cmluZ30gcG9zaXRpb24KICAgKiBAcGFyYW0ge09iamVjdH0gaGludAogICAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50CiAgICovCgoKICBmdW5jdGlvbiBhbGlnbkhpbnRQb3NpdGlvbihwb3NpdGlvbiwgX3JlZiwgZWxlbWVudCkgewogICAgdmFyIHN0eWxlID0gX3JlZi5zdHlsZTsgLy8gZ2V0L2NhbGN1bGF0ZSBvZmZzZXQgb2YgdGFyZ2V0IGVsZW1lbnQKCiAgICB2YXIgb2Zmc2V0ID0gZ2V0T2Zmc2V0LmNhbGwodGhpcywgZWxlbWVudCk7CiAgICB2YXIgaWNvbldpZHRoID0gMjA7CiAgICB2YXIgaWNvbkhlaWdodCA9IDIwOyAvLyBhbGlnbiB0aGUgaGludCBlbGVtZW50CgogICAgc3dpdGNoIChwb3NpdGlvbikgewogICAgICBkZWZhdWx0OgogICAgICBjYXNlICJ0b3AtbGVmdCI6CiAgICAgICAgc3R5bGUubGVmdCA9ICIiLmNvbmNhdChvZmZzZXQubGVmdCwgInB4Iik7CiAgICAgICAgc3R5bGUudG9wID0gIiIuY29uY2F0KG9mZnNldC50b3AsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAidG9wLXJpZ2h0IjoKICAgICAgICBzdHlsZS5sZWZ0ID0gIiIuY29uY2F0KG9mZnNldC5sZWZ0ICsgb2Zmc2V0LndpZHRoIC0gaWNvbldpZHRoLCAicHgiKTsKICAgICAgICBzdHlsZS50b3AgPSAiIi5jb25jYXQob2Zmc2V0LnRvcCwgInB4Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJib3R0b20tbGVmdCI6CiAgICAgICAgc3R5bGUubGVmdCA9ICIiLmNvbmNhdChvZmZzZXQubGVmdCwgInB4Iik7CiAgICAgICAgc3R5bGUudG9wID0gIiIuY29uY2F0KG9mZnNldC50b3AgKyBvZmZzZXQuaGVpZ2h0IC0gaWNvbkhlaWdodCwgInB4Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJib3R0b20tcmlnaHQiOgogICAgICAgIHN0eWxlLmxlZnQgPSAiIi5jb25jYXQob2Zmc2V0LmxlZnQgKyBvZmZzZXQud2lkdGggLSBpY29uV2lkdGgsICJweCIpOwogICAgICAgIHN0eWxlLnRvcCA9ICIiLmNvbmNhdChvZmZzZXQudG9wICsgb2Zmc2V0LmhlaWdodCAtIGljb25IZWlnaHQsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAibWlkZGxlLWxlZnQiOgogICAgICAgIHN0eWxlLmxlZnQgPSAiIi5jb25jYXQob2Zmc2V0LmxlZnQsICJweCIpOwogICAgICAgIHN0eWxlLnRvcCA9ICIiLmNvbmNhdChvZmZzZXQudG9wICsgKG9mZnNldC5oZWlnaHQgLSBpY29uSGVpZ2h0KSAvIDIsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAibWlkZGxlLXJpZ2h0IjoKICAgICAgICBzdHlsZS5sZWZ0ID0gIiIuY29uY2F0KG9mZnNldC5sZWZ0ICsgb2Zmc2V0LndpZHRoIC0gaWNvbldpZHRoLCAicHgiKTsKICAgICAgICBzdHlsZS50b3AgPSAiIi5jb25jYXQob2Zmc2V0LnRvcCArIChvZmZzZXQuaGVpZ2h0IC0gaWNvbkhlaWdodCkgLyAyLCAicHgiKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgIm1pZGRsZS1taWRkbGUiOgogICAgICAgIHN0eWxlLmxlZnQgPSAiIi5jb25jYXQob2Zmc2V0LmxlZnQgKyAob2Zmc2V0LndpZHRoIC0gaWNvbldpZHRoKSAvIDIsICJweCIpOwogICAgICAgIHN0eWxlLnRvcCA9ICIiLmNvbmNhdChvZmZzZXQudG9wICsgKG9mZnNldC5oZWlnaHQgLSBpY29uSGVpZ2h0KSAvIDIsICJweCIpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiYm90dG9tLW1pZGRsZSI6CiAgICAgICAgc3R5bGUubGVmdCA9ICIiLmNvbmNhdChvZmZzZXQubGVmdCArIChvZmZzZXQud2lkdGggLSBpY29uV2lkdGgpIC8gMiwgInB4Iik7CiAgICAgICAgc3R5bGUudG9wID0gIiIuY29uY2F0KG9mZnNldC50b3AgKyBvZmZzZXQuaGVpZ2h0IC0gaWNvbkhlaWdodCwgInB4Iik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICJ0b3AtbWlkZGxlIjoKICAgICAgICBzdHlsZS5sZWZ0ID0gIiIuY29uY2F0KG9mZnNldC5sZWZ0ICsgKG9mZnNldC53aWR0aCAtIGljb25XaWR0aCkgLyAyLCAicHgiKTsKICAgICAgICBzdHlsZS50b3AgPSAiIi5jb25jYXQob2Zmc2V0LnRvcCwgInB4Iik7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQogIC8qKgogICAqIFRyaWdnZXJzIHdoZW4gdXNlciBjbGlja3Mgb24gdGhlIGhpbnQgZWxlbWVudAogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfc2hvd0hpbnREaWFsb2cKICAgKiBAcGFyYW0ge051bWJlcn0gc3RlcElkCiAgICovCgoKICBmdW5jdGlvbiBzaG93SGludERpYWxvZyhzdGVwSWQpIHsKICAgIHZhciBoaW50RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhpbnRbZGF0YS1zdGVwPVwiIi5jb25jYXQoc3RlcElkLCAiXCJdIikpOwogICAgdmFyIGl0ZW0gPSB0aGlzLl9pbnRyb0l0ZW1zW3N0ZXBJZF07IC8vIGNhbGwgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIChpZiBhbnkpCgogICAgaWYgKHR5cGVvZiB0aGlzLl9oaW50Q2xpY2tDYWxsYmFjayAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgdGhpcy5faGludENsaWNrQ2FsbGJhY2suY2FsbCh0aGlzLCBoaW50RWxlbWVudCwgaXRlbSwgc3RlcElkKTsKICAgIH0gLy8gcmVtb3ZlIGFsbCBvcGVuIHRvb2x0aXBzCgoKICAgIHZhciByZW1vdmVkU3RlcCA9IHJlbW92ZUhpbnRUb29sdGlwLmNhbGwodGhpcyk7IC8vIHRvIHRvZ2dsZSB0aGUgdG9vbHRpcAoKICAgIGlmIChwYXJzZUludChyZW1vdmVkU3RlcCwgMTApID09PSBzdGVwSWQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciB0b29sdGlwTGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIHZhciB0b29sdGlwVGV4dExheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICB2YXIgYXJyb3dMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgdmFyIHJlZmVyZW5jZUxheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICB0b29sdGlwTGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtdG9vbHRpcCI7CgogICAgdG9vbHRpcExheWVyLm9uY2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICAvL0lFOSAmIE90aGVyIEJyb3dzZXJzCiAgICAgIGlmIChlLnN0b3BQcm9wYWdhdGlvbikgewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0gLy9JRTggYW5kIExvd2VyCiAgICAgIGVsc2UgewogICAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlOwogICAgICAgIH0KICAgIH07CgogICAgdG9vbHRpcFRleHRMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy10b29sdGlwdGV4dCI7CiAgICB2YXIgdG9vbHRpcFdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJwIik7CiAgICB0b29sdGlwV3JhcHBlci5pbm5lckhUTUwgPSBpdGVtLmhpbnQ7CiAgICB2YXIgY2xvc2VCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICBjbG9zZUJ1dHRvbi5jbGFzc05hbWUgPSB0aGlzLl9vcHRpb25zLmJ1dHRvbkNsYXNzOwogICAgY2xvc2VCdXR0b24uc2V0QXR0cmlidXRlKCJyb2xlIiwgImJ1dHRvbiIpOwogICAgY2xvc2VCdXR0b24uaW5uZXJIVE1MID0gdGhpcy5fb3B0aW9ucy5oaW50QnV0dG9uTGFiZWw7CiAgICBjbG9zZUJ1dHRvbi5vbmNsaWNrID0gaGlkZUhpbnQuYmluZCh0aGlzLCBzdGVwSWQpOwogICAgdG9vbHRpcFRleHRMYXllci5hcHBlbmRDaGlsZCh0b29sdGlwV3JhcHBlcik7CiAgICB0b29sdGlwVGV4dExheWVyLmFwcGVuZENoaWxkKGNsb3NlQnV0dG9uKTsKICAgIGFycm93TGF5ZXIuY2xhc3NOYW1lID0gImludHJvanMtYXJyb3ciOwogICAgdG9vbHRpcExheWVyLmFwcGVuZENoaWxkKGFycm93TGF5ZXIpOwogICAgdG9vbHRpcExheWVyLmFwcGVuZENoaWxkKHRvb2x0aXBUZXh0TGF5ZXIpOyAvLyBzZXQgY3VycmVudCBzdGVwIGZvciBfcGxhY2VUb29sdGlwIGZ1bmN0aW9uCgogICAgdGhpcy5fY3VycmVudFN0ZXAgPSBoaW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtc3RlcCIpOyAvLyBhbGlnbiByZWZlcmVuY2UgbGF5ZXIgcG9zaXRpb24KCiAgICByZWZlcmVuY2VMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy10b29sdGlwUmVmZXJlbmNlTGF5ZXIgaW50cm9qcy1oaW50UmVmZXJlbmNlIjsKICAgIHJlZmVyZW5jZUxheWVyLnNldEF0dHJpYnV0ZSgiZGF0YS1zdGVwIiwgaGludEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXN0ZXAiKSk7CiAgICBzZXRIZWxwZXJMYXllclBvc2l0aW9uLmNhbGwodGhpcywgcmVmZXJlbmNlTGF5ZXIpOwogICAgcmVmZXJlbmNlTGF5ZXIuYXBwZW5kQ2hpbGQodG9vbHRpcExheWVyKTsKICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocmVmZXJlbmNlTGF5ZXIpOyAvL3NldCBwcm9wZXIgcG9zaXRpb24KCiAgICBwbGFjZVRvb2x0aXAuY2FsbCh0aGlzLCBoaW50RWxlbWVudCwgdG9vbHRpcExheWVyLCBhcnJvd0xheWVyLCBudWxsLCB0cnVlKTsKICB9CiAgLyoqCiAgICogUmVtb3ZlcyBvcGVuIGhpbnQgKHRvb2x0aXAgaGludCkKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX3JlbW92ZUhpbnRUb29sdGlwCiAgICovCgoKICBmdW5jdGlvbiByZW1vdmVIaW50VG9vbHRpcCgpIHsKICAgIHZhciB0b29sdGlwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtaGludFJlZmVyZW5jZSIpOwoKICAgIGlmICh0b29sdGlwKSB7CiAgICAgIHZhciBzdGVwID0gdG9vbHRpcC5nZXRBdHRyaWJ1dGUoImRhdGEtc3RlcCIpOwogICAgICB0b29sdGlwLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodG9vbHRpcCk7CiAgICAgIHJldHVybiBzdGVwOwogICAgfQogIH0KICAvKioKICAgKiBTdGFydCBwYXJzaW5nIGhpbnQgaXRlbXMKICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRFbG0KICAgKiBAbWV0aG9kIF9zdGFydEhpbnQKICAgKi8KCgogIGZ1bmN0aW9uIHBvcHVsYXRlSGludHModGFyZ2V0RWxtKSB7CiAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICB0aGlzLl9pbnRyb0l0ZW1zID0gW107CgogICAgaWYgKHRoaXMuX29wdGlvbnMuaGludHMpIHsKICAgICAgZm9yRWFjaCh0aGlzLl9vcHRpb25zLmhpbnRzLCBmdW5jdGlvbiAoaGludCkgewogICAgICAgIHZhciBjdXJyZW50SXRlbSA9IGNsb25lT2JqZWN0KGhpbnQpOwoKICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnRJdGVtLmVsZW1lbnQgPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAvL2dyYWIgdGhlIGVsZW1lbnQgd2l0aCBnaXZlbiBzZWxlY3RvciBmcm9tIHRoZSBwYWdlCiAgICAgICAgICBjdXJyZW50SXRlbS5lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjdXJyZW50SXRlbS5lbGVtZW50KTsKICAgICAgICB9CgogICAgICAgIGN1cnJlbnRJdGVtLmhpbnRQb3NpdGlvbiA9IGN1cnJlbnRJdGVtLmhpbnRQb3NpdGlvbiB8fCBfdGhpczUuX29wdGlvbnMuaGludFBvc2l0aW9uOwogICAgICAgIGN1cnJlbnRJdGVtLmhpbnRBbmltYXRpb24gPSBjdXJyZW50SXRlbS5oaW50QW5pbWF0aW9uIHx8IF90aGlzNS5fb3B0aW9ucy5oaW50QW5pbWF0aW9uOwoKICAgICAgICBpZiAoY3VycmVudEl0ZW0uZWxlbWVudCAhPT0gbnVsbCkgewogICAgICAgICAgX3RoaXM1Ll9pbnRyb0l0ZW1zLnB1c2goY3VycmVudEl0ZW0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICB2YXIgaGludHMgPSB0YXJnZXRFbG0ucXVlcnlTZWxlY3RvckFsbCgiKltkYXRhLWhpbnRdIik7CgogICAgICBpZiAoIWhpbnRzIHx8ICFoaW50cy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy9maXJzdCBhZGQgaW50cm8gaXRlbXMgd2l0aCBkYXRhLXN0ZXAKCgogICAgICBmb3JFYWNoKGhpbnRzLCBmdW5jdGlvbiAoY3VycmVudEVsZW1lbnQpIHsKICAgICAgICAvLyBoaW50IGFuaW1hdGlvbgogICAgICAgIHZhciBoaW50QW5pbWF0aW9uID0gY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLWhpbnRhbmltYXRpb24iKTsKCiAgICAgICAgaWYgKGhpbnRBbmltYXRpb24pIHsKICAgICAgICAgIGhpbnRBbmltYXRpb24gPSBoaW50QW5pbWF0aW9uID09PSAidHJ1ZSI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhpbnRBbmltYXRpb24gPSBfdGhpczUuX29wdGlvbnMuaGludEFuaW1hdGlvbjsKICAgICAgICB9CgogICAgICAgIF90aGlzNS5faW50cm9JdGVtcy5wdXNoKHsKICAgICAgICAgIGVsZW1lbnQ6IGN1cnJlbnRFbGVtZW50LAogICAgICAgICAgaGludDogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLWhpbnQiKSwKICAgICAgICAgIGhpbnRQb3NpdGlvbjogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLWhpbnRwb3NpdGlvbiIpIHx8IF90aGlzNS5fb3B0aW9ucy5oaW50UG9zaXRpb24sCiAgICAgICAgICBoaW50QW5pbWF0aW9uOiBoaW50QW5pbWF0aW9uLAogICAgICAgICAgdG9vbHRpcENsYXNzOiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtdG9vbHRpcGNsYXNzIiksCiAgICAgICAgICBwb3NpdGlvbjogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXBvc2l0aW9uIikgfHwgX3RoaXM1Ll9vcHRpb25zLnRvb2x0aXBQb3NpdGlvbgogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICBhZGRIaW50cy5jYWxsKHRoaXMpOwogICAgLyoKICAgIHRvZG86CiAgICB0aGVzZSBldmVudHMgc2hvdWxkIGJlIHJlbW92ZWQgYXQgc29tZSBwb2ludAogICAgKi8KCiAgICBET01FdmVudC5vbihkb2N1bWVudCwgImNsaWNrIiwgcmVtb3ZlSGludFRvb2x0aXAsIHRoaXMsIGZhbHNlKTsKICAgIERPTUV2ZW50Lm9uKHdpbmRvdywgInJlc2l6ZSIsIHJlQWxpZ25IaW50cywgdGhpcywgdHJ1ZSk7CiAgfQogIC8qKgogICAqIFJlLWFsaWducyBhbGwgaGludCBlbGVtZW50cwogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfcmVBbGlnbkhpbnRzCiAgICovCgoKICBmdW5jdGlvbiByZUFsaWduSGludHMoKSB7CiAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICBmb3JFYWNoKHRoaXMuX2ludHJvSXRlbXMsIGZ1bmN0aW9uIChfcmVmMikgewogICAgICB2YXIgdGFyZ2V0RWxlbWVudCA9IF9yZWYyLnRhcmdldEVsZW1lbnQsCiAgICAgICAgICBoaW50UG9zaXRpb24gPSBfcmVmMi5oaW50UG9zaXRpb24sCiAgICAgICAgICBlbGVtZW50ID0gX3JlZjIuZWxlbWVudDsKCiAgICAgIGlmICh0eXBlb2YgdGFyZ2V0RWxlbWVudCA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGFsaWduSGludFBvc2l0aW9uLmNhbGwoX3RoaXM2LCBoaW50UG9zaXRpb24sIGVsZW1lbnQsIHRhcmdldEVsZW1lbnQpOwogICAgfSk7CiAgfQogIC8qKgogICAqIFVwZGF0ZSBwbGFjZW1lbnQgb2YgdGhlIGludHJvIG9iamVjdHMgb24gdGhlIHNjcmVlbgogICAqIEBhcGkgcHJpdmF0ZQogICAqLwoKCiAgZnVuY3Rpb24gcmVmcmVzaCgpIHsKICAgIC8vIHJlLWFsaWduIGludHJvcwogICAgc2V0SGVscGVyTGF5ZXJQb3NpdGlvbi5jYWxsKHRoaXMsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWhlbHBlckxheWVyIikpOwogICAgc2V0SGVscGVyTGF5ZXJQb3NpdGlvbi5jYWxsKHRoaXMsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLXRvb2x0aXBSZWZlcmVuY2VMYXllciIpKTsKICAgIHNldEhlbHBlckxheWVyUG9zaXRpb24uY2FsbCh0aGlzLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1kaXNhYmxlSW50ZXJhY3Rpb24iKSk7IC8vIHJlLWFsaWduIHRvb2x0aXAKCiAgICBpZiAodGhpcy5fY3VycmVudFN0ZXAgIT09IHVuZGVmaW5lZCAmJiB0aGlzLl9jdXJyZW50U3RlcCAhPT0gbnVsbCkgewogICAgICB2YXIgb2xkSGVscGVyTnVtYmVyTGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy1oZWxwZXJOdW1iZXJMYXllciIpOwogICAgICB2YXIgb2xkQXJyb3dMYXllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnRyb2pzLWFycm93Iik7CiAgICAgIHZhciBvbGR0b29sdGlwQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtdG9vbHRpcCIpOwogICAgICBwbGFjZVRvb2x0aXAuY2FsbCh0aGlzLCB0aGlzLl9pbnRyb0l0ZW1zW3RoaXMuX2N1cnJlbnRTdGVwXS5lbGVtZW50LCBvbGR0b29sdGlwQ29udGFpbmVyLCBvbGRBcnJvd0xheWVyLCBvbGRIZWxwZXJOdW1iZXJMYXllcik7CiAgICB9IC8vcmUtYWxpZ24gaGludHMKCgogICAgcmVBbGlnbkhpbnRzLmNhbGwodGhpcyk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIGZ1bmN0aW9uIG9uUmVzaXplKCkgewogICAgcmVmcmVzaC5jYWxsKHRoaXMpOwogIH0KICAvKioKICAgKiBFeGl0IGZyb20gaW50cm8KICAgKgogICAqIEBhcGkgcHJpdmF0ZQogICAqIEBtZXRob2QgX2V4aXRJbnRybwogICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRFbGVtZW50CiAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZSAtIFNldHRpbmcgdG8gYHRydWVgIHdpbGwgc2tpcCB0aGUgcmVzdWx0IG9mIGJlZm9yZUV4aXQgY2FsbGJhY2sKICAgKi8KCgogIGZ1bmN0aW9uIGV4aXRJbnRybyh0YXJnZXRFbGVtZW50LCBmb3JjZSkgewogICAgdmFyIGNvbnRpbnVlRXhpdCA9IHRydWU7IC8vIGNhbGxpbmcgb25iZWZvcmVleGl0IGNhbGxiYWNrCiAgICAvLwogICAgLy8gSWYgdGhpcyBjYWxsYmFjayByZXR1cm4gYGZhbHNlYCwgaXQgd291bGQgaGFsdCB0aGUgcHJvY2VzcwoKICAgIGlmICh0aGlzLl9pbnRyb0JlZm9yZUV4aXRDYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGNvbnRpbnVlRXhpdCA9IHRoaXMuX2ludHJvQmVmb3JlRXhpdENhbGxiYWNrLmNhbGwodGhpcyk7CiAgICB9IC8vIHNraXAgdGhpcyBjaGVjayBpZiBgZm9yY2VgIHBhcmFtZXRlciBpcyBgdHJ1ZWAKICAgIC8vIG90aGVyd2lzZSwgaWYgYG9uYmVmb3JlZXhpdGAgcmV0dXJuZWQgYGZhbHNlYCwgZG9uJ3QgZXhpdCB0aGUgaW50cm8KCgogICAgaWYgKCFmb3JjZSAmJiBjb250aW51ZUV4aXQgPT09IGZhbHNlKSByZXR1cm47IC8vcmVtb3ZlIG92ZXJsYXkgbGF5ZXJzIGZyb20gdGhlIHBhZ2UKCiAgICB2YXIgb3ZlcmxheUxheWVycyA9IHRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLmludHJvanMtb3ZlcmxheSIpOwoKICAgIGlmIChvdmVybGF5TGF5ZXJzICYmIG92ZXJsYXlMYXllcnMubGVuZ3RoKSB7CiAgICAgIGZvckVhY2gob3ZlcmxheUxheWVycywgZnVuY3Rpb24gKG92ZXJsYXlMYXllcikgewogICAgICAgIG92ZXJsYXlMYXllci5zdHlsZS5vcGFjaXR5ID0gMDsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAodGhpcy5wYXJlbnROb2RlKSB7CiAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzKTsKICAgICAgICAgIH0KICAgICAgICB9LmJpbmQob3ZlcmxheUxheWVyKSwgNTAwKTsKICAgICAgfSk7CiAgICB9IC8vcmVtb3ZlIGFsbCBoZWxwZXIgbGF5ZXJzCgoKICAgIHZhciBoZWxwZXJMYXllciA9IHRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtaGVscGVyTGF5ZXIiKTsKCiAgICBpZiAoaGVscGVyTGF5ZXIpIHsKICAgICAgaGVscGVyTGF5ZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChoZWxwZXJMYXllcik7CiAgICB9CgogICAgdmFyIHJlZmVyZW5jZUxheWVyID0gdGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qcy10b29sdGlwUmVmZXJlbmNlTGF5ZXIiKTsKCiAgICBpZiAocmVmZXJlbmNlTGF5ZXIpIHsKICAgICAgcmVmZXJlbmNlTGF5ZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyZWZlcmVuY2VMYXllcik7CiAgICB9IC8vcmVtb3ZlIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyCgoKICAgIHZhciBkaXNhYmxlSW50ZXJhY3Rpb25MYXllciA9IHRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcigiLmludHJvanMtZGlzYWJsZUludGVyYWN0aW9uIik7CgogICAgaWYgKGRpc2FibGVJbnRlcmFjdGlvbkxheWVyKSB7CiAgICAgIGRpc2FibGVJbnRlcmFjdGlvbkxheWVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGlzYWJsZUludGVyYWN0aW9uTGF5ZXIpOwogICAgfSAvL3JlbW92ZSBpbnRybyBmbG9hdGluZyBlbGVtZW50CgoKICAgIHZhciBmbG9hdGluZ0VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qc0Zsb2F0aW5nRWxlbWVudCIpOwoKICAgIGlmIChmbG9hdGluZ0VsZW1lbnQpIHsKICAgICAgZmxvYXRpbmdFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZmxvYXRpbmdFbGVtZW50KTsKICAgIH0KCiAgICByZW1vdmVTaG93RWxlbWVudCgpOyAvL3JlbW92ZSBgaW50cm9qcy1maXhQYXJlbnRgIGNsYXNzIGZyb20gdGhlIGVsZW1lbnRzCgogICAgdmFyIGZpeFBhcmVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCIuaW50cm9qcy1maXhQYXJlbnQiKTsKICAgIGZvckVhY2goZml4UGFyZW50cywgZnVuY3Rpb24gKHBhcmVudCkgewogICAgICByZW1vdmVDbGFzcyhwYXJlbnQsIC9pbnRyb2pzLWZpeFBhcmVudC9nKTsKICAgIH0pOyAvL2NsZWFuIGxpc3RlbmVycwoKICAgIERPTUV2ZW50Lm9mZih3aW5kb3csICJrZXlkb3duIiwgb25LZXlEb3duLCB0aGlzLCB0cnVlKTsKICAgIERPTUV2ZW50Lm9mZih3aW5kb3csICJyZXNpemUiLCBvblJlc2l6ZSwgdGhpcywgdHJ1ZSk7IC8vY2hlY2sgaWYgYW55IGNhbGxiYWNrIGlzIGRlZmluZWQKCiAgICBpZiAodGhpcy5faW50cm9FeGl0Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLl9pbnRyb0V4aXRDYWxsYmFjay5jYWxsKHRoaXMpOwogICAgfSAvL3NldCB0aGUgc3RlcCB0byB6ZXJvCgoKICAgIHRoaXMuX2N1cnJlbnRTdGVwID0gdW5kZWZpbmVkOwogIH0KICAvKioKICAgKiBBZGQgb3ZlcmxheSBsYXllciB0byB0aGUgcGFnZQogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfYWRkT3ZlcmxheUxheWVyCiAgICogQHBhcmFtIHtPYmplY3R9IHRhcmdldEVsbQogICAqLwoKCiAgZnVuY3Rpb24gYWRkT3ZlcmxheUxheWVyKHRhcmdldEVsbSkgewogICAgdmFyIG92ZXJsYXlMYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgdmFyIHN0eWxlVGV4dCA9ICIiOwogICAgdmFyIHNlbGYgPSB0aGlzOyAvL3NldCBjc3MgY2xhc3MgbmFtZQoKICAgIG92ZXJsYXlMYXllci5jbGFzc05hbWUgPSAiaW50cm9qcy1vdmVybGF5IjsgLy9jaGVjayBpZiB0aGUgdGFyZ2V0IGVsZW1lbnQgaXMgYm9keSwgd2Ugc2hvdWxkIGNhbGN1bGF0ZSB0aGUgc2l6ZSBvZiBvdmVybGF5IGxheWVyIGluIGEgYmV0dGVyIHdheQoKICAgIGlmICghdGFyZ2V0RWxtLnRhZ05hbWUgfHwgdGFyZ2V0RWxtLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gImJvZHkiKSB7CiAgICAgIHN0eWxlVGV4dCArPSAidG9wOiAwO2JvdHRvbTogMDsgbGVmdDogMDtyaWdodDogMDtwb3NpdGlvbjogZml4ZWQ7IjsKICAgICAgb3ZlcmxheUxheWVyLnN0eWxlLmNzc1RleHQgPSBzdHlsZVRleHQ7CiAgICB9IGVsc2UgewogICAgICAvL3NldCBvdmVybGF5IGxheWVyIHBvc2l0aW9uCiAgICAgIHZhciBlbGVtZW50UG9zaXRpb24gPSBnZXRPZmZzZXQodGFyZ2V0RWxtKTsKCiAgICAgIGlmIChlbGVtZW50UG9zaXRpb24pIHsKICAgICAgICBzdHlsZVRleHQgKz0gIndpZHRoOiAiLmNvbmNhdChlbGVtZW50UG9zaXRpb24ud2lkdGgsICJweDsgaGVpZ2h0OiIpLmNvbmNhdChlbGVtZW50UG9zaXRpb24uaGVpZ2h0LCAicHg7IHRvcDoiKS5jb25jYXQoZWxlbWVudFBvc2l0aW9uLnRvcCwgInB4O2xlZnQ6ICIpLmNvbmNhdChlbGVtZW50UG9zaXRpb24ubGVmdCwgInB4OyIpOwogICAgICAgIG92ZXJsYXlMYXllci5zdHlsZS5jc3NUZXh0ID0gc3R5bGVUZXh0OwogICAgICB9CiAgICB9CgogICAgdGFyZ2V0RWxtLmFwcGVuZENoaWxkKG92ZXJsYXlMYXllcik7CgogICAgb3ZlcmxheUxheWVyLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChzZWxmLl9vcHRpb25zLmV4aXRPbk92ZXJsYXlDbGljayA9PT0gdHJ1ZSkgewogICAgICAgIGV4aXRJbnRyby5jYWxsKHNlbGYsIHRhcmdldEVsbSk7CiAgICAgIH0KICAgIH07CgogICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBzdHlsZVRleHQgKz0gIm9wYWNpdHk6ICIuY29uY2F0KHNlbGYuX29wdGlvbnMub3ZlcmxheU9wYWNpdHkudG9TdHJpbmcoKSwgIjsiKTsKICAgICAgb3ZlcmxheUxheWVyLnN0eWxlLmNzc1RleHQgPSBzdHlsZVRleHQ7CiAgICB9LCAxMCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgLyoqCiAgICogSW5pdGlhdGUgYSBuZXcgaW50cm9kdWN0aW9uL2d1aWRlIGZyb20gYW4gZWxlbWVudCBpbiB0aGUgcGFnZQogICAqCiAgICogQGFwaSBwcml2YXRlCiAgICogQG1ldGhvZCBfaW50cm9Gb3JFbGVtZW50CiAgICogQHBhcmFtIHtPYmplY3R9IHRhcmdldEVsbQogICAqIEBwYXJhbSB7U3RyaW5nfSBncm91cAogICAqIEByZXR1cm5zIHtCb29sZWFufSBTdWNjZXNzIG9yIG5vdD8KICAgKi8KCgogIGZ1bmN0aW9uIGludHJvRm9yRWxlbWVudCh0YXJnZXRFbG0sIGdyb3VwKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHZhciBhbGxJbnRyb1N0ZXBzID0gdGFyZ2V0RWxtLnF1ZXJ5U2VsZWN0b3JBbGwoIipbZGF0YS1pbnRyb10iKTsKICAgIHZhciBpbnRyb0l0ZW1zID0gW107CgogICAgaWYgKHRoaXMuX29wdGlvbnMuc3RlcHMpIHsKICAgICAgLy91c2Ugc3RlcHMgcGFzc2VkIHByb2dyYW1tYXRpY2FsbHkKICAgICAgZm9yRWFjaCh0aGlzLl9vcHRpb25zLnN0ZXBzLCBmdW5jdGlvbiAoc3RlcCkgewogICAgICAgIHZhciBjdXJyZW50SXRlbSA9IGNsb25lT2JqZWN0KHN0ZXApOyAvL3NldCB0aGUgc3RlcAoKICAgICAgICBjdXJyZW50SXRlbS5zdGVwID0gaW50cm9JdGVtcy5sZW5ndGggKyAxOyAvL3VzZSBxdWVyeVNlbGVjdG9yIGZ1bmN0aW9uIG9ubHkgd2hlbiBkZXZlbG9wZXIgdXNlZCBDU1Mgc2VsZWN0b3IKCiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50SXRlbS5lbGVtZW50ID09PSAic3RyaW5nIikgewogICAgICAgICAgLy9ncmFiIHRoZSBlbGVtZW50IHdpdGggZ2l2ZW4gc2VsZWN0b3IgZnJvbSB0aGUgcGFnZQogICAgICAgICAgY3VycmVudEl0ZW0uZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY3VycmVudEl0ZW0uZWxlbWVudCk7CiAgICAgICAgfSAvL2ludHJvIHdpdGhvdXQgZWxlbWVudAoKCiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50SXRlbS5lbGVtZW50ID09PSAidW5kZWZpbmVkIiB8fCBjdXJyZW50SXRlbS5lbGVtZW50ID09PSBudWxsKSB7CiAgICAgICAgICB2YXIgZmxvYXRpbmdFbGVtZW50UXVlcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaW50cm9qc0Zsb2F0aW5nRWxlbWVudCIpOwoKICAgICAgICAgIGlmIChmbG9hdGluZ0VsZW1lbnRRdWVyeSA9PT0gbnVsbCkgewogICAgICAgICAgICBmbG9hdGluZ0VsZW1lbnRRdWVyeSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICBmbG9hdGluZ0VsZW1lbnRRdWVyeS5jbGFzc05hbWUgPSAiaW50cm9qc0Zsb2F0aW5nRWxlbWVudCI7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZmxvYXRpbmdFbGVtZW50UXVlcnkpOwogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRJdGVtLmVsZW1lbnQgPSBmbG9hdGluZ0VsZW1lbnRRdWVyeTsKICAgICAgICAgIGN1cnJlbnRJdGVtLnBvc2l0aW9uID0gImZsb2F0aW5nIjsKICAgICAgICB9CgogICAgICAgIGN1cnJlbnRJdGVtLnNjcm9sbFRvID0gY3VycmVudEl0ZW0uc2Nyb2xsVG8gfHwgX3RoaXMuX29wdGlvbnMuc2Nyb2xsVG87CgogICAgICAgIGlmICh0eXBlb2YgY3VycmVudEl0ZW0uZGlzYWJsZUludGVyYWN0aW9uID09PSAidW5kZWZpbmVkIikgewogICAgICAgICAgY3VycmVudEl0ZW0uZGlzYWJsZUludGVyYWN0aW9uID0gX3RoaXMuX29wdGlvbnMuZGlzYWJsZUludGVyYWN0aW9uOwogICAgICAgIH0KCiAgICAgICAgaWYgKGN1cnJlbnRJdGVtLmVsZW1lbnQgIT09IG51bGwpIHsKICAgICAgICAgIGludHJvSXRlbXMucHVzaChjdXJyZW50SXRlbSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vdXNlIHN0ZXBzIGZyb20gZGF0YS0qIGFubm90YXRpb25zCiAgICAgIHZhciBlbG1zTGVuZ3RoID0gYWxsSW50cm9TdGVwcy5sZW5ndGg7CiAgICAgIHZhciBkaXNhYmxlSW50ZXJhY3Rpb247IC8vaWYgdGhlcmUncyBubyBlbGVtZW50IHRvIGludHJvCgogICAgICBpZiAoZWxtc0xlbmd0aCA8IDEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGZvckVhY2goYWxsSW50cm9TdGVwcywgZnVuY3Rpb24gKGN1cnJlbnRFbGVtZW50KSB7CiAgICAgICAgLy8gUFIgIzgwCiAgICAgICAgLy8gc3RhcnQgaW50cm8gZm9yIGdyb3VwcyBvZiBlbGVtZW50cwogICAgICAgIGlmIChncm91cCAmJiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtaW50cm8tZ3JvdXAiKSAhPT0gZ3JvdXApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIHNraXAgaGlkZGVuIGVsZW1lbnRzCgoKICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9PT0gIm5vbmUiKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgc3RlcCA9IHBhcnNlSW50KGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1zdGVwIiksIDEwKTsKCiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtZGlzYWJsZS1pbnRlcmFjdGlvbiIpICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uID0gISFjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtZGlzYWJsZS1pbnRlcmFjdGlvbiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkaXNhYmxlSW50ZXJhY3Rpb24gPSBfdGhpcy5fb3B0aW9ucy5kaXNhYmxlSW50ZXJhY3Rpb247CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RlcCA+IDApIHsKICAgICAgICAgIGludHJvSXRlbXNbc3RlcCAtIDFdID0gewogICAgICAgICAgICBlbGVtZW50OiBjdXJyZW50RWxlbWVudCwKICAgICAgICAgICAgaW50cm86IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1pbnRybyIpLAogICAgICAgICAgICBzdGVwOiBwYXJzZUludChjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtc3RlcCIpLCAxMCksCiAgICAgICAgICAgIHRvb2x0aXBDbGFzczogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXRvb2x0aXBjbGFzcyIpLAogICAgICAgICAgICBoaWdobGlnaHRDbGFzczogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLWhpZ2hsaWdodGNsYXNzIiksCiAgICAgICAgICAgIHBvc2l0aW9uOiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtcG9zaXRpb24iKSB8fCBfdGhpcy5fb3B0aW9ucy50b29sdGlwUG9zaXRpb24sCiAgICAgICAgICAgIHNjcm9sbFRvOiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtc2Nyb2xsdG8iKSB8fCBfdGhpcy5fb3B0aW9ucy5zY3JvbGxUbywKICAgICAgICAgICAgZGlzYWJsZUludGVyYWN0aW9uOiBkaXNhYmxlSW50ZXJhY3Rpb24KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9KTsgLy9uZXh0IGFkZCBpbnRybyBpdGVtcyB3aXRob3V0IGRhdGEtc3RlcAogICAgICAvL3RvZG86IHdlIG5lZWQgYSBjbGVhbnVwIGhlcmUsIHR3byBsb29wcyBhcmUgcmVkdW5kYW50CgogICAgICB2YXIgX25leHRTdGVwID0gMDsKICAgICAgZm9yRWFjaChhbGxJbnRyb1N0ZXBzLCBmdW5jdGlvbiAoY3VycmVudEVsZW1lbnQpIHsKICAgICAgICAvLyBQUiAjODAKICAgICAgICAvLyBzdGFydCBpbnRybyBmb3IgZ3JvdXBzIG9mIGVsZW1lbnRzCiAgICAgICAgaWYgKGdyb3VwICYmIGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1pbnRyby1ncm91cCIpICE9PSBncm91cCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1zdGVwIikgPT09IG51bGwpIHsKICAgICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgaW50cm9JdGVtc1tfbmV4dFN0ZXBdID09PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIF9uZXh0U3RlcCsrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtZGlzYWJsZS1pbnRlcmFjdGlvbiIpICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICBkaXNhYmxlSW50ZXJhY3Rpb24gPSAhIWN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1kaXNhYmxlLWludGVyYWN0aW9uIik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkaXNhYmxlSW50ZXJhY3Rpb24gPSBfdGhpcy5fb3B0aW9ucy5kaXNhYmxlSW50ZXJhY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgaW50cm9JdGVtc1tfbmV4dFN0ZXBdID0gewogICAgICAgICAgICBlbGVtZW50OiBjdXJyZW50RWxlbWVudCwKICAgICAgICAgICAgaW50cm86IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1pbnRybyIpLAogICAgICAgICAgICBzdGVwOiBfbmV4dFN0ZXAgKyAxLAogICAgICAgICAgICB0b29sdGlwQ2xhc3M6IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS10b29sdGlwY2xhc3MiKSwKICAgICAgICAgICAgaGlnaGxpZ2h0Q2xhc3M6IGN1cnJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1oaWdobGlnaHRjbGFzcyIpLAogICAgICAgICAgICBwb3NpdGlvbjogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXBvc2l0aW9uIikgfHwgX3RoaXMuX29wdGlvbnMudG9vbHRpcFBvc2l0aW9uLAogICAgICAgICAgICBzY3JvbGxUbzogY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLXNjcm9sbHRvIikgfHwgX3RoaXMuX29wdGlvbnMuc2Nyb2xsVG8sCiAgICAgICAgICAgIGRpc2FibGVJbnRlcmFjdGlvbjogZGlzYWJsZUludGVyYWN0aW9uCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IC8vcmVtb3ZpbmcgdW5kZWZpbmVkL251bGwgZWxlbWVudHMKCgogICAgdmFyIHRlbXBJbnRyb0l0ZW1zID0gW107CgogICAgZm9yICh2YXIgeiA9IDA7IHogPCBpbnRyb0l0ZW1zLmxlbmd0aDsgeisrKSB7CiAgICAgIGlmIChpbnRyb0l0ZW1zW3pdKSB7CiAgICAgICAgLy8gY29weSBub24tZmFsc3kgdmFsdWVzIHRvIHRoZSBlbmQgb2YgdGhlIGFycmF5CiAgICAgICAgdGVtcEludHJvSXRlbXMucHVzaChpbnRyb0l0ZW1zW3pdKTsKICAgICAgfQogICAgfQoKICAgIGludHJvSXRlbXMgPSB0ZW1wSW50cm9JdGVtczsgLy9Paywgc29ydCBhbGwgaXRlbXMgd2l0aCBnaXZlbiBzdGVwcwoKICAgIGludHJvSXRlbXMuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gYS5zdGVwIC0gYi5zdGVwOwogICAgfSk7IC8vc2V0IGl0IHRvIHRoZSBpbnRyb0pzIG9iamVjdAoKICAgIHRoaXMuX2ludHJvSXRlbXMgPSBpbnRyb0l0ZW1zOyAvL2FkZCBvdmVybGF5IGxheWVyIHRvIHRoZSBwYWdlCgogICAgaWYgKGFkZE92ZXJsYXlMYXllci5jYWxsKHRoaXMsIHRhcmdldEVsbSkpIHsKICAgICAgLy90aGVuLCBzdGFydCB0aGUgc2hvdwogICAgICBuZXh0U3RlcC5jYWxsKHRoaXMpOwoKICAgICAgaWYgKHRoaXMuX29wdGlvbnMua2V5Ym9hcmROYXZpZ2F0aW9uKSB7CiAgICAgICAgRE9NRXZlbnQub24od2luZG93LCAia2V5ZG93biIsIG9uS2V5RG93biwgdGhpcywgdHJ1ZSk7CiAgICAgIH0gLy9mb3Igd2luZG93IHJlc2l6ZQoKCiAgICAgIERPTUV2ZW50Lm9uKHdpbmRvdywgInJlc2l6ZSIsIG9uUmVzaXplLCB0aGlzLCB0cnVlKTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB2YXIgdmVyc2lvbiA9ICIzLjAuMSI7CiAgLyoqCiAgICogSW50cm9KcyBtYWluIGNsYXNzCiAgICoKICAgKiBAY2xhc3MgSW50cm9KcwogICAqLwoKICBmdW5jdGlvbiBJbnRyb0pzKG9iaikgewogICAgdGhpcy5fdGFyZ2V0RWxlbWVudCA9IG9iajsKICAgIHRoaXMuX2ludHJvSXRlbXMgPSBbXTsKICAgIHRoaXMuX29wdGlvbnMgPSB7CiAgICAgIC8qIExhYmVsIERpc3BsYXkgdG8gYmUgU2hvd24gaW4gdGhlIGhpZ2hsaWdodGVkIGRpdiAqLwogICAgICBsYWJlbERpc3BsYXk6ICIiLAoKICAgICAgLyogTmV4dCBidXR0b24gbGFiZWwgaW4gdG9vbHRpcCBib3ggKi8KICAgICAgbmV4dExhYmVsOiAiTmV4dCAmcmFycjsiLAoKICAgICAgLyogUHJldmlvdXMgYnV0dG9uIGxhYmVsIGluIHRvb2x0aXAgYm94ICovCiAgICAgIHByZXZMYWJlbDogIiZsYXJyOyBCYWNrIiwKCiAgICAgIC8qIFNraXAgYnV0dG9uIGxhYmVsIGluIHRvb2x0aXAgYm94ICovCiAgICAgIHNraXBMYWJlbDogIlNraXAiLAoKICAgICAgLyogRG9uZSBidXR0b24gbGFiZWwgaW4gdG9vbHRpcCBib3ggKi8KICAgICAgZG9uZUxhYmVsOiAiRG9uZSIsCgogICAgICAvKiBIaWRlIHByZXZpb3VzIGJ1dHRvbiBpbiB0aGUgZmlyc3Qgc3RlcD8gT3RoZXJ3aXNlLCBpdCB3aWxsIGJlIGRpc2FibGVkIGJ1dHRvbi4gKi8KICAgICAgaGlkZVByZXY6IGZhbHNlLAoKICAgICAgLyogSGlkZSBuZXh0IGJ1dHRvbiBpbiB0aGUgbGFzdCBzdGVwPyBPdGhlcndpc2UsIGl0IHdpbGwgYmUgZGlzYWJsZWQgYnV0dG9uLiAqLwogICAgICBoaWRlTmV4dDogZmFsc2UsCgogICAgICAvKiBEZWZhdWx0IHRvb2x0aXAgYm94IHBvc2l0aW9uICovCiAgICAgIHRvb2x0aXBQb3NpdGlvbjogImJvdHRvbSIsCgogICAgICAvKiBOZXh0IENTUyBjbGFzcyBmb3IgdG9vbHRpcCBib3hlcyAqLwogICAgICB0b29sdGlwQ2xhc3M6ICIiLAoKICAgICAgLyogQ1NTIGNsYXNzIHRoYXQgaXMgYWRkZWQgdG8gdGhlIGhlbHBlckxheWVyICovCiAgICAgIGhpZ2hsaWdodENsYXNzOiAiIiwKCiAgICAgIC8qIENsb3NlIGludHJvZHVjdGlvbiB3aGVuIHByZXNzaW5nIEVzY2FwZSBidXR0b24/ICovCiAgICAgIGV4aXRPbkVzYzogdHJ1ZSwKCiAgICAgIC8qIENsb3NlIGludHJvZHVjdGlvbiB3aGVuIGNsaWNraW5nIG9uIG92ZXJsYXkgbGF5ZXI/ICovCiAgICAgIGV4aXRPbk92ZXJsYXlDbGljazogdHJ1ZSwKCiAgICAgIC8qIFNob3cgc3RlcCBudW1iZXJzIGluIGludHJvZHVjdGlvbj8gKi8KICAgICAgc2hvd1N0ZXBOdW1iZXJzOiB0cnVlLAoKICAgICAgLyogTGV0IHVzZXIgdXNlIGtleWJvYXJkIHRvIG5hdmlnYXRlIHRoZSB0b3VyPyAqLwogICAgICBrZXlib2FyZE5hdmlnYXRpb246IHRydWUsCgogICAgICAvKiBTaG93IHRvdXIgY29udHJvbCBidXR0b25zPyAqLwogICAgICBzaG93QnV0dG9uczogdHJ1ZSwKCiAgICAgIC8qIFNob3cgdG91ciBidWxsZXRzPyAqLwogICAgICBzaG93QnVsbGV0czogdHJ1ZSwKCiAgICAgIC8qIFNob3cgdG91ciBwcm9ncmVzcz8gKi8KICAgICAgc2hvd1Byb2dyZXNzOiBmYWxzZSwKCiAgICAgIC8qIFNjcm9sbCB0byBoaWdobGlnaHRlZCBlbGVtZW50PyAqLwogICAgICBzY3JvbGxUb0VsZW1lbnQ6IHRydWUsCgogICAgICAvKgogICAgICAgKiBTaG91bGQgd2Ugc2Nyb2xsIHRoZSB0b29sdGlwIG9yIHRhcmdldCBlbGVtZW50PwogICAgICAgKgogICAgICAgKiBPcHRpb25zIGFyZTogJ2VsZW1lbnQnIG9yICd0b29sdGlwJwogICAgICAgKi8KICAgICAgc2Nyb2xsVG86ICJlbGVtZW50IiwKCiAgICAgIC8qIFBhZGRpbmcgdG8gYWRkIGFmdGVyIHNjcm9sbGluZyB3aGVuIGVsZW1lbnQgaXMgbm90IGluIHRoZSB2aWV3cG9ydCAoaW4gcGl4ZWxzKSAqLwogICAgICBzY3JvbGxQYWRkaW5nOiAzMCwKCiAgICAgIC8qIFNldCB0aGUgb3ZlcmxheSBvcGFjaXR5ICovCiAgICAgIG92ZXJsYXlPcGFjaXR5OiAwLjgsCgogICAgICAvKiBQcmVjZWRlbmNlIG9mIHBvc2l0aW9ucywgd2hlbiBhdXRvIGlzIGVuYWJsZWQgKi8KICAgICAgcG9zaXRpb25QcmVjZWRlbmNlOiBbImJvdHRvbSIsICJ0b3AiLCAicmlnaHQiLCAibGVmdCJdLAoKICAgICAgLyogRGlzYWJsZSBhbiBpbnRlcmFjdGlvbiB3aXRoIGVsZW1lbnQ/ICovCiAgICAgIGRpc2FibGVJbnRlcmFjdGlvbjogZmFsc2UsCgogICAgICAvKiBTZXQgaG93IG11Y2ggcGFkZGluZyB0byBiZSB1c2VkIGFyb3VuZCBoZWxwZXIgZWxlbWVudCAqLwogICAgICBoZWxwZXJFbGVtZW50UGFkZGluZzogMTAsCgogICAgICAvKiBEZWZhdWx0IGhpbnQgcG9zaXRpb24gKi8KICAgICAgaGludFBvc2l0aW9uOiAidG9wLW1pZGRsZSIsCgogICAgICAvKiBIaW50IGJ1dHRvbiBsYWJlbCAqLwogICAgICBoaW50QnV0dG9uTGFiZWw6ICJHb3QgaXQiLAoKICAgICAgLyogQWRkaW5nIGFuaW1hdGlvbiB0byBoaW50cz8gKi8KICAgICAgaGludEFuaW1hdGlvbjogdHJ1ZSwKCiAgICAgIC8qIGFkZGl0aW9uYWwgY2xhc3NlcyB0byBwdXQgb24gdGhlIGJ1dHRvbnMgKi8KICAgICAgYnV0dG9uQ2xhc3M6ICJpbnRyb2pzLWJ1dHRvbiIKICAgIH07CiAgfQoKICB2YXIgaW50cm9KcyA9IGZ1bmN0aW9uIGludHJvSnModGFyZ2V0RWxtKSB7CiAgICB2YXIgaW5zdGFuY2U7CgogICAgaWYgKF90eXBlb2YodGFyZ2V0RWxtKSA9PT0gIm9iamVjdCIpIHsKICAgICAgLy9PaywgY3JlYXRlIGEgbmV3IGluc3RhbmNlCiAgICAgIGluc3RhbmNlID0gbmV3IEludHJvSnModGFyZ2V0RWxtKTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIHRhcmdldEVsbSA9PT0gInN0cmluZyIpIHsKICAgICAgLy9zZWxlY3QgdGhlIHRhcmdldCBlbGVtZW50IHdpdGggcXVlcnkgc2VsZWN0b3IKICAgICAgdmFyIHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldEVsbSk7CgogICAgICBpZiAodGFyZ2V0RWxlbWVudCkgewogICAgICAgIGluc3RhbmNlID0gbmV3IEludHJvSnModGFyZ2V0RWxlbWVudCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJUaGVyZSBpcyBubyBlbGVtZW50IHdpdGggZ2l2ZW4gc2VsZWN0b3IuIik7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGluc3RhbmNlID0gbmV3IEludHJvSnMoZG9jdW1lbnQuYm9keSk7CiAgICB9IC8vIGFkZCBpbnN0YW5jZSB0byBsaXN0IG9mIF9pbnN0YW5jZXMKICAgIC8vIHBhc3NpbmcgZ3JvdXAgdG8gc3RhbXAgdG8gaW5jcmVtZW50CiAgICAvLyBmcm9tIDAgb253YXJkIHNvbWV3aGF0IHJlbGlhYmx5CgoKICAgIGludHJvSnMuaW5zdGFuY2VzW3N0YW1wKGluc3RhbmNlLCAiaW50cm9qcy1pbnN0YW5jZSIpXSA9IGluc3RhbmNlOwogICAgcmV0dXJuIGluc3RhbmNlOwogIH07CiAgLyoqCiAgICogQ3VycmVudCBJbnRyb0pzIHZlcnNpb24KICAgKgogICAqIEBwcm9wZXJ0eSB2ZXJzaW9uCiAgICogQHR5cGUgU3RyaW5nCiAgICovCgoKICBpbnRyb0pzLnZlcnNpb24gPSB2ZXJzaW9uOwogIC8qKgogICAqIGtleS12YWwgb2JqZWN0IGhlbHBlciBmb3IgaW50cm9KcyBpbnN0YW5jZXMKICAgKgogICAqIEBwcm9wZXJ0eSBpbnN0YW5jZXMKICAgKiBAdHlwZSBPYmplY3QKICAgKi8KCiAgaW50cm9Kcy5pbnN0YW5jZXMgPSB7fTsgLy9Qcm90b3R5cGUKCiAgaW50cm9Kcy5mbiA9IEludHJvSnMucHJvdG90eXBlID0gewogICAgY2xvbmU6IGZ1bmN0aW9uIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IEludHJvSnModGhpcyk7CiAgICB9LAogICAgc2V0T3B0aW9uOiBmdW5jdGlvbiBzZXRPcHRpb24ob3B0aW9uLCB2YWx1ZSkgewogICAgICB0aGlzLl9vcHRpb25zW29wdGlvbl0gPSB2YWx1ZTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgc2V0T3B0aW9uczogZnVuY3Rpb24gc2V0T3B0aW9ucyhvcHRpb25zKSB7CiAgICAgIHRoaXMuX29wdGlvbnMgPSBtZXJnZU9wdGlvbnModGhpcy5fb3B0aW9ucywgb3B0aW9ucyk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHN0YXJ0OiBmdW5jdGlvbiBzdGFydChncm91cCkgewogICAgICBpbnRyb0ZvckVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLl90YXJnZXRFbGVtZW50LCBncm91cCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGdvVG9TdGVwOiBmdW5jdGlvbiBnb1RvU3RlcCQxKHN0ZXApIHsKICAgICAgZ29Ub1N0ZXAuY2FsbCh0aGlzLCBzdGVwKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgYWRkU3RlcDogZnVuY3Rpb24gYWRkU3RlcChvcHRpb25zKSB7CiAgICAgIGlmICghdGhpcy5fb3B0aW9ucy5zdGVwcykgewogICAgICAgIHRoaXMuX29wdGlvbnMuc3RlcHMgPSBbXTsKICAgICAgfQoKICAgICAgdGhpcy5fb3B0aW9ucy5zdGVwcy5wdXNoKG9wdGlvbnMpOwoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgYWRkU3RlcHM6IGZ1bmN0aW9uIGFkZFN0ZXBzKHN0ZXBzKSB7CiAgICAgIGlmICghc3RlcHMubGVuZ3RoKSByZXR1cm47CgogICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgc3RlcHMubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgdGhpcy5hZGRTdGVwKHN0ZXBzW2luZGV4XSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGdvVG9TdGVwTnVtYmVyOiBmdW5jdGlvbiBnb1RvU3RlcE51bWJlciQxKHN0ZXApIHsKICAgICAgZ29Ub1N0ZXBOdW1iZXIuY2FsbCh0aGlzLCBzdGVwKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgbmV4dFN0ZXA6IGZ1bmN0aW9uIG5leHRTdGVwJDEoKSB7CiAgICAgIG5leHRTdGVwLmNhbGwodGhpcyk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHByZXZpb3VzU3RlcDogZnVuY3Rpb24gcHJldmlvdXNTdGVwJDEoKSB7CiAgICAgIHByZXZpb3VzU3RlcC5jYWxsKHRoaXMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBjdXJyZW50U3RlcDogZnVuY3Rpb24gY3VycmVudFN0ZXAkMSgpIHsKICAgICAgcmV0dXJuIGN1cnJlbnRTdGVwLmNhbGwodGhpcyk7CiAgICB9LAogICAgZXhpdDogZnVuY3Rpb24gZXhpdChmb3JjZSkgewogICAgICBleGl0SW50cm8uY2FsbCh0aGlzLCB0aGlzLl90YXJnZXRFbGVtZW50LCBmb3JjZSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHJlZnJlc2g6IGZ1bmN0aW9uIHJlZnJlc2gkMSgpIHsKICAgICAgcmVmcmVzaC5jYWxsKHRoaXMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBvbmJlZm9yZWNoYW5nZTogZnVuY3Rpb24gb25iZWZvcmVjaGFuZ2UocHJvdmlkZWRDYWxsYmFjaykgewogICAgICBpZiAodHlwZW9mIHByb3ZpZGVkQ2FsbGJhY2sgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB0aGlzLl9pbnRyb0JlZm9yZUNoYW5nZUNhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbmJlZm9yZWNoYW5nZSB3YXMgbm90IGEgZnVuY3Rpb24iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgb25jaGFuZ2U6IGZ1bmN0aW9uIG9uY2hhbmdlKHByb3ZpZGVkQ2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faW50cm9DaGFuZ2VDYWxsYmFjayA9IHByb3ZpZGVkQ2FsbGJhY2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQcm92aWRlZCBjYWxsYmFjayBmb3Igb25jaGFuZ2Ugd2FzIG5vdCBhIGZ1bmN0aW9uLiIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBvbmFmdGVyY2hhbmdlOiBmdW5jdGlvbiBvbmFmdGVyY2hhbmdlKHByb3ZpZGVkQ2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faW50cm9BZnRlckNoYW5nZUNhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbmFmdGVyY2hhbmdlIHdhcyBub3QgYSBmdW5jdGlvbiIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBvbmNvbXBsZXRlOiBmdW5jdGlvbiBvbmNvbXBsZXRlKHByb3ZpZGVkQ2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faW50cm9Db21wbGV0ZUNhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbmNvbXBsZXRlIHdhcyBub3QgYSBmdW5jdGlvbi4iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgb25oaW50c2FkZGVkOiBmdW5jdGlvbiBvbmhpbnRzYWRkZWQocHJvdmlkZWRDYWxsYmFjaykgewogICAgICBpZiAodHlwZW9mIHByb3ZpZGVkQ2FsbGJhY2sgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB0aGlzLl9oaW50c0FkZGVkQ2FsbGJhY2sgPSBwcm92aWRlZENhbGxiYWNrOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uaGludHNhZGRlZCB3YXMgbm90IGEgZnVuY3Rpb24uIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIG9uaGludGNsaWNrOiBmdW5jdGlvbiBvbmhpbnRjbGljayhwcm92aWRlZENhbGxiYWNrKSB7CiAgICAgIGlmICh0eXBlb2YgcHJvdmlkZWRDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMuX2hpbnRDbGlja0NhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbmhpbnRjbGljayB3YXMgbm90IGEgZnVuY3Rpb24uIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIG9uaGludGNsb3NlOiBmdW5jdGlvbiBvbmhpbnRjbG9zZShwcm92aWRlZENhbGxiYWNrKSB7CiAgICAgIGlmICh0eXBlb2YgcHJvdmlkZWRDYWxsYmFjayA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHRoaXMuX2hpbnRDbG9zZUNhbGxiYWNrID0gcHJvdmlkZWRDYWxsYmFjazsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3ZpZGVkIGNhbGxiYWNrIGZvciBvbmhpbnRjbG9zZSB3YXMgbm90IGEgZnVuY3Rpb24uIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIG9uZXhpdDogZnVuY3Rpb24gb25leGl0KHByb3ZpZGVkQ2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faW50cm9FeGl0Q2FsbGJhY2sgPSBwcm92aWRlZENhbGxiYWNrOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uZXhpdCB3YXMgbm90IGEgZnVuY3Rpb24uIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIG9uc2tpcDogZnVuY3Rpb24gb25za2lwKHByb3ZpZGVkQ2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faW50cm9Ta2lwQ2FsbGJhY2sgPSBwcm92aWRlZENhbGxiYWNrOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uc2tpcCB3YXMgbm90IGEgZnVuY3Rpb24uIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIG9uYmVmb3JlZXhpdDogZnVuY3Rpb24gb25iZWZvcmVleGl0KHByb3ZpZGVkQ2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBwcm92aWRlZENhbGxiYWNrID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhpcy5faW50cm9CZWZvcmVFeGl0Q2FsbGJhY2sgPSBwcm92aWRlZENhbGxiYWNrOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiUHJvdmlkZWQgY2FsbGJhY2sgZm9yIG9uYmVmb3JlZXhpdCB3YXMgbm90IGEgZnVuY3Rpb24uIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGFkZEhpbnRzOiBmdW5jdGlvbiBhZGRIaW50cygpIHsKICAgICAgcG9wdWxhdGVIaW50cy5jYWxsKHRoaXMsIHRoaXMuX3RhcmdldEVsZW1lbnQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBoaWRlSGludDogZnVuY3Rpb24gaGlkZUhpbnQkMShzdGVwSWQpIHsKICAgICAgaGlkZUhpbnQuY2FsbCh0aGlzLCBzdGVwSWQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBoaWRlSGludHM6IGZ1bmN0aW9uIGhpZGVIaW50cyQxKCkgewogICAgICBoaWRlSGludHMuY2FsbCh0aGlzKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgc2hvd0hpbnQ6IGZ1bmN0aW9uIHNob3dIaW50JDEoc3RlcElkKSB7CiAgICAgIHNob3dIaW50LmNhbGwodGhpcywgc3RlcElkKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgc2hvd0hpbnRzOiBmdW5jdGlvbiBzaG93SGludHMkMSgpIHsKICAgICAgc2hvd0hpbnRzLmNhbGwodGhpcyk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHJlbW92ZUhpbnRzOiBmdW5jdGlvbiByZW1vdmVIaW50cyQxKCkgewogICAgICByZW1vdmVIaW50cy5jYWxsKHRoaXMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICByZW1vdmVIaW50OiBmdW5jdGlvbiByZW1vdmVIaW50JDEoc3RlcElkKSB7CiAgICAgIHJlbW92ZUhpbnQoKS5jYWxsKHRoaXMsIHN0ZXBJZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIHNob3dIaW50RGlhbG9nOiBmdW5jdGlvbiBzaG93SGludERpYWxvZyQxKHN0ZXBJZCkgewogICAgICBzaG93SGludERpYWxvZy5jYWxsKHRoaXMsIHN0ZXBJZCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH07CiAgcmV0dXJuIGludHJvSnM7Cn0pOw=="},{"version":3,"sources":["/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Layout/intro.js"],"names":["require","image","global","factory","exports","module","define","amd","self","introJs","_typeof","obj","Symbol","iterator","constructor","prototype","mergeOptions","obj1","obj2","obj3","attrname","stamp","keys","key","arguments","length","undefined","forEach","arr","forEachFnc","completeFnc","i","len","removeClass","element","classNameRegex","SVGElement","pre","getAttribute","setAttribute","replace","className","DOMEvent","events_key","_id","type","listener","context","concat","on","useCapture","id","apply","handler","e","call","window","event","addEventListener","attachEvent","off","removeEventListener","detachEvent","addClass","classList","classes","split","cls","add","match","getPropValue","propName","propValue","currentStyle","document","defaultView","getComputedStyle","getPropertyValue","toLowerCase","setShowElement","_ref","parentElm","parentNode","tagName","currentElementPosition","zIndex","opacity","parseFloat","transform","test","scrollParentToElement","parent","offsetTop","scrollTop","getScrollParent","style","excludeStaticParent","position","overflowRegex","body","parentElement","overflow","overflowY","overflowX","getWinSize","innerWidth","width","height","innerHeight","D","documentElement","clientWidth","clientHeight","elementInViewport","el","rect","getBoundingClientRect","top","left","bottom","right","scrollTo","tooltipLayer","_options","scrollToElement","winHeight","scrollBy","scrollPadding","setAnchorAsButton","anchor","tabIndex","getOffset","docEl","pageYOffset","scrollLeft","pageXOffset","x","isFixed","p","nodeName","setHelperLayerPosition","helperLayer","_introItems","_currentStep","currentElement","elementPosition","widthHeightPadding","helperElementPadding","cssText","checkRight","targetOffset","tooltipLayerStyleLeft","tooltipOffset","windowSize","checkLeft","tooltipLayerStyleRight","removeEntry","stringArray","stringToRemove","includes","splice","indexOf","_determineAutoAlignment","offsetLeft","tooltipWidth","desiredAlignment","halfTooltipWidth","winWidth","Math","min","screen","possibleAlignments","calculatedAlignment","_determineAutoPosition","targetElement","desiredTooltipPosition","possiblePositions","positionPrecedence","slice","tooltipHeight","targetElementRect","calculatedPosition","pos","hyphenIndex","substr","placeTooltip","arrowLayer","helperNumberLayer","hintMode","tooltipCssClass","currentStepObj","currentTooltipPosition","marginLeft","marginTop","display","tooltipClass","tooltipLayerStyleLeftRight","imageLayer","createElement","src","parent_div_for_image","getElementById","showStepNumbers","get_left_offset","max","get_top_offset","removeShowElement","elms","querySelectorAll","elm","_getProgress","currentStep","parseInt","_disableInteraction","disableInteractionLayer","querySelector","_targetElement","appendChild","_showElement","_introChangeCallback","oldHelperLayer","oldReferenceLayer","highlightClass","nextTooltipButton","prevTooltipButton","skipTooltipButton","scrollParent","oldHelperNumberLayer","oldtooltipLayer","oldArrowLayer","oldtooltipContainer","contains","remove","labelDisplay","label_display_div","color","textAlign","innerHTML","lastIntroItem","step","_direction","fixParents","_lastShowElementTimer","clearTimeout","setTimeout","tooltipHeader","fontFamily","tooltipBody","intro","maxWidth","minWidth","marginBottom","paddingLeft","showBullets","focus","referenceLayer","tooltipTextLayer","bulletsLayer","progressLayer","buttonsLayer","ulContainer","anchorClick","goToStep","innerLi","anchorLink","onclick","showProgress","progressBar","showButtons","nextStep","nextLabel","previousStep","prevLabel","buttonClass","skipLabel","_introCompleteCallback","_introSkipCallback","exitIntro","removeChild","disableInteraction","hidePrev","doneLabel","hideNext","_introAfterChangeCallback","goToStepNumber","_currentStepNumber","_this","continueStep","_introBeforeChangeCallback","onKeyDown","code","which","charCode","keyCode","exitOnEsc","target","srcElement","click","preventDefault","returnValue","cloneObject","object","nodeType","temp","jQuery","hintQuerySelectorAll","selector","hintsWrapper","hideHint","stepId","hint","removeHintTooltip","_hintCloseCallback","hideHints","hints","showHints","_this2","showHint","populateHints","removeHints","_this3","removeHint","addHints","_this4","getHintClick","evt","stopPropagation","cancelBubble","showHintDialog","item","hintAnimation","hintDot","hintPulse","alignHintPosition","hintPosition","_hintsAddedCallback","offset","iconWidth","iconHeight","hintElement","_hintClickCallback","removedStep","tooltipWrapper","closeButton","hintButtonLabel","bind","tooltip","targetElm","_this5","currentItem","push","tooltipPosition","reAlignHints","_this6","_ref2","refresh","onResize","force","continueExit","_introBeforeExitCallback","overlayLayers","overlayLayer","floatingElement","_introExitCallback","addOverlayLayer","styleText","exitOnOverlayClick","overlayOpacity","toString","introForElement","group","allIntroSteps","introItems","steps","floatingElementQuery","elmsLength","_nextStep","tempIntroItems","z","sort","a","b","keyboardNavigation","version","IntroJs","instance","Error","instances","fn","clone","setOption","option","value","setOptions","options","start","goToStep$1","addStep","addSteps","index","goToStepNumber$1","nextStep$1","previousStep$1","currentStep$1","exit","refresh$1","onbeforechange","providedCallback","onchange","onafterchange","oncomplete","onhintsadded","onhintclick","onhintclose","onexit","onskip","onbeforeexit","hideHint$1","hideHints$1","showHint$1","showHints$1","removeHints$1","removeHint$1","showHintDialog$1"],"mappings":"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","sourcesContent":["/*!\n * Intro.js v3.0.1\n * https://github.com/usablica/intro.js\n *\n * Copyright (C) 2017-2020 Afshin Mehrabani (@afshinmeh).\n * https://raw.githubusercontent.com/usablica/intro.js/master/license.md\n *\n * Date: Sat, 17 Oct 2020 10:36:20 GMT\n */\n\nconst { image } = require(\"d3\");\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.introJs = factory());\n}(this, (function () { 'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  /**\n   * Overwrites obj1's values with obj2's and adds obj2's if non existent in obj1\n   * via: http://stackoverflow.com/questions/171251/how-can-i-merge-properties-of-two-javascript-objects-dynamically\n   *\n   * @param obj1\n   * @param obj2\n   * @returns obj3 a new object based on obj1 and obj2\n   */\n  function mergeOptions(obj1, obj2) {\n    var obj3 = {};\n    var attrname;\n\n    for (attrname in obj1) {\n      obj3[attrname] = obj1[attrname];\n    }\n\n    for (attrname in obj2) {\n      obj3[attrname] = obj2[attrname];\n    }\n\n    return obj3;\n  }\n\n  /**\n   * Mark any object with an incrementing number\n   * used for keeping track of objects\n   *\n   * @param Object obj   Any object or DOM Element\n   * @param String key\n   * @return Object\n   */\n  var stamp = function () {\n    var keys = {};\n    return function stamp(obj) {\n      var key = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"introjs-stamp\";\n      // each group increments from 0\n      keys[key] = keys[key] || 0; // stamp only once per object\n\n      if (obj[key] === undefined) {\n        // increment key for each new object\n        obj[key] = keys[key]++;\n      }\n\n      return obj[key];\n    };\n  }();\n\n  /**\n   * Iterates arrays\n   *\n   * @param {Array} arr\n   * @param {Function} forEachFnc\n   * @param {Function} completeFnc\n   * @return {Null}\n   */\n  function forEach(arr, forEachFnc, completeFnc) {\n    // in case arr is an empty query selector node list\n    if (arr) {\n      for (var i = 0, len = arr.length; i < len; i++) {\n        forEachFnc(arr[i], i);\n      }\n    }\n\n    if (typeof completeFnc === \"function\") {\n      completeFnc();\n    }\n  }\n\n  /**\n   * Remove a class from an element\n   *\n   * @api private\n   * @method _removeClass\n   * @param {Object} element\n   * @param {RegExp|String} classNameRegex can be regex or string\n   * @returns null\n   */\n  function removeClass(element, classNameRegex) {\n    if (element instanceof SVGElement) {\n      var pre = element.getAttribute(\"class\") || \"\";\n      element.setAttribute(\"class\", pre.replace(classNameRegex, \"\").replace(/^\\s+|\\s+$/g, \"\"));\n    } else {\n      element.className = element.className.replace(classNameRegex, \"\").replace(/^\\s+|\\s+$/g, \"\");\n    }\n  }\n\n  /**\n   * DOMEvent Handles all DOM events\n   *\n   * methods:\n   *\n   * on - add event handler\n   * off - remove event\n   */\n\n  var DOMEvent = function () {\n    function DOMEvent() {\n      var events_key = \"introjs_event\";\n      /**\n       * Gets a unique ID for an event listener\n       *\n       * @param obj Object\n       * @param type event type\n       * @param listener Function\n       * @param context Object\n       * @return String\n       */\n\n      this._id = function (obj, type, listener, context) {\n        return type + stamp(listener) + (context ? \"_\".concat(stamp(context)) : \"\");\n      };\n      /**\n       * Adds event listener\n       *\n       * @param obj Object obj\n       * @param type String\n       * @param listener Function\n       * @param context Object\n       * @param useCapture Boolean\n       * @return null\n       */\n\n\n      this.on = function (obj, type, listener, context, useCapture) {\n        var id = this._id.apply(this, arguments);\n\n        var handler = function handler(e) {\n          return listener.call(context || obj, e || window.event);\n        };\n\n        if (\"addEventListener\" in obj) {\n          obj.addEventListener(type, handler, useCapture);\n        } else if (\"attachEvent\" in obj) {\n          obj.attachEvent(\"on\".concat(type), handler);\n        }\n\n        obj[events_key] = obj[events_key] || {};\n        obj[events_key][id] = handler;\n      };\n      /**\n       * Removes event listener\n       *\n       * @param obj Object\n       * @param type String\n       * @param listener Function\n       * @param context Object\n       * @param useCapture Boolean\n       * @return null\n       */\n\n\n      this.off = function (obj, type, listener, context, useCapture) {\n        var id = this._id.apply(this, arguments);\n\n        var handler = obj[events_key] && obj[events_key][id];\n\n        if (!handler) {\n          return;\n        }\n\n        if (\"removeEventListener\" in obj) {\n          obj.removeEventListener(type, handler, useCapture);\n        } else if (\"detachEvent\" in obj) {\n          obj.detachEvent(\"on\".concat(type), handler);\n        }\n\n        obj[events_key][id] = null;\n      };\n    }\n\n    return new DOMEvent();\n  }();\n\n  /**\n   * Append a class to an element\n   *\n   * @api private\n   * @method _addClass\n   * @param {Object} element\n   * @param {String} className\n   * @returns null\n   */\n\n  function addClass(element, className) {\n    if (element instanceof SVGElement) {\n      // svg\n      var pre = element.getAttribute(\"class\") || \"\";\n      element.setAttribute(\"class\", \"\".concat(pre, \" \").concat(className));\n    } else {\n      if (element.classList !== undefined) {\n        // check for modern classList property\n        var classes = className.split(\" \");\n        forEach(classes, function (cls) {\n          element.classList.add(cls);\n        });\n      } else if (!element.className.match(className)) {\n        // check if element doesn't already have className\n        element.className += \" \".concat(className);\n      }\n    }\n  }\n\n  /**\n   * Get an element CSS property on the page\n   * Thanks to JavaScript Kit: http://www.javascriptkit.com/dhtmltutors/dhtmlcascade4.shtml\n   *\n   * @api private\n   * @method _getPropValue\n   * @param {Object} element\n   * @param {String} propName\n   * @returns string property value\n   */\n  function getPropValue(element, propName) {\n    var propValue = \"\";\n\n    if (element.currentStyle) {\n      //IE\n      propValue = element.currentStyle[propName];\n    } else if (document.defaultView && document.defaultView.getComputedStyle) {\n      //Others\n      propValue = document.defaultView.getComputedStyle(element, null).getPropertyValue(propName);\n    } //Prevent exception in IE\n\n\n    if (propValue && propValue.toLowerCase) {\n      return propValue.toLowerCase();\n    } else {\n      return propValue;\n    }\n  }\n\n  /**\n   * To set the show element\n   * This function set a relative (in most cases) position and changes the z-index\n   *\n   * @api private\n   * @method _setShowElement\n   * @param {Object} targetElement\n   */\n\n  function setShowElement(_ref) {\n    var element = _ref.element;\n    var parentElm; // we need to add this show element class to the parent of SVG elements\n    // because the SVG elements can't have independent z-index\n\n    if (element instanceof SVGElement) {\n      parentElm = element.parentNode;\n\n      while (element.parentNode !== null) {\n        if (!parentElm.tagName || parentElm.tagName.toLowerCase() === \"body\") break;\n\n        if (parentElm.tagName.toLowerCase() === \"svg\") {\n          addClass(parentElm, \"introjs-showElement introjs-relativePosition\");\n        }\n\n        parentElm = parentElm.parentNode;\n      }\n    }\n\n    addClass(element, \"introjs-showElement\");\n    var currentElementPosition = getPropValue(element, \"position\");\n\n    if (currentElementPosition !== \"absolute\" && currentElementPosition !== \"relative\" && currentElementPosition !== \"fixed\") {\n      //change to new intro item\n      addClass(element, \"introjs-relativePosition\");\n    }\n\n    parentElm = element.parentNode;\n\n    while (parentElm !== null) {\n      if (!parentElm.tagName || parentElm.tagName.toLowerCase() === \"body\") break; //fix The Stacking Context problem.\n      //More detail: https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Understanding_z_index/The_stacking_context\n\n      var zIndex = getPropValue(parentElm, \"z-index\");\n      var opacity = parseFloat(getPropValue(parentElm, \"opacity\"));\n      var transform = getPropValue(parentElm, \"transform\") || getPropValue(parentElm, \"-webkit-transform\") || getPropValue(parentElm, \"-moz-transform\") || getPropValue(parentElm, \"-ms-transform\") || getPropValue(parentElm, \"-o-transform\");\n\n      if (/[0-9]+/.test(zIndex) || opacity < 1 || transform !== \"none\" && transform !== undefined) {\n        addClass(parentElm, \"introjs-fixParent\");\n      }\n\n      parentElm = parentElm.parentNode;\n    }\n  }\n\n  /**\n   * scroll a scrollable element to a child element\n   *\n   * @param Element parent\n   * @param Element element\n   * @return Null\n   */\n  function scrollParentToElement(parent, _ref) {\n    var offsetTop = _ref.offsetTop;\n    parent.scrollTop = offsetTop - parent.offsetTop;\n  }\n\n  /**\n   * Find the nearest scrollable parent\n   * copied from https://stackoverflow.com/questions/35939886/find-first-scrollable-parent\n   *\n   * @param Element element\n   * @return Element\n   */\n  function getScrollParent(element) {\n    var style = window.getComputedStyle(element);\n    var excludeStaticParent = style.position === \"absolute\";\n    var overflowRegex = /(auto|scroll)/;\n    if (style.position === \"fixed\") return document.body;\n\n    for (var parent = element; parent = parent.parentElement;) {\n      style = window.getComputedStyle(parent);\n\n      if (excludeStaticParent && style.position === \"static\") {\n        continue;\n      }\n\n      if (overflowRegex.test(style.overflow + style.overflowY + style.overflowX)) return parent;\n    }\n\n    return document.body;\n  }\n\n  /**\n   * Provides a cross-browser way to get the screen dimensions\n   * via: http://stackoverflow.com/questions/5864467/internet-explorer-innerheight\n   *\n   * @api private\n   * @method _getWinSize\n   * @returns {Object} width and height attributes\n   */\n  function getWinSize() {\n    if (window.innerWidth !== undefined) {\n      return {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    } else {\n      var D = document.documentElement;\n      return {\n        width: D.clientWidth,\n        height: D.clientHeight\n      };\n    }\n  }\n\n  /**\n   * Check to see if the element is in the viewport or not\n   * http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport\n   *\n   * @api private\n   * @method _elementInViewport\n   * @param {Object} el\n   */\n  function elementInViewport(el) {\n    var rect = el.getBoundingClientRect();\n    return rect.top >= 0 && rect.left >= 0 && rect.bottom + 80 <= window.innerHeight && // add 80 to get the text right\n    rect.right <= window.innerWidth;\n  }\n\n  /**\n   * To change the scroll of `window` after highlighting an element\n   *\n   * @api private\n   * @method _scrollTo\n   * @param {String} scrollTo\n   * @param {Object} targetElement\n   * @param {Object} tooltipLayer\n   */\n\n  function scrollTo(scrollTo, _ref, tooltipLayer) {\n    var element = _ref.element;\n    if (scrollTo === \"off\") return;\n    var rect;\n    if (!this._options.scrollToElement) return;\n\n    if (scrollTo === \"tooltip\") {\n      rect = tooltipLayer.getBoundingClientRect();\n    } else {\n      rect = element.getBoundingClientRect();\n    }\n\n    if (!elementInViewport(element)) {\n      var winHeight = getWinSize().height;\n      var top = rect.bottom - (rect.bottom - rect.top); // TODO (afshinm): do we need scroll padding now?\n      // I have changed the scroll option and now it scrolls the window to\n      // the center of the target element or tooltip.\n\n      if (top < 0 || element.clientHeight > winHeight) {\n        window.scrollBy(0, rect.top - (winHeight / 2 - rect.height / 2) - this._options.scrollPadding); // 30px padding from edge to look nice\n        //Scroll down\n      } else {\n        window.scrollBy(0, rect.top - (winHeight / 2 - rect.height / 2) + this._options.scrollPadding); // 30px padding from edge to look nice\n      }\n    }\n  }\n\n  /**\n   * Setting anchors to behave like buttons\n   *\n   * @api private\n   * @method _setAnchorAsButton\n   */\n  function setAnchorAsButton(anchor) {\n    anchor.setAttribute(\"role\", \"button\");\n    anchor.tabIndex = 0;\n  }\n\n  /**\n   * Get an element position on the page\n   * Thanks to `meouw`: http://stackoverflow.com/a/442474/375966\n   *\n   * @api private\n   * @method _getOffset\n   * @param {Object} element\n   * @returns Element's position info\n   */\n  function getOffset(element) {\n    var body = document.body;\n    var docEl = document.documentElement;\n    var scrollTop = window.pageYOffset || docEl.scrollTop || body.scrollTop;\n    var scrollLeft = window.pageXOffset || docEl.scrollLeft || body.scrollLeft;\n    var x = element.getBoundingClientRect();\n    return {\n      top: x.top + scrollTop,\n      width: x.width,\n      height: x.height,\n      left: x.left + scrollLeft\n    };\n  }\n\n  /**\n   * Checks to see if target element (or parents) position is fixed or not\n   *\n   * @api private\n   * @method _isFixed\n   * @param {Object} element\n   * @returns Boolean\n   */\n\n  function isFixed(element) {\n    var p = element.parentNode;\n\n    if (!p || p.nodeName === \"HTML\") {\n      return false;\n    }\n\n    if (getPropValue(element, \"position\") === \"fixed\") {\n      return true;\n    }\n\n    return isFixed(p);\n  }\n\n  /**\n   * Update the position of the helper layer on the screen\n   *\n   * @api private\n   * @method _setHelperLayerPosition\n   * @param {Object} helperLayer\n   */\n\n  function setHelperLayerPosition(helperLayer) {\n    if (helperLayer) {\n      //prevent error when `this._currentStep` in undefined\n      if (!this._introItems[this._currentStep]) return;\n      var currentElement = this._introItems[this._currentStep];\n      var elementPosition = getOffset(currentElement.element);\n      var widthHeightPadding = this._options.helperElementPadding; // If the target element is fixed, the tooltip should be fixed as well.\n      // Otherwise, remove a fixed class that may be left over from the previous\n      // step.\n\n      if (isFixed(currentElement.element)) {\n        addClass(helperLayer, \"introjs-fixedTooltip\");\n      } else {\n        removeClass(helperLayer, \"introjs-fixedTooltip\");\n      }\n\n      if (currentElement.position === \"floating\") {\n        widthHeightPadding = 0;\n      } //set new position to helper layer\n\n      helperLayer.style.cssText = \"width: \".concat(elementPosition.width + widthHeightPadding, \"px; height:\").concat(elementPosition.height + widthHeightPadding, \"px; top:\").concat(elementPosition.top - widthHeightPadding / 2, \"px;left: \").concat(elementPosition.left - widthHeightPadding / 2, \"px;\");\n    }\n  }\n\n  /**\n   * Set tooltip left so it doesn't go off the right side of the window\n   *\n   * @return boolean true, if tooltipLayerStyleLeft is ok.  false, otherwise.\n   */\n  function checkRight(targetOffset, tooltipLayerStyleLeft, tooltipOffset, windowSize, tooltipLayer) {\n    if (targetOffset.left + tooltipLayerStyleLeft + tooltipOffset.width > windowSize.width) {\n      // off the right side of the window\n      tooltipLayer.left = \"\".concat(windowSize.width - tooltipOffset.width - targetOffset.left, \"px\");\n      return false;\n    }\n\n    tooltipLayer.left = \"\".concat(tooltipLayerStyleLeft, \"px\");\n    return true;\n  }\n\n  /**\n   * Set tooltip right so it doesn't go off the left side of the window\n   *\n   * @return boolean true, if tooltipLayerStyleRight is ok.  false, otherwise.\n   */\n  function checkLeft(targetOffset, tooltipLayerStyleRight, tooltipOffset, tooltipLayer) {\n    if (targetOffset.left + targetOffset.width - tooltipLayerStyleRight - tooltipOffset.width < 0) {\n      // off the left side of the window\n      tooltipLayer.style.left = \"\".concat(-targetOffset.left, \"px\");\n      return false;\n    }\n\n    tooltipLayer.style.right = \"\".concat(tooltipLayerStyleRight, \"px\");\n    return true;\n  }\n\n  /**\n   * Remove an entry from a string array if it's there, does nothing if it isn't there.\n   *\n   * @param {Array} stringArray\n   * @param {String} stringToRemove\n   */\n  function removeEntry(stringArray, stringToRemove) {\n    if (stringArray.includes(stringToRemove)) {\n      stringArray.splice(stringArray.indexOf(stringToRemove), 1);\n    }\n  }\n\n  /**\n   * auto-determine alignment\n   * @param {Integer}  offsetLeft\n   * @param {Integer}  tooltipWidth\n   * @param {Object}   windowSize\n   * @param {String}   desiredAlignment\n   * @return {String}  calculatedAlignment\n   */\n\n  function _determineAutoAlignment(offsetLeft, tooltipWidth, _ref, desiredAlignment) {\n    var width = _ref.width;\n    var halfTooltipWidth = tooltipWidth / 2;\n    var winWidth = Math.min(width, window.screen.width);\n    var possibleAlignments = [\"-left-aligned\", \"-middle-aligned\", \"-right-aligned\"];\n    var calculatedAlignment = \"\"; // valid left must be at least a tooltipWidth\n    // away from right side\n\n    if (winWidth - offsetLeft < tooltipWidth) {\n      removeEntry(possibleAlignments, \"-left-aligned\");\n    } // valid middle must be at least half\n    // width away from both sides\n\n\n    if (offsetLeft < halfTooltipWidth || winWidth - offsetLeft < halfTooltipWidth) {\n      removeEntry(possibleAlignments, \"-middle-aligned\");\n    } // valid right must be at least a tooltipWidth\n    // width away from left side\n\n\n    if (offsetLeft < tooltipWidth) {\n      removeEntry(possibleAlignments, \"-right-aligned\");\n    }\n\n    if (possibleAlignments.length) {\n      if (possibleAlignments.includes(desiredAlignment)) {\n        // the desired alignment is valid\n        calculatedAlignment = desiredAlignment;\n      } else {\n        // pick the first valid position, in order\n        calculatedAlignment = possibleAlignments[0];\n      }\n    } else {\n      // if screen width is too small\n      // for ANY alignment, middle is\n      // probably the best for visibility\n      calculatedAlignment = \"-middle-aligned\";\n    }\n\n    return calculatedAlignment;\n  }\n  /**\n   * Determines the position of the tooltip based on the position precedence and availability\n   * of screen space.\n   *\n   * @param {Object}    targetElement\n   * @param {Object}    tooltipLayer\n   * @param {String}    desiredTooltipPosition\n   * @return {String}   calculatedPosition\n   */\n\n\n  function _determineAutoPosition(targetElement, tooltipLayer, desiredTooltipPosition) {\n    // Take a clone of position precedence. These will be the available\n    var possiblePositions = this._options.positionPrecedence.slice();\n\n    var windowSize = getWinSize();\n    var tooltipHeight = getOffset(tooltipLayer).height + 10;\n    var tooltipWidth = getOffset(tooltipLayer).width + 20;\n    var targetElementRect = targetElement.getBoundingClientRect(); // If we check all the possible areas, and there are no valid places for the tooltip, the element\n    // must take up most of the screen real estate. Show the tooltip floating in the middle of the screen.\n\n    var calculatedPosition = \"floating\";\n    /*\n     * auto determine position\n     */\n    // Check for space below\n\n    if (targetElementRect.bottom + tooltipHeight > windowSize.height) {\n      removeEntry(possiblePositions, \"bottom\");\n    } // Check for space above\n\n\n    if (targetElementRect.top - tooltipHeight < 0) {\n      removeEntry(possiblePositions, \"top\");\n    } // Check for space to the right\n\n\n    if (targetElementRect.right + tooltipWidth > windowSize.width) {\n      removeEntry(possiblePositions, \"right\");\n    } // Check for space to the left\n\n\n    if (targetElementRect.left - tooltipWidth < 0) {\n      removeEntry(possiblePositions, \"left\");\n    } // @var {String}  ex: 'right-aligned'\n\n\n    var desiredAlignment = function (pos) {\n      var hyphenIndex = pos.indexOf(\"-\");\n\n      if (hyphenIndex !== -1) {\n        // has alignment\n        return pos.substr(hyphenIndex);\n      }\n\n      return \"\";\n    }(desiredTooltipPosition || \"\"); // strip alignment from position\n\n\n    if (desiredTooltipPosition) {\n      // ex: \"bottom-right-aligned\"\n      // should return 'bottom'\n      desiredTooltipPosition = desiredTooltipPosition.split(\"-\")[0];\n    }\n\n    if (possiblePositions.length) {\n      if (desiredTooltipPosition !== \"auto\" && possiblePositions.includes(desiredTooltipPosition)) {\n        // If the requested position is in the list, choose that\n        calculatedPosition = desiredTooltipPosition;\n      } else {\n        // Pick the first valid position, in order\n        calculatedPosition = possiblePositions[0];\n      }\n    } // only top and bottom positions have optional alignments\n\n\n    if ([\"top\", \"bottom\"].includes(calculatedPosition)) {\n      calculatedPosition += _determineAutoAlignment(targetElementRect.left, tooltipWidth, windowSize, desiredAlignment);\n    }\n\n    return calculatedPosition;\n  }\n  /**\n   * Render tooltip box in the page\n   *\n   * @api private\n   * @method placeTooltip\n   * @param {HTMLElement} targetElement\n   * @param {HTMLElement} tooltipLayer\n   * @param {HTMLElement} arrowLayer\n   * @param {HTMLElement} helperNumberLayer\n   * @param {Boolean} hintMode\n   */\n\n\n  function placeTooltip(targetElement, tooltipLayer, arrowLayer, helperNumberLayer, hintMode) {\n    var tooltipCssClass = \"\";\n    var currentStepObj;\n    var tooltipOffset;\n    var targetOffset;\n    var windowSize;\n    var currentTooltipPosition;\n    hintMode = hintMode || false; //reset the old style\n\n    tooltipLayer.style.top = null;\n    tooltipLayer.style.right = null;\n    tooltipLayer.style.bottom = null;\n    tooltipLayer.style.left = null;\n    tooltipLayer.style.marginLeft = null;\n    tooltipLayer.style.marginTop = null;\n    arrowLayer.style.display = \"inherit\";\n\n    if (typeof helperNumberLayer !== \"undefined\" && helperNumberLayer !== null) {\n      helperNumberLayer.style.top = null;\n      helperNumberLayer.style.left = null;\n    } //prevent error when `this._currentStep` is undefined\n\n\n    if (!this._introItems[this._currentStep]) return; //if we have a custom css class for each step\n\n    currentStepObj = this._introItems[this._currentStep];\n\n    if (typeof currentStepObj.tooltipClass === \"string\") {\n      tooltipCssClass = currentStepObj.tooltipClass;\n    } else {\n      tooltipCssClass = this._options.tooltipClass;\n    }\n\n    tooltipLayer.className = \"introjs-tooltip \".concat(tooltipCssClass).replace(/^\\s+|\\s+$/g, \"\");\n    tooltipLayer.setAttribute(\"role\", \"dialog\");\n    currentTooltipPosition = this._introItems[this._currentStep].position; // Floating is always valid, no point in calculating\n    if (currentTooltipPosition !== \"floating\") {\n      // currentTooltipPosition = _determineAutoPosition.call(this, targetElement, tooltipLayer, currentTooltipPosition);\n    }\n\n    var tooltipLayerStyleLeft;\n    targetOffset = getOffset(targetElement);\n    tooltipOffset = getOffset(tooltipLayer);\n    windowSize = getWinSize();\n    addClass(tooltipLayer, \"introjs-\".concat(currentTooltipPosition));\n    switch (currentTooltipPosition) {\n      case \"top-right-aligned\":\n        arrowLayer.className = \"introjs-arrow bottom-right\";\n        var tooltipLayerStyleRight = 0;\n        checkLeft(targetOffset, tooltipLayerStyleRight, tooltipOffset, tooltipLayer);\n        tooltipLayer.style.bottom = \"\".concat(targetOffset.height + 20, \"px\");\n        break;\n\n      case \"top-middle-aligned\":\n        arrowLayer.className = \"introjs-arrow bottom-middle\";\n        var tooltipLayerStyleLeftRight = targetOffset.width / 2 - tooltipOffset.width / 2; // a fix for middle aligned hints\n\n        if (hintMode) {\n          tooltipLayerStyleLeftRight += 5;\n        }\n\n        if (checkLeft(targetOffset, tooltipLayerStyleLeftRight, tooltipOffset, tooltipLayer)) {\n          tooltipLayer.style.right = null;\n          checkRight(targetOffset, tooltipLayerStyleLeftRight, tooltipOffset, windowSize, tooltipLayer);\n        }\n\n        tooltipLayer.style.bottom = \"\".concat(targetOffset.height + 20, \"px\");\n        break;\n\n      case \"top-left-aligned\": // top-left-aligned is the same as the default top\n\n      case \"top\":\n        arrowLayer.className = \"introjs-arrow bottom\";\n        tooltipLayerStyleLeft = hintMode ? 0 : 15;\n        checkRight(targetOffset, tooltipLayerStyleLeft, tooltipOffset, windowSize, tooltipLayer);\n        tooltipLayer.style.bottom = \"\".concat(targetOffset.height + 20, \"px\");\n        break;\n\n      case \"right\":\n        tooltipLayer.style.left = \"\".concat(targetOffset.width + 20 + 63, \"px\");\n        var imageLayer = document.createElement(\"img\");\n        imageLayer.src= \"/img/Group3.svg\";\n        var parent_div_for_image = document.getElementById(\"custom-arrow-image-cense\");\n        if (targetOffset.top + tooltipOffset.height > windowSize.height) {\n          // In this case, right would have fallen below the bottom of the screen.\n          // Modify so that the bottom of the tooltip connects with the target\n          // arrowLayer.appendChild(imageLayer);\n          // parent_div_for_image.appendChild(imageLayer);\n          parent_div_for_image.style.position = \"relative\";\n          parent_div_for_image.style.left = \"-67px\";\n          parent_div_for_image.style.top = \"\".concat(targetOffset.height - 10, \"px\");\n          arrowLayer.className = \"introjs-arrow left-bottom\";\n          tooltipLayer.style.top = \"-\".concat(tooltipOffset.height - targetOffset.height - 20, \"px\");\n        } else {\n          // arrowLayer.appendChild(imageLayer);\n          // parent_div_for_image.appendChild(imageLayer);\n          parent_div_for_image.style.position = \"relative\";\n          parent_div_for_image.style.left = \"-67px\";\n          parent_div_for_image.style.top = \"\".concat(targetOffset.height - 10, \"px\");\n          // arrowLayer.className = \"introjs-arrow left\";\n          arrowLayer.className = \"introjs-arrow left-bottom\";\n          tooltipLayer.style.top = \"-\".concat(tooltipOffset.height - targetOffset.height - 20, \"px\");\n        }\n\n        break;\n\n      case \"left\":\n        if (!hintMode && this._options.showStepNumbers === true) {\n          tooltipLayer.style.top = \"15px\";\n        }\n\n        if (targetOffset.top + tooltipOffset.height > windowSize.height) {\n          // In this case, left would have fallen below the bottom of the screen.\n          // Modify so that the bottom of the tooltip connects with the target\n          tooltipLayer.style.top = \"-\".concat(tooltipOffset.height - targetOffset.height - 20, \"px\");\n          arrowLayer.className = \"introjs-arrow right-bottom\";\n        } else {\n          arrowLayer.className = \"introjs-arrow right\";\n        }\n\n        tooltipLayer.style.right = \"\".concat(targetOffset.width + 20, \"px\");\n        break;\n\n      case \"floating\":\n        arrowLayer.style.display = \"none\"; //we have to adjust the top and left of layer manually for intro items without element\n\n        tooltipLayer.style.left = \"50%\";\n        tooltipLayer.style.top = \"50%\";\n        tooltipLayer.style.marginLeft = \"-\".concat(tooltipOffset.width / 2, \"px\");\n        tooltipLayer.style.marginTop = \"-\".concat(tooltipOffset.height / 2, \"px\");\n\n        if (typeof helperNumberLayer !== \"undefined\" && helperNumberLayer !== null) {\n          helperNumberLayer.style.left = \"-\".concat(tooltipOffset.width / 2 + 18, \"px\");\n          helperNumberLayer.style.top = \"-\".concat(tooltipOffset.height / 2 + 18, \"px\");\n        }\n\n        break;\n\n      case \"bottom-right-aligned\":\n        arrowLayer.className = \"introjs-arrow top-right\";\n        tooltipLayerStyleRight = 0;\n        checkLeft(targetOffset, tooltipLayerStyleRight, tooltipOffset, tooltipLayer);\n        tooltipLayer.style.top = \"\".concat(targetOffset.height + 20, \"px\");\n        break;\n\n      case \"bottom-middle-aligned\":\n        arrowLayer.className = \"introjs-arrow top-middle\";\n        tooltipLayerStyleLeftRight = targetOffset.width / 2 - tooltipOffset.width / 2; // a fix for middle aligned hints\n\n        if (hintMode) {\n          tooltipLayerStyleLeftRight += 5;\n        }\n\n        if (checkLeft(targetOffset, tooltipLayerStyleLeftRight, tooltipOffset, tooltipLayer)) {\n          tooltipLayer.style.right = null;\n          checkRight(targetOffset, tooltipLayerStyleLeftRight, tooltipOffset, windowSize, tooltipLayer);\n        }\n        var get_left_offset  = Math.max(\n          document.documentElement.clientWidth\n        );\n\n        var get_top_offset = document.documentElement.clientHeight;\n\n        // tooltipLayer.style.top = \"\".concat(targetOffset.height + 20, \"px\");\n        tooltipLayer.style.top = \"\".concat((get_top_offset / 2.3), \"px\");\n        tooltipLayer.style.left = \"\".concat((get_left_offset / 2.5), \"px\");\n        break;\n      // case 'bottom-left-aligned':\n      // Bottom-left-aligned is the same as the default bottom\n      // case 'bottom':\n      // Bottom going to follow the default behavior\n\n      default:\n        arrowLayer.className = \"introjs-arrow top\";\n        tooltipLayerStyleLeft = 0;\n        checkRight(targetOffset, tooltipLayerStyleLeft, tooltipOffset, windowSize, tooltipLayer);\n        tooltipLayer.style.top = \"\".concat(targetOffset.height + 20, \"px\");\n    }\n  }\n\n  /**\n   * To remove all show element(s)\n   *\n   * @api private\n   * @method _removeShowElement\n   */\n\n  function removeShowElement() {\n    var elms = document.querySelectorAll(\".introjs-showElement\");\n    forEach(elms, function (elm) {\n      removeClass(elm, /introjs-[a-zA-Z]+/g);\n    });\n  }\n\n  /**\n   * Gets the current progress percentage\n   *\n   * @api private\n   * @method _getProgress\n   * @returns current progress percentage\n   */\n\n  function _getProgress() {\n    // Steps are 0 indexed\n    var currentStep = parseInt(this._currentStep + 1, 10);\n    return currentStep / this._introItems.length * 100;\n  }\n  /**\n   * Add disableinteraction layer and adjust the size and position of the layer\n   *\n   * @api private\n   * @method _disableInteraction\n   */\n\n\n  function _disableInteraction() {\n    var disableInteractionLayer = document.querySelector(\".introjs-disableInteraction\");\n\n    if (disableInteractionLayer === null) {\n      disableInteractionLayer = document.createElement(\"div\");\n      disableInteractionLayer.className = \"introjs-disableInteraction\";\n\n      this._targetElement.appendChild(disableInteractionLayer);\n    }\n\n    setHelperLayerPosition.call(this, disableInteractionLayer);\n  }\n  /**\n   * Show an element on the page\n   *\n   * @api private\n   * @method _showElement\n   * @param {Object} targetElement\n   */\n\n\n  function _showElement(targetElement) {\n    if (typeof this._introChangeCallback !== \"undefined\") {\n      this._introChangeCallback.call(this, targetElement.element);\n    }\n\n    var self = this;\n    var oldHelperLayer = document.querySelector(\".introjs-helperLayer\");\n    var oldReferenceLayer = document.querySelector(\".introjs-tooltipReferenceLayer\");\n    var highlightClass = \"introjs-helperLayer\";\n    var nextTooltipButton;\n    var prevTooltipButton;\n    var skipTooltipButton;\n    var scrollParent; //check for a current step highlight class\n\n    if (typeof targetElement.highlightClass === \"string\") {\n      highlightClass += \" \".concat(targetElement.highlightClass);\n    } //check for options highlight class\n\n\n    if (typeof this._options.highlightClass === \"string\") {\n      highlightClass += \" \".concat(this._options.highlightClass);\n    }\n\n    if (oldHelperLayer !== null) {\n      var oldHelperNumberLayer = oldReferenceLayer.querySelector(\".introjs-helperNumberLayer\");\n      var oldtooltipLayer = oldReferenceLayer.querySelector(\".introjs-tooltiptext\");\n      var oldArrowLayer = oldReferenceLayer.querySelector(\".introjs-arrow\");\n      var oldtooltipContainer = oldReferenceLayer.querySelector(\".introjs-tooltip\");\n      skipTooltipButton = oldReferenceLayer.querySelector(\".introjs-skipbutton\");\n      prevTooltipButton = oldReferenceLayer.querySelector(\".introjs-prevbutton\");\n      nextTooltipButton = oldReferenceLayer.querySelector(\".introjs-nextbutton\"); //update or reset the helper highlight class\n\n      oldHelperLayer.className = highlightClass; //hide the tooltip\n      if (document.contains(document.getElementById(\"label_display_div\"))) {\n        document.getElementById(\"label_display_div\").remove();\n      } \n      if(targetElement.labelDisplay !== \"WELCOME\"){\n        document.getElementById(\"custom-arrow-image-cense\").style.display = \"block\";\n        document.getElementById(\"custom-arrow-image-cense\").style.opacity = 1;\n      } else {\n        document.getElementById(\"custom-arrow-image-cense\").style.opacity = 0;\n      }\n      var label_display_div = document.createElement(\"div\");\n      label_display_div.id = \"label_display_div\";\n      label_display_div.style.color = \"#FFFFFF\";\n      label_display_div.style.textAlign = \"center\";\n      label_display_div.style.marginTop = \"0.5rem\";\n      label_display_div.innerHTML = targetElement.labelDisplay;\n      oldHelperLayer.appendChild(label_display_div);\n\n      // oldHelperLayer.innerHTML = targetElement.labelDisplay;\n      oldtooltipContainer.style.opacity = 0;\n      oldtooltipContainer.style.display = \"none\";\n\n      if (oldHelperNumberLayer !== null) {\n        var lastIntroItem = this._introItems[targetElement.step - 2 >= 0 ? targetElement.step - 2 : 0];\n\n        if (lastIntroItem !== null && this._direction === \"forward\" && lastIntroItem.position === \"floating\" || this._direction === \"backward\" && targetElement.position === \"floating\") {\n          oldHelperNumberLayer.style.opacity = 0;\n        }\n      } // scroll to element\n\n\n      scrollParent = getScrollParent(targetElement.element);\n\n      if (scrollParent !== document.body) {\n        // target is within a scrollable element\n        scrollParentToElement(scrollParent, targetElement.element);\n      } // set new position to helper layer\n\n\n      setHelperLayerPosition.call(self, oldHelperLayer);\n      setHelperLayerPosition.call(self, oldReferenceLayer); //remove `introjs-fixParent` class from the elements\n\n      var fixParents = document.querySelectorAll(\".introjs-fixParent\");\n      forEach(fixParents, function (parent) {\n        removeClass(parent, /introjs-fixParent/g);\n      }); //remove old classes if the element still exist\n\n      removeShowElement(); //we should wait until the CSS3 transition is competed (it's 0.3 sec) to prevent incorrect `height` and `width` calculation\n\n      if (self._lastShowElementTimer) {\n        window.clearTimeout(self._lastShowElementTimer);\n      }\n\n      self._lastShowElementTimer = window.setTimeout(function () {\n        //set current step to the label\n        if (oldHelperNumberLayer !== null) {\n          oldHelperNumberLayer.innerHTML = targetElement.step;\n        } //set current tooltip text\n\n        var tooltipHeader = document.createElement(\"h5\");\n        tooltipHeader.style.color = \"#283877\";\n        tooltipHeader.style.fontFamily = \"rubik\";\n        tooltipHeader.innerHTML = targetElement.labelDisplay;\n        var tooltipBody = document.createElement(\"div\");\n        tooltipBody.innerHTML = targetElement.intro;\n        oldtooltipLayer.innerHTML = \"\";\n        oldtooltipLayer.style.maxWidth = \"\";\n        oldtooltipLayer.style.minWidth = \"460px\";\n        // tooltipTextLayer.style.maxWidth = \"300px\";\n        // oldtooltipLayer.innerHTML = targetElement.intro; //set the tooltip position\n        oldtooltipLayer.appendChild(tooltipHeader);\n        oldtooltipLayer.appendChild(tooltipBody);\n        oldtooltipLayer.style.marginBottom = \"-1.52rem\";\n        oldtooltipContainer.style.display = \"block\";\n        oldtooltipLayer.style.paddingLeft= \"1rem\";  \n        // oldtooltipContainer.style.cssText = \"max-width: 700px !important\"; \n        placeTooltip.call(self, targetElement.element, oldtooltipContainer, oldArrowLayer, oldHelperNumberLayer); //change active bullet\n\n        if (self._options.showBullets) {\n          oldReferenceLayer.querySelector(\".introjs-bullets li > a.active\").className = \"\";\n          oldReferenceLayer.querySelector(\".introjs-bullets li > a[data-stepnumber=\\\"\".concat(targetElement.step, \"\\\"]\")).className = \"active\";\n        }\n\n        // oldReferenceLayer.querySelector(\".introjs-progress .introjs-progressbar\").style.cssText = \"width:\".concat(_getProgress.call(self), \"%;\");\n        // oldReferenceLayer.querySelector(\".introjs-progress .introjs-progressbar\").setAttribute(\"aria-valuenow\", _getProgress.call(self)); //show the tooltip\n\n        oldtooltipContainer.style.opacity = 1;\n        if (oldHelperNumberLayer) oldHelperNumberLayer.style.opacity = 1; //reset button focus\n\n        if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null && /introjs-donebutton/gi.test(skipTooltipButton.className)) {\n          // skip button is now \"done\" button\n          skipTooltipButton.focus();\n        } else if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n          //still in the tour, focus on next\n          nextTooltipButton.focus();\n        } // change the scroll of the window, if needed\n\n\n        scrollTo.call(self, targetElement.scrollTo, targetElement, oldtooltipLayer);\n      }, 350); // end of old element if-else condition\n    } else {\n      var helperLayer = document.createElement(\"div\");\n      var referenceLayer = document.createElement(\"div\");\n      var arrowLayer = document.createElement(\"div\");\n      var tooltipLayer = document.createElement(\"div\");\n      var tooltipTextLayer = document.createElement(\"div\");\n      var bulletsLayer = document.createElement(\"div\");\n      var progressLayer = document.createElement(\"div\");\n      var buttonsLayer = document.createElement(\"div\");\n      var imageLayer = document.createElement(\"img\");\n      imageLayer.src= \"/img/Group3.svg\";\n      imageLayer.id = \"custom-arrow-image-cense\";\n      imageLayer.style.display = \"none\";\n      helperLayer.className = highlightClass;\n      referenceLayer.className = \"introjs-tooltipReferenceLayer\"; // scroll to element\n\n      scrollParent = getScrollParent(targetElement.element);\n\n      if (scrollParent !== document.body) {\n        // target is within a scrollable element\n        scrollParentToElement(scrollParent, targetElement.element);\n      } //set new position to helper layer\n\n\n      setHelperLayerPosition.call(self, helperLayer);\n      setHelperLayerPosition.call(self, referenceLayer); //add helper layer to target element\n\n      this._targetElement.appendChild(helperLayer);\n      // this._targetElement.appendChild(imageLayer);\n\n      this._targetElement.appendChild(referenceLayer);\n\n      arrowLayer.className = \"introjs-arrow\";\n      tooltipTextLayer.className = \"introjs-tooltiptext\";\n      var tooltipHeader = document.createElement(\"h5\");\n      tooltipHeader.style.color = \"#283877\";\n      tooltipHeader.innerHTML = \"WELCOME\";\n      var tooltipBody = document.createElement(\"div\");\n      tooltipBody.innerHTML = targetElement.intro;\n      tooltipTextLayer.innerHTML = \"\";\n      tooltipTextLayer.style.minWidth = \"500px\";\n      tooltipTextLayer.style.maxWidth = \"300px\";\n      tooltipTextLayer.appendChild(tooltipHeader);\n      tooltipTextLayer.appendChild(tooltipBody);\n      tooltipTextLayer.style.marginBottom = \"0\";\n      // tooltipTextLayer.innerHTML = targetElement.intro;\n      // var label_display_div = document.createElement(\"div\");\n      // label_display_div.id = \"label_display_div\";\n      // label_display_div.style.color = \"#FFFFFF\";\n      // label_display_div.style.textAlign = \"center\";\n      // label_display_div.style.marginTop = \"0.5rem\";\n      // label_display_div.innerHTML = targetElement.labelDisplay;\n      // helperLayer.appendChild(label_display_div);\n      // helperLayer.innerHTML = targetElement.labelDisplay;\n      bulletsLayer.className = \"introjs-bullets\";\n\n      if (this._options.showBullets === false) {\n        bulletsLayer.style.display = \"none\";\n      }\n\n      var ulContainer = document.createElement(\"ul\");\n      ulContainer.setAttribute(\"role\", \"tablist\");\n\n      var anchorClick = function anchorClick() {\n        self.goToStep(this.getAttribute(\"data-stepnumber\"));\n      };\n\n      forEach(this._introItems, function (_ref, i) {\n        var step = _ref.step;\n        var innerLi = document.createElement(\"li\");\n        var anchorLink = document.createElement(\"a\");\n        innerLi.setAttribute(\"role\", \"presentation\");\n        anchorLink.setAttribute(\"role\", \"tab\");\n        anchorLink.onclick = anchorClick;\n\n        if (i === targetElement.step - 1) {\n          anchorLink.className = \"active\";\n        }\n\n        setAnchorAsButton(anchorLink);\n        anchorLink.innerHTML = \"&nbsp;\";\n        anchorLink.setAttribute(\"data-stepnumber\", step);\n        innerLi.appendChild(anchorLink);\n        ulContainer.appendChild(innerLi);\n      });\n      bulletsLayer.appendChild(ulContainer);\n      progressLayer.className = \"introjs-progress\";\n\n      if (this._options.showProgress === false) {\n        progressLayer.style.display = \"none\";\n      }\n\n      var progressBar = document.createElement(\"div\");\n      progressBar.className = \"introjs-progressbar\";\n      progressBar.setAttribute(\"role\", \"progress\");\n      progressBar.setAttribute(\"aria-valuemin\", 0);\n      progressBar.setAttribute(\"aria-valuemax\", 100);\n      progressBar.setAttribute(\"aria-valuenow\", _getProgress.call(this));\n      progressBar.style.cssText = \"width:\".concat(_getProgress.call(this), \"%;\");\n      progressLayer.appendChild(progressBar);\n      buttonsLayer.className = \"introjs-tooltipbuttons\";\n\n      if (this._options.showButtons === false) {\n        buttonsLayer.style.display = \"none\";\n      }\n\n      tooltipLayer.className = \"introjs-tooltip\";\n      // tooltipLayer.style.cssText = \"max-width: 300px !important\"; \n      tooltipLayer.appendChild(tooltipTextLayer);\n      tooltipLayer.appendChild(imageLayer);\n      // tooltipLayer.appendChild(bulletsLayer);\n      // tooltipLayer.appendChild(progressLayer); //add helper layer number\n\n      var helperNumberLayer = document.createElement(\"span\");\n\n      if (this._options.showStepNumbers === true) {\n        helperNumberLayer.className = \"introjs-helperNumberLayer\";\n        helperNumberLayer.innerHTML = targetElement.step;\n        referenceLayer.appendChild(helperNumberLayer);\n      }\n\n      tooltipLayer.appendChild(arrowLayer);\n      referenceLayer.appendChild(tooltipLayer); //next button\n\n      nextTooltipButton = document.createElement(\"a\");\n\n      nextTooltipButton.onclick = function () {\n        if (self._introItems.length - 1 !== self._currentStep) {\n          nextStep.call(self);\n        }\n      };\n\n      setAnchorAsButton(nextTooltipButton);\n      nextTooltipButton.innerHTML = this._options.nextLabel; //previous button\n\n      prevTooltipButton = document.createElement(\"a\");\n      prevTooltipButton.style.display = \"none\";\n      prevTooltipButton.onclick = function () {\n        if (self._currentStep !== 0) {\n          previousStep.call(self);\n        }\n      };\n\n      setAnchorAsButton(prevTooltipButton);\n      prevTooltipButton.innerHTML = this._options.prevLabel; //skip button\n\n      skipTooltipButton = document.createElement(\"a\");\n      skipTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-skipbutton \");\n      setAnchorAsButton(skipTooltipButton);\n      skipTooltipButton.innerHTML = this._options.skipLabel;\n\n      skipTooltipButton.onclick = function () {\n        if (self._introItems.length - 1 === self._currentStep && typeof self._introCompleteCallback === \"function\") {\n          self._introCompleteCallback.call(self);\n        }\n\n        if (typeof self._introSkipCallback === \"function\") {\n          self._introSkipCallback.call(self);\n        }\n\n        exitIntro.call(self, self._targetElement);\n      };\n\n      buttonsLayer.appendChild(skipTooltipButton); //in order to prevent displaying next/previous button always\n\n      if (this._introItems.length > 1) {\n        buttonsLayer.appendChild(prevTooltipButton);\n        buttonsLayer.appendChild(nextTooltipButton);\n      }\n\n      tooltipLayer.appendChild(buttonsLayer); //set proper position\n\n      placeTooltip.call(self, targetElement.element, tooltipLayer, arrowLayer, helperNumberLayer); // change the scroll of the window, if needed\n\n      scrollTo.call(this, targetElement.scrollTo, targetElement, tooltipLayer); //end of new element if-else condition\n    } // removing previous disable interaction layer\n\n\n    var disableInteractionLayer = self._targetElement.querySelector(\".introjs-disableInteraction\");\n\n    if (disableInteractionLayer) {\n      disableInteractionLayer.parentNode.removeChild(disableInteractionLayer);\n    } //disable interaction\n\n\n    if (targetElement.disableInteraction) {\n      _disableInteraction.call(self);\n    } // when it's the first step of tour\n\n\n    if (this._currentStep === 0 && this._introItems.length > 1) {\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-skipbutton\");\n        skipTooltipButton.style.display=\"none\";\n      }\n\n      if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n        nextTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-nextbutton\");\n      }\n\n      if (this._options.hidePrev === true) {\n        if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n          prevTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-prevbutton introjs-hidden\");\n        }\n\n        if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n          addClass(nextTooltipButton, \"introjs-fullbutton\");\n        }\n      } else {\n        if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n          prevTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-prevbutton introjs-disabled\");\n        }\n      }\n\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.innerHTML = this._options.skipLabel;\n      }\n    } else if (this._introItems.length - 1 === this._currentStep || this._introItems.length === 1) {\n      // last step of tour\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.innerHTML = this._options.doneLabel; // adding donebutton class in addition to skipbutton\n        skipTooltipButton.style.display=\"inline-block\";\n\n        addClass(skipTooltipButton, \"introjs-donebutton\");\n      }\n\n      if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n        prevTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-prevbutton\");\n      }\n\n      if (this._options.hideNext === true) {\n        if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n          nextTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-nextbutton introjs-hidden\");\n        }\n\n        if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n          addClass(prevTooltipButton, \"introjs-fullbutton\");\n        }\n      } else {\n        if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n          nextTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-nextbutton introjs-disabled\");\n        }\n      }\n    } else {\n      // steps between start and end\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.style.display=\"none\";\n        skipTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-skipbutton\");\n      }\n\n      if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n        prevTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-prevbutton\");\n      }\n\n      if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n        nextTooltipButton.className = \"\".concat(this._options.buttonClass, \" introjs-nextbutton\");\n      }\n\n      if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n        skipTooltipButton.innerHTML = this._options.skipLabel;\n      }\n    }\n\n    if (typeof prevTooltipButton !== \"undefined\" && prevTooltipButton !== null) {\n      prevTooltipButton.setAttribute(\"role\", \"button\");\n    }\n\n    if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n      nextTooltipButton.setAttribute(\"role\", \"button\");\n    }\n\n    if (typeof skipTooltipButton !== \"undefined\" && skipTooltipButton !== null) {\n      skipTooltipButton.setAttribute(\"role\", \"button\");\n    } //Set focus on \"next\" button, so that hitting Enter always moves you onto the next step\n\n\n    if (typeof nextTooltipButton !== \"undefined\" && nextTooltipButton !== null) {\n      nextTooltipButton.focus();\n    }\n\n    setShowElement(targetElement);\n\n    if (typeof this._introAfterChangeCallback !== \"undefined\") {\n      this._introAfterChangeCallback.call(this, targetElement.element);\n    }\n  }\n\n  /**\n   * Go to specific step of introduction\n   *\n   * @api private\n   * @method _goToStep\n   */\n\n  function goToStep(step) {\n    //because steps starts with zero\n    this._currentStep = step - 2;\n\n    if (typeof this._introItems !== \"undefined\") {\n      nextStep.call(this);\n    }\n  }\n  /**\n   * Go to the specific step of introduction with the explicit [data-step] number\n   *\n   * @api private\n   * @method _goToStepNumber\n   */\n\n  function goToStepNumber(step) {\n    this._currentStepNumber = step;\n\n    if (typeof this._introItems !== \"undefined\") {\n      nextStep.call(this);\n    }\n  }\n  /**\n   * Go to next step on intro\n   *\n   * @api private\n   * @method _nextStep\n   */\n\n  function nextStep() {\n    var _this = this;\n\n    this._direction = \"forward\";\n\n    if (typeof this._currentStepNumber !== \"undefined\") {\n      forEach(this._introItems, function (_ref, i) {\n        var step = _ref.step;\n\n        if (step === _this._currentStepNumber) {\n          _this._currentStep = i - 1;\n          _this._currentStepNumber = undefined;\n        }\n      });\n    }\n\n    if (typeof this._currentStep === \"undefined\") {\n      this._currentStep = 0;\n    } else {\n      ++this._currentStep;\n    }\n\n    var nextStep = this._introItems[this._currentStep];\n    var continueStep = true;\n\n    if (typeof this._introBeforeChangeCallback !== \"undefined\") {\n      continueStep = this._introBeforeChangeCallback.call(this, nextStep.element);\n    } // if `onbeforechange` returned `false`, stop displaying the element\n\n\n    if (continueStep === false) {\n      --this._currentStep;\n      return false;\n    }\n\n    if (this._introItems.length <= this._currentStep) {\n      //end of the intro\n      //check if any callback is defined\n      if (typeof this._introCompleteCallback === \"function\") {\n        this._introCompleteCallback.call(this);\n      }\n\n      exitIntro.call(this, this._targetElement);\n      return;\n    }\n\n    _showElement.call(this, nextStep);\n  }\n  /**\n   * Go to previous step on intro\n   *\n   * @api private\n   * @method _previousStep\n   */\n\n  function previousStep() {\n    this._direction = \"backward\";\n\n    if (this._currentStep === 0) {\n      return false;\n    }\n\n    --this._currentStep;\n    var nextStep = this._introItems[this._currentStep];\n    var continueStep = true;\n\n    if (typeof this._introBeforeChangeCallback !== \"undefined\") {\n      continueStep = this._introBeforeChangeCallback.call(this, nextStep.element);\n    } // if `onbeforechange` returned `false`, stop displaying the element\n\n\n    if (continueStep === false) {\n      ++this._currentStep;\n      return false;\n    }\n\n    _showElement.call(this, nextStep);\n  }\n  /**\n   * Returns the current step of the intro\n   *\n   * @returns {boolean}\n   */\n\n  function currentStep() {\n    return this._currentStep;\n  }\n\n  /**\n   * on keyCode:\n   * https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode\n   * This feature has been removed from the Web standards.\n   * Though some browsers may still support it, it is in\n   * the process of being dropped.\n   * Instead, you should use KeyboardEvent.code,\n   * if it's implemented.\n   *\n   * jQuery's approach is to test for\n   *   (1) e.which, then\n   *   (2) e.charCode, then\n   *   (3) e.keyCode\n   * https://github.com/jquery/jquery/blob/a6b0705294d336ae2f63f7276de0da1195495363/src/event.js#L638\n   *\n   * @param type var\n   * @return type\n   */\n\n  function onKeyDown(e) {\n    var code = e.code === null ? e.which : e.code; // if code/e.which is null\n\n    if (code === null) {\n      code = e.charCode === null ? e.keyCode : e.charCode;\n    }\n\n    if ((code === \"Escape\" || code === 27) && this._options.exitOnEsc === true) {\n      //escape key pressed, exit the intro\n      //check if exit callback is defined\n      exitIntro.call(this, this._targetElement);\n    } else if (code === \"ArrowLeft\" || code === 37) {\n      //left arrow\n      previousStep.call(this);\n    } else if (code === \"ArrowRight\" || code === 39) {\n      //right arrow\n      nextStep.call(this);\n    } else if (code === \"Enter\" || code === 13) {\n      //srcElement === ie\n      var target = e.target || e.srcElement;\n\n      if (target && target.className.match(\"introjs-prevbutton\")) {\n        //user hit enter while focusing on previous button\n        previousStep.call(this);\n      } else if (target && target.className.match(\"introjs-skipbutton\")) {\n        //user hit enter while focusing on skip button\n        if (this._introItems.length - 1 === this._currentStep && typeof this._introCompleteCallback === \"function\") {\n          this._introCompleteCallback.call(this);\n        }\n\n        exitIntro.call(this, this._targetElement);\n      } else if (target && target.getAttribute(\"data-stepnumber\")) {\n        // user hit enter while focusing on step bullet\n        target.click();\n      } else {\n        //default behavior for responding to enter\n        nextStep.call(this);\n      } //prevent default behaviour on hitting Enter, to prevent steps being skipped in some browsers\n\n\n      if (e.preventDefault) {\n        e.preventDefault();\n      } else {\n        e.returnValue = false;\n      }\n    }\n  }\n\n  /*\n   * makes a copy of the object\n   * @api private\n   * @method _cloneObject\n   */\n  function cloneObject(object) {\n    if (object === null || _typeof(object) !== \"object\" || typeof object.nodeType !== \"undefined\") {\n      return object;\n    }\n\n    var temp = {};\n\n    for (var key in object) {\n      if (typeof window.jQuery !== \"undefined\" && object[key] instanceof window.jQuery) {\n        temp[key] = object[key];\n      } else {\n        temp[key] = cloneObject(object[key]);\n      }\n    }\n\n    return temp;\n  }\n\n  /**\n   * Get a queryselector within the hint wrapper\n   *\n   * @param {String} selector\n   * @return {NodeList|Array}\n   */\n\n  function hintQuerySelectorAll(selector) {\n    var hintsWrapper = document.querySelector(\".introjs-hints\");\n    return hintsWrapper ? hintsWrapper.querySelectorAll(selector) : [];\n  }\n  /**\n   * Hide a hint\n   *\n   * @api private\n   * @method hideHint\n   */\n\n  function hideHint(stepId) {\n    var hint = hintQuerySelectorAll(\".introjs-hint[data-step=\\\"\".concat(stepId, \"\\\"]\"))[0];\n    removeHintTooltip.call(this);\n\n    if (hint) {\n      addClass(hint, \"introjs-hidehint\");\n    } // call the callback function (if any)\n\n\n    if (typeof this._hintCloseCallback !== \"undefined\") {\n      this._hintCloseCallback.call(this, stepId);\n    }\n  }\n  /**\n   * Hide all hints\n   *\n   * @api private\n   * @method hideHints\n   */\n\n  function hideHints() {\n    var _this = this;\n\n    var hints = hintQuerySelectorAll(\".introjs-hint\");\n    forEach(hints, function (hint) {\n      hideHint.call(_this, hint.getAttribute(\"data-step\"));\n    });\n  }\n  /**\n   * Show all hints\n   *\n   * @api private\n   * @method _showHints\n   */\n\n  function showHints() {\n    var _this2 = this;\n\n    var hints = hintQuerySelectorAll(\".introjs-hint\");\n\n    if (hints && hints.length) {\n      forEach(hints, function (hint) {\n        showHint.call(_this2, hint.getAttribute(\"data-step\"));\n      });\n    } else {\n      populateHints.call(this, this._targetElement);\n    }\n  }\n  /**\n   * Show a hint\n   *\n   * @api private\n   * @method showHint\n   */\n\n  function showHint(stepId) {\n    var hint = hintQuerySelectorAll(\".introjs-hint[data-step=\\\"\".concat(stepId, \"\\\"]\"))[0];\n\n    if (hint) {\n      removeClass(hint, /introjs-hidehint/g);\n    }\n  }\n  /**\n   * Removes all hint elements on the page\n   * Useful when you want to destroy the elements and add them again (e.g. a modal or popup)\n   *\n   * @api private\n   * @method removeHints\n   */\n\n  function removeHints() {\n    var _this3 = this;\n\n    var hints = hintQuerySelectorAll(\".introjs-hint\");\n    forEach(hints, function (hint) {\n      removeHint.call(_this3, hint.getAttribute(\"data-step\"));\n    });\n  }\n  /**\n   * Remove one single hint element from the page\n   * Useful when you want to destroy the element and add them again (e.g. a modal or popup)\n   * Use removeHints if you want to remove all elements.\n   *\n   * @api private\n   * @method removeHint\n   */\n\n  function removeHint(stepId) {\n    var hint = hintQuerySelectorAll(\".introjs-hint[data-step=\\\"\".concat(stepId, \"\\\"]\"))[0];\n\n    if (hint) {\n      hint.parentNode.removeChild(hint);\n    }\n  }\n  /**\n   * Add all available hints to the page\n   *\n   * @api private\n   * @method addHints\n   */\n\n  function addHints() {\n    var _this4 = this;\n\n    var self = this;\n    var hintsWrapper = document.querySelector(\".introjs-hints\");\n\n    if (hintsWrapper === null) {\n      hintsWrapper = document.createElement(\"div\");\n      hintsWrapper.className = \"introjs-hints\";\n    }\n    /**\n     * Returns an event handler unique to the hint iteration\n     *\n     * @param {Integer} i\n     * @return {Function}\n     */\n\n\n    var getHintClick = function getHintClick(i) {\n      return function (e) {\n        var evt = e ? e : window.event;\n\n        if (evt.stopPropagation) {\n          evt.stopPropagation();\n        }\n\n        if (evt.cancelBubble !== null) {\n          evt.cancelBubble = true;\n        }\n\n        showHintDialog.call(self, i);\n      };\n    };\n\n    forEach(this._introItems, function (item, i) {\n      // avoid append a hint twice\n      if (document.querySelector(\".introjs-hint[data-step=\\\"\".concat(i, \"\\\"]\"))) {\n        return;\n      }\n\n      var hint = document.createElement(\"a\");\n      setAnchorAsButton(hint);\n      hint.onclick = getHintClick(i);\n      hint.className = \"introjs-hint\";\n\n      if (!item.hintAnimation) {\n        addClass(hint, \"introjs-hint-no-anim\");\n      } // hint's position should be fixed if the target element's position is fixed\n\n\n      if (isFixed(item.element)) {\n        addClass(hint, \"introjs-fixedhint\");\n      }\n\n      var hintDot = document.createElement(\"div\");\n      hintDot.className = \"introjs-hint-dot\";\n      var hintPulse = document.createElement(\"div\");\n      hintPulse.className = \"introjs-hint-pulse\";\n      hint.appendChild(hintDot);\n      hint.appendChild(hintPulse);\n      hint.setAttribute(\"data-step\", i); // we swap the hint element with target element\n      // because _setHelperLayerPosition uses `element` property\n\n      item.targetElement = item.element;\n      item.element = hint; // align the hint position\n\n      alignHintPosition.call(_this4, item.hintPosition, hint, item.targetElement);\n      hintsWrapper.appendChild(hint);\n    }); // adding the hints wrapper\n\n    document.body.appendChild(hintsWrapper); // call the callback function (if any)\n\n    if (typeof this._hintsAddedCallback !== \"undefined\") {\n      this._hintsAddedCallback.call(this);\n    }\n  }\n  /**\n   * Aligns hint position\n   *\n   * @api private\n   * @method alignHintPosition\n   * @param {String} position\n   * @param {Object} hint\n   * @param {Object} element\n   */\n\n  function alignHintPosition(position, _ref, element) {\n    var style = _ref.style;\n    // get/calculate offset of target element\n    var offset = getOffset.call(this, element);\n    var iconWidth = 20;\n    var iconHeight = 20; // align the hint element\n\n    switch (position) {\n      default:\n      case \"top-left\":\n        style.left = \"\".concat(offset.left, \"px\");\n        style.top = \"\".concat(offset.top, \"px\");\n        break;\n\n      case \"top-right\":\n        style.left = \"\".concat(offset.left + offset.width - iconWidth, \"px\");\n        style.top = \"\".concat(offset.top, \"px\");\n        break;\n\n      case \"bottom-left\":\n        style.left = \"\".concat(offset.left, \"px\");\n        style.top = \"\".concat(offset.top + offset.height - iconHeight, \"px\");\n        break;\n\n      case \"bottom-right\":\n        style.left = \"\".concat(offset.left + offset.width - iconWidth, \"px\");\n        style.top = \"\".concat(offset.top + offset.height - iconHeight, \"px\");\n        break;\n\n      case \"middle-left\":\n        style.left = \"\".concat(offset.left, \"px\");\n        style.top = \"\".concat(offset.top + (offset.height - iconHeight) / 2, \"px\");\n        break;\n\n      case \"middle-right\":\n        style.left = \"\".concat(offset.left + offset.width - iconWidth, \"px\");\n        style.top = \"\".concat(offset.top + (offset.height - iconHeight) / 2, \"px\");\n        break;\n\n      case \"middle-middle\":\n        style.left = \"\".concat(offset.left + (offset.width - iconWidth) / 2, \"px\");\n        style.top = \"\".concat(offset.top + (offset.height - iconHeight) / 2, \"px\");\n        break;\n\n      case \"bottom-middle\":\n        style.left = \"\".concat(offset.left + (offset.width - iconWidth) / 2, \"px\");\n        style.top = \"\".concat(offset.top + offset.height - iconHeight, \"px\");\n        break;\n\n      case \"top-middle\":\n        style.left = \"\".concat(offset.left + (offset.width - iconWidth) / 2, \"px\");\n        style.top = \"\".concat(offset.top, \"px\");\n        break;\n    }\n  }\n  /**\n   * Triggers when user clicks on the hint element\n   *\n   * @api private\n   * @method _showHintDialog\n   * @param {Number} stepId\n   */\n\n  function showHintDialog(stepId) {\n    var hintElement = document.querySelector(\".introjs-hint[data-step=\\\"\".concat(stepId, \"\\\"]\"));\n    var item = this._introItems[stepId]; // call the callback function (if any)\n\n    if (typeof this._hintClickCallback !== \"undefined\") {\n      this._hintClickCallback.call(this, hintElement, item, stepId);\n    } // remove all open tooltips\n\n\n    var removedStep = removeHintTooltip.call(this); // to toggle the tooltip\n\n    if (parseInt(removedStep, 10) === stepId) {\n      return;\n    }\n\n    var tooltipLayer = document.createElement(\"div\");\n    var tooltipTextLayer = document.createElement(\"div\");\n    var arrowLayer = document.createElement(\"div\");\n    var referenceLayer = document.createElement(\"div\");\n    tooltipLayer.className = \"introjs-tooltip\";\n\n    tooltipLayer.onclick = function (e) {\n      //IE9 & Other Browsers\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      } //IE8 and Lower\n      else {\n          e.cancelBubble = true;\n        }\n    };\n\n    tooltipTextLayer.className = \"introjs-tooltiptext\";\n    var tooltipWrapper = document.createElement(\"p\");\n    tooltipWrapper.innerHTML = item.hint;\n    var closeButton = document.createElement(\"a\");\n    closeButton.className = this._options.buttonClass;\n    closeButton.setAttribute(\"role\", \"button\");\n    closeButton.innerHTML = this._options.hintButtonLabel;\n    closeButton.onclick = hideHint.bind(this, stepId);\n    tooltipTextLayer.appendChild(tooltipWrapper);\n    tooltipTextLayer.appendChild(closeButton);\n    arrowLayer.className = \"introjs-arrow\";\n    tooltipLayer.appendChild(arrowLayer);\n    tooltipLayer.appendChild(tooltipTextLayer); // set current step for _placeTooltip function\n\n    this._currentStep = hintElement.getAttribute(\"data-step\"); // align reference layer position\n\n    referenceLayer.className = \"introjs-tooltipReferenceLayer introjs-hintReference\";\n    referenceLayer.setAttribute(\"data-step\", hintElement.getAttribute(\"data-step\"));\n    setHelperLayerPosition.call(this, referenceLayer);\n    referenceLayer.appendChild(tooltipLayer);\n    document.body.appendChild(referenceLayer); //set proper position\n\n    placeTooltip.call(this, hintElement, tooltipLayer, arrowLayer, null, true);\n  }\n  /**\n   * Removes open hint (tooltip hint)\n   *\n   * @api private\n   * @method _removeHintTooltip\n   */\n\n  function removeHintTooltip() {\n    var tooltip = document.querySelector(\".introjs-hintReference\");\n\n    if (tooltip) {\n      var step = tooltip.getAttribute(\"data-step\");\n      tooltip.parentNode.removeChild(tooltip);\n      return step;\n    }\n  }\n  /**\n   * Start parsing hint items\n   *\n   * @api private\n   * @param {Object} targetElm\n   * @method _startHint\n   */\n\n  function populateHints(targetElm) {\n    var _this5 = this;\n\n    this._introItems = [];\n\n    if (this._options.hints) {\n      forEach(this._options.hints, function (hint) {\n        var currentItem = cloneObject(hint);\n\n        if (typeof currentItem.element === \"string\") {\n          //grab the element with given selector from the page\n          currentItem.element = document.querySelector(currentItem.element);\n        }\n\n        currentItem.hintPosition = currentItem.hintPosition || _this5._options.hintPosition;\n        currentItem.hintAnimation = currentItem.hintAnimation || _this5._options.hintAnimation;\n\n        if (currentItem.element !== null) {\n          _this5._introItems.push(currentItem);\n        }\n      });\n    } else {\n      var hints = targetElm.querySelectorAll(\"*[data-hint]\");\n\n      if (!hints || !hints.length) {\n        return false;\n      } //first add intro items with data-step\n\n\n      forEach(hints, function (currentElement) {\n        // hint animation\n        var hintAnimation = currentElement.getAttribute(\"data-hintanimation\");\n\n        if (hintAnimation) {\n          hintAnimation = hintAnimation === \"true\";\n        } else {\n          hintAnimation = _this5._options.hintAnimation;\n        }\n\n        _this5._introItems.push({\n          element: currentElement,\n          hint: currentElement.getAttribute(\"data-hint\"),\n          hintPosition: currentElement.getAttribute(\"data-hintposition\") || _this5._options.hintPosition,\n          hintAnimation: hintAnimation,\n          tooltipClass: currentElement.getAttribute(\"data-tooltipclass\"),\n          position: currentElement.getAttribute(\"data-position\") || _this5._options.tooltipPosition\n        });\n      });\n    }\n\n    addHints.call(this);\n    /*\n    todo:\n    these events should be removed at some point\n    */\n\n    DOMEvent.on(document, \"click\", removeHintTooltip, this, false);\n    DOMEvent.on(window, \"resize\", reAlignHints, this, true);\n  }\n  /**\n   * Re-aligns all hint elements\n   *\n   * @api private\n   * @method _reAlignHints\n   */\n\n  function reAlignHints() {\n    var _this6 = this;\n\n    forEach(this._introItems, function (_ref2) {\n      var targetElement = _ref2.targetElement,\n          hintPosition = _ref2.hintPosition,\n          element = _ref2.element;\n\n      if (typeof targetElement === \"undefined\") {\n        return;\n      }\n\n      alignHintPosition.call(_this6, hintPosition, element, targetElement);\n    });\n  }\n\n  /**\n   * Update placement of the intro objects on the screen\n   * @api private\n   */\n\n  function refresh() {\n    // re-align intros\n    setHelperLayerPosition.call(this, document.querySelector(\".introjs-helperLayer\"));\n    setHelperLayerPosition.call(this, document.querySelector(\".introjs-tooltipReferenceLayer\"));\n    setHelperLayerPosition.call(this, document.querySelector(\".introjs-disableInteraction\")); // re-align tooltip\n\n    if (this._currentStep !== undefined && this._currentStep !== null) {\n      var oldHelperNumberLayer = document.querySelector(\".introjs-helperNumberLayer\");\n      var oldArrowLayer = document.querySelector(\".introjs-arrow\");\n      var oldtooltipContainer = document.querySelector(\".introjs-tooltip\");\n      placeTooltip.call(this, this._introItems[this._currentStep].element, oldtooltipContainer, oldArrowLayer, oldHelperNumberLayer);\n    } //re-align hints\n\n\n    reAlignHints.call(this);\n    return this;\n  }\n\n  function onResize() {\n    refresh.call(this);\n  }\n\n  /**\n   * Exit from intro\n   *\n   * @api private\n   * @method _exitIntro\n   * @param {Object} targetElement\n   * @param {Boolean} force - Setting to `true` will skip the result of beforeExit callback\n   */\n\n  function exitIntro(targetElement, force) {\n    var continueExit = true; // calling onbeforeexit callback\n    //\n    // If this callback return `false`, it would halt the process\n\n    if (this._introBeforeExitCallback !== undefined) {\n      continueExit = this._introBeforeExitCallback.call(this);\n    } // skip this check if `force` parameter is `true`\n    // otherwise, if `onbeforeexit` returned `false`, don't exit the intro\n\n\n    if (!force && continueExit === false) return; //remove overlay layers from the page\n\n    var overlayLayers = targetElement.querySelectorAll(\".introjs-overlay\");\n\n    if (overlayLayers && overlayLayers.length) {\n      forEach(overlayLayers, function (overlayLayer) {\n        overlayLayer.style.opacity = 0;\n        window.setTimeout(function () {\n          if (this.parentNode) {\n            this.parentNode.removeChild(this);\n          }\n        }.bind(overlayLayer), 500);\n      });\n    } //remove all helper layers\n\n\n    var helperLayer = targetElement.querySelector(\".introjs-helperLayer\");\n\n    if (helperLayer) {\n      helperLayer.parentNode.removeChild(helperLayer);\n    }\n\n    var referenceLayer = targetElement.querySelector(\".introjs-tooltipReferenceLayer\");\n\n    if (referenceLayer) {\n      referenceLayer.parentNode.removeChild(referenceLayer);\n    } //remove disableInteractionLayer\n\n\n    var disableInteractionLayer = targetElement.querySelector(\".introjs-disableInteraction\");\n\n    if (disableInteractionLayer) {\n      disableInteractionLayer.parentNode.removeChild(disableInteractionLayer);\n    } //remove intro floating element\n\n\n    var floatingElement = document.querySelector(\".introjsFloatingElement\");\n\n    if (floatingElement) {\n      floatingElement.parentNode.removeChild(floatingElement);\n    }\n\n    removeShowElement(); //remove `introjs-fixParent` class from the elements\n\n    var fixParents = document.querySelectorAll(\".introjs-fixParent\");\n    forEach(fixParents, function (parent) {\n      removeClass(parent, /introjs-fixParent/g);\n    }); //clean listeners\n\n    DOMEvent.off(window, \"keydown\", onKeyDown, this, true);\n    DOMEvent.off(window, \"resize\", onResize, this, true); //check if any callback is defined\n\n    if (this._introExitCallback !== undefined) {\n      this._introExitCallback.call(this);\n    } //set the step to zero\n\n\n    this._currentStep = undefined;\n  }\n\n  /**\n   * Add overlay layer to the page\n   *\n   * @api private\n   * @method _addOverlayLayer\n   * @param {Object} targetElm\n   */\n\n  function addOverlayLayer(targetElm) {\n    var overlayLayer = document.createElement(\"div\");\n    var styleText = \"\";\n    var self = this; //set css class name\n\n    overlayLayer.className = \"introjs-overlay\"; //check if the target element is body, we should calculate the size of overlay layer in a better way\n\n    if (!targetElm.tagName || targetElm.tagName.toLowerCase() === \"body\") {\n      styleText += \"top: 0;bottom: 0; left: 0;right: 0;position: fixed;\";\n      overlayLayer.style.cssText = styleText;\n    } else {\n      //set overlay layer position\n      var elementPosition = getOffset(targetElm);\n\n      if (elementPosition) {\n        styleText += \"width: \".concat(elementPosition.width, \"px; height:\").concat(elementPosition.height, \"px; top:\").concat(elementPosition.top, \"px;left: \").concat(elementPosition.left, \"px;\");\n        overlayLayer.style.cssText = styleText;\n      }\n    }\n\n    targetElm.appendChild(overlayLayer);\n\n    overlayLayer.onclick = function () {\n      if (self._options.exitOnOverlayClick === true) {\n        exitIntro.call(self, targetElm);\n      }\n    };\n\n    window.setTimeout(function () {\n      styleText += \"opacity: \".concat(self._options.overlayOpacity.toString(), \";\");\n      overlayLayer.style.cssText = styleText;\n    }, 10);\n    return true;\n  }\n\n  /**\n   * Initiate a new introduction/guide from an element in the page\n   *\n   * @api private\n   * @method _introForElement\n   * @param {Object} targetElm\n   * @param {String} group\n   * @returns {Boolean} Success or not?\n   */\n\n  function introForElement(targetElm, group) {\n    var _this = this;\n\n    var allIntroSteps = targetElm.querySelectorAll(\"*[data-intro]\");\n    var introItems = [];\n\n    if (this._options.steps) {\n      //use steps passed programmatically\n      forEach(this._options.steps, function (step) {\n        var currentItem = cloneObject(step); //set the step\n\n        currentItem.step = introItems.length + 1; //use querySelector function only when developer used CSS selector\n\n        if (typeof currentItem.element === \"string\") {\n          //grab the element with given selector from the page\n          currentItem.element = document.querySelector(currentItem.element);\n        } //intro without element\n\n\n        if (typeof currentItem.element === \"undefined\" || currentItem.element === null) {\n          var floatingElementQuery = document.querySelector(\".introjsFloatingElement\");\n\n          if (floatingElementQuery === null) {\n            floatingElementQuery = document.createElement(\"div\");\n            floatingElementQuery.className = \"introjsFloatingElement\";\n            document.body.appendChild(floatingElementQuery);\n          }\n\n          currentItem.element = floatingElementQuery;\n          currentItem.position = \"floating\";\n        }\n\n        currentItem.scrollTo = currentItem.scrollTo || _this._options.scrollTo;\n\n        if (typeof currentItem.disableInteraction === \"undefined\") {\n          currentItem.disableInteraction = _this._options.disableInteraction;\n        }\n\n        if (currentItem.element !== null) {\n          introItems.push(currentItem);\n        }\n      });\n    } else {\n      //use steps from data-* annotations\n      var elmsLength = allIntroSteps.length;\n      var disableInteraction; //if there's no element to intro\n\n      if (elmsLength < 1) {\n        return false;\n      }\n\n      forEach(allIntroSteps, function (currentElement) {\n        // PR #80\n        // start intro for groups of elements\n        if (group && currentElement.getAttribute(\"data-intro-group\") !== group) {\n          return;\n        } // skip hidden elements\n\n\n        if (currentElement.style.display === \"none\") {\n          return;\n        }\n\n        var step = parseInt(currentElement.getAttribute(\"data-step\"), 10);\n\n        if (typeof currentElement.getAttribute(\"data-disable-interaction\") !== \"undefined\") {\n          disableInteraction = !!currentElement.getAttribute(\"data-disable-interaction\");\n        } else {\n          disableInteraction = _this._options.disableInteraction;\n        }\n\n        if (step > 0) {\n          introItems[step - 1] = {\n            element: currentElement,\n            intro: currentElement.getAttribute(\"data-intro\"),\n            step: parseInt(currentElement.getAttribute(\"data-step\"), 10),\n            tooltipClass: currentElement.getAttribute(\"data-tooltipclass\"),\n            highlightClass: currentElement.getAttribute(\"data-highlightclass\"),\n            position: currentElement.getAttribute(\"data-position\") || _this._options.tooltipPosition,\n            scrollTo: currentElement.getAttribute(\"data-scrollto\") || _this._options.scrollTo,\n            disableInteraction: disableInteraction\n          };\n        }\n      }); //next add intro items without data-step\n      //todo: we need a cleanup here, two loops are redundant\n\n      var _nextStep = 0;\n      forEach(allIntroSteps, function (currentElement) {\n        // PR #80\n        // start intro for groups of elements\n        if (group && currentElement.getAttribute(\"data-intro-group\") !== group) {\n          return;\n        }\n\n        if (currentElement.getAttribute(\"data-step\") === null) {\n          while (true) {\n            if (typeof introItems[_nextStep] === \"undefined\") {\n              break;\n            } else {\n              _nextStep++;\n            }\n          }\n\n          if (typeof currentElement.getAttribute(\"data-disable-interaction\") !== \"undefined\") {\n            disableInteraction = !!currentElement.getAttribute(\"data-disable-interaction\");\n          } else {\n            disableInteraction = _this._options.disableInteraction;\n          }\n\n          introItems[_nextStep] = {\n            element: currentElement,\n            intro: currentElement.getAttribute(\"data-intro\"),\n            step: _nextStep + 1,\n            tooltipClass: currentElement.getAttribute(\"data-tooltipclass\"),\n            highlightClass: currentElement.getAttribute(\"data-highlightclass\"),\n            position: currentElement.getAttribute(\"data-position\") || _this._options.tooltipPosition,\n            scrollTo: currentElement.getAttribute(\"data-scrollto\") || _this._options.scrollTo,\n            disableInteraction: disableInteraction\n          };\n        }\n      });\n    } //removing undefined/null elements\n\n\n    var tempIntroItems = [];\n\n    for (var z = 0; z < introItems.length; z++) {\n      if (introItems[z]) {\n        // copy non-falsy values to the end of the array\n        tempIntroItems.push(introItems[z]);\n      }\n    }\n\n    introItems = tempIntroItems; //Ok, sort all items with given steps\n\n    introItems.sort(function (a, b) {\n      return a.step - b.step;\n    }); //set it to the introJs object\n\n    this._introItems = introItems; //add overlay layer to the page\n\n    if (addOverlayLayer.call(this, targetElm)) {\n      //then, start the show\n      nextStep.call(this);\n\n      if (this._options.keyboardNavigation) {\n        DOMEvent.on(window, \"keydown\", onKeyDown, this, true);\n      } //for window resize\n\n\n      DOMEvent.on(window, \"resize\", onResize, this, true);\n    }\n\n    return false;\n  }\n\n  var version = \"3.0.1\";\n\n  /**\n   * IntroJs main class\n   *\n   * @class IntroJs\n   */\n\n  function IntroJs(obj) {\n    this._targetElement = obj;\n    this._introItems = [];\n    this._options = {\n      /* Label Display to be Shown in the highlighted div */\n      labelDisplay: \"\",\n\n      /* Next button label in tooltip box */\n      nextLabel: \"Next &rarr;\",\n\n      /* Previous button label in tooltip box */\n      prevLabel: \"&larr; Back\",\n\n      /* Skip button label in tooltip box */\n      skipLabel: \"Skip\",\n\n      /* Done button label in tooltip box */\n      doneLabel: \"Done\",\n\n      /* Hide previous button in the first step? Otherwise, it will be disabled button. */\n      hidePrev: false,\n\n      /* Hide next button in the last step? Otherwise, it will be disabled button. */\n      hideNext: false,\n\n      /* Default tooltip box position */\n      tooltipPosition: \"bottom\",\n\n      /* Next CSS class for tooltip boxes */\n      tooltipClass: \"\",\n\n      /* CSS class that is added to the helperLayer */\n      highlightClass: \"\",\n\n      /* Close introduction when pressing Escape button? */\n      exitOnEsc: true,\n\n      /* Close introduction when clicking on overlay layer? */\n      exitOnOverlayClick: true,\n\n      /* Show step numbers in introduction? */\n      showStepNumbers: true,\n\n      /* Let user use keyboard to navigate the tour? */\n      keyboardNavigation: true,\n\n      /* Show tour control buttons? */\n      showButtons: true,\n\n      /* Show tour bullets? */\n      showBullets: true,\n\n      /* Show tour progress? */\n      showProgress: false,\n\n      /* Scroll to highlighted element? */\n      scrollToElement: true,\n\n      /*\n       * Should we scroll the tooltip or target element?\n       *\n       * Options are: 'element' or 'tooltip'\n       */\n      scrollTo: \"element\",\n\n      /* Padding to add after scrolling when element is not in the viewport (in pixels) */\n      scrollPadding: 30,\n\n      /* Set the overlay opacity */\n      overlayOpacity: 0.8,\n\n      /* Precedence of positions, when auto is enabled */\n      positionPrecedence: [\"bottom\", \"top\", \"right\", \"left\"],\n\n      /* Disable an interaction with element? */\n      disableInteraction: false,\n\n      /* Set how much padding to be used around helper element */\n      helperElementPadding: 10,\n\n      /* Default hint position */\n      hintPosition: \"top-middle\",\n\n      /* Hint button label */\n      hintButtonLabel: \"Got it\",\n\n      /* Adding animation to hints? */\n      hintAnimation: true,\n\n      /* additional classes to put on the buttons */\n      buttonClass: \"introjs-button\"\n    };\n  }\n\n  var introJs = function introJs(targetElm) {\n    var instance;\n\n    if (_typeof(targetElm) === \"object\") {\n      //Ok, create a new instance\n      instance = new IntroJs(targetElm);\n    } else if (typeof targetElm === \"string\") {\n      //select the target element with query selector\n      var targetElement = document.querySelector(targetElm);\n\n      if (targetElement) {\n        instance = new IntroJs(targetElement);\n      } else {\n        throw new Error(\"There is no element with given selector.\");\n      }\n    } else {\n      instance = new IntroJs(document.body);\n    } // add instance to list of _instances\n    // passing group to stamp to increment\n    // from 0 onward somewhat reliably\n\n\n    introJs.instances[stamp(instance, \"introjs-instance\")] = instance;\n    return instance;\n  };\n  /**\n   * Current IntroJs version\n   *\n   * @property version\n   * @type String\n   */\n\n\n  introJs.version = version;\n  /**\n   * key-val object helper for introJs instances\n   *\n   * @property instances\n   * @type Object\n   */\n\n  introJs.instances = {}; //Prototype\n\n  introJs.fn = IntroJs.prototype = {\n    clone: function clone() {\n      return new IntroJs(this);\n    },\n    setOption: function setOption(option, value) {\n      this._options[option] = value;\n      return this;\n    },\n    setOptions: function setOptions(options) {\n      this._options = mergeOptions(this._options, options);\n      return this;\n    },\n    start: function start(group) {\n      introForElement.call(this, this._targetElement, group);\n      return this;\n    },\n    goToStep: function goToStep$1(step) {\n      goToStep.call(this, step);\n\n      return this;\n    },\n    addStep: function addStep(options) {\n      if (!this._options.steps) {\n        this._options.steps = [];\n      }\n\n      this._options.steps.push(options);\n\n      return this;\n    },\n    addSteps: function addSteps(steps) {\n      if (!steps.length) return;\n\n      for (var index = 0; index < steps.length; index++) {\n        this.addStep(steps[index]);\n      }\n\n      return this;\n    },\n    goToStepNumber: function goToStepNumber$1(step) {\n      goToStepNumber.call(this, step);\n\n      return this;\n    },\n    nextStep: function nextStep$1() {\n      nextStep.call(this);\n\n      return this;\n    },\n    previousStep: function previousStep$1() {\n      previousStep.call(this);\n\n      return this;\n    },\n    currentStep: function currentStep$1() {\n      return currentStep.call(this);\n    },\n    exit: function exit(force) {\n      exitIntro.call(this, this._targetElement, force);\n      return this;\n    },\n    refresh: function refresh$1() {\n      refresh.call(this);\n\n      return this;\n    },\n    onbeforechange: function onbeforechange(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introBeforeChangeCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onbeforechange was not a function\");\n      }\n\n      return this;\n    },\n    onchange: function onchange(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introChangeCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onchange was not a function.\");\n      }\n\n      return this;\n    },\n    onafterchange: function onafterchange(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introAfterChangeCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onafterchange was not a function\");\n      }\n\n      return this;\n    },\n    oncomplete: function oncomplete(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introCompleteCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for oncomplete was not a function.\");\n      }\n\n      return this;\n    },\n    onhintsadded: function onhintsadded(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._hintsAddedCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onhintsadded was not a function.\");\n      }\n\n      return this;\n    },\n    onhintclick: function onhintclick(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._hintClickCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onhintclick was not a function.\");\n      }\n\n      return this;\n    },\n    onhintclose: function onhintclose(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._hintCloseCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onhintclose was not a function.\");\n      }\n\n      return this;\n    },\n    onexit: function onexit(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introExitCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onexit was not a function.\");\n      }\n\n      return this;\n    },\n    onskip: function onskip(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introSkipCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onskip was not a function.\");\n      }\n\n      return this;\n    },\n    onbeforeexit: function onbeforeexit(providedCallback) {\n      if (typeof providedCallback === \"function\") {\n        this._introBeforeExitCallback = providedCallback;\n      } else {\n        throw new Error(\"Provided callback for onbeforeexit was not a function.\");\n      }\n\n      return this;\n    },\n    addHints: function addHints() {\n      populateHints.call(this, this._targetElement);\n      return this;\n    },\n    hideHint: function hideHint$1(stepId) {\n      hideHint.call(this, stepId);\n\n      return this;\n    },\n    hideHints: function hideHints$1() {\n      hideHints.call(this);\n\n      return this;\n    },\n    showHint: function showHint$1(stepId) {\n      showHint.call(this, stepId);\n\n      return this;\n    },\n    showHints: function showHints$1() {\n      showHints.call(this);\n\n      return this;\n    },\n    removeHints: function removeHints$1() {\n      removeHints.call(this);\n\n      return this;\n    },\n    removeHint: function removeHint$1(stepId) {\n      removeHint().call(this, stepId);\n\n      return this;\n    },\n    showHintDialog: function showHintDialog$1(stepId) {\n      showHintDialog.call(this, stepId);\n\n      return this;\n    }\n  };\n\n  return introJs;\n\n})));\n"]}]}