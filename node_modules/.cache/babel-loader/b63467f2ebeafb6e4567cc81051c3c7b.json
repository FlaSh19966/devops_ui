{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/ProductManagement/BannerTemplate.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/ProductManagement/BannerTemplate.vue","mtime":1645594423491},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvaG9tZS92aW1hbGVzaC9DRU5TRS9jaGF0Ym90LXBvcnRhbC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwoKdmFyIF9uYW1lJG5hbWUkY29tcG9uZW50czsKCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IFZ1ZUVkaXRvciB9IGZyb20gInZ1ZTItZWRpdG9yIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IHN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgU3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7CmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IERhdGVQaWNrZXIgZnJvbSAidnVlMi1kYXRlcGlja2VyIjsKaW1wb3J0ICJ2dWUyLWRhdGVwaWNrZXIvaW5kZXguY3NzIjsKaW1wb3J0IGRyYWdnYWJsZSBmcm9tICJ2dWVkcmFnZ2FibGUiOwppbXBvcnQgUmVzcG9uc2VCb3QgZnJvbSAiLi4vRGF0YSBJbnB1dHMvUmVzcG9uc2VCb3QiOyAvLyBpbXBvcnQgeyBJbWFnZURyb3AgfSBmcm9tICJxdWlsbC1pbWFnZS1kcm9wLW1vZHVsZSI7Ci8vIGltcG9ydCBJbWFnZVJlc2l6ZSBmcm9tICJxdWlsbC1pbWFnZS1yZXNpemUtbW9kdWxlIjsKCmV4cG9ydCBkZWZhdWx0IChfbmFtZSRuYW1lJGNvbXBvbmVudHMgPSB7CiAgbmFtZTogIkJhbm5lclRlbXBsYXRlUGFnZSIKfSwgX2RlZmluZVByb3BlcnR5KF9uYW1lJG5hbWUkY29tcG9uZW50cywgIm5hbWUiLCAiVmFsdWVUeXBlIiksIF9kZWZpbmVQcm9wZXJ0eShfbmFtZSRuYW1lJGNvbXBvbmVudHMsICJjb21wb25lbnRzIiwgewogIFZ1ZUVkaXRvcjogVnVlRWRpdG9yLAogIERhdGVQaWNrZXI6IERhdGVQaWNrZXIsCiAgZHJhZ2dhYmxlOiBkcmFnZ2FibGUsCiAgUmVzcG9uc2VCb3Q6IFJlc3BvbnNlQm90Cn0pLCBfZGVmaW5lUHJvcGVydHkoX25hbWUkbmFtZSRjb21wb25lbnRzLCAiZGF0YSIsIGZ1bmN0aW9uIGRhdGEoKSB7CiAgcmV0dXJuIHsKICAgIC8vIGN1c3RvbU1vZHVsZXNGb3JFZGl0b3I6IFsKICAgIC8vICAgeyBhbGlhczogImltYWdlRHJvcCIsIG1vZHVsZTogSW1hZ2VEcm9wIH0sCiAgICAvLyAgIHsgYWxpYXM6ICJpbWFnZVJlc2l6ZSIsIG1vZHVsZTogSW1hZ2VSZXNpemUgfSwKICAgIC8vIF0sCiAgICAvLyBlZGl0b3JTZXR0aW5nczogewogICAgLy8gICBtb2R1bGVzOiB7CiAgICAvLyAgICAgaW1hZ2VEcm9wOiB0cnVlLAogICAgLy8gICAgIGltYWdlUmVzaXplOiB7fSwKICAgIC8vICAgfSwKICAgIC8vIH0sCiAgICBwYWdlX25vOiAxLAogICAgZHJhZ19iYW5uZXJfY29udGVudDogZmFsc2UsCiAgICBwZXJfcGFnZTogMTUsCiAgICB0b3RhbF9wYWdlczogbnVsbCwKICAgIG51bWJlcl9vZl9yb3dzOiBudWxsLAogICAgcGFnZV9hcnJheTogW10sCiAgICBiYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0OiBbLy8gewogICAgICAvLyAgIGRhdGVfdGltZV9saXN0OiBbCiAgICAgIC8vICAgICB7CiAgICAgIC8vICAgICAgIGRhdGU6IFtdLAogICAgICAvLyAgICAgfSwKICAgICAgLy8gICBdLAogICAgICAvLyAgIGxvY2F0aW9uX2xpc3Q6IFsKICAgICAgLy8gICAgIHsKICAgICAgLy8gICAgICAgbG9jYXRpb246IFtdLAogICAgICAvLyAgICAgfSwKICAgICAgLy8gICBdLAogICAgICAvLyB9LAogICAgXSwKICAgIHNob3dUaW1lUmFuZ2VQYW5lbDogZmFsc2UsCiAgICBwZW5jaWxfc3ZnOiAnIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUuNTQ2IiBoZWlnaHQ9IjE1LjQ2MSIgdmlld0JveD0iMCAwIDE1LjU0NiAxNS40NjEiPjxkZWZzPjxzdHlsZT4uYXtmaWxsOiM5ZTllOWU7fTwvc3R5bGU+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03NDcuODg4IC0zNTYuNzY5KSI+PHBhdGggY2xhc3M9ImEiIGQ9Ik03NTkuNDE2LDM1Ni43NjlhMi4zNTgsMi4zNTgsMCwwLDEsMS43NzcuNjYyYy41MzQuNTEzLDEuMDcyLDEuMDI1LDEuNTY3LDEuNTc1YTIuMywyLjMsMCwwLDEtLjA3MSwzLjMyNWMtMi43MzYsMi43Ni01LjQ5NCw1LjUtOC4yMzgsOC4yNTFhMS4zODEsMS4zODEsMCwwLDEtLjc1OC4yODhjLS43MTkuMTc0LTEuNDI5LjM3OS0yLjE0NC41NzItLjkzMi4yNTEtMS44NjIuNS0yLjc5NS43NTEtLjYuMTU4LS45ODktLjIxMy0uODMyLS44MDdxLjY4OS0yLjU5NSwxLjQwNi01LjE4MmExLjE2NCwxLjE2NCwwLDAsMSwuMjg5LS40ODdxNC4wOTEtNC4xMDcsOC4yLTguMkEyLjI2NSwyLjI2NSwwLDAsMSw3NTkuNDE2LDM1Ni43NjlabS0xLjk4OSwyLjk1Ni02LjU0LDYuNTM4LDMuMDI1LDMuMDI0LDYuNTM4LTYuNTM3Wm00LjAyMywyLjE2NWMuMTE4LS4xMzUuMjI1LS4yNjkuMzQzLS4zOTJhMS4xMzQsMS4xMzQsMCwwLDAsMC0xLjczNGMtLjQ2LS40NjYtLjkyNi0uOTI1LTEuMzg4LTEuMzlhMS4xNjYsMS4xNjYsMCwwLDAtLjg2MS0uMzY4Yy0uNTc4LDAtLjg4MS40LTEuMjE0Ljc2Wm0tMTIuMDg0LDguODYzLDMuMi0uODYzLTIuMzM3LTIuMzMxWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCkiLz48cGF0aCBjbGFzcz0iYSIgZD0iTTgxMy45NDIsNDIyLjZsLS43ODktLjgsMy44MjEtMy44MTkuNzg0LjhaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTkuNjQ4IC01NS45NDcpIi8+PC9nPjwvc3ZnPicsCiAgICBzcGlubmVyT246IGZhbHNlLAogICAgYmFubmVyX25hbWU6ICIiLAogICAgYmFubmVyX2Rlc2NyaXB0aW9uOiAiIiwKICAgIGJhbm5lcl9jb250ZW50X3Bvc2l0aW9uOiBbewogICAgICAibmFtZSI6ICdEZXNjcmlwdGlvbicsCiAgICAgICJpZCI6ICdiYW5uZXJfZGVzY3JpcHRpb24nCiAgICB9LCB7CiAgICAgICJuYW1lIjogJ0ltYWdlJywKICAgICAgImlkIjogJ2Jhbm5lcl9pbWdfdXJsJwogICAgfSwgewogICAgICAibmFtZSI6ICdWaWRlbycsCiAgICAgICJpZCI6ICdiYW5uZXJfdmlkZW9fdXJsJwogICAgfV0sCiAgICBpc19kaXNwbGF5X2Jhbm5lcjogZmFsc2UsCiAgICBiYW5uZXJfbmFtZV9hbHJlYWR5X2V4aXN0OiBmYWxzZSwKICAgIGlzVmlzaWJsZVNlYXJjaENsZWFyOiBmYWxzZSwKICAgIGltYWdlX2ZpbGU6IG51bGwsCiAgICBpbWFnZV9maWxlXzI6IG51bGwsCiAgICBiYW5uZXJfaW1nX2xpbms6ICIiLAogICAgYmFubmVyX3ZpZGVvX3VybDogIiIsCiAgICBpc0VkaXRCYW5uZXI6IGZhbHNlLAogICAgZWRpdF9iYW5uZXJfbmFtZV9hbHJlYWR5X2V4aXN0OiBmYWxzZSwKICAgIGZpbGVfbGFiZWw6ICJDaG9vc2UgZmlsZSIsCiAgICBlZGl0ZWRfZmlsZV9sYWJlbDogIkNob29zZSBmaWxlIiwKICAgIHJlZ191cmw6IC9odHRwczpcL1wvWyh3d3dcLik/YS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIoWy1hLXpBLVowLTlAOiVfXCsufiM/JlwvXC89XSopL2ksCiAgICBjdXN0b21Ub29sYmFyOiBbWyJib2xkIiwgIml0YWxpYyIsICJ1bmRlcmxpbmUiXSwgW3sKICAgICAgYWxpZ246IFtdCiAgICB9XSwgW3sKICAgICAgY29sb3I6IFtdCiAgICB9LCB7CiAgICAgIGJhY2tncm91bmQ6IFtdCiAgICB9XSwgW3sKICAgICAgbGlzdDogIm9yZGVyZWQiCiAgICB9LCB7CiAgICAgIGxpc3Q6ICJidWxsZXQiCiAgICB9XSwgWyJsaW5rIl0gLy8gWyJpbWFnZSIsICJjb2RlLWJsb2NrIl0sCiAgICAvLyBbInZpZGVvIl0sCiAgICBdLAogICAgY3VycmVudF9iYW5uZXI6IFtdLAogICAgYmFubmVyX29sZF9pbWdfbmFtZTogIiIsCiAgICBjdXJyZW50X2Jhbm5lcl9vbGRfbmFtZTogIiIsCiAgICBzZWFyY2hfbmFtZTogIiIsCiAgICBjaGVja2VkX2xpc3Q6IFtdLAogICAgY3VycmVudF9iYW5uZXJfaW5kZXg6IDAsCiAgICBjdXJyZW50X3NlbGVjdGVkX2Jhbm5lcl9oaWdobGlnaHQ6ICIiLAogICAgYmFubmVyX3RlbXBsYXRlX2xpc3Q6IFtdLAogICAgbG9hZF9ib3RfcHJldmlldzogZmFsc2UKICB9Owp9KSwgX2RlZmluZVByb3BlcnR5KF9uYW1lJG5hbWUkY29tcG9uZW50cywgIndhdGNoIiwgewogIHNlYXJjaF9uYW1lOiBmdW5jdGlvbiBzZWFyY2hfbmFtZSgpIHsKICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09PSAiIikgewogICAgICB0aGlzLmxvYWRfYmFubmVycygpOwogICAgICB0aGlzLmlzVmlzaWJsZVNlYXJjaENsZWFyID0gZmFsc2U7CiAgICB9IGVsc2UgaWYgKHRoaXMuc2VhcmNoX25hbWUgIT09ICIiKSB7CiAgICAgIHRoaXMuaXNWaXNpYmxlU2VhcmNoQ2xlYXIgPSB0cnVlOwogICAgfQogIH0KfSksIF9kZWZpbmVQcm9wZXJ0eShfbmFtZSRuYW1lJGNvbXBvbmVudHMsICJjcmVhdGVkIiwgZnVuY3Rpb24gY3JlYXRlZCgpIHsKICBpZiAodGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUgPT0gIlN1cGVyQWRtaW4iKSB7CiAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpKSB7CiAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlJZCIpOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgdG9hc3RyLndhcm5pbmcoIlBsZWFzZSBzZWxlY3QgYSBjb21wYW55IG5hbWUgZnJvbSB0aGUgZHJvcGRvd24iKTsKICAgIH0KICB9IGVsc2UgewogICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgIHRoaXMuY29tcGFueW5hbWUgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lOwogIH0KCiAgdGhpcy5sb2FkX2Jhbm5lcnMoKTsKfSksIF9kZWZpbmVQcm9wZXJ0eShfbmFtZSRuYW1lJGNvbXBvbmVudHMsICJtb3VudGVkIiwgZnVuY3Rpb24gbW91bnRlZCgpIHsKICB2YXIgX3RoaXMgPSB0aGlzOwoKICAvLyAkKCcucGFjLWNvbnRhaW5lcicpLnJlbW92ZSgpOwogIC8vICAgICBjb25zdCBhdXRvY29tcGxldGUgPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLkF1dG9jb21wbGV0ZSgKICAvLyAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXV0b2NvbXBsZXRlX2FkZCIpCiAgLy8gICAgICk7CiAgJCgnYVtkYXRhLXRhcmdldD0iI2Jhbm5lcm1vZGVsIl0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICBpZiAodm0uaXNFZGl0QmFubmVyID09IHRydWUpIHsKICAgICAgdm0udmVyaWZ5X2NoYW5nZXMoKTsKICAgIH0gZWxzZSB7CiAgICAgIHZtLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICQoIiNiYW5uZXJtb2RlbCIpLm1vZGFsKCdzaG93Jyk7CiAgICB9CiAgfSk7CiAgJCgiI3ByZXZpZXdfYm90X3Zpc2libGUiKS5vbigic2hvdy5icy5tb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgIF90aGlzLmxvYWRfYm90X3ByZXZpZXcgPSB0cnVlOwogIH0pOwogICQoIiNwcmV2aWV3X2JvdF92aXNpYmxlIikub24oImhpZGUuYnMubW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICBfdGhpcy5sb2FkX2JvdF9wcmV2aWV3ID0gZmFsc2U7CiAgfSk7CiAgdmFyIHZtID0gdGhpczsKICAkKCIjc2VsZWN0YWxsIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgaWYgKCQodGhpcykuaXMoIjpjaGVja2VkIikpIHsKICAgICAgLy8gJCgnZGl2OmlucHV0JykucHJvcCgnY2hlY2tlZCcsdHJ1ZSk7CiAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIHRydWUpOwogICAgfSBlbHNlIHsKICAgICAgdm0uY2hlY2tlZF9saXN0ID0gW107CiAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgIH0KICB9KTsKfSksIF9kZWZpbmVQcm9wZXJ0eShfbmFtZSRuYW1lJGNvbXBvbmVudHMsICJjb21wdXRlZCIsIHsKICBkcmFnT3B0aW9uc0Jhbm5lcjogZnVuY3Rpb24gZHJhZ09wdGlvbnNCYW5uZXIoKSB7CiAgICByZXR1cm4gewogICAgICBhbmltYXRpb246IDIwMCwKICAgICAgZ3JvdXA6ICJkZXNjcmlwdGlvbiIsCiAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgZ2hvc3RDbGFzczogImdob3N0IiwKICAgICAgc2Nyb2xsU2Vuc2l0aXZpdHk6IDIwMCwKICAgICAgZm9yY2VGYWxsYmFjazogdHJ1ZQogICAgfTsKICB9LAogIHZhbGlkVVJMOiBmdW5jdGlvbiB2YWxpZFVSTCgpIHsKICAgIGlmICh0aGlzLnJlZ191cmwudGVzdCh0aGlzLmJhbm5lcl9pbWdfbGluaykpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKICB2YWxpZFZpZGVvVVJMOiBmdW5jdGlvbiB2YWxpZFZpZGVvVVJMKCkgewogICAgaWYgKHRoaXMucmVnX3VybC50ZXN0KHRoaXMuYmFubmVyX3ZpZGVvX3VybCkpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKICB2YWxpZFVSTF9lZGl0OiBmdW5jdGlvbiB2YWxpZFVSTF9lZGl0KCkgewogICAgaWYgKHRoaXMucmVnX3VybC50ZXN0KHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2ltZ19saW5rKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LAogIHZhbGlkVmlkZW9VUkxfZWRpdDogZnVuY3Rpb24gdmFsaWRWaWRlb1VSTF9lZGl0KCkgewogICAgaWYgKHRoaXMucmVnX3VybC50ZXN0KHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX3ZpZGVvX3VybCkpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQp9KSwgX2RlZmluZVByb3BlcnR5KF9uYW1lJG5hbWUkY29tcG9uZW50cywgImJlZm9yZVJvdXRlTGVhdmUiLCBmdW5jdGlvbiBiZWZvcmVSb3V0ZUxlYXZlKHRvLCBmcm9tLCBuZXh0KSB7CiAgaWYgKHRoaXMuaXNFZGl0QmFubmVyKSB7CiAgICB0aGlzLnZlcmlmeV9jaGFuZ2VzKCk7CiAgfSBlbHNlIHsKICAgIG5leHQoKTsKICB9Cn0pLCBfZGVmaW5lUHJvcGVydHkoX25hbWUkbmFtZSRjb21wb25lbnRzLCAibWV0aG9kcyIsIHsKICBjbGVhcl9zZWFyY2hfbmFtZTogZnVuY3Rpb24gY2xlYXJfc2VhcmNoX25hbWUoKSB7CiAgICB0aGlzLnNlYXJjaF9uYW1lID0gIiI7CiAgfSwKICBjYWxsc2VhcmNoOiBmdW5jdGlvbiBjYWxsc2VhcmNoKCkgewogICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7CiAgICAgIGlmICh0aGlzLmlzRWRpdEJhbm5lcikgewogICAgICAgIHRoaXMudmVyaWZ5X2NoYW5nZXMoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNlYXJjaF9iYW5uZXIoKTsKICAgICAgfQogICAgfQogIH0sCiAgc2VhcmNoX2Jhbm5lcjogZnVuY3Rpb24gc2VhcmNoX2Jhbm5lcigpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lICE9ICIiKSB7CiAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5iYW5uZXJfdGVtcGxhdGUoKSwgewogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgIGlzX3NlYXJjaDogdHJ1ZSwKICAgICAgICBzZWFyY2hfdGVybTogdGhpcy5zZWFyY2hfbmFtZSwKICAgICAgICBwYWdlX25vOiAxLAogICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczIuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICBfdGhpczIubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLkNvdW50OwogICAgICAgICAgX3RoaXMyLnRvdGFsX3BhZ2VzID0gTWF0aC5jZWlsKF90aGlzMi5udW1iZXJfb2Zfcm93cyAvIF90aGlzMi5wZXJfcGFnZSk7IC8vIHRoaXMuYmFubmVyX3RlbXBsYXRlX2xpc3QgPSByZXNwb25zZS5kYXRhLkJhbm5lckRhdGE7CgogICAgICAgICAgdmFyIGRpY3QgPSByZXNwb25zZS5kYXRhLkJhbm5lckRhdGE7CiAgICAgICAgICBfdGhpczIuYmFubmVyX3RlbXBsYXRlX2xpc3QgPSBbXTsKCiAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGljdCkgewogICAgICAgICAgICBpZiAoZGljdC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgICAgICAgX3RoaXMyLmJhbm5lcl90ZW1wbGF0ZV9saXN0LnB1c2goZGljdFtrZXldKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChfdGhpczIuYmFubmVyX3RlbXBsYXRlX2xpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgICBfdGhpczIuc2hvd19iYW5uZXIoMCk7CiAgICAgICAgICB9CgogICAgICAgICAgX3RoaXMyLnNldHBhZ2luYXRpb24oX3RoaXMyLnBhZ2Vfbm8pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczIuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXMyLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBieWZvY3VzX291dF9nb29nbGVfYXV0b2NvbXBsZXRlX3RvX2FkZF9sb2NhdGlvbjogZnVuY3Rpb24gYnlmb2N1c19vdXRfZ29vZ2xlX2F1dG9jb21wbGV0ZV90b19hZGRfbG9jYXRpb24oKSB7CiAgICAkKCcucGFjLWNvbnRhaW5lcicpLnJlbW92ZSgpOwogIH0sCiAgYnlmb2N1c19pbl9nb29nbGVfYXV0b2NvbXBsZXRlX3RvX2FkZF9sb2NhdGlvbjogZnVuY3Rpb24gYnlmb2N1c19pbl9nb29nbGVfYXV0b2NvbXBsZXRlX3RvX2FkZF9sb2NhdGlvbihpbmRleF9pZCwgaW5kZXgsIGluZGV4MSkgewogICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGluZGV4X2lkKTsKICAgICAgdmFyIGF1dG9jb21wbGV0ZSA9IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuQXV0b2NvbXBsZXRlKGlucHV0LCB7CiAgICAgICAgZmllbGRzOiBbJ2Zvcm1hdHRlZF9hZGRyZXNzJywgJ2dlb21ldHJ5J10KICAgICAgfSk7CiAgICAgIGF1dG9jb21wbGV0ZS5hZGRMaXN0ZW5lcigicGxhY2VfY2hhbmdlZCIsIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcGxhY2UgPSBhdXRvY29tcGxldGUuZ2V0UGxhY2UoKTsKICAgICAgICAkKCcucGFjLWNvbnRhaW5lcicpLnJlbW92ZSgpOwogICAgICAgIF90aGlzMy5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0W2luZGV4XVsibG9jYXRpb25fbGlzdCJdW2luZGV4MV0ubG9jYXRpb24gPSBwbGFjZS5mb3JtYXR0ZWRfYWRkcmVzczsKICAgICAgICBfdGhpczMuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdFtpbmRleF1bImxvY2F0aW9uX2xpc3QiXVtpbmRleDFdLmdlb21ldHJ5ID0gcGxhY2UuZ2VvbWV0cnk7CiAgICAgIH0pOwogICAgfSwgMTAwKTsKICB9LAogIGJ5Zm9jdXNfb3V0X2dvb2dsZV9hdXRvY29tcGxldGVfdG9fZWRpdF9sb2NhdGlvbjogZnVuY3Rpb24gYnlmb2N1c19vdXRfZ29vZ2xlX2F1dG9jb21wbGV0ZV90b19lZGl0X2xvY2F0aW9uKCkgewogICAgJCgnLnBhYy1jb250YWluZXInKS5yZW1vdmUoKTsKICB9LAogIGJ5Zm9jdXNfaW5fZ29vZ2xlX2F1dG9jb21wbGV0ZV90b19lZGl0X2xvY2F0aW9uOiBmdW5jdGlvbiBieWZvY3VzX2luX2dvb2dsZV9hdXRvY29tcGxldGVfdG9fZWRpdF9sb2NhdGlvbihpbmRleF9pZCwgaW5kZXgsIGluZGV4MSkgewogICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGluZGV4X2lkKTsKICAgICAgdmFyIGF1dG9jb21wbGV0ZSA9IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuQXV0b2NvbXBsZXRlKGlucHV0LCB7CiAgICAgICAgZmllbGRzOiBbJ2Zvcm1hdHRlZF9hZGRyZXNzJywgJ2dlb21ldHJ5J10KICAgICAgfSk7CiAgICAgIGF1dG9jb21wbGV0ZS5hZGRMaXN0ZW5lcigicGxhY2VfY2hhbmdlZCIsIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcGxhY2UgPSBhdXRvY29tcGxldGUuZ2V0UGxhY2UoKTsKICAgICAgICAkKCcucGFjLWNvbnRhaW5lcicpLnJlbW92ZSgpOwogICAgICAgIF90aGlzNC5jdXJyZW50X2Jhbm5lci5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0W2luZGV4XVsibG9jYXRpb25fbGlzdCJdW2luZGV4MV0ubG9jYXRpb24gPSBwbGFjZS5mb3JtYXR0ZWRfYWRkcmVzczsKICAgICAgICBfdGhpczQuY3VycmVudF9iYW5uZXIuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdFtpbmRleF1bImxvY2F0aW9uX2xpc3QiXVtpbmRleDFdLmdlb21ldHJ5ID0gcGxhY2UuZ2VvbWV0cnk7CiAgICAgIH0pOwogICAgfSwgMTAwKTsKICB9LAogIHZlcmlmeV9jaGFuZ2VzOiBmdW5jdGlvbiB2ZXJpZnlfY2hhbmdlcygpIHsKICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgIFN3YWwoewogICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICB0ZXh0OiAiSWYgeW91IGhhdmUgbWFkZSBhbnkgY2hhbmdlcyB0byB0aGUgc2VsZWN0ZWQgQmFubmVyIHBsZWFzZSBzYXZlIHRoZW0gZmlyc3QsIGVsc2UgdGhleSB3aWxsIGRpc2NhcmRlZCEiLAogICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICBjb25maXJtQnV0dG9uVGV4dDogIlNhdmUiLAogICAgICBjYW5jZWxCdXR0b25UZXh0OiAiQ2FuY2VsIgogICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICBfdGhpczUuZWRpdF9iYW5uZXIoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpczUuaXNFZGl0QmFubmVyID0gZmFsc2U7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgZWRpdF9iYW5uZXJfZGV0YWlsczogZnVuY3Rpb24gZWRpdF9iYW5uZXJfZGV0YWlscygpIHsKICAgIGlmICghdGhpcy5pc0VkaXRCYW5uZXIpIHsKICAgICAgdGhpcy5pc0VkaXRCYW5uZXIgPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5pc0VkaXRCYW5uZXIgPSBmYWxzZTsKICAgICAgdGhpcy5sb2FkX2Jhbm5lcnModGhpcy5jdXJyZW50X2Jhbm5lcl9pbmRleCk7CiAgICAgIHRoaXMuZWRpdF9iYW5uZXJfbmFtZV9hbHJlYWR5X2V4aXN0ID0gZmFsc2U7CiAgICB9CiAgfSwKICBjaGVja19lbmFibGU6IGZ1bmN0aW9uIGNoZWNrX2VuYWJsZShpbmRleCkgewogICAgaWYgKHRoaXMuYmFubmVyX3RlbXBsYXRlX2xpc3RbaW5kZXhdLmlzX2Rpc3BsYXlfYmFubmVyID09PSB0cnVlKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sCiAgc2hvd19iYW5uZXI6IGZ1bmN0aW9uIHNob3dfYmFubmVyKGluZGV4KSB7CiAgICB0aGlzLmlzRWRpdEJhbm5lciA9IGZhbHNlOwogICAgdGhpcy5jdXJyZW50X2Jhbm5lcl9pbmRleCA9IGluZGV4OwogICAgdGhpcy5jdXJyZW50X2Jhbm5lciA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5iYW5uZXJfdGVtcGxhdGVfbGlzdFtpbmRleF0pKTsKCiAgICBpZiAodGhpcy5jdXJyZW50X2Jhbm5lci5pc19kaXNwbGF5X2Jhbm5lciA9PT0gdHJ1ZSkgewogICAgICAkKCIjY3VycmVudF9zZWxlY3RlZF9pc19kaXNwbGF5X2Jhbm5lcl9pZCIpLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgIH0gZWxzZSB7CiAgICAgICQoIiNjdXJyZW50X3NlbGVjdGVkX2lzX2Rpc3BsYXlfYmFubmVyX2lkIikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgIH0KCiAgICB0aGlzLmVkaXRlZF9maWxlX2xhYmVsID0gdGhpcy5jdXJyZW50X2Jhbm5lci5iYW5uZXJfaW1nX25hbWU7CiAgICB0aGlzLmltYWdlX2ZpbGVfMiA9IHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2ltZ19uYW1lOwoKICAgIGlmICh0aGlzLmVkaXRlZF9maWxlX2xhYmVsID09ICIiIHx8IHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwgPT0gbnVsbCkgewogICAgICB0aGlzLmVkaXRlZF9maWxlX2xhYmVsID0gIkNob29zZSBmaWxlIjsKICAgIH0KCiAgICB0aGlzLmJhbm5lcl9vbGRfaW1nX25hbWUgPSB0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9pbWdfbmFtZTsKICAgIHRoaXMuY3VycmVudF9iYW5uZXJfb2xkX25hbWUgPSB0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9uYW1lOwogICAgdGhpcy5jdXJyZW50X3NlbGVjdGVkX2Jhbm5lcl9oaWdobGlnaHQgPSB0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9pZDsKICB9LAogIGxvYWRfYmFubmVyczogZnVuY3Rpb24gbG9hZF9iYW5uZXJzKGN1cnJlbnRfYmFubmVyX2luZGV4KSB7CiAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgYXhpb3MucG9zdChhcGlfY2FsbHMuYmFubmVyX3RlbXBsYXRlKCksIHsKICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgaXNfZ2V0OiB0cnVlLAogICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlCiAgICB9LCB7CiAgICAgIGhlYWRlcnM6IHsKICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICBfdGhpczYuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwMCkgewogICAgICAgIF90aGlzNi5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEuQ291bnQ7CiAgICAgICAgX3RoaXM2LnRvdGFsX3BhZ2VzID0gTWF0aC5jZWlsKF90aGlzNi5udW1iZXJfb2Zfcm93cyAvIF90aGlzNi5wZXJfcGFnZSk7IC8vIHRoaXMuYmFubmVyX3RlbXBsYXRlX2xpc3QgPSByZXNwb25zZS5kYXRhLkJhbm5lckRhdGE7CgogICAgICAgIHZhciBkaWN0ID0gcmVzcG9uc2UuZGF0YS5CYW5uZXJEYXRhOwogICAgICAgIF90aGlzNi5iYW5uZXJfdGVtcGxhdGVfbGlzdCA9IFtdOwoKICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGljdCkgewogICAgICAgICAgaWYgKGRpY3QuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgICBfdGhpczYuYmFubmVyX3RlbXBsYXRlX2xpc3QucHVzaChkaWN0W2tleV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKF90aGlzNi5iYW5uZXJfdGVtcGxhdGVfbGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICBpZiAoQm9vbGVhbihjdXJyZW50X2Jhbm5lcl9pbmRleCkpIHsKICAgICAgICAgICAgX3RoaXM2LnNob3dfYmFubmVyKGN1cnJlbnRfYmFubmVyX2luZGV4KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzNi5zaG93X2Jhbm5lcigwKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIF90aGlzNi5zZXRwYWdpbmF0aW9uKF90aGlzNi5wYWdlX25vKTsKICAgICAgfQogICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgX3RoaXM2LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgX3RoaXM2LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICB9CiAgICB9KTsKICB9LAogIHBhZ2VfcmVxdWlyZTogZnVuY3Rpb24gcGFnZV9yZXF1aXJlKHBhZ2UpIHsKICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CgogICAgaWYgKHBhZ2UgPT0gMCB8fCBwYWdlID09IHRoaXMudG90YWxfcGFnZXMgKyAxKSB7fSBlbHNlIHsKICAgICAgaWYgKHRoaXMuc2VhcmNoX25hbWUgPT0gIiIpIHsKICAgICAgICBpZiAocGFnZSA9PSAiLi4ucyIpIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgoMSArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICB9IGVsc2UgaWYgKHBhZ2UgPT0gIi4uLmwiKSB7CiAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKHRoaXMudG90YWxfcGFnZXMgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IHBhZ2U7CiAgICAgICAgfQoKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmJhbm5lcl90ZW1wbGF0ZSgpLCB7CiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICBwZXJfcGFnZTogdGhpcy5wZXJfcGFnZQogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXM3LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgIF90aGlzNy5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEuQ291bnQ7CiAgICAgICAgICAgIF90aGlzNy50b3RhbF9wYWdlcyA9IE1hdGguY2VpbChfdGhpczcubnVtYmVyX29mX3Jvd3MgLyBfdGhpczcucGVyX3BhZ2UpOwogICAgICAgICAgICB2YXIgZGljdCA9IHJlc3BvbnNlLmRhdGEuQmFubmVyRGF0YTsKICAgICAgICAgICAgX3RoaXM3LmJhbm5lcl90ZW1wbGF0ZV9saXN0ID0gW107CgogICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGljdCkgewogICAgICAgICAgICAgIGlmIChkaWN0Lmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICAgIF90aGlzNy5iYW5uZXJfdGVtcGxhdGVfbGlzdC5wdXNoKGRpY3Rba2V5XSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoX3RoaXM3LmJhbm5lcl90ZW1wbGF0ZV9saXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBfdGhpczcuc2hvd19iYW5uZXIoMCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzNy5zZXRwYWdpbmF0aW9uKF90aGlzNy5wYWdlX25vKTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgX3RoaXM3LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICBfdGhpczcuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwoKICAgICAgICBpZiAodGhpcy5wYWdlbm8gPT0gIi4uLnMiKSB7CiAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKDEgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBhZ2VubyA9PSAiLi4ubCIpIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgodGhpcy50b3RhbF9wYWdlcyArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5wYWdlX25vID0gdGhpcy5wYWdlbm87CiAgICAgICAgfQoKICAgICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuYmFubmVyX3RlbXBsYXRlKCksIHsKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgICAgIGlzX3NlYXJjaDogdHJ1ZSwKICAgICAgICAgIHNlYXJjaF90ZXJtOiB0aGlzLnNlYXJjaF9uYW1lLAogICAgICAgICAgcGFnZV9ubzogdGhpcy5wYWdlX25vLAogICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzNy5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICBfdGhpczcubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLkNvdW50OwogICAgICAgICAgICBfdGhpczcudG90YWxfcGFnZXMgPSBNYXRoLmNlaWwoX3RoaXM3Lm51bWJlcl9vZl9yb3dzIC8gX3RoaXM3LnBlcl9wYWdlKTsgLy8gdGhpcy5iYW5uZXJfdGVtcGxhdGVfbGlzdCA9IHJlc3BvbnNlLmRhdGEuQmFubmVyRGF0YTsKCiAgICAgICAgICAgIHZhciBkaWN0ID0gcmVzcG9uc2UuZGF0YS5CYW5uZXJEYXRhOwogICAgICAgICAgICBfdGhpczcuYmFubmVyX3RlbXBsYXRlX2xpc3QgPSBbXTsKCiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkaWN0KSB7CiAgICAgICAgICAgICAgaWYgKGRpY3QuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgICAgICAgX3RoaXM3LmJhbm5lcl90ZW1wbGF0ZV9saXN0LnB1c2goZGljdFtrZXldKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChfdGhpczcuYmFubmVyX3RlbXBsYXRlX2xpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIF90aGlzNy5zaG93X2Jhbm5lcigwKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX3RoaXM3LnNldHBhZ2luYXRpb24oX3RoaXM3LnBhZ2Vfbm8pOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBfdGhpczcuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzNy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sCiAgc2V0cGFnaW5hdGlvbjogZnVuY3Rpb24gc2V0cGFnaW5hdGlvbihwYWdlX25vKSB7CiAgICB0aGlzLnBhZ2VfYXJyYXkgPSBbXTsKCiAgICBpZiAodGhpcy50b3RhbF9wYWdlcyA8PSA3KSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50b3RhbF9wYWdlczsgaSsrKSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goaSArIDEpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gMSkgewogICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgNDsgX2krKykgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKF9pICsgMSk7CiAgICAgIH0KCiAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgfSBlbHNlIGlmIChwYWdlX25vID09IHRoaXMudG90YWxfcGFnZXMpIHsKICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CgogICAgICBmb3IgKHZhciBfaTIgPSB0aGlzLnRvdGFsX3BhZ2VzIC0gNDsgX2kyIDwgdGhpcy50b3RhbF9wYWdlczsgX2kyKyspIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTIgKyAxKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChwYWdlX25vIDw9IDQpIHsKICAgICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgcGFnZV9ubyArIDM7IF9pMysrKSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2kzICsgMSk7CiAgICAgIH0KCiAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgfSBlbHNlIGlmIChwYWdlX25vID49IHRoaXMudG90YWxfcGFnZXMgLSA0KSB7CiAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwoKICAgICAgZm9yICh2YXIgX2k0ID0gcGFnZV9ubyAtIDQ7IF9pNCA8IHRoaXMudG90YWxfcGFnZXM7IF9pNCsrKSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2k0ICsgMSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwoKICAgICAgZm9yICh2YXIgX2k1ID0gcGFnZV9ubyAtIDM7IF9pNSA8PSBwYWdlX25vICsgMzsgX2k1KyspIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTUpOwogICAgICB9CgogICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgIH0KICB9LAogIHBhZ2luYXRpb25fY2xhc3M6IGZ1bmN0aW9uIHBhZ2luYXRpb25fY2xhc3MoaW5kZXgpIHsKICAgIGlmIChpbmRleCA9PSB0aGlzLnBhZ2Vfbm8pIHsKICAgICAgcmV0dXJuICIgYWN0aXZlIjsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiAiIjsKICAgIH0KICB9LAogIGNoZWNrX2N1cnJlbnRfYmFubmVyX2FjdGl2ZTogZnVuY3Rpb24gY2hlY2tfY3VycmVudF9iYW5uZXJfYWN0aXZlKGluZGV4KSB7CiAgICB2YXIgcmV0dXJuX3ZhciA9ICIiOwoKICAgIGlmICh0aGlzLmJhbm5lcl90ZW1wbGF0ZV9saXN0W2luZGV4XS5iYW5uZXJfaWQgPT0gdGhpcy5jdXJyZW50X3NlbGVjdGVkX2Jhbm5lcl9oaWdobGlnaHQpIHsKICAgICAgcmV0dXJuX3ZhciArPSAiY3VycmVudC1hY3RpdmUtYmFubmVyIjsKICAgIH0KCiAgICByZXR1cm4gcmV0dXJuX3ZhcjsKICB9LAogIHNlbGVjdGVkX2Jhbm5lcjogZnVuY3Rpb24gc2VsZWN0ZWRfYmFubmVyKGJhbm5lcl9pZCkgewogICAgaWYgKGJhbm5lcl9pZCA9PSAiYWxsIikgewogICAgICBpZiAoZXZlbnQudGFyZ2V0LmNoZWNrZWQpIHsKICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRoaXMuYmFubmVyX3RlbXBsYXRlX2xpc3QubWFwKGZ1bmN0aW9uIChiYW5uZXIpIHsKICAgICAgICAgIHJldHVybiBiYW5uZXIuYmFubmVyX2lkOwogICAgICAgIH0pOwogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNoZWNrZWRfbGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgJCgiIyIgKyBbaV0pLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgICAgICQoIiNzZWxlY3RhbGwiKS5wcm9wKCJjaGVja2VkIiwgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKCFldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoZXZlbnQudGFyZ2V0LmNoZWNrZWQgPT0gdHJ1ZSkgewogICAgICAgIHZhciB2YWxfaW5kZXggPSB0aGlzLmNoZWNrZWRfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKHRlbXApIHsKICAgICAgICAgIHJldHVybiB0ZW1wLmJhbm5lcl9pZCA9PSBiYW5uZXJfaWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmICh2YWxfaW5kZXgubGVuZ3RoID09IDApIHsKICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0LnB1c2goYmFubmVyX2lkKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0LmNoZWNrZWQgPT0gZmFsc2UpIHsKICAgICAgICB2YXIgc2VsZWN0YWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3NlbGVjdGFsbCIpOwoKICAgICAgICBpZiAoc2VsZWN0YWxsLmNoZWNrZWQgPT0gdHJ1ZSkgewogICAgICAgICAgc2VsZWN0YWxsLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciB0ZW1wID0gdGhpcy5jaGVja2VkX2xpc3QuZmlsdGVyKGZ1bmN0aW9uIChpZCkgewogICAgICAgICAgcmV0dXJuIGlkICE9IGJhbm5lcl9pZDsKICAgICAgICB9KTsKICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRlbXA7CiAgICAgIH0KICAgIH0KICB9LAogIGFkZF90b19kYXRlX3RpbWVfbGlzdDogZnVuY3Rpb24gYWRkX3RvX2RhdGVfdGltZV9saXN0KHR5cGUsIGluZGV4LCBpbmRleDEpIHsKICAgIGlmICh0eXBlID09ICJhZGQiKSB7CiAgICAgIHRoaXMuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdFtpbmRleF1bImRhdGVfdGltZV9saXN0Il0udW5zaGlmdCh7CiAgICAgICAgZGF0ZTogW10KICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKHR5cGUgPT0gInJlbW92ZSIpIHsKICAgICAgdGhpcy5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0W2luZGV4XVsiZGF0ZV90aW1lX2xpc3QiXS5zcGxpY2UoaW5kZXgxLCAxKTsKICAgIH0KICB9LAogIGFkZF90b19jdXJyZW50X2Jhbm5lcl9kYXRlX3RpbWVfbGlzdDogZnVuY3Rpb24gYWRkX3RvX2N1cnJlbnRfYmFubmVyX2RhdGVfdGltZV9saXN0KHR5cGUsIGluZGV4LCBpbmRleDEpIHsKICAgIGlmICh0eXBlID09ICJhZGQiKSB7CiAgICAgIHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdFtpbmRleF1bImRhdGVfdGltZV9saXN0Il0udW5zaGlmdCh7CiAgICAgICAgZGF0ZTogW10KICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKHR5cGUgPT0gInJlbW92ZSIpIHsKICAgICAgdGhpcy5jdXJyZW50X2Jhbm5lci5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0W2luZGV4XVsiZGF0ZV90aW1lX2xpc3QiXS5zcGxpY2UoaW5kZXgxLCAxKTsKICAgIH0KICB9LAogIGFkZF90b19sb2NhdGlvbl9saXN0OiBmdW5jdGlvbiBhZGRfdG9fbG9jYXRpb25fbGlzdCh0eXBlLCBpbmRleCwgaW5kZXgxKSB7CiAgICBpZiAodHlwZSA9PSAiYWRkIikgewogICAgICB0aGlzLmJhbm5lcl9kYXRlX2xvY2F0aW9uX2xpc3RbaW5kZXhdWyJsb2NhdGlvbl9saXN0Il0udW5zaGlmdCh7CiAgICAgICAgbG9jYXRpb246IFtdCiAgICAgIH0pOwogICAgfSBlbHNlIGlmICh0eXBlID09ICJyZW1vdmUiKSB7CiAgICAgIHRoaXMuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdFtpbmRleF1bImxvY2F0aW9uX2xpc3QiXS5zcGxpY2UoaW5kZXgxLCAxKTsKICAgIH0KICB9LAogIGFkZF90b19jdXJyZW50X2Jhbm5lcl9sb2NhdGlvbl9saXN0OiBmdW5jdGlvbiBhZGRfdG9fY3VycmVudF9iYW5uZXJfbG9jYXRpb25fbGlzdCh0eXBlLCBpbmRleCwgaW5kZXgxKSB7CiAgICBpZiAodHlwZSA9PSAiYWRkIikgewogICAgICB0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9kYXRlX2xvY2F0aW9uX2xpc3RbaW5kZXhdWyJsb2NhdGlvbl9saXN0Il0udW5zaGlmdCh7CiAgICAgICAgbG9jYXRpb246IFtdCiAgICAgIH0pOwogICAgfSBlbHNlIGlmICh0eXBlID09ICJyZW1vdmUiKSB7CiAgICAgIHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdFtpbmRleF1bImxvY2F0aW9uX2xpc3QiXS5zcGxpY2UoaW5kZXgxLCAxKTsKICAgIH0KICB9LAogIGFkZF90b19iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0OiBmdW5jdGlvbiBhZGRfdG9fYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdCh0eXBlLCBpbmRleCkgewogICAgaWYgKHR5cGUgPT0gImFkZCIpIHsKICAgICAgdGhpcy5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0LnVuc2hpZnQoewogICAgICAgIGRhdGVfdGltZV9saXN0OiBbewogICAgICAgICAgZGF0ZTogW10KICAgICAgICB9XSwKICAgICAgICBsb2NhdGlvbl9saXN0OiBbewogICAgICAgICAgbG9jYXRpb246IFtdCiAgICAgICAgfV0KICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKHR5cGUgPT0gInJlbW92ZSIpIHsKICAgICAgdGhpcy5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0LnNwbGljZShpbmRleCwgMSk7CiAgICB9CiAgfSwKICBhZGRfdG9fY3VycmVudF9iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0OiBmdW5jdGlvbiBhZGRfdG9fY3VycmVudF9iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0KHR5cGUsIGluZGV4KSB7CiAgICBpZiAodHlwZSA9PSAiYWRkIikgewogICAgICB0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9kYXRlX2xvY2F0aW9uX2xpc3QudW5zaGlmdCh7CiAgICAgICAgZGF0ZV90aW1lX2xpc3Q6IFt7CiAgICAgICAgICBkYXRlOiBbXQogICAgICAgIH1dLAogICAgICAgIGxvY2F0aW9uX2xpc3Q6IFt7CiAgICAgICAgICBsb2NhdGlvbjogW10KICAgICAgICB9XQogICAgICB9KTsKICAgIH0gZWxzZSBpZiAodHlwZSA9PSAicmVtb3ZlIikgewogICAgICB0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9kYXRlX2xvY2F0aW9uX2xpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgIH0KICB9LAogIHRvZ2dsZVRpbWVSYW5nZVBhbmVsOiBmdW5jdGlvbiB0b2dnbGVUaW1lUmFuZ2VQYW5lbCgpIHsKICAgIHRoaXMuc2hvd1RpbWVSYW5nZVBhbmVsID0gIXRoaXMuc2hvd1RpbWVSYW5nZVBhbmVsOwogIH0sCiAgaGFuZGxlUmFuZ2VDbG9zZTogZnVuY3Rpb24gaGFuZGxlUmFuZ2VDbG9zZSgpIHsKICAgIHRoaXMuc2hvd1RpbWVSYW5nZVBhbmVsID0gZmFsc2U7CiAgfSwKICBlbXB0eV92YXJpYWJsZTogZnVuY3Rpb24gZW1wdHlfdmFyaWFibGUoKSB7CiAgICB0aGlzLmJhbm5lcl9uYW1lID0gIiI7CiAgICB0aGlzLmJhbm5lcl9kZXNjcmlwdGlvbiA9ICIiOwogICAgdGhpcy5iYW5uZXJfaW1nX2xpbmsgPSAiIjsKICAgIHRoaXMuYmFubmVyX3ZpZGVvX3VybCA9ICIiOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0RmlsZScpLnZhbHVlID0gIiI7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFubmVyX25hbWVfaWQiKS5zdHlsZS5ib3JkZXIgPSBudWxsOwogICAgdGhpcy5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0ID0gWy8vIHsKICAgICAgLy8gICBkYXRlX3RpbWVfbGlzdDogWwogICAgICAvLyAgICAgewogICAgICAvLyAgICAgICBkYXRlOiBbXSwKICAgICAgLy8gICAgIH0sCiAgICAgIC8vICAgXSwKICAgICAgLy8gICBsb2NhdGlvbl9saXN0OiBbCiAgICAgIC8vICAgICB7CiAgICAgIC8vICAgICAgIGxvY2F0aW9uOiBbXSwKICAgICAgLy8gICAgIH0sCiAgICAgIC8vICAgXSwKICAgICAgLy8gfSwKICAgIF07CiAgICB0aGlzLmltYWdlX2ZpbGUgPSBudWxsOwogICAgdGhpcy5pbWFnZV9maWxlXzIgPSBudWxsOwogICAgdGhpcy5maWxlX2xhYmVsID0gIkNob29zZSBmaWxlIjsKICAgIHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwgPSAiQ2hvb3NlIGZpbGUiOwogIH0sCiAgZGVsZXRlX3NlbGVjdGVkOiBmdW5jdGlvbiBkZWxldGVfc2VsZWN0ZWQoKSB7CiAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICBpZiAodGhpcy5jaGVja2VkX2xpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgIFN3YWwoewogICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICB0ZXh0OiAiTm8gRW50aXR5IFNlbGVjdGVkICEiLAogICAgICAgIHRpbWVyOiAyMDAwCiAgICAgIH0pOwogICAgfSBlbHNlIGlmICh0aGlzLmNoZWNrZWRfbGlzdC5sZW5ndGggPiAwKSB7CiAgICAgIHZhciBkZWxldGVfYmFubmVyX2xpc3QgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5jaGVja2VkX2xpc3QpIHsKICAgICAgICBkZWxldGVfYmFubmVyX2xpc3QucHVzaCh0aGlzLmNoZWNrZWRfbGlzdFtpXSk7CiAgICAgIH0KCiAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgdGl0bGU6ICJBcmUgeW91IHN1cmU/IiwKICAgICAgICB0ZXh0OiAiWW91IHdvbid0IGJlIGFibGUgdG8gcmV2ZXJ0IHRoaXMhIiwKICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAiWWVzLCBkZWxldGUhISIKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgX3RoaXM4LnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5iYW5uZXJfdGVtcGxhdGUoKSwgewogICAgICAgICAgICBjb21wYW55X25hbWU6IF90aGlzOC5jb21wYW55bmFtZSwKICAgICAgICAgICAgY29tcGFueV9pZDogX3RoaXM4LmNvbXBhbnlpZCwKICAgICAgICAgICAgZW1haWw6IF90aGlzOC4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICBsaWNlbnNlX2tleTogX3RoaXM4LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiBfdGhpczguJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogX3RoaXM4LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICBpc19kZWxldGU6IHRydWUsCiAgICAgICAgICAgIGJhbm5lcl9pZHNfbGlzdDogZGVsZXRlX2Jhbm5lcl9saXN0CiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KF90aGlzOC4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIF90aGlzOC5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiUXVlcnkgRXhlY3V0ZWQgU3VjY2Vzc2Z1bGx5IikgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgdGV4dDogIkJhbm5lciBEZWxldGVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBpZiAoX3RoaXM4LmNoZWNrZWRfbGlzdC5sZW5ndGggPT09IF90aGlzOC5iYW5uZXJfdGVtcGxhdGVfbGlzdC5sZW5ndGggJiYgX3RoaXM4LnBhZ2Vfbm8gPiAxKSB7CiAgICAgICAgICAgICAgICBfdGhpczgucGFnZV9ubyA9IF90aGlzOC5wYWdlX25vIC0gMTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF90aGlzOC5sb2FkX2Jhbm5lcnMoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICB0ZXh0OiAiU29tZSBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgX3RoaXM4LnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHRleHQ6ICJTb21lIGVycm9yIG9jY3VycmVkLiBQbGVhc2UgdHJ5IGFnYWluLiIsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICBfdGhpczguJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBjcmVhdGVfVVVJRDogZnVuY3Rpb24gY3JlYXRlX1VVSUQoKSB7CiAgICB2YXIgZHQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgIHZhciB1dWlkID0gInh4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCIucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykgewogICAgICB2YXIgciA9IChkdCArIE1hdGgucmFuZG9tKCkgKiAxNikgJSAxNiB8IDA7CiAgICAgIGR0ID0gTWF0aC5mbG9vcihkdCAvIDE2KTsKICAgICAgcmV0dXJuIChjID09ICJ4IiA/IHIgOiByICYgMHgzIHwgMHg4KS50b1N0cmluZygxNik7CiAgICB9KTsKICAgIHJldHVybiB1dWlkOwogIH0sCiAgc2F2ZV9iYW5uZXI6IGZ1bmN0aW9uIHNhdmVfYmFubmVyKCkgewogICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgaWYgKHRoaXMuYmFubmVyX25hbWUgPT0gIiIpIHsKICAgICAgU3dhbCh7CiAgICAgICAgdGV4dDogIlBsZWFzZSBlbnRlciBhbiBCYW5uZXIgbmFtZSIsCiAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgIHRpbWVyOiAzNTAwCiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuYmFubmVyX25hbWVfYWxyZWFkeV9leGlzdCA9PSB0cnVlKSB7CiAgICAgIFN3YWwoewogICAgICAgIHRleHQ6ICJCYW5uZXIgbmFtZSBhbHJlYWR5IGV4aXN0LCBQbGVhc2UgZW50ZXIgZGlmZmVyZW50IG5hbWUiLAogICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICB0aW1lcjogNDUwMAogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLmJhbm5lcl92aWRlb191cmwgPT0gIiIgJiYgdGhpcy5pbWFnZV9maWxlID09IG51bGwgJiYgdGhpcy5maWxlX2xhYmVsID09ICJDaG9vc2UgZmlsZSIpIHsKICAgICAgU3dhbCh7CiAgICAgICAgdGV4dDogIlBsZWFzZSBhZGQgaW1hZ2Ugb3IgdmlkZW8gdXJsIiwKICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgdGltZXI6IDU1MDAKICAgICAgfSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5iYW5uZXJfaW1nX2xpbmsgIT0gIiIpIHsKICAgICAgaWYgKHRoaXMuaW1hZ2VfZmlsZSA9PSBudWxsIHx8IHRoaXMuZmlsZV9sYWJlbCA9PSAiQ2hvb3NlIGZpbGUiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiAiUGxlYXNlIGFkZCBCYW5uZXIgaW1hZ2UgZmlyc3QiLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDU1MDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5iYW5uZXJfaW1nX2xpbmsgIT0gIiIpIHsKICAgICAgaWYgKHRoaXMudmFsaWRVUkwgPT0gZmFsc2UpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBpbWFnZSByZWRpcmVjdCB1cmwiLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDU1MDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5iYW5uZXJfdmlkZW9fdXJsICE9ICIiKSB7CiAgICAgIGlmICh0aGlzLnZhbGlkVmlkZW9VUkwgPT0gZmFsc2UpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCB2aWRlbyB1cmwiLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDU1MDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdC5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGF0ZSA9IHRoaXMuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdFtpXVsnZGF0ZV90aW1lX2xpc3QnXTsKICAgICAgdmFyIGxvY2F0aW9uID0gdGhpcy5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0W2ldWydsb2NhdGlvbl9saXN0J107CgogICAgICBpZiAoQm9vbGVhbihkYXRlLmxlbmd0aCkgfHwgQm9vbGVhbihsb2NhdGlvbi5sZW5ndGgpKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkYXRlLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoIWRhdGVbal0uZGF0ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJEYXRlIGNhbm5vdCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGVbal0uZGF0ZS5pbmNsdWRlcyhudWxsKSA9PSB0cnVlKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJEYXRlIGNhbm5vdCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGxvY2F0aW9uLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICBpZiAoIWxvY2F0aW9uW2tdLmxvY2F0aW9uLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogIkxvY2F0aW9uIGNhbm5vdCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogIkJvdGggRGF0ZSBhbmQgTG9jYXRpb24gY2Fubm90IGJlIGVtcHR5IiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgdmFyIHV1aWQgPSB0aGlzLmNyZWF0ZV9VVUlEKCk7CiAgICBTd2FsKHsKICAgICAgdGV4dDogIlBsZWFzZSB3YWl0IHdoaWxlIHdlIGFyZSBzdWJtaXR0aW5nIHlvdXIgZGV0YWlscy4uLiIsCiAgICAgIHR5cGU6ICJpbmZvIiwKICAgICAgdG9hc3Q6IHRydWUsCiAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZQogICAgfSk7CiAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5iYW5uZXJfdGVtcGxhdGUoKSwgewogICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICBpc19zYXZlOiB0cnVlLAogICAgICBiYW5uZXJfZGV0YWlsczogewogICAgICAgIGJhbm5lcl9pZDogdXVpZCwKICAgICAgICBiYW5uZXJfbmFtZTogdGhpcy5iYW5uZXJfbmFtZSwKICAgICAgICBpc19kaXNwbGF5X2Jhbm5lcjogdGhpcy5pc19kaXNwbGF5X2Jhbm5lciwKICAgICAgICBiYW5uZXJfZGVzY3JpcHRpb246IHRoaXMuYmFubmVyX2Rlc2NyaXB0aW9uLAogICAgICAgIGJhbm5lcl9jb250ZW50X3Bvc2l0aW9uOiB0aGlzLmJhbm5lcl9jb250ZW50X3Bvc2l0aW9uLAogICAgICAgIGJhbm5lcl9pbWdfZmlsZTogdGhpcy5pbWFnZV9maWxlID09PSBudWxsID8gbnVsbCA6IHRoaXMuaW1hZ2VfZmlsZSwKICAgICAgICBiYW5uZXJfaW1nX25hbWU6IHRoaXMuZmlsZV9sYWJlbCA9PSAiQ2hvb3NlIGZpbGUiID8gbnVsbCA6IHRoaXMuZmlsZV9sYWJlbCwKICAgICAgICBiYW5uZXJfaW1nX2xpbms6IHRoaXMuYmFubmVyX2ltZ19saW5rLAogICAgICAgIGJhbm5lcl92aWRlb191cmw6IHRoaXMuYmFubmVyX3ZpZGVvX3VybCwKICAgICAgICBiYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0OiB0aGlzLmJhbm5lcl9kYXRlX2xvY2F0aW9uX2xpc3QKICAgICAgfQogICAgfSwgewogICAgICBoZWFkZXJzOiB7CiAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgfQogICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubXNnID09ICJRdWVyeSBFeGVjdXRlZCBTdWNjZXNzZnVsbHkiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICB0ZXh0OiAiQmFubmVyIGRhdGEgYWRkZWQgc3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICBfdGhpczkuZW1wdHlfdmFyaWFibGUoKTsKCiAgICAgICAgICBfdGhpczkubG9hZF9iYW5uZXJzKCk7CgogICAgICAgICAgJCgiI2Jhbm5lcm1vZGVsIikubW9kYWwoImhpZGUiKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhID09ICJEdXBsaWNhdGUgaW1hZ2UiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGV4dDogIkltYWdlIGFscmVhZHkgZm91bmQuIFBsZWFzZSB1cGxvYWQgYW5vdGhlciBpbWFnZSBvciByZW5hbWUgaXQuIiwKICAgICAgICAgIHRpbWVyOiA0NTAwCiAgICAgICAgfSk7IC8vIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgICAvLyB0aGlzLmxvYWRfYmFubmVycygpOwogICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubXNnID09ICJwbGVhc2Ugc2VsZWN0IHByb3BlciBsb2NhdGlvbiIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICB0ZXh0OiAiUGxlYXNlIGVudGVyIGxvY2F0aW9uIGUuZy4gQ2l0eSwgU3RhdGUgb3IgQ291bnRyeS4iLAogICAgICAgICAgdGltZXI6IDU1MDAKICAgICAgICB9KTsgLy8gdGhpcy5lbXB0eV92YXJpYWJsZSgpOwogICAgICAgIC8vIHRoaXMubG9hZF9iYW5uZXJzKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGV4dDogIlNvbWUgZXJyb3Igb2NjdXJyZWQuIFBsZWFzZSB0cnkgYWdhaW4uIiwKICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgIF90aGlzOS5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgU3dhbCh7CiAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICB0ZXh0OiAiU29tZSBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgIHRpbWVyOiAyNTAwCiAgICAgIH0pOwoKICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgX3RoaXM5LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICB9CiAgICB9KTsKICB9LAogIGlzX2Rpc3BsYXlfYmFubmVyX3NhdmU6IGZ1bmN0aW9uIGlzX2Rpc3BsYXlfYmFubmVyX3NhdmUoKSB7CiAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgdGhpcy5jdXJyZW50X2Jhbm5lci5pc19kaXNwbGF5X2Jhbm5lciA9ICF0aGlzLmN1cnJlbnRfYmFubmVyLmlzX2Rpc3BsYXlfYmFubmVyOwoKICAgIGlmICh0aGlzLmN1cnJlbnRfYmFubmVyLmlzX2Rpc3BsYXlfYmFubmVyKSB7CiAgICAgIFN3YWwoewogICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgdGV4dDogIllvdSB3YW50IHRvIGVuYWJsZSB0aGlzIGJhbm5lciAoRm9yIGJldHRlciB1c2VyIGV4cGVyaWVuY2Ugc2hvdyBtYXggdHdvIGJhbm5lcnMpIiwKICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlNhdmUiLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICJDYW5jZWwiCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgIF90aGlzMTAuZWRpdF9iYW5uZXIoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMxMC5jdXJyZW50X2Jhbm5lci5pc19kaXNwbGF5X2Jhbm5lciA9ICFfdGhpczEwLmN1cnJlbnRfYmFubmVyLmlzX2Rpc3BsYXlfYmFubmVyOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmVkaXRfYmFubmVyKCk7CiAgICB9CiAgfSwKICBlZGl0X2Jhbm5lcjogZnVuY3Rpb24gZWRpdF9iYW5uZXIoKSB7CiAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX25hbWUgPT0gIiIpIHsKICAgICAgU3dhbCh7CiAgICAgICAgdGV4dDogIlBsZWFzZSBlbnRlciBhbiBCYW5uZXIgbmFtZSIsCiAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgIHRpbWVyOiAzNTAwCiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuZWRpdF9iYW5uZXJfbmFtZV9hbHJlYWR5X2V4aXN0ID09IHRydWUpIHsKICAgICAgU3dhbCh7CiAgICAgICAgdGV4dDogIkJhbm5lciBuYW1lIGFscmVhZHkgZXhpc3QsIFBsZWFzZSBlbnRlciBkaWZmZXJlbnQgbmFtZSIsCiAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgIHRpbWVyOiA0NTAwCiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX3ZpZGVvX3VybCA9PSAiIiAmJiB0aGlzLmltYWdlX2ZpbGVfMiA9PSBudWxsICYmIHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwgPT0gIkNob29zZSBmaWxlIikgewogICAgICBTd2FsKHsKICAgICAgICB0ZXh0OiAiUGxlYXNlIGFkZCBpbWFnZSBvciB2aWRlbyB1cmwiLAogICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICB0aW1lcjogNTUwMAogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9pbWdfbGluayAhPSAiIikgewogICAgICBpZiAodGhpcy5pbWFnZV9maWxlXzIgPT0gbnVsbCB8fCB0aGlzLmVkaXRlZF9maWxlX2xhYmVsID09ICJDaG9vc2UgZmlsZSIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6ICJQbGVhc2UgYWRkIEJhbm5lciBpbWFnZSBmaXJzdCIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTUwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9pbWdfbGluayAhPSAiIikgewogICAgICBpZiAodGhpcy52YWxpZFVSTF9lZGl0ID09IGZhbHNlKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgaW1hZ2UgcmVkaXJlY3QgdXJsIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX3ZpZGVvX3VybCAhPSAiIikgewogICAgICBpZiAodGhpcy52YWxpZFZpZGVvVVJMX2VkaXQgPT0gZmFsc2UpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCB2aWRlbyB1cmwiLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDU1MDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdC5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGF0ZSA9IHRoaXMuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdFtpXVsnZGF0ZV90aW1lX2xpc3QnXTsKICAgICAgdmFyIGxvY2F0aW9uID0gdGhpcy5iYW5uZXJfZGF0ZV9sb2NhdGlvbl9saXN0W2ldWydsb2NhdGlvbl9saXN0J107CgogICAgICBpZiAoQm9vbGVhbihkYXRlLmxlbmd0aCkgfHwgQm9vbGVhbihsb2NhdGlvbi5sZW5ndGgpKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBkYXRlLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoIWRhdGVbal0uZGF0ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJEYXRlIGNhbm5vdCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGVbal0uZGF0ZS5pbmNsdWRlcyhudWxsKSA9PSB0cnVlKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICJEYXRlIGNhbm5vdCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGxvY2F0aW9uLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICBpZiAoIWxvY2F0aW9uW2tdLmxvY2F0aW9uLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogIkxvY2F0aW9uIGNhbm5vdCBiZSBlbXB0eSIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogIkJvdGggRGF0ZSBhbmQgTG9jYXRpb24gY2Fubm90IGJlIGVtcHR5IiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgYXhpb3MucG9zdChhcGlfY2FsbHMuYmFubmVyX3RlbXBsYXRlKCksIHsKICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgaXNfZWRpdDogdHJ1ZSwKICAgICAgYmFubmVyX29sZF9pbWdfbmFtZTogdGhpcy5iYW5uZXJfb2xkX2ltZ19uYW1lICE9IHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2ltZ19uYW1lID8gdGhpcy5iYW5uZXJfb2xkX2ltZ19uYW1lIDogbnVsbCwKICAgICAgYmFubmVyX2RldGFpbHM6IHsKICAgICAgICBiYW5uZXJfaWQ6IHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2lkLAogICAgICAgIGJhbm5lcl9uYW1lOiB0aGlzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9uYW1lLAogICAgICAgIGlzX2Rpc3BsYXlfYmFubmVyOiB0aGlzLmN1cnJlbnRfYmFubmVyLmlzX2Rpc3BsYXlfYmFubmVyLAogICAgICAgIGJhbm5lcl9kZXNjcmlwdGlvbjogdGhpcy5jdXJyZW50X2Jhbm5lci5iYW5uZXJfZGVzY3JpcHRpb24sCiAgICAgICAgYmFubmVyX2NvbnRlbnRfcG9zaXRpb246IHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2NvbnRlbnRfcG9zaXRpb24sCiAgICAgICAgYmFubmVyX2ltZ191cmw6IHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2ltZ191cmwsCiAgICAgICAgYmFubmVyX2ltZ19maWxlOiB0aGlzLmltYWdlX2ZpbGVfMiA9PT0gbnVsbCA/IG51bGwgOiB0aGlzLmltYWdlX2ZpbGVfMiwKICAgICAgICBiYW5uZXJfaW1nX25hbWU6IHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwgPT0gIkNob29zZSBmaWxlIiA/IG51bGwgOiB0aGlzLmVkaXRlZF9maWxlX2xhYmVsLAogICAgICAgIGJhbm5lcl9pbWdfbGluazogdGhpcy5jdXJyZW50X2Jhbm5lci5iYW5uZXJfaW1nX2xpbmssCiAgICAgICAgYmFubmVyX3ZpZGVvX3VybDogdGhpcy5jdXJyZW50X2Jhbm5lci5iYW5uZXJfdmlkZW9fdXJsLAogICAgICAgIGJhbm5lcl9kYXRlX2xvY2F0aW9uX2xpc3Q6IHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX2RhdGVfbG9jYXRpb25fbGlzdAogICAgICB9CiAgICB9LCB7CiAgICAgIGhlYWRlcnM6IHsKICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICBfdGhpczExLnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubXNnID09ICJRdWVyeSBFeGVjdXRlZCBTdWNjZXNzZnVsbHkiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICB0ZXh0OiAiQmFubmVyIGRhdGEgZWRpdGVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgLy8gdGhpcy5lbXB0eV92YXJpYWJsZSgpOwogICAgICAgICAgX3RoaXMxMS5sb2FkX2Jhbm5lcnMoX3RoaXMxMS5jdXJyZW50X2Jhbm5lcl9pbmRleCk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIkR1cGxpY2F0ZSBpbWFnZSIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICB0ZXh0OiAiSW1hZ2UgYWxyZWFkeSBmb3VuZC4gUGxlYXNlIHVwbG9hZCBhbm90aGVyIGltYWdlIG9yIHJlbmFtZSBpdC4iLAogICAgICAgICAgdGltZXI6IDQ1MDAKICAgICAgICB9KTsgLy8gdGhpcy5lbXB0eV92YXJpYWJsZSgpOwoKICAgICAgICBfdGhpczExLmxvYWRfYmFubmVycyhfdGhpczExLmN1cnJlbnRfYmFubmVyX2luZGV4KTsKICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAicGxlYXNlIHNlbGVjdCBwcm9wZXIgbG9jYXRpb24iKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGV4dDogIlBsZWFzZSBlbnRlciBsb2NhdGlvbiBlLmcuIENpdHksIFN0YXRlIG9yIENvdW50cnkuIiwKICAgICAgICAgIHRpbWVyOiA1NTAwCiAgICAgICAgfSk7IC8vIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgICAvLyB0aGlzLmxvYWRfYmFubmVycyh0aGlzLmN1cnJlbnRfYmFubmVyX2luZGV4KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICB0ZXh0OiAiU29tZSBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICB9KTsKICAgICAgfQogICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgX3RoaXMxMS5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgU3dhbCh7CiAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICB0ZXh0OiAiU29tZSBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgIHRpbWVyOiAyNTAwCiAgICAgIH0pOwoKICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgX3RoaXMxMS4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgfQogICAgfSk7CiAgfSwKICB2YWxpZGF0ZV9iYW5uZXJfbmFtZTogZnVuY3Rpb24gdmFsaWRhdGVfYmFubmVyX25hbWUoKSB7CiAgICB2YXIgX3RoaXMxMiA9IHRoaXM7CgogICAgYXhpb3MucG9zdChhcGlfY2FsbHMuYmFubmVyX3RlbXBsYXRlKCksIHsKICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgIHN1YnNjcmlwdGlvbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiwKICAgICAgaXNfZXhpc3Q6IHRydWUsCiAgICAgIGJhbm5lcl9uYW1lOiB0aGlzLmJhbm5lcl9uYW1lCiAgICB9LCB7CiAgICAgIGhlYWRlcnM6IHsKICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIkJhbm5lciBuYW1lIGRvZXMgbm90IGV4aXN0IikgewogICAgICAgIF90aGlzMTIuYmFubmVyX25hbWVfYWxyZWFkeV9leGlzdCA9IGZhbHNlOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJiYW5uZXJfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9IG51bGw7CgogICAgICAgIGlmIChfdGhpczEyLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9uYW1lICE9ICIiKSB7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFubmVyX25hbWVfaWQiKS5zdHlsZS5ib3JkZXIgPSAiMXB4IHNvbGlkICMwMGYwMDAiOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiQmFubmVyIG5hbWUgYWxyZWFkeSBleGlzdHMiKSB7CiAgICAgICAgX3RoaXMxMi5iYW5uZXJfbmFtZV9hbHJlYWR5X2V4aXN0ID0gdHJ1ZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFubmVyX25hbWVfaWQiKS5zdHlsZS5ib3JkZXIgPSAiMXB4IHNvbGlkIHJlZCI7CiAgICAgIH0KICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgIF90aGlzMTIuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgdmFsaWRhdGVfZWRpdF9iYW5uZXJfbmFtZTogZnVuY3Rpb24gdmFsaWRhdGVfZWRpdF9iYW5uZXJfbmFtZSgpIHsKICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5iYW5uZXJfdGVtcGxhdGUoKSwgewogICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICBpc19leGlzdDogdHJ1ZSwKICAgICAgYmFubmVyX25hbWU6IHRoaXMuY3VycmVudF9iYW5uZXIuYmFubmVyX25hbWUKICAgIH0sIHsKICAgICAgaGVhZGVyczogewogICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiQmFubmVyIG5hbWUgZG9lcyBub3QgZXhpc3QiKSB7CiAgICAgICAgX3RoaXMxMy5lZGl0X2Jhbm5lcl9uYW1lX2FscmVhZHlfZXhpc3QgPSBmYWxzZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdF9iYW5uZXJfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9IG51bGw7CgogICAgICAgIGlmIChfdGhpczEzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9uYW1lICE9ICIiKSB7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdF9iYW5uZXJfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9ICIxcHggc29saWQgIzAwZjAwMCI7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubXNnID09ICJCYW5uZXIgbmFtZSBhbHJlYWR5IGV4aXN0cyIpIHsKICAgICAgICBpZiAoX3RoaXMxMy5jdXJyZW50X2Jhbm5lcl9vbGRfbmFtZSA9PSBfdGhpczEzLmN1cnJlbnRfYmFubmVyLmJhbm5lcl9uYW1lKSB7CiAgICAgICAgICBfdGhpczEzLmVkaXRfYmFubmVyX25hbWVfYWxyZWFkeV9leGlzdCA9IGZhbHNlOwogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVkaXRfYmFubmVyX25hbWVfaWQiKS5zdHlsZS5ib3JkZXIgPSBudWxsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczEzLmVkaXRfYmFubmVyX25hbWVfYWxyZWFkeV9leGlzdCA9IHRydWU7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdF9iYW5uZXJfbmFtZV9pZCIpLnN0eWxlLmJvcmRlciA9ICIxcHggc29saWQgcmVkIjsKICAgICAgICB9CiAgICAgIH0KICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgIF90aGlzMTMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgZmlsZWlucHV0MjogZnVuY3Rpb24gZmlsZWlucHV0MihlKSB7CiAgICB2YXIgZmlsZXMgPSBlLnRhcmdldC5maWxlcyB8fCBlLmRhdGFUcmFuc2Zlci5maWxlczsKCiAgICBpZiAoZmlsZXNbMF0udHlwZSA9PT0gImltYWdlL3BuZyIgfHwgZmlsZXNbMF0udHlwZSA9PT0gImltYWdlL2pwZWciKSB7CiAgICAgIGlmICghZmlsZXMubGVuZ3RoKSByZXR1cm47IC8vIHRoaXMub2xkX2VkaXRlZF9pbWFnZV9uYW1lID0gdGhpcy5lZGl0ZWRfZmlsZV9sYWJlbDsKCiAgICAgIHRoaXMuZWRpdGVkX2ZpbGVfbGFiZWwgPSBmaWxlc1swXS5uYW1lOwogICAgICB0aGlzLmNyZWF0ZUltYWdlMihmaWxlc1swXSk7CiAgICB9IGVsc2UgewogICAgICBzd2FsKHsKICAgICAgICB0ZXh0OiAiUGxlYXNlIFNlbGVjdCBhbiBJbWFnZSBvZiB0eXBlIFBORyBvciBKUEVHIiwKICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgIHRpbWVyOiAyNTAwCiAgICAgIH0pOwogICAgfQogIH0sCiAgY3JlYXRlSW1hZ2UyOiBmdW5jdGlvbiBjcmVhdGVJbWFnZTIoZmlsZSwgdHlwZSkgewogICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICBfdGhpczE0LmltYWdlX2ZpbGVfMiA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdCgiYmFzZTY0LCIpWzFdOwogICAgfTsKCiAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICB9LAogIGZpbGVpbnB1dDE6IGZ1bmN0aW9uIGZpbGVpbnB1dDEoZSkgewogICAgdmFyIGZpbGVzID0gZS50YXJnZXQuZmlsZXMgfHwgZS5kYXRhVHJhbnNmZXIuZmlsZXM7CgogICAgaWYgKGZpbGVzWzBdLnR5cGUgPT09ICJpbWFnZS9wbmciIHx8IGZpbGVzWzBdLnR5cGUgPT09ICJpbWFnZS9qcGVnIikgewogICAgICBpZiAoIWZpbGVzLmxlbmd0aCkgcmV0dXJuOwogICAgICB0aGlzLmZpbGVfbGFiZWwgPSBmaWxlc1swXS5uYW1lOwogICAgICB0aGlzLmNyZWF0ZUltYWdlKGZpbGVzWzBdKTsKICAgIH0gZWxzZSB7CiAgICAgIHN3YWwoewogICAgICAgIHRleHQ6ICJQbGVhc2UgU2VsZWN0IGFuIEltYWdlIG9mIHR5cGUgUE5HIG9yIEpQRUciLAogICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgdGltZXI6IDQ1MDAKICAgICAgfSk7CiAgICB9CiAgfSwKICBjcmVhdGVJbWFnZTogZnVuY3Rpb24gY3JlYXRlSW1hZ2UoZmlsZSwgdHlwZSkgewogICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICBfdGhpczE1LmltYWdlX2ZpbGUgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoImJhc2U2NCwiKVsxXTsKICAgIH07CgogICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgfQp9KSwgX25hbWUkbmFtZSRjb21wb25lbnRzKTs="},null]}