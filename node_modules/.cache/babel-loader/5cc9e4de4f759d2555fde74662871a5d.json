{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Settings/Miscellaneous.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Settings/Miscellaneous.vue","mtime":1643027096180},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwppbXBvcnQgSnNvbkV4Y2VsIGZyb20gInZ1ZS1qc29uLWV4Y2VsIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IFN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgeyBzZXRUaW1lb3V0IH0gZnJvbSAidGltZXJzIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKaW1wb3J0IFZvZXJyb1RhZ3NJbnB1dCBmcm9tICJAdm9lcnJvL3Z1ZS10YWdzaW5wdXQiOwppbXBvcnQgIkB2b2Vycm8vdnVlLXRhZ3NpbnB1dC9kaXN0L3N0eWxlLmNzcyI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IEJpbGxpbmcgZnJvbSAiLi4vQWNjb3VudC9CaWxsaW5nLnZ1ZSI7CmltcG9ydCBzd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IEZlZWRiYWNrIGZyb20gIi4vRmVlZGJhY2sudnVlIjsKaW1wb3J0IEludGVncmF0aW9uTGF5b3V0IGZyb20gIi4uL0ludGVncmF0aW9ucy9JbnRlZ3JhdGlvbkxheW91dC52dWUiOwppbXBvcnQgeyBmcmVlemVfcG9ydGFsLCBzaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwgfSBmcm9tICJAL3BvcnRhbC9taXhpbnMiOwppbXBvcnQgVnVlUGhvbmVOdW1iZXJJbnB1dCBmcm9tICd2dWUtcGhvbmUtbnVtYmVyLWlucHV0JzsKaW1wb3J0ICd2dWUtcGhvbmUtbnVtYmVyLWlucHV0L2Rpc3QvdnVlLXBob25lLW51bWJlci1pbnB1dC5jc3MnOwppbXBvcnQgeyBidXMgfSBmcm9tICJAL3BvcnRhbC9tYWluIjsKVnVlLmNvbXBvbmVudCgiZG93bmxvYWRFeGNlbCIsIEpzb25FeGNlbCk7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTWlzY2VsbGFuZW91c1BhZ2UiLAogIG1peGluczogW2ZyZWV6ZV9wb3J0YWwsIHNob3dfc3Vic2NyaXB0aW9uX2V4cGlyZWRfc3dhbF0sCiAgY29tcG9uZW50czogewogICAgTXVsdGlzZWxlY3Q6IE11bHRpc2VsZWN0LAogICAgInRhZ3MtaW5wdXQiOiBWb2Vycm9UYWdzSW5wdXQsCiAgICBCaWxsaW5nOiBCaWxsaW5nLAogICAgRmVlZGJhY2s6IEZlZWRiYWNrLAogICAgSW50ZWdyYXRpb25MYXlvdXQ6IEludGVncmF0aW9uTGF5b3V0LAogICAgVnVlUGhvbmVOdW1iZXJJbnB1dDogVnVlUGhvbmVOdW1iZXJJbnB1dAogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHZpZXdfY29tcG9uZW50X25hbWU6ICJvdGhlcnMiLAogICAgICAvLyBzdGFydF9ncmVldGluZ3M6ICIiLAogICAgICAvLyBlbmRfZ3JlZXRpbmdzOiAiIiwKICAgICAgdGl0bGU6ICIiLAogICAgICBpbWFnZV9maWxlOiBudWxsLAogICAgICBmaWxlX2xhYmVsOiAiQ2hvb3NlIGZpbGUiLAogICAgICBzZW5kZXI6IG51bGwsCiAgICAgIHN1YmplY3Q6IG51bGwsCiAgICAgIGVtYWlsX2JvZHk6IG51bGwsCiAgICAgIGNvbXBhbnlpZDogbnVsbCwKICAgICAgY29tcGFueW5hbWU6IG51bGwsCiAgICAgIG11bHRpcGxlX2xhbmd1YWdlX2xpc3Q6IFtdLAogICAgICBwaG9uZU51bWJlcjogbnVsbCwKICAgICAgY29udGFjdF91c19waG9uZV9udW1iZXI6IG51bGwsCiAgICAgIGNvbnRhY3RfdXNfZW1haWw6ICIiLAogICAgICBlbWFpbF92YWxpZGl0eTogL14oWzAtOWEtekEtWl0oWy0uXHddKlswLTlhLXpBLVpdKSpAKFswLTlhLXpBLVpdWy1cd10qWzAtOWEtekEtWl1cLikrW2EtekEtWl17Miw5fSkkLywKICAgICAgaXNfcmV0YWlsOiBmYWxzZSwKICAgICAgb2xkX2ltYWdlX25hbWU6IG51bGwsCiAgICAgIHNwaW5uZXJPbjE6IGZhbHNlLAogICAgICBzcGlubmVyT24yOiBmYWxzZSwKICAgICAgYmlnX3NwaW5uZXI6IGZhbHNlLAogICAgICB0cmFpbmVkX2RpYWxvZ3VlX21vZGVsczogbnVsbCwKICAgICAgdHJhaW5lZF9pbnRlbnRfbW9kZWxzOiBudWxsLAogICAgICBjdXJyZW50X2xpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgIHRyYWluZWRfbmVyX21vZGVsczogbnVsbCwKICAgICAgZGlzYWJsZV9idG5fZXhwaXJlZDogZmFsc2UKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgaWYgKHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIikgewogICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55SWQiKTsKICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55TmFtZSIpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgdGhpcy5jb21wYW55bmFtZSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWU7CiAgICB9IC8vIGF4aW9zCiAgICAvLyAgIC5wb3N0KAogICAgLy8gICAgIGFwaV9jYWxscy50d2lsaW9fZ3JlZXRpbmdzKCksCiAgICAvLyAgICAgewogICAgLy8gICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAvLyAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgLy8gICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgIC8vICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAvLyAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgIC8vICAgICAgIGlzU2hvdzogdHJ1ZQogICAgLy8gICAgIH0sCiAgICAvLyAgICAgewogICAgLy8gICAgICAgaGVhZGVyczogewogICAgLy8gICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YAogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0KICAgIC8vICAgKQogICAgLy8gICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAvLyAgICAgdGhpcy5zdGFydF9ncmVldGluZ3MgPSByZXNwb25zZS5kYXRhLmdyZWV0aW5nOwogICAgLy8gICAgIHRoaXMuZW5kX2dyZWV0aW5ncyA9IHJlc3BvbnNlLmRhdGEuYnVzeTsKICAgIC8vICAgfSkKICAgIC8vICAgLmNhdGNoKGUgPT4gewogICAgLy8gICAgIGlmICgKICAgIC8vICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgIC8vICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgIC8vICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICApIHsKICAgIC8vICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgfQogICAgLy8gICB9KTsKCiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB0aGlzLiRzZXNzaW9uLnNldCgiQ3VycmVudEFjdGl2ZVRhYkZvckhlbHAiLCB0aGlzLnZpZXdfY29tcG9uZW50X25hbWUpOyAvL2NvbnNvbGUubG9nKHRoaXMudmlld19jb21wb25lbnRfbmFtZSwiY29tcCBuYW1lIik7CgogICAgYnVzLiRvbigiQ3VycmVudEFjdGl2ZVRhYiIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIGlmIChkYXRhID09PSBfdGhpcy4kcm91dGUuZnVsbFBhdGgpIHsKICAgICAgICAvL2NvbnNvbGUubG9nKCJIZWxsbyIsdGhpcy4kcm91dGUpOwogICAgICAgIHJldHVybiBfdGhpcy52aWV3X2NvbXBvbmVudF9uYW1lOyAvLyBidXMuJGVtaXQoIkN1cnJyZW50QWN0aXZlVGFiUmVzcG9uc2UiLCB0aGlzLnZpZXdfY29tcG9uZW50X25hbWUpCiAgICAgIH0KICAgIH0pOwoKICAgIGlmICh0aGlzLmlzX3JldGFpbCAhPSB0cnVlKSB7CiAgICAgIHRoaXMubG9hZF9wcm9kdWN0X3NldHRpbmdzKCk7CiAgICB9CgogICAgdmFyIGJvdF90ZW1wbGF0ZXNfZGF0YSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJCb3RUZW1wbGF0ZXMiKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvdF90ZW1wbGF0ZXNfZGF0YS5sZW5ndGg7IGkrKykgewogICAgICBpZiAoYm90X3RlbXBsYXRlc19kYXRhW2ldLmRvbWFpbiA9PT0gIlJldGFpbCIgJiYgYm90X3RlbXBsYXRlc19kYXRhW2ldLnN1YnNjcmliZWQgPT09IHRydWUpIHsKICAgICAgICB0aGlzLmlzX3JldGFpbCA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuZnJlZXplX3BvcnRhbCgpOwogICAgfSwgMTAwMCk7CiAgICB0aGlzLiRyb290LiRvbigiTWlzY2VsbGFuZW91c1BhZ2VEaXNhYmxlZCIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIGlmIChkYXRhID09PSB0cnVlKSB7CiAgICAgICAgX3RoaXMuZGlzYWJsZV9idG5fZXhwaXJlZCA9IHRydWU7CiAgICAgIH0KICAgIH0pOwogICAgdGhpcy4kcm9vdC4kb24oImFjY291bnRQYWdlIiwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgaWYgKGRhdGEgPT09IHRydWUpIHsKICAgICAgICAkKCIjYWNjb3VudHMtdGFiIikuY2xpY2soKTsKICAgICAgICBfdGhpcy52aWV3X2NvbXBvbmVudF9uYW1lID0gImFjY291bnRzIjsKICAgICAgfQogICAgfSk7CiAgICB0aGlzLmluaXRpYWxpemVfdG9vbHRpcHMoKTsKICAgIHZhciB2bSA9IHRoaXM7CiAgICB0aGlzLmdldF90cmFpbmVkX2RpYWxvZ3VlX21vZGVscygpOwogICAgdGhpcy5nZXRfdHJhaW5lZF9pbnRlbnRfbW9kZWxzKCk7CiAgICB0aGlzLmdldF90cmFpbmVkX25lcl9tb2RlbHMoKTsKICAgIHRoaXMuZ2V0X2NvbXBhbnlfbG9nbygpOwoKICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuU3Vic2NyaXB0aW9uID09PSB0cnVlKSB7CiAgICAgICQoIiNhY2NvdW50cy10YWIiKS5jbGljaygpOwogICAgICB0aGlzLnZpZXdfY29tcG9uZW50X25hbWUgPSAiYWNjb3VudHMiOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHZhbGlkRW1haWw6IGZ1bmN0aW9uIHZhbGlkRW1haWwoKSB7CiAgICAgIGlmICh0aGlzLmNvbnRhY3RfdXNfZW1haWwgIT0gbnVsbCkgewogICAgICAgIGlmICh0aGlzLmVtYWlsX3ZhbGlkaXR5LnRlc3QodGhpcy5jb250YWN0X3VzX2VtYWlsKSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgRW1haWwgQWRkcmVzcyI7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgdmlld19jb21wb25lbnRfbmFtZTogZnVuY3Rpb24gdmlld19jb21wb25lbnRfbmFtZShuZXdWYWwpIHsKICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIkN1cnJlbnRBY3RpdmVUYWJGb3JIZWxwIiwgbmV3VmFsKTsKICAgIH0sCiAgICBib3RfYmFja2dyb3VuZF90eXBlOiBmdW5jdGlvbiBib3RfYmFja2dyb3VuZF90eXBlKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIGlmIChuZXdWYWwgPT09ICJub25lIikgewogICAgICAgIHRoaXMuZmlsZV9sYWJlbF8zID0gIkNob29zZSBGaWxlIjsKICAgICAgICB0aGlzLmltYWdlX2ZpbGVfMyA9IG51bGw7CiAgICAgICAgdGhpcy5pc19iZ19pbWFnZV9jaGFuZ2VkID0gdHJ1ZTsgLy8gdGhpcy5vbGRfaW1hZ2VfbmFtZV8zID0gbnVsbDsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlucHV0R3JvdXBGaWxlMDMiKS52YWx1ZSA9ICIiOwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZW5lcmF0ZVVVSUQ6IGZ1bmN0aW9uIGdlbmVyYXRlVVVJRCgpIHsKICAgICAgLy8gUHVibGljIERvbWFpbi9NSVQKICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgLy9UaW1lc3RhbXAKCiAgICAgIHZhciBkMiA9IHBlcmZvcm1hbmNlICYmIHBlcmZvcm1hbmNlLm5vdyAmJiBwZXJmb3JtYW5jZS5ub3coKSAqIDEwMDAgfHwgMDsgLy9UaW1lIGluIG1pY3Jvc2Vjb25kcyBzaW5jZSBwYWdlLWxvYWQgb3IgMCBpZiB1bnN1cHBvcnRlZAoKICAgICAgcmV0dXJuICJ4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgiLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHsKICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAxNjsgLy9yYW5kb20gbnVtYmVyIGJldHdlZW4gMCBhbmQgMTYKCiAgICAgICAgaWYgKGQgPiAwKSB7CiAgICAgICAgICAvL1VzZSB0aW1lc3RhbXAgdW50aWwgZGVwbGV0ZWQKICAgICAgICAgIHIgPSAoZCArIHIpICUgMTYgfCAwOwogICAgICAgICAgZCA9IE1hdGguZmxvb3IoZCAvIDE2KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy9Vc2UgbWljcm9zZWNvbmRzIHNpbmNlIHBhZ2UtbG9hZCBpZiBzdXBwb3J0ZWQKICAgICAgICAgIHIgPSAoZDIgKyByKSAlIDE2IHwgMDsKICAgICAgICAgIGQyID0gTWF0aC5mbG9vcihkMiAvIDE2KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAoYyA9PT0gIngiID8gciA6IHIgJiAweDMgfCAweDgpLnRvU3RyaW5nKDE2KTsKICAgICAgfSk7CiAgICB9LAogICAgdHJpbV9tb2RlbF9uYW1lOiBmdW5jdGlvbiB0cmltX21vZGVsX25hbWUodmFsMSkgewogICAgICBpZiAodmFsMS5sZW5ndGggPiA2KSB7CiAgICAgICAgdmFyIHN0cjEgPSB2YWwxLnN1YnN0cmluZygwLCAzKSArICIuLi4iOwogICAgICAgIHJldHVybiBzdHIxOwogICAgICB9CgogICAgICByZXR1cm4gdmFsMTsKICAgIH0sCiAgICBsb2FkX3Byb2R1Y3Rfc2V0dGluZ3M6IGZ1bmN0aW9uIGxvYWRfcHJvZHVjdF9zZXR0aW5ncygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmJpZ19zcGlubmVyID0gdHJ1ZTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMucHJvZHVjdF9zZXR0aW5ncygpLCB7CiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAgICAgaXNfbm9uX3JldGFpbDogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMyLmJpZ19zcGlubmVyID0gZmFsc2U7CgogICAgICAgIGlmIChyZXNwb25zZS5kYXRhICE9ICIiICYmIHJlc3BvbnNlLmRhdGEgIT0gbnVsbCAmJiByZXNwb25zZS5kYXRhICE9ICJJbnRlcm5hbCBzZXJ2ZXIgRXJyb3IiKSB7CiAgICAgICAgICBfdGhpczIuY29udGFjdF91c19lbWFpbCA9IHJlc3BvbnNlLmRhdGEuZGV0YWlscy5jb250YWN0X2hlbHBfZW1haWw7CiAgICAgICAgICBfdGhpczIuY29udGFjdF91c19waG9uZV9udW1iZXIgPSByZXNwb25zZS5kYXRhLmRldGFpbHMuY29udGFjdF91c19waG9uZV9udW1iZXI7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMi5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgIHRvYXN0ci5lcnJvcigiU29tZSBFcnJvciBPY2N1cnJlZC4iKTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczIuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBnZXRfY29tcGFueV9sb2dvOiBmdW5jdGlvbiBnZXRfY29tcGFueV9sb2dvKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnVwbG9hZF9jb21wYW55X2xvZ28oKSwgewogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgaXNfZ2V0OiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczMuZmlsZV9sYWJlbCA9IHJlc3BvbnNlLmRhdGEuY29tcGFueV9pbWFnZV91cmwuc3BsaXQoIi8iKS5yZXZlcnNlKClbMF07CiAgICAgICAgX3RoaXMzLmZpbGVfbGFiZWwgPSBkZWNvZGVVUkkoX3RoaXMzLmZpbGVfbGFiZWwpOwogICAgICAgIF90aGlzMy5vbGRfaW1hZ2VfbmFtZSA9IF90aGlzMy5maWxlX2xhYmVsOwoKICAgICAgICBpZiAoX3RoaXMzLmZpbGVfbGFiZWwgPT0gIiIpIHsKICAgICAgICAgIF90aGlzMy5maWxlX2xhYmVsID0gIkNob29zZSBmaWxlIjsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgX3RoaXMzLmZpbGVfbGFiZWwgPSAiQ2hvb3NlIGZpbGUiOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnB1dF9jb21wYW55X2ZpbGUiKS52YWx1ZSA9ICIiOwoKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzMy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHVwbG9hZF9jb21wYW55X2xvZ29fZmlsZTogZnVuY3Rpb24gdXBsb2FkX2NvbXBhbnlfbG9nb19maWxlKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmZpbGVfbGFiZWwgPT0gdGhpcy5vbGRfaW1hZ2VfbmFtZSB8fCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5wdXRfY29tcGFueV9maWxlIikudmFsdWUgPT0gIiIpIHsKICAgICAgICBzd2FsKHsKICAgICAgICAgIHRleHQ6ICJQbGVhc2UgU2VsZWN0IGEgRmlsZSIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gdHJ1ZTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy51cGxvYWRfY29tcGFueV9sb2dvKCksIHsKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIGltYWdlX25hbWU6IHRoaXMuZmlsZV9sYWJlbCwKICAgICAgICAgIGNvbXBhbnlfbG9nb19maWxlOiB0aGlzLmltYWdlX2ZpbGUsCiAgICAgICAgICBpc19pbWFnZV9lZGl0OiB0aGlzLmZpbGVfbGFiZWwgIT0gdGhpcy5vbGRfaW1hZ2VfbmFtZSA/IHRydWUgOiBmYWxzZSwKICAgICAgICAgIG9sZF9pbWFnZV9uYW1lOiB0aGlzLm9sZF9pbWFnZV9uYW1lID09ICJDaG9vc2UgRmlsZSIgPyBudWxsIDogdGhpcy5vbGRfaW1hZ2VfbmFtZQogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXM0LmJpZ19zcGlubmVyID0gZmFsc2U7CgogICAgICAgICAgX3RoaXM0LmdldF9jb21wYW55X2xvZ28oKTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5NU0cgPT0gIkR1cGxpY2F0ZSBpbWFnZSIpIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlucHV0X2NvbXBhbnlfZmlsZSIpLnZhbHVlID0gIiI7IC8vIHRvYXN0ci5lcnJvcigKICAgICAgICAgICAgLy8gICAiSW1hZ2UgYWxyZWFkeSBmb3VuZC4gUGxlYXNlIHVwbG9hZCBhbm90aGVyIGltYWdlIG9yIHJlbmFtZSBpdC4iCiAgICAgICAgICAgIC8vICk7CgogICAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiAiSW1hZ2UgYWxyZWFkeSBmb3VuZC4gUGxlYXNlIHVwbG9hZCBhbm90aGVyIGltYWdlIG9yIHJlbmFtZSBpdC4iLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgdGltZXI6IDMwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuTVNHID09ICJDb21wYW55IExvZ28gVXBsb2FkZWQgU3VjY2Vzc2Z1bGx5IikgewogICAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiAiQ29tcGFueSBMb2dvIGhhdmUgYmVlbiBVcGxvYWRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnB1dF9jb21wYW55X2ZpbGUiKS52YWx1ZSA9ICIiOwogICAgICAgICAgICBzd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiAiU29tZSBFcnJvciBPY2N1cnJlZC4gUGxlYXNlIFRyeSBBZ2FpbiIsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgIHRleHQ6ICJTb21lIEVycm9yIE9jY3VycmVkLiBQbGVhc2UgVHJ5IEFnYWluIiwKICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgIH0pOwoKICAgICAgICAgIF90aGlzNC5nZXRfY29tcGFueV9sb2dvKCk7CgogICAgICAgICAgX3RoaXM0LmJpZ19zcGlubmVyID0gZmFsc2U7CgogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzNC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNvbmZpZ3VyZV9wcm9kdWN0X3NldHRpbmdzOiBmdW5jdGlvbiBjb25maWd1cmVfcHJvZHVjdF9zZXR0aW5ncygpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgaWYgKHRoaXMudmFsaWRFbWFpbCAhPSB0cnVlKSB7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgRW1haWwgQWRkcmVzcyIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0aW1lcjogMzAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCFCb29sZWFuKHRoaXMucGhvbmVOdW1iZXIpKSB7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgUGhvbmUgTnVtYmVyIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRpbWVyOiAzMDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMucGhvbmVOdW1iZXIuaXNWYWxpZCAhPSB0cnVlKSB7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgUGhvbmUgTnVtYmVyIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRpbWVyOiAzMDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmJpZ19zcGlubmVyID0gdHJ1ZTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMucHJvZHVjdF9zZXR0aW5ncygpLCB7CiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICBpc19lbWFpbF9yZXF1aXJlZDogdHJ1ZSwKICAgICAgICBpc19ub25fcmV0YWlsOiB0cnVlLAogICAgICAgIGVtYWlsX3JlcXVpcmVkOiB7CiAgICAgICAgICBjb250YWN0X2hlbHBfZW1haWw6IHRoaXMuY29udGFjdF91c19lbWFpbCwKICAgICAgICAgIGNvbnRhY3RfdXNfcGhvbmVfbnVtYmVyOiB0aGlzLnBob25lTnVtYmVyLmZvcm1hdHRlZE51bWJlcgogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzNS5iaWdfc3Bpbm5lciA9IGZhbHNlOwoKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PSAiUXVlcnkgRXhlY3V0ZWQgU3VjY2Vzc2Z1bGx5IikgewogICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgIHRleHQ6ICJZb3VyIGNoYW5nZXMgaGF2ZSBiZWVuIHNhdmVkIHN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgdGltZXI6IDQwMDAKICAgICAgICAgIH0pOwoKICAgICAgICAgIF90aGlzNS5lbXB0eV92YXJpYWJsZSgpOwoKICAgICAgICAgIF90aGlzNS5sb2FkX3Byb2R1Y3Rfc2V0dGluZ3MoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3dhbCh7CiAgICAgICAgICAgIHRleHQ6ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNS5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgIHRvYXN0ci5lcnJvcigiU29tZSBFcnJvciBPY2N1cnJlZC4iKTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczUuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBidXR0b25fY2xhc3M6IGZ1bmN0aW9uIGJ1dHRvbl9jbGFzcyhpbmRleCkgewogICAgICBpZiAodGhpcy5tdWx0aXBsZV9sYW5ndWFnZV9saXN0Lmxlbmd0aCAhPSAwKSB7CiAgICAgICAgaWYgKHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdFtpbmRleF0uRW5hYmxlZCA9PSB0cnVlKSB7CiAgICAgICAgICByZXR1cm4gImJ1dHRvbl9lbmFibGVkIjsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdFtpbmRleF0uRW5hYmxlZCA9PSBmYWxzZSkgewogICAgICAgICAgcmV0dXJuICJidXR0b25fZGlzYWJsZWQiOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gImJ1dHRvbl9kaXNhYmxlZCI7CiAgICAgIH0KICAgIH0sCiAgICBtdWx0aXBsZV9sYW5ndWFnZV9zdHlsZTogZnVuY3Rpb24gbXVsdGlwbGVfbGFuZ3VhZ2Vfc3R5bGUoKSB7fSwKICAgIG11bHRpcGxlX2xhbmd1YWdlX2FwaTogZnVuY3Rpb24gbXVsdGlwbGVfbGFuZ3VhZ2VfYXBpKGxhbmd1YWdlLCBpbmRleCkgewogICAgICB2YXIgYnV0dG9uX2NsYXNzOwoKICAgICAgaWYgKGxhbmd1YWdlICE9ICJhbGwiKSB7CiAgICAgICAgYnV0dG9uX2NsYXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobGFuZ3VhZ2UgKyAiX2J1dHRvbiIpLmNsYXNzTGlzdDsKCiAgICAgICAgaWYgKGJ1dHRvbl9jbGFzcy5jb250YWlucygiYnV0dG9uX2Rpc2FibGVkIikpIHsKICAgICAgICAgIGJ1dHRvbl9jbGFzcy5yZW1vdmUoImJ1dHRvbl9kaXNhYmxlZCIpOwogICAgICAgICAgYnV0dG9uX2NsYXNzLmFkZCgiYnV0dG9uX2VuYWJsZWQiKTsKICAgICAgICAgIHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdFtpbmRleF0uRW5hYmxlZCA9IHRydWU7CiAgICAgICAgICB0aGlzLmxhbmd1YWdlX3N1cHBvcnRfYXBpKCk7CiAgICAgICAgfSBlbHNlIGlmIChidXR0b25fY2xhc3MuY29udGFpbnMoImJ1dHRvbl9lbmFibGVkIikpIHsKICAgICAgICAgIGJ1dHRvbl9jbGFzcy5yZW1vdmUoImJ1dHRvbl9lbmFibGVkIik7CiAgICAgICAgICBidXR0b25fY2xhc3MuYWRkKCJidXR0b25fZGlzYWJsZWQiKTsKICAgICAgICAgIHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdFtpbmRleF0uRW5hYmxlZCA9IGZhbHNlOwogICAgICAgICAgdGhpcy5sYW5ndWFnZV9zdXBwb3J0X2FwaSgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChsYW5ndWFnZSA9PSAiYWxsIikgewogICAgICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVuZ2xpc2hfYnV0dG9uIikuY2xhc3NMaXN0LmFkZCgiYnV0dG9uX2VuYWJsZWQiKTsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlbmdsaXNoX2J1dHRvbiIpLmNsYXNzTGlzdC5yZW1vdmUoImJ1dHRvbl9kaXNhYmxlZCIpOwogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhpbmRpX2J1dHRvbiIpLmNsYXNzTGlzdC5hZGQoImJ1dHRvbl9lbmFibGVkIik7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGluZGlfYnV0dG9uIikuY2xhc3NMaXN0LnJlbW92ZSgiYnV0dG9uX2Rpc2FibGVkIik7CgogICAgICAgICAgaWYgKHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdFswXS5FbmFibGVkICYmIHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdFsxXS5FbmFibGVkKSB7fSBlbHNlIHsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3QpIHsKICAgICAgICAgICAgICB0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbaV0uRW5hYmxlZCA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2Vfc3VwcG9ydF9hcGkoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKCFldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVuZ2xpc2hfYnV0dG9uIikuY2xhc3NMaXN0LnJlbW92ZSgiYnV0dG9uX2VuYWJsZWQiKTsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlbmdsaXNoX2J1dHRvbiIpLmNsYXNzTGlzdC5hZGQoImJ1dHRvbl9kaXNhYmxlZCIpOwogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhpbmRpX2J1dHRvbiIpLmNsYXNzTGlzdC5yZW1vdmUoImJ1dHRvbl9lbmFibGVkIik7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGluZGlfYnV0dG9uIikuY2xhc3NMaXN0LmFkZCgiYnV0dG9uX2Rpc2FibGVkIik7CgogICAgICAgICAgaWYgKCF0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbMF0uRW5hYmxlZCAmJiAhdGhpcy5tdWx0aXBsZV9sYW5ndWFnZV9saXN0WzFdLkVuYWJsZWQpIHt9IGVsc2UgewogICAgICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdCkgewogICAgICAgICAgICAgIHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdFtpXS5FbmFibGVkID0gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2Vfc3VwcG9ydF9hcGkoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzZWxlY3RfdHJhaW5lZF9kaWFsb2d1ZV9tb2RlbDogZnVuY3Rpb24gc2VsZWN0X3RyYWluZWRfZGlhbG9ndWVfbW9kZWwoaW5kZXgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuZGlzYWJsZV9idG5fZXhwaXJlZCkgewogICAgICAgIHZhciBjYWxsX2FwaSA9IHRydWU7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFpbmVkX2RpYWxvZ3VlX21vZGVscy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMudHJhaW5lZF9kaWFsb2d1ZV9tb2RlbHNbaW5kZXhdLmFjdGl2ZSkgewogICAgICAgICAgICBjYWxsX2FwaSA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChjYWxsX2FwaSkgewogICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgdGl0bGU6ICJBcmUgeW91IHN1cmU/IiwKICAgICAgICAgICAgdGV4dDogIkRvIHlvdSB3YW50IHRvIHNldCAiICsgdGhpcy5jb21wYW55bmFtZSArICIgViIgKyAodGhpcy50cmFpbmVkX2RpYWxvZ3VlX21vZGVscy5sZW5ndGggLSBpbmRleCkgKyAiIGFzIHlvdXIgY3VycmVudCB0cmFpbmVkIG1vZGVsID8iLAogICAgICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIENvbmZpcm0hIiwKICAgICAgICAgICAgYWxsb3dPdXRzaWRlQ2xpY2s6IGZhbHNlLAogICAgICAgICAgICBhbGxvd0VzY2FwZUtleTogZmFsc2UKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgICAgX3RoaXM2LnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICAgICAgX3RoaXM2LmJpZ19zcGlubmVyID0gdHJ1ZTsgLy8gU3dhbC5maXJlKHsKICAgICAgICAgICAgICAvLyAgIHRleHQ6ICJQbGVhc2Ugd2FpdCB3aGlsZSB3ZSBzdWJtaXQgeW91ciByZXF1ZXN0IiwKICAgICAgICAgICAgICAvLyAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIC8vICAgdHlwZTogImluZm8iLAogICAgICAgICAgICAgIC8vICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgLy8gICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgLy8gfSk7CgogICAgICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnJldmVydF9tb2RlbHMoKSwgewogICAgICAgICAgICAgICAgZW1haWw6IF90aGlzNi4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IF90aGlzNi4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgdG9rZW46IF90aGlzNi4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogX3RoaXM2LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uLAogICAgICAgICAgICAgICAgY29tcGFueV9kZXRhaWxzOiB7CiAgICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IF90aGlzNi4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogX3RoaXM2LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbW9kZWxfZmlsZTogX3RoaXM2LnRyYWluZWRfZGlhbG9ndWVfbW9kZWxzW2luZGV4XS5GaWxlTmFtZQogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChfdGhpczYuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICBfdGhpczYuYmlnX3NwaW5uZXIgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09ICJTdWNjZXNzIikgewogICAgICAgICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiTW9kZWwgVXBkYXRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgYWxsb3dFc2NhcGVLZXk6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiAyMDAwCiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdF9zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdF9zdWNjZXNzLnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuYmlnX3NwaW5uZXIgPSB0cnVlOwoKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNi5nZXRfdHJhaW5lZF9kaWFsb2d1ZV9tb2RlbHMoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogIlNvbWUgRXJyb3IgT2NjdXJyZWQsIFBsZWFzZSBUcnkgQWdhaW4hIiwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSAvLyBjb25zb2xlLmxvZyhyZXNwb25zZSk7CgogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBfdGhpczYuYmlnX3NwaW5uZXIgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM2LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwodHJ1ZSk7CiAgICAgIH0KICAgIH0sCiAgICBzZWxlY3RfdHJhaW5lZF9pbnRlbnRfbW9kZWw6IGZ1bmN0aW9uIHNlbGVjdF90cmFpbmVkX2ludGVudF9tb2RlbChpbmRleCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5kaXNhYmxlX2J0bl9leHBpcmVkKSB7CiAgICAgICAgdmFyIGNhbGxfYXBpID0gdHJ1ZTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRyYWluZWRfaW50ZW50X21vZGVscy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMudHJhaW5lZF9pbnRlbnRfbW9kZWxzW2luZGV4XS5hY3RpdmUpIHsKICAgICAgICAgICAgY2FsbF9hcGkgPSBmYWxzZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoY2FsbF9hcGkpIHsKICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgICAgIHRleHQ6ICJEbyB5b3Ugd2FudCB0byBzZXQgIiArIHRoaXMuY29tcGFueW5hbWUgKyAiIFYiICsgKHRoaXMudHJhaW5lZF9pbnRlbnRfbW9kZWxzLmxlbmd0aCAtIGluZGV4KSArICIgYXMgeW91ciBjdXJyZW50IHRyYWluZWQgbW9kZWwgPyIsCiAgICAgICAgICAgIHR5cGU6ICJxdWVzdGlvbiIsCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgQ29uZmlybSEiLAogICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgIGFsbG93RXNjYXBlS2V5OiBmYWxzZQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgICBfdGhpczcuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICAgICAgICBfdGhpczcuYmlnX3NwaW5uZXIgPSB0cnVlOyAvLyBTd2FsLmZpcmUoewogICAgICAgICAgICAgIC8vICAgdGV4dDogIlBsZWFzZSB3YWl0IHdoaWxlIHdlIHN1Ym1pdCB5b3VyIHJlcXVlc3QiLAogICAgICAgICAgICAgIC8vICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgLy8gICB0eXBlOiAiaW5mbyIsCiAgICAgICAgICAgICAgLy8gICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAvLyAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAvLyB9KTsKCiAgICAgICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMudHJhaW5faW50ZW50X21vZGVsKCksIHsKICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogX3RoaXM3LmNvbXBhbnluYW1lLAogICAgICAgICAgICAgICAgY29tcGFueV9pZDogX3RoaXM3LmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgIGVtYWlsOiBfdGhpczcuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiBfdGhpczcuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgIHRva2VuOiBfdGhpczcuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICBGaWxlTmFtZTogX3RoaXM3LnRyYWluZWRfaW50ZW50X21vZGVsc1tpbmRleF0uRmlsZU5hbWUsCiAgICAgICAgICAgICAgICBpc0NoYW5nZU1vZGVsVmVyc2lvbjogdHJ1ZQogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChfdGhpczcuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICBfdGhpczcuYmlnX3NwaW5uZXIgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09ICJTdWNjZXNzIikgewogICAgICAgICAgICAgICAgICBfdGhpczcuZ2V0X3RyYWluZWRfaW50ZW50X21vZGVscygpOwoKICAgICAgICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogIk1vZGVsIFVwZGF0ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgYWxsb3dPdXRzaWRlQ2xpY2s6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGFsbG93RXNjYXBlS2V5OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICJTb21lIEVycm9yIE9jY3VycmVkLCBQbGVhc2UgVHJ5IEFnYWluISIsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gLy8gY29uc29sZS5sb2cocmVzcG9uc2UpOwoKICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgX3RoaXM3LmJpZ19zcGlubmVyID0gZmFsc2U7CgogICAgICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsKHRydWUpOwogICAgICB9CiAgICB9LAogICAgc2VsZWN0X3RyYWluZWRfbmVyX21vZGVsOiBmdW5jdGlvbiBzZWxlY3RfdHJhaW5lZF9uZXJfbW9kZWwoaW5kZXgpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuZGlzYWJsZV9idG5fZXhwaXJlZCkgewogICAgICAgIHZhciBjYWxsX2FwaSA9IHRydWU7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFpbmVkX25lcl9tb2RlbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmICh0aGlzLnRyYWluZWRfbmVyX21vZGVsc1tpbmRleF0uYWN0aXZlKSB7CiAgICAgICAgICAgIGNhbGxfYXBpID0gZmFsc2U7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGNhbGxfYXBpKSB7CiAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgICAgICB0ZXh0OiAiRG8geW91IHdhbnQgdG8gc2V0ICIgKyB0aGlzLmNvbXBhbnluYW1lICsgIiBWIiArICh0aGlzLnRyYWluZWRfbmVyX21vZGVscy5sZW5ndGggLSBpbmRleCkgKyAiIGFzIHlvdXIgY3VycmVudCB0cmFpbmVkIG1vZGVsID8iLAogICAgICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIENvbmZpcm0hIiwKICAgICAgICAgICAgYWxsb3dPdXRzaWRlQ2xpY2s6IGZhbHNlLAogICAgICAgICAgICBhbGxvd0VzY2FwZUtleTogZmFsc2UKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgICAgX3RoaXM4LnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgICAgICAgX3RoaXM4LmJpZ19zcGlubmVyID0gdHJ1ZTsgLy8gU3dhbC5maXJlKHsKICAgICAgICAgICAgICAvLyAgIHRleHQ6ICJQbGVhc2Ugd2FpdCB3aGlsZSB3ZSBzdWJtaXQgeW91ciByZXF1ZXN0IiwKICAgICAgICAgICAgICAvLyAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIC8vICAgdHlwZTogImluZm8iLAogICAgICAgICAgICAgIC8vICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgLy8gICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgLy8gfSk7CgogICAgICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnJldmVydF9uZXJfbW9kZWxzKCksIHsKICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogX3RoaXM4LmNvbXBhbnluYW1lLAogICAgICAgICAgICAgICAgY29tcGFueV9pZDogX3RoaXM4LmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgIGVtYWlsOiBfdGhpczguJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiBfdGhpczguJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgICAgIHRva2VuOiBfdGhpczguJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICBjb21wYW55X2RldGFpbHM6IHsKICAgICAgICAgICAgICAgICAgY29tcGFueV9pZDogX3RoaXM4LmNvbXBhbnlpZCwKICAgICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiBfdGhpczguY29tcGFueW5hbWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBtb2RlbF9maWxlOiBfdGhpczgudHJhaW5lZF9uZXJfbW9kZWxzW2luZGV4XS5GaWxlTmFtZQogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChfdGhpczguJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICBfdGhpczguYmlnX3NwaW5uZXIgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PT0gIlJldmVydCBTdWNjZXNzZnVsIikgewogICAgICAgICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiTW9kZWwgVXBkYXRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgYWxsb3dFc2NhcGVLZXk6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiAyMDAwCiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdF9zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHJlc3VsdF9zdWNjZXNzLnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM4LmJpZ19zcGlubmVyID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXM4LmdldF90cmFpbmVkX25lcl9tb2RlbHMoKTsgLy8gfQoKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiU29tZSBFcnJvciBPY2N1cnJlZCwgUGxlYXNlIFRyeSBBZ2FpbiEiLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKCiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIF90aGlzOC5iaWdfc3Bpbm5lciA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICAgICAgICBfdGhpczguJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNob3dfc3Vic2NyaXB0aW9uX2V4cGlyZWRfc3dhbCh0cnVlKTsKICAgICAgfQogICAgfSwKICAgIGdldF90cmFpbmVkX2RpYWxvZ3VlX21vZGVsczogZnVuY3Rpb24gZ2V0X3RyYWluZWRfZGlhbG9ndWVfbW9kZWxzKCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy51c2VfbW9kZWwoKSwgewogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgaXNTaG93OiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAoX3JlZikgewogICAgICAgIHZhciBkYXRhID0gX3JlZi5kYXRhOwogICAgICAgIF90aGlzOS5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgIF90aGlzOS50cmFpbmVkX2RpYWxvZ3VlX21vZGVscyA9IGRhdGEubW9kZWxzLm1hcChmdW5jdGlvbiAobW9kZWwpIHsKICAgICAgICAgIG1vZGVsLmNyZWF0ZWRfYXQgPSBtb21lbnQudW5peChtb2RlbC5jcmVhdGVkX2F0KS5mb3JtYXQoIkRvIE1NTSBZWSIpOwogICAgICAgICAgcmV0dXJuIG1vZGVsOwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgIF90aGlzOS5iaWdfc3Bpbm5lciA9IGZhbHNlOwoKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzOS4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdldF90cmFpbmVkX25lcl9tb2RlbHM6IGZ1bmN0aW9uIGdldF90cmFpbmVkX25lcl9tb2RlbHMoKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgICBheGlvcy5nZXQoYXBpX2NhbGxzLnJldmVydF9uZXJfbW9kZWxzKCksIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIHJldmVydF9jb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIHJldmVydF9jb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBpc1Nob3c6IHRydWUKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICB2YXIgZGF0YSA9IF9yZWYyLmRhdGE7CiAgICAgICAgX3RoaXMxMC5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgIF90aGlzMTAudHJhaW5lZF9uZXJfbW9kZWxzID0gZGF0YS5tb2RlbF9kYXRhLm1hcChmdW5jdGlvbiAobW9kZWwpIHsKICAgICAgICAgIG1vZGVsLmNyZWF0ZWRfYXQgPSBtb21lbnQobW9kZWwuY3JlYXRlZF9hdCwgIllZWVlNTURESEhtbXNzIikuZm9ybWF0KCJEbyBNTU0gWVkiKTsKICAgICAgICAgIHJldHVybiBtb2RlbDsKICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICBfdGhpczEwLmJpZ19zcGlubmVyID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXMxMC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdldF90cmFpbmVkX2ludGVudF9tb2RlbHM6IGZ1bmN0aW9uIGdldF90cmFpbmVkX2ludGVudF9tb2RlbHMoKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy50cmFpbl9pbnRlbnRfbW9kZWwoKSwgewogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgaXNHZXRNb2RlbHM6IHRydWUKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgIHZhciBkYXRhID0gX3JlZjMuZGF0YTsKICAgICAgICBfdGhpczExLmJpZ19zcGlubmVyID0gZmFsc2U7IC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEpOwoKICAgICAgICBfdGhpczExLnRyYWluZWRfaW50ZW50X21vZGVscyA9IGRhdGEubW9kZWxzLm1hcChmdW5jdGlvbiAobW9kZWwpIHsKICAgICAgICAgIG1vZGVsLmNyZWF0ZWRfYXQgPSBtb21lbnQobW9kZWwuY3JlYXRlZF9hdCwgIllZWVlNTURESEhtbXNzIikuZm9ybWF0KCJEbyBNTU0gWVkiKTsKICAgICAgICAgIHJldHVybiBtb2RlbDsKICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICBfdGhpczExLmJpZ19zcGlubmVyID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXMxMS4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIGFkZF9tYWlsKCkgewogICAgLy8gICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgLy8gICBheGlvcwogICAgLy8gICAgIC5wb3N0KAogICAgLy8gICAgICAgYXBpX2NhbGxzLm5vdGlmeV9zdXBlcmFkbWluX3VybCgpLAogICAgLy8gICAgICAgewogICAgLy8gICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgIC8vICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgIC8vICAgICAgICAgc2VuZHRvOiB0aGlzLnNlbmRlciwKICAgIC8vICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgIC8vICAgICAgICAgYm9keTogdGhpcy5lbWFpbF9ib2R5LAogICAgLy8gICAgICAgICBzdWJqZWN0OiB0aGlzLnN1YmplY3QsCiAgICAvLyAgICAgICAgIGJpbmRlbWFpbDogIkZhbHNlIiwKICAgIC8vICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgIC8vICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMKICAgIC8vICAgICAgIH0sCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGhlYWRlcnM6IHsKICAgIC8vICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YAogICAgLy8gICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgKQogICAgLy8gICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgIC8vICAgICAgIHRvYXN0ci5zdWNjZXNzKHJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgIH0pCiAgICAvLyAgICAgLmNhdGNoKGUgPT4gewogICAgLy8gICAgICAgaWYgKAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgLy8gICAgICAgKSB7CiAgICAvLyAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgbGFuZ3VhZ2Vfc3VwcG9ydF9hcGk6IGZ1bmN0aW9uIGxhbmd1YWdlX3N1cHBvcnRfYXBpKCkgewogICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7CgogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5tdWx0aXBsZV9sYW5ndWFnZV9zdXBwb3J0X3VybCgpLCB7CiAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgbGFuZ3VhZ2Vfc3VwcG9ydDogdGhpcy5tdWx0aXBsZV9sYW5ndWFnZV9saXN0CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIlF1ZXJ5IEV4ZWN1dGVkIFN1Y2Nlc3NmdWxseSIpIHt9IGVsc2UgewogICAgICAgICAgX3RoaXMxMi4kcm91dGVyLmdvKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBmaWxlaW5wdXQ6IGZ1bmN0aW9uIGZpbGVpbnB1dChlKSB7CiAgICAgIHZhciBmaWxlcyA9IGUudGFyZ2V0LmZpbGVzIHx8IGUuZGF0YVRyYW5zZmVyLmZpbGVzOwoKICAgICAgaWYgKGZpbGVzWzBdLnNpemUgPiAyMDk3MTUyKSB7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiAiVXBsb2FkIGNvbXBhbnkgbG9nbyB3aXRoIHNpemUgbGVzcyB0aGFuIDJNQiIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDEwMDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoZmlsZXNbMF0udHlwZSA9PT0gImltYWdlL3BuZyIgfHwgZmlsZXNbMF0udHlwZSA9PT0gImltYWdlL2pwZWciKSB7CiAgICAgICAgaWYgKCFmaWxlcy5sZW5ndGgpIHJldHVybjsKICAgICAgICB0aGlzLm9sZF9pbWFnZV9uYW1lID0gdGhpcy5maWxlX2xhYmVsOwogICAgICAgIHRoaXMuZmlsZV9sYWJlbCA9IGZpbGVzWzBdLm5hbWU7CiAgICAgICAgdGhpcy5jcmVhdGVJbWFnZShmaWxlc1swXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dhbCh7CiAgICAgICAgICB0ZXh0OiAiUGxlYXNlIFNlbGVjdCBhbiBJbWFnZSBvZiB0eXBlIFBORyBvciBKUEVHIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICB0aW1lcjogMjUwMAogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlSW1hZ2U6IGZ1bmN0aW9uIGNyZWF0ZUltYWdlKGZpbGUsIHR5cGUpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczEzLmltYWdlX2ZpbGUgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoImJhc2U2NCwiKVsxXTsKICAgICAgfTsKCiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgfSwKICAgIGRvd25sb2FkX3NkazogZnVuY3Rpb24gZG93bmxvYWRfc2RrKGRhdGFfdHlwZSkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICBpZiAoZGF0YV90eXBlID09ICJsaWNlbnNlX2tleSIpIHsKICAgICAgICB0aGlzLnNwaW5uZXJPbjEgPSB0cnVlOwogICAgICAgIGF4aW9zKHsKICAgICAgICAgIG1ldGhvZDogInBvc3QiLAogICAgICAgICAgdXJsOiBhcGlfY2FsbHMuZ2V0X2xpY2Vuc2Vfa2V5KCksCiAgICAgICAgICByZXNwb25zZVR5cGU6ICJibG9iIiwKICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsCiAgICAgICAgICB9LAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICB2YXIgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3Jlc3BvbnNlLmRhdGFdKSk7CiAgICAgICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsIGRhdGFfdHlwZSArICIudHh0Iik7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgICAgICAgbGluay5jbGljaygpOwogICAgICAgICAgX3RoaXMxNC5zcGlubmVyT24xID0gZmFsc2U7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICBfdGhpczE0LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc3Bpbm5lck9uMiA9IHRydWU7CiAgICAgICAgYXhpb3MoewogICAgICAgICAgbWV0aG9kOiAicG9zdCIsCiAgICAgICAgICB1cmw6IGFwaV9jYWxscy5maWxlX2Rvd25sb2FkX3VybCgpLAogICAgICAgICAgcmVzcG9uc2VUeXBlOiAiYmxvYiIsCiAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgIGRvd25sb2FkX3Nka190eXBlOiBkYXRhX3R5cGUsCiAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbAogICAgICAgICAgfSwKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXMxNC5zcGlubmVyT24yID0gZmFsc2U7CgogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZSA9PSAiTm90IGFibGUgdG8gZG93bmxvYWQgZmlsZSIpIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJEdWUgdG8gc29tZSBpbnRlcm5hbCBlcnJvciwgbm90IGFibGUgdG8gZG93bmxvYWQgdGhlIGZpbGUiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbcmVzcG9uc2UuZGF0YV0pKTsKICAgICAgICAgICAgdmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoImRvd25sb2FkIiwgZGF0YV90eXBlICsgIl9TREsuemlwIik7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgX3RoaXMxNC5zcGlubmVyT24yID0gZmFsc2U7CiAgICAgICAgICB0b2FzdHIuZXJyb3IoIkR1ZSB0byBzb21lIGludGVybmFsIGVycm9yLCBub3QgYWJsZSB0byBkb3dubG9hZCB0aGUgZmlsZSIpOwoKICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICBfdGhpczE0LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY29weV93aWRnZXRfY29kZTogZnVuY3Rpb24gY29weV93aWRnZXRfY29kZSgpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgdGhpcy4kcmVmcy53aWRnZXRfdGV4dGFyZWEuc2VsZWN0KCk7CiAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCJjb3B5Iik7CiAgICAgICQoIiNjb3B5X2NvZGVfdG9vbHRpcCIpLnRvb2x0aXAoInNob3ciKTsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgJCgiI2NvcHlfY29kZV90b29sdGlwIikudG9vbHRpcCgiZGlzcG9zZSIpOwoKICAgICAgICBfdGhpczE1LmluaXRpYWxpemVfdG9vbHRpcHMoKTsKICAgICAgfSwgNTAwMCk7CiAgICB9LAogICAgY29weV91dWlkX2NvZGU6IGZ1bmN0aW9uIGNvcHlfdXVpZF9jb2RlKCkgewogICAgICB2YXIgX3RoaXMxNiA9IHRoaXM7CgogICAgICB0aGlzLiRyZWZzLnV1aWRfdGV4dGFyZWExLnNlbGVjdCgpOwogICAgICB0aGlzLiRyZWZzLnV1aWRfdGV4dGFyZWEyLnNlbGVjdCgpOwogICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgiY29weSIpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCIjY29weV9jb2RlX3Rvb2x0aXAiKS50b29sdGlwKCJkaXNwb3NlIik7CgogICAgICAgIF90aGlzMTYuaW5pdGlhbGl6ZV90b29sdGlwcygpOwogICAgICB9LCA1MDAwKTsKICAgIH0sCiAgICBpbml0aWFsaXplX3Rvb2x0aXBzOiBmdW5jdGlvbiBpbml0aWFsaXplX3Rvb2x0aXBzKCkgewogICAgICAkKCdbZGF0YS10b29sdGlwPSJ0b29sdGlwIl0nKS50b29sdGlwKHsKICAgICAgICB0cmlnZ2VyOiAibWFudWFsIgogICAgICB9KTsKICAgIH0sCiAgICBjb3B5X2xpY2Vuc2Vfa2V5OiBmdW5jdGlvbiBjb3B5X2xpY2Vuc2Vfa2V5KCkgewogICAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CgogICAgICB0aGlzLiRyZWZzLmxpY2Vuc2Vfa2V5X3RleHRhcmVhLnNlbGVjdCgpOwogICAgICB0aGlzLiRyZWZzLmxpY2Vuc2Vfa2V5X3RleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKDAsIDk5OTk5KTsKICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoImNvcHkiKTsKICAgICAgJCgiI2NvcHlfbGljbnNlX2tleV90b29sdGlwIikudG9vbHRpcCgic2hvdyIpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCIjY29weV9saWNuc2Vfa2V5X3Rvb2x0aXAiKS50b29sdGlwKCJkaXNwb3NlIik7CgogICAgICAgIF90aGlzMTcuaW5pdGlhbGl6ZV90b29sdGlwcygpOwogICAgICB9LCA1MDAwKTsKICAgIH0sCiAgICBlbXB0eV92YXJpYWJsZTogZnVuY3Rpb24gZW1wdHlfdmFyaWFibGUoKSB7fQogIH0KfTs="},null]}