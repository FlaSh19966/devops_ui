{"remainingRequest":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js!/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/ConversationalFlow/Dialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/ConversationalFlow/Dialog.vue","mtime":1663910265454},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIi9ob21lL3ZpbWFsZXNoL0xlYXJuaW5nL2Rldm9wc191aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIi9ob21lL3ZpbWFsZXNoL0xlYXJuaW5nL2Rldm9wc191aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLyBpbXBvcnQgeyBUcmVlLCBUcmVlTm9kZSB9IGZyb20gInZ1ZS10cmVlLWxpc3QiOwppbXBvcnQgeyBWdWVUcmVlTGlzdCwgVHJlZSwgVHJlZU5vZGUgfSBmcm9tICIuLi8uLi8uLi8uLi8uLi9wdWJsaWMvanMvdnVlLXRyZWUtbGlzdC51bWQubWluLmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwppbXBvcnQgU3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7CmltcG9ydCB7IFZ1ZUVkaXRvciB9IGZyb20gInZ1ZTItZWRpdG9yIjsKaW1wb3J0IE11bHRpc2VsZWN0IGZyb20gInZ1ZS1tdWx0aXNlbGVjdCI7CmltcG9ydCBSZXNwb25zZUJvdCBmcm9tICIuLi9EYXRhIElucHV0cy9SZXNwb25zZUJvdCI7CmltcG9ydCBkcmFnZ2FibGUgZnJvbSAidnVlZHJhZ2dhYmxlIjsKaW1wb3J0IHsgZnJlZXplX3BvcnRhbCwgc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsLCBjbG9zZV9tb2RhbCB9IGZyb20gIkAvcG9ydGFsL21peGlucyI7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBWdWVUcmVlTGlzdDogVnVlVHJlZUxpc3QsCiAgICBWdWVFZGl0b3I6IFZ1ZUVkaXRvciwKICAgIE11bHRpc2VsZWN0OiBNdWx0aXNlbGVjdCwKICAgIFJlc3BvbnNlQm90OiBSZXNwb25zZUJvdCwKICAgIGRyYWdnYWJsZTogZHJhZ2dhYmxlCiAgfSwKICBuYW1lOiAiZGlhbG9nX2NvbXBvbmVudCIsCiAgbWl4aW5zOiBbZnJlZXplX3BvcnRhbCwgc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsLCBjbG9zZV9tb2RhbF0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNlbGVjdGVkX2VudGl0eTogIiIsCiAgICAgIHVwZGF0ZWRfbm9kZV9saXN0OiAiIiwKICAgICAgc3Bpbm5lck9uOiBmYWxzZSwKICAgICAgYnV0dG9uX3R5cGVfbGlzdDogW3sKICAgICAgICB2YWx1ZTogInBvc3RiYWNrIiwKICAgICAgICBuYW1lOiAiUG9zdGJhY2siCiAgICAgIH0sIHsKICAgICAgICB2YWx1ZTogIndlYl91cmwiLAogICAgICAgIG5hbWU6ICJVUkwiCiAgICAgIH1dLAogICAgICBhc3Npc3RhbmNlX3Jlc3BvbnNlX2lkOiAwLAogICAgICBhc3Npc3RhbmNlX3Jlc3BvbnNlX192YWxfaW5kZXg6IDAsCiAgICAgIG1hbmFnZV9oYW5kbGVyc19pbmQ6IDAsCiAgICAgIG1hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlX2lkOiAwLAogICAgICBtYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV9fdmFsX2luZGV4OiAwLAogICAgICBzbG90X3ZhcmlhYmxlOiBbXSwKICAgICAgZmlsdGVyZWRfYXNzaXN0YW50X3Jlc3BvbnNlOiBbXSwKICAgICAgcmVnX3VybDogL2h0dHBzOlwvXC9bKHd3d1wuKT9hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn1cLlthLXpdezIsNn1cYihbLWEtekEtWjAtOUA6JV9cKy5+Iz8mXC9cLz1dKikvaSwKICAgICAgcmVnX2ltYWdlOiAvKGh0dHBzOlwvXC8pKFteXHMoWyI8LD4vXSopKFwvKVteXHNbIiw+PF0qKC5wbmd8LmpwZ3wuanBlZ3wuZ2lmKShcP1teXHNbIiw+PF0qKT8vLAogICAgICBuZXdUcmVlOiB7fSwKICAgICAgbm9kZXNfbGlzdDogW10sCiAgICAgIGRhdGE6IG5ldyBUcmVlKFtdKSwKICAgICAgbG9hZF9ib3RfcHJldmlldzogZmFsc2UsCiAgICAgIGRyYWdfc2xvdHM6IGZhbHNlLAogICAgICAvLyB0ZXN0X3Jlc3BvbnNlX3RyZWU6IFsKICAgICAgLy8gICB7CiAgICAgIC8vICAgICBpZDogMTYyMzY2OTAxNDMwNywKICAgICAgLy8gICAgIGlzX2xlYWY6IGZhbHNlLAogICAgICAvLyAgICAgZWRpdE5vZGVEaXNhYmxlZDogdHJ1ZSwKICAgICAgLy8gICAgIG5hbWU6ICJIZWxsbyIsCiAgICAgIC8vICAgICBuZXh0X3N0ZXA6IHsKICAgICAgLy8gICAgICAgYmVoYXZpb3I6ICJ3YWl0X2Zvcl9yZXBseSIsCiAgICAgIC8vICAgICAgIG5vZGVfaWQ6IG51bGwsCiAgICAgIC8vICAgICAgIHNlbGVjdG9yOiAid2FpdF9mb3JfdXNlcl9pbnB1dCIsCiAgICAgIC8vICAgICB9LAogICAgICAvLyAgICAgcGlkOiAwLAogICAgICAvLyAgICAgcmVzcG9uc2VzOiBbCiAgICAgIC8vICAgICAgIHsKICAgICAgLy8gICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgIGlkOiAwLAogICAgICAvLyAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgIC8vICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAvLyAgICAgICAgIHZhbHVlczogWyJIZXl5YSJdLAogICAgICAvLyAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgIC8vICAgICAgIH0sCiAgICAgIC8vICAgICAgIHsKICAgICAgLy8gICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgIGlkOiAxLAogICAgICAvLyAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgIC8vICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAvLyAgICAgICAgIHZhbHVlczogWyJIZXl5YTIiXSwKICAgICAgLy8gICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAvLyAgICAgICB9LAogICAgICAvLyAgICAgXSwKICAgICAgLy8gICAgIHNsb3Rfc2V0dGluZzogZmFsc2UsCiAgICAgIC8vICAgICBzbG90czogW10sCiAgICAgIC8vICAgICB0cmlnZ2VyczogWwogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgdHJpZ2dlcl90eXBlOiAiaW50ZW50IiwKICAgICAgLy8gICAgICAgICB0cmlnZ2VyX3ZhbHVlOiAiaW50ZW50IiwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgIF0sCiAgICAgIC8vICAgICB3ZWJob29rX2lkOiBudWxsLAogICAgICAvLyAgICAgd2ViaG9va19pbnRlZ3JhdGlvbjogZmFsc2UsCiAgICAgIC8vICAgICB3ZWJob29rX21hcHBpbmc6IG51bGwsCiAgICAgIC8vICAgICB3ZWJob29rX3JldHVybl92YXJpYWJsZTogbnVsbCwKICAgICAgLy8gICAgIGNoaWxkcmVuOiBbCiAgICAgIC8vICAgICAgIHsKICAgICAgLy8gICAgICAgICBpZDogMTYyMzY3MDk5OTg3OCwKICAgICAgLy8gICAgICAgICBpc19sZWFmOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBlZGl0Tm9kZURpc2FibGVkOiB0cnVlLAogICAgICAvLyAgICAgICAgIG5hbWU6ICJIZWxsbyBjaGlsZCIsCiAgICAgIC8vICAgICAgICAgbmV4dF9zdGVwOiB7CiAgICAgIC8vICAgICAgICAgICBiZWhhdmlvcjogIndhaXRfZm9yX3JlcGx5IiwKICAgICAgLy8gICAgICAgICAgIG5vZGVfaWQ6IG51bGwsCiAgICAgIC8vICAgICAgICAgICBzZWxlY3RvcjogIndhaXRfZm9yX3VzZXJfaW5wdXQiLAogICAgICAvLyAgICAgICAgIH0sCiAgICAgIC8vICAgICAgICAgcGlkOiAxNjIzNjY5MDE0MzA3LAogICAgICAvLyAgICAgICAgIHJlc3BvbnNlczogWwogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgICAgICBpZDogMCwKICAgICAgLy8gICAgICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgLy8gICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAvLyAgICAgICAgICAgICB2YWx1ZXM6IFsiY2hpbGQiLCAibm9kZSJdLAogICAgICAvLyAgICAgICAgICAgICB2YXJpYXRpb246ICJzZXF1ZW50aWFsIiwKICAgICAgLy8gICAgICAgICAgIH0sCiAgICAgIC8vICAgICAgICAgXSwKICAgICAgLy8gICAgICAgICBzbG90X3NldHRpbmc6IGZhbHNlLAogICAgICAvLyAgICAgICAgIHNsb3RzOiBbXSwKICAgICAgLy8gICAgICAgICB0cmlnZ2VyczogWwogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICB0cmlnZ2VyX3R5cGU6ICJpbnRlbnQiLAogICAgICAvLyAgICAgICAgICAgICB0cmlnZ2VyX3ZhbHVlOiAiaW50ZW50IiwKICAgICAgLy8gICAgICAgICAgIH0sCiAgICAgIC8vICAgICAgICAgXSwKICAgICAgLy8gICAgICAgICB3ZWJob29rX2lkOiBudWxsLAogICAgICAvLyAgICAgICAgIHdlYmhvb2tfaW50ZWdyYXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgIHdlYmhvb2tfbWFwcGluZzogbnVsbCwKICAgICAgLy8gICAgICAgICB3ZWJob29rX3JldHVybl92YXJpYWJsZTogbnVsbCwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgICAgewogICAgICAvLyAgICAgICAgIGlkOiAxNjIzNzMxMDI1NDE0LAogICAgICAvLyAgICAgICAgIGlzX2xlYWY6IGZhbHNlLAogICAgICAvLyAgICAgICAgIGVkaXROb2RlRGlzYWJsZWQ6IHRydWUsCiAgICAgIC8vICAgICAgICAgbmFtZTogImNoaWxkXzIiLAogICAgICAvLyAgICAgICAgIG5leHRfc3RlcDogewogICAgICAvLyAgICAgICAgICAgYmVoYXZpb3I6ICJ3YWl0X2Zvcl9yZXBseSIsCiAgICAgIC8vICAgICAgICAgICBub2RlX2lkOiBudWxsLAogICAgICAvLyAgICAgICAgICAgc2VsZWN0b3I6ICJ3YWl0X2Zvcl91c2VyX2lucHV0IiwKICAgICAgLy8gICAgICAgICB9LAogICAgICAvLyAgICAgICAgIG5vZGVfbmFtZTogImJhc2ljX2NoaWxkXzIiLAogICAgICAvLyAgICAgICAgIG5vZGVfdHlwZTogImJhc2ljIiwKICAgICAgLy8gICAgICAgICBwaWQ6IDE2MjM2NjkwMTQzMDcsCiAgICAgIC8vICAgICAgICAgcmVzcG9uc2VzOiBbCiAgICAgIC8vICAgICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgIC8vICAgICAgICAgICAgIGlkOiAwLAogICAgICAvLyAgICAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAvLyAgICAgICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgIC8vICAgICAgICAgICAgIHZhbHVlczogWyJjaGlsZCIsICJ0ZXh0IHJlc3BvbnNlIl0sCiAgICAgIC8vICAgICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgICAgICBpZDogMSwKICAgICAgLy8gICAgICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgLy8gICAgICAgICAgICAgc291cmNlOiAiZ29vZ2wuY29tIiwKICAgICAgLy8gICAgICAgICAgICAgdHlwZTogImltYWdlIiwKICAgICAgLy8gICAgICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgLy8gICAgICAgICAgIH0sCiAgICAgIC8vICAgICAgICAgXSwKICAgICAgLy8gICAgICAgICBzbG90X3NldHRpbmc6IGZhbHNlLAogICAgICAvLyAgICAgICAgIHNsb3RzOiBbXSwKICAgICAgLy8gICAgICAgICB0cmlnZ2VyczogWwogICAgICAvLyAgICAgICAgICAgewogICAgICAvLyAgICAgICAgICAgICB0cmlnZ2VyX3R5cGU6ICJpbnRlbnQiLAogICAgICAvLyAgICAgICAgICAgICB0cmlnZ2VyX3ZhbHVlOiAiaW50ZW50IiwKICAgICAgLy8gICAgICAgICAgIH0sCiAgICAgIC8vICAgICAgICAgXSwKICAgICAgLy8gICAgICAgICB3ZWJob29rX2lkOiBudWxsLAogICAgICAvLyAgICAgICAgIHdlYmhvb2tfaW50ZWdyYXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgIHdlYmhvb2tfbWFwcGluZzogbnVsbCwKICAgICAgLy8gICAgICAgICB3ZWJob29rX3JldHVybl92YXJpYWJsZTogbnVsbCwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgIF0sCiAgICAgIC8vICAgfSwKICAgICAgLy8gICB7CiAgICAgIC8vICAgICBpZDogMTYyMzY3MDg4MjEzMCwKICAgICAgLy8gICAgIGlzX2xlYWY6IGZhbHNlLAogICAgICAvLyAgICAgZWRpdE5vZGVEaXNhYmxlZDogdHJ1ZSwKICAgICAgLy8gICAgIG5hbWU6ICJXb3JsZCIsCiAgICAgIC8vICAgICBuZXh0X3N0ZXA6IHsKICAgICAgLy8gICAgICAgYmVoYXZpb3I6ICJ3YWl0X2Zvcl9yZXBseSIsCiAgICAgIC8vICAgICAgIG5vZGVfaWQ6IG51bGwsCiAgICAgIC8vICAgICAgIHNlbGVjdG9yOiAid2FpdF9mb3JfdXNlcl9pbnB1dCIsCiAgICAgIC8vICAgICB9LAogICAgICAvLyAgICAgbm9kZV9uYW1lOiAiYmFzaWNfV29ybGQiLAogICAgICAvLyAgICAgbm9kZV90eXBlOiAiYmFzaWMiLAogICAgICAvLyAgICAgcGlkOiAwLAogICAgICAvLyAgICAgcmVzcG9uc2VzOiBbCiAgICAgIC8vICAgICAgIHsKICAgICAgLy8gICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAvLyAgICAgICAgIGlkOiAiMCIsCiAgICAgIC8vICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgLy8gICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgIC8vICAgICAgICAgdmFsdWVzOiBbInRleHQiXSwKICAgICAgLy8gICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAvLyAgICAgICB9LAogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBpZDogIjEiLAogICAgICAvLyAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgIC8vICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAvLyAgICAgICAgIHZhbHVlczogWyJyZXNwIl0sCiAgICAgIC8vICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgIF0sCiAgICAgIC8vICAgICBzbG90X3NldHRpbmc6IGZhbHNlLAogICAgICAvLyAgICAgc2xvdHM6IFtdLAogICAgICAvLyAgICAgdHJpZ2dlcnM6IFsKICAgICAgLy8gICAgICAgewogICAgICAvLyAgICAgICAgIHRyaWdnZXJfdHlwZTogImludGVudCIsCiAgICAgIC8vICAgICAgICAgdHJpZ2dlcl92YWx1ZTogImludGVudCIsCiAgICAgIC8vICAgICAgIH0sCiAgICAgIC8vICAgICBdLAogICAgICAvLyAgICAgd2ViaG9va19pZDogbnVsbCwKICAgICAgLy8gICAgIHdlYmhvb2tfaW50ZWdyYXRpb246IGZhbHNlLAogICAgICAvLyAgICAgd2ViaG9va19tYXBwaW5nOiBudWxsLAogICAgICAvLyAgICAgd2ViaG9va19yZXR1cm5fdmFyaWFibGU6IG51bGwsCiAgICAgIC8vICAgfSwKICAgICAgLy8gICB7CiAgICAgIC8vICAgICBpZDogMTYyMzY3MTIxODk5NiwKICAgICAgLy8gICAgIGlzX2xlYWY6IGZhbHNlLAogICAgICAvLyAgICAgZWRpdE5vZGVEaXNhYmxlZDogdHJ1ZSwKICAgICAgLy8gICAgIG5hbWU6ICJUZXN0IG5vZGUzIiwKICAgICAgLy8gICAgIG5leHRfc3RlcDogewogICAgICAvLyAgICAgICBiZWhhdmlvcjogIndhaXRfZm9yX3JlcGx5IiwKICAgICAgLy8gICAgICAgbm9kZV9pZDogbnVsbCwKICAgICAgLy8gICAgICAgc2VsZWN0b3I6ICJ3YWl0X2Zvcl91c2VyX2lucHV0IiwKICAgICAgLy8gICAgIH0sCiAgICAgIC8vICAgICBwaWQ6IDAsCiAgICAgIC8vICAgICByZXNwb25zZXM6IFsKICAgICAgLy8gICAgICAgewogICAgICAvLyAgICAgICAgIGNvbmRpdGlvbjogInVuZmlsbGVkIiwKICAgICAgLy8gICAgICAgICBpZDogIjAiLAogICAgICAvLyAgICAgICAgIHJlY29nbml6ZXM6ICIkd2ViaG9va19yZXN1bHQiLAogICAgICAvLyAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgLy8gICAgICAgICB2YWx1ZXM6IFsid2ViaG9va192YXJpYWJibGUgcmVzcG9uc2UiXSwKICAgICAgLy8gICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAvLyAgICAgICB9LAogICAgICAvLyAgICAgXSwKICAgICAgLy8gICAgIHNsb3Rfc2V0dGluZzogZmFsc2UsCiAgICAgIC8vICAgICBzbG90czogW10sCiAgICAgIC8vICAgICB0cmlnZ2VyczogWwogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgdHJpZ2dlcl90eXBlOiAiSW50ZW50IiwKICAgICAgLy8gICAgICAgICB0cmlnZ2VyX3ZhbHVlOiAiSW50ZW50IiwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgIF0sCiAgICAgIC8vICAgICB3ZWJob29rX2lkOiAiMSIsCiAgICAgIC8vICAgICB3ZWJob29rX2ludGVncmF0aW9uOiB0cnVlLAogICAgICAvLyAgICAgd2ViaG9va19tYXBwaW5nOiBbCiAgICAgIC8vICAgICAgIHsKICAgICAgLy8gICAgICAgICBrZXk6ICJuYW1lIiwKICAgICAgLy8gICAgICAgICB2YWx1ZTogInZhbHVlIiwKICAgICAgLy8gICAgICAgfSwKICAgICAgLy8gICAgIF0sCiAgICAgIC8vICAgICB3ZWJob29rX3JldHVybl92YXJpYWJsZTogIiR3ZWJob29rX3Jlc3VsdCIsCiAgICAgIC8vICAgICBjaGlsZHJlbjogWwogICAgICAvLyAgICAgICB7CiAgICAgIC8vICAgICAgICAgaWQ6IDE2MjM3MzA4MjcyMDYsCiAgICAgIC8vICAgICAgICAgaXNfbGVhZjogZmFsc2UsCiAgICAgIC8vICAgICAgICAgZWRpdE5vZGVEaXNhYmxlZDogdHJ1ZSwKICAgICAgLy8gICAgICAgICBuYW1lOiAidGVzdCBjaGlsZCBub2RlIiwKICAgICAgLy8gICAgICAgICBuZXh0X3N0ZXA6IHsKICAgICAgLy8gICAgICAgICAgIGJlaGF2aW9yOiAid2FpdF9mb3JfcmVwbHkiLAogICAgICAvLyAgICAgICAgICAgbm9kZV9pZDogbnVsbCwKICAgICAgLy8gICAgICAgICAgIHNlbGVjdG9yOiAid2FpdF9mb3JfdXNlcl9pbnB1dCIsCiAgICAgIC8vICAgICAgICAgfSwKICAgICAgLy8gICAgICAgICBub2RlX25hbWU6ICJiYXNpY190ZXN0IGNoaWxkIG5vZGUiLAogICAgICAvLyAgICAgICAgIG5vZGVfdHlwZTogImJhc2ljIiwKICAgICAgLy8gICAgICAgICBwaWQ6IDE2MjM2NzEyMTg5OTYsCiAgICAgIC8vICAgICAgICAgcmVzcG9uc2VzOiBbCiAgICAgIC8vICAgICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgIC8vICAgICAgICAgICAgIGlkOiAwLAogICAgICAvLyAgICAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAvLyAgICAgICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgIC8vICAgICAgICAgICAgIHZhbHVlczogWyJoZWxsbyJdLAogICAgICAvLyAgICAgICAgICAgICB2YXJpYXRpb246ICJzZXF1ZW50aWFsIiwKICAgICAgLy8gICAgICAgICAgIH0sCiAgICAgIC8vICAgICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgIC8vICAgICAgICAgICAgIGlkOiAxLAogICAgICAvLyAgICAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAvLyAgICAgICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgIC8vICAgICAgICAgICAgIHZhbHVlczogWyJ0ZXh0IiwgInJlc3BvbnNlIl0sCiAgICAgIC8vICAgICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgIF0sCiAgICAgIC8vICAgICAgICAgc2xvdF9zZXR0aW5nOiBmYWxzZSwKICAgICAgLy8gICAgICAgICBzbG90czogW10sCiAgICAgIC8vICAgICAgICAgdHJpZ2dlcnM6IFsKICAgICAgLy8gICAgICAgICAgIHsKICAgICAgLy8gICAgICAgICAgICAgdHJpZ2dlcl90eXBlOiAiSW50ZW50IiwKICAgICAgLy8gICAgICAgICAgICAgdHJpZ2dlcl92YWx1ZTogIkludGVudCIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgIF0sCiAgICAgIC8vICAgICAgICAgd2ViaG9va19pZDogIjEiLAogICAgICAvLyAgICAgICAgIHdlYmhvb2tfaW50ZWdyYXRpb246IHRydWUsCiAgICAgIC8vICAgICAgICAgd2ViaG9va19tYXBwaW5nOiBbCiAgICAgIC8vICAgICAgICAgICB7CiAgICAgIC8vICAgICAgICAgICAgIGtleTogIm5hbWUiLAogICAgICAvLyAgICAgICAgICAgICB2YWx1ZTogIiR2YWx1ZSIsCiAgICAgIC8vICAgICAgICAgICB9LAogICAgICAvLyAgICAgICAgIF0sCiAgICAgIC8vICAgICAgICAgd2ViaG9va19yZXR1cm5fdmFyaWFibGU6ICIkd2ViaG9va19yZXN1bHQiLAogICAgICAvLyAgICAgICB9LAogICAgICAvLyAgICAgXSwKICAgICAgLy8gICB9LAogICAgICAvLyBdLAogICAgICBuZXdfY2hpbGRfbm9kZTogZmFsc2UsCiAgICAgIGNoaWxkX25vZGU6IHt9LAogICAgICBub2RlX2lkOiAiIiwKICAgICAgbm9kZV9uYW1lOiAiIiwKICAgICAgbm9kZV90eXBlOiAiIiwKICAgICAgaXNfcm9vdDogZmFsc2UsCiAgICAgIGFzc2lzdGFudF9yZXNwb25zZTogW10sCiAgICAgIGFzc2lzdGFudF9yZXNwb25zZV90eXBlOiBbInRleHQiLCAiaW1hZ2UiLCAidmlkZW8iLCAiY2hvaWNlcyIsICJjYXJkIl0sCiAgICAgIHNlbGVjdGVkX3Jlc3BvbnNlX3R5cGU6ICJ0ZXh0IiwKICAgICAgcmVzcG9uc2VfdmFyaWF0aW9uOiBbInNlcXVlbnRpYWwiXSwKICAgICAgdHJpZ2dlcnNfZmlsdGVyX2J5X29wdGlvbnM6IFsiaW50ZW50IiwgImVudGl0eSJdLAogICAgICBpbnNlcnRfc2xvdF92YXJpYWJsZV9vcHRpb25zOiBbXSwKICAgICAgZW50aXR5X29wZXJhbmRfb3B0aW9uczogWyJpcyIsICJhbnkiXSwKICAgICAgdHJpZ2dlcnM6IFt7CiAgICAgICAgdHJpZ2dlcl90eXBlOiAiIiwKICAgICAgICB0cmlnZ2VyX3ZhbHVlOiAiIgogICAgICB9XSwKICAgICAgdGhlbl9hc3Npc3RhbnRfc2hvdWxkOiBbIndhaXRfZm9yX3JlcGx5IiwgImp1bXBfdG8iXSwKICAgICAgc2F2ZV90aGVuX2Fzc2lzdGFudF9zaG91bGQ6ICIiLAogICAgICBuZXh0X3N0ZXA6IHt9LAogICAgICBqdW1wX3RvX25vZGVfaWQ6ICIiLAogICAgICBpc19zbG90OiBmYWxzZSwKICAgICAgaXNfd2ViaG9vazogZmFsc2UsCiAgICAgIGlzX25vdGlmaWNhdGlvbjogZmFsc2UsCiAgICAgIHdlYmhvb2tfaWQ6IG51bGwsCiAgICAgIHdlYmhvb2tfbGlzdDogW10sCiAgICAgIGlzX3dlYmhvb2tfZGV0YWlsczogZmFsc2UsCiAgICAgIHdlYmhvb2tfbWFwcGluZzogW10sCiAgICAgIHdlYmhvb2tfdmFyaWFibGU6ICIiLAogICAgICB3ZWJob29rX2Fzc2lzdGFudF9yZXNwb25zZTogW10sCiAgICAgIHNsb3RzOiBbXSwKICAgICAgaXNfdmFsaWRhdGlvbl9lbnRpdHk6IGZhbHNlLAogICAgICB1bmZpbGxlZF9zbG90X2Fzc2lzdGFudF9yZXNwb25zZTogW10sCiAgICAgIHZhbGlkYXRpb25fc2xvdF9hc3Npc3RhbnRfcmVzcG9uc2U6IFtdLAogICAgICBub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF9hc3Npc3RhbnRfcmVzcG9uc2U6IFtdLAogICAgICBub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX2Fzc2lzdGFudF9yZXNwb25zZTogW10sCiAgICAgIGVkaXRfc2xvdF9pbmRleDogIiIsCiAgICAgIGVkaXRfc2xvdF9jaGVja19mb3I6ICIiLAogICAgICBlZGl0X3Nsb3Rfc2xvdF92YXJpYWJsZTogIiIsCiAgICAgIG1hbmFnZV9oYW5kbGVyczogW10sCiAgICAgIG5vdGlmaWNhdGlvbnM6IHsKICAgICAgICBub3RpZnk6IFt7CiAgICAgICAgICB0eXBlOiAiIiwKICAgICAgICAgIHNsb3Q6ICIiLAogICAgICAgICAgdGVtcGxhdGVfaWQ6ICIiLAogICAgICAgICAgdGVtcGxhdGVfbmFtZTogIiIKICAgICAgICB9XSwKICAgICAgICByZXNwb25zZXM6IFtdCiAgICAgIH0sCiAgICAgIG5vdGlmaWNhdGlvbnNfbm90aWZ5X3R5cGVfbGlzdDogWyJlbWFpbCJdLAogICAgICBub3RpZmljYXRpb25zX25vdGlmeV90ZW1wbGF0ZV9saXN0OiBbLy8gewogICAgICAgIC8vICAgImVtYWlsIjogIjxwPk5ldyBZZWFyIE9mZmVycyBvZiA1MCUgZGlzY291bnQgb24gYWxsIGdyb2NlcnkgcHJvZHVjdHMhISE8L3A+IiwKICAgICAgICAvLyAgICJzbXMiOiBudWxsLAogICAgICAgIC8vICAgInRlbXBsYXRlX2lkIjogIjQzNTMxMmJjLWQ0MjctNDk3YS1hZWNlLWI4YjkyYTQ4MmUyMCIsCiAgICAgICAgLy8gICAidGVtcGxhdGVfbmFtZSI6ICJOZXcgWWVhciBPZmZlcnMiCiAgICAgICAgLy8gfSwKICAgICAgICAvLyB7CiAgICAgICAgLy8gICAiZW1haWwiOiAiPHA+U2FsZSBvZiA1MCAlIG9uIGRpd2FsaTwvcD4iLAogICAgICAgIC8vICAgInNtcyI6IG51bGwsCiAgICAgICAgLy8gICAidGVtcGxhdGVfaWQiOiAiZTc2NmU3OTUtOWIzYS00YWQ4LThlYTMtNTlkNjllZGYwMjY3IiwKICAgICAgICAvLyAgICJ0ZW1wbGF0ZV9uYW1lIjogIkRpd2FsaSBUZW1wbGF0ZSIKICAgICAgICAvLyB9LAogICAgICAgIC8vIHsKICAgICAgICAvLyAgICJlbWFpbCI6ICI8cD5IZWxsbyBDdXN0b21lcnMhPC9wPjxwPkNocmlzdG1hcyBtYXkgYmUgd2Vla3MgYWdvIGJ1dCB3ZSBhcmUgZW5jb3VyYWdpbmcgY3VzdG9tZXJzIHRvIHNob3AgZWFybHkgdGhpcyB5ZWFyIGZvciB0aW1lbHkgZGVsaXZlcnkuIENPVklELTE5IHdpbGwgY2F1c2Ugc3VyZ2UgaW4gb25saW5lIHNob3BwaW5nLCB3aGljaCBtZWFucyB0aGF0IHRoZXJlIGNvdWxkIGJlIHVuZXhwZWN0ZWQgc2hpcHBpbmcgZGVsYXlzIHdpdGggY2FycmllcnMuIEdvIHZpc2l0IG91ciBzdG9yZSBub3c6IGh0dHBzOi8vZWFydGhvbnN0b3JlLmNvbS8gPC9wPiIsCiAgICAgICAgLy8gICAic21zIjogbnVsbCwKICAgICAgICAvLyAgICJzdWJqZWN0IjogIk9mZmVycyIsCiAgICAgICAgLy8gICAidGVtcGxhdGVfaWQiOiAiMGJiMGNlYjMtZmQzMC00MTNlLThmMzctYjBiYzU5YmIwMGU3IiwKICAgICAgICAvLyAgICJ0ZW1wbGF0ZV9uYW1lIjogIkNocmlzdG1hcyIKICAgICAgICAvLyB9CiAgICAgIF0sCiAgICAgIGN1c3RvbVRvb2xiYXI6IFtbImJvbGQiLCAiaXRhbGljIiwgInVuZGVybGluZSJdLCBbewogICAgICAgIGFsaWduOiBbXQogICAgICB9XSwgW3sKICAgICAgICBjb2xvcjogW10KICAgICAgfSwgewogICAgICAgIGJhY2tncm91bmQ6IFtdCiAgICAgIH1dLCBbewogICAgICAgIGxpc3Q6ICJvcmRlcmVkIgogICAgICB9LCB7CiAgICAgICAgbGlzdDogImJ1bGxldCIKICAgICAgfV0sIFsibGluayJdXSwKICAgICAgLy8gZW50aXR5X2xpc3Q6IFsiZW50aXR5MSIsImVudGl0eTIiXSwKICAgICAgZW50aXR5X2xpc3Q6IFtdLAogICAgICAvLyB0cmlnZ2VyX29wdGlvbnM6IFsiSU50ZW50MSIsIkludGVudDIiLCJJbnRlbnQzIl0sCiAgICAgIHRyaWdnZXJfb3B0aW9uczogW10sCiAgICAgIHRyaWdnZXJfb3B0aW9uc19pbnRlbnQ6IFtdLAogICAgICB0cmlnZ2VyX29wdGlvbnNfZW50aXR5OiBbXSwKICAgICAgaW50ZW50X2xpc3RfY2hvaWNlX2NhcmQ6IFtdLAogICAgICB0cmlnZ2VyX29wdGlvbnNfZW50aXR5X3ZhbHVlczogW10sCiAgICAgIGlzX3Nob3dfZWRpdDogZmFsc2UsCiAgICAgIGlzX2xvYWRpbmc6IGZhbHNlLAogICAgICBzaG93X2ludGVudF9saXN0OiBmYWxzZQogICAgfTsKICB9LAogIHdhdGNoOiB7fSwKICBjb21wdXRlZDogewogICAgZHJhZ09wdGlvbnNTbG90czogZnVuY3Rpb24gZHJhZ09wdGlvbnNTbG90cygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBhbmltYXRpb246IDIwMCwKICAgICAgICBncm91cDogImRlc2NyaXB0aW9uIiwKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgICAgZ2hvc3RDbGFzczogImdob3N0IiwKICAgICAgICBzY3JvbGxTZW5zaXRpdml0eTogMjAwLAogICAgICAgIGZvcmNlRmFsbGJhY2s6IHRydWUKICAgICAgfTsKICAgIH0gLy8gcGxhY2Vob2xkZXIoKSB7CiAgICAvLyAgIGlmICh0aGlzLnRyaWdnZXJzLmxlbmd0aCA+IDEpewogICAgLy8gICAgIHRoaXMudHJpZ2dlcl9vcHRpb25zID0gW107CiAgICAvLyAgICAgcmV0dXJuICJUeXBlIHRvIHNlYXJjaCBFbnRpdHkiCiAgICAvLyAgIH1lbHNlewogICAgLy8gICAgIHJldHVybiAiVHlwZSB0byBzZWFyY2ggb2JqZWN0aXZlIgogICAgLy8gICB9CiAgICAvLyB9CgogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLmZyZWV6ZV9wb3J0YWwoKTsKICAgIH0sIDEwMDApOwogICAgdGhpcy4kcm9vdC4kb24oImRpYWxvZ19jb21wb25lbnREaXNhYmxlZCIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIGlmIChkYXRhID09PSB0cnVlKSB7CiAgICAgICAgX3RoaXMuc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsKCk7CiAgICAgIH0KICAgIH0pOyAvLyAkKCIjdHJ5X2JvdF9idG4iKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAvLyAgIGFsZXJ0KCdjbGlja2VkIScpOwogICAgLy8gfSk7CgogICAgdmFyIHZtID0gdGhpczsKICAgICQoIiNpbnNlcnRfdmFyaWFibGVfbW9kYWwiKS5vbigiaGlkZGVuLmJzLm1vZGFsIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIGlkID0gdm0uYXNzaXN0YW5jZV9yZXNwb25zZV9pZDsKICAgICAgdmFyIG51bSA9IHZtLmFzc2lzdGFuY2VfcmVzcG9uc2VfX3ZhbF9pbmRleDsKICAgICAgJCgiI2Fzc2lzdGFuY2VfcmVzcG9uc2VfIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLmZvY3VzKCk7CiAgICB9KTsKICAgICQoIiNtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX21vZGFsIikub24oImhpZGRlbi5icy5tb2RhbCIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciBpZCA9IHZtLm1hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlX2lkOwogICAgICB2YXIgbnVtID0gdm0ubWFuYWdlX2hhbmRsZXJzX2Fzc2lzdGFuY2VfcmVzcG9uc2VfX3ZhbF9pbmRleDsKICAgICAgJCgiI21hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS5mb2N1cygpOwogICAgfSk7CgogICAgd2luZG93Lm9uY2xpY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgiI3RyeV9ib3RfcmVzcG9uc2UiKSB8fCBlLnRhcmdldC5jbG9zZXN0KCIjdHJ5X2JvdF9idG4iKSkge30gZWxzZSB7CiAgICAgICAgdm0ubG9hZF9ib3RfcHJldmlldyA9IGZhbHNlOwogICAgICB9CiAgICB9OyAvLyBHRVQgU0FWRUQgRElBTE9HIFRSRUUKCgogICAgdGhpcy5sb2FkX3NhdmVkX2RpYWxvZ190cmVlKCk7IC8vIENIRUNLSU5HIFdFQkhPT0sgREVUQUlMUwoKICAgIHRoaXMubG9hZF93ZWJob29rKCk7CiAgICB0aGlzLmxvYWRfaW50ZW50KCk7CiAgICB0aGlzLmxvYWRfZW50aXR5KCk7CiAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7IC8vIHRoaXMuZGF0YSA9IG5ldyBUcmVlKHRoaXMudGVzdF9yZXNwb25zZV90cmVlKQogICAgLy8gdGhpcy5nZXRfbm9kZXNfbGlzdCh0aGlzLmRhdGEpOwogIH0sCiAgbWV0aG9kczogewogICAgZmlsdGVyX2FzaXN0YW5jZV9yZXNwb25zZTogZnVuY3Rpb24gZmlsdGVyX2FzaXN0YW5jZV9yZXNwb25zZSgpIHsKICAgICAgdGhpcy5maWx0ZXJlZF9hc3Npc3RhbnRfcmVzcG9uc2UgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UpIHsKICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uY29uZGl0aW9uICE9ICd1bmZpbGxlZF9zbG90JyAmJiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5jb25kaXRpb24gIT0gJyFzdWNjZXNzZnVsJyAmJiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5jb25kaXRpb24gIT0gJyF1bnN1Y2Nlc3NmdWwnICYmIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmNvbmRpdGlvbiAhPSAndmFsaWRhdGlvbl9yZXNwb25zZScpIHsKICAgICAgICAgIHRoaXMuZmlsdGVyZWRfYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2godGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGludGVyY2hhbmdlX3Bvc2l0aW9uX2Fzc2lzdGFudF9yZXNwb25zZTogZnVuY3Rpb24gaW50ZXJjaGFuZ2VfcG9zaXRpb25fYXNzaXN0YW50X3Jlc3BvbnNlKGlkMSwgaWQyLCB0eXBlKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQgPT09IGlkMSkgewogICAgICAgICAgdmFyIHRlbXAxID0gaTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5pZCA9PT0gaWQyKSB7CiAgICAgICAgICB2YXIgdGVtcDIgPSBpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIHRtcCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW3RlbXAxXTsKICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbdGVtcDFdID0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbdGVtcDJdOwogICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVt0ZW1wMl0gPSB0bXA7CgogICAgICBpZiAodHlwZSA9PT0gJ25vdGlmaWNhdGlvbl9tb2RhbCcpIHsKICAgICAgICB0aGlzLm9uX29wZW5fbm90aWZpY2F0aW9uX21vZGFsKCk7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3Nsb3RfbW9kYWwnKSB7CiAgICAgICAgdGhpcy5vbl9vcGVuX3Nsb3RzX21vZGFsKHRoaXMuZWRpdF9zbG90X3Nsb3RfdmFyaWFibGUsIHRoaXMuZWRpdF9zbG90X2luZGV4LCB0aGlzLmVkaXRfc2xvdF9jaGVja19mb3IpOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdmaWx0ZXJfYXNzaXN0YW5jZScpIHsKICAgICAgICB0aGlzLmZpbHRlcl9hc2lzdGFuY2VfcmVzcG9uc2UoKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnd2ViaG9va19tb2RhbCcpIHsKICAgICAgICB0aGlzLm9uX29wZW5fd2ViaG9va19tb2RhbCgpOwogICAgICB9CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX2ludGVyY2hhbmdlX3Bvc2l0aW9uX2Fzc2lzdGFudF9yZXNwb25zZTogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2ludGVyY2hhbmdlX3Bvc2l0aW9uX2Fzc2lzdGFudF9yZXNwb25zZShpZDEsIGlkMiwgaW5kKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAodGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaV0uaWQgPT09IGlkMSkgewogICAgICAgICAgdmFyIHRlbXAxID0gaTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpXS5pZCA9PT0gaWQyKSB7CiAgICAgICAgICB2YXIgdGVtcDIgPSBpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIHRtcCA9IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzW3RlbXAxXTsKICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbdGVtcDFdID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbdGVtcDJdOwogICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1t0ZW1wMl0gPSB0bXA7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZtLiRzZXQodm0ubWFuYWdlX2hhbmRsZXJzLCBpbmQsIHZtLm1hbmFnZV9oYW5kbGVyc1tpbmRdKTsKICAgIH0sCiAgICBjaGFuZ2VfYnRuX3ZhbHVlX3BsYWNlaG9sZGVyOiBmdW5jdGlvbiBjaGFuZ2VfYnRuX3ZhbHVlX3BsYWNlaG9sZGVyKHR5cGUpIHsKICAgICAgaWYgKHR5cGUgPT09ICJwb3N0YmFjayIpIHsKICAgICAgICByZXR1cm4gIkVudGVyIHZhbHVlIjsKICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAidXJsIikgewogICAgICAgIHJldHVybiAiRW50ZXIgVVJMIjsKICAgICAgfQogICAgfSwKICAgIHVwZGF0ZWRfZW50aXR5X2xpc3RfYWZ0ZXJfcmVtb3ZpbmdfdXNlZF9lbnRpdHlfaW5fc2xvdDogZnVuY3Rpb24gdXBkYXRlZF9lbnRpdHlfbGlzdF9hZnRlcl9yZW1vdmluZ191c2VkX2VudGl0eV9pbl9zbG90KGVudGl0eV9saXN0LCBzbG90X2xpc3QpIHsKICAgICAgdmFyIHRvUmVtb3ZlID0gc2xvdF9saXN0Lm1hcChmdW5jdGlvbiAoc2xvdCkgewogICAgICAgIHJldHVybiBzbG90LmNoZWNrX2ZvcjsKICAgICAgfSk7CiAgICAgIHZhciBkaWZmZXJlbmNlID0gZW50aXR5X2xpc3QuZmlsdGVyKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgcmV0dXJuICF0b1JlbW92ZS5pbmNsdWRlcyh4KTsKICAgICAgfSk7CiAgICAgIHJldHVybiBkaWZmZXJlbmNlOwogICAgfSwKICAgIGxvYWRfc2xvdF92YXJpYWJsZTogZnVuY3Rpb24gbG9hZF9zbG90X3ZhcmlhYmxlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl9kaWFsb2dfdHJlZSgpLCB7CiAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgIGlzX2dldF9zbG90X3ZhcmlhYmxlOiB0cnVlLAogICAgICAgIG5vZGVfaWQ6IHRoaXMubm9kZV9pZC50b1N0cmluZygpCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAoX3RoaXMyLmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRV9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBfdGhpczIuc2xvdF92YXJpYWJsZSA9IHJlc3BvbnNlLmRhdGEuZGF0YS5zbG90c19saXN0OwogICAgICAgIH0gZWxzZSBpZiAoX3RoaXMyLmFwaV9zdGF0dXNfY29kZS5OT19TTE9UU19GT1VORF9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0bHQoJ2RpYWxvZ19mbG93X2xvYWRfc2xvdF9pbnRlcm5hbF9zZXJ2ZXJfbXNnJyksCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIF90aGlzMi5hZGRfdG9faW5zZXJ0X3Nsb3RfdmFyaWFibGVfb3B0aW9ucygpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMi5hZGRfdG9faW5zZXJ0X3Nsb3RfdmFyaWFibGVfb3B0aW9ucygpOwoKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzMi4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNpcmNsZV9tb3VzZW92ZXI6IGZ1bmN0aW9uIGNpcmNsZV9tb3VzZW92ZXIoaWQsIG51bSkgewogICAgICAkKCIjaW5zZXJ0X3ZhcmlhYmxlX2NpcmNsZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkudG9nZ2xlQ2xhc3MoImluc2VydF92YXJpYWJsZV9jaXJjbGUiKTsKICAgIH0sCiAgICBjaXJjbGVfbW91c2VvdXQ6IGZ1bmN0aW9uIGNpcmNsZV9tb3VzZW91dChpZCwgbnVtKSB7CiAgICAgICQoIiNpbnNlcnRfdmFyaWFibGVfY2lyY2xlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS50b2dnbGVDbGFzcygiaW5zZXJ0X3ZhcmlhYmxlX2NpcmNsZSIpOwogICAgfSwKICAgIG1hbmFnZV9oYW5kbGVyc19jaXJjbGVfbW91c2VvdmVyOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfY2lyY2xlX21vdXNlb3ZlcihpZCwgbnVtKSB7CiAgICAgICQoIiNtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX2NpcmNsZV8iLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkudG9nZ2xlQ2xhc3MoImluc2VydF92YXJpYWJsZV9jaXJjbGUiKTsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfY2lyY2xlX21vdXNlb3V0OiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfY2lyY2xlX21vdXNlb3V0KGlkLCBudW0pIHsKICAgICAgJCgiI21hbmFnZV9oYW5kbGVyc19pbnNlcnRfdmFyaWFibGVfY2lyY2xlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS50b2dnbGVDbGFzcygiaW5zZXJ0X3ZhcmlhYmxlX2NpcmNsZSIpOwogICAgfSwKICAgIGluc2VydF92YXJpYWJsZV9ibG9ja19vZmY6IGZ1bmN0aW9uIGluc2VydF92YXJpYWJsZV9ibG9ja19vZmYoaWQsIG51bSkgewogICAgICAkKCIjaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnRvZ2dsZUNsYXNzKCJpbnNlcnRfdmFyaWFibGVfYmxvY2siKTsKICAgIH0sCiAgICBpbnNlcnRfdmFyaWFibGVfYmxvY2tfb246IGZ1bmN0aW9uIGluc2VydF92YXJpYWJsZV9ibG9ja19vbihpZCwgbnVtKSB7CiAgICAgICQoIiNpbnNlcnRfdmFyaWFibGVfYmxvY2siLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkudG9nZ2xlQ2xhc3MoImluc2VydF92YXJpYWJsZV9ibG9jayIpOwogICAgfSwKICAgIG1hbmFnZV9oYW5kbGVyc19pbnNlcnRfdmFyaWFibGVfYmxvY2tfb2ZmOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrX29mZihpZCwgbnVtKSB7CiAgICAgICQoIiNtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnRvZ2dsZUNsYXNzKCJpbnNlcnRfdmFyaWFibGVfYmxvY2siKTsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrX29uOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3ZhcmlhYmxlX2Jsb2NrX29uKGlkLCBudW0pIHsKICAgICAgJCgiI21hbmFnZV9oYW5kbGVyc19pbnNlcnRfdmFyaWFibGVfYmxvY2siLmNvbmNhdChpZCwgIl8iKS5jb25jYXQobnVtKSkudG9nZ2xlQ2xhc3MoImluc2VydF92YXJpYWJsZV9ibG9jayIpOwogICAgfSwKICAgIHNldF9hc3Npc3RhbmNlX3Jlc3BvbnNlX2luZGV4OiBmdW5jdGlvbiBzZXRfYXNzaXN0YW5jZV9yZXNwb25zZV9pbmRleChpZCwgbnVtKSB7CiAgICAgICQoIiNhc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS5mb2N1cygpOwogICAgICB0aGlzLmFzc2lzdGFuY2VfcmVzcG9uc2VfaWQgPSBpZDsKICAgICAgdGhpcy5hc3Npc3RhbmNlX3Jlc3BvbnNlX192YWxfaW5kZXggPSBudW07CiAgICAgIHRoaXMuYWRkX3RvX2luc2VydF9zbG90X3ZhcmlhYmxlX29wdGlvbnMoKTsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfc2V0X2Fzc2lzdGFuY2VfcmVzcG9uc2VfaW5kZXg6IGZ1bmN0aW9uIG1hbmFnZV9oYW5kbGVyc19zZXRfYXNzaXN0YW5jZV9yZXNwb25zZV9pbmRleChpZCwgbnVtLCBpbmQpIHsKICAgICAgJCgiI21hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS5mb2N1cygpOwogICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc19pbmQgPSBpbmQ7CiAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzX2Fzc2lzdGFuY2VfcmVzcG9uc2VfaWQgPSBpZDsKICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV9fdmFsX2luZGV4ID0gbnVtOwogICAgICB0aGlzLmFkZF90b19pbnNlcnRfc2xvdF92YXJpYWJsZV9vcHRpb25zKCk7CiAgICB9LAogICAgYWRkVGFnOiBmdW5jdGlvbiBhZGRUYWcobmV3VGFnKSB7CiAgICAgIHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0uc2xvdCA9IG5ld1RhZzsKICAgIH0sCiAgICBhZGRfdG9faW5zZXJ0X3Nsb3RfdmFyaWFibGVfb3B0aW9uczogZnVuY3Rpb24gYWRkX3RvX2luc2VydF9zbG90X3ZhcmlhYmxlX29wdGlvbnMoKSB7CiAgICAgIHZhciB0ZW1wMSA9IFtdOwogICAgICB2YXIgdGVtcCA9IHRoaXMuc2xvdHMubWFwKGZ1bmN0aW9uIChzbG90KSB7CiAgICAgICAgcmV0dXJuIHNsb3Quc2xvdDsKICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0gIT0gIiI7CiAgICAgIH0pOwoKICAgICAgaWYgKEJvb2xlYW4odGhpcy53ZWJob29rX3ZhcmlhYmxlKSkgewogICAgICAgIHRlbXAxLnB1c2goIiQiICsgdGhpcy53ZWJob29rX3ZhcmlhYmxlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gbWVyZ2VOb0R1cGxpY2F0ZXMoKSB7CiAgICAgICAgdmFyIG1lcmdlZEFycmF5ID0gW107CgogICAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcnJheXMgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgICBhcnJheXNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICAgICAgfQoKICAgICAgICBhcnJheXMuZm9yRWFjaChmdW5jdGlvbiAoYXJyYXkpIHsKICAgICAgICAgIG1lcmdlZEFycmF5ID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShtZXJnZWRBcnJheSksIF90b0NvbnN1bWFibGVBcnJheShhcnJheSkpOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBfdG9Db25zdW1hYmxlQXJyYXkobmV3IFNldChfdG9Db25zdW1hYmxlQXJyYXkobWVyZ2VkQXJyYXkpKSk7CiAgICAgIH0KCiAgICAgIHRoaXMuaW5zZXJ0X3Nsb3RfdmFyaWFibGVfb3B0aW9ucyA9IG1lcmdlTm9EdXBsaWNhdGVzKHRlbXAsIHRlbXAxLCB0aGlzLnNsb3RfdmFyaWFibGUpOwogICAgfSwKICAgIGluc2VydF9zbG90X3ZhcmlhYmxlX3RvX2Fzc2lzdGFuY2VfcmVzcG9uc2U6IGZ1bmN0aW9uIGluc2VydF9zbG90X3ZhcmlhYmxlX3RvX2Fzc2lzdGFuY2VfcmVzcG9uc2UodmFyaWFibGUpIHsKICAgICAgdmFyIGlkID0gdGhpcy5hc3Npc3RhbmNlX3Jlc3BvbnNlX2lkOwogICAgICB2YXIgbnVtID0gdGhpcy5hc3Npc3RhbmNlX3Jlc3BvbnNlX192YWxfaW5kZXg7CiAgICAgICQoIiNhc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS5mb2N1cygpOwogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2YXIgY3Vyc29yUG9zID0gJCgiI2Fzc2lzdGFuY2VfcmVzcG9uc2VfIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnByb3AoInNlbGVjdGlvblN0YXJ0Iik7CiAgICAgIHZhciB2ID0gJCgiI2Fzc2lzdGFuY2VfcmVzcG9uc2VfIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnZhbCgpOwogICAgICB2YXIgdGV4dEJlZm9yZSA9IHYuc3Vic3RyaW5nKDAsIGN1cnNvclBvcyk7CiAgICAgIHZhciB0ZXh0QWZ0ZXIgPSB2LnN1YnN0cmluZyhjdXJzb3JQb3MsIHYubGVuZ3RoKTsgLy8gJCgnI2Fzc2lzdGFuY2VfcmVzcG9uc2VfJysgaWQgKyAnXycgKyBudW0pLnZhbCggdGV4dEJlZm9yZSsgYW0gK3RleHRBZnRlciApOwoKICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaWRdLnZhbHVlc1tudW1dID0gdGV4dEJlZm9yZSArICJ7IiArIHZhcmlhYmxlICsgIn0iICsgdGV4dEFmdGVyOwogICAgICB2bS4kc2V0KHZtLmFzc2lzdGFudF9yZXNwb25zZSwgaWQsIHZtLmFzc2lzdGFudF9yZXNwb25zZVtpZF0pOwogICAgfSwKICAgIG1hbmFnZV9oYW5kbGVyc19pbnNlcnRfc2xvdF92YXJpYWJsZV90b19hc3Npc3RhbmNlX3Jlc3BvbnNlOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfaW5zZXJ0X3Nsb3RfdmFyaWFibGVfdG9fYXNzaXN0YW5jZV9yZXNwb25zZSh2YXJpYWJsZSkgewogICAgICB2YXIgaW5kID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNfaW5kOwogICAgICB2YXIgaWQgPSB0aGlzLm1hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlX2lkOwogICAgICB2YXIgbnVtID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV9fdmFsX2luZGV4OwogICAgICAkKCIjbWFuYWdlX2hhbmRsZXJzX2Fzc2lzdGFuY2VfcmVzcG9uc2VfIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLmZvY3VzKCk7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZhciBjdXJzb3JQb3MgPSAkKCIjbWFuYWdlX2hhbmRsZXJzX2Fzc2lzdGFuY2VfcmVzcG9uc2VfIi5jb25jYXQoaWQsICJfIikuY29uY2F0KG51bSkpLnByb3AoInNlbGVjdGlvblN0YXJ0Iik7CiAgICAgIHZhciB2ID0gJCgiI21hbmFnZV9oYW5kbGVyc19hc3Npc3RhbmNlX3Jlc3BvbnNlXyIuY29uY2F0KGlkLCAiXyIpLmNvbmNhdChudW0pKS52YWwoKTsKICAgICAgdmFyIHRleHRCZWZvcmUgPSB2LnN1YnN0cmluZygwLCBjdXJzb3JQb3MpOwogICAgICB2YXIgdGV4dEFmdGVyID0gdi5zdWJzdHJpbmcoY3Vyc29yUG9zLCB2Lmxlbmd0aCk7IC8vICQoJyNtYW5hZ2VfaGFuZGxlcnNfYXNzaXN0YW5jZV9yZXNwb25zZV8nKyBpZCArICdfJyArIG51bSkudmFsKCB0ZXh0QmVmb3JlKyBhbSArdGV4dEFmdGVyICk7CgogICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpZF0udmFsdWVzW251bV0gPSB0ZXh0QmVmb3JlICsgInsiICsgdmFyaWFibGUgKyAifSIgKyB0ZXh0QWZ0ZXI7CiAgICAgIHZtLiRzZXQodm0ubWFuYWdlX2hhbmRsZXJzLCBpbmQsIHZtLm1hbmFnZV9oYW5kbGVyc1tpbmRdKTsKICAgIH0sCiAgICBhZGRfcmVtb3ZlX3RvX21hbmFnZV9oYW5kbGVyX2xpc3Q6IGZ1bmN0aW9uIGFkZF9yZW1vdmVfdG9fbWFuYWdlX2hhbmRsZXJfbGlzdChmdW5jLCBpbmQpIHsKICAgICAgaWYgKGZ1bmMgPT09ICJhZGQiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnMucHVzaCh7CiAgICAgICAgICBpZDogRGF0ZS5ub3coKSwKICAgICAgICAgIG5vZGVfdHlwZTogImV2ZW50X2hhbmRsZXIiLAogICAgICAgICAgbmFtZTogIiIsCiAgICAgICAgICB0cmlnZ2VyczogW3sKICAgICAgICAgICAgdHJpZ2dlcl90eXBlOiAiIiwKICAgICAgICAgICAgdHJpZ2dlcl92YWx1ZTogIiIKICAgICAgICAgIH1dLAogICAgICAgICAgcmVzcG9uc2VzOiBbXSwKICAgICAgICAgIHBhcmVudF9ub2RlOiB0aGlzLm5vZGVfaWQsCiAgICAgICAgICBwcmV2aW91c19ub2RlOiAiIiwKICAgICAgICAgIG5leHRfc3RlcDogewogICAgICAgICAgICBiZWhhdmlvcjogInNraXBfYWxsX3Nsb3RzIiwKICAgICAgICAgICAgc2VsZWN0b3I6IG51bGwsCiAgICAgICAgICAgIG5vZGVfaWQ6IG51bGwKICAgICAgICAgIH0sCiAgICAgICAgICBldmVudF9uYW1lOiAiZ2VuZXJpYyIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzLnNwbGljZShpbmQsIDEpOwogICAgICB9CiAgICB9LAogICAgc2V0X3dlYmhvb2tfcmV0dXJuX3ZhcmlhYmxlOiBmdW5jdGlvbiBzZXRfd2ViaG9va19yZXR1cm5fdmFyaWFibGUod2ViaG9va19pZCkgewogICAgICBjb25zb2xlLmxvZyh3ZWJob29rX2lkLCAiLS0iKTsKICAgICAgdGhpcy53ZWJob29rX3ZhcmlhYmxlID0gdGhpcy53ZWJob29rX2xpc3QuZmlsdGVyKGZ1bmN0aW9uIChpZCkgewogICAgICAgIHJldHVybiBpZC5pZCA9PSB3ZWJob29rX2lkOwogICAgICB9KVswXS5uYW1lLnJlcGxhY2UoL1xzKy9nLCAiXyIpOwogICAgfSwKICAgIGxvYWRfc2F2ZWRfZGlhbG9nX3RyZWU6IGZ1bmN0aW9uIGxvYWRfc2F2ZWRfZGlhbG9nX3RyZWUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5mb3JtX2F1dG9tYXRpb25fZGlhbG9nX3RyZWUoKSwgewogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBpc19nZXQ6IHRydWUKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzMy5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKF90aGlzMy5hcGlfc3RhdHVzX2NvZGUuTk9ERV9TVFJVQ1RVUkVfUkVDRUlWRURfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXMzLmRhdGEgPSBuZXcgVHJlZShyZXNwb25zZS5kYXRhLmRhdGEubm9kZV9zdHJ1Y3R1cmVbMF0ubm9kZXN0cnVjdHVyZSk7CgogICAgICAgICAgX3RoaXMzLmdldF9ub2Rlc19saXN0KF90aGlzMy5kYXRhKTsKICAgICAgICB9IGVsc2UgaWYgKF90aGlzMy5hcGlfc3RhdHVzX2NvZGUuTk9ERV9TVFJVQ1RVUkVfTk9UX0VYSVNUU19NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6IF90aGlzMy50bHQoJ2RpYWxvZ19mbG93X2NyZWF0ZV9kaWFsb2dfdHJlZV9tc2cnKSwKICAgICAgICAgICAgdGV4dDogX3RoaXMzLnRsdCgnZGlhbG9nX2Zsb3dfYWRkaW5nX25vZGVzX21zZycpLAogICAgICAgICAgICB0eXBlOiAiaW5mbyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRleHQ6IF90aGlzMy50bHQoJ2RpYWxvZ19mbG93X2xvYWRfc2F2ZWRfaW50ZXJuYWxfc2VydmVyX21zZycpLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMy5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBsb2FkX3dlYmhvb2s6IGZ1bmN0aW9uIGxvYWRfd2ViaG9vaygpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl93ZWJob29rX2RldGFpbHMoKSwgewogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICBwZXJfcGFnZTogNDAKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzNC5zcGlubmVyT24gPSBmYWxzZTsKICAgICAgICBfdGhpczQud2ViaG9va19saXN0ID0gW107CgogICAgICAgIGlmIChfdGhpczQuYXBpX3N0YXR1c19jb2RlLldFQkhPT0tfREVUQUlMU19SRUNFSVZFRF9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBfdGhpczQuaXNfd2ViaG9va19kZXRhaWxzID0gdHJ1ZTsKCiAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGEuZGF0YS53ZWJob29rWzBdLndlYmhvb2spIHsKICAgICAgICAgICAgX3RoaXM0LndlYmhvb2tfbGlzdC5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS53ZWJob29rWzBdLndlYmhvb2tbaV0pOwoKICAgICAgICAgICAgY29uc29sZS5sb2coX3RoaXM0LndlYmhvb2tfbGlzdCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChfdGhpczQuYXBpX3N0YXR1c19jb2RlLldFQkhPT0tfREVUQUlMU19OT1RfRVhJU1RTX01PREVMUy5NU0dfQ09ERSA9PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIF90aGlzNC5pc193ZWJob29rX2RldGFpbHMgPSBmYWxzZTsKICAgICAgICAgIF90aGlzNC53ZWJob29rX2lkID0gbnVsbDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICB0ZXh0OiB0bHQoJ2RpYWxvZ19mbG93X2xvYWRfd2ViaG9va19pbnRlcm5hbF9zZXJ2ZXJfbXNnJyksCiAgICAgICAgICAgIHRpbWVyOiAyMDAwCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgX3RoaXM0LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzNC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGxvYWRfaW50ZW50OiBmdW5jdGlvbiBsb2FkX2ludGVudCgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl9zYXZlX2ludGVudF9leGFtcGxlKCksIHsKICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICBwYWdlX25vOiAxLAogICAgICAgIHBlcl9wYWdlOiA0MAogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM1LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICBpZiAoX3RoaXM1LmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRV9NT0RFTFMuTVNHX0NPREUgPT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBfdGhpczUudHJpZ2dlcl9vcHRpb25zX2ludGVudCA9IFtdOwogICAgICAgICAgX3RoaXM1LmludGVudF9saXN0X2Nob2ljZV9jYXJkID0gW107CgogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5kYXRhLmRhdGEuZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBfdGhpczUudHJpZ2dlcl9vcHRpb25zX2ludGVudC5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS5kYXRhW2ldLkludGVudCk7CgogICAgICAgICAgICBfdGhpczUuaW50ZW50X2xpc3RfY2hvaWNlX2NhcmQucHVzaCgiLyIuY29uY2F0KHJlc3BvbnNlLmRhdGEuZGF0YS5kYXRhW2ldLkludGVudCkpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNS5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczUuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBsb2FkX2VudGl0eTogZnVuY3Rpb24gbG9hZF9lbnRpdHkoKSB7CiAgICAgIHZhciBfYXhpb3MkcG9zdCwKICAgICAgICAgIF90aGlzNiA9IHRoaXM7CgogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl9hZGRfZW50aXR5KCksIChfYXhpb3MkcG9zdCA9IHsKICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsCiAgICAgIH0sIF9kZWZpbmVQcm9wZXJ0eShfYXhpb3MkcG9zdCwgImxpY2Vuc2Vfa2V5IiwgdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5KSwgX2RlZmluZVByb3BlcnR5KF9heGlvcyRwb3N0LCAidG9rZW4iLCB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zKSwgX2RlZmluZVByb3BlcnR5KF9heGlvcyRwb3N0LCAic3Vic2NyaXB0aW9uIiwgdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnN1YnNjcmlwdGlvbiksIF9kZWZpbmVQcm9wZXJ0eShfYXhpb3MkcG9zdCwgImlzX2dldF9lbnRpdHkiLCB0cnVlKSwgX2RlZmluZVByb3BlcnR5KF9heGlvcyRwb3N0LCAicGFnZV9ubyIsIDEpLCBfZGVmaW5lUHJvcGVydHkoX2F4aW9zJHBvc3QsICJwZXJfcGFnZSIsIDQwKSwgX2F4aW9zJHBvc3QpLCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM2LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICBpZiAoX3RoaXM2LmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRV9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXM2LmVudGl0eV9saXN0ID0gW107CiAgICAgICAgICBfdGhpczYudHJpZ2dlcl9vcHRpb25zX2VudGl0eV92YWx1ZXMgPSBbXTsKICAgICAgICAgIF90aGlzNi50cmlnZ2VyX29wdGlvbnNfZW50aXR5ID0gW107CgogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5kYXRhLmRhdGEuZW50aXR5X25hbWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIF90aGlzNi5lbnRpdHlfbGlzdC5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS5lbnRpdHlfbmFtZXNbaV0uZW50aXR5KTsKCiAgICAgICAgICAgIF90aGlzNi50cmlnZ2VyX29wdGlvbnNfZW50aXR5X3ZhbHVlcy5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS5lbnRpdHlfbmFtZXNbaV0pOwoKICAgICAgICAgICAgX3RoaXM2LnRyaWdnZXJfb3B0aW9uc19lbnRpdHkucHVzaChyZXNwb25zZS5kYXRhLmRhdGEuZW50aXR5X25hbWVzW2ldLmVudGl0eSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChfdGhpczYuYXBpX3N0YXR1c19jb2RlLkVNUFRZX0RBVEFfTU9ERUxTLk1TR19DT0RFID09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRleHQ6IHRsdCgnZGlhbG9nX2Zsb3dfYWRkX3NvbWVfZW50aXRpZXNfbXNnJyksCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczYuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXM2LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgbG9hZF90ZW1wbGF0ZXM6IGZ1bmN0aW9uIGxvYWRfdGVtcGxhdGVzKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMudGVtcGxhdGVfcHJvbW90aW9uYWxfZW1haWwoKSwgewogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAgICAgaXNfbm90aWZpY2F0aW9uOiB0cnVlLAogICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgcGVyX3BhZ2U6IDQwCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczcuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChfdGhpczcuYXBpX3N0YXR1c19jb2RlLlNUQVRVU19TVUNDRVNTX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICBfdGhpczcubm90aWZpY2F0aW9uc19ub3RpZnlfdGVtcGxhdGVfbGlzdCA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICB9IGVsc2UgaWYgKF90aGlzNy5hcGlfc3RhdHVzX2NvZGUuVU5TVUNDRVNTRlVMX0RCX09QRVJBVElPTl9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgX3RoaXM3Lm5vdGlmaWNhdGlvbnNfbm90aWZ5X3RlbXBsYXRlX2xpc3QgPSBbXTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczcuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXM3LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2hlY2tfc2xvdF92YWx1ZV91c2VfaW5fcmVzcG9uc2U6IGZ1bmN0aW9uIGNoZWNrX3Nsb3RfdmFsdWVfdXNlX2luX3Jlc3BvbnNlKHJlc3BvbnNlKSB7CiAgICAgIGlmIChCb29sZWFuKHJlc3BvbnNlLmluY2x1ZGVzKCJ7IikpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9LAogICAgdmlzaWJsZV90cnlfYm90OiBmdW5jdGlvbiB2aXNpYmxlX3RyeV9ib3QoKSB7CiAgICAgIHRoaXMubG9hZF9ib3RfcHJldmlldyA9ICF0aGlzLmxvYWRfYm90X3ByZXZpZXc7CiAgICB9LAogICAgaXNfZW50aXR5X3R5cGVfc3lzX3BhdHRlcm46IGZ1bmN0aW9uIGlzX2VudGl0eV90eXBlX3N5c19wYXR0ZXJuKHRyaWdnZXJfdmFsdWUpIHsKICAgICAgdmFyIGEgPSB0aGlzLnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmVudGl0eSA9PSB0cmlnZ2VyX3ZhbHVlOwogICAgICB9KTsKICAgICAgdGhpcy5zZWxlY3RlZF9lbnRpdHkgPSB0cmlnZ2VyX3ZhbHVlOwoKICAgICAgaWYgKGEubGVuZ3RoID4gMCkgewogICAgICAgIGlmICh0aGlzLnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uZW50aXR5ID09IHRyaWdnZXJfdmFsdWU7CiAgICAgICAgfSlbMF0udHlwZSA9PT0gInBhdHRlcm4iIHx8IHRoaXMudHJpZ2dlcl9vcHRpb25zX2VudGl0eV92YWx1ZXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gaXRlbS5lbnRpdHkgPT0gdHJpZ2dlcl92YWx1ZTsKICAgICAgICB9KVswXS50eXBlID09PSAic3lzdGVtIikgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBlbnRpdHlfdmFsdWVfb3B0aW9uczogZnVuY3Rpb24gZW50aXR5X3ZhbHVlX29wdGlvbnModHJpZ2dlcl92YWx1ZSkgewogICAgICB2YXIgYSA9IHRoaXMudHJpZ2dlcl9vcHRpb25zX2VudGl0eV92YWx1ZXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0uZW50aXR5ID09IHRyaWdnZXJfdmFsdWU7CiAgICAgIH0pOwogICAgICB2YXIgdGVtcCA9IFtdOwoKICAgICAgaWYgKGEubGVuZ3RoID4gMCkgewogICAgICAgIHRlbXAgPSB0aGlzLnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uZW50aXR5ID09IHRyaWdnZXJfdmFsdWU7CiAgICAgICAgfSlbMF0udmFsdWVzLm1hcChmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICByZXR1cm4gdmFsLnZhbHVlOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gdGVtcDsKICAgIH0sCiAgICBjaGVja19pbWFnZV91cmw6IGZ1bmN0aW9uIGNoZWNrX2ltYWdlX3VybCh1cmwpIHsKICAgICAgaWYgKHRoaXMucmVnX2ltYWdlLnRlc3QodXJsKSA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGNoZWNrX3ZpZGVvX3VybDogZnVuY3Rpb24gY2hlY2tfdmlkZW9fdXJsKHVybCkgewogICAgICBpZiAodGhpcy5yZWdfdXJsLnRlc3QodXJsKSA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIHNlYXJjaF93ZWJob29rOiBmdW5jdGlvbiBzZWFyY2hfd2ViaG9vayhxdWVyeSkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIGlmIChxdWVyeSAhPSAiIikgewogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl93ZWJob29rX2RldGFpbHMoKSwgewogICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgc3Vic2NyaXB0aW9uOiAiUGxhdGludW0iLAogICAgICAgICAgaXNfc2VhcmNoOiB0cnVlLAogICAgICAgICAgc2VhcmNoX3Rlcm06IHRoaXMuc2VhcmNoX25hbWUsCiAgICAgICAgICBwZXJfcGFnZTogNDAsCiAgICAgICAgICBwYWdlX25vOiAxCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczguc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgaWYgKF90aGlzOC5hcGlfc3RhdHVzX2NvZGUuV0VCSE9PS19ERVRBSUxTX1JFQ0VJVkVEX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIF90aGlzOC53ZWJob29rX2xpc3QgPSBbXTsKICAgICAgICAgICAgX3RoaXM4LmlzX3dlYmhvb2tfZGV0YWlscyA9IHRydWU7CgogICAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGEuZGF0YS53ZWJob29rWzBdLndlYmhvb2spIHsKICAgICAgICAgICAgICBfdGhpczgud2ViaG9va19saXN0LnB1c2gocmVzcG9uc2UuZGF0YS5kYXRhLndlYmhvb2tbMF0ud2ViaG9va1tpXSk7CgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKF90aGlzOC53ZWJob29rX2xpc3QpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzOC5hcGlfc3RhdHVzX2NvZGUuU0VBUkNIX1dFQkhPT0tfTk9UX0ZPVU5EX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0ZXh0OiBfdGhpczgudGx0KCdkaWFsb2dfZmxvd193ZWJob29rX25vdF9mb3VuZF9tc2cnKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogMzAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IF90aGlzOC50bHQoJ2RpYWxvZ19mbG93X3NlYXJjaF93ZWJob29rX2ludGVybmFsX3NlcnZlcicpLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogMjAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzOC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHNlYXJjaF9pbnRlbnRfZW50aXR5OiBmdW5jdGlvbiBzZWFyY2hfaW50ZW50X2VudGl0eSh0cmlnZ2VyX3R5cGUsIHF1ZXJ5KSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgLy8gaWYocXVlcnkgPT0gIiIpewogICAgICAvLyAgIHRoaXMudHJpZ2dlcl9vcHRpb25zX2ludGVudCA9IFtdOwogICAgICAvLyAgIHRoaXMudHJpZ2dlcl9vcHRpb25zX2VudGl0eSA9IFtdOwogICAgICAvLyB9CiAgICAgIGlmICh0aGlzLmlzX3Jvb3QgfHwgdHJpZ2dlcl90eXBlID09PSAiaW50ZW50IikgewogICAgICAgIGlmIChxdWVyeSAhPSAiIikgewogICAgICAgICAgdGhpcy5pc19sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl9zYXZlX2ludGVudF9leGFtcGxlKCksIHsKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogIlBsYXRpbnVtIiwKICAgICAgICAgICAgaXNfc2VhcmNoOiB0cnVlLAogICAgICAgICAgICBzZWFyY2hfa2V5OiBxdWVyeSwKICAgICAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICAgICAgcGVyX3BhZ2U6IDQwCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICBpZiAoX3RoaXM5LmFwaV9zdGF0dXNfY29kZS5FTVBUWV9EQVRBX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgLy8gdG9hc3RyLmVycm9yKCJObyBSZXN1bHRzIEZvdW5kIik7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiBfdGhpczkudGx0KCdkaWFsb2dfZmxvd19ub19yZXN1bHRfZm91bmRfbXNnJyksCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzOS5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEVfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICBfdGhpczkudHJpZ2dlcl9vcHRpb25zX2ludGVudCA9IFtdOwogICAgICAgICAgICAgIF90aGlzOS5pbnRlbnRfbGlzdF9jaG9pY2VfY2FyZCA9IFtdOwoKICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3BvbnNlLmRhdGEuZGF0YS5SZXNwb25zZUxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIF90aGlzOS50cmlnZ2VyX29wdGlvbnNfaW50ZW50LnB1c2gocmVzcG9uc2UuZGF0YS5kYXRhLlJlc3BvbnNlTGlzdFtpXS5JbnRlbnQpOwoKICAgICAgICAgICAgICAgIF90aGlzOS5pbnRlbnRfbGlzdF9jaG9pY2VfY2FyZC5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS5SZXNwb25zZUxpc3RbaV0uSW50ZW50KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gdG9hc3RyLmVycm9yKCJJbnRybmFsIFNlcnZlciBFcnJvciIpOwogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogX3RoaXM5LnRsdCgnZGlhbG9nX2Zsb3dfaW50ZXJuYWxfc2VydmVyX21zZzEnKSwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICBfdGhpczkuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5pc19sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9hZF9pbnRlbnQoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodHJpZ2dlcl90eXBlID09PSAiZW50aXR5IikgewogICAgICAgIGlmIChxdWVyeSAhPSAiIikgewogICAgICAgICAgdGhpcy5pc19sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl9hZGRfZW50aXR5KCksIHsKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIHN1YnNjcmlwdGlvbjogIlBsYXRpbnVtIiwKICAgICAgICAgICAgaXNfc2VhcmNoOiB0cnVlLAogICAgICAgICAgICBzZWFyY2hfa2V5OiBxdWVyeSwKICAgICAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICAgICAgcGVyX3BhZ2U6IDQwCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICBpZiAoX3RoaXM5LmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRV9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICAgIF90aGlzOS50cmlnZ2VyX29wdGlvbnNfZW50aXR5ID0gW107CiAgICAgICAgICAgICAgX3RoaXM5LnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzID0gW107CgogICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzcG9uc2UuZGF0YS5kYXRhLmVudGl0aWVzX3NlYXJjaC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgX3RoaXM5LnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzLnB1c2gocmVzcG9uc2UuZGF0YS5kYXRhLmVudGl0aWVzX3NlYXJjaFtpXSk7CgogICAgICAgICAgICAgICAgX3RoaXM5LnRyaWdnZXJfb3B0aW9uc19lbnRpdHkucHVzaChyZXNwb25zZS5kYXRhLmVudGl0aWVzX3NlYXJjaFtpXS5lbnRpdHkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpczkuYXBpX3N0YXR1c19jb2RlLkVNUFRZX0RBVEFfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IF90aGlzOS50bHQoJ2RpYWxvZ19mbG93X25vX3Jlc3VsdF9mb3VuZF9tc2cxJyksCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIHRvYXN0ci5lcnJvcigiSW50cm5hbCBTZXJ2ZXIgRXJyb3IiKTsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IF90aGlzOS50bHQoJ2RpYWxvZ19mbG93X2ludGVybmFsX3NlcnZlcl9tc2czJyksCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgX3RoaXM5LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuaXNfbG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmxvYWRfZW50aXR5KCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2VhcmNoX2VudGl0eTogZnVuY3Rpb24gc2VhcmNoX2VudGl0eShxdWVyeSkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICBpZiAocXVlcnkgIT0gIiIpIHsKICAgICAgICB0aGlzLmlzX2xvYWRpbmcgPSB0cnVlOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl9hZGRfZW50aXR5KCksIHsKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHN1YnNjcmlwdGlvbjogIlBsYXRpbnVtIiwKICAgICAgICAgIGlzX3NlYXJjaDogdHJ1ZSwKICAgICAgICAgIHNlYXJjaF9rZXk6IHF1ZXJ5LAogICAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICAgIHBlcl9wYWdlOiA0MAogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXMxMC5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAoX3RoaXMxMC5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEVfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgX3RoaXMxMC5lbnRpdHlfbGlzdCA9IFtdOwoKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5kYXRhLmRhdGEuZW50aXRpZXNfc2VhcmNoLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgX3RoaXMxMC5lbnRpdHlfbGlzdC5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YS5lbnRpdGllc19zZWFyY2hbaV0uZW50aXR5KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChfdGhpczEwLmFwaV9zdGF0dXNfY29kZS5FTVBUWV9EQVRBX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IF90aGlzMTAudGx0KCdkaWFsb2dfZmxvd19ub19yZXN1bHRfZm91bmRfbXNnMicpLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIHRvYXN0ci5lcnJvcigiSW50cm5hbCBTZXJ2ZXIgRXJyb3IiKTsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogX3RoaXMxMC50bHQoJ2RpYWxvZ19mbG93X2ludGVybmFsX3NlcnZlcl9tc2c0JyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzMTAuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5pc19sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5sb2FkX2VudGl0eSgpOwogICAgICB9CiAgICB9LAogICAgc2VhcmNoX2Zvcl9lbnRpdHlfaGFzX3ZhbGlkYXRpb246IGZ1bmN0aW9uIHNlYXJjaF9mb3JfZW50aXR5X2hhc192YWxpZGF0aW9uKHF1ZXJ5KSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIGlmIChxdWVyeSAhPSAiIikgewogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl9hZGRfZW50aXR5KCksIHsKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHN1YnNjcmlwdGlvbjogIlBsYXRpbnVtIiwKICAgICAgICAgIGlzX3ZhbGlkYXRpb25fZW50aXR5OiB0cnVlLAogICAgICAgICAgZW50aXR5OiBxdWVyeQogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXMxMS5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICBpZiAoX3RoaXMxMS5hcGlfc3RhdHVzX2NvZGUuRU5USVRZX0hBU19WQUxJREFUSU9OX01PREVMUy5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIF90aGlzMTEuaXNfdmFsaWRhdGlvbl9lbnRpdHkgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIGlmIChfdGhpczExLmFwaV9zdGF0dXNfY29kZS5FTlRJVFlfSEFTX05PX1ZBTElEQVRJT04uTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBfdGhpczExLmlzX3ZhbGlkYXRpb25fZW50aXR5ID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpczExLmlzX3ZhbGlkYXRpb25fZW50aXR5ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIF90aGlzMTEuaXNfdmFsaWRhdGlvbl9lbnRpdHkgPSBmYWxzZTsKCiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXMxMS4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzX3ZhbGlkYXRpb25fZW50aXR5ID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBzZWFyY2hfdGVtcGxhdGVfbmFtZTogZnVuY3Rpb24gc2VhcmNoX3RlbXBsYXRlX25hbWUocXVlcnkpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgaWYgKHF1ZXJ5ICE9ICIiKSB7CiAgICAgICAgdGhpcy5pc19sb2FkaW5nID0gdHJ1ZTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy50ZW1wbGF0ZV9wcm9tb3Rpb25hbF9lbWFpbCgpLCB7CiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBzdWJzY3JpcHRpb246ICJQbGF0aW51bSIsCiAgICAgICAgICBpc19zZWFyY2g6IHRydWUsCiAgICAgICAgICBpc19ub3RpZmljYXRpb246IHRydWUsCiAgICAgICAgICBzZWFyY2hfa2V5OiBxdWVyeSwKICAgICAgICAgIHBhZ2Vfbm86IDEsCiAgICAgICAgICBwZXJfcGFnZTogNDAKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzMTIuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgaWYgKF90aGlzMTIuYXBpX3N0YXR1c19jb2RlLlRFTVBMQVRFX0RPRVNfTk9UX0VYSVNUU19NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiBfdGhpczEyLnRsdCgnZGlhbG9nX2Zsb3dfbm9fcmVzdWx0X2ZvdW5kX21zZzMnKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMTIuYXBpX3N0YXR1c19jb2RlLlRFTVBMQVRFX1NFQVJDSF9SRVNVTFRfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgICAgX3RoaXMxMi5ub3RpZmljYXRpb25zX25vdGlmeV90ZW1wbGF0ZV9saXN0ID0gW107CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3BvbnNlLmRhdGEuZGF0YS50ZW1wbGF0ZV9zZWFyY2gubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBfdGhpczEyLm5vdGlmaWNhdGlvbnNfbm90aWZ5X3RlbXBsYXRlX2xpc3QucHVzaChyZXNwb25zZS5kYXRhLmRhdGEudGVtcGxhdGVfc2VhcmNoW2ldKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXMxMi4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICB0aGlzLmlzX2xvYWRpbmcgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmxvYWRfdGVtcGxhdGVzKCk7CiAgICAgIH0KICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfYXJyYW5nZV9pZHNfZnVuY3Rpb246IGZ1bmN0aW9uIG1hbmFnZV9oYW5kbGVyc19hcnJhbmdlX2lkc19mdW5jdGlvbihpbmQpIHsKICAgICAgaWYgKHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzICE9IFtdKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcykgewogICAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaV0uaWQgPSBpLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYXJyYW5nZV9pZHNfZnVuY3Rpb246IGZ1bmN0aW9uIGFycmFuZ2VfaWRzX2Z1bmN0aW9uKCkgewogICAgICAvL0ZvciByZXNwb25zZXMgcmV3cml0ZSBpZHMKICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlICE9IFtdKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQgPSBpLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICB9IC8vRm9yIHNsb3RzIHJld3JpdGUgaWRzCgoKICAgICAgaWYgKHRoaXMuc2xvdHMgIT0gW10pIHsKICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMuc2xvdHMpIHsKICAgICAgICAgIHRoaXMuc2xvdHNbaV0ucmVzcG9uc2VzID0gW107CiAgICAgICAgICB2YXIgdGVtcCA9IHRoaXMuc2xvdHNbaV0uc2xvdDsKCiAgICAgICAgICBmb3IgKHZhciBqIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5yZWNvZ25pemVzID09IHRlbXApIHsKICAgICAgICAgICAgICB0aGlzLnNsb3RzW2ldLnJlc3BvbnNlcy5wdXNoKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2pdLmlkKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvL0ZvciBub3RpZmljYXRpb24gcmV3cml0ZSBpZHMKCgogICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcyAhPSBbXSkgewogICAgICAgIHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXMgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgaiBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2pdLnJlY29nbml6ZXMgPT0gInN1Y2Nlc3NmdWwiIHx8IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2pdLnJlY29nbml6ZXMgPT0gInVuc3VjY2Vzc2Z1bCIpIHsKICAgICAgICAgICAgdGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcy5wdXNoKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2pdLmlkKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvLyBhcnJhbmdlX2lkc19mdW5jdGlvbl9mb3Jfbm90aWZpY2F0aW9uKCl7CiAgICAvLyAgIC8vRm9yIHJlc3BvbnNlcyByZXdyaXRlIGlkcwogICAgLy8gICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UgIT0gW10pIHsKICAgIC8vICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAvLyAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5pZCA9IGkudG9TdHJpbmcoKTsKICAgIC8vICAgICB9CiAgICAvLyAgIH0KICAgIC8vICAgLy9Gb3Igbm90aWZpY2F0aW9uIHJld3JpdGUgaWRzCiAgICAvLyAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzICE9IFtdKSB7CiAgICAvLyAgICAgICB0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzID0gW107CiAgICAvLyAgICAgICBmb3IgKHZhciBqIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAvLyAgICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5yZWNvZ25pemVzID09ICJzdWNjZXNzZnVsIiB8fAogICAgLy8gICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2pdLnJlY29nbml6ZXMgPT0gInVuc3VjY2Vzc2Z1bCIpIHsKICAgIC8vICAgICAgICAgICAgIHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXMucHVzaCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5pZCk7CiAgICAvLyAgICAgICAgIH0KICAgIC8vICAgICAgIH0KICAgIC8vICAgfQogICAgLy8gfSwKICAgIGdldF9ub2Rlc19saXN0OiBmdW5jdGlvbiBnZXRfbm9kZXNfbGlzdChvbGROb2RlKSB7CiAgICAgIGlmIChvbGROb2RlLmNoaWxkcmVuICYmIG9sZE5vZGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBvbGROb2RlLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLmlzX3Jvb3QgPSB0cnVlOwogICAgICAgICAgdGhpcy5ub2Rlc19saXN0LnB1c2goW3sKICAgICAgICAgICAgaWQ6IG9sZE5vZGUuY2hpbGRyZW5baV0uaWQsCiAgICAgICAgICAgIG5hbWU6IG9sZE5vZGUuY2hpbGRyZW5baV0ubmFtZQogICAgICAgICAgfV0pOwogICAgICAgICAgdGhpcy5hZGRfY2hpbGRyZW5fbm9kZV9uYW1lKG9sZE5vZGUuY2hpbGRyZW5baV0sIGkpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFkZF9jaGlsZHJlbl9ub2RlX25hbWU6IGZ1bmN0aW9uIGFkZF9jaGlsZHJlbl9ub2RlX25hbWUoY2hpbGROb2RlLCBpbmR4KSB7CiAgICAgIGlmIChjaGlsZE5vZGUuY2hpbGRyZW4gJiYgY2hpbGROb2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gY2hpbGROb2RlLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICBjaGlsZE5vZGUuY2hpbGRyZW5baV0uaXNfcm9vdCA9IGZhbHNlOwogICAgICAgICAgdGhpcy5ub2Rlc19saXN0W2luZHhdLnNwbGljZShpbmR4LCAwLCB7CiAgICAgICAgICAgIGlkOiBjaGlsZE5vZGUuY2hpbGRyZW5baV0uaWQsCiAgICAgICAgICAgIG5hbWU6IGNoaWxkTm9kZS5jaGlsZHJlbltpXS5uYW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuYWRkX2NoaWxkcmVuX25vZGVfbmFtZShjaGlsZE5vZGUuY2hpbGRyZW5baV0sIGluZHgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGRyb3A6IGZ1bmN0aW9uIGRyb3Aobm9kZSwgc3JjLCB0YXJnZXQpIHsKICAgICAgLy8gY29uc29sZS5sb2cobm9kZSwgc3JjLCB0YXJnZXQpOwogICAgICB0aGlzLnB1c2hOZXdUcmVlKCk7CiAgICB9LAogICAgZHJvcEFmdGVyOiBmdW5jdGlvbiBkcm9wQWZ0ZXIobm9kZSwgc3JjLCB0YXJnZXQpIHsKICAgICAgLy8gY29uc29sZS5sb2cobm9kZSwgc3JjLCB0YXJnZXQpOwogICAgICB0aGlzLnB1c2hOZXdUcmVlKCk7CiAgICB9LAogICAgZHJvcEJlZm9yZTogZnVuY3Rpb24gZHJvcEJlZm9yZShub2RlLCBzcmMsIHRhcmdldCkgewogICAgICAvLyBjb25zb2xlLmxvZyhub2RlLCBzcmMsIHRhcmdldCk7CiAgICAgIHRoaXMucHVzaE5ld1RyZWUoKTsKICAgIH0sCiAgICBjbG9zZV9hZGRub2RlbW9kYWw6IGZ1bmN0aW9uIGNsb3NlX2FkZG5vZGVtb2RhbCgpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgU3dhbC5maXJlKHsKICAgICAgICB0aXRsZTogdGhpcy50bHQoJ2RpYWxvZ19mbG93X2FsZXJ0X21zZycpLAogICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19ub2RlX2NoYW5nZXNfbXNnJyksCiAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X3NhdmVfYnRuJyksCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X2Rpc2NhcmRfYnRuJykKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgaWYgKF90aGlzMTMuaXNfc2hvd19lZGl0KSB7CiAgICAgICAgICAgIF90aGlzMTMuZWRpdE5vZGUoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzMTMuYWRkTm9kZSgpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LmRpc21pc3MgPT09ICJjYW5jZWwiKSB7CiAgICAgICAgICAkKCIjYWRkbm9kZW1vZGFsIikubW9kYWwoImhpZGUiKTsKCiAgICAgICAgICBfdGhpczEzLmVtcHR5X3ZhcmlhYmxlKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBvbkRlbDogZnVuY3Rpb24gb25EZWwobm9kZSkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICBpZiAodGhpcy5uZXdfY2hpbGRfbm9kZSkgewogICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ2RpYWxvZ19mbG93X2FsZXJ0X21zZycpLAogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X25vZGVfY2hhbmdlc19tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X2RlbF9zYXZlX2J0bicpLAogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X2RlbF9kaXNjYXJkX2J0bicpCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgIGlmIChfdGhpczE0LmlzX3Nob3dfZWRpdCkgewogICAgICAgICAgICAgIF90aGlzMTQuZWRpdE5vZGUoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBfdGhpczE0LmFkZE5vZGUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuZGlzbWlzcyA9PT0gImNhbmNlbCIpIHsKICAgICAgICAgICAgJCgiI2FkZG5vZGVtb2RhbCIpLm1vZGFsKCJoaWRlIik7CgogICAgICAgICAgICB2YXIgbmV3X25vZGVzID0gX3RoaXMxNC5ub2Rlc19saXN0LmZpbHRlcihmdW5jdGlvbiAoc2VsZWN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHNlbGVjdC5pZCAhPT0gbm9kZS5pZDsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBfdGhpczE0Lm5vZGVzX2xpc3QgPSBuZXdfbm9kZXM7CiAgICAgICAgICAgIF90aGlzMTQubmV3X2NoaWxkX25vZGUgPSBmYWxzZTsKICAgICAgICAgICAgbm9kZS5yZW1vdmUoKTsKCiAgICAgICAgICAgIF90aGlzMTQuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19hbGVydF9tc2cnKSwKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19ub19yZXZlcnRfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19kZWxldGVfYnRuJykKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgdmFyIG5ld19ub2RlcyA9IF90aGlzMTQubm9kZXNfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKHNlbGVjdCkgewogICAgICAgICAgICAgIHJldHVybiBzZWxlY3QuaWQgIT09IG5vZGUuaWQ7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgX3RoaXMxNC5ub2Rlc19saXN0ID0gbmV3X25vZGVzOwogICAgICAgICAgICBub2RlLnJlbW92ZSgpOwogICAgICAgICAgICB2YXIgdm0gPSBfdGhpczE0OwoKICAgICAgICAgICAgX2Rmcyh2bS5kYXRhKTsKCiAgICAgICAgICAgIGZ1bmN0aW9uIF9kZnMob2xkTm9kZSkgewogICAgICAgICAgICAgIGlmIChvbGROb2RlLmNoaWxkcmVuICYmIG9sZE5vZGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG9sZE5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaWQgPT0gb2xkTm9kZS5jaGlsZHJlbltpXS5uZXh0X3N0ZXAubm9kZV9pZCkgewogICAgICAgICAgICAgICAgICAgIG9sZE5vZGUuY2hpbGRyZW5baV0ubmV4dF9zdGVwLmJlaGF2aW9yID0gIndhaXRfZm9yX3JlcGx5IjsKICAgICAgICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLm5leHRfc3RlcC5ub2RlX2lkID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLm5leHRfc3RlcC5zZWxlY3RvciA9ICJ3YWl0X2Zvcl91c2VyX2lucHV0IjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgX2RmcyhvbGROb2RlLmNoaWxkcmVuW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzMTQucHVzaE5ld1RyZWUoImRlbGV0ZW5vZGUiKTsKCiAgICAgICAgICAgIF90aGlzMTQuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSAvLyB0aGlzLmVtcHR5X3ZhcmlhYmxlKCk7CgogICAgfSwKICAgIG9uQWRkTm9kZTogZnVuY3Rpb24gb25BZGROb2RlKHBhcmFtcykgewogICAgICB0aGlzLmNoaWxkX25vZGUgPSBwYXJhbXM7CiAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgICAgdGhpcy5pc19zaG93X2VkaXQgPSB0cnVlOwogICAgICB0aGlzLm5ld19jaGlsZF9ub2RlID0gdHJ1ZTsgLy8gTm9kZSBpZCBpcyBpbXBvcnRhbnQsIGNoZWNrIGhvdyB3ZSBhcmUgYWRkaW5nIGNoaWxkbm9kZSBpbiBlZGl0Tm9kZSgpCgogICAgICB0aGlzLm5vZGVfaWQgPSBwYXJhbXMuaWQ7CiAgICAgIHRoaXMubm9kZV9uYW1lID0gcGFyYW1zLm5hbWU7CiAgICAgICQoIiNhZGRub2RlbW9kYWwiKS5tb2RhbCgic2hvdyIpOwogICAgfSwKICAgIGNoYW5nZV9yb290OiBmdW5jdGlvbiBjaGFuZ2Vfcm9vdCgpIHsKICAgICAgdGhpcy5pc19yb290ID0gdHJ1ZTsKICAgIH0sCiAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKHBhcmFtcykgewogICAgICB2YXIgX3RoaXMxNSA9IHRoaXM7CgogICAgICB2YXIgbmV3X29iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoewogICAgICAgIHRyaWdnZXJzOiBwYXJhbXMudHJpZ2dlcnMsCiAgICAgICAgYXNzaXN0YW50X3Jlc3BvbnNlOiBwYXJhbXMucmVzcG9uc2VzLAogICAgICAgIHNsb3RzOiBwYXJhbXMuc2xvdHMgIT0gbnVsbCA/IHBhcmFtcy5zbG90cyA6IFtdLAogICAgICAgIG5vdGlmaWNhdGlvbnM6IHBhcmFtcy5ub3RpZmljYXRpb25zICE9IG51bGwgPyBwYXJhbXMubm90aWZpY2F0aW9ucyA6IHsKICAgICAgICAgIG5vdGlmeTogW3sKICAgICAgICAgICAgdHlwZTogIiIsCiAgICAgICAgICAgIHNsb3Q6ICIiLAogICAgICAgICAgICB0ZW1wbGF0ZV9pZDogIiIsCiAgICAgICAgICAgIHRlbXBsYXRlX25hbWU6ICIiCiAgICAgICAgICB9XSwKICAgICAgICAgIHJlc3BvbnNlczogW10KICAgICAgICB9LAogICAgICAgIG1hbmFnZV9oYW5kbGVyczogcGFyYW1zLm1hbmFnZV9oYW5kbGVycyAhPSBudWxsID8gcGFyYW1zLm1hbmFnZV9oYW5kbGVycyA6IFtdLAogICAgICAgIHdlYmhvb2tfbWFwcGluZzogcGFyYW1zLndlYmhvb2tfbWFwcGluZyA9PSBudWxsID8gW10gOiBwYXJhbXMud2ViaG9va19tYXBwaW5nLAogICAgICAgIG5vZGVfaWQ6IHBhcmFtcy5pZCwKICAgICAgICBub2RlX25hbWU6IHBhcmFtcy5uYW1lLAogICAgICAgIGlzX3Jvb3Q6IHBhcmFtcy5pc19yb290LAogICAgICAgIGlzX3Nsb3Q6IHBhcmFtcy5zbG90X3NldHRpbmcsCiAgICAgICAgaXNfbm90aWZpY2F0aW9uOiBwYXJhbXMubm90aWZpY2F0aW9uX2VuYWJsZWQsCiAgICAgICAgbmV4dF9zdGVwOiBwYXJhbXMubmV4dF9zdGVwLAogICAgICAgIHNhdmVfdGhlbl9hc3Npc3RhbnRfc2hvdWxkOiBwYXJhbXMubmV4dF9zdGVwLmJlaGF2aW9yLAogICAgICAgIGp1bXBfdG9fbm9kZV9pZDogcGFyYW1zLm5leHRfc3RlcC5ub2RlX2lkLAogICAgICAgIGlzX3dlYmhvb2s6IHBhcmFtcy53ZWJob29rX2ludGVncmF0aW9uIC8vIHdlYmhvb2tfaWQ6IHRoaXMuaXNfd2ViaG9vayA9PSB0cnVlID8gcGFyYW1zLndlYmhvb2tfaWQgOiBudWxsLAogICAgICAgIC8vIHdlYmhvb2tfdmFyaWFibGU6dGhpcy53ZWJob29rX2lkICE9IG51bGwgPyBwYXJhbXMud2ViaG9va19yZXR1cm5fdmFyaWFibGUgOiAiIiwKCiAgICAgIH0pKTsgLy8gbmV3X29iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkobmV3X29iaikpOwoKICAgICAgdGhpcy5lbXB0eV92YXJpYWJsZSgpOwogICAgICB0aGlzLmlzX3Nob3dfZWRpdCA9IHRydWU7CiAgICAgIHRoaXMubm9kZV9pZCA9IG5ld19vYmoubm9kZV9pZDsKICAgICAgdGhpcy5ub2RlX25hbWUgPSBuZXdfb2JqLm5vZGVfbmFtZTsKICAgICAgdGhpcy5pc19yb290ID0gbmV3X29iai5pc19yb290OwogICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSA9IG5ld19vYmouYXNzaXN0YW50X3Jlc3BvbnNlOyAvLyB0aGlzLnRyaWdnZXJzID0gT2JqZWN0LmFzc2lnbihwYXJhbXMudHJpZ2dlcnMpOwoKICAgICAgdGhpcy50cmlnZ2VycyA9IG5ld19vYmoudHJpZ2dlcnM7CiAgICAgIHRoaXMuc2xvdHMgPSBuZXdfb2JqLnNsb3RzOwogICAgICB0aGlzLmlzX3Nsb3QgPSBuZXdfb2JqLmlzX3Nsb3Q7CiAgICAgIHRoaXMuaXNfbm90aWZpY2F0aW9uID0gbmV3X29iai5pc19ub3RpZmljYXRpb247CiAgICAgIHRoaXMubm90aWZpY2F0aW9ucyA9IG5ld19vYmoubm90aWZpY2F0aW9uczsKICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnMgPSBuZXdfb2JqLm1hbmFnZV9oYW5kbGVyczsKICAgICAgdGhpcy5uZXh0X3N0ZXAgPSBuZXdfb2JqLm5leHRfc3RlcDsKICAgICAgdGhpcy5zYXZlX3RoZW5fYXNzaXN0YW50X3Nob3VsZCA9IG5ld19vYmouc2F2ZV90aGVuX2Fzc2lzdGFudF9zaG91bGQ7CiAgICAgIHRoaXMuanVtcF90b19ub2RlX2lkID0gbmV3X29iai5qdW1wX3RvX25vZGVfaWQgPT09IG51bGwgPyAiIiA6IG5ld19vYmouanVtcF90b19ub2RlX2lkOwogICAgICB0aGlzLmlzX3dlYmhvb2sgPSBuZXdfb2JqLmlzX3dlYmhvb2s7CiAgICAgIHRoaXMud2ViaG9va19pZCA9IHRoaXMuaXNfd2ViaG9vayA9PSB0cnVlID8gcGFyYW1zLndlYmhvb2tfaWQgOiBudWxsLCB0aGlzLndlYmhvb2tfdmFyaWFibGUgPSB0aGlzLndlYmhvb2tfaWQgIT0gbnVsbCA/IHBhcmFtcy53ZWJob29rX3JldHVybl92YXJpYWJsZSA6ICIiLCB0aGlzLndlYmhvb2tfbWFwcGluZyA9IG5ld19vYmoud2ViaG9va19tYXBwaW5nOyAvLyBUaGlzIGNvbmRpdGlvbiBpcyB0byBjaGVjayBpZiByb290IG5vZGUgaXMgc2VsZWN0ZWQgdGhlbiBkb24ndCBsZXQgaXQgYWRkIG1vcmUgdGhhbiBvbmUgdHJpZ2dlcgogICAgICAvLyBpZiAodGhpcy5pc19yb290KSB7CiAgICAgIC8vICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFkZF90cmlnZ2VyX2J0biIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIC8vIH0gZWxzZSB7CiAgICAgIC8vICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFkZF90cmlnZ2VyX2J0biIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAvLyAgIHRoaXMuaXNfcm9vdCA9IGZhbHNlOwogICAgICAvLyB9CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZm91bmQgPSBfdGhpczE1LnRyaWdnZXJfb3B0aW9uc19lbnRpdHlfdmFsdWVzLnNvbWUoZnVuY3Rpb24gKGVudGl0eSkgewogICAgICAgICAgcmV0dXJuIGVudGl0eS5lbnRpdHkgPT09IF90aGlzMTUuc2VsZWN0ZWRfZW50aXR5OwogICAgICAgIH0pOyAvLyBjb25zb2xlLmxvZyh0aGlzLnNlbGVjdGVkX2VudGl0eSAsIi0tc2VsY3RlZCBlbnRpdHkiLCB0aGlzLnRyaWdnZXJzWzBdLmVudGl0eV92YWx1ZSAsICItLWVudGl0eSB2YWx1ZSIgLCBmb3VuZCkKICAgICAgICAvLyBjb25zb2xlLmxvZyhCb29sZWFuKHRoaXMuc2VsZWN0ZWRfZW50aXR5ICwgImJvb29sIikpCgoKICAgICAgICBpZiAoX3RoaXMxNS5zZWxlY3RlZF9lbnRpdHkgIT09ICIiICYmICFmb3VuZCkgewogICAgICAgICAgLy8gY29uc29sZS5sb2coInNob3cgc3dhbCIpCiAgICAgICAgICAvLyAgIFN3YWwoewogICAgICAgICAgLy8gICB0ZXh0OiBgVGhlICBlbnRpdHkgLSAke3RoaXMuc2VsZWN0ZWRfZW50aXR5fSAgaW4gc2VsZWN0ZWQgbm9kZSBoYXMgYmVlbiBkZWxldGVkIGZyb20gdGhlIGVudGl0aWVzIGxpc3QuUGxlYXNlIG1ha2Ugc3VyZSBpdCBpcyBhZGRlZCBpbiB0aGUgZW50aXRpZXMgbGlzdCB0byBhdm9pZCB0aGUgdW5leHBlY3RlZCBiZWhhdmlvci5gLAogICAgICAgICAgLy8gICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAvLyAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLAogICAgICAgICAgLy8gICB0aW1lcjo1MDAwLAogICAgICAgICAgLy8gfSk7CiAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgICAgICB0ZXh0OiAiVGhlICBlbnRpdHkgLSAiLmNvbmNhdChfdGhpczE1LnNlbGVjdGVkX2VudGl0eSwgIiAgaW4gc2VsZWN0ZWQgbm9kZSBoYXMgYmVlbiBkZWxldGVkIGZyb20gdGhlIGVudGl0aWVzIGxpc3QuUGxlYXNlIG1ha2Ugc3VyZSBpdCBpcyBhZGRlZCBpbiB0aGUgZW50aXRpZXMgbGlzdCB0byBhdm9pZCB0aGUgdW5leHBlY3RlZCBiZWhhdmlvci4iKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIENvbnRpbnVlISEiCiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgICAgIF90aGlzMTUubG9hZF9zbG90X3ZhcmlhYmxlKCk7CgogICAgICAgICAgICAgIF90aGlzMTUuZmlsdGVyX2FzaXN0YW5jZV9yZXNwb25zZSgpOwoKICAgICAgICAgICAgICBfdGhpczE1LnJlbW92ZV9jdXJyZW50X25vZGVfanVtcF9uYW1lKF90aGlzMTUubm9kZXNfbGlzdCwgX3RoaXMxNS5ub2RlX25hbWUpOwoKICAgICAgICAgICAgICAkKCIjYWRkbm9kZW1vZGFsIikubW9kYWwoInNob3ciKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzMTUubG9hZF9zbG90X3ZhcmlhYmxlKCk7CgogICAgICAgICAgX3RoaXMxNS5maWx0ZXJfYXNpc3RhbmNlX3Jlc3BvbnNlKCk7CgogICAgICAgICAgX3RoaXMxNS5yZW1vdmVfY3VycmVudF9ub2RlX2p1bXBfbmFtZShfdGhpczE1Lm5vZGVzX2xpc3QsIF90aGlzMTUubm9kZV9uYW1lKTsKCiAgICAgICAgICAkKCIjYWRkbm9kZW1vZGFsIikubW9kYWwoInNob3ciKTsKICAgICAgICB9CgogICAgICAgIF90aGlzMTUuc2VsZWN0ZWRfZW50aXR5ID0gIiI7CiAgICAgIH0sIDEwMCk7CiAgICB9LAogICAgZGVsZXRlX2FzaXN0YW5jZV9yZXNwb25zZV9ieV9pZDogZnVuY3Rpb24gZGVsZXRlX2FzaXN0YW5jZV9yZXNwb25zZV9ieV9pZChpZCkgewogICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgaWYgKGlkID09PSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5pZCkgewogICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Uuc3BsaWNlKGksIDEpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGVkaXROb2RlOiBmdW5jdGlvbiBlZGl0Tm9kZSgpIHsKICAgICAgaWYgKHRoaXMubm9kZV9uYW1lID09ICIiKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX2VudGVyX25hbWVfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudHJpZ2dlcnMubGVuZ3RoIDwgMSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9hZGRfb25lX2NvbmRpdGlvbl9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMudHJpZ2dlcnMubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCB0aGlzLnRyaWdnZXJzLmxlbmd0aDsgX2krKykgewogICAgICAgICAgaWYgKHRoaXMudHJpZ2dlcnNbX2ldLnRyaWdnZXJfdmFsdWUgPT09ICIiIHx8IHRoaXMudHJpZ2dlcnNbX2ldLnRyaWdnZXJfdmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jb25kaXRpb25fY2Fubm90X2JsYW5rX21zZzEnKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy50cmlnZ2Vyc1tfaV0udHJpZ2dlcl90eXBlID09PSAiZW50aXR5IikgewogICAgICAgICAgICBpZiAodGhpcy50cmlnZ2Vyc1tfaV0ub3BlcmFuZCA9PT0gIiIgfHwgdGhpcy50cmlnZ2Vyc1tfaV0ub3BlcmFuZCA9PT0gbnVsbCkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jb25kaXRpb25fY2Fubm90X2JsYW5rX21zZzInKSwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy50cmlnZ2Vyc1tfaV0ub3BlcmFuZCA9PT0gImlzIikgewogICAgICAgICAgICAgIGlmICh0aGlzLnRyaWdnZXJzW19pXS5lbnRpdHlfdmFsdWUgPT09ICIiIHx8IHRoaXMudHJpZ2dlcnNbX2ldLmVudGl0eV92YWx1ZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY29uZGl0aW9uX2Nhbm5vdF9ibGFua19tc2czJyksCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNfc2xvdCAmJiB0aGlzLnNsb3RzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX2FkZF9vbmVfc2xvdF9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5pc19zbG90ICYmIHRoaXMuc2xvdHMubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIGwgPSAwOyBsIDwgdGhpcy5zbG90cy5sZW5ndGg7IGwrKykgewogICAgICAgICAgdmFyIHNsb3QgPSB0aGlzLnNsb3RzW2xdOwoKICAgICAgICAgIGlmICghQm9vbGVhbihzbG90LnNsb3QpKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfZW50aXR5X2Zvcl9zbG90X21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghQm9vbGVhbihzbG90LnJlc3BvbnNlcy5sZW5ndGgpKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfcmVzcG9uc2VfdG9fc2xvdF9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5pc19zbG90ICYmIHRoaXMuc2xvdHMubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIF9sID0gMDsgX2wgPCB0aGlzLnNsb3RzLmxlbmd0aDsgX2wrKykgewogICAgICAgICAgdmFyIF9zbG90ID0gdGhpcy5zbG90c1tfbF07CgogICAgICAgICAgZm9yIChpIGluIF9zbG90LnJlc3BvbnNlcykgewogICAgICAgICAgICB0aGlzLmRlbGV0ZV9hc2lzdGFuY2VfcmVzcG9uc2VfYnlfaWQoX3Nsb3QucmVzcG9uc2VzW2ldKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuYXJyYW5nZV9pZHNfZnVuY3Rpb24oKTsKICAgICAgICB0aGlzLnNsb3RzID0gW107CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm1hbmFnZV9oYW5kbGVycy5sZW5ndGggPiAwICYmIHRoaXMuaXNfc2xvdCkgewogICAgICAgIGZvciAodmFyIGluZCA9IDA7IGluZCA8IHRoaXMubWFuYWdlX2hhbmRsZXJzLmxlbmd0aDsgaW5kKyspIHsKICAgICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXTsKCiAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vycy5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY29uZGl0aW9uX2Zvcl9tYW5hZ2VfaGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlci50cmlnZ2Vycy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9pMiA9IDA7IF9pMiA8IGhhbmRsZXIudHJpZ2dlcnMubGVuZ3RoOyBfaTIrKykgewogICAgICAgICAgICAgIGlmIChoYW5kbGVyLnRyaWdnZXJzW19pMl0udHJpZ2dlcl92YWx1ZSA9PT0gIiIgfHwgaGFuZGxlci50cmlnZ2Vyc1tfaTJdLnRyaWdnZXJfdmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX2Nhbm5vdF9ibGFua19pbl9oYW5kbGVyX21zZzEnKSwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vyc1tfaTJdLnRyaWdnZXJfdHlwZSA9PT0gImVudGl0eSIpIHsKICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyLnRyaWdnZXJzW19pMl0ub3BlcmFuZCA9PT0gIiIgfHwgaGFuZGxlci50cmlnZ2Vyc1tfaTJdLm9wZXJhbmQgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jYW5ub3RfYmxhbmtfaW5faGFuZGxlcl9tc2cyJyksCiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIudHJpZ2dlcnNbX2kyXS5vcGVyYW5kID09PSAiaXMiKSB7CiAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyLnRyaWdnZXJzW19pMl0uZW50aXR5X3ZhbHVlID09PSAiIiB8fCBoYW5kbGVyLnRyaWdnZXJzW19pMl0uZW50aXR5X3ZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX2Nhbm5vdF9ibGFua19pbl9oYW5kbGVyX21zZzMnKSwKICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGhhbmRsZXIucmVzcG9uc2VzLmxlbmd0aCA8IDEpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9vbmVfcmVzcF9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9pMyA9IDA7IF9pMyA8IGhhbmRsZXIucmVzcG9uc2VzLmxlbmd0aDsgX2kzKyspIHsKICAgICAgICAgICAgICBpZiAoaGFuZGxlci5yZXNwb25zZXNbX2kzXS50eXBlID09PSAidGV4dCIpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaGFuZGxlci5yZXNwb25zZXNbX2kzXS52YWx1ZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oaGFuZGxlci5yZXNwb25zZXNbX2kzXS52YWx1ZXNbal0pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV90ZXh0X3Jlc3BfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLnR5cGUgPT09ICJpbWFnZSIpIHsKICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKGhhbmRsZXIucmVzcG9uc2VzW19pM10uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9pbWdfcmVzcF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlZ19pbWFnZS50ZXN0KGhhbmRsZXIucmVzcG9uc2VzW19pM10uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV92YWxpZF9pbWdfdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLnR5cGUgPT09ICJ2aWRlbyIpIHsKICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKGhhbmRsZXIucmVzcG9uc2VzW19pM10uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV92aWRlb19yZXNwX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVnX3VybC50ZXN0KGhhbmRsZXIucmVzcG9uc2VzW19pM10uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV92YWxpZF92aWRlb191cmxfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRsZXIucmVzcG9uc2VzW19pM10udHlwZSA9PT0gImNob2ljZXMiKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaiA9IDA7IF9qIDwgaGFuZGxlci5yZXNwb25zZXNbX2kzXS5jaG9pY2VzLmxlbmd0aDsgX2orKykgewogICAgICAgICAgICAgICAgICBpZiAoQm9vbGVhbihoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLmNob2ljZXNbX2pdLnRpdGxlKSA9PT0gZmFsc2UgfHwgQm9vbGVhbihoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLmNob2ljZXNbX2pdLnBheWxvYWQpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jaG9pY2VfcmVzcF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRsZXIucmVzcG9uc2VzW19pM10udHlwZSA9PT0gImNhcmQiKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBfajIgPSAwOyBfajIgPCBoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLmNhcmRfbGlzdC5sZW5ndGg7IF9qMisrKSB7CiAgICAgICAgICAgICAgICAgIHZhciBjYXJvdXNlbCA9IGhhbmRsZXIucmVzcG9uc2VzW19pM10uY2FyZF9saXN0W19qMl07CgogICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwuaXNfaW1hZ2UgPT09IHRydWUpIHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVyLnJlc3BvbnNlc1tfaTNdLmNhcmRfbGlzdFtfajJdLnZpZGVvID0gIiI7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlci5yZXNwb25zZXNbX2kzXS5jYXJkX2xpc3RbX2oyXS5pbWFnZSA9ICIiOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB2YXIgYnV0dG9uX2hhc192YWx1ZSA9IGZhbHNlOwoKICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjYXJvdXNlbC5idXR0b25zLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNhcm91c2VsLmJ1dHRvbnNba10udGl0bGUgIT0gIiIgfHwgY2Fyb3VzZWwuYnV0dG9uc1trXS52YWx1ZSAhPSAiIikgewogICAgICAgICAgICAgICAgICAgICAgYnV0dG9uX2hhc192YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwudGl0bGUgPT09ICIiICYmIGNhcm91c2VsLnRleHQgPT09ICIiICYmIGNhcm91c2VsLmltYWdlID09PSAiIiAmJiBjYXJvdXNlbC52aWRlbyA9PT0gIiIgJiYgYnV0dG9uX2hhc192YWx1ZSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfY2FyZF9maWxsZWRfZm9yX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKGNhcm91c2VsLmltYWdlICE9ICIiICYmIHRoaXMucmVnX2ltYWdlLnRlc3QoY2Fyb3VzZWwuaW1hZ2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jYXJkX3ZhbGlkX2ltZ191cmxfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwudmlkZW8gIT0gIiIgJiYgdGhpcy5yZWdfdXJsLnRlc3QoY2Fyb3VzZWwudmlkZW8pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jYXJkX3ZhbGlkX3ZpZGVvX3VybF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgY2Fyb3VzZWwuYnV0dG9ucy5sZW5ndGg7IGQrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChjYXJvdXNlbC5idXR0b25zW2RdLnRpdGxlICE9ICIiICYmIGNhcm91c2VsLmJ1dHRvbnNbZF0udmFsdWUgPT0gIiIgfHwgY2Fyb3VzZWwuYnV0dG9uc1tkXS50aXRsZSA9PSAiIiAmJiBjYXJvdXNlbC5idXR0b25zW2RdLnZhbHVlICE9ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV9jYXJkX3ZhbGlkX2ltZ191cmxfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRoaXMuaXNfd2ViaG9va19kZXRhaWxzKSB7CiAgICAgICAgdGhpcy5pc193ZWJob29rID0gZmFsc2U7CiAgICAgICAgdGhpcy53ZWJob29rX21hcHBpbmcgPSB7fTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNfd2ViaG9vaykgewogICAgICAgIGlmICghQm9vbGVhbih0aGlzLndlYmhvb2tfaWQpKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX25hbWVfbXNnJyksCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFCb29sZWFuKHRoaXMud2ViaG9va192YXJpYWJsZSkpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfcmV0dXJuX3ZhcmlhYmxlX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICghQm9vbGVhbih0aGlzLndlYmhvb2tfbWFwcGluZy5sZW5ndGgpKSB7Ly8gU3dhbCh7CiAgICAgICAgICAvLyAgIHRleHQ6ICJBdGxlYXN0IGFkZCBvbmUgd2ViaG9vayBwYXJhbWV0ZXIiLAogICAgICAgICAgLy8gICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAvLyAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgLy8gICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgLy8gICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAvLyAgIHRpbWVyOiA4MDAwLAogICAgICAgICAgLy8gfSk7CiAgICAgICAgICAvLyByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLndlYmhvb2tfbWFwcGluZy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgaWYgKCFCb29sZWFuKHRoaXMud2ViaG9va19tYXBwaW5nW2luZGV4XS5rZXkpIHx8ICFCb29sZWFuKHRoaXMud2ViaG9va19tYXBwaW5nW2luZGV4XS52YWx1ZSkpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va19wYXJhX2VtcHR5X21zZzEnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5pc19ub3RpZmljYXRpb24pIHsKICAgICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS50eXBlID09ICIiIHx8IHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udHlwZSA9PSBudWxsKSB7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX3BhcmFfZW1wdHlfbXNnMicpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnNsb3QgPT0gIiIgfHwgdGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS5zbG90ID09IG51bGwpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfbm90aWZpY2F0aW9uX3R5cGVfbXNnJyksCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udGVtcGxhdGVfbmFtZSA9PSAiIiB8fCB0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnRlbXBsYXRlX25hbWUgPT0gbnVsbCkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va190ZW1wbGF0ZV9uYW1lX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzLmxlbmd0aCA8IDEpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfbm90aWZpY2F0aW9uX2Zvcl9ib3RfY2FzZXNfbXNnJyksCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgY2hlY2tfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfcmVzcG9uc2UgPSBmYWxzZTsKICAgICAgICAgIHZhciBjaGVja19ub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX3Jlc3BvbnNlID0gZmFsc2U7CgogICAgICAgICAgZm9yICh2YXIgX2wyID0gMDsgX2wyIDwgdGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcy5sZW5ndGg7IF9sMisrKSB7CiAgICAgICAgICAgIHZhciBub3RpZmljYXRpb25fcmVzcG9uc2VfaWQgPSB0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzW19sMl07CgogICAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2Vbbm90aWZpY2F0aW9uX3Jlc3BvbnNlX2lkXS5jb25kaXRpb24gPT09ICIhc3VjY2Vzc2Z1bCIpIHsKICAgICAgICAgICAgICBjaGVja19ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF9yZXNwb25zZSA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtub3RpZmljYXRpb25fcmVzcG9uc2VfaWRdLmNvbmRpdGlvbiA9PT0gIiF1bnN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICAgICAgY2hlY2tfbm90aWZpY2F0aW9uX3Vuc3VjY2Vzc2Z1bF9yZXNwb25zZSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIUJvb2xlYW4oY2hlY2tfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfcmVzcG9uc2UpKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va19ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSBpZiAoIUJvb2xlYW4oY2hlY2tfbm90aWZpY2F0aW9uX3Vuc3VjY2Vzc2Z1bF9yZXNwb25zZSkpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX25vdGlmaWNhdGlvbl91bnN1Y2Nlc3NmdWxfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAoaSBpbiB0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzKSB7CiAgICAgICAgICB0aGlzLmRlbGV0ZV9hc2lzdGFuY2VfcmVzcG9uc2VfYnlfaWQodGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlc1tpXSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmFycmFuZ2VfaWRzX2Z1bmN0aW9uKCk7CiAgICAgICAgdGhpcy5ub3RpZmljYXRpb25zID0gewogICAgICAgICAgbm90aWZ5OiBbewogICAgICAgICAgICB0eXBlOiAiIiwKICAgICAgICAgICAgc2xvdDogIiIsCiAgICAgICAgICAgIHRlbXBsYXRlX2lkOiAiIiwKICAgICAgICAgICAgdGVtcGxhdGVfbmFtZTogIiIKICAgICAgICAgIH1dLAogICAgICAgICAgcmVzcG9uc2VzOiBbXQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGggPCAxKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfb25lX3Jlc3BfdG9fbm9kZV9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBfaTQgPSAwOyBfaTQgPCB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGg7IF9pNCsrKSB7CiAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS50eXBlID09PSAidGV4dCIpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2ozID0gMDsgX2ozIDwgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS52YWx1ZXMubGVuZ3RoOyBfajMrKykgewogICAgICAgICAgICAgIGlmIChCb29sZWFuKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0udmFsdWVzW19qM10pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va190ZXh0X3Jlc3BvbnNlX21zZycpLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS50eXBlID09PSAiaW1hZ2UiKSB7CiAgICAgICAgICAgIGlmIChCb29sZWFuKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va19pbWdfcmVzcG9uc2VfbXNnJyksCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMucmVnX2ltYWdlLnRlc3QodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX3ZhbGlkX2ltZ191cmxfbXNnJyksCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaTRdLnR5cGUgPT09ICJ2aWRlbyIpIHsKICAgICAgICAgICAgaWYgKEJvb2xlYW4odGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX3ZpZGVvX3Jlc3BvbnNlX21zZycpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLnJlZ191cmwudGVzdCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaTRdLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfdmFsaWRfdmlkZW9fdXJsX21zZycpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS50eXBlID09PSAiY2hvaWNlcyIpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2o0ID0gMDsgX2o0IDwgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5jaG9pY2VzLmxlbmd0aDsgX2o0KyspIHsKICAgICAgICAgICAgICBpZiAoQm9vbGVhbih0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaTRdLmNob2ljZXNbX2o0XS50aXRsZSkgPT09IGZhbHNlIHx8IEJvb2xlYW4odGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5jaG9pY2VzW19qNF0ucGF5bG9hZCkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2VkaXRfbm9kZV93ZWJob29rX2Nob2ljZV9yZXNwb25zZV9tc2cnKSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0udHlwZSA9PT0gImNhcmQiKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9qNSA9IDA7IF9qNSA8IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pNF0uY2FyZF9saXN0Lmxlbmd0aDsgX2o1KyspIHsKICAgICAgICAgICAgICB2YXIgX2Nhcm91c2VsID0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5jYXJkX2xpc3RbX2o1XTsKCiAgICAgICAgICAgICAgaWYgKF9jYXJvdXNlbC5pc19pbWFnZSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k0XS5jYXJkX2xpc3RbX2o1XS52aWRlbyA9ICIiOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaTRdLmNhcmRfbGlzdFtfajVdLmltYWdlID0gIiI7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgX2J1dHRvbl9oYXNfdmFsdWUgPSBmYWxzZTsKCiAgICAgICAgICAgICAgZm9yICh2YXIgX2sgPSAwOyBfayA8IF9jYXJvdXNlbC5idXR0b25zLmxlbmd0aDsgX2srKykgewogICAgICAgICAgICAgICAgaWYgKF9jYXJvdXNlbC5idXR0b25zW19rXS50aXRsZSAhPSAiIiB8fCBfY2Fyb3VzZWwuYnV0dG9uc1tfa10udmFsdWUgIT0gIiIpIHsKICAgICAgICAgICAgICAgICAgX2J1dHRvbl9oYXNfdmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKF9jYXJvdXNlbC50aXRsZSA9PT0gIiIgJiYgX2Nhcm91c2VsLnRleHQgPT09ICIiICYmIF9jYXJvdXNlbC5pbWFnZSA9PT0gIiIgJiYgX2Nhcm91c2VsLnZpZGVvID09PSAiIiAmJiBfYnV0dG9uX2hhc192YWx1ZSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfZmlsbGVkX2Zvcl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwuaW1hZ2UgIT0gIiIgJiYgdGhpcy5yZWdfaW1hZ2UudGVzdChfY2Fyb3VzZWwuaW1hZ2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va192YWxpZF9pbWdfdXJsX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKF9jYXJvdXNlbC52aWRlbyAhPSAiIiAmJiB0aGlzLnJlZ191cmwudGVzdChfY2Fyb3VzZWwudmlkZW8pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdlZGl0X25vZGVfd2ViaG9va192YWxpZF92aWRlb191cmxfaGFuZGxlcl9tc2cxJyksCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZm9yICh2YXIgX2QgPSAwOyBfZCA8IF9jYXJvdXNlbC5idXR0b25zLmxlbmd0aDsgX2QrKykgewogICAgICAgICAgICAgICAgaWYgKF9jYXJvdXNlbC5idXR0b25zW19kXS50aXRsZSAhPSAiIiAmJiBfY2Fyb3VzZWwuYnV0dG9uc1tfZF0udmFsdWUgPT0gIiIgfHwgX2Nhcm91c2VsLmJ1dHRvbnNbX2RdLnRpdGxlID09ICIiICYmIF9jYXJvdXNlbC5idXR0b25zW19kXS52YWx1ZSAhPSAiIikgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZWRpdF9ub2RlX3dlYmhvb2tfdmFsaWRfaW1nX3VybF9oYW5kbGVyX21zZzEnKSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5uZXh0X3N0ZXAuYmVoYXZpb3IpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd193ZWJob29rX25leHRfc3RlcF9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5zYXZlX3RoZW5fYXNzaXN0YW50X3Nob3VsZCA9PSAianVtcF90byIgJiYgdGhpcy5qdW1wX3RvX25vZGVfaWQgPT0gIiIpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd193ZWJob29rX25leHRfaWRfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNfc2xvdCAmJiB0aGlzLnNsb3RzLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgdGhpcy5ub2RlX3R5cGUgPSAiZm9ybSI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5ub2RlX3R5cGUgPSAiYmFzaWMiOwogICAgICB9CgogICAgICB2YXIgdm0gPSB0aGlzOwoKICAgICAgX2Rmcyh2bS5kYXRhKTsKCiAgICAgIGZ1bmN0aW9uIF9kZnMob2xkTm9kZSkgewogICAgICAgIGlmIChvbGROb2RlLmNoaWxkcmVuICYmIG9sZE5vZGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG9sZE5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgaWYgKHZtLm5vZGVfaWQgPT0gb2xkTm9kZS5jaGlsZHJlbltpXS5pZCkgewogICAgICAgICAgICAgIG9sZE5vZGUuY2hpbGRyZW5baV0ubmFtZSA9IHZtLm5vZGVfbmFtZTsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLm5vZGVfbmFtZSA9IHZtLm5vZGVfdHlwZSArICJfIiArIHZtLm5vZGVfbmFtZTsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLm5vZGVfdHlwZSA9IHZtLm5vZGVfdHlwZTsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLmlzX3Jvb3QgPSB2bS5pc19yb290ID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgICAgICAgIG9sZE5vZGUuY2hpbGRyZW5baV0ucmVzcG9uc2VzID0gdm0uYXNzaXN0YW50X3Jlc3BvbnNlOwogICAgICAgICAgICAgIG9sZE5vZGUuY2hpbGRyZW5baV0uc2xvdF9zZXR0aW5nID0gdm0uaXNfc2xvdDsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLm5vdGlmaWNhdGlvbl9lbmFibGVkID0gdm0uaXNfbm90aWZpY2F0aW9uLCBvbGROb2RlLmNoaWxkcmVuW2ldLnNsb3RzID0gdm0uaXNfc2xvdCA/IHZtLnNsb3RzIDogbnVsbCwgb2xkTm9kZS5jaGlsZHJlbltpXS5ub3RpZmljYXRpb25zID0gdm0uaXNfbm90aWZpY2F0aW9uID8gdm0ubm90aWZpY2F0aW9ucyA6IG51bGwsIG9sZE5vZGUuY2hpbGRyZW5baV0ubWFuYWdlX2hhbmRsZXJzID0gdm0ubWFuYWdlX2hhbmRsZXJzLmxlbmd0aCA+IDAgJiYgdm0uaXNfc2xvdCA/IHZtLm1hbmFnZV9oYW5kbGVycyA6IG51bGwsIG9sZE5vZGUuY2hpbGRyZW5baV0udHJpZ2dlcnMgPSB2bS50cmlnZ2VyczsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLm5leHRfc3RlcCA9IHZtLm5leHRfc3RlcDsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLndlYmhvb2tfaWQgPSB2bS5pc193ZWJob29rID8gdm0ud2ViaG9va19pZCA6IG51bGw7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS53ZWJob29rX2ludGVncmF0aW9uID0gdm0uaXNfd2ViaG9vazsKICAgICAgICAgICAgICBvbGROb2RlLmNoaWxkcmVuW2ldLndlYmhvb2tfbWFwcGluZyA9IHZtLmlzX3dlYmhvb2sgPyB2bS53ZWJob29rX21hcHBpbmcgOiBudWxsOwogICAgICAgICAgICAgIG9sZE5vZGUuY2hpbGRyZW5baV0ud2ViaG9va19yZXR1cm5fdmFyaWFibGUgPSB2bS5pc193ZWJob29rID8gdm0ud2ViaG9va192YXJpYWJsZSA6IG51bGw7CiAgICAgICAgICAgICAgb2xkTm9kZS5jaGlsZHJlbltpXS5lZGl0Tm9kZURpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2RmcyhvbGROb2RlLmNoaWxkcmVuW2ldKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh2bS5uZXdfY2hpbGRfbm9kZSkgewogICAgICAgIHZtLm5vZGVzX2xpc3QucHVzaChbewogICAgICAgICAgaWQ6IHZtLm5vZGVfaWQsCiAgICAgICAgICBuYW1lOiB2bS5ub2RlX25hbWUKICAgICAgICB9XSk7CiAgICAgIH0KCiAgICAgIGlmICh2bS5uZXdfY2hpbGRfbm9kZSkgewogICAgICAgIHZtLnB1c2hOZXdUcmVlKCJjaGlsZG5vZGUiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2bS5wdXNoTmV3VHJlZSgiZWRpdG5vZGUiKTsKICAgICAgfQoKICAgICAgdm0ubmV3X2NoaWxkX25vZGUgPSBmYWxzZTsKICAgICAgdm0uaXNfc2hvd19lZGl0ID0gZmFsc2U7CiAgICAgIHZtLmVtcHR5X3ZhcmlhYmxlKCk7IC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhZGRfdHJpZ2dlcl9idG4iKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCiAgICAgICQoIiNhZGRub2RlbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgfSwKICAgIGFkZE5vZGU6IGZ1bmN0aW9uIGFkZE5vZGUoKSB7CiAgICAgIGlmICh0aGlzLm5vZGVfbmFtZSA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2VudGVyX25hbWVfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudHJpZ2dlcnMubGVuZ3RoIDwgMSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2FkZF9vbmVfY29uZGl0aW9uX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy50cmlnZ2Vycy5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yICh2YXIgX2k1ID0gMDsgX2k1IDwgdGhpcy50cmlnZ2Vycy5sZW5ndGg7IF9pNSsrKSB7CiAgICAgICAgICBpZiAodGhpcy50cmlnZ2Vyc1tfaTVdLnRyaWdnZXJfdmFsdWUgPT09ICIiIHx8IHRoaXMudHJpZ2dlcnNbX2k1XS50cmlnZ2VyX3ZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jb25kaXRpb25fY2Fubm90X2JsYW5rX21zZzEnKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy50cmlnZ2Vyc1tfaTVdLnRyaWdnZXJfdHlwZSA9PT0gImVudGl0eSIpIHsKICAgICAgICAgICAgaWYgKHRoaXMudHJpZ2dlcnNbX2k1XS5vcGVyYW5kID09PSAiIiB8fCB0aGlzLnRyaWdnZXJzW19pNV0ub3BlcmFuZCA9PT0gbnVsbCkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2NvbmRpdGlvbl9jYW5ub3RfYmxhbmtfbXNnMicpLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLnRyaWdnZXJzW19pNV0ub3BlcmFuZCA9PT0gImlzIikgewogICAgICAgICAgICAgIGlmICh0aGlzLnRyaWdnZXJzW19pNV0uZW50aXR5X3ZhbHVlID09PSAiIiB8fCB0aGlzLnRyaWdnZXJzW19pNV0uZW50aXR5X3ZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2NvbmRpdGlvbl9jYW5ub3RfYmxhbmtfbXNnMycpLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzX3Nsb3QgJiYgdGhpcy5zbG90cy5sZW5ndGggPT0gMCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2FkZF9vbmVfc2xvdF9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5pc19zbG90ICYmIHRoaXMuc2xvdHMubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIGwgPSAwOyBsIDwgdGhpcy5zbG90cy5sZW5ndGg7IGwrKykgewogICAgICAgICAgdmFyIHNsb3QgPSB0aGlzLnNsb3RzW2xdOwoKICAgICAgICAgIGlmICghQm9vbGVhbihzbG90LnNsb3QpKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9lbnRpdHlfZm9yX3Nsb3RfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFCb29sZWFuKHNsb3QucmVzcG9uc2VzLmxlbmd0aCkpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3Jlc3BvbnNlX3RvX3Nsb3RfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRoaXMuaXNfc2xvdCAmJiB0aGlzLnNsb3RzLmxlbmd0aCA+IDApIHsKICAgICAgICBmb3IgKHZhciBfbDMgPSAwOyBfbDMgPCB0aGlzLnNsb3RzLmxlbmd0aDsgX2wzKyspIHsKICAgICAgICAgIHZhciBfc2xvdDIgPSB0aGlzLnNsb3RzW19sM107CgogICAgICAgICAgZm9yIChpIGluIF9zbG90Mi5yZXNwb25zZXMpIHsKICAgICAgICAgICAgdGhpcy5kZWxldGVfYXNpc3RhbmNlX3Jlc3BvbnNlX2J5X2lkKF9zbG90Mi5yZXNwb25zZXNbaV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5hcnJhbmdlX2lkc19mdW5jdGlvbigpOwogICAgICAgIHRoaXMuc2xvdHMgPSBbXTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubWFuYWdlX2hhbmRsZXJzLmxlbmd0aCA+IDAgJiYgdGhpcy5pc19zbG90KSB7CiAgICAgICAgZm9yICh2YXIgaW5kID0gMDsgaW5kIDwgdGhpcy5tYW5hZ2VfaGFuZGxlcnMubGVuZ3RoOyBpbmQrKykgewogICAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdOwoKICAgICAgICAgIGlmIChoYW5kbGVyLnRyaWdnZXJzLmxlbmd0aCA8IDEpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2NvbmRpdGlvbl9mb3JfbWFuYWdlX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRsZXIudHJpZ2dlcnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBmb3IgKHZhciBfaTYgPSAwOyBfaTYgPCBoYW5kbGVyLnRyaWdnZXJzLmxlbmd0aDsgX2k2KyspIHsKICAgICAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vyc1tfaTZdLnRyaWdnZXJfdmFsdWUgPT09ICIiIHx8IGhhbmRsZXIudHJpZ2dlcnNbX2k2XS50cmlnZ2VyX3ZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2Nhbm5vdF9ibGFua19pbl9oYW5kbGVyX21zZzEnKSwKICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vyc1tfaTZdLnRyaWdnZXJfdHlwZSA9PT0gImVudGl0eSIpIHsKICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyLnRyaWdnZXJzW19pNl0ub3BlcmFuZCA9PT0gIiIgfHwgaGFuZGxlci50cmlnZ2Vyc1tfaTZdLm9wZXJhbmQgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2Nhbm5vdF9ibGFua19pbl9oYW5kbGVyX21zZzInKSwKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoaGFuZGxlci50cmlnZ2Vyc1tfaTZdLm9wZXJhbmQgPT09ICJpcyIpIHsKICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIudHJpZ2dlcnNbX2k2XS5lbnRpdHlfdmFsdWUgPT09ICIiIHx8IGhhbmRsZXIudHJpZ2dlcnNbX2k2XS5lbnRpdHlfdmFsdWUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jYW5ub3RfYmxhbmtfaW5faGFuZGxlcl9tc2czJyksCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChoYW5kbGVyLnJlc3BvbnNlcy5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9vbmVfcmVzcF9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9pNyA9IDA7IF9pNyA8IGhhbmRsZXIucmVzcG9uc2VzLmxlbmd0aDsgX2k3KyspIHsKICAgICAgICAgICAgICBpZiAoaGFuZGxlci5yZXNwb25zZXNbX2k3XS50eXBlID09PSAidGV4dCIpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaGFuZGxlci5yZXNwb25zZXNbX2k3XS52YWx1ZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oaGFuZGxlci5yZXNwb25zZXNbX2k3XS52YWx1ZXNbal0pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3RleHRfcmVzcF9pbl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRsZXIucmVzcG9uc2VzW19pN10udHlwZSA9PT0gImltYWdlIikgewogICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oaGFuZGxlci5yZXNwb25zZXNbX2k3XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfaW1nX3Jlc3BfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZWdfaW1hZ2UudGVzdChoYW5kbGVyLnJlc3BvbnNlc1tfaTddLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV92YWxpZF9pbWdfdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlc1tfaTddLnR5cGUgPT09ICJ2aWRlbyIpIHsKICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKGhhbmRsZXIucmVzcG9uc2VzW19pN10uc291cmNlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3ZpZGVvX3Jlc3BfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZWdfdXJsLnRlc3QoaGFuZGxlci5yZXNwb25zZXNbX2k3XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfdmFsaWRfdmlkZW9fdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyLnJlc3BvbnNlc1tfaTddLnR5cGUgPT09ICJjaG9pY2VzIikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgX2o2ID0gMDsgX2o2IDwgaGFuZGxlci5yZXNwb25zZXNbX2k3XS5jaG9pY2VzLmxlbmd0aDsgX2o2KyspIHsKICAgICAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oaGFuZGxlci5yZXNwb25zZXNbX2k3XS5jaG9pY2VzW19qNl0udGl0bGUpID09PSBmYWxzZSB8fCBCb29sZWFuKGhhbmRsZXIucmVzcG9uc2VzW19pN10uY2hvaWNlc1tfajZdLnBheWxvYWQpID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2Nob2ljZV9yZXNwX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlci5yZXNwb25zZXNbX2k3XS50eXBlID09PSAiY2FyZCIpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIF9qNyA9IDA7IF9qNyA8IGhhbmRsZXIucmVzcG9uc2VzW19pN10uY2FyZF9saXN0Lmxlbmd0aDsgX2o3KyspIHsKICAgICAgICAgICAgICAgICAgdmFyIGNhcm91c2VsID0gaGFuZGxlci5yZXNwb25zZXNbX2k3XS5jYXJkX2xpc3RbX2o3XTsKCiAgICAgICAgICAgICAgICAgIGlmIChjYXJvdXNlbC5pc19pbWFnZSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIGhhbmRsZXIucmVzcG9uc2VzW19pN10uY2FyZF9saXN0W19qN10udmlkZW8gPSAiIjsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVyLnJlc3BvbnNlc1tfaTddLmNhcmRfbGlzdFtfajddLmltYWdlID0gIiI7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHZhciBidXR0b25faGFzX3ZhbHVlID0gZmFsc2U7CgogICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGNhcm91c2VsLmJ1dHRvbnMubGVuZ3RoOyBrKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwuYnV0dG9uc1trXS50aXRsZSAhPSAiIiB8fCBjYXJvdXNlbC5idXR0b25zW2tdLnZhbHVlICE9ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICBidXR0b25faGFzX3ZhbHVlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmIChjYXJvdXNlbC50aXRsZSA9PT0gIiIgJiYgY2Fyb3VzZWwudGV4dCA9PT0gIiIgJiYgY2Fyb3VzZWwuaW1hZ2UgPT09ICIiICYmIGNhcm91c2VsLnZpZGVvID09PSAiIiAmJiBidXR0b25faGFzX3ZhbHVlID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2NhcmRfZmlsbGVkX2Zvcl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmIChjYXJvdXNlbC5pbWFnZSAhPSAiIiAmJiB0aGlzLnJlZ19pbWFnZS50ZXN0KGNhcm91c2VsLmltYWdlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV9jYXJkX3ZhbGlkX2ltZ191cmxfaW5faGFuZGxlcl9tc2cnKSwKICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpZiAoY2Fyb3VzZWwudmlkZW8gIT0gIiIgJiYgdGhpcy5yZWdfdXJsLnRlc3QoY2Fyb3VzZWwudmlkZW8pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX2NhcmRfdmFsaWRfdmlkZW9fdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBjYXJvdXNlbC5idXR0b25zLmxlbmd0aDsgZCsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNhcm91c2VsLmJ1dHRvbnNbZF0udGl0bGUgIT0gIiIgJiYgY2Fyb3VzZWwuYnV0dG9uc1tkXS52YWx1ZSA9PSAiIiB8fCBjYXJvdXNlbC5idXR0b25zW2RdLnRpdGxlID09ICIiICYmIGNhcm91c2VsLmJ1dHRvbnNbZF0udmFsdWUgIT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfY2FyZF92YWxpZF9pbWdfdXJsX2luX2hhbmRsZXJfbXNnJyksCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmlzX3dlYmhvb2tfZGV0YWlscykgewogICAgICAgIHRoaXMuaXNfd2ViaG9vayA9IGZhbHNlOwogICAgICAgIHRoaXMud2ViaG9va19tYXBwaW5nID0gW107CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzX3dlYmhvb2spIHsKICAgICAgICBpZiAoIUJvb2xlYW4odGhpcy53ZWJob29rX2lkKSkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX25hbWVfbXNnJyksCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFCb29sZWFuKHRoaXMud2ViaG9va192YXJpYWJsZSkpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va19yZXR1cm5fdmFyaWFibGVfbXNnJyksCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFCb29sZWFuKHRoaXMud2ViaG9va19tYXBwaW5nLmxlbmd0aCkpIHsvLyBTd2FsKHsKICAgICAgICAgIC8vICAgdGV4dDogIkF0bGVhc3QgYWRkIG9uZSB3ZWJob29rIHBhcmFtZXRlciIsCiAgICAgICAgICAvLyAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIC8vICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAvLyAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAvLyAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIC8vICAgdGltZXI6IDgwMDAsCiAgICAgICAgICAvLyB9KTsKICAgICAgICAgIC8vIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMud2ViaG9va19tYXBwaW5nLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICBpZiAoIUJvb2xlYW4odGhpcy53ZWJob29rX21hcHBpbmdbaW5kZXhdLmtleSkgfHwgIUJvb2xlYW4odGhpcy53ZWJob29rX21hcHBpbmdbaW5kZXhdLnZhbHVlKSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfcGFyYV9lbXB0eV9tc2cxJyksCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNfbm90aWZpY2F0aW9uKSB7CiAgICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udHlwZSA9PSAiIiB8fCB0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnR5cGUgPT0gbnVsbCkgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX25vdGlmaWNhdGlvbl90eXBlX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnNsb3QgPT0gIiIgfHwgdGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS5zbG90ID09IG51bGwpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va19lbnRlcl9uYW1lX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnRlbXBsYXRlX25hbWUgPT0gIiIgfHwgdGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS50ZW1wbGF0ZV9uYW1lID09IG51bGwpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va190ZW1wbGF0ZV9uYW1lX21zZycpLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzLmxlbmd0aCA8IDEpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va19ub3RpZmljYXRpb25fZm9yX2JvdF9jYXNlc19tc2cnKSwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBjaGVja19ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF9yZXNwb25zZSA9IGZhbHNlOwogICAgICAgICAgdmFyIGNoZWNrX25vdGlmaWNhdGlvbl91bnN1Y2Nlc3NmdWxfcmVzcG9uc2UgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKHZhciBfbDQgPSAwOyBfbDQgPCB0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzLmxlbmd0aDsgX2w0KyspIHsKICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbl9yZXNwb25zZV9pZCA9IHRoaXMubm90aWZpY2F0aW9ucy5yZXNwb25zZXNbX2w0XTsKCiAgICAgICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtub3RpZmljYXRpb25fcmVzcG9uc2VfaWRdLmNvbmRpdGlvbiA9PT0gIiFzdWNjZXNzZnVsIikgewogICAgICAgICAgICAgIGNoZWNrX25vdGlmaWNhdGlvbl9zdWNjZXNzZnVsX3Jlc3BvbnNlID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW25vdGlmaWNhdGlvbl9yZXNwb25zZV9pZF0uY29uZGl0aW9uID09PSAiIXVuc3VjY2Vzc2Z1bCIpIHsKICAgICAgICAgICAgICBjaGVja19ub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX3Jlc3BvbnNlID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmICghQm9vbGVhbihjaGVja19ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF9yZXNwb25zZSkpIHsKICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfbm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgaWYgKCFCb29sZWFuKGNoZWNrX25vdGlmaWNhdGlvbl91bnN1Y2Nlc3NmdWxfcmVzcG9uc2UpKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX25vdGlmaWNhdGlvbl91bnN1Y2Nlc3NmdWxfbXNnJyksCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAoaSBpbiB0aGlzLm5vdGlmaWNhdGlvbnMucmVzcG9uc2VzKSB7CiAgICAgICAgICB0aGlzLmRlbGV0ZV9hc2lzdGFuY2VfcmVzcG9uc2VfYnlfaWQodGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlc1tpXSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmFycmFuZ2VfaWRzX2Z1bmN0aW9uKCk7CiAgICAgICAgdGhpcy5ub3RpZmljYXRpb25zID0gewogICAgICAgICAgbm90aWZ5OiBbewogICAgICAgICAgICB0eXBlOiAiIiwKICAgICAgICAgICAgc2xvdDogIiIsCiAgICAgICAgICAgIHRlbXBsYXRlX2lkOiAiIiwKICAgICAgICAgICAgdGVtcGxhdGVfbmFtZTogIiIKICAgICAgICAgIH1dLAogICAgICAgICAgcmVzcG9uc2VzOiBbXQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGggPCAxKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va19vbmVfcmVzcF90b19ub2RlX21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIF9pOCA9IDA7IF9pOCA8IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aDsgX2k4KyspIHsKICAgICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLnR5cGUgPT09ICJ0ZXh0IikgewogICAgICAgICAgICBmb3IgKHZhciBfajggPSAwOyBfajggPCB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLnZhbHVlcy5sZW5ndGg7IF9qOCsrKSB7CiAgICAgICAgICAgICAgaWYgKEJvb2xlYW4odGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS52YWx1ZXNbX2o4XSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfdGV4dF9yZXNwb25zZV9tc2cnKSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0udHlwZSA9PT0gImltYWdlIikgewogICAgICAgICAgICBpZiAoQm9vbGVhbih0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va19pbWdfcmVzcG9uc2VfbXNnJyksCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMucmVnX2ltYWdlLnRlc3QodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfdmFsaWRfaW1nX3VybF9tc2cnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW19pOF0udHlwZSA9PT0gInZpZGVvIikgewogICAgICAgICAgICBpZiAoQm9vbGVhbih0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLnNvdXJjZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnYWRkX25vZGVfd2ViaG9va192aWRlb19yZXNwb25zZV9tc2cnKSwKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy5yZWdfdXJsLnRlc3QodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5zb3VyY2UpID09PSBmYWxzZSkgewogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfdmFsaWRfdmlkZW9fdXJsX21zZycpLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdGltZXI6IDgwMDAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS50eXBlID09PSAiY2hvaWNlcyIpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2o5ID0gMDsgX2o5IDwgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5jaG9pY2VzLmxlbmd0aDsgX2o5KyspIHsKICAgICAgICAgICAgICBpZiAoQm9vbGVhbih0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLmNob2ljZXNbX2o5XS50aXRsZSkgPT09IGZhbHNlIHx8IEJvb2xlYW4odGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5jaG9pY2VzW19qOV0ucGF5bG9hZCkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfY2hvaWNlX3Jlc3BvbnNlX21zZycpLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS50eXBlID09PSAiY2FyZCIpIHsKICAgICAgICAgICAgZm9yICh2YXIgX2oxMCA9IDA7IF9qMTAgPCB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLmNhcmRfbGlzdC5sZW5ndGg7IF9qMTArKykgewogICAgICAgICAgICAgIHZhciBfY2Fyb3VzZWwyID0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbX2k4XS5jYXJkX2xpc3RbX2oxMF07CgogICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwyLmlzX2ltYWdlID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLmNhcmRfbGlzdFtfajEwXS52aWRlbyA9ICIiOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtfaThdLmNhcmRfbGlzdFtfajEwXS5pbWFnZSA9ICIiOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIF9idXR0b25faGFzX3ZhbHVlMiA9IGZhbHNlOwoKICAgICAgICAgICAgICBmb3IgKHZhciBfazIgPSAwOyBfazIgPCBfY2Fyb3VzZWwyLmJ1dHRvbnMubGVuZ3RoOyBfazIrKykgewogICAgICAgICAgICAgICAgaWYgKF9jYXJvdXNlbDIuYnV0dG9uc1tfazJdLnRpdGxlICE9ICIiIHx8IF9jYXJvdXNlbDIuYnV0dG9uc1tfazJdLnZhbHVlICE9ICIiKSB7CiAgICAgICAgICAgICAgICAgIF9idXR0b25faGFzX3ZhbHVlMiA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoX2Nhcm91c2VsMi50aXRsZSA9PT0gIiIgJiYgX2Nhcm91c2VsMi50ZXh0ID09PSAiIiAmJiBfY2Fyb3VzZWwyLmltYWdlID09PSAiIiAmJiBfY2Fyb3VzZWwyLnZpZGVvID09PSAiIiAmJiBfYnV0dG9uX2hhc192YWx1ZTIgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfZmlsbGVkX2Zvcl9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwyLmltYWdlICE9ICIiICYmIHRoaXMucmVnX2ltYWdlLnRlc3QoX2Nhcm91c2VsMi5pbWFnZSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2FkZF9ub2RlX3dlYmhvb2tfdmFsaWRfaW1nX3VybF9oYW5kbGVyX21zZycpLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHRpbWVyOiA4MDAwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChfY2Fyb3VzZWwyLnZpZGVvICE9ICIiICYmIHRoaXMucmVnX3VybC50ZXN0KF9jYXJvdXNlbDIudmlkZW8pID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX3ZhbGlkX3ZpZGVvX3VybF9oYW5kbGVyX21zZzEnKSwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICB0aW1lcjogODAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3IgKHZhciBfZDIgPSAwOyBfZDIgPCBfY2Fyb3VzZWwyLmJ1dHRvbnMubGVuZ3RoOyBfZDIrKykgewogICAgICAgICAgICAgICAgaWYgKF9jYXJvdXNlbDIuYnV0dG9uc1tfZDJdLnRpdGxlICE9ICIiICYmIF9jYXJvdXNlbDIuYnV0dG9uc1tfZDJdLnZhbHVlID09ICIiIHx8IF9jYXJvdXNlbDIuYnV0dG9uc1tfZDJdLnRpdGxlID09ICIiICYmIF9jYXJvdXNlbDIuYnV0dG9uc1tfZDJdLnZhbHVlICE9ICIiKSB7CiAgICAgICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdhZGRfbm9kZV93ZWJob29rX3ZhbGlkX2ltZ191cmxfaGFuZGxlcl9tc2cxJyksCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRoaXMubmV4dF9zdGVwLmJlaGF2aW9yKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfd2ViaG9va19uZXh0X3N0ZXBfbXNnMScpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNhdmVfdGhlbl9hc3Npc3RhbnRfc2hvdWxkID09ICJqdW1wX3RvIiAmJiB0aGlzLmp1bXBfdG9fbm9kZV9pZCA9PSAiIikgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X3dlYmhvb2tfbmV4dF9pZF9tc2cxJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNfc2xvdCAmJiB0aGlzLnNsb3RzLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgdGhpcy5ub2RlX3R5cGUgPSAiZm9ybSI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5ub2RlX3R5cGUgPSAiYmFzaWMiOwogICAgICB9CgogICAgICB2YXIgbmV3X3RyaWdnZXJzID0gdGhpcy50cmlnZ2VyczsKICAgICAgdmFyIG5ld19hc3Npc3RhbnRfcmVzcG9uc2UgPSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZTsKICAgICAgdmFyIG5ld19zbG90cyA9IHRoaXMuc2xvdHM7CiAgICAgIHZhciB3ZWJob29rX21hcHBpbmcgPSB0aGlzLndlYmhvb2tfbWFwcGluZzsKICAgICAgdmFyIG1hbmFnZV9oYW5kbGVycyA9IHRoaXMubWFuYWdlX2hhbmRsZXJzOwogICAgICB2YXIgbmV3X25leHRfc3RlcCA9IHRoaXMubmV4dF9zdGVwOwogICAgICB2YXIgbm9kZSA9IG5ldyBUcmVlTm9kZSh7CiAgICAgICAgbmFtZTogdGhpcy5ub2RlX25hbWUsCiAgICAgICAgbm9kZV9uYW1lOiB0aGlzLm5vZGVfdHlwZSArICJfIiArIHRoaXMubm9kZV9uYW1lLAogICAgICAgIG5vZGVfdHlwZTogdGhpcy5ub2RlX3R5cGUsCiAgICAgICAgaXNfbGVhZjogZmFsc2UsCiAgICAgICAgaXNfcm9vdDogdHJ1ZSwKICAgICAgICB0cmlnZ2VyczogbmV3X3RyaWdnZXJzLAogICAgICAgIHJlc3BvbnNlczogbmV3X2Fzc2lzdGFudF9yZXNwb25zZSwKICAgICAgICBzbG90X3NldHRpbmc6IHRoaXMuaXNfc2xvdCwKICAgICAgICBub3RpZmljYXRpb25fZW5hYmxlZDogdGhpcy5pc19ub3RpZmljYXRpb24sCiAgICAgICAgc2xvdHM6IHRoaXMuaXNfc2xvdCA/IG5ld19zbG90cyA6IG51bGwsCiAgICAgICAgbm90aWZpY2F0aW9uczogdGhpcy5pc19ub3RpZmljYXRpb24gPyB0aGlzLm5vdGlmaWNhdGlvbnMgOiBudWxsLAogICAgICAgIG5leHRfc3RlcDogbmV3X25leHRfc3RlcCwKICAgICAgICB3ZWJob29rX2ludGVncmF0aW9uOiB0aGlzLmlzX3dlYmhvb2ssCiAgICAgICAgd2ViaG9va19pZDogdGhpcy5pc193ZWJob29rID8gdGhpcy53ZWJob29rX2lkIDogbnVsbCwKICAgICAgICB3ZWJob29rX3JldHVybl92YXJpYWJsZTogdGhpcy5pc193ZWJob29rID8gdGhpcy53ZWJob29rX3ZhcmlhYmxlIDogIiIsCiAgICAgICAgd2ViaG9va19tYXBwaW5nOiB0aGlzLmlzX3dlYmhvb2sgPyB3ZWJob29rX21hcHBpbmcgOiBudWxsLAogICAgICAgIGVkaXROb2RlRGlzYWJsZWQ6IHRydWUsCiAgICAgICAgbWFuYWdlX2hhbmRsZXJzOiBtYW5hZ2VfaGFuZGxlcnMubGVuZ3RoID4gMCAmJiB0aGlzLmlzX3Nsb3QgPyBtYW5hZ2VfaGFuZGxlcnMgOiBudWxsIC8vIGFkZFRyZWVOb2RlRGlzYWJsZWQ6IHRydWUsCiAgICAgICAgLy8gYWRkTGVhZk5vZGVEaXNhYmxlZDogdHJ1ZQoKICAgICAgfSk7CiAgICAgIGlmICghdGhpcy5kYXRhLmNoaWxkcmVuKSB0aGlzLmRhdGEuY2hpbGRyZW4gPSBbXTsKICAgICAgdGhpcy5kYXRhLmFkZENoaWxkcmVuKG5vZGUpOwogICAgICB0aGlzLm5vZGVzX2xpc3QucHVzaChbewogICAgICAgIGlkOiBub2RlLmlkLAogICAgICAgIG5hbWU6IG5vZGUubmFtZQogICAgICB9XSk7CiAgICAgIHRoaXMucHVzaE5ld1RyZWUoImFkZG5vZGUiKTsKICAgICAgdGhpcy5lbXB0eV92YXJpYWJsZSgpOyAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYWRkX3RyaWdnZXJfYnRuIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CgogICAgICAkKCIjYWRkbm9kZW1vZGFsIikubW9kYWwoImhpZGUiKTsKICAgIH0sCiAgICBlbXB0eV92YXJpYWJsZTogZnVuY3Rpb24gZW1wdHlfdmFyaWFibGUoKSB7CiAgICAgIHRoaXMubm9kZV9pZCA9ICIiOwogICAgICB0aGlzLm5vZGVfbmFtZSA9ICIiOwogICAgICB0aGlzLm5vZGVfdHlwZSA9ICIiOwogICAgICB0aGlzLmlzX3Jvb3QgPSBmYWxzZTsKICAgICAgdGhpcy5pc19zbG90ID0gZmFsc2U7CiAgICAgIHRoaXMuaXNfbm90aWZpY2F0aW9uID0gZmFsc2U7CiAgICAgIHRoaXMuaXNfd2ViaG9vayA9IGZhbHNlOwogICAgICB0aGlzLndlYmhvb2tfaWQgPSBudWxsOwogICAgICB0aGlzLndlYmhvb2tfdmFyaWFibGUgPSAiIjsKICAgICAgdGhpcy53ZWJob29rX21hcHBpbmcgPSBbXTsKICAgICAgdGhpcy50cmlnZ2VycyA9IFt7CiAgICAgICAgdHJpZ2dlcl90eXBlOiAiIiwKICAgICAgICB0cmlnZ2VyX3ZhbHVlOiAiIgogICAgICB9XTsKICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UgPSBbXTsKICAgICAgdGhpcy5maWx0ZXJlZF9hc3Npc3RhbnRfcmVzcG9uc2UgPSBbXTsKICAgICAgdGhpcy5zbG90cyA9IFtdOwogICAgICB0aGlzLm1hbmFnZV9oYW5kbGVycyA9IFtdOwogICAgICB0aGlzLm5vdGlmaWNhdGlvbnMgPSB7CiAgICAgICAgbm90aWZ5OiBbewogICAgICAgICAgdHlwZTogIiIsCiAgICAgICAgICBzbG90OiAiIiwKICAgICAgICAgIHRlbXBsYXRlX2lkOiAiIiwKICAgICAgICAgIHRlbXBsYXRlX25hbWU6ICIiCiAgICAgICAgfV0sCiAgICAgICAgcmVzcG9uc2VzOiBbXQogICAgICB9LCB0aGlzLm5leHRfc3RlcCA9IHt9OwogICAgICB0aGlzLnNhdmVfdGhlbl9hc3Npc3RhbnRfc2hvdWxkID0gIiI7CiAgICAgIHRoaXMuanVtcF90b19ub2RlX2lkID0gIiI7CiAgICAgIHRoaXMuaXNfc2hvd19lZGl0ID0gZmFsc2U7CiAgICAgIHRoaXMudXBkYXRlZF9ub2RlX2xpc3QgPSBbXTsgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFkZF90cmlnZ2VyX2J0biIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgfSwKICAgIHB1c2hOZXdUcmVlOiBmdW5jdGlvbiBwdXNoTmV3VHJlZShmcm9tKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIHZhciB2bSA9IHRoaXM7CgogICAgICBmdW5jdGlvbiBfZGZzKG9sZE5vZGUpIHsKICAgICAgICB2YXIgbmV3Tm9kZSA9IHt9OwoKICAgICAgICBmb3IgKHZhciBrIGluIG9sZE5vZGUpIHsKICAgICAgICAgIGlmIChrICE9PSAiY2hpbGRyZW4iICYmIGsgIT09ICJwYXJlbnQiKSB7CiAgICAgICAgICAgIG5ld05vZGVba10gPSBvbGROb2RlW2tdOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKG9sZE5vZGUuY2hpbGRyZW4gJiYgb2xkTm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICBuZXdOb2RlLmNoaWxkcmVuID0gW107CgogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG9sZE5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgbmV3Tm9kZS5jaGlsZHJlbi5wdXNoKF9kZnMob2xkTm9kZS5jaGlsZHJlbltpXSkpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBuZXdOb2RlLmNoaWxkcmVuID0gW107CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3Tm9kZTsKICAgICAgfQoKICAgICAgdm0ubmV3VHJlZSA9IF9kZnModm0uZGF0YSk7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmZvcm1fYXV0b21hdGlvbl9kaWFsb2dfdHJlZSgpLCB7CiAgICAgICAgY29tcGFueV9pZDogdm0uJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGNvbXBhbnlfbmFtZTogdm0uJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgaXNfc2F2ZTogdHJ1ZSwKICAgICAgICBub2RlX3N0cnVjdHVyZTogdm0ubmV3VHJlZQogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgJCgiI2FkZG5vZGVtb2RhbCIpLm1vZGFsKCJoaWRlIik7CgogICAgICAgIGlmIChfdGhpczE2LmFwaV9zdGF0dXNfY29kZS5OT0RFX1NUUlVDVFVSRV9TQVZFRF9NT0RFTFMuTVNHX0NPREUgPT09IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSkgewogICAgICAgICAgaWYgKGZyb20gPT0gImFkZG5vZGUiKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0ZXh0OiBfdGhpczE2LnRsdCgnZGlhbG9nX2Zsb3dfbm9kZV9hZGRlZF9tc2cnKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAoZnJvbSA9PSAiY2hpbGRub2RlIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgdGV4dDogX3RoaXMxNi50bHQoJ2RpYWxvZ19mbG93X2NoaWxkX25vZGVfYWRkZWRfbXNnJyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGZyb20gPT0gImVkaXRub2RlIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgdGV4dDogX3RoaXMxNi50bHQoJ2RpYWxvZ19mbG93X25vZGVfZWRpdGVkX21zZycpLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmIChmcm9tID09ICJkZWxldGVub2RlIikgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgdGV4dDogX3RoaXMxNi50bHQoJ2RpYWxvZ19mbG93X25vZGVfZGVsZXRlZF9tc2cnKSwKICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0ZXh0OiBfdGhpczE2LnRsdCgnZGlhbG9nX2Zsb3dfZGlhbG9nX3VwZGF0ZWRfbXNnJyksCiAgICAgICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChfdGhpczE2LmFwaV9zdGF0dXNfY29kZS5OT0RFX1NUUlVDVFVSRV9OT1RfU0FWRURfTU9ERUxTLk1TR19DT0RFID09PSByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczE2LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgIF90aGlzMTYuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5jbG9zZV9tb2RhbCgnc2F2ZV9jaGFuZ2VzX2J0bicpOwogICAgfSwKICAgIHRlc3ROZXdUcmVlOiBmdW5jdGlvbiB0ZXN0TmV3VHJlZSgpIHsKICAgICAgdmFyIHZtID0gdGhpczsKCiAgICAgIGZ1bmN0aW9uIF9kZnMob2xkTm9kZSkgewogICAgICAgIHZhciBuZXdOb2RlID0ge307CgogICAgICAgIGZvciAodmFyIGsgaW4gb2xkTm9kZSkgewogICAgICAgICAgaWYgKGsgIT09ICJjaGlsZHJlbiIgJiYgayAhPT0gInBhcmVudCIpIHsKICAgICAgICAgICAgbmV3Tm9kZVtrXSA9IG9sZE5vZGVba107CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAob2xkTm9kZS5jaGlsZHJlbiAmJiBvbGROb2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgIG5ld05vZGUuY2hpbGRyZW4gPSBbXTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gb2xkTm9kZS5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICBuZXdOb2RlLmNoaWxkcmVuLnB1c2goX2RmcyhvbGROb2RlLmNoaWxkcmVuW2ldKSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3Tm9kZTsKICAgICAgfQoKICAgICAgdm0ubmV3VHJlZSA9IF9kZnModm0uZGF0YSk7CiAgICB9LAogICAgcmVtb3ZlX2N1cnJlbnRfbm9kZV9qdW1wX25hbWU6IGZ1bmN0aW9uIHJlbW92ZV9jdXJyZW50X25vZGVfanVtcF9uYW1lKGFyciwgdmFsdWUpIHsKICAgICAgdmFyIHVwZGF0ZV9saXN0ID0gZmFsc2U7CgogICAgICBmb3IgKHZhciBfaTkgPSAwLCBsZW4gPSBhcnIubGVuZ3RoOyBfaTkgPCBsZW47IF9pOSsrKSB7CiAgICAgICAgdmFyIGZvdW5kID0gYXJyW19pOV0uc29tZShmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICByZXR1cm4gdmFsLm5hbWUgPT09IHZhbHVlOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoZm91bmQgPT0gdHJ1ZSkgewogICAgICAgICAgdGhpcy51cGRhdGVkX25vZGVfbGlzdCA9IGFycltfaTldLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS5uYW1lICE9PSB2YWx1ZTsKICAgICAgICAgIH0pOwogICAgICAgICAgdXBkYXRlX2xpc3QgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodXBkYXRlX2xpc3QgPT09IGZhbHNlKSB7CiAgICAgICAgdGhpcy51cGRhdGVkX25vZGVfbGlzdCA9IFtdOwogICAgICB9CiAgICB9LAogICAgc2V0X25leHRfc3RlcDogZnVuY3Rpb24gc2V0X25leHRfc3RlcCgpIHsKICAgICAgdGhpcy5uZXh0X3N0ZXAgPSB7CiAgICAgICAgYmVoYXZpb3I6IHRoaXMuc2F2ZV90aGVuX2Fzc2lzdGFudF9zaG91bGQsCiAgICAgICAgbm9kZV9pZDogdGhpcy5zYXZlX3RoZW5fYXNzaXN0YW50X3Nob3VsZCA9PSAianVtcF90byIgPyB0aGlzLmp1bXBfdG9fbm9kZV9pZC50b1N0cmluZygpIDogbnVsbCwKICAgICAgICBzZWxlY3RvcjogdGhpcy5zYXZlX3RoZW5fYXNzaXN0YW50X3Nob3VsZCA9PSAianVtcF90byIgPyAicmVzcG9uZCIgOiAid2FpdF9mb3JfdXNlcl9pbnB1dCIKICAgICAgfTsKICAgIH0sCiAgICBhZGRfdG9fdHJpZ2dlcnNfbGlzdDogZnVuY3Rpb24gYWRkX3RvX3RyaWdnZXJzX2xpc3QoZnVuYywgaW5kZXgpIHsKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIpIHsKICAgICAgICB0aGlzLnRyaWdnZXJzLnB1c2goewogICAgICAgICAgdHJpZ2dlcl90eXBlOiAiIiwKICAgICAgICAgIHRyaWdnZXJfdmFsdWU6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMudHJpZ2dlcnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfSAvLyBpZiAodGhpcy5pc19yb290ICYmIHRoaXMudHJpZ2dlcnMubGVuZ3RoID4gMCkgewogICAgICAvLyAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhZGRfdHJpZ2dlcl9idG4iKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAvLyB9CgogICAgfSwKICAgIG1hbmFnZV9oYW5kbGVyc19jaGFuZ2VfdHJpZ2dlcl92YWx1ZTogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2NoYW5nZV90cmlnZ2VyX3ZhbHVlKHR5cGUsIGluZGV4LCBpbmQpIHsKICAgICAgaWYgKHR5cGUgPT09ICJpbnRlbnQiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0udHJpZ2dlcl92YWx1ZSA9ICIiOwogICAgICAgIGRlbGV0ZSB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS5vcGVyYW5kOwogICAgICAgIGRlbGV0ZSB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWU7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gImVudGl0eSIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS50cmlnZ2VyX3ZhbHVlID0gIiI7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0ub3BlcmFuZCA9ICIiOwogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdLmVudGl0eV92YWx1ZSA9ICIiOwogICAgICB9CiAgICB9LAogICAgY2hhbmdlX3RyaWdnZXJfdmFsdWU6IGZ1bmN0aW9uIGNoYW5nZV90cmlnZ2VyX3ZhbHVlKHR5cGUsIGluZGV4KSB7CiAgICAgIGlmICh0eXBlID09PSAiaW50ZW50IikgewogICAgICAgIHRoaXMudHJpZ2dlcnNbaW5kZXhdLnRyaWdnZXJfdmFsdWUgPSAiIjsKICAgICAgICBkZWxldGUgdGhpcy50cmlnZ2Vyc1tpbmRleF0ub3BlcmFuZDsKICAgICAgICBkZWxldGUgdGhpcy50cmlnZ2Vyc1tpbmRleF0uZW50aXR5X3ZhbHVlOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJlbnRpdHkiKSB7CiAgICAgICAgdGhpcy50cmlnZ2Vyc1tpbmRleF0udHJpZ2dlcl92YWx1ZSA9ICIiOwogICAgICAgIHRoaXMudHJpZ2dlcnNbaW5kZXhdLm9wZXJhbmQgPSAiIjsKICAgICAgICB0aGlzLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWUgPSAiIjsKICAgICAgfQogICAgfSwKICAgIG1hbmFnZV9oYW5kbGVyc19jaGFuZ2VfdHJpZ2dlcl90eXBlOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfY2hhbmdlX3RyaWdnZXJfdHlwZSh0eXBlLCB2YWx1ZSwgaW5kZXgsIGluZCkgewogICAgICBpZiAodHlwZSA9PT0gImludGVudCIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLm5hbWUgPSAiIyIgKyB2YWx1ZTsKICAgICAgICBkZWxldGUgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0ub3BlcmFuZDsKICAgICAgICBkZWxldGUgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2Vyc1tpbmRleF0uZW50aXR5X3ZhbHVlOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJlbnRpdHkiKSB7CiAgICAgICAgaWYgKHZhbHVlLnN1YnN0cmluZygwLCAxKSA9PT0gIkAiKSB7CiAgICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLm5hbWUgPSAiIyIgKyB2YWx1ZS5zdWJzdHJpbmcoMSwgdmFsdWUubGVuZ3RoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5uYW1lID0gIiMiICsgdmFsdWU7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5pc19lbnRpdHlfdHlwZV9zeXNfcGF0dGVybih2YWx1ZSkpIHsKICAgICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdLm9wZXJhbmQgPSAiYW55IjsKICAgICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdLmVudGl0eV92YWx1ZSA9ICIiOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS5vcGVyYW5kID0gIiI7CiAgICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWUgPSAiIjsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBjaGFuZ2VfdHJpZ2dlcl90eXBlOiBmdW5jdGlvbiBjaGFuZ2VfdHJpZ2dlcl90eXBlKHR5cGUsIHZhbHVlLCBpbmRleCkgewogICAgICAvLyBAY2xpY2s9ImNoYW5nZV90cmlnZ2VyX3R5cGUodHJpZ2dlci50cmlnZ2VyX3ZhbHVlLCBpbmRleCkiCiAgICAgIC8vIEhlcmUgYWRkIGRldGVjdGlvbiBvZiB3aGV0aGVyIHRoZSB2YWx1ZSBzZWxlY3RlZCBpcyBpbnRlbnQgb3IgZW50aXR5CiAgICAgIC8vIGlmIChCb29sZWFuKHZhbHVlLmVudGl0eSkpIHsKICAgICAgLy8gICB0aGlzLnRyaWdnZXJzW2luZGV4XS50cmlnZ2VyX3R5cGUgPSAiZW50aXR5IjsKICAgICAgLy8gfSBlbHNlIHsKICAgICAgLy8gICB0aGlzLnRyaWdnZXJzW2luZGV4XS50cmlnZ2VyX3R5cGUgPSAiaW50ZW50IjsKICAgICAgLy8gfQogICAgICBpZiAodGhpcy5pc19yb290KSB7CiAgICAgICAgdGhpcy50cmlnZ2Vyc1tpbmRleF0udHJpZ2dlcl90eXBlID0gImludGVudCI7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlID09PSAiaW50ZW50IikgewogICAgICAgIGRlbGV0ZSB0aGlzLnRyaWdnZXJzW2luZGV4XS5vcGVyYW5kOwogICAgICAgIGRlbGV0ZSB0aGlzLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWU7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gImVudGl0eSIpIHsKICAgICAgICBpZiAodGhpcy5pc19lbnRpdHlfdHlwZV9zeXNfcGF0dGVybih2YWx1ZSkpIHsKICAgICAgICAgIHRoaXMudHJpZ2dlcnNbaW5kZXhdLm9wZXJhbmQgPSAiYW55IjsKICAgICAgICAgIHRoaXMudHJpZ2dlcnNbaW5kZXhdLmVudGl0eV92YWx1ZSA9ICIiOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnRyaWdnZXJzW2luZGV4XS5vcGVyYW5kID0gIiI7CiAgICAgICAgICB0aGlzLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWUgPSAiIjsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfY2hhbmdlX3RyaWdnZXJfZW50aXR5X3ZhbHVlOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfY2hhbmdlX3RyaWdnZXJfZW50aXR5X3ZhbHVlKG9wZXJhbmQsIGluZGV4LCBpbmQpIHsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdm0uJHNldCh2bS5tYW5hZ2VfaGFuZGxlcnNbaW5kXS50cmlnZ2VycywgaW5kZXgsIHZtLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzW2luZGV4XSk7CiAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdLmVudGl0eV92YWx1ZSA9ICIiOwogICAgfSwKICAgIGNoYW5nZV90cmlnZ2VyX2VudGl0eV92YWx1ZTogZnVuY3Rpb24gY2hhbmdlX3RyaWdnZXJfZW50aXR5X3ZhbHVlKG9wZXJhbmQsIGluZGV4KSB7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZtLiRzZXQodm0udHJpZ2dlcnMsIGluZGV4LCB2bS50cmlnZ2Vyc1tpbmRleF0pOwogICAgICB0aGlzLnRyaWdnZXJzW2luZGV4XS5lbnRpdHlfdmFsdWUgPSAiIjsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfc2V0X3RyaWdnZXJfZW50aXR5X3ZhbHVlOiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfc2V0X3RyaWdnZXJfZW50aXR5X3ZhbHVlKGVudGl0eV92YWx1ZSwgaW5kZXgsIGluZCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS4kc2V0KHZtLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnRyaWdnZXJzLCBpbmRleCwgdm0ubWFuYWdlX2hhbmRsZXJzW2luZF0udHJpZ2dlcnNbaW5kZXhdKTsKICAgIH0sCiAgICBzZXRfdHJpZ2dlcl9lbnRpdHlfdmFsdWU6IGZ1bmN0aW9uIHNldF90cmlnZ2VyX2VudGl0eV92YWx1ZShlbnRpdHlfdmFsdWUsIGluZGV4KSB7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZtLiRzZXQodm0udHJpZ2dlcnMsIGluZGV4LCB2bS50cmlnZ2Vyc1tpbmRleF0pOwogICAgfSwKICAgIGFkZF90b193ZWJob29rX21hcHBpbmc6IGZ1bmN0aW9uIGFkZF90b193ZWJob29rX21hcHBpbmcoZnVuYywgaW5kZXgpIHsKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIpIHsKICAgICAgICB0aGlzLndlYmhvb2tfbWFwcGluZy5wdXNoKHsKICAgICAgICAgIGtleTogIiIsCiAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy53ZWJob29rX21hcHBpbmcuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQogICAgfSwKICAgIC8vIHNldF9zbG90X3NldHRpbmcoaW5kZXgsIGNoZWNrX2Zvciwgc2xvdCkgewogICAgLy8gICB0aGlzLmVkaXRfc2xvdF9pbmRleCA9IGluZGV4OwogICAgLy8gICB0aGlzLmVkaXRfc2xvdF9jaGVja19mb3IgPSBjaGVja19mb3I7CiAgICAvLyAgIHRoaXMuZWRpdF9zbG90X3Nsb3RfdmFyaWFibGUgPSBzbG90OwogICAgLy8gfSwKICAgIHNldF9zbG90X3ZhcmlhYmxlX2luX2Fzc2lzdGFuY2VfcmVzcG9uc2U6IGZ1bmN0aW9uIHNldF9zbG90X3ZhcmlhYmxlX2luX2Fzc2lzdGFuY2VfcmVzcG9uc2UoaWQsIHNsb3QpIHsKICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpbmRleF0uaWQgPT09IGlkKSB7CiAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpbmRleF0ucmVjb2duaXplcyA9IHNsb3Q7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2V0X3Nsb3RfZW50aXR5X3ZhcmlhYmxlOiBmdW5jdGlvbiBzZXRfc2xvdF9lbnRpdHlfdmFyaWFibGUoaW5kZXgsIGVudGl0eSkgewogICAgICBlbnRpdHkgPSBlbnRpdHkuc2xpY2UoMSk7CiAgICAgIHRoaXMuc2xvdHNbaW5kZXhdLnNsb3QgPSAiJCIgKyBlbnRpdHk7CgogICAgICBmb3IgKHZhciBfaTEwID0gMDsgX2kxMCA8IHRoaXMuc2xvdHNbaW5kZXhdLnJlc3BvbnNlcy5sZW5ndGg7IF9pMTArKykgewogICAgICAgIHZhciBpZCA9IHRoaXMuc2xvdHNbaW5kZXhdLnJlc3BvbnNlc1tfaTEwXTsKICAgICAgICB2YXIgc2xvdCA9IHRoaXMuc2xvdHNbaW5kZXhdLnNsb3Q7CiAgICAgICAgdGhpcy5zZXRfc2xvdF92YXJpYWJsZV9pbl9hc3Npc3RhbmNlX3Jlc3BvbnNlKGlkLCBzbG90KTsKICAgICAgfQogICAgfSwKICAgIHNldF9ub3RpZmljYXRpb25zX25vdGlmeV90ZW1wbGF0ZV9pZDogZnVuY3Rpb24gc2V0X25vdGlmaWNhdGlvbnNfbm90aWZ5X3RlbXBsYXRlX2lkKHRlbXBsYXRlX25hbWUpIHsKICAgICAgdGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS50ZW1wbGF0ZV9pZCA9IHRoaXMubm90aWZpY2F0aW9uc19ub3RpZnlfdGVtcGxhdGVfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICByZXR1cm4gbmFtZS50ZW1wbGF0ZV9uYW1lID09PSB0ZW1wbGF0ZV9uYW1lOwogICAgICB9KS5tYXAoZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgcmV0dXJuIGlkLnRlbXBsYXRlX2lkOwogICAgICB9KVswXTsKICAgIH0sCiAgICBvbl9vcGVuX3dlYmhvb2tfbW9kYWw6IGZ1bmN0aW9uIG9uX29wZW5fd2ViaG9va19tb2RhbCh2YXJpYWJsZSkgewogICAgICB0aGlzLndlYmhvb2tfYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CgogICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLnJlY29nbml6ZXMgPT0gdmFyaWFibGUpIHsKICAgICAgICAgIHRoaXMud2ViaG9va19hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgb25fY2xvc2Vfd2ViaG9va19tb2RhbDogZnVuY3Rpb24gb25fY2xvc2Vfd2ViaG9va19tb2RhbCgpIHsKICAgICAgdGhpcy53ZWJob29rX2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwogICAgfSwKICAgIG9uX29wZW5fc2xvdHNfbW9kYWw6IGZ1bmN0aW9uIG9uX29wZW5fc2xvdHNfbW9kYWwoc2xvdCwgaW5kZXgsIGNoZWNrX2ZvcikgewogICAgICB0aGlzLmVkaXRfc2xvdF9pbmRleCA9IGluZGV4OwogICAgICB0aGlzLmVkaXRfc2xvdF9jaGVja19mb3IgPSBjaGVja19mb3I7CiAgICAgIHRoaXMuZWRpdF9zbG90X3Nsb3RfdmFyaWFibGUgPSBzbG90OwogICAgICB0aGlzLnVuZmlsbGVkX3Nsb3RfYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CiAgICAgIHRoaXMudmFsaWRhdGlvbl9zbG90X2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwoKICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5yZWNvZ25pemVzID09IHNsb3QgJiYgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uY29uZGl0aW9uID09PSAidW5maWxsZWRfc2xvdCIpIHsKICAgICAgICAgIHRoaXMudW5maWxsZWRfc2xvdF9hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0ucmVjb2duaXplcyA9PSBzbG90ICYmIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLmNvbmRpdGlvbiA9PT0gInZhbGlkYXRpb25fcmVzcG9uc2UiKSB7CiAgICAgICAgICB0aGlzLnZhbGlkYXRpb25fc2xvdF9hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLnNlYXJjaF9mb3JfZW50aXR5X2hhc192YWxpZGF0aW9uKGNoZWNrX2Zvcik7CiAgICB9LAogICAgb25fY2xvc2Vfc2xvdHNfbW9kYWw6IGZ1bmN0aW9uIG9uX2Nsb3NlX3Nsb3RzX21vZGFsKCkgewogICAgICB0aGlzLnVuZmlsbGVkX3Nsb3RfYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CiAgICAgIHRoaXMudmFsaWRhdGlvbl9zbG90X2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwogICAgICB0aGlzLmlzX3ZhbGlkYXRpb25fZW50aXR5ID0gZmFsc2U7CiAgICAgIHRoaXMuZWRpdF9zbG90X2luZGV4ID0gIiI7CiAgICAgIHRoaXMuZWRpdF9zbG90X2NoZWNrX2ZvciA9ICIiOwogICAgICB0aGlzLmVkaXRfc2xvdF9zbG90X3ZhcmlhYmxlID0gIiI7CiAgICB9LAogICAgb25fb3Blbl9ub3RpZmljYXRpb25fbW9kYWw6IGZ1bmN0aW9uIG9uX29wZW5fbm90aWZpY2F0aW9uX21vZGFsKCkgewogICAgICB0aGlzLm5vdGlmaWNhdGlvbl9zdWNjZXNzZnVsX2Fzc2lzdGFudF9yZXNwb25zZSA9IFtdOwogICAgICB0aGlzLm5vdGlmaWNhdGlvbl91bnN1Y2Nlc3NmdWxfYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CgogICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgaWYgKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldLnJlY29nbml6ZXMgPT0gInN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICB0aGlzLm5vdGlmaWNhdGlvbl9zdWNjZXNzZnVsX2Fzc2lzdGFudF9yZXNwb25zZS5wdXNoKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UpIHsKICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0ucmVjb2duaXplcyA9PSAidW5zdWNjZXNzZnVsIikgewogICAgICAgICAgdGhpcy5ub3RpZmljYXRpb25fdW5zdWNjZXNzZnVsX2Fzc2lzdGFudF9yZXNwb25zZS5wdXNoKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBvbl9jbG9zZV9tYW5hZ2VfaGFuZGxlcnM6IGZ1bmN0aW9uIG9uX2Nsb3NlX21hbmFnZV9oYW5kbGVycygpIHt9LAogICAgb25fY2xvc2Vfbm90aWZpY2F0aW9uX21vZGFsOiBmdW5jdGlvbiBvbl9jbG9zZV9ub3RpZmljYXRpb25fbW9kYWwoKSB7CiAgICAgIHRoaXMubm90aWZpY2F0aW9uX3N1Y2Nlc3NmdWxfYXNzaXN0YW50X3Jlc3BvbnNlID0gW107CiAgICAgIHRoaXMubm90aWZpY2F0aW9uX3Vuc3VjY2Vzc2Z1bF9hc3Npc3RhbnRfcmVzcG9uc2UgPSBbXTsKICAgIH0sCiAgICB3ZWJob29rX3RvX2Fzc2lzdGFudF9yZXNwb25zZTogZnVuY3Rpb24gd2ViaG9va190b19hc3Npc3RhbnRfcmVzcG9uc2UoZnVuYywgd2ViaG9vaywgaW5kZXgpIHsKICAgICAgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICBpbmRleCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgICAgcmV0dXJuIHguaWQgPT0gaW5kZXg7CiAgICAgICAgfSk7CgogICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UpIHsKICAgICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5pZCA9PSBpbmRleCAmJiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5yZWNvZ25pemVzID09IHdlYmhvb2spIHsKICAgICAgICAgICAgLy8gdGhpcy5zbG90c1t0aGlzLmVkaXRfc2xvdF9pbmRleF0ucmVzcG9uc2VzLnNwbGljZSh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5pZCwgMSk7CiAgICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gInRleHQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLAogICAgICAgICAgdHlwZTogdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlLAogICAgICAgICAgY29uZGl0aW9uOiAidW5maWxsZWQiLAogICAgICAgICAgcmVjb2duaXplczogd2ViaG9vaywKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB2YWx1ZXM6IFsiIl0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiaW1hZ2UiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiAiaW1hZ2UiLAogICAgICAgICAgY29uZGl0aW9uOiAidW5maWxsZWQiLAogICAgICAgICAgcmVjb2duaXplczogd2ViaG9vaywKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICBzb3VyY2U6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gInZpZGVvIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogInZpZGVvIiwKICAgICAgICAgIGNvbmRpdGlvbjogInVuZmlsbGVkIiwKICAgICAgICAgIHJlY29nbml6ZXM6IHdlYmhvb2ssCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgc291cmNlOiAiIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJjaG9pY2VzIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogImNob2ljZXMiLAogICAgICAgICAgY29uZGl0aW9uOiAidW5maWxsZWQiLAogICAgICAgICAgcmVjb2duaXplczogd2ViaG9vaywKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICBkZXNjcmlwdGlvbjogIiIsCiAgICAgICAgICBjaG9pY2VzOiBbewogICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgIHBheWxvYWQ6ICIiCiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJjYXJkIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogImNhcmQiLAogICAgICAgICAgY29uZGl0aW9uOiAidW5maWxsZWQiLAogICAgICAgICAgcmVjb2duaXplczogd2ViaG9vaywKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICBkZXNjcmlwdGlvbjogIiIsCiAgICAgICAgICBjYXJkX2xpc3Q6IFt7CiAgICAgICAgICAgIGltYWdlOiAiIiwKICAgICAgICAgICAgaXNfaW1hZ2U6IHRydWUsCiAgICAgICAgICAgIHZpZGVvOiAiIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgYnV0dG9uczogW3sKICAgICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgfV0KICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuYXJyYW5nZV9pZHNfZnVuY3Rpb24oKTsKICAgICAgdGhpcy5vbl9vcGVuX3dlYmhvb2tfbW9kYWwod2ViaG9vayk7CiAgICB9LAogICAgcmVtb3ZlX25vdGlmaWNhdGlvbl90b19hc3Npc3RhbnRfcmVzcG9uc2U6IGZ1bmN0aW9uIHJlbW92ZV9ub3RpZmljYXRpb25fdG9fYXNzaXN0YW50X3Jlc3BvbnNlKGluZGV4LCByZWNvZ25pemVzKSB7CiAgICAgIGluZGV4ID0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UuZmluZEluZGV4KGZ1bmN0aW9uICh4KSB7CiAgICAgICAgcmV0dXJuIHguaWQgPT0gaW5kZXg7CiAgICAgIH0pOwoKICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZSkgewogICAgICAgIGlmICh0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5pZCA9PSBpbmRleCAmJiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpXS5yZWNvZ25pemVzID09IHJlY29nbml6ZXMpIHsKICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLm9uX29wZW5fbm90aWZpY2F0aW9uX21vZGFsKCk7CiAgICAgIHRoaXMuYXJyYW5nZV9pZHNfZnVuY3Rpb24oKTsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9saXN0OiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9saXN0KGZ1bmMsIGluZCwgaW5kZXgpIHsKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJ0ZXh0IikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlLAogICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgdmFsdWVzOiBbIiJdCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImltYWdlIikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlLAogICAgICAgICAgY29uZGl0aW9uOiBmYWxzZSwKICAgICAgICAgIHJlY29nbml6ZXM6IG51bGwsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgc291cmNlOiAiIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJ2aWRlbyIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6IHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSwKICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHNvdXJjZTogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiY2hvaWNlcyIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6IHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSwKICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgIGRlc2NyaXB0aW9uOiAiIiwKICAgICAgICAgIGNob2ljZXM6IFt7CiAgICAgICAgICAgIHR5cGU6ICJwb3N0YmFjayIsCiAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgcGF5bG9hZDogIiIKICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImNhcmQiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUsCiAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICBkZXNjcmlwdGlvbjogIiIsCiAgICAgICAgICBjYXJkX2xpc3Q6IFt7CiAgICAgICAgICAgIGltYWdlOiAiIiwKICAgICAgICAgICAgaXNfaW1hZ2U6IHRydWUsCiAgICAgICAgICAgIHZpZGVvOiAiIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgYnV0dG9uczogW3sKICAgICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgfV0KICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNfYXJyYW5nZV9pZHNfZnVuY3Rpb24oaW5kKTsKICAgICAgfQogICAgfSwKICAgIGFkZF9ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF90b19hc3Npc3RhbnRfcmVzcG9uc2U6IGZ1bmN0aW9uIGFkZF9ub3RpZmljYXRpb25fc3VjY2Vzc2Z1bF90b19hc3Npc3RhbnRfcmVzcG9uc2UodHlwZSkgewogICAgICBpZiAodGhpcy5ub3RpZmljYXRpb25zLm5vdGlmeVswXS50eXBlID09ICIiIHx8IHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udHlwZSA9PSBudWxsKSB7CiAgICAgICAgU3dhbCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnZGlhbG9nX2Zsb3dfbm90aWZpY2F0aW9uX3R5cGVfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0uc2xvdCA9PSAiIiB8fCB0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnNsb3QgPT0gbnVsbCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X3ZhcmlhYmxlX25hbWVfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9ucy5ub3RpZnlbMF0udGVtcGxhdGVfbmFtZSA9PSAiIiB8fCB0aGlzLm5vdGlmaWNhdGlvbnMubm90aWZ5WzBdLnRlbXBsYXRlX25hbWUgPT0gbnVsbCkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdGV4dDogdGhpcy50bHQoJ2RpYWxvZ19mbG93X3RlbXBsYXRlX25hbWVfbXNnJyksCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogNTAwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAidGV4dCIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgIGNvbmRpdGlvbjogIiEiICsgdHlwZSwKICAgICAgICAgIHJlY29nbml6ZXM6IHR5cGUsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgdmFsdWVzOiBbIiJdCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJpbWFnZSIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6ICJpbWFnZSIsCiAgICAgICAgICBjb25kaXRpb246ICIhIiArIHR5cGUsCiAgICAgICAgICByZWNvZ25pemVzOiB0eXBlLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHNvdXJjZTogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gInZpZGVvIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogInZpZGVvIiwKICAgICAgICAgIGNvbmRpdGlvbjogIiEiICsgdHlwZSwKICAgICAgICAgIHJlY29nbml6ZXM6IHR5cGUsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgc291cmNlOiAiIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAiY2hvaWNlcyIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6ICJjaG9pY2VzIiwKICAgICAgICAgIGNvbmRpdGlvbjogIiEiICsgdHlwZSwKICAgICAgICAgIHJlY29nbml6ZXM6IHR5cGUsCiAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgZGVzY3JpcHRpb246ICIiLAogICAgICAgICAgY2hvaWNlczogW3sKICAgICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICBwYXlsb2FkOiAiIgogICAgICAgICAgfV0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImNhcmQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiAiY2FyZCIsCiAgICAgICAgICBjb25kaXRpb246ICIhIiArIHR5cGUsCiAgICAgICAgICByZWNvZ25pemVzOiB0eXBlLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgIGRlc2NyaXB0aW9uOiAiIiwKICAgICAgICAgIGNhcmRfbGlzdDogW3sKICAgICAgICAgICAgaW1hZ2U6ICIiLAogICAgICAgICAgICBpc19pbWFnZTogdHJ1ZSwKICAgICAgICAgICAgdmlkZW86ICIiLAogICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgICBidXR0b25zOiBbewogICAgICAgICAgICAgIHR5cGU6ICJwb3N0YmFjayIsCiAgICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgICB9XQogICAgICAgICAgfV0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy5ub3RpZmljYXRpb25zLnJlc3BvbnNlcy5wdXNoKCh0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGggLSAxKS50b1N0cmluZygpKTsKICAgICAgdGhpcy5vbl9vcGVuX25vdGlmaWNhdGlvbl9tb2RhbCgpOwogICAgfSwKICAgIHJlbW92ZV9zbG90X3RvX2Fzc2lzdGFudF9yZXNwb25zZTogZnVuY3Rpb24gcmVtb3ZlX3Nsb3RfdG9fYXNzaXN0YW50X3Jlc3BvbnNlKGluZGV4LCBzbG90LCBmcm9tKSB7CiAgICAgIGlmIChmcm9tID09ICJzbG90bW9kYWwiKSB7CiAgICAgICAgaW5kZXggPSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5maW5kSW5kZXgoZnVuY3Rpb24gKHgpIHsKICAgICAgICAgIHJldHVybiB4LmlkID09IGluZGV4OwogICAgICAgIH0pOwoKICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQgPT0gaW5kZXggJiYgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0ucmVjb2duaXplcyA9PSBzbG90KSB7CiAgICAgICAgICAgIC8vIHRoaXMuc2xvdHNbdGhpcy5lZGl0X3Nsb3RfaW5kZXhdLnJlc3BvbnNlcy5zcGxpY2UodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQsIDEpOwogICAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5vbl9vcGVuX3Nsb3RzX21vZGFsKHNsb3QsIHRoaXMuZWRpdF9zbG90X2luZGV4LCB0aGlzLmVkaXRfc2xvdF9jaGVja19mb3IpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBpZCA9IGluZGV4OwoKICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgICBpZiAodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQgPT0gaWQgJiYgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0ucmVjb2duaXplcyA9PSBzbG90KSB7CiAgICAgICAgICAgIC8vIHRoaXMuc2xvdHNbaW5kZXhdLnJlc3BvbnNlcy5zcGxpY2UodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0uaWQsIDEpOwogICAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5zcGxpY2UodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaV0sIDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5hcnJhbmdlX2lkc19mdW5jdGlvbigpOwogICAgfSwKICAgIGFkZF9zbG90X3RvX2Fzc2lzdGFudF9yZXNwb25zZTogZnVuY3Rpb24gYWRkX3Nsb3RfdG9fYXNzaXN0YW50X3Jlc3BvbnNlKGZyb20sIGluZGV4LCBjaGVja19mb3IsIHNsb3QsIHJlc3BvbnNlLCBjb25kaXRpb25fdHlwZSkgewogICAgICBpZiAoc2xvdCA9PSAiIiB8fCBzbG90ID09IG51bGwpIHsKICAgICAgICBTd2FsKHsKICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdkaWFsb2dfZmxvd19hZGRfZW50aXR5X2ZpcnN0X21zZycpLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgdGltZXI6IDUwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChmcm9tID09ICJ0ZXh0IikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAgICAgY29uZGl0aW9uOiAidW5maWxsZWRfc2xvdCIsCiAgICAgICAgICByZWNvZ25pemVzOiBzbG90LAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHZhbHVlczogW3Jlc3BvbnNlXQogICAgICAgIH0pOyAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2hlY2tmb2N1cyIpLmRpc2FibGVkID0gdHJ1ZTsKCiAgICAgICAgdGhpcy5zbG90c1tpbmRleF0ucmVzcG9uc2VzID0gW107CiAgICAgICAgdGhpcy5zbG90c1tpbmRleF0ucmVzcG9uc2VzLnB1c2goKHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aCAtIDEpLnRvU3RyaW5nKCkpOwogICAgICAgIHRoaXMub25fb3Blbl9zbG90c19tb2RhbCh0aGlzLmVkaXRfc2xvdF9zbG90X3ZhcmlhYmxlLCB0aGlzLmVkaXRfc2xvdF9pbmRleCwgdGhpcy5lZGl0X3Nsb3RfY2hlY2tfZm9yKTsKICAgICAgfQoKICAgICAgaWYgKGZyb20gPT0gIkFkZGJ0biIpIHsKICAgICAgICBpZiAodGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJ0ZXh0IikgewogICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbl90eXBlLAogICAgICAgICAgICByZWNvZ25pemVzOiBzbG90LAogICAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgICB2YWx1ZXM6IFsiIl0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJpbWFnZSIpIHsKICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICAgIHR5cGU6ICJpbWFnZSIsCiAgICAgICAgICAgIGNvbmRpdGlvbjogY29uZGl0aW9uX3R5cGUsCiAgICAgICAgICAgIHJlY29nbml6ZXM6IHNsb3QsCiAgICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICAgIHNvdXJjZTogIiIKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJ2aWRlbyIpIHsKICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnB1c2goewogICAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICAgIHR5cGU6ICJ2aWRlbyIsCiAgICAgICAgICAgIGNvbmRpdGlvbjogY29uZGl0aW9uX3R5cGUsCiAgICAgICAgICAgIHJlY29nbml6ZXM6IHNsb3QsCiAgICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICAgIHNvdXJjZTogIiIKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJjaG9pY2VzIikgewogICAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgICAgdHlwZTogImNob2ljZXMiLAogICAgICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbl90eXBlLAogICAgICAgICAgICByZWNvZ25pemVzOiBzbG90LAogICAgICAgICAgICB2YXJpYXRpb246ICJyYW5kb20iLAogICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAiIiwKICAgICAgICAgICAgY2hvaWNlczogW3sKICAgICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgICBwYXlsb2FkOiAiIgogICAgICAgICAgICB9XQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImNhcmQiKSB7CiAgICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgICAgaWQ6IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmxlbmd0aC50b1N0cmluZygpLAogICAgICAgICAgICB0eXBlOiAiY2FyZCIsCiAgICAgICAgICAgIGNvbmRpdGlvbjogY29uZGl0aW9uX3R5cGUsCiAgICAgICAgICAgIHJlY29nbml6ZXM6IHNsb3QsCiAgICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgZGVzY3JpcHRpb246ICIiLAogICAgICAgICAgICBjYXJkX2xpc3Q6IFt7CiAgICAgICAgICAgICAgaW1hZ2U6ICIiLAogICAgICAgICAgICAgIGlzX2ltYWdlOiB0cnVlLAogICAgICAgICAgICAgIHZpZGVvOiAiIiwKICAgICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICAgICAgYnV0dG9uczogW3sKICAgICAgICAgICAgICAgIHR5cGU6ICJwb3N0YmFjayIsCiAgICAgICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9XQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnNsb3RzW3RoaXMuZWRpdF9zbG90X2luZGV4XS5yZXNwb25zZXMucHVzaCgodGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoIC0gMSkudG9TdHJpbmcoKSk7CiAgICAgICAgdGhpcy5vbl9vcGVuX3Nsb3RzX21vZGFsKHRoaXMuZWRpdF9zbG90X3Nsb3RfdmFyaWFibGUsIHRoaXMuZWRpdF9zbG90X2luZGV4LCB0aGlzLmVkaXRfc2xvdF9jaGVja19mb3IpOwogICAgICB9CiAgICB9LAogICAgYWRkX3RvX3Nsb3RzX2xpc3Q6IGZ1bmN0aW9uIGFkZF90b19zbG90c19saXN0KGZ1bmMsIGluZGV4LCByZXNwb25zZV9pZCkgewogICAgICBpZiAoZnVuYyA9PSAiYWRkIikgewogICAgICAgIHRoaXMuc2xvdHMucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5zbG90cy5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIGNoZWNrX2ZvcjogIiIsCiAgICAgICAgICBzbG90OiAiIiwKICAgICAgICAgIHJlc3BvbnNlczogW10KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5zbG90cy5zcGxpY2UoaW5kZXgsIDEpOwoKICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlX2lkKSB7CiAgICAgICAgICBmb3IgKHZhciBqIGluIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlKSB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZV9pZFtpXSA9PSB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtqXS5pZCkgewogICAgICAgICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLnNwbGljZShqLCAxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5hcnJhbmdlX2lkc19mdW5jdGlvbigpOwoKICAgICAgICBpZiAodGhpcy5zbG90cyAhPSBbXSkgewogICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnNsb3RzKSB7CiAgICAgICAgICAgIHRoaXMuc2xvdHNbaV0uaWQgPSBpLnRvU3RyaW5nKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgbWFuYWdlX2hhbmRsZXJzX3NlbGVjdF9yZXNwb25zZV92YXJpYXRpb246IGZ1bmN0aW9uIG1hbmFnZV9oYW5kbGVyc19zZWxlY3RfcmVzcG9uc2VfdmFyaWF0aW9uKGluZGV4LCB2YXJpYXRpb24sIGluZCkgewogICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpbmRleF0udmFyaWF0aW9uID0gdmFyaWF0aW9uOwogICAgfSwKICAgIHNlbGVjdF9yZXNwb25zZV92YXJpYXRpb246IGZ1bmN0aW9uIHNlbGVjdF9yZXNwb25zZV92YXJpYXRpb24oaW5kZXgsIHZhcmlhdGlvbikgewogICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpbmRleF0udmFyaWF0aW9uID0gdmFyaWF0aW9uOwogICAgfSwKICAgIG1hbmFnZV9oYW5kbGVyX2FkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfdGV4dF9saXN0OiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcl9hZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX3RleHRfbGlzdChmdW5jLCBpZCwgaW5kLCBudW0pIHsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMuZmluZEluZGV4KGZ1bmN0aW9uICh4KSB7CiAgICAgICAgcmV0dXJuIHguaWQgPT0gaWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpbmRleF0udmFsdWVzLnB1c2goIiIpOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpbmRleF0udmFsdWVzLnNwbGljZShudW0sIDEpOwogICAgICB9CiAgICB9LAogICAgYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV90ZXh0X2xpc3Q6IGZ1bmN0aW9uIGFkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfdGV4dF9saXN0KGZ1bmMsIGlkLCBudW0pIHsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UuZmluZEluZGV4KGZ1bmN0aW9uICh4KSB7CiAgICAgICAgcmV0dXJuIHguaWQgPT0gaWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpbmRleF0udmFsdWVzLnB1c2goIiIpOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZVtpbmRleF0udmFsdWVzLnNwbGljZShudW0sIDEpOwogICAgICB9CgogICAgICB0aGlzLmZpbHRlcl9hc2lzdGFuY2VfcmVzcG9uc2UoKTsKICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jaG9pY2VfbGlzdDogZnVuY3Rpb24gbWFuYWdlX2hhbmRsZXJzX2FkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2hvaWNlX2xpc3QoZnVuYywgaWQsIGluZCwgbnVtKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGlkOwogICAgICB9KTsKCiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaW5kZXhdLmNob2ljZXMucHVzaCh7CiAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgcGF5bG9hZDogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXNbaW5kZXhdLmNob2ljZXMuc3BsaWNlKG51bSwgMSk7CiAgICAgIH0KICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jYXJvdXNlbF9jYXJkX2J1dHRvbl9saXN0OiBmdW5jdGlvbiBtYW5hZ2VfaGFuZGxlcnNfYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jYXJvdXNlbF9jYXJkX2J1dHRvbl9saXN0KGZ1bmMsIGlkLCBpbmQsIG51bSwgYnRuX251bSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlcy5maW5kSW5kZXgoZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4geC5pZCA9PSBpZDsKICAgICAgfSk7CgogICAgICBpZiAoZnVuYyA9PSAiYWRkIikgewogICAgICAgIHRoaXMubWFuYWdlX2hhbmRsZXJzW2luZF0ucmVzcG9uc2VzW2luZGV4XS5jYXJkX2xpc3RbbnVtXS5idXR0b25zLnB1c2goewogICAgICAgICAgdHlwZTogInBvc3RiYWNrIiwKICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpbmRleF0uY2FyZF9saXN0W251bV0uYnV0dG9ucy5zcGxpY2UoYnRuX251bSwgMSk7CiAgICAgIH0KICAgIH0sCiAgICBtYW5hZ2VfaGFuZGxlcnNfYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jYXJvdXNlbF9jYXJkX2xpc3Q6IGZ1bmN0aW9uIG1hbmFnZV9oYW5kbGVyc19hZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX2Nhcm91c2VsX2NhcmRfbGlzdChmdW5jLCBpZCwgaW5kLCBudW0pIHsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5tYW5hZ2VfaGFuZGxlcnNbaW5kXS5yZXNwb25zZXMuZmluZEluZGV4KGZ1bmN0aW9uICh4KSB7CiAgICAgICAgcmV0dXJuIHguaWQgPT0gaWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGZ1bmMgPT0gImFkZCIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpbmRleF0uY2FyZF9saXN0LnB1c2goewogICAgICAgICAgaW1hZ2U6ICIiLAogICAgICAgICAgaXNfaW1hZ2U6IHRydWUsCiAgICAgICAgICB2aWRlbzogIiIsCiAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgIGJ1dHRvbnM6IFt7CiAgICAgICAgICAgIHR5cGU6ICJwb3N0YmFjayIsCiAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLm1hbmFnZV9oYW5kbGVyc1tpbmRdLnJlc3BvbnNlc1tpbmRleF0uY2FyZF9saXN0LnNwbGljZShudW0sIDEpOwogICAgICB9CiAgICB9LAogICAgYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jaG9pY2VfbGlzdDogZnVuY3Rpb24gYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9jaG9pY2VfbGlzdChmdW5jLCBpZCwgbnVtKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGlkOwogICAgICB9KTsKCiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLmNob2ljZXMucHVzaCh7CiAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgcGF5bG9hZDogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLmNob2ljZXMuc3BsaWNlKG51bSwgMSk7CiAgICAgIH0KICAgIH0sCiAgICBhZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX2Nhcm91c2VsX2NhcmRfYnV0dG9uX2xpc3Q6IGZ1bmN0aW9uIGFkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2Fyb3VzZWxfY2FyZF9idXR0b25fbGlzdChmdW5jLCBpZCwgbnVtLCBidG5fbnVtKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGlkOwogICAgICB9KTsKCiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLmNhcmRfbGlzdFtudW1dLmJ1dHRvbnMucHVzaCh7CiAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlW2luZGV4XS5jYXJkX2xpc3RbbnVtXS5idXR0b25zLnNwbGljZShidG5fbnVtLCAxKTsKICAgICAgfQogICAgfSwKICAgIGFkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfY2Fyb3VzZWxfY2FyZF9saXN0OiBmdW5jdGlvbiBhZGRfdG9fYXNzaXN0YW50X3Jlc3BvbnNlX2Nhcm91c2VsX2NhcmRfbGlzdChmdW5jLCBpZCwgbnVtKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGlkOwogICAgICB9KTsKCiAgICAgIGlmIChmdW5jID09ICJhZGQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLmNhcmRfbGlzdC5wdXNoKHsKICAgICAgICAgIGltYWdlOiAiIiwKICAgICAgICAgIGlzX2ltYWdlOiB0cnVlLAogICAgICAgICAgdmlkZW86ICIiLAogICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICBidXR0b25zOiBbewogICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgfV0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2VbaW5kZXhdLmNhcmRfbGlzdC5zcGxpY2UobnVtLCAxKTsKICAgICAgfQogICAgfSwKICAgIGFkZF90b19hc3Npc3RhbnRfcmVzcG9uc2VfbGlzdDogZnVuY3Rpb24gYWRkX3RvX2Fzc2lzdGFudF9yZXNwb25zZV9saXN0KGZ1bmMsIGlkKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuYXNzaXN0YW50X3Jlc3BvbnNlLmZpbmRJbmRleChmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4LmlkID09IGlkOwogICAgICB9KTsKCiAgICAgIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAidGV4dCIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6IHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSwKICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHZhbHVlczogWyIiXQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gImFkZCIgJiYgdGhpcy5zZWxlY3RlZF9yZXNwb25zZV90eXBlID09ICJpbWFnZSIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5wdXNoKHsKICAgICAgICAgIGlkOiB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5sZW5ndGgudG9TdHJpbmcoKSwKICAgICAgICAgIHR5cGU6IHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSwKICAgICAgICAgIGNvbmRpdGlvbjogZmFsc2UsCiAgICAgICAgICByZWNvZ25pemVzOiBudWxsLAogICAgICAgICAgdmFyaWF0aW9uOiAicmFuZG9tIiwKICAgICAgICAgIHNvdXJjZTogIiIKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChmdW5jID09ICJhZGQiICYmIHRoaXMuc2VsZWN0ZWRfcmVzcG9uc2VfdHlwZSA9PSAidmlkZW8iKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUsCiAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICBzb3VyY2U6ICIiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImNhcmQiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUsCiAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICBjYXJkX2xpc3Q6IFt7CiAgICAgICAgICAgIGltYWdlOiAiIiwKICAgICAgICAgICAgaXNfaW1hZ2U6IHRydWUsCiAgICAgICAgICAgIHZpZGVvOiAiIiwKICAgICAgICAgICAgdGl0bGU6ICIiLAogICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgYnV0dG9uczogW3sKICAgICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgfV0KICAgICAgICAgIH1dCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZnVuYyA9PSAiYWRkIiAmJiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUgPT0gImNob2ljZXMiKSB7CiAgICAgICAgdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UucHVzaCh7CiAgICAgICAgICBpZDogdGhpcy5hc3Npc3RhbnRfcmVzcG9uc2UubGVuZ3RoLnRvU3RyaW5nKCksCiAgICAgICAgICB0eXBlOiB0aGlzLnNlbGVjdGVkX3Jlc3BvbnNlX3R5cGUsCiAgICAgICAgICBjb25kaXRpb246IGZhbHNlLAogICAgICAgICAgcmVjb2duaXplczogbnVsbCwKICAgICAgICAgIHZhcmlhdGlvbjogInJhbmRvbSIsCiAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICBkZXNjcmlwdGlvbjogIiIsCiAgICAgICAgICBjaG9pY2VzOiBbewogICAgICAgICAgICB0eXBlOiAicG9zdGJhY2siLAogICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgIHBheWxvYWQ6ICIiCiAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGZ1bmMgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLmFzc2lzdGFudF9yZXNwb25zZS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgIHRoaXMuYXJyYW5nZV9pZHNfZnVuY3Rpb24oKTsKICAgICAgfQoKICAgICAgdGhpcy5maWx0ZXJfYXNpc3RhbmNlX3Jlc3BvbnNlKCk7CiAgICB9LAogICAgY2hlY2tfZmlyc3RfY2hhcjogZnVuY3Rpb24gY2hlY2tfZmlyc3RfY2hhcihlKSB7CiAgICAgIHZhciB2YWwgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgdGhpcy5zaG93X2ludGVudF9saXN0ID0gZmFsc2U7CgogICAgICBpZiAodmFsLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgaWYgKHZhbCA9PSAnLycpIHsKICAgICAgICAgIHRoaXMuc2hvd19pbnRlbnRfbGlzdCA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2hvd19pbnRlbnRfbGlzdCA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},null]}