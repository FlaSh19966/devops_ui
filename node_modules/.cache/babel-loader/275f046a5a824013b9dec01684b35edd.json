{"remainingRequest":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js!/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Layout/TopNavbar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Layout/TopNavbar.vue","mtime":1661252053823},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiOwppbXBvcnQgX3R5cGVvZiBmcm9tICIvaG9tZS92aW1hbGVzaC9MZWFybmluZy9kZXZvcHNfdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIi9ob21lL3ZpbWFsZXNoL0xlYXJuaW5nL2Rldm9wc191aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCB7IGJ1cyB9IGZyb20gIkAvcG9ydGFsL21haW4iOwppbXBvcnQgQ291bnRyaWVzIGZyb20gIkAvcG9ydGFsL2NvbXBvbmVudHMvQ291bnRyaWVzIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwppbXBvcnQgZmluZ2VycHJpbnQgZnJvbSAiQC9wb3J0YWwvY29tcG9uZW50cy9maW5nZXJwcmludCI7CmltcG9ydCB7IHNldFRpbWVvdXQgfSBmcm9tICJ0aW1lcnMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKaW1wb3J0IHsgc3RyaW5nVHlwZUFubm90YXRpb24gfSBmcm9tICJAYmFiZWwvdHlwZXMiOwppbXBvcnQgeyBzdHJpbmdpZnkgfSBmcm9tICJxdWVyeXN0cmluZyI7CmltcG9ydCB7IFNvY2tldCB9IGZyb20gInBob2VuaXgtc29ja2V0IjsKaW1wb3J0IFN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7CmltcG9ydCBWdWVQaG9uZU51bWJlcklucHV0IGZyb20gInZ1ZS1waG9uZS1udW1iZXItaW5wdXQiOwppbXBvcnQgInZ1ZS1waG9uZS1udW1iZXItaW5wdXQvZGlzdC92dWUtcGhvbmUtbnVtYmVyLWlucHV0LmNzcyI7CmltcG9ydCBQYXNzd29yZFZhbGlkYXRvciBmcm9tICIuLi9QYWdlcy9QYXNzd29yZFZhbGlkYXRvci52dWUiOwppbXBvcnQgcGFnZV9ndWlkZSBmcm9tICJAL3BvcnRhbC9taXhpbnMvcGFnZV9ndWlkZS5qcyI7CmltcG9ydCBwYXRoIGZyb20gInBhdGgiOwpleHBvcnQgZGVmYXVsdCB7CiAgYmVmb3JlUm91dGVFbnRlcjogZnVuY3Rpb24gYmVmb3JlUm91dGVFbnRlcih0bywgZnJvbSwgbmV4dCkgewogICAgY29uc29sZS5sb2coJ1dlbGNvbWUgdG8gdGhlIHN3YW1wIScpOwogICAgbmV4dCgpOwogIH0sCiAgbWl4aW5zOiBbcGFnZV9ndWlkZV0sCiAgcHJvcHM6IFsidGl0bGUiXSwKICBjb21wb25lbnRzOiB7CiAgICBNdWx0aXNlbGVjdDogTXVsdGlzZWxlY3QsCiAgICBWdWVQaG9uZU51bWJlcklucHV0OiBWdWVQaG9uZU51bWJlcklucHV0LAogICAgUGFzc3dvcmRWYWxpZGF0b3I6IFBhc3N3b3JkVmFsaWRhdG9yCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNfb3BlbjogdHJ1ZSwKICAgICAgaW50ZW50X2RhdGE6IG51bGwsCiAgICAgIGNhbGxkYXRhOiAiIiwKICAgICAgbmV3X3Bhc3N3b3JkOiAiIiwKICAgICAgb2xkX3Bhc3N3b3JkOiAiIiwKICAgICAgY29uZmlybV9wYXNzd29yZDogIiIsCiAgICAgIGNvcnJlY3RfcGFzc3dvcmQ6IGZhbHNlLAogICAgICBjb21wYW55X25hbWU6IG51bGwsCiAgICAgIGNvbXBhbnlfaWRfc2VsZWN0ZWQ6IG51bGwsCiAgICAgIGNvbXBhbmllczogW10sCiAgICAgIGNvdW50cnlfbGlzdDogbnVsbCwKICAgICAgY29tcGFueV9pZDogW10sCiAgICAgIHVzZXJfY29tcGFueTogbnVsbCwKICAgICAgdGlja2V0c19iYXJfYWNjZXNzOiBmYWxzZSwKICAgICAgaW52aXRlX2NvbXBhbnlfZW1haWw6IG51bGwsCiAgICAgIGludml0ZV9jb21wYW55X25hbWU6IG51bGwsCiAgICAgIG9sZF9maWxlX25hbWU6IG51bGwsCiAgICAgIGZpbGVfbGFiZWw6ICJDaG9vc2UgZmlsZSIsCiAgICAgIGlzc3VlOiAiIiwKICAgICAgaXNzdWVfZGVzY3JpcHRpb246ICIiLAogICAgICBpbWdfZmlsZTogIiIsCiAgICAgIHNwaW5uZXJPbjogZmFsc2UsCiAgICAgIHBob3RvX2ltZ191cmw6ICIiLAogICAgICBleGlzdGluZ19maWxlX25hbWU6IG51bGwsCiAgICAgIHVzZXJfY291bnRyeV9uYW1lOiB7CiAgICAgICAgY29kZTogIiIsCiAgICAgICAgbmFtZTogIiIKICAgICAgfSwKICAgICAgdXNlcl9waG9uZV9udW1iZXI6IHRoaXMuJHNlc3Npb24uaGFzKCJQaG9uZU51bWJlciIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlBob25lTnVtYmVyIikgOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucGhvbmVfbm8gOiAiIiwKICAgICAgdXNlcl9maXJzdF9uYW1lOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckZpcnN0TmFtZSIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJGaXJzdE5hbWUiKSA6IHRoaXMuJHNlc3Npb24uaGFzKCJVc2VySW5mb3JtYXRpb24iKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5maXJzdF9uYW1lIDogIiIsCiAgICAgIHVzZXJfbGFzdF9uYW1lOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckxhc3ROYW1lIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckxhc3ROYW1lIikgOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGFzdF9uYW1lIDogIiIsCiAgICAgIGNvbXBhbnlfc2VsZWN0ZWQ6IHRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55TmFtZSIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIikgOiAiU2VsZWN0IEEgQ29tcGFueSIsCiAgICAgIHVzZXJfY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lIDogIiIsCiAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwgOiAiIiwKICAgICAgdXNlcl9jb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCA6ICIiLAogICAgICB1c2VyX3JvbGU6IHRoaXMuJHNlc3Npb24uaGFzKCJVc2VySW5mb3JtYXRpb24iKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlIDogIiIsCiAgICAgIHVzZXJfdHlwZTogdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJlZ2lzdHJhdGlvbl90eXBlIDogIiIsCiAgICAgIHBob25lX251bWJlcl92YWxpZGl0eTogL1wrWzAtOV17OSwxNH0kLywKICAgICAgcmVnX3B3ZDogL14oPz0uKlthLXpdKSg/PS4qW0EtWl0pKD89LipcZCkoPz0uKlsjQCQhJSo/Jl0pW0EtWmEtelxkI0AkISUqPyZdezgsfS8sCiAgICAgIHJlZ19lbWFpbDogL14oWzAtOWEtekEtWl0oWy0uXHddKlswLTlhLXpBLVpdKSpAKFswLTlhLXpBLVpdWy1cd10qWzAtOWEtekEtWl1cLikrW2EtekEtWl17Miw5fSkkLywKICAgICAgbm90aWZpY2F0aW9uczogW10sCiAgICAgIHRvX3Nob3dfbm90aWZpY2F0aW9uczogZmFsc2UsCiAgICAgIHNvY2tldDogbnVsbCwKICAgICAgc2NoZWR1bGVyX2NoYW5uZWw6IG51bGwsCiAgICAgIHRyYWluaW5nX2NoYW5uZWw6IG51bGwsCiAgICAgIHBob25lTnVtYmVyOiBudWxsLAogICAgICB0b3VyX2d1aWRlX2ljb246IHJlcXVpcmUoIkAvcG9ydGFsL2Fzc2V0cy9pbWcvaW5mb19pY29uLnN2ZyIpLAogICAgICBkaXNhYmxlX25hdmJhcjogZmFsc2UKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdmFsaWRPbGRQYXNzd29yZDogZnVuY3Rpb24gdmFsaWRPbGRQYXNzd29yZCgpIHsKICAgICAgaWYgKHRoaXMucmVnX3B3ZC50ZXN0KHRoaXMub2xkX3Bhc3N3b3JkKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy50bHQoJ2ludmFsaWRfcGFzc3dvcmQnKSk7CiAgICAgIH0KICAgIH0sCiAgICB2YWxpZFBhc3N3b3JkOiBmdW5jdGlvbiB2YWxpZFBhc3N3b3JkKCkgewogICAgICBpZiAodGhpcy5yZWdfcHdkLnRlc3QodGhpcy5uZXdfcGFzc3dvcmQpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLnRsdCgnaW52YWxpZF9wYXNzd29yZCcpKTsKICAgICAgfQogICAgfSwKICAgIHZhbGlkQ29uZmlybVBhc3N3b3JkOiBmdW5jdGlvbiB2YWxpZENvbmZpcm1QYXNzd29yZCgpIHsKICAgICAgaWYgKHRoaXMuY29uZmlybV9wYXNzd29yZCA9PSB0aGlzLm5ld19wYXNzd29yZCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy50bHQoJ3Bhc3Nfbm9fbWF0Y2gnKSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyB2YWxpZFBob25lTnVtYmVyKCkgewogICAgLy8gICBpZiAoCiAgICAvLyAgICAgdGhpcy5waG9uZV9udW1iZXJfdmFsaWRpdHkudGVzdCgKICAgIC8vICAgICAgIHRoaXMudXNlcl9waG9uZV9udW1iZXIucmVwbGFjZSgvXHMrL2csICIiKQogICAgLy8gICAgICkKICAgIC8vICAgKSB7CiAgICAvLyAgICAgcmV0dXJuIHRydWU7CiAgICAvLyAgIH0gZWxzZSB7CiAgICAvLyAgICAgcmV0dXJuICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBwaG9uZSBudW1iZXIgaW4gdGhlIGZvcm1hdDogK0NvdW50cnlDb2RlIE51bWJlciI7CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICB1bnNlZW5fbm90aWZpY2F0aW9uczogZnVuY3Rpb24gdW5zZWVuX25vdGlmaWNhdGlvbnMoKSB7CiAgICAgIHZhciBjb3VudCA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm90aWZpY2F0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICghdGhpcy5ub3RpZmljYXRpb25zW2ldLmlzX2NsZWFyKSB7CiAgICAgICAgICBjb3VudCsrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGNvdW50OwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdGhpcy5jb3VudHJ5X2xpc3QgPSBDb3VudHJpZXM7CgogICAgaWYgKHRoaXMuJHNlc3Npb24uaGFzKCJwaG90b19pbWdfdXJsIikpIHsKICAgICAgdGhpcy5waG90b19pbWdfdXJsID0gdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoInBob3RvX2ltZ191cmwiKSA6ICIiOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5waG90b19pbWdfdXJsID0gdGhpcy4kc2Vzc2lvbi5oYXMoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnBob3RvX2ltZ191cmwgOiAiIjsKICAgIH0KCiAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoImNvdW50cnlfbmFtZSIpICYmIHRoaXMuJHNlc3Npb24uaGFzKCJVc2VySW5mb3JtYXRpb24iKSkgewogICAgICB0aGlzLnVzZXJfY291bnRyeV9uYW1lLmNvZGUgPSB0aGlzLiRzZXNzaW9uLmdldCgiY291bnRyeV9uYW1lIik7CiAgICAgIHZhciBzZWxlY3RfY291bnRyeSA9IHRoaXMuY291bnRyeV9saXN0LmZpbHRlcihmdW5jdGlvbiAoY291bnRyeSkgewogICAgICAgIHJldHVybiBjb3VudHJ5LmNvZGUgPT0gX3RoaXMudXNlcl9jb3VudHJ5X25hbWUuY29kZTsKICAgICAgfSk7CiAgICAgIHRoaXMudXNlcl9jb3VudHJ5X25hbWUubmFtZSA9IHNlbGVjdF9jb3VudHJ5WzBdLm5hbWU7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnVzZXJfY291bnRyeV9uYW1lLmNvZGUgPSB0aGlzLiRzZXNzaW9uLmhhcygiVXNlckluZm9ybWF0aW9uIikgPyB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY291bnRyeV9uYW1lIDogIiI7CgogICAgICBpZiAodGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvdW50cnlfbmFtZSA9PSBudWxsKSB7CiAgICAgICAgdGhpcy51c2VyX2NvdW50cnlfbmFtZS5jb2RlID0gIiI7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnVzZXJfY291bnRyeV9uYW1lLmNvZGUubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBfc2VsZWN0X2NvdW50cnkgPSB0aGlzLmNvdW50cnlfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKGNvdW50cnkpIHsKICAgICAgICAgIHJldHVybiBjb3VudHJ5LmNvZGUgPT0gX3RoaXMudXNlcl9jb3VudHJ5X25hbWUuY29kZTsKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy51c2VyX2NvdW50cnlfbmFtZS5uYW1lID0gX3NlbGVjdF9jb3VudHJ5WzBdID09PSB1bmRlZmluZWQgPyAiIiA6IF9zZWxlY3RfY291bnRyeVswXS5uYW1lOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMudXNlcl9yb2xlID09ICJBZG1pbiIpIHsKICAgICAgdGhpcy5jb21wYW55X3NlbGVjdGVkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpID8gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSA6ICIiOwogICAgfQoKICAgIGlmICh0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucm9sZSA9PSAiU3VwZXJBZG1pbiIpIHsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuY29tcGFueV9saXN0X3VybCgpLCB7CiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMuY29tcGFuaWVzID0gcmVzcG9uc2UuZGF0YS5kYXRhWzBdOwogICAgICAgIF90aGlzLmNvbXBhbnlfaWQgPSByZXNwb25zZS5kYXRhLmRhdGFbMV07CiAgICAgIH0pOwogICAgfQoKICAgIGlmICh0aGlzLnVzZXJfZmlyc3RfbmFtZSA9PSBudWxsIHx8IHRoaXMudXNlcl9maXJzdF9uYW1lID09ICIiKSB7CiAgICAgIHRoaXMudXNlcl9maXJzdF9uYW1lID0gIkZpcnN0IjsKICAgICAgdGhpcy51c2VyX2xhc3RfbmFtZSA9ICJMYXN0IjsKICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIlVzZXJGaXJzdE5hbWUiLCB0aGlzLnVzZXJfZmlyc3RfbmFtZSk7CiAgICAgIHRoaXMuJHNlc3Npb24uc2V0KCJVc2VyTGFzdE5hbWUiLCB0aGlzLnVzZXJfbGFzdF9uYW1lKTsKICAgIH0KCiAgICB2YXIgbWVudXMgPSB0aGlzLiRzZXNzaW9uLmhhcygiQ2hhdGJvdE1lbnUiKSA/IHRoaXMuJHNlc3Npb24uZ2V0KCJDaGF0Ym90TWVudSIpIDogW107CiAgICB2YXIgdGlja2V0X2FjY2VzcyA9IG1lbnVzLmZpbHRlcihmdW5jdGlvbiAobWVudSkgewogICAgICByZXR1cm4gbWVudS5tYWluX21lbnUubmFtZSA9PSAiVGlja2V0cyI7CiAgICB9KTsKCiAgICBpZiAodGlja2V0X2FjY2Vzcy5sZW5ndGggPT0gMCkgewogICAgICB0aGlzLnRpY2tldHNfYmFyX2FjY2VzcyA9IGZhbHNlOwogICAgfSBlbHNlIGlmICh0aWNrZXRfYWNjZXNzLmxlbmd0aCA9PSAxKSB7CiAgICAgIHRoaXMudGlja2V0c19iYXJfYWNjZXNzID0gdHJ1ZTsKICAgIH0KCiAgICB2YXIgbm90aWZpY2F0aW9uc19hY2Nlc3MgPSBmYWxzZTsKCiAgICBmb3IgKHZhciBpID0gMCwgbiA9IG1lbnVzLmxlbmd0aDsgaSA8IG47IGkgKz0gMSkgewogICAgICBmb3IgKHZhciBqID0gMCwgbCA9IG1lbnVzW2ldLnN1Yl9tZW51X2xpc3QubGVuZ3RoOyBqIDwgbDsgaiArPSAxKSB7CiAgICAgICAgaWYgKG1lbnVzW2ldLnN1Yl9tZW51X2xpc3Rbal0ubmFtZSA9PSAiU2NoZWR1bGVyIikgewogICAgICAgICAgbm90aWZpY2F0aW9uc19hY2Nlc3MgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdGhpcy5zb2NrZXQgPSBuZXcgU29ja2V0KHByb2Nlc3MuZW52LlZVRV9BUFBfUFVTSF9OT1RJRklDQVRJT05TX1dFQlNPQ0tFVF9FTkRQT0lOVCwgewogICAgICBwYXJhbXM6IHsKICAgICAgICBub3RpZmljYXRpb25fdGVzdDogdHJ1ZQogICAgICB9CiAgICB9KTsKICAgIHRoaXMuc29ja2V0LmNvbm5lY3QoKTsKCiAgICBpZiAoQm9vbGVhbihub3RpZmljYXRpb25zX2FjY2VzcykpIHsKICAgICAgdGhpcy50b19zaG93X25vdGlmaWNhdGlvbnMgPSB0cnVlOyAvL05vdGlmaWNhdGlvbgoKICAgICAgdGhpcy5zY2hlZHVsZXJfY2hhbm5lbCA9IHRoaXMuc29ja2V0LmNoYW5uZWwoIm5vdGlmaWNhdGlvbl9jaGFubmVsOiIgKyB0aGlzLnVzZXJfY29tcGFueV9pZCk7CiAgICAgIHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwuam9pbigpOwogICAgICB0aGlzLnNjaGVkdWxlcl9jaGFubmVsLm9uKCJzaG93X25vdGlmaWNhdGlvbnMiLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UuaXNfcmVzcG9uc2UpIHsKICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX24gPSByZXNwb25zZS5kYXRhLmxlbmd0aDsgX2kgPCBfbjsgX2krKykgewogICAgICAgICAgICBfdGhpcy5ub3RpZmljYXRpb25zLnB1c2gocmVzcG9uc2UuZGF0YVtfaV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgX3RoaXMuc2NoZWR1bGVyX2NoYW5uZWwub2ZmKCJzaG93X25vdGlmaWNhdGlvbnMiKTsKICAgICAgfSk7CiAgICAgIHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwub24oIm5ld19ub3RpZmljYXRpb24iLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpcy5zaG93X25vdGlmaWNhdGlvbnMocmVzcG9uc2UuZGF0YSk7CgogICAgICAgIF90aGlzLm5vdGlmaWNhdGlvbnMudW5zaGlmdChyZXNwb25zZS5kYXRhKTsKICAgICAgfSk7CiAgICAgIHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwucHVzaCgic2hvd19ub3RpZmljYXRpb25zIiwgewogICAgICAgIG5lZWRfbm90aWZpY2F0aW9uczogdHJ1ZSwKICAgICAgICBlbWFpbF9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsCiAgICAgIH0pOwogICAgfQoKICAgIHRoaXMudHJhaW5pbmdfY2hhbm5lbCA9IHRoaXMuc29ja2V0LmNoYW5uZWwoInRyYWluaW5nX25vdGlmaWNhdGlvbl9jaGFubmVsOiIgKyB0aGlzLnVzZXJfY29tcGFueV9pZCk7CiAgICB0aGlzLnRyYWluaW5nX2NoYW5uZWwuam9pbigpOwogICAgdGhpcy50cmFpbmluZ19jaGFubmVsLm9uKCJzaG93X25vdGlmaWNhdGlvbnMiLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgaWYgKHJlc3BvbnNlLmlzX3Jlc3BvbnNlICYmIHJlc3BvbnNlLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAodmFyIF9pMiA9IDAsIF9uMiA9IHJlc3BvbnNlLmRhdGEubGVuZ3RoOyBfaTIgPCBfbjI7IF9pMisrKSB7CiAgICAgICAgICBfdGhpcy5ub3RpZmljYXRpb25zLnB1c2goX29iamVjdFNwcmVhZCh7CiAgICAgICAgICAgIGRhdGU6IG1vbWVudChyZXNwb25zZS5kYXRhW19pMl0uSW5pdGlhdGVkT24sIFsiWVlZWS1NTS1ERCJdKS5mb3JtYXQoIkRvIE1NTSBZWVlZIikKICAgICAgICAgIH0sIHJlc3BvbnNlLmRhdGFbX2kyXSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgX3RoaXMudHJhaW5pbmdfY2hhbm5lbC5vZmYoInNob3dfbm90aWZpY2F0aW9ucyIpOwogICAgfSk7CiAgICB0aGlzLnRyYWluaW5nX2NoYW5uZWwub24oIm5ld19ub3RpZmljYXRpb24iLCBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgX3RoaXMuc2hvd19ub3RpZmljYXRpb25zKHJlc3BvbnNlLmRhdGEpOwoKICAgICAgX3RoaXMubm90aWZpY2F0aW9ucy51bnNoaWZ0KF9vYmplY3RTcHJlYWQoewogICAgICAgIGRhdGU6IG1vbWVudChyZXNwb25zZS5kYXRhLkluaXRpYXRlZE9uLCBbIllZWVktTU0tREQiXSkuZm9ybWF0KCJEbyBNTU0gWVlZWSIpCiAgICAgIH0sIHJlc3BvbnNlLmRhdGEpKTsKICAgIH0pOwogICAgdGhpcy50cmFpbmluZ19jaGFubmVsLnB1c2goInNob3dfbm90aWZpY2F0aW9ucyIsIHsKICAgICAgbmVlZF9ub3RpZmljYXRpb25zOiB0cnVlLAogICAgICBlbWFpbF9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsCiAgICB9KTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICBidXMuJG9uKCJMYXlvdXRIZWxwRGF0YSIsIGZ1bmN0aW9uIChkYXRhUGcpIHsKICAgICAgX3RoaXMyLmNhbGxkYXRhID0gZGF0YVBnOwogICAgfSk7IC8vIGJ1cy4kb24oJ1RhYnNMYXlvdXRJbmZvJywoZGF0YUZvcnRhYnMpID0+IHsKICAgIC8vICAgICAgICAgY29uc29sZS5sb2coZGF0YUZvcnRhYnMsImRhdGEgb2YgdGFiIHBhbmUiKTsKICAgIC8vICAgICAgICAgdGhpcy5jYWxsZGF0YSA9IGRhdGFGb3J0YWJzOwogICAgLy8gfSkKCiAgICBidXMuJG9uKCJzZW5kIGNvbXBhbnkgYXR0cmlidXRlcyIsIGZ1bmN0aW9uICgpIHsKICAgICAgYnVzLiRlbWl0KCJjb21wYW55IG5hbWUgYW5kIGNvbXBhbnkgaWQiLCBfdGhpczIuY29tcGFueV9uYW1lLCBfdGhpczIuY29tcGFueV9pZF9zZWxlY3RlZCk7CiAgICB9KTsgLy8gcmVmcmVzaFBvcG92ZXIoKTsKCiAgICB0aGlzLiRyb290LiRvbigic2lnbl9vdXQiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzMi5zaWdub3V0X2FwaSgpOwogICAgfSk7CiAgICAkKCIuZHJvcGRvd24tdG9nZ2xlIikuZHJvcGRvd24oKTsKCiAgICBpZiAodGhpcy4kc2Vzc2lvbi5nZXQoIlNldHRpbmdUb3BuYXZiYXJEaXNhYmxlIikgPT0gdHJ1ZSkgewogICAgICB0aGlzLmRpc2FibGVfbmF2YmFyID0gdHJ1ZTsKICAgIH0KCiAgICB0aGlzLiRyb290LiRvbigiRGFzaGJvYXJkU2lkZWJhckRpc2FibGUiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICBpZiAoZGF0YSA9PT0gdHJ1ZSkgewogICAgICAgIF90aGlzMi5kaXNhYmxlX25hdmJhciA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMyLmRpc2FibGVfbmF2YmFyID0gZmFsc2U7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgLy9TZWUgdG9tCiAgbWV0aG9kczogewogICAgbGlzdGVuX2RhdGE6IGZ1bmN0aW9uIGxpc3Rlbl9kYXRhKCkgewogICAgICB0aGlzLmNhbGxkYXRhID0gdGhpcy4kcm91dGUucGF0aDsgLy90aGlzLmNvbXBfbmFtZSA9IHRoaXMuJHJvdXRlLm5hbWU7CiAgICAgIC8vIEVtaXR0aW5nIGEgY3VzdG9tLWV2ZW50IHZpYSB0aGUgRXZlbnQgQnVzCgogICAgICBidXMuJGVtaXQoIkVtaXR0aW5nX2RhdGEiLCB0aGlzLmNhbGxkYXRhKTsKICAgIH0sCiAgICBjaGVja19wYXNzd29yZDogZnVuY3Rpb24gY2hlY2tfcGFzc3dvcmQoY29ycmVjdFBhc3N3b3JkKSB7CiAgICAgIHRoaXMuY29ycmVjdF9wYXNzd29yZCA9IGNvcnJlY3RQYXNzd29yZDsKICAgIH0sCiAgICBlZGl0SW1hZ2U6IGZ1bmN0aW9uIGVkaXRJbWFnZShlKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIGltYWdlID0gZS50YXJnZXQuZmlsZXNbMF07CiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChpbWFnZSk7CgogICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczMucHJldmlld0ltYWdlID0gZS50YXJnZXQucmVzdWx0OwoKICAgICAgICBpZiAoX3RoaXMzLnBob3RvX2ltZ191cmwpIHsKICAgICAgICAgIF90aGlzMy5leGlzdGluZ19maWxlX25hbWUgPSBfdGhpczMucGhvdG9faW1nX3VybC5zcGxpdCgiLyIpWzRdOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZWRpdF9wcm9maWxlX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55X25hbWU6IF90aGlzMy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IF90aGlzMy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBsaWNlbnNlX2tleTogX3RoaXMzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICBlbWFpbDogX3RoaXMzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICB0b2tlbjogX3RoaXMzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgdXBsb2FkX3Bob3RvOiAiVHJ1ZSIsCiAgICAgICAgICBwcm9maWxlX2ltYWdlOiBfdGhpczMucHJldmlld0ltYWdlLnNwbGl0KCJiYXNlNjQsIilbMV0sCiAgICAgICAgICBmaWxlX25hbWU6IGltYWdlLm5hbWUsCiAgICAgICAgICBleGlzdGluZ19maWxlX25hbWU6IF90aGlzMy5leGlzdGluZ19maWxlX25hbWUKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoX3RoaXMzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXMzLnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgIGlmIChfdGhpczMuYXBpX3N0YXR1c19jb2RlLlBIT1RPX1VQTE9BRC5NU0dfQ09ERSA9PT0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFKSB7CiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCIiLmNvbmNhdChfdGhpczMudGx0KCdwaG90b191cGxvYWRlZF9zdWNjZXNzZnVsbHknKSkpOwoKICAgICAgICAgICAgX3RoaXMzLiRzZXNzaW9uLnNldCgicGhvdG9faW1nX3VybCIsIHJlc3BvbnNlLmRhdGEuSW1hZ2VVcmwpOwoKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgX3RoaXMzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgfSwgNTAwMCk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEgPT0gIkR1cGxpY2F0ZSBpbWFnZSIpIHsKICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoIiIuY29uY2F0KF90aGlzMy50bHQoJ3RvYXN0ZXJfZmlsZV9uYW1lX2FscmVhZHlfZXhpc3RzJykpKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfTsKICAgIH0sCiAgICBjcmVhdGVJbWFnZTogZnVuY3Rpb24gY3JlYXRlSW1hZ2UoZmlsZSwgdHlwZSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXM0LmJsb2cuaW1nX2ZpbGUgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoImJhc2U2NCwiKVsxXTsKICAgICAgfTsKCiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgfSwKICAgIHJhaXNlX3RpY2tldDogZnVuY3Rpb24gcmFpc2VfdGlja2V0KCkgewogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgaWYgKHRoaXMuJHJvdXRlLm5hbWUgPT0gIlRpY2tldHMiKSB7CiAgICAgICAgJCgiI3RpY2tldG1vZGFsIikubW9kYWwoInNob3ciKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBuYW1lOiAiVGlja2V0cyIsCiAgICAgICAgICBwcm9wczogdHJ1ZSwKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICByYWlzZV90aWNrZXQ6ICJUcnVlIgogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY2xlYXJfZmllbGRzOiBmdW5jdGlvbiBjbGVhcl9maWVsZHMoKSB7CiAgICAgIHRoaXMuaW1nX2ZpbGUgPSAiIjsKICAgICAgdGhpcy5maWxlX2xhYmVsID0gIiIuY29uY2F0KHRoaXMudGx0KCdjaG9vc2VfZmlsZScpKTsKICAgICAgdGhpcy5pc3N1ZSA9ICIiOwogICAgICB0aGlzLmlzc3VlX2Rlc2NyaXB0aW9uID0gIiI7CiAgICAgIHRoaXMuc3Bpbm5lck9uID0gZmFsc2U7CiAgICB9LAogICAgZW1haWxfY2xhc3M6IGZ1bmN0aW9uIGVtYWlsX2NsYXNzKCkgewogICAgICBpZiAodGhpcy5yZWdfZW1haWwudGVzdCh0aGlzLmludml0ZV9jb21wYW55X2VtYWlsKSkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy50bHQoJ2lzX3ZhbGlkJykpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy50bHQoJ2lzX2ludmFsaWQnKSk7CiAgICAgIH0KICAgIH0sCiAgICBlZGl0X3Byb2ZpbGVfYXBpOiBmdW5jdGlvbiBlZGl0X3Byb2ZpbGVfYXBpKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAoIUJvb2xlYW4odGhpcy5waG9uZU51bWJlcikpIHsKICAgICAgICB0b2FzdHIud2FybmluZygiIi5jb25jYXQodGhpcy50bHQoJ2VudGVyX3ZhbGlkX3Bob25lX251bWJlcicpKSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMucGhvbmVOdW1iZXIuaXNWYWxpZCAhPSB0cnVlKSB7CiAgICAgICAgdG9hc3RyLndhcm5pbmcoIiIuY29uY2F0KHRoaXMudGx0KCdlbnRlcl92YWxpZF9waG9uZV9udW1iZXInKSkpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudXNlcl9jb3VudHJ5X25hbWUuY29kZSAhPSBudWxsICYmIHRoaXMudXNlcl9maXJzdF9uYW1lICE9ICIiICYmIHRoaXMudXNlcl9maXJzdF9uYW1lICE9ICJGIiAmJiB0aGlzLnVzZXJfbGFzdF9uYW1lICE9ICIiICYmIHRoaXMudXNlcl9sYXN0X25hbWUgIT0gIkwiIC8vdGhpcy52YWxpZFBob25lTnVtYmVyID09PSB0cnVlCiAgICAgICkgewogICAgICAgICAgdGhpcy5zcGlubmVyT24gPSB0cnVlOwogICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZWRpdF9wcm9maWxlX3VybCgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBmaXJzdF9uYW1lOiB0aGlzLnVzZXJfZmlyc3RfbmFtZSwKICAgICAgICAgICAgbGFzdF9uYW1lOiB0aGlzLnVzZXJfbGFzdF9uYW1lLAogICAgICAgICAgICBjb3VudHJ5X25hbWU6IHRoaXMudXNlcl9jb3VudHJ5X25hbWUuY29kZSwKICAgICAgICAgICAgcGhvbmVfbnVtYmVyOiB0aGlzLnBob25lTnVtYmVyLmZvcm1hdHRlZE51bWJlcgogICAgICAgICAgfSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXM1LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gX3RoaXM1LmFwaV9zdGF0dXNfY29kZS5QUk9GSUxFX1VQREFURUQuTVNHX0NPREUpIHsKICAgICAgICAgICAgICAvLyBTd2FsKHsKICAgICAgICAgICAgICAvLyAgICAgdGl0bGU6ICJVcGRhdGVkIFN1Y2Nlc3NmdWxseSEhIiwKICAgICAgICAgICAgICAvLyAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIC8vICAgICB0ZXh0OiAiWW91ciBwcm9maWxlIGhhcyBiZWVuIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LiIsCiAgICAgICAgICAgICAgLy8gICAgIHRpbWVyOjIwMDAsCiAgICAgICAgICAgICAgLy8gICB9KTsKICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiIi5jb25jYXQoX3RoaXM1LnRsdCgncHJvZmlsZV91cGRhdGVkX3N1Y2Nlc3NmdWxseScpKSk7CgogICAgICAgICAgICAgIF90aGlzNS4kc2Vzc2lvbi5zZXQoIlVzZXJGaXJzdE5hbWUiLCBfdGhpczUudXNlcl9maXJzdF9uYW1lKTsKCiAgICAgICAgICAgICAgX3RoaXM1LiRzZXNzaW9uLnNldCgiVXNlckxhc3ROYW1lIiwgX3RoaXM1LnVzZXJfbGFzdF9uYW1lKTsKCiAgICAgICAgICAgICAgX3RoaXM1LiRzZXNzaW9uLnNldCgiY291bnRyeV9uYW1lIiwgX3RoaXM1LnVzZXJfY291bnRyeV9uYW1lLmNvZGUpOwoKICAgICAgICAgICAgICBfdGhpczUuJHNlc3Npb24uc2V0KCJQaG9uZU51bWJlciIsIF90aGlzNS5waG9uZU51bWJlci5mb3JtYXR0ZWROdW1iZXIpOwoKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzNS4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgfSwgMjUwMCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkKCIjZWRpdF9wcm9maWxlX21vZGFsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCIiLmNvbmNhdCh0aGlzLnRsdCgnZW50ZXJfYWxsX3JlcXVpcmVkX2ZpZWxkcycpKSk7CiAgICAgIH0KICAgIH0sCiAgICBjb21wYW55X2NoYW5nZWQ6IGZ1bmN0aW9uIGNvbXBhbnlfY2hhbmdlZChjb21wYW55KSB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAoY29tcGFueSAhPSB0aGlzLmNvbXBhbnlfc2VsZWN0ZWQpIHsKICAgICAgICB0aGlzLmNvbXBhbnlfc2VsZWN0ZWQgPSBjb21wYW55OwoKICAgICAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlOYW1lIikpIHsKICAgICAgICAgIHRoaXMuJHNlc3Npb24ucmVtb3ZlKCJDb21wYW55TmFtZSIpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIkNvbXBhbnlOYW1lIiwgdGhpcy5jb21wYW55X3NlbGVjdGVkKTsKCiAgICAgICAgaWYgKHRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55SWQiKSkgewogICAgICAgICAgdGhpcy4kc2Vzc2lvbi5yZW1vdmUoIkNvbXBhbnlJZCIpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIkNvbXBhbnlJZCIsIHRoaXMuY29tcGFueV9pZFt0aGlzLmNvbXBhbmllcy5pbmRleE9mKHRoaXMuY29tcGFueV9zZWxlY3RlZCldKTsKICAgICAgICB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgfSBlbHNlIHt9CiAgICB9LAogICAgc3VibWl0X25ld19wYXNzd29yZDogZnVuY3Rpb24gc3VibWl0X25ld19wYXNzd29yZCgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgaWYgKHRoaXMub2xkX3Bhc3N3b3JkICE9ICIiICYmIHRoaXMuY29ycmVjdF9wYXNzd29yZCA9PSB0cnVlICYmIHRoaXMudmFsaWRDb25maXJtUGFzc3dvcmQgPT0gdHJ1ZSkgewogICAgICAgIFN3YWwoewogICAgICAgICAgdG9hc3Q6IHRydWUsCiAgICAgICAgICB0ZXh0OiAiIi5jb25jYXQodGhpcy50bHQoJ3dhaXRfd2hpbGVfd2Vfc3VibWl0X2RldGFpbHMnKSksCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0eXBlOiAiaW5mbyIKICAgICAgICB9KTsKICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMubmV3X3Bhc3N3b3JkX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIG9sZF9wYXNzd29yZDogdGhpcy5vbGRfcGFzc3dvcmQsCiAgICAgICAgICBuZXdfcGFzc3dvcmQ6IHRoaXMubmV3X3Bhc3N3b3JkLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIGRhdGU6IGRhdGUKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzNi5hcGlfc3RhdHVzX2NvZGUuUEFTU1dPUkRfSU5DT1JSRUNUXzEwMzEuTVNHX0NPREUpIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKCIiLmNvbmNhdChfdGhpczYudGx0KCdpbmNvcnJlY3RfcGFzc3dvcmQnKSkpOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzNi5hcGlfc3RhdHVzX2NvZGUuUEFTU1dPUkRfUkVTRVRfU1VDQ0VTU0ZVTF8xMDI4Lk1TR19DT0RFKSB7CiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCIiLmNvbmNhdChfdGhpczYudGx0KCdwYXNzd29yZF91cGRhdGVkX3N1Y2Nlc3NmdWxseScpKSk7CiAgICAgICAgICAgICQoIiNjaGFuZ2VfcGFzc3dvcmRfbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBfdGhpczYuJHJvdXRlci5nbygpOwogICAgICAgICAgICB9LCAyMDApOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzNi5hcGlfc3RhdHVzX2NvZGUuUEFTU1dPUkRfU0lNSUxBUi5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiAiIi5jb25jYXQoX3RoaXM2LnRsdCgnY2Fubm90X3NldF9vbGRfcGFzc3dvcmQnKSksCiAgICAgICAgICAgICAgdGltZXI6IDMwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gX3RoaXM2LmFwaV9zdGF0dXNfY29kZS5PTERfUEFTU1dPUkRfTk9UX01BVENILk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRleHQ6ICIiLmNvbmNhdChfdGhpczYudGx0KCdvbGRfcGFzc19ub19tYXRjaCcpKSwKICAgICAgICAgICAgICB0aW1lcjogMzAwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczYub2xkX3Bhc3N3b3JkID0gIiI7CiAgICAgICAgICBfdGhpczYubmV3X3Bhc3N3b3JkID0gIiI7CiAgICAgICAgICBfdGhpczYuY29uZmlybV9wYXNzd29yZCA9ICIiOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRvYXN0ci5lcnJvcigiIi5jb25jYXQodGhpcy50bHQoJ2VudGVyX2FsbF9yZXF1aXJlZF9maWVsZHMnKSkpOwogICAgICB9CiAgICB9LAogICAgcGFzc3dvcmRfdG9nZ2xlOiBmdW5jdGlvbiBwYXNzd29yZF90b2dnbGUoaWQpIHsKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgdmFyIHBhc3N3b3JkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwoKICAgICAgaWYgKHBhc3N3b3JkLnR5cGUgPT0gInRleHQiKSB7CiAgICAgICAgcGFzc3dvcmQudHlwZSA9ICJwYXNzd29yZCI7CiAgICAgIH0gZWxzZSBpZiAocGFzc3dvcmQudHlwZSA9PSAicGFzc3dvcmQiKSB7CiAgICAgICAgcGFzc3dvcmQudHlwZSA9ICJ0ZXh0IjsKICAgICAgfQogICAgfSwKICAgIHVwZGF0ZV9zdXBlcmFkbWluOiBmdW5jdGlvbiB1cGRhdGVfc3VwZXJhZG1pbihldnQpIHsKICAgICAgaWYgKGV2dCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpcy5jb21wYW55X25hbWUgPSBldnQ7CiAgICAgICAgdGhpcy5jb21wYW55X2lkX3NlbGVjdGVkID0gdGhpcy5jb21wYW55X2lkW3RoaXMuY29tcGFuaWVzLmluZGV4T2YoZXZ0KV07CiAgICAgICAgYnVzLiRlbWl0KCJjb21wYW55IGF0dHJpYnV0ZXMgdXBkYXRlZCIsICJUcnVlIik7CiAgICAgIH0KICAgIH0sCiAgICBzZW5kX2ludml0ZTogZnVuY3Rpb24gc2VuZF9pbnZpdGUoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKCiAgICAgIGlmICh0aGlzLmludml0ZV9jb21wYW55X25hbWUgPT0gIiIpIHsKICAgICAgICB0b2FzdHIuZXJyb3IoIiIuY29uY2F0KHRoaXMudGx0KCdlbnRlcl9hbGxfcmVxdWlyZWRfZmllbGRzJykpKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnJlZ19lbWFpbC50ZXN0KHRoaXMuaW52aXRlX2NvbXBhbnlfZW1haWwpID09IGZhbHNlKSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCIiLmNvbmNhdCh0aGlzLnRsdCgnZW50ZXJfdmFsaWRfZW1haWwnKSkpOwogICAgICB9IGVsc2UgewogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnJlZmVycmFsc191cmwoKSwgewogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgaW52aXRlZF9jb21wYW55X25hbWU6IHRoaXMuaW52aXRlX2NvbXBhbnlfbmFtZSwKICAgICAgICAgIGludml0ZWRfY29tcGFueV9lbWFpbDogdGhpcy5pbnZpdGVfY29tcGFueV9lbWFpbAogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gX3RoaXM3LmFwaV9zdGF0dXNfY29kZS5FTUFJTF9TRU5UX1NVQ0NFU1NGVUxMWS5NU0dfQ09ERSkgewogICAgICAgICAgICBidXMuJGVtaXQoImludml0ZV91cGRhdGUiLCAibG9hZGVyX29uIik7CiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQoKICAgICAgICAgICQoIiNpbnZpdGVfbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgX3RoaXM3Lmludml0ZV9jb21wYW55X25hbWUgPSAiIjsKICAgICAgICAgIF90aGlzNy5pbnZpdGVfY29tcGFueV9lbWFpbCA9ICIiOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2lnbm91dF9hcGk6IGZ1bmN0aW9uIHNpZ25vdXRfYXBpKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIGJ1cy4kZW1pdCgiTG9nb3V0IGhhcyBiZWVuIGNsaWNrZWQiLCAiVHJ1ZSIpOwogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmNsZWFyX2FjY2Vzc190b2tlbl91cmwoKSwgewogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczguZXhlY3V0ZV9zaWdub3V0KCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczguZXhlY3V0ZV9zaWdub3V0KCk7CiAgICAgIH0pOwogICAgfSwKICAgIGV4ZWN1dGVfc2lnbm91dDogZnVuY3Rpb24gZXhlY3V0ZV9zaWdub3V0KCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHZhciBpc19zdXBlcl9hZG1pbiA9IHRoaXMuJHNlc3Npb24uZ2V0KCJpc19zdXBlcl9hZG1pbiIpOwoKICAgICAgaWYgKGlzX3N1cGVyX2FkbWluKSB7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3VwZXJfYWRtaW5fbG9nb3V0KCksIHsKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgicnQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PSBfdGhpczkuYXBpX3N0YXR1c19jb2RlLlVTRVJfTE9HR0VEX09VVF8xMDMyLk1TR19DT0RFIHx8IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PSBfdGhpczkuYXBpX3N0YXR1c19jb2RlLlRPS0VOX0lOVkFMSURfMDAwMS5NU0dfQ09ERSB8fCByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT0gX3RoaXM5LmFwaV9zdGF0dXNfY29kZS5JTlZBTElEX0NSRURFTlRJQUxTXzAwMDUuTVNHX0NPREUpIHsKICAgICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3VwZXJfYWRtaW5fYm90X2xvZ291dCgpLCB7CiAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgY29tcGFueV9pZDogX3RoaXM5LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICBsaWNlbnNlX2tleTogX3RoaXM5LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgdXNlcm5hbWU6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgIHRva2VuOiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMKICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKF90aGlzOS50b19zaG93X25vdGlmaWNhdGlvbnMpIHsKICAgICAgICAgICAgICAgIF90aGlzOS5zY2hlZHVsZXJfY2hhbm5lbC5sZWF2ZSgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX3RoaXM5LnRyYWluaW5nX2NoYW5uZWwubGVhdmUoKTsKCiAgICAgICAgICAgICAgX3RoaXM5LnNvY2tldC5kaXNjb25uZWN0KCk7CgogICAgICAgICAgICAgIF90aGlzOS4kc2Vzc2lvbi5kZXN0cm95KCk7CgogICAgICAgICAgICAgIF90aGlzOS5zcGlubmVyT24gPSBmYWxzZTsKCiAgICAgICAgICAgICAgX3RoaXM5LiRyb290LiRlbWl0KCJDbGVhcl9SZWZyZXNoX1Rva2VuX0ludGVydmFsIiwgewogICAgICAgICAgICAgICAgY2xlYXJfaW50ZXJ2YWw6IHRydWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgYnVzLiRlbWl0KCJMb2dnZWQgb3V0IiwgIlRydWUiKTsKICAgICAgICAgICAgICBidXMuJGVtaXQoIkRpc2FibGUgdGhlIGJvdCBjaGF0IG5vdyIsICJUcnVlIiwgIkxvZ2dlZG91dCIpOwoKICAgICAgICAgICAgICBfdGhpczkuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICJMb2dpbiIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmIChfdGhpczkudG9fc2hvd19ub3RpZmljYXRpb25zKSB7CiAgICAgICAgICAgICAgICBfdGhpczkuc2NoZWR1bGVyX2NoYW5uZWwubGVhdmUoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF90aGlzOS50cmFpbmluZ19jaGFubmVsLmxlYXZlKCk7CgogICAgICAgICAgICAgIF90aGlzOS5zb2NrZXQuZGlzY29ubmVjdCgpOwoKICAgICAgICAgICAgICBfdGhpczkuJHNlc3Npb24uZGVzdHJveSgpOwoKICAgICAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICAgIF90aGlzOS4kcm9vdC4kZW1pdCgiQ2xlYXJfUmVmcmVzaF9Ub2tlbl9JbnRlcnZhbCIsIHsKICAgICAgICAgICAgICAgIGNsZWFyX2ludGVydmFsOiB0cnVlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGJ1cy4kZW1pdCgiTG9nZ2VkIG91dCIsICJUcnVlIik7CiAgICAgICAgICAgICAgYnVzLiRlbWl0KCJEaXNhYmxlIHRoZSBib3QgY2hhdCBub3ciLCAiVHJ1ZSIsICJMb2dnZWRvdXQiKTsKCiAgICAgICAgICAgICAgX3RoaXM5LiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICBuYW1lOiAiTG9naW4iCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc3VwZXJfYWRtaW5fYm90X2xvZ291dCgpLCB7CiAgICAgICAgICAgICAgY29tcGFueW5hbWU6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBjb21wYW55aWQ6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgIHVzZXJuYW1lOiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICB0b2tlbjogX3RoaXM5LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmIChfdGhpczkudG9fc2hvd19ub3RpZmljYXRpb25zKSB7CiAgICAgICAgICAgICAgICBfdGhpczkuc2NoZWR1bGVyX2NoYW5uZWwubGVhdmUoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF90aGlzOS50cmFpbmluZ19jaGFubmVsLmxlYXZlKCk7CgogICAgICAgICAgICAgIF90aGlzOS5zb2NrZXQuZGlzY29ubmVjdCgpOwoKICAgICAgICAgICAgICBfdGhpczkuJHNlc3Npb24uZGVzdHJveSgpOwoKICAgICAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICAgIF90aGlzOS4kcm9vdC4kZW1pdCgiQ2xlYXJfUmVmcmVzaF9Ub2tlbl9JbnRlcnZhbCIsIHsKICAgICAgICAgICAgICAgIGNsZWFyX2ludGVydmFsOiB0cnVlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGJ1cy4kZW1pdCgiTG9nZ2VkIG91dCIsICJUcnVlIik7CiAgICAgICAgICAgICAgYnVzLiRlbWl0KCJEaXNhYmxlIHRoZSBib3QgY2hhdCBub3ciLCAiVHJ1ZSIsICJMb2dnZWRvdXQiKTsKCiAgICAgICAgICAgICAgX3RoaXM5LiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICBuYW1lOiAiTG9naW4iCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBpZiAoX3RoaXM5LnRvX3Nob3dfbm90aWZpY2F0aW9ucykgewogICAgICAgICAgICAgICAgX3RoaXM5LnNjaGVkdWxlcl9jaGFubmVsLmxlYXZlKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczkudHJhaW5pbmdfY2hhbm5lbC5sZWF2ZSgpOwoKICAgICAgICAgICAgICBfdGhpczkuc29ja2V0LmRpc2Nvbm5lY3QoKTsKCiAgICAgICAgICAgICAgX3RoaXM5LiRzZXNzaW9uLmRlc3Ryb3koKTsKCiAgICAgICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgICBfdGhpczkuJHJvb3QuJGVtaXQoIkNsZWFyX1JlZnJlc2hfVG9rZW5fSW50ZXJ2YWwiLCB7CiAgICAgICAgICAgICAgICBjbGVhcl9pbnRlcnZhbDogdHJ1ZQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBidXMuJGVtaXQoIkxvZ2dlZCBvdXQiLCAiVHJ1ZSIpOwogICAgICAgICAgICAgIGJ1cy4kZW1pdCgiRGlzYWJsZSB0aGUgYm90IGNoYXQgbm93IiwgIlRydWUiLCAiTG9nZ2Vkb3V0Iik7CgogICAgICAgICAgICAgIF90aGlzOS4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgbmFtZTogIkxvZ2luIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChfdGhpczkudG9fc2hvd19ub3RpZmljYXRpb25zKSB7CiAgICAgICAgICAgIF90aGlzOS5zY2hlZHVsZXJfY2hhbm5lbC5sZWF2ZSgpOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzOS50cmFpbmluZ19jaGFubmVsLmxlYXZlKCk7CgogICAgICAgICAgX3RoaXM5LnNvY2tldC5kaXNjb25uZWN0KCk7CgogICAgICAgICAgX3RoaXM5LiRzZXNzaW9uLmRlc3Ryb3koKTsKCiAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBidXMuJGVtaXQoIkxvZ2dlZCBvdXQiLCAiVHJ1ZSIpOwogICAgICAgICAgYnVzLiRlbWl0KCJEaXNhYmxlIHRoZSBib3QgY2hhdCBub3ciLCAiVHJ1ZSIsICJMb2dnZWRvdXQiKTsKCiAgICAgICAgICBfdGhpczkuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogIkxvZ2luIgogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc2lnbm91dF91cmwoKSwgewogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJydCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09IF90aGlzOS5hcGlfc3RhdHVzX2NvZGUuVVNFUl9MT0dHRURfT1VUXzEwMzIuTVNHX0NPREUgfHwgcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09IF90aGlzOS5hcGlfc3RhdHVzX2NvZGUuVE9LRU5fSU5WQUxJRF8wMDAxLk1TR19DT0RFIHx8IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PSBfdGhpczkuYXBpX3N0YXR1c19jb2RlLklOVkFMSURfQ1JFREVOVElBTFNfMDAwNS5NU0dfQ09ERSkgewogICAgICAgICAgICBpZiAoX3RoaXM5LnRvX3Nob3dfbm90aWZpY2F0aW9ucykgewogICAgICAgICAgICAgIF90aGlzOS5zY2hlZHVsZXJfY2hhbm5lbC5sZWF2ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczkudHJhaW5pbmdfY2hhbm5lbC5sZWF2ZSgpOwoKICAgICAgICAgICAgX3RoaXM5LnNvY2tldC5kaXNjb25uZWN0KCk7CgogICAgICAgICAgICBfdGhpczkuJHNlc3Npb24uZGVzdHJveSgpOwoKICAgICAgICAgICAgX3RoaXM5LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgICAgX3RoaXM5LiRyb290LiRlbWl0KCJDbGVhcl9SZWZyZXNoX1Rva2VuX0ludGVydmFsIiwgewogICAgICAgICAgICAgIGNsZWFyX2ludGVydmFsOiB0cnVlCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgYnVzLiRlbWl0KCJMb2dnZWQgb3V0IiwgIlRydWUiKTsKICAgICAgICAgICAgYnVzLiRlbWl0KCJEaXNhYmxlIHRoZSBib3QgY2hhdCBub3ciLCAiVHJ1ZSIsICJMb2dnZWRvdXQiKTsKCiAgICAgICAgICAgIF90aGlzOS4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgIG5hbWU6ICJMb2dpbiIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChfdGhpczkudG9fc2hvd19ub3RpZmljYXRpb25zKSB7CiAgICAgICAgICAgIF90aGlzOS5zY2hlZHVsZXJfY2hhbm5lbC5sZWF2ZSgpOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzOS50cmFpbmluZ19jaGFubmVsLmxlYXZlKCk7CgogICAgICAgICAgX3RoaXM5LnNvY2tldC5kaXNjb25uZWN0KCk7CgogICAgICAgICAgX3RoaXM5LiRzZXNzaW9uLmRlc3Ryb3koKTsKCiAgICAgICAgICBfdGhpczkuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgICBidXMuJGVtaXQoIkxvZ2dlZCBvdXQiLCAiVHJ1ZSIpOwogICAgICAgICAgYnVzLiRlbWl0KCJEaXNhYmxlIHRoZSBib3QgY2hhdCBub3ciLCAiVHJ1ZSIsICJMb2dnZWRvdXQiKTsKCiAgICAgICAgICBfdGhpczkuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogIkxvZ2luIgogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyB1cGRhdGVfbm90aWZpY2F0aW9uc19saXN0KCkgewogICAgLy8gICB0aGlzLnNjaGVkdWxlcl9jaGFubmVsLnB1c2goInNob3dfbm90aWZpY2F0aW9ucyIsIHsKICAgIC8vICAgICBuZWVkX25vdGlmaWNhdGlvbnM6IHRydWUsCiAgICAvLyAgICAgZW1haWxfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgIC8vICAgfSk7CiAgICAvLyB9LAogICAgc2Vlbl9hbGxfbm90aWZpY2F0aW9uczogZnVuY3Rpb24gc2Vlbl9hbGxfbm90aWZpY2F0aW9ucygpIHsKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgdmFyIGxhc3RfaW5kZXggPSB0aGlzLm5vdGlmaWNhdGlvbnMubGVuZ3RoIC0gMTsKCiAgICAgIGlmIChsYXN0X2luZGV4ID49IDApIHsKICAgICAgICBpZiAodGhpcy5zY2hlZHVsZXJfY2hhbm5lbCkgewogICAgICAgICAgdGhpcy5zY2hlZHVsZXJfY2hhbm5lbC5wdXNoKCJub3RpZmljYXRpb25fc2VlbiIsIHsKICAgICAgICAgICAgcmVxX2lkOiB0aGlzLm5vdGlmaWNhdGlvbnNbbGFzdF9pbmRleF0uaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMudHJhaW5pbmdfY2hhbm5lbCkgewogICAgICAgICAgdGhpcy50cmFpbmluZ19jaGFubmVsLnB1c2goIm5vdGlmaWNhdGlvbl9zZWVuIiwgewogICAgICAgICAgICByZXFfaWQ6IHRoaXMubm90aWZpY2F0aW9uc1tsYXN0X2luZGV4XS5pZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY2xlYXJfYWxsX25vdGlmaWNhdGlvbnM6IGZ1bmN0aW9uIGNsZWFyX2FsbF9ub3RpZmljYXRpb25zKCkgewogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgdmFyIHJlcV9saXN0X2NsZWFyZWQgPSBbXTsKICAgICAgdmFyIG5vdGlmaWNhdGlvbnNfdGVtcF9saXN0ID0gdGhpcy5ub3RpZmljYXRpb25zOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG5vdGlmaWNhdGlvbnNfdGVtcF9saXN0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgaWYgKF90eXBlb2Yobm90aWZpY2F0aW9uc190ZW1wX2xpc3RbaV0pID09PSAib2JqZWN0IikgewogICAgICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9uc1tpXS5Ob3RpZmljYXRpb25pZCkgewogICAgICAgICAgICB0aGlzLnNjaGVkdWxlcl9jaGFubmVsLnB1c2goIm5vdGlmaWNhdGlvbl9jbGVhcmVkIiwgewogICAgICAgICAgICAgIHJlcV9pZDogdGhpcy5ub3RpZmljYXRpb25zW2ldLmlkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy50cmFpbmluZ19jaGFubmVsLnB1c2goIm5vdGlmaWNhdGlvbl9jbGVhcmVkIiwgewogICAgICAgICAgICAgIHJlcV9pZDogdGhpcy5ub3RpZmljYXRpb25zW2ldLmlkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJlcV9saXN0X2NsZWFyZWQucHVzaChub3RpZmljYXRpb25zX3RlbXBfbGlzdFtpXS5pZCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLm5vdGlmaWNhdGlvbnMgPSBub3RpZmljYXRpb25zX3RlbXBfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikgewogICAgICAgIHJldHVybiByZXFfbGlzdF9jbGVhcmVkLmluY2x1ZGVzKG5vdGlmaWNhdGlvbi5pZCkgPT09IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICBjbGVhcl9zaW5nbGVfbm90aWZpY2F0aW9uOiBmdW5jdGlvbiBjbGVhcl9zaW5nbGVfbm90aWZpY2F0aW9uKHJlcV9pZCwgaW5kZXgpIHsKICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CgogICAgICBpZiAocmVxX2lkICE9PSBudWxsKSB7CiAgICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9uc1tpbmRleF0uTm90aWZpY2F0aW9uaWQpIHsKICAgICAgICAgIHRoaXMuc2NoZWR1bGVyX2NoYW5uZWwucHVzaCgibm90aWZpY2F0aW9uX2NsZWFyZWQiLCB7CiAgICAgICAgICAgIHJlcV9pZDogcmVxX2lkCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy50cmFpbmluZ19jaGFubmVsLnB1c2goIm5vdGlmaWNhdGlvbl9jbGVhcmVkIiwgewogICAgICAgICAgICByZXFfaWQ6IHJlcV9pZAogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLm5vdGlmaWNhdGlvbnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQogICAgfSwKICAgIHNob3dfbm90aWZpY2F0aW9uczogZnVuY3Rpb24gc2hvd19ub3RpZmljYXRpb25zKGRhdGEpIHsKICAgICAgaWYgKGRhdGEgIT0gMSkgewogICAgICAgIGlmIChkYXRhLk5vdGlmaWNhdGlvbmlkKSB7CiAgICAgICAgICB2YXIgZGF0ZTsKICAgICAgICAgIHZhciBtb250aE5hbWVzID0gWyJKYW4iLCAiRmViIiwgIk1hciIsICJBcHIiLCAiTWF5IiwgIkp1biIsICJKdWwiLCAiQXVnIiwgIlNlcCIsICJPY3QiLCAiTm92IiwgIkRlYyJdOwogICAgICAgICAgZGF0ZSA9IGRhdGEudmlzaXRfZGF0ZS5zcGxpdCgiICIpWzBdLnNwbGl0KCItIilbMl0gKyAiICIgKyBtb250aE5hbWVzW2RhdGEudmlzaXRfZGF0ZS5zcGxpdCgiICIpWzBdLnNwbGl0KCItIilbMV0gLSAxXSArICIgIiArIGRhdGEudmlzaXRfZGF0ZS5zcGxpdCgiICIpWzBdLnNwbGl0KCItIilbMF07CiAgICAgICAgICB2YXIgdGltZTsKICAgICAgICAgIGRhdGEudmlzaXRfc2xvdC5zcGxpdCgiLSIpWzBdOwoKICAgICAgICAgIGlmIChkYXRhLnZpc2l0X3Nsb3Quc3BsaXQoIi0iKVswXS5zcGxpdCgiOiIpWzBdIDwgMTIpIHsKICAgICAgICAgICAgdGltZSA9IE51bWJlcihkYXRhLnZpc2l0X3Nsb3Quc3BsaXQoIi0iKVswXS5zcGxpdCgiOiIpWzBdKSArICI6MDAgYW0iOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnZpc2l0X3Nsb3Quc3BsaXQoIi0iKVswXS5zcGxpdCgiOiIpWzBdID09IDEyKSB7CiAgICAgICAgICAgIHRpbWUgPSAiMTI6MDAgcG0iOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnZpc2l0X3Nsb3Quc3BsaXQoIi0iKVswXS5zcGxpdCgiOiIpWzBdID4gMTIgJiYgZGF0YS52aXNpdF9zbG90LnNwbGl0KCItIilbMF0uc3BsaXQoIjoiKVswXSA8IDI0KSB7CiAgICAgICAgICAgIHRpbWUgPSBOdW1iZXIoZGF0YS52aXNpdF9zbG90LnNwbGl0KCItIilbMF0uc3BsaXQoIjoiKVswXSkgLSAxMiArICI6MDAgcG0iOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnZpc2l0X3Nsb3Quc3BsaXQoIi0iKVswXS5zcGxpdCgiOiIpWzBdID09IDI0KSB7CiAgICAgICAgICAgIHRpbWUgPSAiMTI6MDAgYW0iOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChkYXRhLk5vdGlmaWNhdGlvbmlkID09ICJBcHBvaW50bWVudCBEZWxldGVkIikgewogICAgICAgICAgICB0b2FzdHIuZXJyb3IoZGF0YS52aXNpdG9yX25hbWUgKyAiIi5jb25jYXQodGhpcy50bHQoJ2hhc19jYW5jZWxsZWRfYXBwb2ludG1lbnRfc2NoZWR1bGVfb24nKSkgKyBkYXRlICsgIiBhdCAiICsgdGltZSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuTm90aWZpY2F0aW9uaWQgPT0gIkFwcG9pbnRtZW50IENvbmZpcm1lZCIpIHsKICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoZGF0YS52aXNpdG9yX25hbWUgKyAiIi5jb25jYXQodGhpcy50bHQoJ2hhc19jb25maXJtZWRfYXBwb2ludG1lbnRfc2NoZWR1bGVfb24nKSkgKyBkYXRlICsgIiBhdCAiICsgdGltZSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuTm90aWZpY2F0aW9uaWQgPT0gIkFwcG9pbnRtZW50IFJlc2NoZWR1bGVkIikgewogICAgICAgICAgICB0b2FzdHIud2FybmluZyhkYXRhLnZpc2l0b3JfbmFtZSArICIiLmNvbmNhdCh0aGlzLnRsdCgnaGFzX3Jlc2NoZWR1bGVkX2FwcG9pbnRtZW50X29uJykpICsgZGF0ZSArICIgYXQgIiArIHRpbWUpOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLk5vdGlmaWNhdGlvbmlkID09ICJBcHBvaW50bWVudCBTY2hlZHVsZWQiKSB7CiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKGRhdGEudmlzaXRvcl9uYW1lICsgIiIuY29uY2F0KHRoaXMudGx0KCdoYXNfYmVlbl9zY2hlZHVsZWRfYW5fYXBwb2ludG1lbnRfb24nKSkgKyBkYXRlICsgIiBhdCAiICsgdGltZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChkYXRhLk1vZGVsVHlwZSA9PSAiSW50ZW50LERpYWxvZ3VlIikgewogICAgICAgICAgdmFyIGRhdGU7CiAgICAgICAgICBkYXRlID0gbW9tZW50KGRhdGEuSW5pdGlhdGVkT24sIFsiWVlZWS1NTS1ERCJdKS5mb3JtYXQoIkRvIE1NTSBZWVlZIik7CgogICAgICAgICAgaWYgKGRhdGEuVHJhaW5pbmdTdGF0dXMgPT0gIkZhaWxlZCIpIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKCIiLmNvbmNhdCh0aGlzLnRsdCgndHJhaW5pbmdfb2ZfbW9kZWxfb24nKSwgIiAiKS5jb25jYXQoZGF0ZSwgIiAiKS5jb25jYXQodGhpcy50bHQoJ2ZhaWxlZF9jb250YWN0X2FkbWluJykpKTsKICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5UcmFpbmluZ1N0YXR1cyA9PSAiQ29tcGxldGVkIikgewogICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiIi5jb25jYXQodGhpcy50bHQoJ3RyYWluaW5nX29mX25ld19tb2RlbF9pbml0aWF0ZWQnKSwgIiAiKS5jb25jYXQoZGF0ZSwgIiAiKS5jb25jYXQodGhpcy50bHQoJ2hhc19iZWVuX2NvbXBsZXRlZF9zdWNjZXNzZnVsbHknKSkpOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLlRyYWluaW5nU3RhdHVzID09ICJTdGFydGVkIikgewogICAgICAgICAgICB0b2FzdHIuaW5mbygiIi5jb25jYXQodGhpcy50bHQoJ25ld19yZXFfZm9yX3RyYWluaW5nX2luaXRpYXRlZCcpLCAiICIpLmNvbmNhdChkYXRlLCAiLiIpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGRhdGEuTW9kZWxUeXBlKSB7CiAgICAgICAgICB2YXIgZGF0ZTsKICAgICAgICAgIGRhdGUgPSBtb21lbnQoZGF0YS5Jbml0aWF0ZWRPbiwgWyJZWVlZLU1NLUREIl0pLmZvcm1hdCgiRG8gTU1NIFlZWVkiKTsKCiAgICAgICAgICBpZiAoZGF0YS5UcmFpbmluZ1N0YXR1cyA9PSAiRmFpbGVkIikgewogICAgICAgICAgICB0b2FzdHIuZXJyb3IoIiIuY29uY2F0KHRoaXMudGx0KCd0cmFpbmluZ19vZicpLCAiICIpLmNvbmNhdChkYXRhLk1vZGVsVHlwZSwgIiAiKS5jb25jYXQodGhpcy50bHQoJ21vZGVsX29uJyksICIgIikuY29uY2F0KGRhdGUsICIgIikuY29uY2F0KHRoaXMudGx0KCdmYWlsZWRfY29udGFjdF9hZG1pbicpKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuVHJhaW5pbmdTdGF0dXMgPT0gIkNvbXBsZXRlZCIpIHsKICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIiIuY29uY2F0KHRoaXMudGx0KCd0cmFpbmluZ19vZl9uZXcnKSwgIiAiKS5jb25jYXQoZGF0YS5Nb2RlbFR5cGUsICIgIikuY29uY2F0KHRoaXMudGx0KCdtb2RlbF9pbml0aWF0ZWRfb24nKSwgIiAiKS5jb25jYXQoZGF0ZSwgIiAiKS5jb25jYXQodGhpcy50bHQoJ2hhc19iZWVuX2NvbXBsZXRlZF9zdWNjZXNzZnVsbHknKSkpOwogICAgICAgICAgfSBlbHNlIGlmIChkYXRhLlRyYWluaW5nU3RhdHVzID09ICJTdGFydGVkIikgewogICAgICAgICAgICB0b2FzdHIuaW5mbygiIi5jb25jYXQodGhpcy50bHQoJ25ld19yZXFfZm9yX3RyYWluaW5nJyksICIgIikuY29uY2F0KGRhdGEuTW9kZWxUeXBlLCAiICIpLmNvbmNhdCh0aGlzLnRsdCgnbW9kZWxfaGFzX2JlZW5faW5pdGlhdGVkX29uJyksICIgIikuY29uY2F0KGRhdGUsICIuIikpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHN0YXJ0X3RvdXI6IGZ1bmN0aW9uIHN0YXJ0X3RvdXIoKSB7CiAgICAgIHRoaXMuJHJvb3QuJGVtaXQoInNob3dfdG91cl9ndWlkZSIsIHRydWUpOwogICAgfSwKICAgIGdlbmVyYXRlX2VtYWlsX3dpemFyZDogZnVuY3Rpb24gZ2VuZXJhdGVfZW1haWxfd2l6YXJkKG1vZGVsVHlwZSwgaW5pdGlhdGVkT24pIHsKICAgICAgdmFyIHVzZXJuYW1lID0gIiIuY29uY2F0KHRoaXMudXNlcl9maXJzdF9uYW1lLCAiICIpLmNvbmNhdCh0aGlzLnVzZXJfbGFzdF9uYW1lKTsKICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CgogICAgICBpZiAobW9kZWxUeXBlID09ICJJbnRlbnQsRGlhbG9ndWUiKSB7CiAgICAgICAgYS5ocmVmID0gIm1haWx0bzphZG1pbkBjZW5zZS5haT9zdWJqZWN0PSIuY29uY2F0KHRoaXMudGx0KCdjaGF0Ym90X21vZGVsX3RyYWluaW5nX2ZhaWxlZF9vbicpLCAiICIpLmNvbmNhdChpbml0aWF0ZWRPbiwgIi4mYm9keT0iKS5jb25jYXQodGhpcy50bHQoJ2hpX2NlbnNlX3RlYW0nKSwgIiwlMEQlMEEsICIpLmNvbmNhdCh0aGlzLnRsdCgnY2hhdGJvdF9mYWlsZWRfYWRtaW5fd2lsbF9sb29rJyksICIuJTBEJTBBIikuY29uY2F0KHRoaXMudGx0KCd0aGFua3MnKSwgIiwlMEQlMEEiKS5jb25jYXQodXNlcm5hbWUpOwogICAgICB9IGVsc2UgewogICAgICAgIGEuaHJlZiA9ICJtYWlsdG86YWRtaW5AY2Vuc2UuYWk/c3ViamVjdD0iLmNvbmNhdChtb2RlbFR5cGUsICIgIikuY29uY2F0KHRoaXMudGx0KCdtb2RlbF90cmFpbmluZ19mYWlsZWRfb24nKSwgIiAiKS5jb25jYXQoaW5pdGlhdGVkT24sICIuJmJvZHk9IikuY29uY2F0KHRoaXMudGx0KCdoaV9jZW5zZV90ZWFtJyksICIsJTBEJTBBLCAiKS5jb25jYXQodGhpcy50bHQoJ3RoZScpLCAiICIpLmNvbmNhdChtb2RlbFR5cGUsICIgIikuY29uY2F0KHRoaXMudGx0KCdjaGF0Ym90X2ZhaWxlZF9hZG1pbl93aWxsX2xvb2snKSwgIi4lMEQlMEEiKS5jb25jYXQodGhpcy50bHQoJ3RoYW5rcycpLCAiLCUwRCUwQSIpLmNvbmNhdCh1c2VybmFtZSk7CiAgICAgIH0KCiAgICAgIGEuY2xpY2soKTsKICAgIH0sCiAgICBwYWdlX3JlZGlyZWN0OiBmdW5jdGlvbiBwYWdlX3JlZGlyZWN0KCkgewogICAgICBpZiAodGhpcy4kcm91dGUubmFtZSAhPT0gIkRhc2hib2FyZCIpIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBuYW1lOiAiRGFzaGJvYXJkIgogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoImNoYW5nZV9zaWRlYmFyX21haW5fbWVudSIsICJEYXNoYm9hcmQiKTsKICAgICAgfQogICAgfSwKICAgIHRvcG5hdmJhcl9kaXNhYmxlOiBmdW5jdGlvbiB0b3BuYXZiYXJfZGlzYWJsZSgpIHsKICAgICAgaWYgKHRoaXMuZGlzYWJsZV9uYXZiYXIgPT09IHRydWUpIHsKICAgICAgICByZXR1cm4gInBvaW50ZXItZXZlbnRzOm5vbmU7IjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgIH0KICB9Cn07"},null]}