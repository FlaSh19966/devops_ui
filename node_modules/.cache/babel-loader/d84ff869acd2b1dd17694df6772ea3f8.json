{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Apps/Scheduler.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Apps/Scheduler.vue","mtime":1643027096156},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybCI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwppbXBvcnQgc3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7IC8vIGltcG9ydCBUaW1lUGlja2VyIGZyb20gImFudC1kZXNpZ24tdnVlL2xpYi90aW1lLXBpY2tlciI7CgppbXBvcnQgQ2FsZW5kYXIgZnJvbSAiLi4vLi4vLi4vLi4vLi4vcHVibGljL2pzL3R1aS1jYWxlbmRhci5taW4uanMiOwppbXBvcnQgRGF0ZVBpY2tlciBmcm9tICJ0dWktZGF0ZS1waWNrZXIiOwppbXBvcnQgInR1aS1kYXRlLXBpY2tlci9kaXN0L3R1aS1kYXRlLXBpY2tlci5jc3MiOwppbXBvcnQgIi4uLy4uLy4uLy4uLy4uL3B1YmxpYy9jc3Mvc2Vnb2UtdWkuY3NzIjsKaW1wb3J0ICIuLi8uLi8uLi8uLi8uLi9wdWJsaWMvY3NzL3R1aS1jYWxlbmRhci5taW4uY3NzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJTY2hlZHVsZXIiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjYWxlbmRhckluc3RhbmNlOiBudWxsLAogICAgICBjdXJyZW50X2NhbGVuZGFyX3ZpZXc6ICdkYXknLAogICAgICBzaG93X3NwaW5uZXI6IGZhbHNlLAogICAgICBzZWxlY3RlZF90aW1lOiAiIiwKICAgICAgZGlzcGxheV9zZWxlY3RlZF90aW1lOiAiIiwKICAgICAgc2NoZWR1bGVkX3RpbWU6ICIiLAogICAgICBzZWxlY3RlZF9kYXRlOiAiIiwKICAgICAgcGF0aWVudF9uYW1lOiAiIiwKICAgICAgdmlzaXRvcl9udW1iZXI6ICIiLAogICAgICB2aXNpdF9yZWFzb246ICIiLAogICAgICB2aXNpdG9yX3N5bXB0b21zOiAiIiwKICAgICAgc2NoZWR1bGVfbGlzdDogW10sCiAgICAgIHNlbGVjdGVkX3NjaGVkdWxlX2lkOiAiIiwKICAgICAgc2VsZWN0ZWRfc2NoZWR1bGVfdmlzaXRfc2xvdDogIiIsCiAgICAgIGlzRWRpdDogZmFsc2UsCiAgICAgIHNwaW5uZXJPbjogZmFsc2UsCiAgICAgIHBob25lX251bWJlcl92YWxpZGl0eTogL1wrWzAtOV17OSwxNH0kLywKICAgICAgZnVsbF90aW1lX3Nsb3RzOiBbXSwKICAgICAgdGltZV9zbG90czogW10sCiAgICAgIHNlbGVjdGVkX3RpbWVfc2xvdDogIiIsCiAgICAgIHVzZXJfcm9sZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUsCiAgICAgIHNjaGVkdWxpbmdfY29udGFjdF9udW1iZXI6ICIiLAogICAgICBmaWxlX2xhYmVsOiAiQ2hvb3NlIEZpbGUiLAogICAgICB3ZWVrX2RheXM6IFsiTW9uZGF5IiwgIlR1ZXNkYXkiLCAiV2VkbmVzZGF5IiwgIlRodXJzZGF5IiwgIkZyaWRheSIsICJTYXR1cmRheSIsICJTdW5kYXkiXSwKICAgICAgZGF5c0luTW9udGg6IFtdLAogICAgICBhY3RpdmVNb250aFllYXI6ICcnLAogICAgICBjc3ZfZmlsZTogIiIsCiAgICAgIHNjaF92b2ljZV9ncmVldGluZ3M6ICIiLAogICAgICBzY2hfc21zX2dyZWV0aW5nczogIiIsCiAgICAgIHNob3dfY2hlY2tfYW5kX2NoYW5nZV9zdGF0dXM6IHRydWUsCiAgICAgIHVzZXJfdHlwZTogbnVsbCwKICAgICAgdmlzaXRfc3RhdHVzX2RhdGE6IG51bGwsCiAgICAgIHZpc2l0X3N0YXR1c19jb21wYXJpc29uX2RhdGE6IFtdLAogICAgICBkYWlseV9kYXRlOiAiIiwKICAgICAgaXNSZXNjaGVkdWxlOiB0cnVlLAogICAgICBkYXRlcGlja2VySW5zdGFuY2U6IG51bGwsCiAgICAgIG5ld19zZWxlY3RlZF9kYXRlOiAiIiwKICAgICAgY2FsbF9yZW1pbmRlcl9ocnM6IE51bWJlciwKICAgICAgY2FsbF9yZW1pbmRlcl9taW5zOiBOdW1iZXIsCiAgICAgIGVkaXRfc2NoZWR1bGluZzogZmFsc2UsCiAgICAgIHRlbXBfZGF0YTogIiIsCiAgICAgIGlzQXBwb2ludG1lbnRDb25maXJtZWQ6IGZhbHNlLAogICAgICBhcHBvaW50bWVudFN0YXR1czogIiIsCiAgICAgIHZpc2l0U3RhdHVzOiAiIiwKICAgICAgQXBwb2ludG1lbnRJRDogJycsCiAgICAgIGlzUmVzY2hlZHVsZXRpbWU6IGZhbHNlLAogICAgICB0ZW1wX25hbWU6ICIiLAogICAgICB0ZW1wX3JlYXNvbjogIiIsCiAgICAgIHRlbXBfc3ltcHRvbXM6ICIiLAogICAgICB0ZW1wX2FwcG9pbnRtZW50X2RhdGU6ICIiLAogICAgICB0ZW1wX2FwcG9pbnRtZW50X3RpbWU6ICIiLAogICAgICB0ZW1wX3RpbWVfc2xvdHM6IFtdLAogICAgICBjb21wYW55aWQ6ICIiLAogICAgICBjb21wYW55bmFtZTogIiIsCiAgICAgIHN1cHBvcnRfbnVtYmVyc19saXN0OiBbXSwKICAgICAgZmlsbGVkX3RpbWVfc2xvdHNfc2VsZWN0ZWRfZGF0ZTogW10KICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7Ly8gVGltZVBpY2tlcgogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHZhbGlkUGhvbmVOdW1iZXI6IGZ1bmN0aW9uIHZhbGlkUGhvbmVOdW1iZXIoKSB7CiAgICAgIGlmICh0aGlzLnBob25lX251bWJlcl92YWxpZGl0eS50ZXN0KHRoaXMuc2NoZWR1bGluZ19jb250YWN0X251bWJlci5yZXBsYWNlKC9ccysvZywgJycpKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgcGhvbmUgbnVtYmVyIGluIHRoZSBmb3JtYXQ6ICtDb3VudHJ5Q29kZSBOdW1iZXIiOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlTW9kYWxUaXRsZTogZnVuY3Rpb24gY3JlYXRlTW9kYWxUaXRsZSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGF0aWVudF9uYW1lLnNwbGl0KCcgJykuc2xpY2UoMCwgMSkubWFwKGZ1bmN0aW9uICh3b3JkKSB7CiAgICAgICAgcmV0dXJuIHdvcmQuY2hhckF0KDApOwogICAgICB9KS5qb2luKCcnKS50b1VwcGVyQ2FzZSgpOwogICAgfSwKICAgIHRpbWVTbG90c0xpc3Q6IGZ1bmN0aW9uIHRpbWVTbG90c0xpc3QoKSB7CiAgICAgIHZhciBsaXN0ID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSAyMzsgaSArPSAxKSB7CiAgICAgICAgbGlzdC5wdXNoKHsKICAgICAgICAgIGRpc3BsYXk6IG1vbWVudChpLCBbJ2gnXSkuZm9ybWF0KCdoOm1tIEEnKSwKICAgICAgICAgIHZhbHVlOiBtb21lbnQoaSwgWydoJ10pLmZvcm1hdCgnSDptbScpCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBsaXN0OwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGN1cnJlbnRfY2FsZW5kYXJfdmlldzogZnVuY3Rpb24gY3VycmVudF9jYWxlbmRhcl92aWV3KG5ld1ZhbCkgewogICAgICB0aGlzLnRvZ2dsZV92aWV3KG5ld1ZhbCk7CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBpZiAoIXRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55SWQiKSAmJiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucm9sZSA9PSAiU3VwZXJBZG1pbiIpIHsKICAgICAgdG9hc3RyLndhcm5pbmcoIlBsZWFzZSBzZWxlY3QgYSBjb21wYW55IG5hbWUgZnJvbSB0aGUgZHJvcGRvd24iKTsKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMubG9hZF9zdXBwb3J0X3VybCgpLCB7CiAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBzaG93X3N1cGVyYWRtaW46ICJUcnVlIiwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgaXNTaG93OiAiVHJ1ZSIKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzLnN1cHBvcnRfbnVtYmVyc19saXN0ID0gcmVzcG9uc2UuZGF0YVswXS5tYXAoZnVuY3Rpb24gKG51bWJlcikgewogICAgICAgICAgcmV0dXJuIG51bWJlclsiQ29udGFjdE51bWJlciJdOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAodGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUgPT0gIlN1cGVyQWRtaW4iKSB7CiAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlJZCIpOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgIH0KCiAgICBpZiAodGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpIHx8IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlICE9ICJTdXBlckFkbWluIikgewogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5sb2FkX3N1cHBvcnRfdXJsKCksIHsKICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICBpc1Nob3c6ICJUcnVlIgogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMuc3VwcG9ydF9udW1iZXJzX2xpc3QgPSByZXNwb25zZS5kYXRhWzBdLm1hcChmdW5jdGlvbiAobnVtYmVyKSB7CiAgICAgICAgICByZXR1cm4gbnVtYmVyWyJDb250YWN0TnVtYmVyIl07CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIHRoaXMuc2hvd19zcGlubmVyID0gdHJ1ZTsKICAgIHZhciB2bSA9IHRoaXM7CiAgICB0aGlzLmNhbGVuZGFySW5zdGFuY2UgPSBuZXcgQ2FsZW5kYXIoIiNjYWxlbmRhciIsIHsKICAgICAgZGVmYXVsdFZpZXc6ICJkYXkiLAogICAgICB0YXNrVmlldzogZmFsc2UsCiAgICAgIHNjaGVkdWxlVmlldzogWyJ0aW1lIl0sCiAgICAgIHRoZW1lOiB7CiAgICAgICAgJ21vbnRoLmRheW5hbWUudGV4dEFsaWduJzogJ2NlbnRlcicsCiAgICAgICAgJ21vbnRoLmRheW5hbWUudGV4dFRyYW5zZm9ybSc6ICd1cHBlcmNhc2UnLAogICAgICAgICd3ZWVrLmRheW5hbWUuYm9yZGVyTGVmdCc6ICcxcHggc29saWQgI0RGREZERicsCiAgICAgICAgJ21vbnRoLnNjaGVkdWxlLmJvcmRlclJhZGl1cyc6ICcycHgnLAogICAgICAgICdtb250aC5zY2hlZHVsZS5tYXJnaW5Ub3AnOiAnMnB4JywKICAgICAgICAnbW9udGguc2NoZWR1bGUubWFyZ2luTGVmdCc6ICc4cHgnLAogICAgICAgICdtb250aC5zY2hlZHVsZS5tYXJnaW5SaWdodCc6ICc4cHgnLAogICAgICAgICd3ZWVrLmRheWdyaWQuYmFja2dyb3VuZENvbG9yJzogJ25vbmUnLAogICAgICAgICd3ZWVrLmRheW5hbWUudGV4dEFsaWduJzogJ2NlbnRlcicsCiAgICAgICAgJ3dlZWsuZGF5bmFtZS50ZXh0VHJhbnNmb3JtJzogJ3VwcGVyY2FzZScsCiAgICAgICAgJ3dlZWsudGltZWdyaWRIb3Jpem9udGFsTGluZS5ib3JkZXJCb3R0b20nOiAnMXB4IGRhc2hlZCAjRjFGMUYxJywKICAgICAgICAnd2Vlay50aW1lZ3JpZC5ib3JkZXJSaWdodCc6ICcxcHggc29saWQgI0RGREZERicKICAgICAgfSwKICAgICAgdGVtcGxhdGU6IHsKICAgICAgICBtb250aEdyaWRIZWFkZXI6IGZ1bmN0aW9uIG1vbnRoR3JpZEhlYWRlcihkYXlNb2RlbCkgewogICAgICAgICAgdmFyIGRhdGUgPSBtb21lbnQoZGF5TW9kZWwuZGF0ZSwgWydZWVlZLU1NLUREJ10pLmZvcm1hdCgnREQnKTsKICAgICAgICAgIHZhciBjbGFzc05hbWVzID0gWyd0dWktZnVsbC1jYWxlbmRhci13ZWVrZGF5LWdyaWQtZGF0ZSAnXTsKCiAgICAgICAgICBpZiAoZGF5TW9kZWwuaXNUb2RheSkgewogICAgICAgICAgICBjbGFzc05hbWVzLnB1c2goJ3R1aS1mdWxsLWNhbGVuZGFyLXdlZWtkYXktZ3JpZC1kYXRlLWRlY29yYXRvcicpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiAnPHNwYW4gY2xhc3M9IicgKyBjbGFzc05hbWVzLmpvaW4oJyAnKSArICciPicgKyBkYXRlICsgJzwvc3Bhbj4nOwogICAgICAgIH0sCiAgICAgICAgbW9udGhEYXluYW1lOiBmdW5jdGlvbiBtb250aERheW5hbWUobW9kZWwpIHsKICAgICAgICAgIHJldHVybiAiPHNwYW4gc3R5bGU9XCJjb2xvcjojOTU5NTk1XCI+Ii5jb25jYXQobW9kZWwubGFiZWwudG9TdHJpbmcoKS50b0xvY2FsZVVwcGVyQ2FzZSgpLCAiPC9zcGFuPiIpOwogICAgICAgIH0sCiAgICAgICAgd2Vla0RheW5hbWU6IGZ1bmN0aW9uIHdlZWtEYXluYW1lKG1vZGVsKSB7CiAgICAgICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPSJ0dWktZnVsbC1jYWxlbmRhci1kYXluYW1lLWRhdGUiPjwvc3Bhbj4mbmJzcDsmbmJzcDs8c3BhbiBjbGFzcz0idHVpLWZ1bGwtY2FsZW5kYXItZGF5bmFtZS1uYW1lIj4nICsgbW9kZWwuZGF5TmFtZS50b0xvY2FsZVVwcGVyQ2FzZSgpICsgJzwvc3Bhbj4nOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlQ3JlYXRpb25Qb3B1cDogZmFsc2UsCiAgICAgIHVzZURldGFpbFBvcHVwOiBmYWxzZQogICAgfSk7CiAgICB0aGlzLmN1cnJlbnRfY2FsZW5kYXJfdmlldyA9ICJkYXkiOwogICAgdGhpcy5jYWxlbmRhckluc3RhbmNlLm9uKCJjbGlja0RheW5hbWUiLCBmdW5jdGlvbiAoZSkgewogICAgICBpZiAodm0uY2FsZW5kYXJJbnN0YW5jZS5nZXRWaWV3TmFtZSgpID09PSAid2VlayIpIHsKICAgICAgICB2bS5jYWxlbmRhckluc3RhbmNlLnNldERhdGUobmV3IERhdGUoZS5kYXRlKSk7CiAgICAgICAgdm0uY2FsZW5kYXJJbnN0YW5jZS5jaGFuZ2VWaWV3KCJkYXkiLCB0cnVlKTsKICAgICAgICB0aGlzLmN1cnJlbnRfY2FsZW5kYXJfdmlldyA9ICJkYXkiOwogICAgICAgIHZtLnNldFJlbmRlclJhbmdlVGV4dCgpOwogICAgICB9CiAgICB9KTsKICAgIHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5vbigiYWZ0ZXJSZW5kZXJTY2hlZHVsZSIsIGZ1bmN0aW9uIChlKSB7fSk7CiAgICB0aGlzLnNldFJlbmRlclJhbmdlVGV4dCgpOwogICAgdGhpcy5jYWxlbmRhckluc3RhbmNlLm9uKCJiZWZvcmVDcmVhdGVTY2hlZHVsZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIF90aGlzMi5uZXdfc2NoZWR1bGUoZS5zdGFydC5fZGF0ZSk7CgogICAgICBlLmd1aWRlLmNsZWFyR3VpZGVFbGVtZW50KCk7CiAgICB9KTsKICAgIHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5vbigiY2xpY2tTY2hlZHVsZSIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoZXZlbnQuc2NoZWR1bGUucmF3LmlzSG9saWRheSkgewogICAgICAgIHRvYXN0ci5lcnJvcigiWW91IGNhbm5vdCBlbnRlciBhIHNjaGVkdWxlIGZvciB0aGlzIGRhdGUuIFxuIFJlYXNvbjogIiArIGV2ZW50LnNjaGVkdWxlLnJhdy5yZWFzb24pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBzY2hlZHVsZSA9IGV2ZW50LnNjaGVkdWxlOwogICAgICAgIHZtLnBhdGllbnRfbmFtZSA9IHNjaGVkdWxlLnRpdGxlOwogICAgICAgIHZtLnZpc2l0X3JlYXNvbiA9IHNjaGVkdWxlLnJhdy5yZWFzb247CiAgICAgICAgdm0udmlzaXRvcl9zeW1wdG9tcyA9IHNjaGVkdWxlLnJhdy5zeW1wdG9tczsKICAgICAgICB2bS52aXNpdG9yX251bWJlciA9IHNjaGVkdWxlLnJhdy5waG9uZV9udW1iZXI7CiAgICAgICAgdmFyIHNlbGVjdGVkX3RpbWUgPSBzY2hlZHVsZS5yYXcuc3RhcnQgKyAiLSIgKyBzY2hlZHVsZS5yYXcuZW5kOwogICAgICAgIHZhciBzZWxlY3RlZF90aW1lX3N0YXJ0ID0gbW9tZW50KHNjaGVkdWxlLnJhdy5zdGFydCwgWydISDptbSddKS5mb3JtYXQoJ2hoOm1tIEEnKTsKICAgICAgICB2YXIgc2VsZWN0ZWRfdGltZV9lbmQgPSBtb21lbnQoc2NoZWR1bGUucmF3LmVuZCwgWydISDptbSddKS5mb3JtYXQoJ2hoOm1tIEEnKTsKICAgICAgICB2bS5kaXNwbGF5X3NlbGVjdGVkX3RpbWUgPSAiIi5jb25jYXQoc2VsZWN0ZWRfdGltZV9zdGFydCwgIiAtICIpLmNvbmNhdChzZWxlY3RlZF90aW1lX2VuZCk7CiAgICAgICAgdm0uc2VsZWN0ZWRfc2NoZWR1bGVfaWQgPSBzY2hlZHVsZS5pZDsKICAgICAgICB2bS5zZWxlY3RlZF9zY2hlZHVsZV92aXNpdF9zbG90ID0gc2NoZWR1bGUucmF3LnZpc2l0X3Nsb3Q7CiAgICAgICAgdm0uZ2V0X3RpbWVfc2xvdHMoc2NoZWR1bGUuc3RhcnQuX2RhdGUsICIjc2NoZWR1bGVfZGV0YWlscyIsIHNlbGVjdGVkX3RpbWUpOwogICAgICAgIHZtLmFwcG9pbnRtZW50U3RhdHVzID0gc2NoZWR1bGUucmF3LmFwcG9pbnRtZW50X3N0YXR1czsKICAgICAgICB2bS5BcHBvaW50bWVudElEID0gc2NoZWR1bGUucmF3LmFwcG9pbnRtZW50X2lkOwogICAgICAgIHZtLnZpc2l0U3RhdHVzID0gc2NoZWR1bGUucmF3LnZpc2l0X3N0YXR1czsKICAgICAgICB2bS5vcGVuQ2hlY2tBbmRDaGFuZ2VTdGF0dXNNb2RhbChzY2hlZHVsZS5yYXcuYXBwb2ludG1lbnRfaWQsIHNjaGVkdWxlLnN0YXJ0Ll9kYXRlKTsKICAgICAgfQogICAgfSk7CiAgICB0aGlzLnVwZGF0ZV9zY2hlZHVsZXNfbGlzdCgpOwogICAgJCgiI3NjaGVkdWxlX2RldGFpbHMiKS5vbigiaGlkZGVuLmJzLm1vZGFsIiwgZnVuY3Rpb24gKCkgewogICAgICBpZiAoIXZtLmVkaXRfc2NoZWR1bGluZykgewogICAgICAgIHZtLnBhdGllbnRfbmFtZSA9ICIiOwogICAgICAgIHZtLnZpc2l0X3JlYXNvbiA9ICIiOwogICAgICAgIHZtLnZpc2l0b3Jfc3ltcHRvbXMgPSAiIjsKICAgICAgICB2bS52aXNpdG9yX251bWJlciA9ICIiOwogICAgICAgIHZtLnNlbGVjdGVkX3RpbWUgPSAiIjsKICAgICAgICB2bS5pc0VkaXQgPSBmYWxzZTsKICAgICAgICB2bS5zZWxlY3RlZF9zY2hlZHVsZV9pZCA9ICIiOwogICAgICAgIHZtLnNlbGVjdGVkX3NjaGVkdWxlX3Zpc2l0X3Nsb3QgPSAiIjsKICAgICAgICB2bS5pc1Jlc2NoZWR1bGV0aW1lID0gZmFsc2U7CiAgICAgICAgdm0uZWRpdF9zY2hlZHVsaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0pOwogICAgJCgiI3NjaGVkdWxlX2NyZWF0ZSIpLm9uKCJoaWRkZW4uYnMubW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZtLnBhdGllbnRfbmFtZSA9ICIiOwogICAgICB2bS52aXNpdF9yZWFzb24gPSAiIjsKICAgICAgdm0udmlzaXRvcl9zeW1wdG9tcyA9ICIiOwogICAgICB2bS52aXNpdG9yX251bWJlciA9ICIiOwogICAgICB2bS5zZWxlY3RlZF90aW1lID0gIiI7CiAgICB9KTsKICAgICQoIiNzY2hlZHVsaW5nX21vZGFsIikub24oImhpZGRlbi5icy5tb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdm0uc2NoZWR1bGluZ19jb250YWN0X251bWJlciA9ICIiOwogICAgICB2bS5zY2hfdm9pY2VfZ3JlZXRpbmdzID0gIiI7CiAgICAgIHZtLnNjaF9zbXNfZ3JlZXRpbmdzID0gIiI7CiAgICAgIHZtLmNzdl9maWxlID0gIiI7CiAgICAgIHZtLmZpbGVfbGFiZWwgPSAiQ2hvb3NlIEZpbGUiOwogICAgfSk7CiAgICB2YXIgeCwKICAgICAgICBpLAogICAgICAgIGosCiAgICAgICAgbCwKICAgICAgICBsbCwKICAgICAgICBzZWxFbG1udCwKICAgICAgICBhLAogICAgICAgIGIsCiAgICAgICAgYywKICAgICAgICB2bSA9IHRoaXM7CiAgICAvKmxvb2sgZm9yIGFueSBlbGVtZW50cyB3aXRoIHRoZSBjbGFzcyAiY3VzdG9tLXNjaGVkdWxlci1zZWxlY3QiOiovCgogICAgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImN1c3RvbS1zY2hlZHVsZXItc2VsZWN0Iik7CiAgICBsID0geC5sZW5ndGg7CgogICAgZm9yIChpID0gMDsgaSA8IGw7IGkrKykgewogICAgICBzZWxFbG1udCA9IHhbaV0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNlbGVjdCIpWzBdOwogICAgICBsbCA9IHNlbEVsbW50Lmxlbmd0aDsKICAgICAgLypmb3IgZWFjaCBlbGVtZW50LCBjcmVhdGUgYSBuZXcgRElWIHRoYXQgd2lsbCBhY3QgYXMgdGhlIHNlbGVjdGVkIGl0ZW06Ki8KCiAgICAgIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJESVYiKTsKICAgICAgYS5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgInNlbGVjdC1zZWxlY3RlZCIpOwogICAgICBhLmlubmVySFRNTCA9IHNlbEVsbW50Lm9wdGlvbnNbc2VsRWxtbnQuc2VsZWN0ZWRJbmRleF0uaW5uZXJIVE1MOwogICAgICB4W2ldLmFwcGVuZENoaWxkKGEpOwogICAgICAvKmZvciBlYWNoIGVsZW1lbnQsIGNyZWF0ZSBhIG5ldyBESVYgdGhhdCB3aWxsIGNvbnRhaW4gdGhlIG9wdGlvbiBsaXN0OiovCgogICAgICBiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiRElWIik7CiAgICAgIGIuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJzZWxlY3QtaXRlbXMgc2VsZWN0LWhpZGUiKTsKCiAgICAgIGZvciAoaiA9IDE7IGogPCBsbDsgaisrKSB7CiAgICAgICAgLypmb3IgZWFjaCBvcHRpb24gaW4gdGhlIG9yaWdpbmFsIHNlbGVjdCBlbGVtZW50LA0KICAgICAgICBjcmVhdGUgYSBuZXcgRElWIHRoYXQgd2lsbCBhY3QgYXMgYW4gb3B0aW9uIGl0ZW06Ki8KICAgICAgICBjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiRElWIik7CiAgICAgICAgYy5pbm5lckhUTUwgPSBzZWxFbG1udC5vcHRpb25zW2pdLmlubmVySFRNTDsKICAgICAgICBjLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIC8qd2hlbiBhbiBpdGVtIGlzIGNsaWNrZWQsIHVwZGF0ZSB0aGUgb3JpZ2luYWwgc2VsZWN0IGJveCwNCiAgICAgICAgICBhbmQgdGhlIHNlbGVjdGVkIGl0ZW06Ki8KICAgICAgICAgIHZhciB5LCBpLCBrLCBzLCBoLCBzbCwgeWw7CiAgICAgICAgICBzID0gdGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNlbGVjdCIpWzBdOwogICAgICAgICAgc2wgPSBzLmxlbmd0aDsKICAgICAgICAgIGggPSB0aGlzLnBhcmVudE5vZGUucHJldmlvdXNTaWJsaW5nOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzbDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChzLm9wdGlvbnNbaV0uaW5uZXJIVE1MID09IHRoaXMuaW5uZXJIVE1MKSB7CiAgICAgICAgICAgICAgcy5zZWxlY3RlZEluZGV4ID0gaTsKICAgICAgICAgICAgICBoLmlubmVySFRNTCA9IHRoaXMuaW5uZXJIVE1MOwogICAgICAgICAgICAgIHkgPSB0aGlzLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgic2FtZS1hcy1zZWxlY3RlZCIpOwogICAgICAgICAgICAgIHlsID0geS5sZW5ndGg7CgogICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCB5bDsgaysrKSB7CiAgICAgICAgICAgICAgICB5W2tdLnJlbW92ZUF0dHJpYnV0ZSgiY2xhc3MiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJzYW1lLWFzLXNlbGVjdGVkIik7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBoLmNsaWNrKCk7CiAgICAgICAgICB2bS5jdXJyZW50X2NhbGVuZGFyX3ZpZXcgPSBzZWxFbG1udC52YWx1ZTsKICAgICAgICB9KTsKICAgICAgICBiLmFwcGVuZENoaWxkKGMpOwogICAgICB9CgogICAgICB4W2ldLmFwcGVuZENoaWxkKGIpOwogICAgICBhLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAvKndoZW4gdGhlIHNlbGVjdCBib3ggaXMgY2xpY2tlZCwgY2xvc2UgYW55IG90aGVyIHNlbGVjdCBib3hlcywNCiAgICAgICAgYW5kIG9wZW4vY2xvc2UgdGhlIGN1cnJlbnQgc2VsZWN0IGJveDoqLwogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgY2xvc2VBbGxTZWxlY3QodGhpcyk7CiAgICAgICAgdGhpcy5uZXh0U2libGluZy5jbGFzc0xpc3QudG9nZ2xlKCJzZWxlY3QtaGlkZSIpOwogICAgICAgIHRoaXMuY2xhc3NMaXN0LnRvZ2dsZSgic2VsZWN0LWFycm93LWFjdGl2ZSIpOwogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbG9zZUFsbFNlbGVjdChlbG1udCkgewogICAgICAvKmEgZnVuY3Rpb24gdGhhdCB3aWxsIGNsb3NlIGFsbCBzZWxlY3QgYm94ZXMgaW4gdGhlIGRvY3VtZW50LA0KICAgICAgZXhjZXB0IHRoZSBjdXJyZW50IHNlbGVjdCBib3g6Ki8KICAgICAgdmFyIHgsCiAgICAgICAgICB5LAogICAgICAgICAgaSwKICAgICAgICAgIHhsLAogICAgICAgICAgeWwsCiAgICAgICAgICBhcnJObyA9IFtdOwogICAgICB4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgic2VsZWN0LWl0ZW1zIik7CiAgICAgIHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJzZWxlY3Qtc2VsZWN0ZWQiKTsKICAgICAgeGwgPSB4Lmxlbmd0aDsKICAgICAgeWwgPSB5Lmxlbmd0aDsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCB5bDsgaSsrKSB7CiAgICAgICAgaWYgKGVsbW50ID09IHlbaV0pIHsKICAgICAgICAgIGFyck5vLnB1c2goaSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHlbaV0uY2xhc3NMaXN0LnJlbW92ZSgic2VsZWN0LWFycm93LWFjdGl2ZSIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yIChpID0gMDsgaSA8IHhsOyBpKyspIHsKICAgICAgICBpZiAoYXJyTm8uaW5kZXhPZihpKSkgewogICAgICAgICAgeFtpXS5jbGFzc0xpc3QuYWRkKCJzZWxlY3QtaGlkZSIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyppZiB0aGUgdXNlciBjbGlja3MgYW55d2hlcmUgb3V0c2lkZSB0aGUgc2VsZWN0IGJveCwNCiAgICB0aGVuIGNsb3NlIGFsbCBzZWxlY3QgYm94ZXM6Ki8KCgogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBjbG9zZUFsbFNlbGVjdCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBvcGVuX3NjaGVkdWxpbmdfbW9kYWw6IGZ1bmN0aW9uIG9wZW5fc2NoZWR1bGluZ19tb2RhbCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgIHRoaXMuZWRpdF9zY2hlZHVsaW5nID0gZmFsc2U7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnNjaGVkdWxpbmdfc2V0dGluZ3NfdXJsKCksIHsKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgIGdldFNjaGVkdWxpbmdJbmZvOiB0cnVlCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczMuc2hvd19zcGlubmVyID0gZmFsc2U7CgogICAgICAgIGlmIChyZXNwb25zZS5kYXRhICE9IG51bGwgJiYgcmVzcG9uc2UuZGF0YS5TY2hlZHVsaW5nX2luZm8gIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBfdGhpczMuc2NoZWR1bGluZ19jb250YWN0X251bWJlciA9IHJlc3BvbnNlLmRhdGEuU2NoZWR1bGluZ19pbmZvLnBob25lX251bWJlcjsKICAgICAgICAgIF90aGlzMy5zY2hfdm9pY2VfZ3JlZXRpbmdzID0gcmVzcG9uc2UuZGF0YS5TY2hlZHVsaW5nX2luZm8udm9pY2VfdGV4dDsKICAgICAgICAgIF90aGlzMy5zY2hfc21zX2dyZWV0aW5ncyA9IHJlc3BvbnNlLmRhdGEuU2NoZWR1bGluZ19pbmZvLnNtc190ZXh0OwoKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLlNjaGVkdWxpbmdfaW5mby5ldGFfdG9fY2FsbCA9PSBudWxsKSB7CiAgICAgICAgICAgIF90aGlzMy5jYWxsX3JlbWluZGVyX21pbnMgPSAxNTsKICAgICAgICAgICAgX3RoaXMzLmNhbGxfcmVtaW5kZXJfaHJzID0gMDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzMy5jYWxsX3JlbWluZGVyX21pbnMgPSByZXNwb25zZS5kYXRhLlNjaGVkdWxpbmdfaW5mby5ldGFfdG9fY2FsbC5taW51dGVzOwogICAgICAgICAgICBfdGhpczMuY2FsbF9yZW1pbmRlcl9ocnMgPSByZXNwb25zZS5kYXRhLlNjaGVkdWxpbmdfaW5mby5ldGFfdG9fY2FsbC5ob3VyczsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczMuc2VsZWN0ZWRfdGltZV9zbG90ID0gcmVzcG9uc2UuZGF0YS5TY2hlZHVsaW5nX2luZm8udGltZV9zbG90ICE9PSBudWxsID8gcmVzcG9uc2UuZGF0YS5TY2hlZHVsaW5nX2luZm8udGltZV9zbG90IDogIiI7CgogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuU2NoZWR1bGluZ19pbmZvLkhvbGlkYXlfbGlzdF9maWxlX25hbWUgPT0gIiIgfHwgcmVzcG9uc2UuZGF0YS5TY2hlZHVsaW5nX2luZm8uSG9saWRheV9saXN0X2ZpbGVfbmFtZSA9PSBudWxsKSB7fSBlbHNlIHsvLyB0aGlzLmZpbGVfbGFiZWwgPQogICAgICAgICAgICAvLyAgIHJlc3BvbnNlLmRhdGEuU2NoZWR1bGluZ19pbmZvLkhvbGlkYXlfbGlzdF9maWxlX25hbWU7CiAgICAgICAgICB9CgogICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLlNjaGVkdWxpbmdfaW5mby53b3JraW5nX2hycykgewogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjZnJvbV8iICsgaSkudmFsdWUgPSByZXNwb25zZS5kYXRhLlNjaGVkdWxpbmdfaW5mby53b3JraW5nX2hyc1tpXS5TdGFydFRpbWU7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN0b18iICsgaSkudmFsdWUgPSByZXNwb25zZS5kYXRhLlNjaGVkdWxpbmdfaW5mby53b3JraW5nX2hyc1tpXS5FbmRUaW1lOwogICAgICAgICAgfQoKICAgICAgICAgICQoIiNzY2hlZHVsaW5nX21vZGFsIikubW9kYWwoInNob3ciKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgIF90aGlzMy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAkKCIjc2NoZWR1bGluZ19tb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0X3RpbWVfc2xvdHM6IGZ1bmN0aW9uIGdldF90aW1lX3Nsb3RzKHN0YXJ0X2RhdGUsIHR5cGUsIHNlbGVjdGVkX3RpbWUsIGlzX3Jlc2NoZWR1bGluZykgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gdHJ1ZTsKICAgICAgdGhpcy5lZGl0X3NjaGVkdWxpbmcgPSBpc19yZXNjaGVkdWxpbmcgPT09ICJpc19yZXNjaGVkdWxpbmciOwoKICAgICAgaWYgKGlzX3Jlc2NoZWR1bGluZyA9PT0gImlzX3Jlc2NoZWR1bGluZyIpIHsKICAgICAgICB0aGlzLmhpZGVfbW9kYWwoInNjaGVkdWxlX2RldGFpbHMiKTsKICAgICAgfQoKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc2NoZWR1bGVfdXJsKCksIHsKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgIERhdGU6IG1vbWVudChzdGFydF9kYXRlKS5mb3JtYXQoJ1lZWVktTU0tRCcpLAogICAgICAgIGFwcG9pbnRtZW50X2RhdGU6IG1vbWVudChzdGFydF9kYXRlKS5mb3JtYXQoJ1lZWVktTU0tREQnKQogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM0LnNob3dfc3Bpbm5lciA9IGZhbHNlOwoKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PSBudWxsKSB7fSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiUGxlYXNlIHVwZGF0ZSB5b3VyIHNjaGVkdWxlciBzZXR0aW5ncyIpIHsKICAgICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIHVwZGF0ZSB5b3VyIHNjaGVkdWxlciBzZXR0aW5ncyIpOwogICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIkludGVybmFsIFNlcnZlciBFcnJvciIpIHsKICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmZ1bGxfdGltZV9zbG90cyAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgdmFyIGR0ID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgX3RoaXM0LmZ1bGxfdGltZV9zbG90cyA9IFtdOwogICAgICAgICAgICB2YXIgZ2V0X2Z1bGxfc2xvdF9saXN0ID0gdHJ1ZTsKICAgICAgICAgICAgdmFyIHRlbXBfc3RhcnRfZGF0ZSA9IG5ldyBEYXRlKHN0YXJ0X2RhdGUpOwoKICAgICAgICAgICAgaWYgKHRlbXBfc3RhcnRfZGF0ZS5nZXRGdWxsWWVhcigpID4gZHQuZ2V0RnVsbFllYXIoKSkge30gZWxzZSBpZiAodGVtcF9zdGFydF9kYXRlLmdldEZ1bGxZZWFyKCkgPT0gZHQuZ2V0RnVsbFllYXIoKSkgewogICAgICAgICAgICAgIGlmICh0ZW1wX3N0YXJ0X2RhdGUuZ2V0TW9udGgoKSA+IGR0LmdldE1vbnRoKCkpIHt9IGVsc2UgaWYgKHRlbXBfc3RhcnRfZGF0ZS5nZXRNb250aCgpID09IGR0LmdldE1vbnRoKCkpIHsKICAgICAgICAgICAgICAgIGlmICh0ZW1wX3N0YXJ0X2RhdGUuZ2V0RGF0ZSgpID4gZHQuZ2V0RGF0ZSgpKSB7fSBlbHNlIGlmICh0ZW1wX3N0YXJ0X2RhdGUuZ2V0RGF0ZSgpID09IGR0LmdldERhdGUoKSkgewogICAgICAgICAgICAgICAgICBnZXRfZnVsbF9zbG90X2xpc3QgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gLy8gaWYgKG1vbWVudChzdGFydF9kYXRlKS5kaWZmKG1vbWVudCgpLCAiZGF5IikgPD0gMCkgewogICAgICAgICAgICAvLyAgIGdldF9mdWxsX3Nsb3RfbGlzdCA9IGZhbHNlOwogICAgICAgICAgICAvLyB9CgoKICAgICAgICAgICAgaWYgKGdldF9mdWxsX3Nsb3RfbGlzdCkgewogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YS5mdWxsX3RpbWVfc2xvdHMpIHsKICAgICAgICAgICAgICAgIF90aGlzNC5mdWxsX3RpbWVfc2xvdHMucHVzaCh7CiAgICAgICAgICAgICAgICAgIHZhbHVlOiByZXNwb25zZS5kYXRhLmZ1bGxfdGltZV9zbG90c1tpXSwKICAgICAgICAgICAgICAgICAgdGV4dDogX3RoaXM0LmdlbmVyYXRlX3RpbWUocmVzcG9uc2UuZGF0YS5mdWxsX3RpbWVfc2xvdHNbaV0uc3BsaXQoIi0iKVswXSwgcmVzcG9uc2UuZGF0YS5mdWxsX3RpbWVfc2xvdHNbaV0uc3BsaXQoIi0iKVsxXSkKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGEuZnVsbF90aW1lX3Nsb3RzKSB7CiAgICAgICAgICAgICAgICBpZiAoZHQuZ2V0SG91cnMoKSA8IE51bWJlcihyZXNwb25zZS5kYXRhLmZ1bGxfdGltZV9zbG90c1tpXS5zcGxpdCgiLSIpWzBdLnNwbGl0KCI6IilbMF0pKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNC5mdWxsX3RpbWVfc2xvdHMucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlc3BvbnNlLmRhdGEuZnVsbF90aW1lX3Nsb3RzW2ldLAogICAgICAgICAgICAgICAgICAgIHRleHQ6IF90aGlzNC5nZW5lcmF0ZV90aW1lKHJlc3BvbnNlLmRhdGEuZnVsbF90aW1lX3Nsb3RzW2ldLnNwbGl0KCItIilbMF0sIHJlc3BvbnNlLmRhdGEuZnVsbF90aW1lX3Nsb3RzW2ldLnNwbGl0KCItIilbMV0pCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gLy8gZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLmF2YWlsYWJsZV90aW1lX3Nsb3RzKSB7CiAgICAgICAgICAgICAgLy8gICB0aGlzLmZ1bGxfdGltZV9zbG90cy5wdXNoKHsKICAgICAgICAgICAgICAvLyAgICAgdmFsdWU6IHJlc3BvbnNlLmRhdGEuYXZhaWxhYmxlX3RpbWVfc2xvdHNbaV0sCiAgICAgICAgICAgICAgLy8gICAgIHRleHQ6IHRoaXMuZ2VuZXJhdGVfdGltZSgKICAgICAgICAgICAgICAvLyAgICAgICByZXNwb25zZS5kYXRhLmF2YWlsYWJsZV90aW1lX3Nsb3RzW2ldLnNwbGl0KCItIilbMF0sCiAgICAgICAgICAgICAgLy8gICAgICAgcmVzcG9uc2UuZGF0YS5hdmFpbGFibGVfdGltZV9zbG90c1tpXS5zcGxpdCgiLSIpWzFdCiAgICAgICAgICAgICAgLy8gICAgICkKICAgICAgICAgICAgICAvLyAgIH0pOwogICAgICAgICAgICAgIC8vIH0KCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChCb29sZWFuKHNlbGVjdGVkX3RpbWUpKSB7CiAgICAgICAgICAgICAgX3RoaXM0LmlzRWRpdCA9IGZhbHNlOwogICAgICAgICAgICAgIF90aGlzNC5zZWxlY3RlZF90aW1lID0gc2VsZWN0ZWRfdGltZTsKICAgICAgICAgICAgICBfdGhpczQuc2NoZWR1bGVkX3RpbWUgPSBfdGhpczQuZ2VuZXJhdGVfdGltZShzZWxlY3RlZF90aW1lLnNwbGl0KCItIilbMF0sIHNlbGVjdGVkX3RpbWUuc3BsaXQoIi0iKVsxXSk7CiAgICAgICAgICAgICAgX3RoaXM0LnRpbWVfc2xvdHMgPSBbXTsgLy8gdGhpcy50aW1lX3Nsb3RzLnB1c2goewogICAgICAgICAgICAgIC8vICAgdmFsdWU6IHNlbGVjdGVkX3RpbWUsCiAgICAgICAgICAgICAgLy8gICB0ZXh0OiB0aGlzLmdlbmVyYXRlX3RpbWUoCiAgICAgICAgICAgICAgLy8gICAgIHNlbGVjdGVkX3RpbWUuc3BsaXQoIi0iKVswXSwKICAgICAgICAgICAgICAvLyAgICAgc2VsZWN0ZWRfdGltZS5zcGxpdCgiLSIpWzFdCiAgICAgICAgICAgICAgLy8gICApCiAgICAgICAgICAgICAgLy8gfSkKCiAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBfdGhpczQuZnVsbF90aW1lX3Nsb3RzKSB7CiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5maWxsZWRfdGltZV9zbG90cy5pbmRleE9mKF90aGlzNC5mdWxsX3RpbWVfc2xvdHNbaV0udmFsdWUpID09IC0xIHx8IF90aGlzNC5zZWxlY3RlZF90aW1lID09IF90aGlzNC5mdWxsX3RpbWVfc2xvdHNbaV0udmFsdWUpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0LnRpbWVfc2xvdHMucHVzaChfdGhpczQuZnVsbF90aW1lX3Nsb3RzW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IC8vIGZvciAodmFyIGkgaW4gdGhpcy5mdWxsX3RpbWVfc2xvdHMpIHsKICAgICAgICAgICAgICAvLyAgIHRoaXMudGltZV9zbG90cy5wdXNoKHRoaXMuZnVsbF90aW1lX3Nsb3RzW2ldKTsKICAgICAgICAgICAgICAvLyB9CgogICAgICAgICAgICB9IGVsc2UgaWYgKCFCb29sZWFuKHNlbGVjdGVkX3RpbWUpKSB7CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZmlsbGVkX3RpbWVfc2xvdHMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgIF90aGlzNC50aW1lX3Nsb3RzID0gX3RoaXM0LmZ1bGxfdGltZV9zbG90czsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX3RoaXM0LnRpbWVfc2xvdHMgPSBbXTsKCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIF90aGlzNC5mdWxsX3RpbWVfc2xvdHMpIHsKICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZmlsbGVkX3RpbWVfc2xvdHMuaW5kZXhPZihfdGhpczQuZnVsbF90aW1lX3Nsb3RzW2ldLnZhbHVlKSA9PSAtMSkgewogICAgICAgICAgICAgICAgICAgIF90aGlzNC50aW1lX3Nsb3RzLnB1c2goX3RoaXM0LmZ1bGxfdGltZV9zbG90c1tpXSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gLy8gIHRoaXMudGltZV9zbG90cyA9IHJlc3BvbnNlLmRhdGEuYXZhaWxhYmxlX3RpbWVfc2xvdHM7CgogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKF90aGlzNC50aW1lX3Nsb3RzLmxlbmd0aCA9PT0gMCAmJiB0eXBlID09ICdzY2hlZHVsZV9kZXRhaWxzJykgewogICAgICAgICAgICAgIHRvYXN0ci5lcnJvcignTm8gRnJlZSBTbG90cyBmb3IgdGhpcyBEYXRlJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgJCh0eXBlKS5tb2RhbCgic2hvdyIpOwogICAgICAgICAgICAgIF90aGlzNC50ZW1wX25hbWUgPSBfdGhpczQucGF0aWVudF9uYW1lOwogICAgICAgICAgICAgIF90aGlzNC50ZW1wX3JlYXNvbiA9IF90aGlzNC52aXNpdF9yZWFzb247CiAgICAgICAgICAgICAgX3RoaXM0LnRlbXBfc3ltcHRvbXMgPSBfdGhpczQudmlzaXRvcl9zeW1wdG9tczsKICAgICAgICAgICAgICBfdGhpczQudGVtcF9hcHBvaW50bWVudF90aW1lID0gX3RoaXM0LnNlbGVjdGVkX3RpbWU7CiAgICAgICAgICAgICAgX3RoaXM0LmlzUmVzY2hlZHVsZSA9IHRydWU7CiAgICAgICAgICAgICAgdmFyIG5EYXRlID0gbmV3IERhdGUoc3RhcnRfZGF0ZS5nZXRGdWxsWWVhcigpICsgIi0iICsgKHN0YXJ0X2RhdGUuZ2V0TW9udGgoKSA8IDkgPyAiMCIgKyAoc3RhcnRfZGF0ZS5nZXRNb250aCgpICsgMSkgOiBzdGFydF9kYXRlLmdldE1vbnRoKCkgKyAxKSArICItIiArIHN0YXJ0X2RhdGUuZ2V0RGF0ZSgpKTsKICAgICAgICAgICAgICBfdGhpczQudGVtcF9kYXRhID0gbkRhdGU7CiAgICAgICAgICAgICAgX3RoaXM0LnByZXZpb3VzX3Zpc2l0X2RhdGUgPSBuRGF0ZTsKICAgICAgICAgICAgICBfdGhpczQudGVtcF9hcHBvaW50bWVudF9kYXRlID0gbW9tZW50KG5EYXRlKS5mb3JtYXQoIk1NLURELVlZWVkiKTsKICAgICAgICAgICAgICB2YXIgbWlkYXRlID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgICBfdGhpczQuZGF0ZXBpY2tlckluc3RhbmNlID0gbmV3IERhdGVQaWNrZXIoIiNkYXRlcGlja2VyIiwgewogICAgICAgICAgICAgICAgZGF0ZTogbkRhdGUsCiAgICAgICAgICAgICAgICBtaW5EYXRlOiBtaWRhdGUsCiAgICAgICAgICAgICAgICBpbnB1dDogewogICAgICAgICAgICAgICAgICBlbGVtZW50OiAiI2RhdGVwaWNrZXItaW5wdXQiLAogICAgICAgICAgICAgICAgICBmb3JtYXQ6ICJ5eXl5LU1NLWRkIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHNldFJhbmdlczogW1tuZXcgRGF0ZSgpLCBuZXcgRGF0ZSgyMDUwLCAxMiwgMTIpXV0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB2YXIgdm0gPSBfdGhpczQ7CgogICAgICAgICAgICAgIF90aGlzNC5kYXRlcGlja2VySW5zdGFuY2Uub24oImNsb3NlIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgLy92YXIgeD0gbkRhdGUKICAgICAgICAgICAgICAgIHZtLmNoZWNrZGF0ZSgpOyAvLyAkKCIjZGF0ZXBpY2tlci1pbnB1dCIpWzBdLnZhbHVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gLy8gfSwgMTAwMCk7CgogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgX3RoaXM0LnNob3dfc3Bpbm5lciA9IGZhbHNlOyAvLyBjb25zb2xlLmxvZyhlcnJvcik7CgogICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgIH0pOwogICAgfSwKICAgIHNhbXBsZV9ob2xpZGF5OiBmdW5jdGlvbiBzYW1wbGVfaG9saWRheSgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB0aGlzLnNwaW5uZXJPbiA9IHRydWU7CiAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gdHJ1ZTsKICAgICAgYXhpb3MoewogICAgICAgIG1ldGhvZDogInBvc3QiLAogICAgICAgIHVybDogYXBpX2NhbGxzLmhvbGlkYXlfZmlsZV9kb3dubG9hZCgpLAogICAgICAgIHJlc3BvbnNlVHlwZTogImJsb2IiLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfSwKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBpc0hvbGlkYXlGaWxlOiB0cnVlLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzNS5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICBfdGhpczUuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT09ICJOb3QgYWJsZSB0byBkb3dubG9hZCBmaWxlIikgewogICAgICAgICAgc3dhbC5maXJlKHsKICAgICAgICAgICAgdGl0bGU6ICJTb21lIEVycm9yIE9jY3VycmVkLiBQbGVhc2UgVHJ5IEFnYWluIiwKICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3Jlc3BvbnNlLmRhdGFdKSk7CiAgICAgICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsICJob2xpZGF5U2FtcGxlRmlsZS5jc3YiKTsKICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAgICAgICBsaW5rLmNsaWNrKCk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNS5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICBfdGhpczUuc3Bpbm5lck9uID0gZmFsc2U7CiAgICAgICAgc3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiAiU29tZSBFcnJvciBPY2N1cnJlZC4gUGxlYXNlIFRyeSBBZ2FpbiIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGltZXI6IDI1MDAKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczUuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBmaWxlaW5wdXQ6IGZ1bmN0aW9uIGZpbGVpbnB1dChlKSB7CiAgICAgIHZhciBmaWxlcyA9IGUudGFyZ2V0LmZpbGVzIHx8IGUuZGF0YVRyYW5zZmVyLmZpbGVzOwoKICAgICAgaWYgKGZpbGVzWzBdLnNpemUgPCAxMDAwMDAwKSB7CiAgICAgICAgaWYgKGZpbGVzWzBdLm5hbWUuaW5jbHVkZXMoImNzdiIpKSB7CiAgICAgICAgICB0aGlzLmZpbGVfbGFiZWwgPSBmaWxlc1swXS5uYW1lOwogICAgICAgICAgdGhpcy5jcmVhdGVDU1YoZmlsZXNbMF0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0b2FzdHIuZXJyb3IoIlVwbG9hZCBvbmx5IC5jc3YgZmlsZSB3aXRoIHNpemUgbGVzcyB0aGFuIDFNQiIpOwogICAgICB9CgogICAgICBpZiAoIWZpbGVzLmxlbmd0aCkgcmV0dXJuOwogICAgfSwKICAgIGNyZWF0ZUNTVjogZnVuY3Rpb24gY3JlYXRlQ1NWKGZpbGUsIHR5cGUpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCiAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNi5jc3ZfZmlsZSA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdCgiYmFzZTY0LCIpWzFdOwogICAgICB9OwoKICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICB9LAogICAgc2VuZF9zY2hlZHVsaW5nOiBmdW5jdGlvbiBzZW5kX3NjaGVkdWxpbmcoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdmFyIHdvcmtpbmdfaHJzID0ge307CgogICAgICBmb3IgKHZhciBpIGluIHRoaXMud2Vla19kYXlzKSB7CiAgICAgICAgd29ya2luZ19ocnNbdGhpcy53ZWVrX2RheXNbaV1dID0gewogICAgICAgICAgU3RhcnRUaW1lOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjZnJvbV8iICsgdGhpcy53ZWVrX2RheXNbaV0pLnZhbHVlLAogICAgICAgICAgRW5kVGltZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3RvXyIgKyB0aGlzLndlZWtfZGF5c1tpXSkudmFsdWUKICAgICAgICB9OwogICAgICB9IC8vIGlmICh0aGlzLnVzZXJfcm9sZSA9PSAiQWRtaW4iKSB7CgoKICAgICAgaWYgKHRoaXMuc2NoX3ZvaWNlX2dyZWV0aW5ncyAhPSAiIiAmJiB0aGlzLnNjaF9zbXNfZ3JlZXRpbmdzICE9ICIiICYmIHRoaXMuc2VsZWN0ZWRfdGltZV9zbG90ICE9ICIiICYmIHRoaXMuc2NoZWR1bGluZ19jb250YWN0X251bWJlciAhPSAiIiAmJiB0aGlzLnZhbGlkUGhvbmVOdW1iZXIgPT0gdHJ1ZSkgewogICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gdHJ1ZTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5zY2hlZHVsaW5nX3NldHRpbmdzX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBnZXRTY2hlZHVsaW5nSW5mbzogZmFsc2UsCiAgICAgICAgICBpc3VwZGF0ZTogdHJ1ZSwKICAgICAgICAgIC8vIHVwZGF0ZUNvbnRhY3Q6IHRydWUsCiAgICAgICAgICBDb250YWN0TnVtYmVyOiB0aGlzLnNjaGVkdWxpbmdfY29udGFjdF9udW1iZXIsCiAgICAgICAgICB0aW1lc2xvdDogTnVtYmVyKHRoaXMuc2VsZWN0ZWRfdGltZV9zbG90KSwKICAgICAgICAgIHdvcmtpbmdfaHJzOiB3b3JraW5nX2hycywKICAgICAgICAgIGlzdXBkYXRlSG9saWRheTogdGhpcy5jc3ZfZmlsZSAhPSAiIiA/IHRydWUgOiBmYWxzZSwKICAgICAgICAgIGhvbGlkYXlfbGlzdF9maWxlX25hbWU6IHRoaXMuZmlsZV9sYWJlbCwKICAgICAgICAgIGhvbGlkYXlfbGlzdF9maWxlX2RhdGE6IHRoaXMuY3N2X2ZpbGUgPT0gIiIgPyBudWxsIDogdGhpcy5jc3ZfZmlsZSwKICAgICAgICAgIHZvaWNldGV4dDogdGhpcy5zY2hfdm9pY2VfZ3JlZXRpbmdzLAogICAgICAgICAgc21zdGV4dDogdGhpcy5zY2hfc21zX2dyZWV0aW5ncywKICAgICAgICAgIGV0YV90b19jYWxsOiB7CiAgICAgICAgICAgIGhvdXJzOiBOdW1iZXIodGhpcy5jYWxsX3JlbWluZGVyX2hycyksCiAgICAgICAgICAgIG1pbnV0ZXM6IE51bWJlcih0aGlzLmNhbGxfcmVtaW5kZXJfbWlucykKICAgICAgICAgIH0KICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzNy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKCiAgICAgICAgICBfdGhpczcuaGlkZV9tb2RhbCgic2NoZWR1bGluZ19tb2RhbCIpOwoKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhICE9IG51bGwgJiYgcmVzcG9uc2UuZGF0YS5tc2cgPT0gIlNjaGVkdWxpbmcgaW5mbyB1cGRhdGVkIikgewogICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiWW91ciBzY2hlZHVsaW5nIGluZm9ybWF0aW9uIGhhcyBiZWVuIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5Iik7CgogICAgICAgICAgICBfdGhpczcudXBkYXRlX3NjaGVkdWxlc19saXN0KCk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubXNnID09ICJJbnZhbGlkIEhlYWRlciIpIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgeW91ciBoZWFkZXJzIGFzIHByb3ZpZGVkIGluIHRoZSBzYW1wbGUgZmlsZSBiZWxvdy4iKTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIiIpIHt9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEgPT0gbnVsbCkgewogICAgICAgICAgICAkKCIjc2NoZWR1bGluZ19tb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludGVybmFsIFNlcnZlciBFcnJvciIpOwogICAgICAgICAgICAkKCIjc2NoZWR1bGluZ19tb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMudmFsaWRQaG9uZU51bWJlciAhPSB0cnVlICYmIHRoaXMuc2NoZWR1bGluZ19jb250YWN0X251bWJlciAhPSAiIikgewogICAgICAgICAgdG9hc3RyLmVycm9yKCJNb2JpbGUgbnVtYmVyIGlzIGludmFsaWQsIHBsZWFzZSBlbnRlciBpbiBmb3JtYXQ6ICsgQ291bnRyeUNvZGUgTnVtYmVyIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIGVudGVyIGFsbCB0aGUgcmVxdWlyZWQgZmllbGRzLiIpOwogICAgICAgIH0KICAgICAgfSAvLyB9CiAgICAgIC8vIGVsc2UgaWYgKHRoaXMudXNlcl9yb2xlID09ICJTdXBlckFkbWluIikgewogICAgICAvLyAgIHRoaXMuc2hvd19zcGlubmVyID0gdHJ1ZTsKICAgICAgLy8gICBheGlvcwogICAgICAvLyAgICAgLnBvc3QoYXBpX2NhbGxzLnNjaGVkdWxpbmdfc2V0dGluZ3NfdXJsKCksIHsKICAgICAgLy8gICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnlfbmFtZSwKICAgICAgLy8gICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgIC8vICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgIC8vICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgIC8vICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAvLyAgICAgICBnZXRTY2hlZHVsaW5nSW5mbzogZmFsc2UsCiAgICAgIC8vICAgICAgIGlzdXBkYXRlOiB0cnVlLAogICAgICAvLyAgICAgICB2b2ljZXRleHQ6IHRoaXMuc2NoX3ZvaWNlX2dyZWV0aW5ncywKICAgICAgLy8gICAgICAgc21zdGV4dDogdGhpcy5zY2hfc21zX2dyZWV0aW5ncywKICAgICAgLy8gICAgICAgdXBkYXRlQ29udGFjdDogdHJ1ZSwKICAgICAgLy8gICAgICAgQ29udGFjdE51bWJlcjogdGhpcy5zY2hlZHVsaW5nX2NvbnRhY3RfbnVtYmVyLAogICAgICAvLyAgICAgICBldGFfdG9fY2FsbDogewogICAgICAvLyAgICAgICAgIGhvdXJzOiBOdW1iZXIodGhpcy5jYWxsX3JlbWluZGVyX2hycyksCiAgICAgIC8vICAgICAgICAgbWludXRlczogTnVtYmVyKHRoaXMuY2FsbF9yZW1pbmRlcl9taW5zKQogICAgICAvLyAgICAgICB9CiAgICAgIC8vICAgICB9KQogICAgICAvLyAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAvLyAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAvLyAgICAgICB0aGlzLmhpZGVfbW9kYWwoInNjaGVkdWxpbmdfbW9kYWwiKQogICAgICAvLyAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIlNjaGVkdWxpbmcgaW5mbyB1cGRhdGVkIikgewogICAgICAvLyAgICAgICAgIHRvYXN0ci5zdWNjZXNzKAogICAgICAvLyAgICAgICAgICAgIllvdXIgc2NoZWR1bGluZyBncmVldGluZ3MgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkiCiAgICAgIC8vICAgICAgICAgKTsKICAgICAgLy8gICAgICAgICB0aGlzLnVwZGF0ZV9zY2hlZHVsZXNfbGlzdCgpCiAgICAgIC8vICAgICAgIH0KICAgICAgLy8gICAgIH0pOwogICAgICAvLyB9CgogICAgfSwKICAgIGdlbmVyYXRlX3RpbWU6IGZ1bmN0aW9uIGdlbmVyYXRlX3RpbWUoc3RhcnRfdGltZSwgZW5kX3RpbWUpIHsKICAgICAgdmFyIHN0YXJ0ID0gbW9tZW50KHN0YXJ0X3RpbWUsIFsiaGg6bW0iXSkuZm9ybWF0KCJoaDptbSBBIik7CiAgICAgIHZhciBlbmQgPSBtb21lbnQoZW5kX3RpbWUsIFsiaGg6bW0iXSkuZm9ybWF0KCJoaDptbSBBIik7CiAgICAgIHJldHVybiAiIi5jb25jYXQoc3RhcnQsICItIikuY29uY2F0KGVuZCk7CiAgICB9LAogICAgbmV3X3NjaGVkdWxlOiBmdW5jdGlvbiBuZXdfc2NoZWR1bGUoc3RhcnREYXRlKSB7CiAgICAgIHZhciBzY2hlZHVsZURhdGUgPSAnJzsKCiAgICAgIGlmIChtb21lbnQoc3RhcnREYXRlLCAnWVlZWS1NTS1ERCcsIHRydWUpLmlzVmFsaWQoKSkgewogICAgICAgIHNjaGVkdWxlRGF0ZSA9IHN0YXJ0RGF0ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzY2hlZHVsZURhdGUgPSB0aGlzLmNhbGVuZGFySW5zdGFuY2UuZ2V0RGF0ZSgpOwogICAgICB9CgogICAgICB2YXIgaG9saWRheV9kYXRlID0gdGhpcy5zY2hlZHVsZV9saXN0LmZpbHRlcihmdW5jdGlvbiAoc2NoZWR1bGUpIHsKICAgICAgICByZXR1cm4gbW9tZW50KHNjaGVkdWxlLnN0YXJ0KS5mb3JtYXQoIllZWVkgTU1NTSBERCIpID09IG1vbWVudChzY2hlZHVsZURhdGUpLmZvcm1hdCgiWVlZWSBNTU1NIEREIikgJiYgc2NoZWR1bGUucmF3LmlzSG9saWRheSA9PSB0cnVlOwogICAgICB9KTsKICAgICAgdmFyIHRvZGF5X3RpbWUgPSBuZXcgRGF0ZSgpOwogICAgICB2YXIgc3RhcnRfdGltZSA9IHNjaGVkdWxlRGF0ZTsKICAgICAgdGhpcy5zZWxlY3RlZF9kYXRlID0gc3RhcnRfdGltZTsKICAgICAgc3RhcnRfdGltZS5zZXRIb3VycygwLCAwLCAwLCAwKTsKCiAgICAgIGlmICh0aGlzLmRhdGVfY29uZGl0aW9uKHRvZGF5X3RpbWUsIHN0YXJ0X3RpbWUpICYmIGhvbGlkYXlfZGF0ZS5sZW5ndGggPT0gMCAmJiBtb21lbnQoc3RhcnRfdGltZSkuZm9ybWF0KCJkZGRkIikgIT0gIlN1bmRheSIpIHsKICAgICAgICB0aGlzLmdldF90aW1lX3Nsb3RzKHNjaGVkdWxlRGF0ZSwgIiNzY2hlZHVsZV9jcmVhdGUiKTsKICAgICAgfSBlbHNlIGlmIChob2xpZGF5X2RhdGUubGVuZ3RoID4gMCkgewogICAgICAgIHRvYXN0ci5lcnJvcigiWW91IGNhbm5vdCBlbnRlciBhIHNjaGVkdWxlIGZvciB0aGlzIGRhdGUuIFxuIFJlYXNvbjogIiArIGhvbGlkYXlfZGF0ZVswXS5yYXcucmVhc29uKTsKICAgICAgfSBlbHNlIHt9CiAgICB9LAogICAgY3JlYXRlX2FwcG9pbnRtZW50OiBmdW5jdGlvbiBjcmVhdGVfYXBwb2ludG1lbnQoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIHJlZ2V4ID0gL1wrWzAtOV17OSwxNH0kLzsKICAgICAgdmFyIHggPSB0aGlzLnZpc2l0b3JfbnVtYmVyLnJlcGxhY2UoL1xzKy9nLCAnJyk7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAoIC8vIHRoaXMudmlzaXRfcmVhc29uID09ICIiIHx8CiAgICAgIC8vIHRoaXMudmlzaXRvcl9zeW1wdG9tcyA9PSAiIiB8fAogICAgICB0aGlzLnBhdGllbnRfbmFtZSA9PSAiIiB8fCB0aGlzLnZpc2l0b3JfbnVtYmVyID09ICIiIHx8IHRoaXMuc2VsZWN0ZWRfdGltZSA9PSAiIikgewogICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIGVudGVyIGFsbCB0aGUgcmVxdWlyZWQgZmllbGRzLiIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCFyZWdleC50ZXN0KHgpKSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCJNb2JpbGUgbnVtYmVyIGlzIGludmFsaWQsIHBsZWFzZSBlbnRlciBpbiBmb3JtYXQ6ICsgQ291bnRyeUNvZGUgTnVtYmVyIik7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0VkaXQpIHsKICAgICAgICB2YXIgYXBwb2ludG1lbnRfcGF5bG9hZCA9IHsKICAgICAgICAgIFZpc2l0b3JOYW1lOiB0aGlzLnBhdGllbnRfbmFtZSwKICAgICAgICAgIFZpc2l0UmVhc29uOiB0aGlzLnZpc2l0X3JlYXNvbiwKICAgICAgICAgIFN5bXB0b21zOiB0aGlzLnZpc2l0b3Jfc3ltcHRvbXMsCiAgICAgICAgICBWaXNpdFNsb3Q6IHRoaXMuc2VsZWN0ZWRfdGltZSwKICAgICAgICAgIFBob25lTnVtYmVyOiB0aGlzLnZpc2l0b3JfbnVtYmVyLAogICAgICAgICAgVmlzaXREYXRlOiB0aGlzLnNlbGVjdGVkX3NjaGVkdWxlX3Zpc2l0X3Nsb3Quc3BsaXQoIiAiKVswXQogICAgICAgIH07CiAgICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnNjaGVkdWxlX2VkaXRfZGVsZXRlX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBkYXRlOiB0aGlzLnNlbGVjdGVkX3NjaGVkdWxlX3Zpc2l0X3Nsb3Quc3BsaXQoIiAiKVswXSwKICAgICAgICAgIGlzX2VkaXQ6IHRoaXMuaXNFZGl0LAogICAgICAgICAgYXBwb2ludG1lbnRfaWQ6IHRoaXMuc2VsZWN0ZWRfc2NoZWR1bGVfaWQsCiAgICAgICAgICBhcHBvaW50bWVudF9pbmZvOiBhcHBvaW50bWVudF9wYXlsb2FkCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczguc2hvd19zcGlubmVyID0gZmFsc2U7CgogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubXNnICE9IHVuZGVmaW5lZCAmJiByZXNwb25zZS5kYXRhLm1zZyA9PSAiRWRpdCBBcHBvaW50bWVudCIpIHsKICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIllvdXIgYXBwb2ludG1lbnQgaGFzIGJlZW4gZWRpdGVkIHN1Y2Nlc3NmdWxseS4iKTsKCiAgICAgICAgICAgIF90aGlzOC5oaWRlX21vZGFsKCJzY2hlZHVsZV9jcmVhdGUiKTsKCiAgICAgICAgICAgIF90aGlzOC51cGRhdGVfc2NoZWR1bGVzX2xpc3QoKTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIkludGVybmFsIFNlcnZlciBFcnJvciIpIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKTsKCiAgICAgICAgICAgIF90aGlzOC5oaWRlX21vZGFsKCJzY2hlZHVsZV9kZXRhaWxzIik7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CgogICAgICAgICAgX3RoaXM4LmhpZGVfbW9kYWwoInNjaGVkdWxlX2RldGFpbHMiKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc2NoZWR1bGVfYXBwb2ludG1lbnRfdXJsKCksIHsKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHBob25lX251bWJlcjogdGhpcy52aXNpdG9yX251bWJlciwKICAgICAgICAgIHZpc2l0b3JfbmFtZTogdGhpcy5wYXRpZW50X25hbWUsCiAgICAgICAgICB2aXNpdF9yZWFzb246IHRoaXMudmlzaXRfcmVhc29uLAogICAgICAgICAgc3ltcHRvbXM6IHRoaXMudmlzaXRvcl9zeW1wdG9tcywKICAgICAgICAgIHZpc2l0X3Nsb3Q6IHRoaXMuc2VsZWN0ZWRfdGltZSwKICAgICAgICAgIHZpc2l0X2RhdGU6ICQoIiNkYXRlcGlja2VyLWlucHV0IilbMF0udmFsdWUKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzOC5zaG93X3NwaW5uZXIgPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tc2cgIT0gdW5kZWZpbmVkICYmIHJlc3BvbnNlLmRhdGEubXNnID09ICJBcHBvaW50bWVudCBBZGRlZCBTdWNjZXNzZnVsbHkiKSB7CiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCJZb3VyIGFwcG9pbnRtZW50IGhhcyBiZWVuIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LiIpOwoKICAgICAgICAgICAgX3RoaXM4LmhpZGVfbW9kYWwoInNjaGVkdWxlX2NyZWF0ZSIpOwoKICAgICAgICAgICAgX3RoaXM4LnVwZGF0ZV9zY2hlZHVsZXNfbGlzdCgpOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiSW50ZXJuYWwgU2VydmVyIEVycm9yIikgewogICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludGVybmFsIFNlcnZlciBFcnJvciIpOwoKICAgICAgICAgICAgX3RoaXM4LmhpZGVfbW9kYWwoInNjaGVkdWxlX2NyZWF0ZSIpOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludGVybmFsIFNlcnZlciBFcnJvciIpOwoKICAgICAgICAgIF90aGlzOC5oaWRlX21vZGFsKCJzY2hlZHVsZV9jcmVhdGUiKTsKCiAgICAgICAgICBfdGhpczguc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVfYXBwb2ludG1lbnQ6IGZ1bmN0aW9uIGRlbGV0ZV9hcHBvaW50bWVudCgpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBzd2FsLmZpcmUoewogICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgdGV4dDogIllvdSB3b24ndCBiZSBhYmxlIHRvIHJldmVydCB0aGlzISIsCiAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgZGVsZXRlISEiCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgIF90aGlzOS5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc2NoZWR1bGVfZWRpdF9kZWxldGVfdXJsKCksIHsKICAgICAgICAgICAgY29tcGFueV9uYW1lOiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgIGVtYWlsOiBfdGhpczkuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IF90aGlzOS4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICB0b2tlbjogX3RoaXM5LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBpc19kZWxldGU6IHRydWUsCiAgICAgICAgICAgIGRhdGU6IF90aGlzOS5zZWxlY3RlZF9zY2hlZHVsZV92aXNpdF9zbG90LnNwbGl0KCIgIilbMF0sCiAgICAgICAgICAgIGFwcG9pbnRtZW50X2lkOiBfdGhpczkuc2VsZWN0ZWRfc2NoZWR1bGVfaWQKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoX3RoaXM5LiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXM5LnNob3dfc3Bpbm5lciA9IGZhbHNlOwoKICAgICAgICAgICAgX3RoaXM5LmhpZGVfbW9kYWwoInNjaGVkdWxlX2RldGFpbHMiKTsKCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiRGVsZXRlZCBTdWNjZXNzZnVsbHkiKSB7CiAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIllvdXIgYXBwb2ludG1lbnQgaGFzIGJlZW4gZGVsZXRlZCBzdWNjZXNzZnVsbHkuIik7CgogICAgICAgICAgICAgIF90aGlzOS51cGRhdGVfc2NoZWR1bGVzX2xpc3QoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiSW50ZXJuYWwgU2VydmVyIEVycm9yIikgewogICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CgogICAgICAgICAgICAgIF90aGlzOS5oaWRlX21vZGFsKCJzY2hlZHVsZV9kZXRhaWxzIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CgogICAgICAgICAgICBfdGhpczkuaGlkZV9tb2RhbCgic2NoZWR1bGVfZGV0YWlscyIpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZW5kZXJfc2NoZWR1bGU6IGZ1bmN0aW9uIHJlbmRlcl9zY2hlZHVsZShkYXRhKSB7CiAgICAgIHZhciBzY2hlZHVsZSA9IFtdOwoKICAgICAgZm9yICh2YXIgaSBpbiBkYXRhKSB7CiAgICAgICAgZm9yICh2YXIgaiBpbiBkYXRhW2ldKSB7CiAgICAgICAgICBpZiAoaiA9PSAiSG9saWRheSIpIHsKICAgICAgICAgICAgc2NoZWR1bGUucHVzaCh7CiAgICAgICAgICAgICAgaWQ6IGosCiAgICAgICAgICAgICAgY2FsZW5kYXJJZDogIjEiLAogICAgICAgICAgICAgIHRpdGxlOiAiSG9saWRheSIsCiAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJ0aW1lIiwKICAgICAgICAgICAgICBkdWVEYXRlQ2xhc3M6ICIiLAogICAgICAgICAgICAgIHJhdzogewogICAgICAgICAgICAgICAgcmVhc29uOiBkYXRhW2ldW2pdLlJlYXNvbiwKICAgICAgICAgICAgICAgIGlzSG9saWRheTogdHJ1ZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgc3RhcnQ6IHRoaXMuc2V0X3RpbWVfaW50ZXJ2YWxzKGksICIwMDowMCIpLAogICAgICAgICAgICAgIGVuZDogdGhpcy5zZXRfdGltZV9pbnRlcnZhbHMoaSwgIjIzOjU5IikKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzY2hlZHVsZS5wdXNoKHsKICAgICAgICAgICAgICBpZDogaiwKICAgICAgICAgICAgICBjYWxlbmRhcklkOiAiMSIsCiAgICAgICAgICAgICAgdGl0bGU6IGRhdGFbaV1bal0uVmlzaXRvck5hbWUsCiAgICAgICAgICAgICAgLy90aXRsZTogdGhpcy5jYWxlbmRhckluc3RhbmNlLnRlbXBsYXRlKCksCiAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJ0aW1lIiwKICAgICAgICAgICAgICBkdWVEYXRlQ2xhc3M6ICIiLAogICAgICAgICAgICAgIHJhdzogewogICAgICAgICAgICAgICAgcGhvbmVfbnVtYmVyOiBkYXRhW2ldW2pdLlBob25lTnVtYmVyLAogICAgICAgICAgICAgICAgcmVhc29uOiBkYXRhW2ldW2pdLlZpc2l0UmVhc29uLAogICAgICAgICAgICAgICAgc3ltcHRvbXM6IGRhdGFbaV1bal0uU3ltcHRvbXMsCiAgICAgICAgICAgICAgICB2aXNpdF9zbG90OiBkYXRhW2ldW2pdLlZpc2l0U2xvdCwKICAgICAgICAgICAgICAgIHN0YXJ0OiBkYXRhW2ldW2pdLlZpc2l0U2xvdC5zcGxpdCgiICIpWzFdLnNwbGl0KCItIilbMF0sCiAgICAgICAgICAgICAgICBlbmQ6IGRhdGFbaV1bal0uVmlzaXRTbG90LnNwbGl0KCIgIilbMV0uc3BsaXQoIi0iKVsxXSwKICAgICAgICAgICAgICAgIGlzSG9saWRheTogZmFsc2UsCiAgICAgICAgICAgICAgICBhcHBvaW50bWVudF9zdGF0dXM6IGRhdGFbaV1bal0uQXBwb2ludG1lbnRTdGF0dXMsCiAgICAgICAgICAgICAgICB2aXNpdF9zdGF0dXM6IGRhdGFbaV1bal0uVmlzaXRTdGF0dXMsCiAgICAgICAgICAgICAgICBhcHBvaW50bWVudF9pZDogagogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgc3RhcnQ6IHRoaXMuc2V0X3RpbWVfaW50ZXJ2YWxzKGRhdGFbaV1bal0uVmlzaXRTbG90LnNwbGl0KCIgIilbMF0sIGRhdGFbaV1bal0uVmlzaXRTbG90LnNwbGl0KCIgIilbMV0uc3BsaXQoIi0iKVswXSksCiAgICAgICAgICAgICAgZW5kOiBkYXRhW2ldW2pdLlZpc2l0U2xvdC5zcGxpdCgiICIpWzFdLnNwbGl0KCItIilbMV0gPT0gIjAwOjAwIiA/IHRoaXMuc2V0X3RpbWVfaW50ZXJ2YWxzKGRhdGFbaV1bal0uVmlzaXRTbG90LnNwbGl0KCIgIilbMF0sICIyMzo1OSIpIDogdGhpcy5zZXRfdGltZV9pbnRlcnZhbHMoZGF0YVtpXVtqXS5WaXNpdFNsb3Quc3BsaXQoIiAiKVswXSwgZGF0YVtpXVtqXS5WaXNpdFNsb3Quc3BsaXQoIiAiKVsxXS5zcGxpdCgiLSIpWzFdKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuc2NoZWR1bGVfbGlzdCA9IHNjaGVkdWxlOwogICAgICB0aGlzLmNhbGVuZGFySW5zdGFuY2UuY2xlYXIoKTsKICAgICAgdGhpcy5jYWxlbmRhckluc3RhbmNlLmNyZWF0ZVNjaGVkdWxlcyhzY2hlZHVsZSk7CiAgICAgIHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5yZW5kZXIoKTsKICAgIH0sCiAgICBzZXRSZW5kZXJSYW5nZVRleHQ6IGZ1bmN0aW9uIHNldFJlbmRlclJhbmdlVGV4dCgpIHsKICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgdmFyIHJlbmRlclJhbmdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJlbmRlclJhbmdlIik7CiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5jYWxlbmRhckluc3RhbmNlLmdldE9wdGlvbnMoKTsKICAgICAgdmFyIHZpZXdOYW1lID0gdGhpcy5jYWxlbmRhckluc3RhbmNlLmdldFZpZXdOYW1lKCk7CiAgICAgIHZhciBodG1sID0gW107CgogICAgICBpZiAodmlld05hbWUgPT09ICJtb250aCIgJiYgKCFvcHRpb25zLm1vbnRoLnZpc2libGVXZWVrc0NvdW50IHx8IG9wdGlvbnMubW9udGgudmlzaWJsZVdlZWtzQ291bnQgPiA0KSB8fCB2aWV3TmFtZSA9PT0gImRheSIpIHsKICAgICAgICBodG1sLnB1c2gobW9tZW50KHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5nZXREYXRlKCkuZ2V0VGltZSgpKS5mb3JtYXQoIk1NTU0gWVlZWSIpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgc3RhcnREYXRlID0gdGhpcy5jYWxlbmRhckluc3RhbmNlLmdldERhdGVSYW5nZVN0YXJ0KCkuZ2V0VGltZSgpOwogICAgICAgIHZhciBlbmREYXRlID0gdGhpcy5jYWxlbmRhckluc3RhbmNlLmdldERhdGVSYW5nZUVuZCgpLmdldFRpbWUoKTsKCiAgICAgICAgaWYgKG1vbWVudChlbmREYXRlKS5zdWJ0cmFjdChzdGFydERhdGUsICd5ZWFyJykpIHsKICAgICAgICAgIGh0bWwucHVzaCgiIi5jb25jYXQobW9tZW50KHN0YXJ0RGF0ZSkuZm9ybWF0KCJEIE1NTU0gWVlZWSIpLCAiIHRvICIpLmNvbmNhdChtb21lbnQoZW5kRGF0ZSkuZm9ybWF0KCJEIE1NTU0gWVlZWSIpKSk7CiAgICAgICAgfSBlbHNlIGlmIChtb21lbnQoZW5kRGF0ZSkuc3VidHJhY3Qoc3RhcnREYXRlLCAnbW9udGgnKSkgewogICAgICAgICAgaHRtbC5wdXNoKCIiLmNvbmNhdChtb21lbnQoc3RhcnREYXRlKS5mb3JtYXQoIkQgTU1NTSIpLCAiIHRvICIpLmNvbmNhdChtb21lbnQoZW5kRGF0ZSkuZm9ybWF0KCJEIE1NTU0gWVlZWSIpKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGh0bWwucHVzaCgiIi5jb25jYXQobW9tZW50KHN0YXJ0RGF0ZSkuZm9ybWF0KCJEIiksICIgdG8gIikuY29uY2F0KG1vbWVudChlbmREYXRlKS5mb3JtYXQoIkQgTU1NTSBZWVlZIikpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZ2VuZXJhdGVfZGF5c19pbl9tb250aChtb21lbnQodGhpcy5jYWxlbmRhckluc3RhbmNlLmdldERhdGUoKS5nZXRUaW1lKCkpLmZvcm1hdCgnRCcpLCBtb21lbnQodGhpcy5jYWxlbmRhckluc3RhbmNlLmdldERhdGUoKS5nZXRUaW1lKCkpLmZvcm1hdCgnTU1NTScpLCBtb21lbnQodGhpcy5jYWxlbmRhckluc3RhbmNlLmdldERhdGUoKS5nZXRUaW1lKCkpLmZvcm1hdCgiWVlZWSIpKTsKICAgICAgcmVuZGVyUmFuZ2UuaW5uZXJIVE1MID0gaHRtbC5qb2luKCIiKTsKICAgICAgdGhpcy5kYWlseV9kYXRlID0gcmVuZGVyUmFuZ2UuaW5uZXJIVE1MOwogICAgfSwKICAgIGRhdGVfY29uZGl0aW9uOiBmdW5jdGlvbiBkYXRlX2NvbmRpdGlvbihmcm9tX29iamVjdCwgdG9fb2JqZWN0KSB7CiAgICAgIGlmIChmcm9tX29iamVjdCAhPT0gbnVsbCAmJiB0b19vYmplY3QgIT09IG51bGwpIHsKICAgICAgICBpZiAodG9fb2JqZWN0LmdldEZ1bGxZZWFyKCkgPiBmcm9tX29iamVjdC5nZXRGdWxsWWVhcigpKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKHRvX29iamVjdC5nZXRGdWxsWWVhcigpID09IGZyb21fb2JqZWN0LmdldEZ1bGxZZWFyKCkpIHsKICAgICAgICAgIGlmICh0b19vYmplY3QuZ2V0TW9udGgoKSA+IGZyb21fb2JqZWN0LmdldE1vbnRoKCkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9IGVsc2UgaWYgKHRvX29iamVjdC5nZXRNb250aCgpID09IGZyb21fb2JqZWN0LmdldE1vbnRoKCkpIHsKICAgICAgICAgICAgaWYgKE51bWJlcih0b19vYmplY3QuZ2V0RGF0ZSgpKSA+PSBOdW1iZXIoZnJvbV9vYmplY3QuZ2V0RGF0ZSgpKSkgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfSBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgICB9IGVsc2UgaWYgKGZyb21fb2JqZWN0ID09PSBudWxsICYmIHRvX29iamVjdCA9PT0gbnVsbCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHRvZ2dsZV92aWV3OiBmdW5jdGlvbiB0b2dnbGVfdmlldyh0eXBlKSB7CiAgICAgIGlmICh0eXBlID09ICJkYXkiKSB7CiAgICAgICAgdGhpcy5zaG93X2NoZWNrX2FuZF9jaGFuZ2Vfc3RhdHVzID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNob3dfY2hlY2tfYW5kX2NoYW5nZV9zdGF0dXMgPSBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5jYWxlbmRhckluc3RhbmNlLmNoYW5nZVZpZXcodHlwZSwgdHJ1ZSk7CiAgICAgIHRoaXMuc2V0UmVuZGVyUmFuZ2VUZXh0KCk7CiAgICB9LAogICAgc3dpdGNoX2NhbGVuZGFyOiBmdW5jdGlvbiBzd2l0Y2hfY2FsZW5kYXIodHlwZSwgZGF0ZSkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICBpZiAodHlwZSA9PSAidG9kYXkiKSB7CiAgICAgICAgdGhpcy5jdXJyZW50X2NhbGVuZGFyX3ZpZXcgPSAiZGF5IjsKICAgICAgICB0aGlzLmNhbGVuZGFySW5zdGFuY2UudG9kYXkoKTsgLy8gdGhpcy5zZXRSZW5kZXJSYW5nZVRleHQoKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNhbGVuZGFySW5zdGFuY2UuX3ZpZXdOYW1lID09ICJ3ZWVrIiB8fCB0aGlzLmNhbGVuZGFySW5zdGFuY2UuX3ZpZXdOYW1lID09ICJkYXkiKSB7CiAgICAgICAgaWYgKHR5cGUgPT0gIm5leHQiKSB7CiAgICAgICAgICB0aGlzLmNhbGVuZGFySW5zdGFuY2UubmV4dCgpOwogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAicHJldiIpIHsKICAgICAgICAgIHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5wcmV2KCk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09ICJjdXN0b20iKSB7CiAgICAgICAgICB0aGlzLmNhbGVuZGFySW5zdGFuY2Uuc2V0RGF0ZShuZXcgRGF0ZSh0aGlzLmNhbGVuZGFySW5zdGFuY2UuZ2V0RGF0ZSgpLnNldERhdGUoZGF0ZSkpKTsKICAgICAgICB9IC8vIHRoaXMuc2V0UmVuZGVyUmFuZ2VUZXh0KCk7CgogICAgICB9IGVsc2UgaWYgKHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5fdmlld05hbWUgPT0gIm1vbnRoIikgewogICAgICAgIHRoaXMuc2hvd19zcGlubmVyID0gdHJ1ZTsKCiAgICAgICAgaWYgKHR5cGUgPT0gIm5leHQiKSB7CiAgICAgICAgICB0aGlzLmNhbGVuZGFySW5zdGFuY2UubmV4dCgpOwogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAicHJldiIpIHsKICAgICAgICAgIHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5wcmV2KCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnNjaGVkdWxlX2luZm9fdXJsKCksIHsKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgIGZpcnN0X2RheTogdGhpcy5tb250aF9yYW5nZSgic3RhcnRfdGltZSIpLAogICAgICAgIGxhc3RfZGF5OiB0aGlzLm1vbnRoX3JhbmdlKCJlbmRfdGltZSIpCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczEwLnNob3dfc3Bpbm5lciA9IGZhbHNlOwoKICAgICAgICBfdGhpczEwLnJlbmRlcl9zY2hlZHVsZShyZXNwb25zZS5kYXRhLlNjaGVkdWxpbmdfaW5mbyk7CiAgICAgIH0pOwogICAgICB0aGlzLnNldFJlbmRlclJhbmdlVGV4dCgpOwogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgfSwKICAgIG1vbnRoX3JhbmdlOiBmdW5jdGlvbiBtb250aF9yYW5nZSh0eXBlKSB7CiAgICAgIHZhciB0aW1lID0gbW9tZW50KHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5nZXREYXRlKCkuZ2V0VGltZSgpKTsKICAgICAgdGltZSA9IG1vbWVudCh0aW1lKS5kYXlzSW5Nb250aCgpOwoKICAgICAgaWYgKHR5cGUgPT0gInN0YXJ0X3RpbWUiKSB7CiAgICAgICAgdmFyIHN0YXJ0X3RpbWUgPSBudWxsOwoKICAgICAgICBpZiAodGhpcy5jYWxlbmRhckluc3RhbmNlLl92aWV3TmFtZSA9PSAid2VlayIpIHsKICAgICAgICAgIHN0YXJ0X3RpbWUgPSB0aGlzLmNhbGVuZGFySW5zdGFuY2UuX3JlbmRlclJhbmdlLnN0YXJ0Ll9kYXRlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdGFydF90aW1lID0gbmV3IERhdGUodGhpcy5jYWxlbmRhckluc3RhbmNlLmdldERhdGUoKS5fZGF0ZS5nZXRGdWxsWWVhcigpLCB0aGlzLmNhbGVuZGFySW5zdGFuY2UuZ2V0RGF0ZSgpLl9kYXRlLmdldE1vbnRoKCksIDEpOwogICAgICAgIH0KCiAgICAgICAgc3RhcnRfdGltZSA9IHN0YXJ0X3RpbWUuZ2V0RnVsbFllYXIoKSArICItIiArIChzdGFydF90aW1lLmdldE1vbnRoKCkgPCA5ID8gIjAiICsgKHN0YXJ0X3RpbWUuZ2V0TW9udGgoKSArIDEpIDogc3RhcnRfdGltZS5nZXRNb250aCgpICsgMSkgKyAiLSIgKyAoc3RhcnRfdGltZS5nZXREYXRlKCkgPCAxMCA/ICIwIiArIHN0YXJ0X3RpbWUuZ2V0RGF0ZSgpIDogc3RhcnRfdGltZS5nZXREYXRlKCkpOwogICAgICAgIHJldHVybiBzdGFydF90aW1lOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gImVuZF90aW1lIikgewogICAgICAgIHZhciBlbmRfdGltZSA9IG51bGw7CgogICAgICAgIGlmICh0aGlzLmNhbGVuZGFySW5zdGFuY2UuX3ZpZXdOYW1lID09ICJ3ZWVrIikgewogICAgICAgICAgZW5kX3RpbWUgPSB0aGlzLmNhbGVuZGFySW5zdGFuY2UuX3JlbmRlclJhbmdlLmVuZC5fZGF0ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZW5kX3RpbWUgPSBuZXcgRGF0ZSh0aGlzLmNhbGVuZGFySW5zdGFuY2UuZ2V0RGF0ZSgpLl9kYXRlLmdldEZ1bGxZZWFyKCksIHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5nZXREYXRlKCkuX2RhdGUuZ2V0TW9udGgoKSwgdGltZSk7CiAgICAgICAgfQoKICAgICAgICBlbmRfdGltZSA9IGVuZF90aW1lLmdldEZ1bGxZZWFyKCkgKyAiLSIgKyAoZW5kX3RpbWUuZ2V0TW9udGgoKSA8IDkgPyAiMCIgKyAoZW5kX3RpbWUuZ2V0TW9udGgoKSArIDEpIDogZW5kX3RpbWUuZ2V0TW9udGgoKSArIDEpICsgIi0iICsgKGVuZF90aW1lLmdldERhdGUoKSA8IDEwID8gIjAiICsgZW5kX3RpbWUuZ2V0RGF0ZSgpIDogZW5kX3RpbWUuZ2V0RGF0ZSgpKTsKICAgICAgICByZXR1cm4gZW5kX3RpbWU7CiAgICAgIH0KICAgIH0sCiAgICBnZW5lcmF0ZV9kYXlzX2luX21vbnRoOiBmdW5jdGlvbiBnZW5lcmF0ZV9kYXlzX2luX21vbnRoKGRheSwgbW9udGgsIHllYXIpIHsKICAgICAgdmFyIHRvdGFsX2RheXMgPSBtb21lbnQoIiIuY29uY2F0KG1vbnRoLCAiICIpLmNvbmNhdCh5ZWFyKSwgWydNTU1NIFlZWVknXSkuZGF5c0luTW9udGgoKTsKICAgICAgdGhpcy5kYXlzSW5Nb250aCA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDEsIG4gPSB0b3RhbF9kYXlzOyBpIDw9IG47IGkrKykgewogICAgICAgIHRoaXMuZGF5c0luTW9udGgucHVzaCh7CiAgICAgICAgICBkYXk6IG1vbWVudCgiIi5jb25jYXQoaSwgIiAiKS5jb25jYXQobW9udGgsICIgIikuY29uY2F0KHllYXIpLCBbJ0QgTU1NTSBZWVlZJ10pLmZvcm1hdCgnZGQnKSwKICAgICAgICAgIGRhdGU6IGksCiAgICAgICAgICBpc19hY3RpdmU6IG1vbWVudCgiIi5jb25jYXQoZGF5LCAiICIpLmNvbmNhdChtb250aCwgIiAiKS5jb25jYXQoeWVhciksIFsnRCBNTU1NIFlZWVknXSkuaXNTYW1lKG1vbWVudCgiIi5jb25jYXQoaSwgIiAiKS5jb25jYXQobW9udGgsICIgIikuY29uY2F0KHllYXIpLCBbJ0QgTU1NTSBZWVlZJ10pLCAnZGF5JykKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHNldF90aW1lX2ludGVydmFsczogZnVuY3Rpb24gc2V0X3RpbWVfaW50ZXJ2YWxzKHllYXIsIHRpbWUpIHsKICAgICAgdmFyIHZtID0gbmV3IERhdGUoeWVhci5zcGxpdCgiLSIpWzBdLCB5ZWFyLnNwbGl0KCItIilbMV0gLSAxLCB5ZWFyLnNwbGl0KCItIilbMl0sIHRpbWUuc3BsaXQoIjoiKVswXSwgdGltZS5zcGxpdCgiOiIpWzFdKTsKICAgICAgdm0gPSBtb21lbnQodm0pLmZvcm1hdCgpOwogICAgICByZXR1cm4gdm07CiAgICB9LAogICAgb3BlbkNoZWNrQW5kQ2hhbmdlU3RhdHVzTW9kYWw6IGZ1bmN0aW9uIG9wZW5DaGVja0FuZENoYW5nZVN0YXR1c01vZGFsKEFwcG9pbnRtZW50SUQsIHNjaGVkdWxlRGF0ZSkgewogICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CgogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7IC8vIHZhciBkYXRlVG9TZW5kID0gbW9tZW50KHRoaXMuY2FsZW5kYXJJbnN0YW5jZS5nZXREYXRlKCkuZ2V0VGltZSgpKS5mb3JtYXQoCiAgICAgIC8vICAgIllZWVktTU0tREQiCiAgICAgIC8vICk7CgogICAgICB2YXIgZGF0ZVRvU2VuZCA9IG1vbWVudChzY2hlZHVsZURhdGUpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOyAvLyB2YXIgZGF0ZW9iaiA9IG5ldyBEYXRlKG1vbWVudCh0aGlzLmNhbGVuZGFySW5zdGFuY2UuZ2V0RGF0ZSgpLmdldFRpbWUoKSkuZm9ybWF0KCJNTU1NIERELCBZWVlZIikpOwoKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMudmlzaXRfc3RhdHVzX2luZm8oKSwgewogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgZGF0ZTogZGF0ZVRvU2VuZCwKICAgICAgICBpc19nZXQ6IHRydWUKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzMTEuc2hvd19zcGlubmVyID0gZmFsc2U7CgogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmRhdGEubGVuZ3RoICE9IDApIHsKICAgICAgICAgIHZhciBhcHBvaW50bWVudEZpbHRlciA9IHJlc3BvbnNlLmRhdGEuZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGFwcHQpIHsKICAgICAgICAgICAgcmV0dXJuIGFwcHRbIkFwcG9pbnRtZW50SUQiXSA9PSBBcHBvaW50bWVudElEOwogICAgICAgICAgfSk7CgogICAgICAgICAgaWYgKGFwcG9pbnRtZW50RmlsdGVyLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgICBfdGhpczExLnZpc2l0U3RhdHVzID0gYXBwb2ludG1lbnRGaWx0ZXJbMF1bIlZpc2l0U3RhdHVzIl07CiAgICAgICAgICB9CgogICAgICAgICAgX3RoaXMxMS52aXNpdF9zdGF0dXNfZGF0YSA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgIHZhciBjb25maXJtZWRfYXBwdCA9IFtdOwogICAgICAgICAgdmFyIG5vbmVfYXBwdCA9IFtdOwogICAgICAgICAgdmFyIHJlc2NoZWR1bGVfYXBwdCA9IFtdOwogICAgICAgICAgdmFyIGRlbGV0ZWRfYXBwdCA9IFtdOyAvLyB0aGlzLnZpc2l0X3N0YXR1c19jb21wYXJpc29uX2RhdGEgPSB0aGlzLnZpc2l0X3N0YXR1c19kYXRhLnNsaWNlKCk7CgogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfdGhpczExLnZpc2l0X3N0YXR1c19kYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgX3RoaXMxMS5zY2hlZHVsZV9saXN0Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgLy8gdGhpcy52aXNpdF9zdGF0dXNfZGF0YVtpXVsiQ29tcGFyZVZpc2l0U3RhdHVzIl0gPQogICAgICAgICAgICAgIC8vICAgcmVzcG9uc2UuZGF0YS5kYXRhW2ldLlZpc2l0U3RhdHVzOwogICAgICAgICAgICAgIGlmIChfdGhpczExLnZpc2l0X3N0YXR1c19kYXRhW2ldLkFwcG9pbnRtZW50SUQgPT09IF90aGlzMTEuc2NoZWR1bGVfbGlzdFtqXS5pZCkgewogICAgICAgICAgICAgICAgX3RoaXMxMS52aXNpdF9zdGF0dXNfZGF0YVtpXVsiQXBwb2ludG1lbnRTdGF0dXMiXSA9IF90aGlzMTEuc2NoZWR1bGVfbGlzdFtqXS5yYXcuYXBwb2ludG1lbnRfc3RhdHVzOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczExLnZpc2l0X3N0YXR1c19kYXRhW2ldWyJBcHBvaW50bWVudFN0YXR1cyJdID09PSAnY29uZmlybWVkJykgewogICAgICAgICAgICAgICAgICBjb25maXJtZWRfYXBwdC5wdXNoKF90aGlzMTEudmlzaXRfc3RhdHVzX2RhdGFbaV0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChfdGhpczExLnZpc2l0X3N0YXR1c19kYXRhW2ldWyJBcHBvaW50bWVudFN0YXR1cyJdID09PSAnbm9uZScpIHsKICAgICAgICAgICAgICAgICAgbm9uZV9hcHB0LnB1c2goX3RoaXMxMS52aXNpdF9zdGF0dXNfZGF0YVtpXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTEudmlzaXRfc3RhdHVzX2RhdGFbaV1bIkFwcG9pbnRtZW50U3RhdHVzIl0gPT09ICdyZXNjaGVkdWxlZCcpIHsKICAgICAgICAgICAgICAgICAgcmVzY2hlZHVsZV9hcHB0LnB1c2goX3RoaXMxMS52aXNpdF9zdGF0dXNfZGF0YVtpXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTEudmlzaXRfc3RhdHVzX2RhdGFbaV1bIkFwcG9pbnRtZW50U3RhdHVzIl0gPT09ICdkZWxldGVkJykgewogICAgICAgICAgICAgICAgICBkZWxldGVkX2FwcHQucHVzaChfdGhpczExLnZpc2l0X3N0YXR1c19kYXRhW2ldKTsKICAgICAgICAgICAgICAgIH0gLy8gIHRoaXMudmlzaXRfc3RhdHVzX2RhdGEgPSBbXTsKICAgICAgICAgICAgICAgIC8vICB0aGlzLnZpc2l0X3N0YXR1c19kYXRhICs9IG5vbmVfYXBwdDsKICAgICAgICAgICAgICAgIC8vICB0aGlzLnZpc2l0X3N0YXR1c19kYXRhICs9IGNvbmZpcm1lZF9hcHB0OwogICAgICAgICAgICAgICAgLy8gIHRoaXMudmlzaXRfc3RhdHVzX2RhdGEgKz0gcmVzY2hlZHVsZV9hcHB0OwogICAgICAgICAgICAgICAgLy8gIHRoaXMudmlzaXRfc3RhdHVzX2RhdGEgKz0gZGVsZXRlZF9hcHB0OwoKICAgICAgICAgICAgICB9IC8vIHRoaXMudmlzaXRfc3RhdHVzX2NvbXBhcmlzb25fZGF0YS5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YVtpXSk7CgoKICAgICAgICAgICAgICBfdGhpczExLnZpc2l0X3N0YXR1c19kYXRhW2ldWyJDb21wYXJlVmlzaXRTdGF0dXMiXSA9IHJlc3BvbnNlLmRhdGEuZGF0YVtpXS5WaXNpdFN0YXR1czsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzMTEudmlzaXRfc3RhdHVzX2RhdGEgPSBbXTsKICAgICAgICAgIF90aGlzMTEudmlzaXRfc3RhdHVzX2RhdGEgPSBfdGhpczExLnZpc2l0X3N0YXR1c19kYXRhLmNvbmNhdChub25lX2FwcHQsIGNvbmZpcm1lZF9hcHB0LCByZXNjaGVkdWxlX2FwcHQsIGRlbGV0ZWRfYXBwdCk7IC8vICB0aGlzLnZpc2l0X3N0YXR1c19kYXRhLmNvbmNhdCggY29uZmlybWVkX2FwcHQpOwogICAgICAgICAgLy8gIHRoaXMudmlzaXRfc3RhdHVzX2RhdGEuY29uY2F0KHJlc2NoZWR1bGVfYXBwdCk7CiAgICAgICAgICAvLyAgdGhpcy52aXNpdF9zdGF0dXNfZGF0YS5jb25jYXQoZGVsZXRlZF9hcHB0KTsKICAgICAgICAgIC8vICQoJyNwYXRpZW50ZGF0YW1vZGVsJykubW9kYWwoJ3Nob3cnKTsKICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubXNnID09PSAnTm8gQXBwb2ludG1lbnRzIFNjaGVkdWxlZCcgfHwgcmVzcG9uc2UuZGF0YS5kYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgX3RoaXMxMS52aXNpdF9zdGF0dXNfZGF0YSA9IFtdOwogICAgICAgICAgc3dhbC5maXJlKHsKICAgICAgICAgICAgdGV4dDogIk5vIEFwcG9pbnRtZW50cyBoYXZlIGJlZW4gc2NoZWR1bGVkIGZvciAiICsgIiAiICsgX3RoaXMxMS5kYWlseV9kYXRlLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIk9rYXkiCiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgX3RoaXMxMS5oaWRlX21vZGFsKCdwYXRpZW50ZGF0YW1vZGVsJyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICBfdGhpczExLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgIH0pOwogICAgfSwKICAgIGNoYW5nZVNpbmdsZVZpc2l0U3RhdHVzOiBmdW5jdGlvbiBjaGFuZ2VTaW5nbGVWaXNpdFN0YXR1cygpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgdGhpcy5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB2YXIgZGF0ZVRvU2VuZCA9ICQoIiNkYXRlcGlja2VyLWlucHV0IilbMF0udmFsdWU7CiAgICAgIHZhciBmb3JtTGVuZ3RoID0gdGhpcy52aXNpdF9zdGF0dXNfZGF0YS5sZW5ndGg7CiAgICAgIHZhciBhcnJheSA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmb3JtTGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAodGhpcy52aXNpdF9zdGF0dXNfZGF0YVtpXS5BcHBvaW50bWVudElEID09PSB0aGlzLkFwcG9pbnRtZW50SUQpIHsKICAgICAgICAgIGFycmF5LnB1c2goewogICAgICAgICAgICBBcHBvaW50bWVudElEOiB0aGlzLnZpc2l0X3N0YXR1c19kYXRhW2ldLkFwcG9pbnRtZW50SUQsCiAgICAgICAgICAgIFZpc2l0b3JOYW1lOiB0aGlzLnZpc2l0X3N0YXR1c19kYXRhW2ldLlZpc2l0b3JOYW1lLAogICAgICAgICAgICBWaXNpdFNsb3Q6IHRoaXMudmlzaXRfc3RhdHVzX2RhdGFbaV0uVmlzaXRTbG90LAogICAgICAgICAgICBBcHBvaW50bWVudFN0YXR1czogdGhpcy52aXNpdF9zdGF0dXNfZGF0YVtpXS5BcHBvaW50bWVudFN0YXR1cywKICAgICAgICAgICAgVmlzaXRTdGF0dXM6IHRoaXMudmlzaXRTdGF0dXMKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGFycmF5Lmxlbmd0aCA+IDApIHsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy52aXNpdF9zdGF0dXNfaW5mbygpLCB7CiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICByZXNwb25zZV92aXNpdF9zdGF0dXM6IGFycmF5LAogICAgICAgICAgaXNfZWRpdDogdHJ1ZSwKICAgICAgICAgIGRhdGU6IGRhdGVUb1NlbmQKICAgICAgICB9LCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzMTIuc2hvd19zcGlubmVyID0gZmFsc2U7CgogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubXNnID09ICJWaXNpdCBTdGF0dXMgRWRpdGVkIikgewogICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiVmlzaXQgU3RhdHVzIENoYW5nZWQgU3VjY2Vzc2Z1bGx5Iik7CgogICAgICAgICAgICBfdGhpczEyLmhpZGVfbW9kYWwoJ3BhdGllbnRkYXRhbW9kZWwnKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzMTIuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiU29tZSBFcnJvciBPY2N1cnJlZCIpOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgX3RoaXMxMi5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgIHRvYXN0ci5lcnJvcigiU29tZSBFcnJvciBPY2N1cnJlZCIpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY2hhbmdlVmlzaXRTdGF0dXM6IGZ1bmN0aW9uIGNoYW5nZVZpc2l0U3RhdHVzKCkgewogICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CgogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIHZhciBkYXRlVG9TZW5kID0gJCgiI2RhdGVwaWNrZXItaW5wdXQiKVswXS52YWx1ZTsKICAgICAgdmFyIGZvcm1MZW5ndGggPSB0aGlzLnZpc2l0X3N0YXR1c19kYXRhLmxlbmd0aDsKICAgICAgdmFyIGFycmF5ID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvcm1MZW5ndGg7IGkrKykgewogICAgICAgIGlmICh0aGlzLnZpc2l0X3N0YXR1c19kYXRhW2ldLkNvbXBhcmVWaXNpdFN0YXR1cyA9PT0gdGhpcy52aXNpdFN0YXR1cyAvLyB0aGlzLnZpc2l0X3N0YXR1c19kYXRhW2ldLlZpc2l0U3RhdHVzCiAgICAgICAgKSB7fSBlbHNlIHsKICAgICAgICAgIGFycmF5LnB1c2goewogICAgICAgICAgICBBcHBvaW50bWVudElEOiB0aGlzLnZpc2l0X3N0YXR1c19kYXRhW2ldLkFwcG9pbnRtZW50SUQsCiAgICAgICAgICAgIFZpc2l0b3JOYW1lOiB0aGlzLnZpc2l0X3N0YXR1c19kYXRhW2ldLlZpc2l0b3JOYW1lLAogICAgICAgICAgICBWaXNpdFNsb3Q6IHRoaXMudmlzaXRfc3RhdHVzX2RhdGFbaV0uVmlzaXRTbG90LAogICAgICAgICAgICBBcHBvaW50bWVudFN0YXR1czogdGhpcy52aXNpdF9zdGF0dXNfZGF0YVtpXS5BcHBvaW50bWVudFN0YXR1cywKICAgICAgICAgICAgVmlzaXRTdGF0dXM6IHRoaXMudmlzaXRTdGF0dXMgLy8gVmlzaXRTdGF0dXM6IHRoaXMudmlzaXRfc3RhdHVzX2RhdGFbaV0uVmlzaXRTdGF0dXMKCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChhcnJheS5sZW5ndGggPiAwKSB7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMudmlzaXRfc3RhdHVzX2luZm8oKSwgewogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgcmVzcG9uc2VfdmlzaXRfc3RhdHVzOiBhcnJheSwKICAgICAgICAgIGlzX2VkaXQ6IHRydWUsCiAgICAgICAgICBkYXRlOiBkYXRlVG9TZW5kCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczEzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwoKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiVmlzaXQgU3RhdHVzIEVkaXRlZCIpIHsKICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIlZpc2l0IFN0YXR1cyBDaGFuZ2VkIFN1Y2Nlc3NmdWxseSIpOwoKICAgICAgICAgICAgX3RoaXMxMy5oaWRlX21vZGFsKCdwYXRpZW50ZGF0YW1vZGVsJyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpczEzLnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgICB0b2FzdHIuZXJyb3IoIlNvbWUgRXJyb3IgT2NjdXJyZWQiKTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIF90aGlzMTMuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICB0b2FzdHIuZXJyb3IoIlNvbWUgRXJyb3IgT2NjdXJyZWQiKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNvbmZpcm1SZXNjaGVkdWxlOiBmdW5jdGlvbiBjb25maXJtUmVzY2hlZHVsZSgpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgICAgdmFyIGlzX2ludmFsaWQgPSBtb21lbnQodGhpcy50ZW1wX2FwcG9pbnRtZW50X2RhdGUsIFsnTU0tREQtWVlZWSddKS5kaWZmKG1vbWVudCgkKCIjZGF0ZXBpY2tlci1pbnB1dCIpWzBdLnZhbHVlLCBbJ1lZWVktTU0tREQnXSksICJkYXkiKSA9PT0gMCAmJiB0aGlzLnRlbXBfYXBwb2ludG1lbnRfdGltZSA9PSB0aGlzLnNlbGVjdGVkX3RpbWU7CgogICAgICBpZiAoaXNfaW52YWxpZCkgewogICAgICAgIHN3YWwuZmlyZSh7CiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB0ZXh0OiAiSXQgbG9va3MgbGlrZSB5b3UgaGF2ZSBub3QgbWFkZSBhbnkgY2hhbmdlIHRvIHRoZSBhcHBvaW50bWVudCBkYXRlIGFuZCBhcHBvaW50bWVudCB0aW1lIiwKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLAogICAgICAgICAgdGltZXI6IDkwMDAKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHt9KTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZmlsbGVkX3RpbWVfc2xvdHNfc2VsZWN0ZWRfZGF0ZS5pbmNsdWRlcyh0aGlzLnNlbGVjdGVkX3RpbWUpIHx8IHRoaXMuc2VsZWN0ZWRfdGltZSA9PSAiIikgewogICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIGVudGVyIGFsbCB0aGUgcmVxdWlyZWQgZmllbGRzLiIpOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgICAgdmFyIGRhdGVTZWxlY3RlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYXRlcGlja2VyLWlucHV0IikudmFsdWU7CiAgICAgICAgdmFyIHByZXZpb3VzRGF0ZSA9IG1vbWVudCh0aGlzLnRlbXBfYXBwb2ludG1lbnRfZGF0ZSwgWydNTS1ERC1ZWVlZJ10pLmZvcm1hdCgnWVlZWS1NTS1ERCcpOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnJlc2NoZWR1bGVfYXBwb2ludG1lbnQoKSwgewogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBwaG9uZV9udW1iZXI6IHRoaXMudmlzaXRvcl9udW1iZXIsCiAgICAgICAgICB2aXNpdG9yX25hbWU6IHRoaXMucGF0aWVudF9uYW1lLAogICAgICAgICAgdmlzaXRfcmVhc29uOiB0aGlzLnZpc2l0X3JlYXNvbiwKICAgICAgICAgIHZpc2l0X3Nsb3Q6IHRoaXMuc2VsZWN0ZWRfdGltZSwKICAgICAgICAgIHN5bXB0b21zOiB0aGlzLnZpc2l0b3Jfc3ltcHRvbXMsCiAgICAgICAgICB2aXNpdF9kYXRlOiBkYXRlU2VsZWN0ZWQsCiAgICAgICAgICBwcmV2aW91c192aXNpdF9kYXRlOiBwcmV2aW91c0RhdGUsCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIGFwcG9pbnRtZW50X2lkOiB0aGlzLnNlbGVjdGVkX3NjaGVkdWxlX2lkCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAvLyB0aGlzLmhpZGVfbW9kYWwoInNjaGVkdWxpbmdfbW9kYWwiKQogICAgICAgICAgX3RoaXMxNC5lZGl0X3NjaGVkdWxpbmcgPSBmYWxzZTsKCiAgICAgICAgICBfdGhpczE0LmhpZGVfbW9kYWwoInNjaGVkdWxlX2NyZWF0ZSIpOwoKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiQXBwb2ludG1lbnQgUmVzY2hlZHVsZWQgU3VjY2Vzc2Z1bGx5IikgewogICAgICAgICAgICBfdGhpczE0LnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiQXBwb2ludG1lbnQgSGFzIEJlZW4gUmVzY2hlZHVsZWQgU3VjY2Vzc2Z1bGx5Iik7CgogICAgICAgICAgICBfdGhpczE0LnVwZGF0ZV9zY2hlZHVsZXNfbGlzdCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXMxNC5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJTb21ldGhpbmcgV2VudCBXcm9uZyIpOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBfdGhpczE0LiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBfdGhpczE0LnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgdG9hc3RyLmVycm9yKCJTb21lIEVycm9yIE9jY3VycmVkIik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBrZWVwY2hlY2tpbmdkYXRlOiBmdW5jdGlvbiBrZWVwY2hlY2tpbmdkYXRlKCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB0aGlzLnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgIHRoaXMuZGF0ZXBpY2tlckluc3RhbmNlLm9uKCJjbG9zZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyB2bS5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICAgIHZtLmNoZWNrZGF0ZSgpOwogICAgICB9KTsKICAgIH0sCiAgICBjaGVja2RhdGU6IGZ1bmN0aW9uIGNoZWNrZGF0ZSgpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB2YXIgZHQgPSBuZXcgRGF0ZSgpOwoKICAgICAgaWYgKHRoaXMuZGF0ZV9jb25kaXRpb24oZHQsIG5ldyBEYXRlKCQoIiNkYXRlcGlja2VyLWlucHV0IilbMF0udmFsdWUpKSkgewogICAgICAgIHRoaXMuc2VsZWN0ZWRfZGF0ZSA9ICQoIiNkYXRlcGlja2VyLWlucHV0IilbMF0udmFsdWU7CiAgICAgICAgdmFyIHN0YXJ0X2RhdGUgPSAkKCIjZGF0ZXBpY2tlci1pbnB1dCIpWzBdLnZhbHVlOwogICAgICAgIHZhciBzZWxlY3RlZF90aW1lID0gdGhpcy5zZWxlY3RlZF90aW1lOwogICAgICAgIHZhciB0aW1lID0gZHQuZ2V0SG91cnMoKSArICI6IiArIGR0LmdldE1pbnV0ZXMoKSArICI6IiArIGR0LmdldFNlY29uZHMoKTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5zY2hlZHVsZV91cmwoKSwgewogICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBwaG9uZV9udW1iZXI6IHRoaXMudmlzaXRvcl9udW1iZXIsCiAgICAgICAgICBEYXRlOiB0aGlzLnNlbGVjdGVkX2RhdGUsCiAgICAgICAgICBhcHBvaW50bWVudF9kYXRlOiB0aGlzLnNlbGVjdGVkX2RhdGUsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczE1Lm5ld19zZWxlY3RlZF9kYXRlID0gJCgiI2RhdGVwaWNrZXItaW5wdXQiKVswXS52YWx1ZTsgLy8gICQoIiNkYXRlcGlja2VyLWlucHV0IilbMF0udmFsdWUgPSB0aGlzLnNlbGVjdGVkX2RhdGU7CgogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gbnVsbCkge30gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIlBsZWFzZSB1cGRhdGUgeW91ciBzY2hlZHVsZXIgc2V0dGluZ3MiKSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIHVwZGF0ZSB5b3VyIHNjaGVkdWxlciBzZXR0aW5ncyIpOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1zZyA9PSAiSW50ZXJuYWwgU2VydmVyIEVycm9yIikgewogICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludGVybmFsIFNlcnZlciBFcnJvciIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gaWYgKHJlc3BvbnNlLmRhdGEuRnVsbFRpbWVTbG90ICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAvLyAgIHZhciBkdCA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIC8vICAgdGhpcy5mdWxsX3RpbWVfc2xvdHMgPSBbXTsKICAgICAgICAgICAgLy8gICB0aGlzLnRpbWVfc2xvdHMgPSBbXTsKICAgICAgICAgICAgLy8gICAvLyBmb3IgKHZhciBpIGluIHRoaXMuZnVsbF90aW1lX3Nsb3RzKSB7CiAgICAgICAgICAgIC8vICAgLy8gICAgIHRoaXMuZnVsbF90aW1lX3Nsb3RzLnB1c2goewogICAgICAgICAgICAvLyAgIC8vICAgICB2YWx1ZTogcmVzcG9uc2UuZGF0YS5GdWxsVGltZVNsb3RbaV0sCiAgICAgICAgICAgIC8vICAgLy8gICAgIHRleHQ6IHRoaXMuZ2VuZXJhdGVfdGltZSgKICAgICAgICAgICAgLy8gICAvLyAgICAgICByZXNwb25zZS5kYXRhLkZ1bGxUaW1lU2xvdFtpXS5zcGxpdCgiLSIpWzBdLAogICAgICAgICAgICAvLyAgIC8vICAgICAgIHJlc3BvbnNlLmRhdGEuRnVsbFRpbWVTbG90W2ldLnNwbGl0KCItIilbMV0KICAgICAgICAgICAgLy8gICAvLyAgICAgKQogICAgICAgICAgICAvLyAgIC8vICAgICB9KTsKICAgICAgICAgICAgLy8gICAvLyAgIGlmICgKICAgICAgICAgICAgLy8gICAvLyAgICAgcmVzcG9uc2UuZGF0YS5BdmFpbGFibGVUaW1lU2xvdC5pbmRleE9mKAogICAgICAgICAgICAvLyAgIC8vICAgICAgIHRoaXMuZnVsbF90aW1lX3Nsb3RzW2ldLnZhbHVlCiAgICAgICAgICAgIC8vICAgLy8gICAgICkgPT0gLTEKICAgICAgICAgICAgLy8gICAvLyAgICkgewogICAgICAgICAgICAvLyAgIC8vICAgICB0aGlzLnRpbWVfc2xvdHMucHVzaCh0aGlzLmZ1bGxfdGltZV9zbG90c1tpXSk7CiAgICAgICAgICAgIC8vICAgLy8gICB9CiAgICAgICAgICAgIC8vICAgLy8gfQogICAgICAgICAgICAvLyAgICAgZm9yKHZhciBpIGluIHJlc3BvbnNlLmRhdGEuYXZhaWxhYmxlX3RpbWVfc2xvdHMpewogICAgICAgICAgICAvLyAgICAgICB0aGlzLmZ1bGxfdGltZV9zbG90cy5wdXNoKHsKICAgICAgICAgICAgLy8gICAgICAgICB2YWx1ZTogcmVzcG9uc2UuZGF0YS5hdmFpbGFibGVfdGltZV9zbG90c1tpXSwKICAgICAgICAgICAgLy8gICAgICAgICB0ZXh0OiB0aGlzLmdlbmVyYXRlX3RpbWUoCiAgICAgICAgICAgIC8vICAgICAgICAgcmVzcG9uc2UuZGF0YS5hdmFpbGFibGVfdGltZV9zbG90c1tpXS5zcGxpdCgiLSIpWzBdLAogICAgICAgICAgICAvLyAgICAgICAgIHJlc3BvbnNlLmRhdGEuYXZhaWxhYmxlX3RpbWVfc2xvdHNbaV0uc3BsaXQoIi0iKVsxXQogICAgICAgICAgICAvLyAgICAgICAgICkKICAgICAgICAgICAgLy8gICAgICAgfSkKICAgICAgICAgICAgLy8gICAgIH0KICAgICAgICAgICAgLy8gICAgICQoIiNkYXRlcGlja2VyLWlucHV0IilbMF0udmFsdWUgPSB0aGlzLnNlbGVjdGVkX2RhdGUKICAgICAgICAgICAgLy8gfQogICAgICAgICAgICBfdGhpczE1LmlzUmVzY2hlZHVsZXRpbWUgPSB0cnVlOwogICAgICAgICAgICBfdGhpczE1LmZ1bGxfdGltZV9zbG90cyA9IFtdOwogICAgICAgICAgICBfdGhpczE1LnRpbWVfc2xvdHMgPSBbXTsKCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmZ1bGxfdGltZV9zbG90cyAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICB2YXIgZHQgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICAgIF90aGlzMTUuZnVsbF90aW1lX3Nsb3RzID0gW107CiAgICAgICAgICAgICAgdmFyIGdldF9mdWxsX3Nsb3RfbGlzdCA9IHRydWU7CiAgICAgICAgICAgICAgdmFyIHRlbXBfc3RhcnRfZGF0ZSA9IG5ldyBEYXRlKHN0YXJ0X2RhdGUpOwoKICAgICAgICAgICAgICBpZiAodGVtcF9zdGFydF9kYXRlLmdldEZ1bGxZZWFyKCkgPiBkdC5nZXRGdWxsWWVhcigpKSB7fSBlbHNlIGlmICh0ZW1wX3N0YXJ0X2RhdGUuZ2V0RnVsbFllYXIoKSA9PSBkdC5nZXRGdWxsWWVhcigpKSB7CiAgICAgICAgICAgICAgICBpZiAodGVtcF9zdGFydF9kYXRlLmdldE1vbnRoKCkgPiBkdC5nZXRNb250aCgpKSB7fSBlbHNlIGlmICh0ZW1wX3N0YXJ0X2RhdGUuZ2V0TW9udGgoKSA9PSBkdC5nZXRNb250aCgpKSB7CiAgICAgICAgICAgICAgICAgIGlmICh0ZW1wX3N0YXJ0X2RhdGUuZ2V0RGF0ZSgpID4gZHQuZ2V0RGF0ZSgpKSB7fSBlbHNlIGlmICh0ZW1wX3N0YXJ0X2RhdGUuZ2V0RGF0ZSgpID09IGR0LmdldERhdGUoKSkgewogICAgICAgICAgICAgICAgICAgIGdldF9mdWxsX3Nsb3RfbGlzdCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoZ2V0X2Z1bGxfc2xvdF9saXN0KSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGEuZnVsbF90aW1lX3Nsb3RzKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTUuZnVsbF90aW1lX3Nsb3RzLnB1c2goewogICAgICAgICAgICAgICAgICAgIHZhbHVlOiByZXNwb25zZS5kYXRhLmZ1bGxfdGltZV9zbG90c1tpXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0OiBfdGhpczE1LmdlbmVyYXRlX3RpbWUocmVzcG9uc2UuZGF0YS5mdWxsX3RpbWVfc2xvdHNbaV0uc3BsaXQoIi0iKVswXSwgcmVzcG9uc2UuZGF0YS5mdWxsX3RpbWVfc2xvdHNbaV0uc3BsaXQoIi0iKVsxXSkKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YS5mdWxsX3RpbWVfc2xvdHMpIHsKICAgICAgICAgICAgICAgICAgaWYgKGR0LmdldEhvdXJzKCkgPCBOdW1iZXIocmVzcG9uc2UuZGF0YS5mdWxsX3RpbWVfc2xvdHNbaV0uc3BsaXQoIi0iKVswXS5zcGxpdCgiOiIpWzBdKSkgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTUuZnVsbF90aW1lX3Nsb3RzLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlc3BvbnNlLmRhdGEuZnVsbF90aW1lX3Nsb3RzW2ldLAogICAgICAgICAgICAgICAgICAgICAgdGV4dDogX3RoaXMxNS5nZW5lcmF0ZV90aW1lKHJlc3BvbnNlLmRhdGEuZnVsbF90aW1lX3Nsb3RzW2ldLnNwbGl0KCItIilbMF0sIHJlc3BvbnNlLmRhdGEuZnVsbF90aW1lX3Nsb3RzW2ldLnNwbGl0KCItIilbMV0pCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IC8vIGlmIChzZWxlY3RlZF90aW1lICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIC8vICAgdGhpcy5pc0VkaXQgPSBmYWxzZTsKICAgICAgICAgICAgICAvLyAgIHRoaXMuc2VsZWN0ZWRfdGltZSA9IHNlbGVjdGVkX3RpbWU7CiAgICAgICAgICAgICAgLy8gICB0aGlzLnNjaGVkdWxlZF90aW1lID0gdGhpcy5nZW5lcmF0ZV90aW1lKAogICAgICAgICAgICAgIC8vICAgICBzZWxlY3RlZF90aW1lLnNwbGl0KCItIilbMF0sCiAgICAgICAgICAgICAgLy8gICAgIHNlbGVjdGVkX3RpbWUuc3BsaXQoIi0iKVsxXQogICAgICAgICAgICAgIC8vICAgKTsKICAgICAgICAgICAgICAvLyB9IGVsc2UgaWYgKHNlbGVjdGVkX3RpbWUgPT0gdW5kZWZpbmVkKSB7CgoKICAgICAgICAgICAgICBfdGhpczE1LmZpbGxlZF90aW1lX3Nsb3RzX3NlbGVjdGVkX2RhdGUgPSByZXNwb25zZS5kYXRhLmZpbGxlZF90aW1lX3Nsb3RzOwoKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5maWxsZWRfdGltZV9zbG90cy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgX3RoaXMxNS50aW1lX3Nsb3RzID0gX3RoaXMxNS5mdWxsX3RpbWVfc2xvdHM7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIF90aGlzMTUudGltZV9zbG90cyA9IFtdOwoKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gX3RoaXMxNS5mdWxsX3RpbWVfc2xvdHMpIHsKICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZmlsbGVkX3RpbWVfc2xvdHMuaW5kZXhPZihfdGhpczE1LmZ1bGxfdGltZV9zbG90c1tpXS52YWx1ZSkgPT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczE1LnRpbWVfc2xvdHMucHVzaChfdGhpczE1LmZ1bGxfdGltZV9zbG90c1tpXSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gLy8gdGhpcy50aW1lX3Nsb3RzID0gcmVzcG9uc2UuZGF0YS5hdmFpbGFibGVfdGltZV9zbG90czsKCiAgICAgICAgICAgICAgfSAvL30KCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczE1LnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIFNlbGVjdCBBIFZhbGlkIERhdGUiKTsKICAgICAgICB0aGlzLmRhdGVwaWNrZXJJbnN0YW5jZS5vcGVuKCk7CiAgICAgICAgJCgiI2RhdGVwaWNrZXItaW5wdXQiKVswXS52YWx1ZSA9IHRoaXMubmV3X3NlbGVjdGVkX2RhdGU7CiAgICAgIH0KICAgIH0sCiAgICBzZW5kX3JlbWluZGVyOiBmdW5jdGlvbiBzZW5kX3JlbWluZGVyKEFwcG9pbnRtZW50SUQpIHsKICAgICAgdmFyIF90aGlzMTYgPSB0aGlzOwoKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgc3dhbC5maXJlKHsKICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgIHRleHQ6ICIgWW91IHdhbnQgdG8gU2VuZCB0aGUgUmVtaW5kZXIiLAogICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIFNlbmQhISIKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgX3RoaXMxNi5zaG93X3NwaW5uZXIgPSB0cnVlOyAvLyB2YXIgdG9kYXlzX2RhdGUgPSB0aGlzLmRhaWx5X2RhdGU7CgogICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZShfdGhpczE2LnRlbXBfYXBwb2ludG1lbnRfZGF0ZSk7CiAgICAgICAgICB2YXIgcHJldmlvdXNEYXRlID0gZC5nZXRGdWxsWWVhcigpICsgIi0iICsgKGQuZ2V0TW9udGgoKSArIDEpICsgIi0iICsgZC5nZXREYXRlKCk7CiAgICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5zZW5kX3JlbWluZGVyKCksIHsKICAgICAgICAgICAgY29tcGFueV9uYW1lOiBfdGhpczE2LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgICBjb21wYW55X2lkOiBfdGhpczE2LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgZW1haWw6IF90aGlzMTYuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IF90aGlzMTYuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgdG9rZW46IF90aGlzMTYuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIGFwcG9pbnRtZW50X2lkOiBBcHBvaW50bWVudElELAogICAgICAgICAgICBkYXRlOiBwcmV2aW91c0RhdGUsCiAgICAgICAgICAgIHZpc2l0X3Nsb3Q6IF90aGlzMTYuZGlzcGxheV9zZWxlY3RlZF90aW1lCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KF90aGlzMTYuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczE2LnNob3dfc3Bpbm5lciA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2VzcyA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIk5vdGlmaWNhdGlvbiBIYXMgYmVlbiBzZW50Iik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5zdWNjZXNzID09IGZhbHNlKSB7CiAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJDb3VsZCBOb3QgU2VuZCBOb3RpZmljYXRpb24iKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgIF90aGlzMTYuc2hvd19zcGlubmVyID0gZmFsc2U7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNvbmZpcm1BcHBvaW50bWVudDogZnVuY3Rpb24gY29uZmlybUFwcG9pbnRtZW50KCkgewogICAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CgogICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB2YXIgaXNfaW52YWxpZCA9IG1vbWVudCgpLmRpZmYobW9tZW50KCIiLmNvbmNhdCh0aGlzLnRlbXBfYXBwb2ludG1lbnRfdGltZSwgIiAiKS5jb25jYXQodGhpcy50ZW1wX2FwcG9pbnRtZW50X2RhdGUpLCBbJ0hIOm1tIE1NLURELVlZWVknXSksICJtaW51dGUiKSA+PSAwOyAvLyBpZiAoKHRoaXMudGVtcF9hcHBvaW50bWVudF9kYXRlICE9ICQoIiNkYXRlcGlja2VyLWlucHV0IilbMF0udmFsdWUpIHx8IHRoaXMudGVtcF9hcHBvaW50bWVudF90aW1lICE9IHRoaXMuc2VsZWN0ZWRfdGltZSkgewoKICAgICAgaWYgKGlzX2ludmFsaWQpIHsKICAgICAgICBzd2FsLmZpcmUoewogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgdGV4dDogIkl0IGxvb2tzIGxpa2UgeW91IGhhdmUgbWFkZSBjaGFuZ2UgdG8gdGhlIGFwcG9pbnRtZW50IGRhdGUgYW5kIGFwcG9pbnRtZW50IHRpbWUsIHNvIHBsZWFzZSByZXNjaGVkdWxlIHRoZSBhcHBvaW50bWVudCBmaXJzdCIsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgIHRpbWVyOiA1MDAwCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7fSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiAiQXJlIHlvdSBzdXJlPyIsCiAgICAgICAgICB0ZXh0OiAiIFlvdSB3YW50IHRvIENvbmZpcm0gdGhlIEFwcHBvaW50bWVudD8gVGhpcyB3aWxsIHNlbmQgYSBtZXNzYWdlIHRvIHRoZSBwYXRpZW50IiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIlllcywgQ29uZmlybSEiCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAgIGlmIChfdGhpczE3LnRlbXBfbmFtZSAhPSBfdGhpczE3LnBhdGllbnRfbmFtZSB8fCBfdGhpczE3LnRlbXBfcmVhc29uICE9IF90aGlzMTcudmlzaXRfcmVhc29uIHx8IF90aGlzMTcudGVtcF9zeW1wdG9tcyAhPSBfdGhpczE3LnZpc2l0b3Jfc3ltcHRvbXMpIHsKICAgICAgICAgICAgICAvLyBhbGVydCgiSGkiKTsKICAgICAgICAgICAgICB2YXIgYXBwb2ludG1lbnRfcGF5bG9hZCA9IHsKICAgICAgICAgICAgICAgIFZpc2l0b3JOYW1lOiBfdGhpczE3LnBhdGllbnRfbmFtZSwKICAgICAgICAgICAgICAgIFZpc2l0UmVhc29uOiBfdGhpczE3LnZpc2l0X3JlYXNvbiwKICAgICAgICAgICAgICAgIFN5bXB0b21zOiBfdGhpczE3LnZpc2l0b3Jfc3ltcHRvbXMsCiAgICAgICAgICAgICAgICBWaXNpdFNsb3Q6IF90aGlzMTcuc2VsZWN0ZWRfdGltZSwKICAgICAgICAgICAgICAgIFBob25lTnVtYmVyOiBfdGhpczE3LnZpc2l0b3JfbnVtYmVyLAogICAgICAgICAgICAgICAgVmlzaXREYXRlOiBfdGhpczE3LnNlbGVjdGVkX3NjaGVkdWxlX3Zpc2l0X3Nsb3Quc3BsaXQoIiAiKVswXQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgX3RoaXMxNy5zaG93X3NwaW5uZXIgPSB0cnVlOwogICAgICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnNjaGVkdWxlX2VkaXRfZGVsZXRlX3VybCgpLCB7CiAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IF90aGlzMTcuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgICAgICBjb21wYW55X2lkOiBfdGhpczE3LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgICAgICAgIGVtYWlsOiBfdGhpczE3LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogX3RoaXMxNy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgICAgdG9rZW46IF90aGlzMTcuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgICBkYXRlOiBfdGhpczE3LnNlbGVjdGVkX3NjaGVkdWxlX3Zpc2l0X3Nsb3Quc3BsaXQoIiAiKVswXSwKICAgICAgICAgICAgICAgIGlzX2VkaXQ6IHRydWUsCiAgICAgICAgICAgICAgICBhcHBvaW50bWVudF9pZDogX3RoaXMxNy5zZWxlY3RlZF9zY2hlZHVsZV9pZCwKICAgICAgICAgICAgICAgIGFwcG9pbnRtZW50X2luZm86IGFwcG9pbnRtZW50X3BheWxvYWQKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoX3RoaXMxNy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIF90aGlzMTcuc2hvd19zcGlubmVyID0gZmFsc2U7CgogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubXNnICE9IHVuZGVmaW5lZCAmJiByZXNwb25zZS5kYXRhLm1zZyA9PSAiRWRpdCBBcHBvaW50bWVudCIpIHsKICAgICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIllvdXIgYXBwb2ludG1lbnQgaGFzIGJlZW4gZWRpdGVkIHN1Y2Nlc3NmdWxseS4iKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIkludGVybmFsIFNlcnZlciBFcnJvciIpIHsKICAgICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKTsKICAgICAgICAgICAgICAgICAgJCgiI3NjaGVkdWxlX2RldGFpbHMiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludGVybmFsIFNlcnZlciBFcnJvciIpOwogICAgICAgICAgICAgICAgJCgiI3NjaGVkdWxlX2RldGFpbHMiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczE3LnNob3dfc3Bpbm5lciA9IHRydWU7CiAgICAgICAgICAgIHZhciBkYXRlU2VsZWN0ZWQgPSBtb21lbnQoX3RoaXMxNy50ZW1wX2FwcG9pbnRtZW50X2RhdGUsIFsnTU0tREQtWVlZWSddKS5mb3JtYXQoJ1lZWVktTU0tREQnKTsKICAgICAgICAgICAgdmFyIERhdGUxID0gX3RoaXMxNy5wcmV2aW91c192aXNpdF9kYXRlOwogICAgICAgICAgICB2YXIgcHJldmlvdXNEYXRlID0gbW9tZW50KERhdGUxKS5mb3JtYXQoJ1lZWVktTU0tREQnKTsKICAgICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuY29uZmlybV9hcHBvaW50bWVudCgpLCB7CiAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiBfdGhpczE3LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IF90aGlzMTcuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICAgIHBob25lX251bWJlcjogX3RoaXMxNy52aXNpdG9yX251bWJlciwKICAgICAgICAgICAgICB2aXNpdG9yX25hbWU6IF90aGlzMTcucGF0aWVudF9uYW1lLAogICAgICAgICAgICAgIHZpc2l0X3JlYXNvbjogX3RoaXMxNy52aXNpdF9yZWFzb24sCiAgICAgICAgICAgICAgdmlzaXRfc2xvdDogX3RoaXMxNy5zZWxlY3RlZF90aW1lLAogICAgICAgICAgICAgIHN5bXB0b21zOiBfdGhpczE3LnZpc2l0b3Jfc3ltcHRvbXMsCiAgICAgICAgICAgICAgdmlzaXRfZGF0ZTogZGF0ZVNlbGVjdGVkLAogICAgICAgICAgICAgIHRva2VuOiBfdGhpczE3LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgIGFwcG9pbnRtZW50X2lkOiBfdGhpczE3LnNlbGVjdGVkX3NjaGVkdWxlX2lkCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KF90aGlzMTcuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBfdGhpczE3LmhpZGVfbW9kYWwoInNjaGVkdWxlX2RldGFpbHMiKTsKCiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubXNnID09ICJBcHBvaW50bWVudCBDb25maXJtZWQgU3VjY2Vzc2Z1bGx5IikgewogICAgICAgICAgICAgICAgX3RoaXMxNy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCJBcHBvaW50bWVudCBoYXMgYmVlbiBDb25maXJtZWQiKTsKCiAgICAgICAgICAgICAgICBfdGhpczE3LnVwZGF0ZV9zY2hlZHVsZXNfbGlzdCgpOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIkFwcG9pbnRtZW50IENvbmZpcm1hdGlvbiBGYWlsZWQiKSB7CiAgICAgICAgICAgICAgICBfdGhpczE3LnNob3dfc3Bpbm5lciA9IGZhbHNlOwogICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIkFwcG9pbnRtZW50IENvbmZpcm1hdGlvbiBGYWlsZWQiKTsKCiAgICAgICAgICAgICAgICBfdGhpczE3LnVwZGF0ZV9zY2hlZHVsZXNfbGlzdCgpOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tc2cgPT0gIkFuIEVycm9yIE9jY3VycmVkIikgewogICAgICAgICAgICAgICAgX3RoaXMxNy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiU29tZXRoaW5nIFdlbnQgV3JvbmciKTsKCiAgICAgICAgICAgICAgICBfdGhpczE3LnVwZGF0ZV9zY2hlZHVsZXNfbGlzdCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgX3RoaXMxNy5zaG93X3NwaW5uZXIgPSBmYWxzZTsKICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludGVybmFsIFNlcnZlciBFcnJvciIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNhbmNlbF9yZXNjaGVkdWxlOiBmdW5jdGlvbiBjYW5jZWxfcmVzY2hlZHVsZSgpIHsKICAgICAgdGhpcy5pc1Jlc2NoZWR1bGUgPSAhdGhpcy5pc1Jlc2NoZWR1bGU7IC8vICAkKCIjZGF0ZXBpY2tlci1pbnB1dCIpWzBdLnZhbHVlID0gdGhpcy50ZW1wX2RhdGE7CiAgICB9LAogICAgY29udmVydF9jYXNpbmc6IGZ1bmN0aW9uIGNvbnZlcnRfY2FzaW5nKHRleHQpIHsKICAgICAgaWYgKHRleHQgPT09ICdub25lJykgewogICAgICAgIHRleHQgPSAnc2NoZWR1bGVkJzsKICAgICAgfQoKICAgICAgdGV4dCA9IHRleHQudG9TdHJpbmcoKTsKICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvXHdcUyovZywgZnVuY3Rpb24gKHR4dCkgewogICAgICAgIHJldHVybiB0eHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eHQuc3Vic3RyKDEpLnRvTG93ZXJDYXNlKCk7CiAgICAgIH0pOwogICAgICByZXR1cm4gdHh0OwogICAgfSwKICAgIGhpZGVfbW9kYWw6IGZ1bmN0aW9uIGhpZGVfbW9kYWwoaWQpIHsKICAgICAgJCgiIyIuY29uY2F0KGlkKSkubW9kYWwoJ2hpZGUnKTsKICAgIH0sCiAgICB1cGRhdGVfc2NoZWR1bGVzX2xpc3Q6IGZ1bmN0aW9uIHVwZGF0ZV9zY2hlZHVsZXNfbGlzdCgpIHsKICAgICAgdmFyIF90aGlzMTggPSB0aGlzOwoKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc2NoZWR1bGVfaW5mb191cmwoKSwgewogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgZmlyc3RfZGF5OiB0aGlzLm1vbnRoX3JhbmdlKCJzdGFydF90aW1lIiksCiAgICAgICAgbGFzdF9kYXk6IHRoaXMubW9udGhfcmFuZ2UoImVuZF90aW1lIikKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzMTgucmVuZGVyX3NjaGVkdWxlKHJlc3BvbnNlLmRhdGEuU2NoZWR1bGluZ19pbmZvKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsvLyBjb25zb2xlLmxvZyhlKTsKICAgICAgfSk7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnNjaGVkdWxpbmdfc2V0dGluZ3NfdXJsKCksIHsKICAgICAgICBnZXRUaW1lU2xvdDogdHJ1ZSwKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAvLyBnZXRTY2hlZHVsaW5nSW5mbzogdHJ1ZSwKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICBfdGhpczE4LmZ1bGxfdGltZV9zbG90cyA9IFtdOwoKICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICB2YXIgc3BsaXRfc3RyaW5ncyA9IHJlc3BvbnNlLmRhdGFbaV0uc3BsaXQoIi0iKTsKCiAgICAgICAgICAgIF90aGlzMTguZnVsbF90aW1lX3Nsb3RzLnB1c2goewogICAgICAgICAgICAgIHZhbHVlOiByZXNwb25zZS5kYXRhW2ldLAogICAgICAgICAgICAgIHRleHQ6IF90aGlzMTguZ2VuZXJhdGVfdGltZShyZXNwb25zZS5kYXRhW2ldLnNwbGl0KCItIilbMF0sIHJlc3BvbnNlLmRhdGFbaV0uc3BsaXQoIi0iKVsxXSkKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIHRvYXN0ci5lcnJvcigiSW50ZXJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},null]}