{"remainingRequest":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js!/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Settings/Miscellaneous.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/Learning/devops_ui/src/portal/Chatbot/Dashboard/Settings/Miscellaneous.vue","mtime":1661252053823},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/Learning/devops_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwppbXBvcnQgSnNvbkV4Y2VsIGZyb20gInZ1ZS1qc29uLWV4Y2VsIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IFN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgeyBzZXRUaW1lb3V0IH0gZnJvbSAidGltZXJzIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKaW1wb3J0IFZvZXJyb1RhZ3NJbnB1dCBmcm9tICJAdm9lcnJvL3Z1ZS10YWdzaW5wdXQiOwppbXBvcnQgIkB2b2Vycm8vdnVlLXRhZ3NpbnB1dC9kaXN0L3N0eWxlLmNzcyI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IEJpbGxpbmcgZnJvbSAiLi4vQWNjb3VudC9CaWxsaW5nLnZ1ZSI7CmltcG9ydCBzd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IEZlZWRiYWNrIGZyb20gIi4vRmVlZGJhY2sudnVlIjsKaW1wb3J0IE1vZGVsc1RhYiBmcm9tICIuL01vZGVsc1RhYi52dWUiOwppbXBvcnQgR2VuZXJhbFRhYiBmcm9tICIuL0dlbmVyYWxUYWIudnVlIjsKaW1wb3J0IEludGVncmF0aW9uTGF5b3V0IGZyb20gIi4uL0ludGVncmF0aW9ucy9JbnRlZ3JhdGlvbkxheW91dC52dWUiOwppbXBvcnQgeyBmcmVlemVfcG9ydGFsLCBzaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwgfSBmcm9tICJAL3BvcnRhbC9taXhpbnMiOwppbXBvcnQgVnVlUGhvbmVOdW1iZXJJbnB1dCBmcm9tICd2dWUtcGhvbmUtbnVtYmVyLWlucHV0JzsKaW1wb3J0ICd2dWUtcGhvbmUtbnVtYmVyLWlucHV0L2Rpc3QvdnVlLXBob25lLW51bWJlci1pbnB1dC5jc3MnOwppbXBvcnQgU29jaWFsTWVkaWFMaW5rcyBmcm9tICIuLi9JbnRlZ3JhdGlvbnMvU29jaWFsTWVkaWFMaW5rcy52dWUiOwppbXBvcnQgeyBidXMgfSBmcm9tICJAL3BvcnRhbC9tYWluIjsKVnVlLmNvbXBvbmVudCgiZG93bmxvYWRFeGNlbCIsIEpzb25FeGNlbCk7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTWlzY2VsbGFuZW91c1BhZ2UiLAogIG1peGluczogW2ZyZWV6ZV9wb3J0YWwsIHNob3dfc3Vic2NyaXB0aW9uX2V4cGlyZWRfc3dhbF0sCiAgY29tcG9uZW50czogewogICAgTXVsdGlzZWxlY3Q6IE11bHRpc2VsZWN0LAogICAgInRhZ3MtaW5wdXQiOiBWb2Vycm9UYWdzSW5wdXQsCiAgICBCaWxsaW5nOiBCaWxsaW5nLAogICAgRmVlZGJhY2s6IEZlZWRiYWNrLAogICAgSW50ZWdyYXRpb25MYXlvdXQ6IEludGVncmF0aW9uTGF5b3V0LAogICAgVnVlUGhvbmVOdW1iZXJJbnB1dDogVnVlUGhvbmVOdW1iZXJJbnB1dCwKICAgIFNvY2lhbE1lZGlhTGlua3M6IFNvY2lhbE1lZGlhTGlua3MsCiAgICBHZW5lcmFsVGFiOiBHZW5lcmFsVGFiLAogICAgTW9kZWxzVGFiOiBNb2RlbHNUYWIKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB2aWV3X2NvbXBvbmVudF9uYW1lOiAib3RoZXJzIiwKICAgICAgLy8gc3RhcnRfZ3JlZXRpbmdzOiAiIiwKICAgICAgLy8gZW5kX2dyZWV0aW5nczogIiIsCiAgICAgIHRpdGxlOiAiIiwKICAgICAgaW1hZ2VfZmlsZTogbnVsbCwKICAgICAgZmlsZV9sYWJlbDogIkNob29zZSBmaWxlIiwKICAgICAgc2VuZGVyOiBudWxsLAogICAgICBzdWJqZWN0OiBudWxsLAogICAgICBlbWFpbF9ib2R5OiBudWxsLAogICAgICBjb21wYW55aWQ6IG51bGwsCiAgICAgIGNvbXBhbnluYW1lOiBudWxsLAogICAgICBtdWx0aXBsZV9sYW5ndWFnZV9saXN0OiBbXSwKICAgICAgcGhvbmVOdW1iZXI6IG51bGwsCiAgICAgIGNvbnRhY3RfdXNfcGhvbmVfbnVtYmVyOiBudWxsLAogICAgICBjb250YWN0X3VzX2VtYWlsOiAiIiwKICAgICAgZW1haWxfdmFsaWRpdHk6IC9eKFswLTlhLXpBLVpdKFstLlx3XSpbMC05YS16QS1aXSkqQChbMC05YS16QS1aXVstXHddKlswLTlhLXpBLVpdXC4pK1thLXpBLVpdezIsOX0pJC8sCiAgICAgIGlzX3JldGFpbDogZmFsc2UsCiAgICAgIG9sZF9pbWFnZV9uYW1lOiBudWxsLAogICAgICBzcGlubmVyT24xOiBmYWxzZSwKICAgICAgc3Bpbm5lck9uMjogZmFsc2UsCiAgICAgIGJpZ19zcGlubmVyOiBmYWxzZSwKICAgICAgdHJhaW5lZF9kaWFsb2d1ZV9tb2RlbHM6IG51bGwsCiAgICAgIHRyYWluZWRfaW50ZW50X21vZGVsczogbnVsbCwKICAgICAgY3VycmVudF9saWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICB0cmFpbmVkX25lcl9tb2RlbHM6IG51bGwsCiAgICAgIGRpc2FibGVfYnRuX2V4cGlyZWQ6IGZhbHNlLAogICAgICByZXRhaWxfd2ViX2ZyYW1ld29yazogdGhpcy4kc2Vzc2lvbi5nZXQoInJldGFpbF93ZWJfZnJhbWV3b3JrIiksCiAgICAgIGVtYWlsX2RldGFpbHM6IG51bGwsCiAgICAgIGVtYWlsX2Rpc2FibGU6IGZhbHNlLAogICAgICB2ZXJpZmljYXRpb25fc3RhdHVzOiBudWxsLAogICAgICByZXNldF9pY29uX3BhdGg6IHJlcXVpcmUoIkAvcG9ydGFsL2Fzc2V0cy9pbWcvcmVzZXRfaWNvbi5zdmciKSwKICAgICAgZGlzYWJsZV9zaWRlYmFyOiBmYWxzZQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUgPT0gIlN1cGVyQWRtaW4iKSB7CiAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlJZCIpOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNvbXBhbnlpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkOwogICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgIH0gLy8gYXhpb3MKICAgIC8vICAgLnBvc3QoCiAgICAvLyAgICAgYXBpX2NhbGxzLnR3aWxpb19ncmVldGluZ3MoKSwKICAgIC8vICAgICB7CiAgICAvLyAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAvLyAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgIC8vICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgLy8gICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAvLyAgICAgICBpc1Nob3c6IHRydWUKICAgIC8vICAgICB9LAogICAgLy8gICAgIHsKICAgIC8vICAgICAgIGhlYWRlcnM6IHsKICAgIC8vICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAKICAgIC8vICAgICAgIH0KICAgIC8vICAgICB9CiAgICAvLyAgICkKICAgIC8vICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgLy8gICAgIHRoaXMuc3RhcnRfZ3JlZXRpbmdzID0gcmVzcG9uc2UuZGF0YS5ncmVldGluZzsKICAgIC8vICAgICB0aGlzLmVuZF9ncmVldGluZ3MgPSByZXNwb25zZS5kYXRhLmJ1c3k7CiAgICAvLyAgIH0pCiAgICAvLyAgIC5jYXRjaChlID0+IHsKICAgIC8vICAgICBpZiAoCiAgICAvLyAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAvLyAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAvLyAgICAgKSB7CiAgICAvLyAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgIH0KICAgIC8vICAgfSk7CgogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdGhpcy4kc2Vzc2lvbi5zZXQoIkN1cnJlbnRBY3RpdmVUYWJGb3JIZWxwIiwgdGhpcy52aWV3X2NvbXBvbmVudF9uYW1lKTsKCiAgICBpZiAodGhpcy4kc2Vzc2lvbi5nZXQoIlNldHRpbmdUb3BuYXZiYXJEaXNhYmxlIikgPT0gdHJ1ZSkgewogICAgICB0aGlzLmRpc2FibGVfc2lkZWJhciA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRpc2FibGVfc2lkZWJhciA9IGZhbHNlOwogICAgfSAvL2NvbnNvbGUubG9nKHRoaXMudmlld19jb21wb25lbnRfbmFtZSwiY29tcCBuYW1lIik7CgoKICAgIGJ1cy4kb24oIkN1cnJlbnRBY3RpdmVUYWIiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICBpZiAoZGF0YSA9PT0gX3RoaXMuJHJvdXRlLmZ1bGxQYXRoKSB7CiAgICAgICAgLy9jb25zb2xlLmxvZygiSGVsbG8iLHRoaXMuJHJvdXRlKTsKICAgICAgICByZXR1cm4gX3RoaXMudmlld19jb21wb25lbnRfbmFtZTsgLy8gYnVzLiRlbWl0KCJDdXJycmVudEFjdGl2ZVRhYlJlc3BvbnNlIiwgdGhpcy52aWV3X2NvbXBvbmVudF9uYW1lKQogICAgICB9CiAgICB9KTsgLy8gaWYodGhpcy5pc19yZXRhaWwgIT0gdHJ1ZSl7CiAgICAvLyAgIHRoaXMubG9hZF9wcm9kdWN0X3NldHRpbmdzKCk7CiAgICAvLyB9CgogICAgdmFyIGJvdF90ZW1wbGF0ZXNfZGF0YSA9IHRoaXMuJHNlc3Npb24uZ2V0KCJCb3RUZW1wbGF0ZXMiKTsKCiAgICBpZiAoYm90X3RlbXBsYXRlc19kYXRhICE9IHVuZGVmaW5lZCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvdF90ZW1wbGF0ZXNfZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChib3RfdGVtcGxhdGVzX2RhdGFbaV0uZG9tYWluID09PSAiUmV0YWlsIiAmJiBib3RfdGVtcGxhdGVzX2RhdGFbaV0uc3Vic2NyaWJlZCA9PT0gdHJ1ZSkgewogICAgICAgICAgdGhpcy5pc19yZXRhaWwgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5mcmVlemVfcG9ydGFsKCk7CiAgICB9LCAxMDAwKTsKICAgIHRoaXMuJHJvb3QuJG9uKCJNaXNjZWxsYW5lb3VzUGFnZURpc2FibGVkIiwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgaWYgKGRhdGEgPT09IHRydWUpIHsKICAgICAgICBfdGhpcy5kaXNhYmxlX2J0bl9leHBpcmVkID0gdHJ1ZTsKICAgICAgfQogICAgfSk7CiAgICB0aGlzLiRyb290LiRvbigiYWNjb3VudFBhZ2UiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICBpZiAoZGF0YSA9PT0gdHJ1ZSkgewogICAgICAgICQoIiNhY2NvdW50cy10YWIiKS5jbGljaygpOwogICAgICAgIF90aGlzLnZpZXdfY29tcG9uZW50X25hbWUgPSAiYWNjb3VudHMiOwogICAgICB9CiAgICB9KTsgLy8gdGhpcy5pbml0aWFsaXplX3Rvb2x0aXBzKCk7CgogICAgdmFyIHZtID0gdGhpczsgLy8gdGhpcy5nZXRfdHJhaW5lZF9kaWFsb2d1ZV9tb2RlbHMoKTsKICAgIC8vIHRoaXMuZ2V0X3RyYWluZWRfaW50ZW50X21vZGVscygpOwogICAgLy8gdGhpcy5nZXRfdHJhaW5lZF9uZXJfbW9kZWxzKCk7CiAgICAvLyB0aGlzLmdldF9jb21wYW55X2xvZ28oKTsKCiAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLlN1YnNjcmlwdGlvbiA9PT0gdHJ1ZSkgewogICAgICAkKCIjYWNjb3VudHMtdGFiIikuY2xpY2soKTsKICAgICAgdGhpcy52aWV3X2NvbXBvbmVudF9uYW1lID0gImFjY291bnRzIjsKICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiY2hhbmdlX3NpZGViYXJfbWFpbl9tZW51IiwgIlNldHRpbmdzIik7CiAgICB9CgogICAgdGhpcy5yZXRhaWxfd2ViX2ZyYW1ld29yayA9IHRoaXMuJHNlc3Npb24uZ2V0KCJyZXRhaWxfd2ViX2ZyYW1ld29yayIpOwoKICAgIGlmICh0aGlzLiRyb3V0ZS5xdWVyeS5TdWJzY3JpcHRpb24gPT0gInRydWUiKSB7CiAgICAgICQoIiNhY2NvdW50cy10YWIiKS5jbGljaygpOwogICAgICB0aGlzLnZpZXdfY29tcG9uZW50X25hbWUgPSAiYWNjb3VudHMiOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsvLyAgIHZhbGlkRW1haWwoKSB7CiAgICAvLyAgICAgaWYgKHRoaXMuY29udGFjdF91c19lbWFpbCAhPSBudWxsKSB7CiAgICAvLyAgICAgICBpZiAodGhpcy5lbWFpbF92YWxpZGl0eS50ZXN0KHRoaXMuY29udGFjdF91c19lbWFpbCkpIHsKICAgIC8vICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAvLyAgICAgICB9IGVsc2UgewogICAgLy8gICAgICAgICByZXR1cm4gdGhpcy50bHQoJ290aGVyX2VudGVyX3ZhbGlkX2VtYWlsX21zZycpOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0KICAgIC8vIH0KICB9LAogIHdhdGNoOiB7CiAgICB2aWV3X2NvbXBvbmVudF9uYW1lOiBmdW5jdGlvbiB2aWV3X2NvbXBvbmVudF9uYW1lKG5ld1ZhbCkgewogICAgICB0aGlzLiRzZXNzaW9uLnNldCgiQ3VycmVudEFjdGl2ZVRhYkZvckhlbHAiLCBuZXdWYWwpOwogICAgfSwKICAgIGJvdF9iYWNrZ3JvdW5kX3R5cGU6IGZ1bmN0aW9uIGJvdF9iYWNrZ3JvdW5kX3R5cGUobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgaWYgKG5ld1ZhbCA9PT0gIm5vbmUiKSB7CiAgICAgICAgdGhpcy5maWxlX2xhYmVsXzMgPSAiQ2hvb3NlIEZpbGUiOwogICAgICAgIHRoaXMuaW1hZ2VfZmlsZV8zID0gbnVsbDsKICAgICAgICB0aGlzLmlzX2JnX2ltYWdlX2NoYW5nZWQgPSB0cnVlOyAvLyB0aGlzLm9sZF9pbWFnZV9uYW1lXzMgPSBudWxsOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5wdXRHcm91cEZpbGUwMyIpLnZhbHVlID0gIiI7CiAgICAgIH0KICAgIH0gLy8gZW1haWxfZGV0YWlscygpIHsKICAgIC8vICAgaWYgKHRoaXMuZW1haWxfZGV0YWlscyA9PSBudWxsIHx8IHRoaXMuZW1haWxfZGV0YWlscyA9PSAiIikgewogICAgLy8gICAgIHRoaXMuZW1haWxfZGlzYWJsZSA9IGZhbHNlOwogICAgLy8gICB9CiAgICAvLyB9CgogIH0sCiAgbWV0aG9kczogewogICAgZ2VuZXJhdGVVVUlEOiBmdW5jdGlvbiBnZW5lcmF0ZVVVSUQoKSB7CiAgICAgIC8vIFB1YmxpYyBEb21haW4vTUlUCiAgICAgIHZhciBkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7IC8vVGltZXN0YW1wCgogICAgICB2YXIgZDIgPSBwZXJmb3JtYW5jZSAmJiBwZXJmb3JtYW5jZS5ub3cgJiYgcGVyZm9ybWFuY2Uubm93KCkgKiAxMDAwIHx8IDA7IC8vVGltZSBpbiBtaWNyb3NlY29uZHMgc2luY2UgcGFnZS1sb2FkIG9yIDAgaWYgdW5zdXBwb3J0ZWQKCiAgICAgIHJldHVybiAieHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Ii5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7CiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpICogMTY7IC8vcmFuZG9tIG51bWJlciBiZXR3ZWVuIDAgYW5kIDE2CgogICAgICAgIGlmIChkID4gMCkgewogICAgICAgICAgLy9Vc2UgdGltZXN0YW1wIHVudGlsIGRlcGxldGVkCiAgICAgICAgICByID0gKGQgKyByKSAlIDE2IHwgMDsKICAgICAgICAgIGQgPSBNYXRoLmZsb29yKGQgLyAxNik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vVXNlIG1pY3Jvc2Vjb25kcyBzaW5jZSBwYWdlLWxvYWQgaWYgc3VwcG9ydGVkCiAgICAgICAgICByID0gKGQyICsgcikgJSAxNiB8IDA7CiAgICAgICAgICBkMiA9IE1hdGguZmxvb3IoZDIgLyAxNik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKGMgPT09ICJ4IiA/IHIgOiByICYgMHgzIHwgMHg4KS50b1N0cmluZygxNik7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIHRyaW1fbW9kZWxfbmFtZSh2YWwxKSB7CiAgICAvLyAgIGlmICh2YWwxLmxlbmd0aCA+IDYpIHsKICAgIC8vICAgICBsZXQgc3RyMSA9IHZhbDEuc3Vic3RyaW5nKDAsIDMpICsgIi4uLiI7CiAgICAvLyAgICAgcmV0dXJuIHN0cjE7CiAgICAvLyAgIH0KICAgIC8vICAgcmV0dXJuIHZhbDE7CiAgICAvLyB9LAogICAgLy8gbG9hZF9wcm9kdWN0X3NldHRpbmdzKCkgewogICAgLy8gICB0aGlzLmJpZ19zcGlubmVyID0gdHJ1ZTsKICAgIC8vICAgYXhpb3MKICAgIC8vICAgICAucG9zdCgKICAgIC8vICAgICAgIGFwaV9jYWxscy5wcm9kdWN0X3NldHRpbmdzKCksCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgIC8vICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAvLyAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAvLyAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgLy8gICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAvLyAgICAgICB9LAogICAgLy8gICAgICAgewogICAgLy8gICAgICAgICBoZWFkZXJzOiB7CiAgICAvLyAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAvLyAgICAgICAgIH0sCiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgKQogICAgLy8gICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgLy8gICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuREFUQV9BVkFJTEFCTEUuTVNHX0NPREUpewogICAgLy8gICAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7IAogICAgLy8gICAgICAgICB2YXIgd2ViZnJhbWV3b3JrID0gdGhpcy5yZXRhaWxfd2ViX2ZyYW1ld29yazsKICAgIC8vICAgICAgICAgaWYgKHdlYmZyYW1ld29yayA9PT0gbnVsbCB8fCB3ZWJmcmFtZXdvcmsgPT09IHVuZGVmaW5lZCApewogICAgLy8gICAgICAgICAgIHdlYmZyYW1ld29yayA9IHVuZGVmaW5lZDsKICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgICBpZiAoCiAgICAvLyAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFICE9IHRoaXMuYXBpX3N0YXR1c19jb2RlLklOVEVSTkFMX1NFUlZFUl9FUlJPUi5NU0dfQ09ERSAmJgogICAgLy8gICAgICAgICAgIHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSAhPSB0aGlzLmFwaV9zdGF0dXNfY29kZS5FTVBUWV9EQVRBLk1TR19DT0RFCiAgICAvLyAgICAgICAgICkgewogICAgLy8gICAgICAgICAgIHRoaXMuY29udGFjdF91c19lbWFpbCA9IHdlYmZyYW1ld29yayA9PT0gdW5kZWZpbmVkID8gcmVzcG9uc2UuZGF0YS5kYXRhLmRldGFpbHMuY29udGFjdF9oZWxwX2VtYWlsIDogcmVzcG9uc2UuZGF0YS5kYXRhW3dlYmZyYW1ld29yayArICdfZGV0YWlscyddLmNvbnRhY3RfaGVscF9lbWFpbDsKICAgIC8vICAgICAgICAgICB0aGlzLmNvbnRhY3RfdXNfcGhvbmVfbnVtYmVyID0gd2ViZnJhbWV3b3JrID09PSB1bmRlZmluZWQgID8gcmVzcG9uc2UuZGF0YS5kYXRhLmRldGFpbHMuY29udGFjdF91c19waG9uZV9udW1iZXI6IHJlc3BvbnNlLmRhdGEuZGF0YVt3ZWJmcmFtZXdvcmsgKyAnX2RldGFpbHMnXS5jb250YWN0X3VzX3Bob25lX251bWJlcjsKICAgIC8vICAgICAgICAgICB0aGlzLmVtYWlsX2RldGFpbHMgPSB3ZWJmcmFtZXdvcmsgPT09IHVuZGVmaW5lZCA/IHJlc3BvbnNlLmRhdGEuZGF0YS5kZXRhaWxzLnNlbmRlcl9lbWFpbCA6IHJlc3BvbnNlLmRhdGEuZGF0YVt3ZWJmcmFtZXdvcmsgKyAnX2RldGFpbHMnXS5zZW5kZXJfZW1haWw7CiAgICAvLyAgICAgICAgICAgdGhpcy5lbWFpbF92ZXJpZmljYXRpb25fc3RhdHVzKCk7CiAgICAvLyAgICAgICAgIH0KICAgIC8vICAgICAgIH1lbHNlIHsKICAgIC8vICAgICAgICAgU3dhbCh7CiAgICAvLyAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgIC8vICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgLy8gICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgIC8vICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAvLyAgICAgICAgIH0pCiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSkKICAgIC8vICAgICAuY2F0Y2goKGUpID0+IHsKICAgIC8vICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSBmYWxzZTsKICAgIC8vICAgICAgIHRvYXN0ci5lcnJvcih0aGlzLnRsdCgnb3RoZXJfZXJyb3Jfb2NjdXJfbXNnJykpOwogICAgLy8gICAgICAgaWYgKAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgLy8gICAgICAgKSB7CiAgICAvLyAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgLy8gZ2V0X2NvbXBhbnlfbG9nbygpIHsKICAgIC8vICAgYXhpb3MKICAgIC8vICAgICAucG9zdCgKICAgIC8vICAgICAgIGFwaV9jYWxscy51cGxvYWRfY29tcGFueV9sb2dvKCksCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgIC8vICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAvLyAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAvLyAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgLy8gICAgICAgICBpc19nZXQ6IHRydWUsCiAgICAvLyAgICAgICB9LAogICAgLy8gICAgICAgewogICAgLy8gICAgICAgICBoZWFkZXJzOiB7CiAgICAvLyAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAvLyAgICAgICAgIH0sCiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgKQogICAgLy8gICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgLy8gICAgICAgaWYocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSB0aGlzLmFwaV9zdGF0dXNfY29kZS5DT01QQU5ZX0lNQUdFX1VSTF9SRUNFSVZFRC5NU0dfQ09ERSl7CiAgICAvLyAgICAgICAgIHRoaXMuZmlsZV9sYWJlbCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5jb21wYW55X2ltYWdlX3VybAogICAgLy8gICAgICAgICAgIC5zcGxpdCgiLyIpCiAgICAvLyAgICAgICAgICAgLnJldmVyc2UoKVswXTsKICAgIC8vICAgICAgICAgdGhpcy5maWxlX2xhYmVsID0gZGVjb2RlVVJJKHRoaXMuZmlsZV9sYWJlbCk7CiAgICAvLyAgICAgICAgIHRoaXMub2xkX2ltYWdlX25hbWUgPSB0aGlzLmZpbGVfbGFiZWw7CiAgICAvLyAgICAgICAgIGlmICh0aGlzLmZpbGVfbGFiZWwgPT0gIiIpIHsKICAgIC8vICAgICAgICAgICB0aGlzLmZpbGVfbGFiZWwgPSAiQ2hvb3NlIGZpbGUiOwogICAgLy8gICAgICAgICB9CiAgICAvLyAgICAgICB9ZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSB0aGlzLmFwaV9zdGF0dXNfY29kZS5EQVRBX05PVF9GT1VORC5NU0dfQ09ERSl7CiAgICAvLyAgICAgICB9ZWxzZSB7CiAgICAvLyAgICAgICAgIFN3YWwoewogICAgLy8gICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAvLyAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgIC8vICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAvLyAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgLy8gICAgICAgICB9KQogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0pCiAgICAvLyAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAvLyAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgIC8vICAgICAgIHRoaXMuZmlsZV9sYWJlbCA9ICJDaG9vc2UgZmlsZSI7CiAgICAvLyAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5wdXRfY29tcGFueV9maWxlIikudmFsdWUgPSAiIjsKICAgIC8vICAgICAgIGlmICgKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICkgewogICAgLy8gICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0pOwogICAgLy8gfSwKICAgIC8vIHVwbG9hZF9jb21wYW55X2xvZ29fZmlsZSgpIHsKICAgIC8vICAgaWYgKAogICAgLy8gICAgIHRoaXMuZmlsZV9sYWJlbCA9PSB0aGlzLm9sZF9pbWFnZV9uYW1lIHx8CiAgICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlucHV0X2NvbXBhbnlfZmlsZSIpLnZhbHVlID09ICIiCiAgICAvLyAgICkgewogICAgLy8gICAgIHN3YWwoewogICAgLy8gICAgICAgdGV4dDogdGhpcy50bHQoJ290aGVyX3NlbGVjdF9maWxlX21zZycpLAogICAgLy8gICAgICAgdHlwZTogImVycm9yIiwKICAgIC8vICAgICAgIHRpbWVyOiAyNTAwLAogICAgLy8gICAgIH0pOwogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgLy8gICAgIGF4aW9zCiAgICAvLyAgICAgICAucG9zdCgKICAgIC8vICAgICAgICAgYXBpX2NhbGxzLnVwbG9hZF9jb21wYW55X2xvZ28oKSwKICAgIC8vICAgICAgICAgewogICAgLy8gICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgLy8gICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgIC8vICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgLy8gICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAvLyAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAvLyAgICAgICAgICAgaW1hZ2VfbmFtZTogdGhpcy5maWxlX2xhYmVsLAogICAgLy8gICAgICAgICAgIGNvbXBhbnlfbG9nb19maWxlOiB0aGlzLmltYWdlX2ZpbGUsCiAgICAvLyAgICAgICAgICAgaXNfaW1hZ2VfZWRpdDoKICAgIC8vICAgICAgICAgICAgIHRoaXMuZmlsZV9sYWJlbCAhPSB0aGlzLm9sZF9pbWFnZV9uYW1lID8gdHJ1ZSA6IGZhbHNlLAogICAgLy8gICAgICAgICAgIG9sZF9pbWFnZV9uYW1lOgogICAgLy8gICAgICAgICAgICAgdGhpcy5vbGRfaW1hZ2VfbmFtZSA9PSAiQ2hvb3NlIEZpbGUiCiAgICAvLyAgICAgICAgICAgICAgID8gbnVsbAogICAgLy8gICAgICAgICAgICAgICA6IHRoaXMub2xkX2ltYWdlX25hbWUsCiAgICAvLyAgICAgICAgIH0sCiAgICAvLyAgICAgICAgIHsKICAgIC8vICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAvLyAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgIC8vICAgICAgICAgICB9LAogICAgLy8gICAgICAgICB9CiAgICAvLyAgICAgICApCiAgICAvLyAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgIC8vICAgICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgLy8gICAgICAgICB0aGlzLmdldF9jb21wYW55X2xvZ28oKTsKICAgIC8vICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuSU1HX0RVUExJQ0FURS5NU0dfQ09ERSkgewogICAgLy8gICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnB1dF9jb21wYW55X2ZpbGUiKS52YWx1ZSA9ICIiOwogICAgLy8gICAgICAgICAgIC8vIHRvYXN0ci5lcnJvcigKICAgIC8vICAgICAgICAgICAvLyAgICJJbWFnZSBhbHJlYWR5IGZvdW5kLiBQbGVhc2UgdXBsb2FkIGFub3RoZXIgaW1hZ2Ugb3IgcmVuYW1lIGl0LiIKICAgIC8vICAgICAgICAgICAvLyApOwogICAgLy8gICAgICAgICAgIHN3YWwoewogICAgLy8gICAgICAgICAgICAgdGV4dDogdGhpcy50bHQoJ290aGVyX2ltZ19hbHJlYWR5X2ZvdW5kX21zZycpLAogICAgLy8gICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgIC8vICAgICAgICAgICAgIHRpbWVyOiAzMDAwLAogICAgLy8gICAgICAgICAgIH0pOwogICAgLy8gICAgICAgICB9IGVsc2UgaWYgKAogICAgLy8gICAgICAgICAgIHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuQ09NUEFOWV9MT0dPX1VQREFURUQuTVNHX0NPREUKICAgIC8vICAgICAgICAgKSB7CiAgICAvLyAgICAgICAgICAgc3dhbCh7CiAgICAvLyAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgnb3RoZXJfbG9nb191cGxvYWRfc3VjY2Vzc2Z1bF9tc2cnKSwKICAgIC8vICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgIC8vICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgLy8gICAgICAgICAgIH0pOwogICAgLy8gICAgICAgICB9IGVsc2UgewogICAgLy8gICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnB1dF9jb21wYW55X2ZpbGUiKS52YWx1ZSA9ICIiOwogICAgLy8gICAgICAgICAgIHN3YWwoewogICAgLy8gICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgIC8vICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAvLyAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgLy8gICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgLy8gICAgICAgICAgIH0pOwogICAgLy8gICAgICAgICB9CiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAvLyAgICAgICAgIHN3YWwoewogICAgLy8gICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdvdGhlcl9lcnJvcl9vY2N1cl9tc2czJyksCiAgICAvLyAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgIC8vICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgIC8vICAgICAgICAgfSk7CiAgICAvLyAgICAgICAgIHRoaXMuZ2V0X2NvbXBhbnlfbG9nbygpOwogICAgLy8gICAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7CiAgICAvLyAgICAgICAgIGlmICgKICAgIC8vICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgLy8gICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICAgKSB7CiAgICAvLyAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgfSk7CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICAvLyBjb25maWd1cmVfcHJvZHVjdF9zZXR0aW5ncygpIHsKICAgIC8vICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgIC8vICAgaWYgKHRoaXMudmFsaWRFbWFpbCAhPSB0cnVlICYmICFCb29sZWFuKHRoaXMucGhvbmVOdW1iZXIpICkgewogICAgLy8gICAgIHN3YWwoewogICAgLy8gICAgICAgdGV4dDogdGhpcy50bHQoJ290aGVyX3ZhbGlkX2VtYWlsX29yX251bWJlcl9tc2cnKSwKICAgIC8vICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgIC8vICAgICAgIHRpbWVyOiAzMDAwLAogICAgLy8gICAgIH0pOwogICAgLy8gICAgIHJldHVybjsKICAgIC8vICAgfQogICAgLy8gICAvLyBpZiAoIUJvb2xlYW4odGhpcy5waG9uZU51bWJlcikpIHsKICAgIC8vICAgLy8gICBzd2FsKHsKICAgIC8vICAgLy8gICAgIHRleHQ6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBQaG9uZSBOdW1iZXIiLAogICAgLy8gICAvLyAgICAgdHlwZTogIndhcm5pbmciLAogICAgLy8gICAvLyAgICAgdGltZXI6IDMwMDAsCiAgICAvLyAgIC8vICAgfSk7CiAgICAvLyAgIC8vICAgcmV0dXJuOwogICAgLy8gICAvLyBlbHNlIGlmICh0aGlzLnBob25lTnVtYmVyLmlzVmFsaWQgIT0gdHJ1ZSkgewogICAgLy8gICAvLyAgIHN3YWwoewogICAgLy8gICAvLyAgICAgdGV4dDogIlBsZWFzZSBlbnRlciBhIHZhbGlkIFBob25lIE51bWJlciIsCiAgICAvLyAgIC8vICAgICB0eXBlOiAid2FybmluZyIsCiAgICAvLyAgIC8vICAgICB0aW1lcjogMzAwMCwKICAgIC8vICAgLy8gICB9KTsKICAgIC8vICAgLy8gICByZXR1cm47CiAgICAvLyAgIC8vIH0KICAgIC8vICAgdGhpcy5iaWdfc3Bpbm5lciA9IHRydWU7CiAgICAvLyAgIGF4aW9zCiAgICAvLyAgICAgLnBvc3QoCiAgICAvLyAgICAgICBhcGlfY2FsbHMucHJvZHVjdF9zZXR0aW5ncygpLAogICAgLy8gICAgICAgewogICAgLy8gICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAvLyAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgLy8gICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgLy8gICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgLy8gICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgIC8vICAgICAgICAgaXNfZW1haWxfcmVxdWlyZWQ6IHRydWUsCiAgICAvLyAgICAgICAgIGVtYWlsX3JlcXVpcmVkOiB7CiAgICAvLyAgICAgICAgICAgY29udGFjdF9oZWxwX2VtYWlsOiB0aGlzLmNvbnRhY3RfdXNfZW1haWwsCiAgICAvLyAgICAgICAgICAgY29udGFjdF91c19waG9uZV9udW1iZXI6IChCb29sZWFuKHRoaXMucGhvbmVOdW1iZXIpICYmIHRoaXMucGhvbmVOdW1iZXIuaXNWYWxpZCA9PSB0cnVlKSA/IHRoaXMucGhvbmVOdW1iZXIuZm9ybWF0dGVkTnVtYmVyIDogbnVsbCwKICAgIC8vICAgICAgICAgfSwKICAgIC8vICAgICAgIH0sCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGhlYWRlcnM6IHsKICAgIC8vICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgIC8vICAgICAgICAgfSwKICAgIC8vICAgICAgIH0KICAgIC8vICAgICApCiAgICAvLyAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAvLyAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7CiAgICAvLyAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSB0aGlzLmFwaV9zdGF0dXNfY29kZS5TVUNDRVNTRlVMX0RCX1FVRVJZLk1TR19DT0RFKSB7CiAgICAvLyAgICAgICAgIHN3YWwoewogICAgLy8gICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdvdGhlcl9jaGFuZ2VzX3NhdmVkX21zZycpLAogICAgLy8gICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgIC8vICAgICAgICAgICB0aW1lcjogNDAwMCwKICAgIC8vICAgICAgICAgfSk7CiAgICAvLyAgICAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgIC8vICAgICAgICAgdGhpcy5sb2FkX3Byb2R1Y3Rfc2V0dGluZ3MoKTsKICAgIC8vICAgICAgIH0gZWxzZSB7CiAgICAvLyAgICAgICAgIHN3YWwoewogICAgLy8gICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAvLyAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgIC8vICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAvLyAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgLy8gICAgICAgICB9KTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgICB9KQogICAgLy8gICAgIC5jYXRjaCgoZSkgPT4gewogICAgLy8gICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgLy8gICAgICAgdG9hc3RyLmVycm9yKHRoaXMudGx0KCdvdGhlcl9lcnJvcl9vY2N1cl9tc2c0JykpOwogICAgLy8gICAgICAgaWYgKAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgLy8gICAgICAgKSB7CiAgICAvLyAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgYnV0dG9uX2NsYXNzOiBmdW5jdGlvbiBidXR0b25fY2xhc3MoaW5kZXgpIHsKICAgICAgaWYgKHRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdC5sZW5ndGggIT0gMCkgewogICAgICAgIGlmICh0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbaW5kZXhdLkVuYWJsZWQgPT0gdHJ1ZSkgewogICAgICAgICAgcmV0dXJuICJidXR0b25fZW5hYmxlZCI7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbaW5kZXhdLkVuYWJsZWQgPT0gZmFsc2UpIHsKICAgICAgICAgIHJldHVybiAiYnV0dG9uX2Rpc2FibGVkIjsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICJidXR0b25fZGlzYWJsZWQiOwogICAgICB9CiAgICB9LAogICAgbXVsdGlwbGVfbGFuZ3VhZ2Vfc3R5bGU6IGZ1bmN0aW9uIG11bHRpcGxlX2xhbmd1YWdlX3N0eWxlKCkge30sCiAgICBtdWx0aXBsZV9sYW5ndWFnZV9hcGk6IGZ1bmN0aW9uIG11bHRpcGxlX2xhbmd1YWdlX2FwaShsYW5ndWFnZSwgaW5kZXgpIHsKICAgICAgdmFyIGJ1dHRvbl9jbGFzczsKCiAgICAgIGlmIChsYW5ndWFnZSAhPSAiYWxsIikgewogICAgICAgIGJ1dHRvbl9jbGFzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxhbmd1YWdlICsgIl9idXR0b24iKS5jbGFzc0xpc3Q7CgogICAgICAgIGlmIChidXR0b25fY2xhc3MuY29udGFpbnMoImJ1dHRvbl9kaXNhYmxlZCIpKSB7CiAgICAgICAgICBidXR0b25fY2xhc3MucmVtb3ZlKCJidXR0b25fZGlzYWJsZWQiKTsKICAgICAgICAgIGJ1dHRvbl9jbGFzcy5hZGQoImJ1dHRvbl9lbmFibGVkIik7CiAgICAgICAgICB0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbaW5kZXhdLkVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgdGhpcy5sYW5ndWFnZV9zdXBwb3J0X2FwaSgpOwogICAgICAgIH0gZWxzZSBpZiAoYnV0dG9uX2NsYXNzLmNvbnRhaW5zKCJidXR0b25fZW5hYmxlZCIpKSB7CiAgICAgICAgICBidXR0b25fY2xhc3MucmVtb3ZlKCJidXR0b25fZW5hYmxlZCIpOwogICAgICAgICAgYnV0dG9uX2NsYXNzLmFkZCgiYnV0dG9uX2Rpc2FibGVkIik7CiAgICAgICAgICB0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbaW5kZXhdLkVuYWJsZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMubGFuZ3VhZ2Vfc3VwcG9ydF9hcGkoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAobGFuZ3VhZ2UgPT0gImFsbCIpIHsKICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNoZWNrZWQpIHsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlbmdsaXNoX2J1dHRvbiIpLmNsYXNzTGlzdC5hZGQoImJ1dHRvbl9lbmFibGVkIik7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZW5nbGlzaF9idXR0b24iKS5jbGFzc0xpc3QucmVtb3ZlKCJidXR0b25fZGlzYWJsZWQiKTsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoaW5kaV9idXR0b24iKS5jbGFzc0xpc3QuYWRkKCJidXR0b25fZW5hYmxlZCIpOwogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhpbmRpX2J1dHRvbiIpLmNsYXNzTGlzdC5yZW1vdmUoImJ1dHRvbl9kaXNhYmxlZCIpOwoKICAgICAgICAgIGlmICh0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbMF0uRW5hYmxlZCAmJiB0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbMV0uRW5hYmxlZCkge30gZWxzZSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5tdWx0aXBsZV9sYW5ndWFnZV9saXN0KSB7CiAgICAgICAgICAgICAgdGhpcy5tdWx0aXBsZV9sYW5ndWFnZV9saXN0W2ldLkVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLmxhbmd1YWdlX3N1cHBvcnRfYXBpKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICghZXZlbnQudGFyZ2V0LmNoZWNrZWQpIHsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlbmdsaXNoX2J1dHRvbiIpLmNsYXNzTGlzdC5yZW1vdmUoImJ1dHRvbl9lbmFibGVkIik7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZW5nbGlzaF9idXR0b24iKS5jbGFzc0xpc3QuYWRkKCJidXR0b25fZGlzYWJsZWQiKTsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoaW5kaV9idXR0b24iKS5jbGFzc0xpc3QucmVtb3ZlKCJidXR0b25fZW5hYmxlZCIpOwogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhpbmRpX2J1dHRvbiIpLmNsYXNzTGlzdC5hZGQoImJ1dHRvbl9kaXNhYmxlZCIpOwoKICAgICAgICAgIGlmICghdGhpcy5tdWx0aXBsZV9sYW5ndWFnZV9saXN0WzBdLkVuYWJsZWQgJiYgIXRoaXMubXVsdGlwbGVfbGFuZ3VhZ2VfbGlzdFsxXS5FbmFibGVkKSB7fSBlbHNlIHsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3QpIHsKICAgICAgICAgICAgICB0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3RbaV0uRW5hYmxlZCA9IGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLmxhbmd1YWdlX3N1cHBvcnRfYXBpKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8gc2VsZWN0X3RyYWluZWRfZGlhbG9ndWVfbW9kZWwoaW5kZXgpIHsKICAgIC8vICAgaWYoIXRoaXMuZGlzYWJsZV9idG5fZXhwaXJlZCl7CiAgICAvLyAgICAgbGV0IGNhbGxfYXBpID0gdHJ1ZTsKICAgIC8vICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudHJhaW5lZF9kaWFsb2d1ZV9tb2RlbHMubGVuZ3RoOyBpKyspIHsKICAgIC8vICAgICAgIGlmICh0aGlzLnRyYWluZWRfZGlhbG9ndWVfbW9kZWxzW2luZGV4XS5hY3RpdmUpIHsKICAgIC8vICAgICAgICAgY2FsbF9hcGkgPSBmYWxzZTsKICAgIC8vICAgICAgICAgYnJlYWs7CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfQogICAgLy8gICAgIGlmIChjYWxsX2FwaSkgewogICAgLy8gICAgICAgU3dhbC5maXJlKHsKICAgIC8vICAgICAgICAgdGl0bGU6IHRoaXMudGx0KCd0cmFpbmVkX2RpYWxvZ19zd2FsX2FsZXJ0X21zZycpLAogICAgLy8gICAgICAgICB0ZXh0OgogICAgLy8gICAgICAgICAgIHRoaXMudGx0KCd0cmFpbmVkX2RpYWxvZ19zd2FsX3NldF9tc2cnKSArCiAgICAvLyAgICAgICAgICAgdGhpcy50bHQoJ3RyYWluZWRfZGlhbG9nX3N3YWxfY29tcGFueW5hbWVfbXNnJykgKwogICAgLy8gICAgICAgICAgICIgViIgKwogICAgLy8gICAgICAgICAgICh0aGlzLnRsdCgndHJhaW5lZF9kaWFsb2dfbW9kZWxfc3dhbF9tc2cnKS5sZW5ndGggLSBpbmRleCkgKwogICAgLy8gICAgICAgICAgIHRoaXMudGx0KCd0cmFpbmVkX2RpYWxvZ19jdXJyZW50X21vZGVsX21zZycpLAogICAgLy8gICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgLy8gICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgLy8gICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgIC8vICAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgIC8vICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IHRoaXMudGx0KCd0cmFpbmVkX2RpYWxvZ19zd2FsX2NvbmZpcm1fbXNnJyksCiAgICAvLyAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgIC8vICAgICAgICAgYWxsb3dFc2NhcGVLZXk6IGZhbHNlLAogICAgLy8gICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAvLyAgICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgIC8vICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJEYXNoYm9hcmRTaWRlYmFyRGlzYWJsZSIsdHJ1ZSk7CiAgICAvLyAgICAgICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIlNldHRpbmdUb3BuYXZiYXJEaXNhYmxlIix0cnVlKTsKICAgIC8vICAgICAgICAgICB0aGlzLmRpc2FibGVfc2lkZWJhciA9IHRydWU7CiAgICAvLyAgICAgICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IHRydWU7CiAgICAvLyAgICAgICAgICAgLy8gU3dhbC5maXJlKHsKICAgIC8vICAgICAgICAgICAvLyAgIHRleHQ6ICJQbGVhc2Ugd2FpdCB3aGlsZSB3ZSBzdWJtaXQgeW91ciByZXF1ZXN0IiwKICAgIC8vICAgICAgICAgICAvLyAgIHRvYXN0OiB0cnVlLAogICAgLy8gICAgICAgICAgIC8vICAgdHlwZTogImluZm8iLAogICAgLy8gICAgICAgICAgIC8vICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgLy8gICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgLy8gfSk7CiAgICAvLyAgICAgICAgICAgYXhpb3MKICAgIC8vICAgICAgICAgICAgIC5wb3N0KAogICAgLy8gICAgICAgICAgICAgICBhcGlfY2FsbHMucmV2ZXJ0X21vZGVscygpLAogICAgLy8gICAgICAgICAgICAgICB7CiAgICAvLyAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgIC8vICAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgLy8gICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgLy8gICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbjoKICAgIC8vICAgICAgICAgICAgICAgICAgIHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAvLyAgICAgICAgICAgICAgICAgY29tcGFueV9kZXRhaWxzOiB7CiAgICAvLyAgICAgICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgIC8vICAgICAgICAgICAgICAgICAgIGNvbXBhbnlfbmFtZToKICAgIC8vICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgIC8vICAgICAgICAgICAgICAgICB9LAogICAgLy8gICAgICAgICAgICAgICAgIG1vZGVsX2ZpbGU6IHRoaXMudHJhaW5lZF9kaWFsb2d1ZV9tb2RlbHNbaW5kZXhdLkZpbGVOYW1lLAogICAgLy8gICAgICAgICAgICAgICB9LAogICAgLy8gICAgICAgICAgICAgICB7CiAgICAvLyAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgLy8gICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAvLyAgICAgICAgICAgICAgICAgfSwKICAgIC8vICAgICAgICAgICAgICAgfQogICAgLy8gICAgICAgICAgICAgKQogICAgLy8gICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAvLyAgICAgICAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlX3NpZGViYXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiRGFzaGJvYXJkU2lkZWJhckRpc2FibGUiLGZhbHNlKTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIlNldHRpbmdUb3BuYXZiYXJEaXNhYmxlIixmYWxzZSk7CiAgICAvLyAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IHRoaXMuYXBpX3N0YXR1c19jb2RlLlVQREFURURfQ09SRS5NU0dfQ09ERSkgewogICAgLy8gICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ3RyYWluZWRfZGlhbG9nX21vZGVsX3VwZGF0ZWRfbXNnJyksCiAgICAvLyAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAvLyAgICAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgICBhbGxvd0VzY2FwZUtleTogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgICB0aW1lcjogMjAwMCwKICAgIC8vICAgICAgICAgICAgICAgICB9KQogICAgLy8gICAgICAgICAgICAgICAgIHRoaXMuZ2V0X3RyYWluZWRfZGlhbG9ndWVfbW9kZWxzKCk7CiAgICAvLyAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAvLyAgICAgICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgIC8vICAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAvLyAgICAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgLy8gICAgICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgIC8vICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgIC8vICAgICAgICAgICAgICAgICB9KTsKICAgIC8vICAgICAgICAgICAgICAgfQogICAgLy8gICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAvLyAgICAgICAgICAgICB9KQogICAgLy8gICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAvLyAgICAgICAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlX3NpZGViYXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiRGFzaGJvYXJkU2lkZWJhckRpc2FibGUiLGZhbHNlKTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIlNldHRpbmdUb3BuYXZiYXJEaXNhYmxlIixmYWxzZSk7CiAgICAvLyAgICAgICAgICAgICAgIGlmICgKICAgIC8vICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgLy8gICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICAgICAgICAgKSB7CiAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgIC8vICAgICAgICAgICAgICAgfQogICAgLy8gICAgICAgICAgICAgfSk7CiAgICAvLyAgICAgICAgIH0KICAgIC8vICAgICAgIH0pOwogICAgLy8gICAgIH0KICAgIC8vICAgfWVsc2V7CiAgICAvLyAgICAgdGhpcy5zaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwodHJ1ZSk7CiAgICAvLyAgIH0KICAgIC8vIH0sICAKICAgIC8vIHNlbGVjdF90cmFpbmVkX2ludGVudF9tb2RlbChpbmRleCkgewogICAgLy8gICBpZighdGhpcy5kaXNhYmxlX2J0bl9leHBpcmVkKXsKICAgIC8vICAgICBsZXQgY2FsbF9hcGkgPSB0cnVlOwogICAgLy8gICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmFpbmVkX2ludGVudF9tb2RlbHMubGVuZ3RoOyBpKyspIHsKICAgIC8vICAgICAgIGlmICh0aGlzLnRyYWluZWRfaW50ZW50X21vZGVsc1tpbmRleF0uYWN0aXZlKSB7CiAgICAvLyAgICAgICAgIGNhbGxfYXBpID0gZmFsc2U7CiAgICAvLyAgICAgICAgIGJyZWFrOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0KICAgIC8vICAgICBpZiAoY2FsbF9hcGkpIHsKICAgIC8vICAgICAgIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgndHJhaW5lZF9pbnRlbnRfc3dhbF9hbGVydF9tc2cnKSwKICAgIC8vICAgICAgICAgdGV4dDoKICAgIC8vICAgICAgICAgICB0aGlzLnRsdCgndHJhaW5lZF9pbnRlbnRfc3dhbF9zZXRfbXNnJykgKwogICAgLy8gICAgICAgICAgIHRoaXMudGx0KCd0cmFpbmVkX2ludGVudF9zd2FsX2NvbXBhbnluYW1lX21zZycpICsKICAgIC8vICAgICAgICAgICAiIFYiICsKICAgIC8vICAgICAgICAgICAodGhpcy50bHQoJ3RyYWluZWRfaW50ZW50X21vZGVsX3N3YWxfbXNnJykubGVuZ3RoIC0gaW5kZXgpICsKICAgIC8vICAgICAgICAgICB0aGlzLnRsdCgndHJhaW5lZF9pbnRlbnRfY3VycmVudF9tb2RlbF9tc2cnKSwKICAgIC8vICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgIC8vICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgIC8vICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAvLyAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAvLyAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgndHJhaW5lZF9pbnRlbnRfc3dhbF9jb25maXJtX21zZycpLAogICAgLy8gICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAvLyAgICAgICAgIGFsbG93RXNjYXBlS2V5OiBmYWxzZSwKICAgIC8vICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgLy8gICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAvLyAgICAgICAgICAgdGhpcy5kaXNhYmxlX3NpZGViYXIgPSB0cnVlOwogICAgLy8gICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIkRhc2hib2FyZFNpZGViYXJEaXNhYmxlIix0cnVlKTsKICAgIC8vICAgICAgICAgICB0aGlzLiRzZXNzaW9uLnNldCgiU2V0dGluZ1RvcG5hdmJhckRpc2FibGUiLHRydWUpOwogICAgLy8gICAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgLy8gICAgICAgICAgIC8vIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICAgICAgLy8gICB0ZXh0OiAiUGxlYXNlIHdhaXQgd2hpbGUgd2Ugc3VibWl0IHlvdXIgcmVxdWVzdCIsCiAgICAvLyAgICAgICAgICAgLy8gICB0b2FzdDogdHJ1ZSwKICAgIC8vICAgICAgICAgICAvLyAgIHR5cGU6ICJpbmZvIiwKICAgIC8vICAgICAgICAgICAvLyAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgIC8vICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgIC8vIH0pOwogICAgLy8gICAgICAgICAgIGF4aW9zCiAgICAvLyAgICAgICAgICAgICAucG9zdCgKICAgIC8vICAgICAgICAgICAgICAgYXBpX2NhbGxzLnRyYWluX2ludGVudF9tb2RlbCgpLAogICAgLy8gICAgICAgICAgICAgICB7CiAgICAvLyAgICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgLy8gICAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgLy8gICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgIC8vICAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgIC8vICAgICAgICAgICAgICAgICBGaWxlTmFtZTogdGhpcy50cmFpbmVkX2ludGVudF9tb2RlbHNbaW5kZXhdLkZpbGVOYW1lLAogICAgLy8gICAgICAgICAgICAgICAgIGlzQ2hhbmdlTW9kZWxWZXJzaW9uOiB0cnVlLAogICAgLy8gICAgICAgICAgICAgICB9LAogICAgLy8gICAgICAgICAgICAgICB7CiAgICAvLyAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgLy8gICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAvLyAgICAgICAgICAgICAgICAgfSwKICAgIC8vICAgICAgICAgICAgICAgfQogICAgLy8gICAgICAgICAgICAgKQogICAgLy8gICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAvLyAgICAgICAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlX3NpZGViYXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiRGFzaGJvYXJkU2lkZWJhckRpc2FibGUiLGZhbHNlKTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIlNldHRpbmdUb3BuYXZiYXJEaXNhYmxlIixmYWxzZSk7CiAgICAvLyAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IHRoaXMuYXBpX3N0YXR1c19jb2RlLk1PREVMX1VQREFURURfTU9ERUxTLk1TR19DT0RFKSB7CiAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy5nZXRfdHJhaW5lZF9pbnRlbnRfbW9kZWxzKCk7CiAgICAvLyAgICAgICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgIC8vICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgndHJhaW5lZF9pbnRlbnRfbW9kZWxfdXBkYXRlZF9tc2cnKSwKICAgIC8vICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgIC8vICAgICAgICAgICAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgIC8vICAgICAgICAgICAgICAgICAgIGFsbG93RXNjYXBlS2V5OiBmYWxzZSwKICAgIC8vICAgICAgICAgICAgICAgICAgIHRpbWVyOiAyMDAwLAogICAgLy8gICAgICAgICAgICAgICAgIH0pOwogICAgLy8gICAgICAgICAgICAgICB9IGVsc2UgewogICAgLy8gICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgLy8gICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgIC8vICAgICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgLy8gICAgICAgICAgICAgICAgIH0pOwogICAgLy8gICAgICAgICAgICAgICB9CiAgICAvLyAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgIC8vICAgICAgICAgICAgIH0pCiAgICAvLyAgICAgICAgICAgICAuY2F0Y2goKGUpID0+IHsKICAgIC8vICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSkKICAgIC8vICAgICAgICAgICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgLy8gICAgICAgICAgICAgICB0aGlzLmRpc2FibGVfc2lkZWJhciA9IGZhbHNlOwogICAgLy8gICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJEYXNoYm9hcmRTaWRlYmFyRGlzYWJsZSIsZmFsc2UpOwogICAgLy8gICAgICAgICAgICAgICB0aGlzLiRzZXNzaW9uLnNldCgiU2V0dGluZ1RvcG5hdmJhckRpc2FibGUiLGZhbHNlKTsKICAgIC8vICAgICAgICAgICAgICAgaWYgKAogICAgLy8gICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgIC8vICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAvLyAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgLy8gICAgICAgICAgICAgICApIHsKICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgICAgICAgICAgICB9CiAgICAvLyAgICAgICAgICAgICB9KTsKICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgfSk7CiAgICAvLyAgICAgfQogICAgLy8gICB9ZWxzZXsKICAgIC8vICAgICB0aGlzLnNob3dfc3Vic2NyaXB0aW9uX2V4cGlyZWRfc3dhbCh0cnVlKTsKICAgIC8vICAgfQogICAgLy8gfSwKICAgIC8vIHNlbGVjdF90cmFpbmVkX25lcl9tb2RlbChpbmRleCkgewogICAgLy8gICBpZighdGhpcy5kaXNhYmxlX2J0bl9leHBpcmVkKXsKICAgIC8vICAgICBsZXQgY2FsbF9hcGkgPSB0cnVlOwogICAgLy8gICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmFpbmVkX25lcl9tb2RlbHMubGVuZ3RoOyBpKyspIHsKICAgIC8vICAgICAgIGlmICh0aGlzLnRyYWluZWRfbmVyX21vZGVsc1tpbmRleF0uYWN0aXZlKSB7CiAgICAvLyAgICAgICAgIGNhbGxfYXBpID0gZmFsc2U7CiAgICAvLyAgICAgICAgIGJyZWFrOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0KICAgIC8vICAgICBpZiAoY2FsbF9hcGkpIHsKICAgIC8vICAgICAgIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgndHJhaW5lZF9uZXJfc3dhbF9hbGVydF9tc2cnKSwKICAgIC8vICAgICAgICAgdGV4dDoKICAgIC8vICAgICAgICAgICB0aGlzLnRsdCgndHJhaW5lZF9uZXJfc3dhbF9zZXRfbXNnJykgKwogICAgLy8gICAgICAgICAgIHRoaXMudGx0KCd0cmFpbmVkX25lcl9zd2FsX2NvbXBhbnluYW1lX21zZycpICsKICAgIC8vICAgICAgICAgICAiIFYiICsKICAgIC8vICAgICAgICAgICAodGhpcy50bHQoJ3RyYWluZWRfbmVyX21vZGVsX3N3YWxfbXNnJykubGVuZ3RoIC0gaW5kZXgpICsKICAgIC8vICAgICAgICAgICB0aGlzLnRsdCgndHJhaW5lZF9uZXJfY3VycmVudF9tb2RlbF9tc2cnKSwKICAgIC8vICAgICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgIC8vICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgIC8vICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAvLyAgICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAvLyAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgndHJhaW5lZF9uZXJfc3dhbF9jb25maXJtX21zZycpLAogICAgLy8gICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAvLyAgICAgICAgIGFsbG93RXNjYXBlS2V5OiBmYWxzZSwKICAgIC8vICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4gewogICAgLy8gICAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAvLyAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiRGFzaGJvYXJkU2lkZWJhckRpc2FibGUiLHRydWUpOwogICAgLy8gICAgICAgICAgIHRoaXMuJHNlc3Npb24uc2V0KCJTZXR0aW5nVG9wbmF2YmFyRGlzYWJsZSIsdHJ1ZSk7CiAgICAvLyAgICAgICAgICAgdGhpcy5kaXNhYmxlX3NpZGViYXIgPSB0cnVlOwogICAgLy8gICAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgLy8gICAgICAgICAgIC8vIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICAgICAgLy8gICB0ZXh0OiAiUGxlYXNlIHdhaXQgd2hpbGUgd2Ugc3VibWl0IHlvdXIgcmVxdWVzdCIsCiAgICAvLyAgICAgICAgICAgLy8gICB0b2FzdDogdHJ1ZSwKICAgIC8vICAgICAgICAgICAvLyAgIHR5cGU6ICJpbmZvIiwKICAgIC8vICAgICAgICAgICAvLyAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgIC8vICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgIC8vIH0pOwogICAgLy8gICAgICAgICAgIGF4aW9zCiAgICAvLyAgICAgICAgICAgICAucG9zdCgKICAgIC8vICAgICAgICAgICAgICAgYXBpX2NhbGxzLnJldmVydF9uZXJfbW9kZWxzKCksCiAgICAvLyAgICAgICAgICAgICAgIHsKICAgIC8vICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAvLyAgICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAvLyAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgIC8vICAgICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgLy8gICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgLy8gICAgICAgICAgICAgICAgIGNvbXBhbnlfZGV0YWlsczogewogICAgLy8gICAgICAgICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAvLyAgICAgICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAvLyAgICAgICAgICAgICAgICAgfSwKICAgIC8vICAgICAgICAgICAgICAgICBtb2RlbF9maWxlOiB0aGlzLnRyYWluZWRfbmVyX21vZGVsc1tpbmRleF0uRmlsZU5hbWUsCiAgICAvLyAgICAgICAgICAgICAgIH0sCiAgICAvLyAgICAgICAgICAgICAgIHsKICAgIC8vICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAvLyAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgIC8vICAgICAgICAgICAgICAgICB9LAogICAgLy8gICAgICAgICAgICAgICB9CiAgICAvLyAgICAgICAgICAgICApCiAgICAvLyAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlX3NpZGViYXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiRGFzaGJvYXJkU2lkZWJhckRpc2FibGUiLHRydWUpOwogICAgLy8gICAgICAgICAgICAgICB0aGlzLiRzZXNzaW9uLnNldCgiU2V0dGluZ1RvcG5hdmJhckRpc2FibGUiLHRydWUpOwogICAgLy8gICAgICAgICAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7CiAgICAvLyAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IHRoaXMuYXBpX3N0YXR1c19jb2RlLlJFVkVSVF9TVUNDRVNTRlVMX01PREVMUy5NU0dfQ09ERSkgewogICAgLy8gICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ3RyYWluZWRfbmVyX21vZGVsX3VwZGF0ZWRfbXNnJyksCiAgICAvLyAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAvLyAgICAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgICBhbGxvd0VzY2FwZUtleTogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgICB0aW1lcjogMjAwMCwKICAgIC8vICAgICAgICAgICAgICAgICB9KS50aGVuKChyZXN1bHRfc3VjY2VzcykgPT4gewogICAgLy8gICAgICAgICAgICAgICAgICAgLy8gaWYgKHJlc3VsdF9zdWNjZXNzLnZhbHVlKSB7CiAgICAvLyAgICAgICAgICAgICAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gdHJ1ZTsKICAgIC8vICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0X3RyYWluZWRfbmVyX21vZGVscygpOwogICAgLy8gICAgICAgICAgICAgICAgICAgLy8gfQogICAgLy8gICAgICAgICAgICAgICAgIH0pOwogICAgLy8gICAgICAgICAgICAgICB9IGVsc2UgewogICAgLy8gICAgICAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgLy8gICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgIC8vICAgICAgICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwKICAgIC8vICAgICAgICAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAvLyAgICAgICAgICAgICAgICAgfSk7CiAgICAvLyAgICAgICAgICAgICAgIH0KICAgIC8vICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgLy8gICAgICAgICAgICAgfSkKICAgIC8vICAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgLy8gICAgICAgICAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7CiAgICAvLyAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZV9zaWRlYmFyID0gZmFsc2U7CiAgICAvLyAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIkRhc2hib2FyZFNpZGViYXJEaXNhYmxlIix0cnVlKTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy4kc2Vzc2lvbi5zZXQoIlNldHRpbmdUb3BuYXZiYXJEaXNhYmxlIix0cnVlKTsKICAgIC8vICAgICAgICAgICAgICAgaWYgKAogICAgLy8gICAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwKICAgIC8vICAgICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAvLyAgICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgLy8gICAgICAgICAgICAgICApIHsKICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgICAgICAgICAgICB9CiAgICAvLyAgICAgICAgICAgICB9KTsKICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgfSk7CiAgICAvLyAgICAgfQogICAgLy8gICB9ZWxzZXsKICAgIC8vICAgICB0aGlzLnNob3dfc3Vic2NyaXB0aW9uX2V4cGlyZWRfc3dhbCh0cnVlKTsKICAgIC8vICAgfQogICAgLy8gfSwKICAgIC8vIGdldF90cmFpbmVkX2RpYWxvZ3VlX21vZGVscygpIHsKICAgIC8vICAgdGhpcy5iaWdfc3Bpbm5lciA9IHRydWU7CiAgICAvLyAgIGF4aW9zCiAgICAvLyAgICAgLnBvc3QoCiAgICAvLyAgICAgICBhcGlfY2FsbHMudXNlX21vZGVsKCksCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgLy8gICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAvLyAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgLy8gICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgLy8gICAgICAgICBpc1Nob3c6IHRydWUsCiAgICAvLyAgICAgICB9LAogICAgLy8gICAgICAgewogICAgLy8gICAgICAgICBoZWFkZXJzOiB7CiAgICAvLyAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAsCiAgICAvLyAgICAgICAgIH0sCiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgKQogICAgLy8gICAgIC50aGVuKCh7IGRhdGEgfSkgPT4gewogICAgLy8gICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgLy8gICAgICAgaWYgKGRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuU1VDQ0VTU0ZVTF9EQl9RVUVSWV9DT1JFLk1TR19DT0RFKSB7CiAgICAvLyAgICAgICAgIHRoaXMudHJhaW5lZF9kaWFsb2d1ZV9tb2RlbHMgPSBkYXRhLmRhdGEubW9kZWxzLm1hcCgobW9kZWwpID0+IHsKICAgIC8vICAgICAgICAgICBtb2RlbC5jcmVhdGVkX2F0ID0gbW9tZW50CiAgICAvLyAgICAgICAgICAgICAudW5peChtb2RlbC5jcmVhdGVkX2F0KQogICAgLy8gICAgICAgICAgICAgLmZvcm1hdCgiRG8gTU1NIFlZIik7CiAgICAvLyAgICAgICAgICAgcmV0dXJuIG1vZGVsOwogICAgLy8gICAgICAgICB9KTsgICAgICAKICAgIC8vICAgICAgIH1lbHNlIHsKICAgIC8vICAgICAgICAgU3dhbCh7CiAgICAvLyAgICAgICAgICAgdGl0bGU6ZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgLy8gICAgICAgICAgIHRleHQ6ZGF0YS5tZXNzYWdlLk1TRywKICAgIC8vICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAvLyAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgLy8gICAgICAgICB9KQogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0pCiAgICAvLyAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAvLyAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgIC8vICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSBmYWxzZTsKICAgIC8vICAgICAgIGlmICgKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICkgewogICAgLy8gICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0pOwogICAgLy8gfSwKICAgIC8vIGdldF90cmFpbmVkX25lcl9tb2RlbHMoKSB7CiAgICAvLyAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgLy8gICBheGlvcwogICAgLy8gICAgIC5nZXQoCiAgICAvLyAgICAgICBhcGlfY2FsbHMucmV2ZXJ0X25lcl9tb2RlbHMoKSwKICAgIC8vICAgICAgIHsKICAgIC8vICAgICAgICAgcGFyYW1zOiB7CiAgICAvLyAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgIC8vICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgIC8vICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAvLyAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAvLyAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgIC8vICAgICAgICAgICByZXZlcnRfY29tcGFueV9pZDoKICAgIC8vICAgICAgICAgICAgIHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgLy8gICAgICAgICAgIHJldmVydF9jb21wYW55X25hbWU6CiAgICAvLyAgICAgICAgICAgICB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgLy8gICAgICAgICAgIGlzU2hvdzogdHJ1ZSwKICAgIC8vICAgICAgICAgfSwKICAgIC8vICAgICAgIH0sCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGhlYWRlcnM6IHsKICAgIC8vICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgIC8vICAgICAgICAgfSwKICAgIC8vICAgICAgIH0KICAgIC8vICAgICApCiAgICAvLyAgICAgLnRoZW4oKHsgZGF0YSB9KSA9PiB7CiAgICAvLyAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7CiAgICAvLyAgICAgICBpZiAoZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSB0aGlzLmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRV9NT0RFTFMuTVNHX0NPREUpIHsKICAgIC8vICAgICAgICAgdGhpcy50cmFpbmVkX25lcl9tb2RlbHMgPSBkYXRhLmRhdGEubW9kZWxfZGF0YS5tYXAoKG1vZGVsKSA9PiB7CiAgICAvLyAgICAgICAgICAgbW9kZWwuY3JlYXRlZF9hdCA9IG1vbWVudCgKICAgIC8vICAgICAgICAgICAgIG1vZGVsLmNyZWF0ZWRfYXQsCiAgICAvLyAgICAgICAgICAgICAiWVlZWU1NRERISG1tc3MiCiAgICAvLyAgICAgICAgICAgKS5mb3JtYXQoIkRvIE1NTSBZWSIpOwogICAgLy8gICAgICAgICAgIHJldHVybiBtb2RlbDsKICAgIC8vICAgICAgICAgfSk7ICAgICAgIAogICAgLy8gICAgICAgfWVsc2UgaWYgKGRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuRU1QVFlfREFUQV9NT0RFTFMuTVNHX0NPREUpewogICAgLy8gICAgICAgfQogICAgLy8gICAgICAgZWxzZXsKICAgIC8vICAgICAgICAgU3dhbCh7CiAgICAvLyAgICAgICAgICAgdGl0bGU6ZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgLy8gICAgICAgICAgIHRleHQ6ZGF0YS5tZXNzYWdlLk1TRywKICAgIC8vICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAvLyAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgLy8gICAgICAgICB9KSAgICAgICAgICAgCiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSkKICAgIC8vICAgICAuY2F0Y2goKGUpID0+IHsKICAgIC8vICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgLy8gICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgLy8gICAgICAgaWYgKAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgLy8gICAgICAgKSB7CiAgICAvLyAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgLy8gZ2V0X3RyYWluZWRfaW50ZW50X21vZGVscygpIHsKICAgIC8vICAgdGhpcy5iaWdfc3Bpbm5lciA9IHRydWU7CiAgICAvLyAgIGF4aW9zCiAgICAvLyAgICAgLnBvc3QoCiAgICAvLyAgICAgICBhcGlfY2FsbHMudHJhaW5faW50ZW50X21vZGVsKCksCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgIC8vICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAvLyAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAvLyAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgLy8gICAgICAgICBpc0dldE1vZGVsczogdHJ1ZSwKICAgIC8vICAgICAgIH0sCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGhlYWRlcnM6IHsKICAgIC8vICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgIC8vICAgICAgICAgfSwKICAgIC8vICAgICAgIH0KICAgIC8vICAgICApCiAgICAvLyAgICAgLnRoZW4oKHsgZGF0YSB9KSA9PiB7CiAgICAvLyAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7CiAgICAvLyAgICAgICBpZiAoZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSB0aGlzLmFwaV9zdGF0dXNfY29kZS5EQVRBX0FWQUlMQUJMRV9NT0RFTFMuTVNHX0NPREUpIHsKICAgIC8vICAgICAgICAgdGhpcy50cmFpbmVkX2ludGVudF9tb2RlbHMgPSBkYXRhLmRhdGEubW9kZWxzLm1hcCgobW9kZWwpID0+IHsKICAgIC8vICAgICAgICAgICBtb2RlbC5jcmVhdGVkX2F0ID0gbW9tZW50KAogICAgLy8gICAgICAgICAgICAgbW9kZWwuY3JlYXRlZF9hdCwKICAgIC8vICAgICAgICAgICAgICJZWVlZTU1EREhIbW1zcyIKICAgIC8vICAgICAgICAgICApLmZvcm1hdCgiRG8gTU1NIFlZIik7CiAgICAvLyAgICAgICAgICAgcmV0dXJuIG1vZGVsOwogICAgLy8gICAgICAgICB9KTsgCiAgICAvLyAgICAgICB9IGVsc2UgewogICAgLy8gICAgICAgICBTd2FsKHsKICAgIC8vICAgICAgICAgICB0aXRsZTpyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAvLyAgICAgICAgICAgdGV4dDpyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgLy8gICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgLy8gICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgIC8vICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAvLyAgICAgICAgIH0pCiAgICAvLyAgICAgfQogICAgLy8gICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgfSkKICAgIC8vICAgICAuY2F0Y2goKGUpID0+IHsKICAgIC8vICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgLy8gICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgLy8gICAgICAgaWYgKAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgLy8gICAgICAgKSB7CiAgICAvLyAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgLy8gYWRkX21haWwoKSB7CiAgICAvLyAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAvLyAgIGF4aW9zCiAgICAvLyAgICAgLnBvc3QoCiAgICAvLyAgICAgICBhcGlfY2FsbHMubm90aWZ5X3N1cGVyYWRtaW5fdXJsKCksCiAgICAvLyAgICAgICB7CiAgICAvLyAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgIC8vICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAvLyAgICAgICAgIHNlbmR0bzogdGhpcy5zZW5kZXIsCiAgICAvLyAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICAgIGJvZHk6IHRoaXMuZW1haWxfYm9keSwKICAgIC8vICAgICAgICAgc3ViamVjdDogdGhpcy5zdWJqZWN0LAogICAgLy8gICAgICAgICBiaW5kZW1haWw6ICJGYWxzZSIsCiAgICAvLyAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAvLyAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAvLyAgICAgICB9LAogICAgLy8gICAgICAgewogICAgLy8gICAgICAgICBoZWFkZXJzOiB7CiAgICAvLyAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuJHNlc3Npb24uZ2V0KCJhdCIpfWAKICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgfQogICAgLy8gICAgICkKICAgIC8vICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAvLyAgICAgICB0b2FzdHIuc3VjY2VzcyhyZXNwb25zZS5kYXRhKTsKICAgIC8vICAgICB9KQogICAgLy8gICAgIC5jYXRjaChlID0+IHsKICAgIC8vICAgICAgIGlmICgKICAgIC8vICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgLy8gICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAvLyAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICkgewogICAgLy8gICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0pOwogICAgLy8gfSwKICAgIGxhbmd1YWdlX3N1cHBvcnRfYXBpOiBmdW5jdGlvbiBsYW5ndWFnZV9zdXBwb3J0X2FwaSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5tdWx0aXBsZV9sYW5ndWFnZV9zdXBwb3J0X3VybCgpLCB7CiAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICBsYW5ndWFnZV9zdXBwb3J0OiB0aGlzLm11bHRpcGxlX2xhbmd1YWdlX2xpc3QKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFICE9IF90aGlzMi5hcGlfc3RhdHVzX2NvZGUuU1VDQ0VTU0ZVTF9EQl9RVUVSWS5NU0dfQ09ERSkge30gZWxzZSB7CiAgICAgICAgICBfdGhpczIuJHJvdXRlci5nbygpOwoKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyBmaWxlaW5wdXQoZSkgewogICAgLy8gICBsZXQgZmlsZXMgPSBlLnRhcmdldC5maWxlcyB8fCBlLmRhdGFUcmFuc2Zlci5maWxlczsKICAgIC8vICAgaWYgKGZpbGVzWzBdLnNpemUgPiAyMDk3MTUyKSB7CiAgICAvLyAgICAgc3dhbCh7CiAgICAvLyAgICAgICB0ZXh0OiB0aGlzLnRsdCgnb3RoZXJfdXBsb2FkX2NvbXBhbnlfbG9nb19tc2cnKSwKICAgIC8vICAgICAgIHRvYXN0OiB0cnVlLAogICAgLy8gICAgICAgcG9zaXRpb246ICJ0b3AtZW5kIiwKICAgIC8vICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAvLyAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICB0aW1lcjogMTAwMDAsCiAgICAvLyAgICAgfSk7CiAgICAvLyAgICAgcmV0dXJuOwogICAgLy8gICB9CiAgICAvLyAgIGlmIChmaWxlc1swXS50eXBlID09PSAiaW1hZ2UvcG5nIiB8fCBmaWxlc1swXS50eXBlID09PSAiaW1hZ2UvanBlZyIpIHsKICAgIC8vICAgICBpZiAoIWZpbGVzLmxlbmd0aCkgcmV0dXJuOwogICAgLy8gICAgIHRoaXMub2xkX2ltYWdlX25hbWUgPSB0aGlzLmZpbGVfbGFiZWw7CiAgICAvLyAgICAgdGhpcy5maWxlX2xhYmVsID0gZmlsZXNbMF0ubmFtZTsKICAgIC8vICAgICB0aGlzLmNyZWF0ZUltYWdlKGZpbGVzWzBdKTsKICAgIC8vICAgfSBlbHNlIHsKICAgIC8vICAgICBzd2FsKHsKICAgIC8vICAgICAgIHRleHQ6IHRoaXMudGx0KCdvdGhlcl9zZWxlY3RfaW1nX3R5cGVfbXNnJyksCiAgICAvLyAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgLy8gICAgICAgdGltZXI6IDI1MDAsCiAgICAvLyAgICAgfSk7CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICAvLyBjcmVhdGVJbWFnZShmaWxlLCB0eXBlKSB7CiAgICAvLyAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgLy8gICByZWFkZXIub25sb2FkID0gKGUpID0+IHsKICAgIC8vICAgICB0aGlzLmltYWdlX2ZpbGUgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoImJhc2U2NCwiKVsxXTsKICAgIC8vICAgfTsKICAgIC8vICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICAvLyB9LAogICAgLy8gZG93bmxvYWRfc2RrKGRhdGFfdHlwZSkgewogICAgLy8gICBpZiAoZGF0YV90eXBlID09ICJsaWNlbnNlX2tleSIpIHsKICAgIC8vICAgICB0aGlzLnNwaW5uZXJPbjEgPSB0cnVlOwogICAgLy8gICAgIGF4aW9zKHsKICAgIC8vICAgICAgIG1ldGhvZDogInBvc3QiLAogICAgLy8gICAgICAgdXJsOiBhcGlfY2FsbHMuZ2V0X2xpY2Vuc2Vfa2V5KCksCiAgICAvLyAgICAgICByZXNwb25zZVR5cGU6ICJibG9iIiwKICAgIC8vICAgICAgIGRhdGE6IHsKICAgIC8vICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAvLyAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgIC8vICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgIC8vICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAvLyAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICB9LAogICAgLy8gICAgICAgaGVhZGVyczogewogICAgLy8gICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgIC8vICAgICAgIH0sCiAgICAvLyAgICAgfSkKICAgIC8vICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgLy8gICAgICAgICB2YXIgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3Jlc3BvbnNlLmRhdGFdKSk7CiAgICAvLyAgICAgICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgLy8gICAgICAgICBsaW5rLmhyZWYgPSB1cmw7CiAgICAvLyAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsIGRhdGFfdHlwZSArICIudHh0Iik7CiAgICAvLyAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAvLyAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgIC8vICAgICAgICAgdGhpcy5zcGlubmVyT24xID0gZmFsc2U7CiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAvLyAgICAgICAgIGlmICgKICAgIC8vICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgLy8gICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICAgKSB7CiAgICAvLyAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgfSk7CiAgICAvLyAgIH0gZWxzZSB7CiAgICAvLyAgICAgdGhpcy5zcGlubmVyT24yID0gdHJ1ZTsKICAgIC8vICAgICBheGlvcyh7CiAgICAvLyAgICAgICBtZXRob2Q6ICJwb3N0IiwKICAgIC8vICAgICAgIHVybDogYXBpX2NhbGxzLmZpbGVfZG93bmxvYWRfdXJsKCksCiAgICAvLyAgICAgICByZXNwb25zZVR5cGU6ICJibG9iIiwKICAgIC8vICAgICAgIGRhdGE6IHsKICAgIC8vICAgICAgICAgZG93bmxvYWRfc2RrX3R5cGU6IGRhdGFfdHlwZSwKICAgIC8vICAgICAgICAgY29tcGFueV9pZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAvLyAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgIC8vICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgIC8vICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAvLyAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAvLyAgICAgICB9LAogICAgLy8gICAgICAgaGVhZGVyczogewogICAgLy8gICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YCwKICAgIC8vICAgICAgIH0sCiAgICAvLyAgICAgfSkKICAgIC8vICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgLy8gICAgICAgICB0aGlzLnNwaW5uZXJPbjIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuU1RBVFVTX1NVQ0NFU1MuTVNHX0NPREUpIHsKICAgIC8vICAgICAgICAgICB0b2FzdHIuZXJyb3IoCiAgICAvLyAgICAgICAgICAgICB0aGlzLnRsdCgnb3RoZXJfaW50ZXJuYWxfZXJyb3JfbXNnMScpCiAgICAvLyAgICAgICAgICAgKTsKICAgIC8vICAgICAgICAgfSBlbHNlIHsKICAgIC8vICAgICAgICAgICB2YXIgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3Jlc3BvbnNlLmRhdGFdKSk7CiAgICAvLyAgICAgICAgICAgdmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAvLyAgICAgICAgICAgbGluay5ocmVmID0gdXJsOwogICAgLy8gICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsIGRhdGFfdHlwZSArICJfU0RLLnppcCIpOwogICAgLy8gICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7CiAgICAvLyAgICAgICAgICAgbGluay5jbGljaygpOwogICAgLy8gICAgICAgICB9CiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAvLyAgICAgICAgIHRoaXMuc3Bpbm5lck9uMiA9IGZhbHNlOwogICAgLy8gICAgICAgICB0b2FzdHIuZXJyb3IoCiAgICAvLyAgICAgICAgICAgdGhpcy50bHQoJ290aGVyX2ludGVybmFsX2Vycm9yX21zZzInKQogICAgLy8gICAgICAgICApOwogICAgLy8gICAgICAgICBpZiAoCiAgICAvLyAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgLy8gICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgIC8vICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5CiAgICAvLyAgICAgICAgICkgewogICAgLy8gICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgICAgIH0KICAgIC8vICAgICAgIH0pOwogICAgLy8gICB9CiAgICAvLyB9LAogICAgY29weV93aWRnZXRfY29kZTogZnVuY3Rpb24gY29weV93aWRnZXRfY29kZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLiRyZWZzLndpZGdldF90ZXh0YXJlYS5zZWxlY3QoKTsKICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoImNvcHkiKTsKICAgICAgJCgiI2NvcHlfY29kZV90b29sdGlwIikudG9vbHRpcCgic2hvdyIpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCIjY29weV9jb2RlX3Rvb2x0aXAiKS50b29sdGlwKCJkaXNwb3NlIik7CgogICAgICAgIF90aGlzMy5pbml0aWFsaXplX3Rvb2x0aXBzKCk7CiAgICAgIH0sIDUwMDApOwogICAgfSwKICAgIGNvcHlfdXVpZF9jb2RlOiBmdW5jdGlvbiBjb3B5X3V1aWRfY29kZSgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLiRyZWZzLnV1aWRfdGV4dGFyZWExLnNlbGVjdCgpOwogICAgICB0aGlzLiRyZWZzLnV1aWRfdGV4dGFyZWEyLnNlbGVjdCgpOwogICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgiY29weSIpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCIjY29weV9jb2RlX3Rvb2x0aXAiKS50b29sdGlwKCJkaXNwb3NlIik7CgogICAgICAgIF90aGlzNC5pbml0aWFsaXplX3Rvb2x0aXBzKCk7CiAgICAgIH0sIDUwMDApOwogICAgfSwKICAgIC8vIGluaXRpYWxpemVfdG9vbHRpcHMoKSB7CiAgICAvLyAgICQoJ1tkYXRhLXRvb2x0aXA9InRvb2x0aXAiXScpLnRvb2x0aXAoewogICAgLy8gICAgIHRyaWdnZXI6ICJtYW51YWwiLAogICAgLy8gICB9KTsKICAgIC8vIH0sCiAgICAvLyBjb3B5X2xpY2Vuc2Vfa2V5KCkgewogICAgLy8gICB0aGlzLiRyZWZzLmxpY2Vuc2Vfa2V5X3RleHRhcmVhLnNlbGVjdCgpOwogICAgLy8gICB0aGlzLiRyZWZzLmxpY2Vuc2Vfa2V5X3RleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKDAsIDk5OTk5KTsKICAgIC8vICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoImNvcHkiKTsKICAgIC8vICAgJCgiI2NvcHlfbGljbnNlX2tleV90b29sdGlwIikudG9vbHRpcCgic2hvdyIpOwogICAgLy8gICBzZXRUaW1lb3V0KCgpID0+IHsKICAgIC8vICAgICAkKCIjY29weV9saWNuc2Vfa2V5X3Rvb2x0aXAiKS50b29sdGlwKCJkaXNwb3NlIik7CiAgICAvLyAgICAgdGhpcy5pbml0aWFsaXplX3Rvb2x0aXBzKCk7CiAgICAvLyAgIH0sIDUwMDApOwogICAgLy8gfSwKICAgIC8vIGNvbmZpZ3VyZV9zZW5kZXJfZW1haWwodmFsdWUpewogICAgLy8gICBpZiAodmFsdWUgPT0gImVtYWlsIikgewogICAgLy8gICAgIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICB0aXRsZTogdGhpcy50bHQoJ290aGVyX2NvbmZpZ3VyZV9lbWFpbF9zd2FsX21zZycpLAogICAgLy8gICAgICAgdGV4dDoKICAgIC8vICAgICAgICAgdGhpcy50bHQoJ290aGVyX3ZlcmlmaWNhdGlvbl9saW5rX21zZycpLAogICAgLy8gICAgICAgdHlwZTogInF1ZXN0aW9uIiwKICAgIC8vICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAvLyAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgIC8vICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAvLyAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ290aGVyX3N3YWxfcHJvY2VlZF9tc2cnKQogICAgLy8gICAgIH0pLnRoZW4ocmVzdWx0ID0+IHsKICAgIC8vICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgIC8vICAgICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IHRydWU7CiAgICAvLyAgICAgICAgIGF4aW9zCiAgICAvLyAgICAgICAgICAgLnBvc3QoCiAgICAvLyAgICAgICAgICAgICBhcGlfY2FsbHMucHJvZHVjdF9zZXR0aW5ncygpLAogICAgLy8gICAgICAgICAgICAgewogICAgLy8gICAgICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAvLyAgICAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgLy8gICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgLy8gICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgLy8gICAgICAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgIC8vICAgICAgICAgICAgICAgaXNfZW1haWw6IHRydWUsCiAgICAvLyAgICAgICAgICAgICAgIGVtYWlsX2lkOiB0aGlzLmVtYWlsX2RldGFpbHMKICAgIC8vICAgICAgICAgICAgIH0sCiAgICAvLyAgICAgICAgICAgICB7CiAgICAvLyAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgIC8vICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YAogICAgLy8gICAgICAgICAgICAgICB9CiAgICAvLyAgICAgICAgICAgICB9CiAgICAvLyAgICAgICAgICAgKQogICAgLy8gICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgIC8vICAgICAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgIT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuU1VDQ0VTU0ZVTF9EQl9RVUVSWS5NU0dfQ09ERSkgewogICAgLy8gICAgICAgICAgICAgICBzd2FsKHsKICAgIC8vICAgICAgICAgICAgICAgICB0ZXh0OgogICAgLy8gICAgICAgICAgICAgICAgICAgdGhpcy50bHQoJ290aGVyX2VtYWlsX3NlbmRfdG9fbXNnJykgKwogICAgLy8gICAgICAgICAgICAgICAgICAgIiAiICsKICAgIC8vICAgICAgICAgICAgICAgICAgIHRoaXMudGx0KCdvdGhlcl91c2VyX2VtYWlsX2RldGFpbHNfbXNnJykgKwogICAgLy8gICAgICAgICAgICAgICAgICAgdGhpcy50bHQoJ290aGVyX2NoZWNrX3lvdXJfZW1haWxfbXNnJyksCiAgICAvLyAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgLy8gICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgnb3RoZXJfc3VjY2Vzc19zd2FsX2J0bjEnKSwKICAgIC8vICAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgYWxsb3dFc2NhcGVLZXk6IGZhbHNlCiAgICAvLyAgICAgICAgICAgICAgIH0pOwogICAgLy8gICAgICAgICAgICAgICB0aGlzLmVtYWlsX2Rpc2FibGUgPSB0cnVlOwogICAgLy8gICAgICAgICAgICAgICB0aGlzLmVtYWlsX3ZlcmlmaWNhdGlvbl9zdGF0dXMoKTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy5sb2FkX3Byb2R1Y3Rfc2V0dGluZ3MoKTsKICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAvLyAgICAgICAgICAgICAgIHN3YWwoewogICAgLy8gICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAvLyAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgIC8vICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAvLyAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgLy8gICAgICAgICAgICAgICB9KTsKICAgIC8vICAgICAgICAgICAgIH0KICAgIC8vICAgICAgICAgICB9KQogICAgLy8gICAgICAgICAgIC5jYXRjaChlID0+IHsKICAgIC8vICAgICAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgIHRvYXN0ci5lcnJvcih0aGlzLnRsdCgnb3RoZXJfZXJyb3Jfb2NjdXJfbXNnJykpOwogICAgLy8gICAgICAgICAgICAgaWYgKAogICAgLy8gICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwKICAgIC8vICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgLy8gICAgICAgICAgICAgKSB7CiAgICAvLyAgICAgICAgICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAvLyAgICAgICAgICAgICB9CiAgICAvLyAgICAgICAgICAgfSk7CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgfSk7CiAgICAvLyAgIH1lbHNlIGlmICh2YWx1ZSA9PSAiZW1haWxfcmVtb3ZlIikgewogICAgLy8gICAgIFN3YWwuZmlyZSh7CiAgICAvLyAgICAgICB0aXRsZTogdGhpcy50bHQoJ290aGVyX3N3YWxfYWxlcnRfbXNnMScpLAogICAgLy8gICAgICAgdGV4dDoKICAgIC8vICAgICAgICAgdGhpcy50bHQoJ290aGVyX3JlbW92ZWRfc2F2ZWRfZW1haWxfbXNnJyksCiAgICAvLyAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgLy8gICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgIC8vICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgLy8gICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgIC8vICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiB0aGlzLnRsdCgnb3RoZXJfc3dhbF9yZW1vdmVfbXNnJykKICAgIC8vICAgICB9KS50aGVuKHJlc3VsdCA9PiB7CiAgICAvLyAgICAgICBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAvLyAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgLy8gICAgICAgICBheGlvcwogICAgLy8gICAgICAgICAgIC5wb3N0KAogICAgLy8gICAgICAgICAgICAgYXBpX2NhbGxzLnByb2R1Y3Rfc2V0dGluZ3MoKSwKICAgIC8vICAgICAgICAgICAgIHsKICAgIC8vICAgICAgICAgICAgICAgY29tcGFueV9uYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgLy8gICAgICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgIC8vICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgIC8vICAgICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgIC8vICAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAvLyAgICAgICAgICAgICAgIGlzX3JlbW92ZV9lbWFpbDogdHJ1ZSwKICAgIC8vICAgICAgICAgICAgICAgZW1haWxfaWQ6IHRoaXMuZW1haWxfZGV0YWlscwogICAgLy8gICAgICAgICAgICAgfSwKICAgIC8vICAgICAgICAgICAgIHsKICAgIC8vICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgLy8gICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gCiAgICAvLyAgICAgICAgICAgICAgIH0KICAgIC8vICAgICAgICAgICAgIH0KICAgIC8vICAgICAgICAgICApCiAgICAvLyAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgLy8gICAgICAgICAgICAgdGhpcy5iaWdfc3Bpbm5lciA9IGZhbHNlOwogICAgLy8gICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSAhPSB0aGlzLmFwaV9zdGF0dXNfY29kZS5TVUNDRVNTRlVMX0RCX1FVRVJZLk1TR19DT0RFKSB7CiAgICAvLyAgICAgICAgICAgICAgIHN3YWwoewogICAgLy8gICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMudGx0KCdvdGhlcl9lbWFpbF9yZW1vdmVkX3N3YWxfbXNnJyksCiAgICAvLyAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgLy8gICAgICAgICAgICAgICAgIHRpbWVyOiA1MDAwLAogICAgLy8gICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRsdCgnb3RoZXJfc3VjY2Vzc19zd2FsX2J0bjInKQogICAgLy8gICAgICAgICAgICAgICB9KTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy5lbWFpbF9kaXNhYmxlID0gZmFsc2U7CiAgICAvLyAgICAgICAgICAgICAgIHRoaXMuZW1haWxfZGV0YWlscyA9IG51bGw7CiAgICAvLyAgICAgICAgICAgICAgIHRoaXMuZW1wdHlfdmFyaWFibGUoKTsKICAgIC8vICAgICAgICAgICAgICAgdGhpcy5sb2FkX3Byb2R1Y3Rfc2V0dGluZ3MoKTsKICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAvLyAgICAgICAgICAgICAgIHN3YWwoewogICAgLy8gICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAvLyAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgIC8vICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgIC8vICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAvLyAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgLy8gICAgICAgICAgICAgICB9KTsKICAgIC8vICAgICAgICAgICAgIH0KICAgIC8vICAgICAgICAgICB9KQogICAgLy8gICAgICAgICAgIC5jYXRjaChlID0+IHsKICAgIC8vICAgICAgICAgICAgIHRoaXMuYmlnX3NwaW5uZXIgPSBmYWxzZTsKICAgIC8vICAgICAgICAgICAgIHRvYXN0ci5lcnJvcih0aGlzLnRsdCgnb3RoZXJfZXJyb3Jfb2NjdXJfbXNnMicpKTsKICAgIC8vICAgICAgICAgICAgIGlmICgKICAgIC8vICAgICAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgLy8gICAgICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8CiAgICAvLyAgICAgICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICAgICAgICkgewogICAgLy8gICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgLy8gICAgICAgICAgICAgfQogICAgLy8gICAgICAgICAgIH0pOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0pOwogICAgLy8gICB9IAogICAgLy8gfSwKICAgIC8vIGVtYWlsX3ZlcmlmaWNhdGlvbl9zdGF0dXMoKSB7CiAgICAvLyAgIGlmICh0aGlzLmVtYWlsX2RldGFpbHMgIT0gbnVsbCAmJiB0aGlzLmVtYWlsX2RldGFpbHMgIT0gIiIpIHsKICAgIC8vICAgICB0aGlzLmVtYWlsX2Rpc2FibGUgPSB0cnVlOwogICAgLy8gICAgIHRoaXMuYmlnX3NwaW5uZXIgPSB0cnVlOwogICAgLy8gICAgIGF4aW9zCiAgICAvLyAgICAgICAucG9zdCgKICAgIC8vICAgICAgICAgYXBpX2NhbGxzLnByb2R1Y3Rfc2V0dGluZ3MoKSwKICAgIC8vICAgICAgICAgewogICAgLy8gICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgIC8vICAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgIC8vICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgLy8gICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAvLyAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAvLyAgICAgICAgICAgaXNfZW1haWxfdmVyaWZpY2F0aW9uX3N0YXR1czogdHJ1ZSwKICAgIC8vICAgICAgICAgICBlbWFpbF9pZDogdGhpcy5lbWFpbF9kZXRhaWxzCiAgICAvLyAgICAgICAgIH0sCiAgICAvLyAgICAgICAgIHsKICAgIC8vICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAvLyAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy4kc2Vzc2lvbi5nZXQoImF0Iil9YAogICAgLy8gICAgICAgICAgIH0KICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgKQogICAgLy8gICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgLy8gICAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7CiAgICAvLyAgICAgICAgIGlmICgKICAgIC8vICAgICAgICAgICByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgIT0gdGhpcy5hcGlfc3RhdHVzX2NvZGUuSU5URVJOQUxfU0VSVkVSX0VSUk9SLk1TR19DT0RFICYmCiAgICAvLyAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFICE9IHRoaXMuYXBpX3N0YXR1c19jb2RlLk5PX0RBVEFfQVZBSUxBQkxFLk1TR19DT0RFCiAgICAvLyAgICAgICAgICkgewogICAgLy8gICAgICAgICAgIHZhciBzdGF0dXMgPSByZXNwb25zZS5kYXRhLmRhdGEudmVyaWZpY2F0aW9uX3N0YXR1czsKICAgIC8vICAgICAgICAgICB0aGlzLnZlcmlmaWNhdGlvbl9zdGF0dXMgPQogICAgLy8gICAgICAgICAgICAgc3RhdHVzID09ICJTdWNjZXNzIgogICAgLy8gICAgICAgICAgICAgICA/ICJTdWNjZXNzIgogICAgLy8gICAgICAgICAgICAgICA6IHN0YXR1cyA9PSAiUGVuZGluZyIKICAgIC8vICAgICAgICAgICAgICAgPyB0aGlzLnRsdCgnb3RoZXJfcGVuZGluZ192ZXJpZnlfZW1haWxfbXNnJykKICAgIC8vICAgICAgICAgICAgICAgOiBzdGF0dXMgKwogICAgLy8gICAgICAgICAgICAgICAgIHRoaXMudGx0KCdvdGhlcl9saW5rX2V4cGlyZWRfbXNnJyk7CiAgICAvLyAgICAgICAgIH1lbHNlIHsKICAgIC8vICAgICAgICAgICBTd2FsKHsKICAgIC8vICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAvLyAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgLy8gICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAvLyAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgIC8vICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgIC8vICAgICAgICAgICB9KQogICAgLy8gICAgICAgICB9CiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgLmNhdGNoKGUgPT4gewogICAgLy8gICAgICAgICB0aGlzLmJpZ19zcGlubmVyID0gZmFsc2U7CiAgICAvLyAgICAgICAgIGlmICgKICAgIC8vICAgICAgICAgICBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8CiAgICAvLyAgICAgICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgLy8gICAgICAgICAgIGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkKICAgIC8vICAgICAgICAgKSB7CiAgICAvLyAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgfSk7CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICB0b3BfbmF2YmFyX2Rpc2FibGU6IGZ1bmN0aW9uIHRvcF9uYXZiYXJfZGlzYWJsZSgpIHsKICAgICAgaWYgKHRoaXMuZGlzYWJsZV9zaWRlYmFyID09PSB0cnVlKSB7CiAgICAgICAgcmV0dXJuICdwb2ludGVyLWV2ZW50czpub25lOyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},null]}