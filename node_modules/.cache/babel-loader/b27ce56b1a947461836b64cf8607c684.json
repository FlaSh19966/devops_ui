{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Data Inputs/AddTasks.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/Data Inputs/AddTasks.vue","mtime":1643027096168},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IFN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgeyBzZXRUaW1lb3V0IH0gZnJvbSAidGltZXJzIjsKaW1wb3J0IGFwaV9jYWxscyBmcm9tICJAL3BvcnRhbC9hcGlfY2FsbHMiOwppbXBvcnQgTXVsdGlzZWxlY3QgZnJvbSAidnVlLW11bHRpc2VsZWN0IjsKaW1wb3J0IHsgdHNPYmplY3RLZXl3b3JkIH0gZnJvbSAiQGJhYmVsL3R5cGVzIjsKaW1wb3J0IHsgZnJlZXplX3BvcnRhbCwgc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsIH0gZnJvbSAiQC9wb3J0YWwvbWl4aW5zIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBZGRUYXNrUGFnZSIsCiAgbWl4aW5zOiBbZnJlZXplX3BvcnRhbCwgc2hvd19zdWJzY3JpcHRpb25fZXhwaXJlZF9zd2FsXSwKICBjb21wb25lbnRzOiB7CiAgICBNdWx0aXNlbGVjdDogTXVsdGlzZWxlY3QKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpbnB1dF9saXN0OiB7CiAgICAgICAgdGFza19uYW1lOiAiIiwKICAgICAgICBpbnRlbnQ6ICIiLAogICAgICAgIGZpZWxkczogW10sCiAgICAgICAgcXVlc3Rpb246ICIiLAogICAgICAgIHF1ZXN0aW9uX2lkOiAiIgogICAgICB9LAogICAgICB0b3RhbF9wYWdlczogMSwKICAgICAgcGVyX3BhZ2U6IDEwLAogICAgICBwYWdlX25vOiAxLAogICAgICBxdWVzdGlvbl90ZXh0OiBmYWxzZSwKICAgICAgcXVlc3Rpb25fZW50ZXJlZDogIiIsCiAgICAgIGludGVudGxpc3Q6IFtdLAogICAgICB0YXNrX2xpc3Q6IFtdLAogICAgICBvcmlnaW5hbF9pbnRlbnRfbGlzdDogW10sCiAgICAgIGNoZWNrZWRfbGlzdDogW10sCiAgICAgIGlzRWRpdDogZmFsc2UsCiAgICAgIHF1ZXN0aW9uc19saXN0OiBbXSwKICAgICAgLy8gaGFyc2gKICAgICAgc2VhcmNoX25hbWU6ICIiLAogICAgICBwYWdlX2FycmF5OiBbXSwKICAgICAgdGFza190eXBlOiAiRGVmYXVsdCIsCiAgICAgIHRhc2tfdHlwZXM6IFsiRW1haWwiLCAiU01TIiwgIkRlZmF1bHQiXSwKICAgICAgZW1haWxfdG9fdXNlcjogdHJ1ZSwKICAgICAgYWRkX2N1c3RvbXNfZW1haWw6IHRydWUsCiAgICAgIG5ld19jdXN0b21fZW1haWw6IG51bGwsCiAgICAgIGN1c3RvbV9lbWFpbHM6IFtdLAogICAgICBlbWFpbF90aXRsZTogbnVsbCwKICAgICAgZW1haWxfYm9keTogbnVsbCwKICAgICAgZW1haWxfdmFyaWFibGVzOiBbXSwKICAgICAgc21zX3RvX3VzZXI6IHRydWUsCiAgICAgIGFkZF9jdXN0b21zX251bWJlcjogdHJ1ZSwKICAgICAgbmV3X2N1c3RvbV9udW1iZXI6IG51bGwsCiAgICAgIGN1c3RvbV9udW1iZXI6IFtdLAogICAgICBzbXNfYm9keTogbnVsbCwKICAgICAgc21zX3ZhcmlibGVzOiBbXSwKICAgICAgc2VsZWN0ZWRfdGFzazogbnVsbCwKICAgICAgc3Bpbm5lck9uOiBmYWxzZSwKICAgICAgaXNWaXNpYmxlU2VhcmNoQ2xlYXI6IGZhbHNlLAogICAgICBkaXNhYmxlX2J0bl9leHBpcmVkOiBmYWxzZSwKICAgICAgLy8gLS0tLQogICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIiA/IHRoaXMuJHNlc3Npb24uZ2V0KCJDb21wYW55SWQiKSA6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICBjb21wYW55bmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnJvbGUgPT0gIlN1cGVyQWRtaW4iID8gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIikgOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9uYW1lLAogICAgICB2YXJpYWJsZTogInt7bmFtZX19IiwKICAgICAgcHJldmlldzogZmFsc2UsCiAgICAgIGRlbGV0ZV90YXNrX2lkczogW10sCiAgICAgIGJvZHlfY29udGVudDogIkhpIHt7bmFtZX19LFxuICAgICAgICBZb3UgYXJlIHJlY2VpdmluZyB0aGlzIGVtYWlsIGJlY2F1c2UgeW91IChvciBzb21lb25lIGVsc2UpIGhhdmUgcmVxdWVzdGVkIHRvIHJlc2V0IHRoZSBwYXNzd29yZCBvZiB7e25hbWV9fSBhY2NvdW50LlxuICAgICAgICBQbGVhc2UgY2xpY2sgb24gdGhlIGZvbGxvd2luZyBsaW5rLCBvciBwYXN0ZSB0aGlzIGludG8geW91ciBicm93c2VyIHRvIGNvbXBsZXRlIHRoZSBwcm9jZXNzOlxuICAgICAgICBodHRwczovL2NlbnNlLmFpL2NoYW5nZS1wYXNzd29yZFxuICAgICAgICBJZiB5b3UgZGlkIG5vdCByZXF1ZXN0IHRoaXMsIHBsZWFzZSBpZ25vcmUgdGhpcyBlbWFpbCBhbmQgeW91ciBwYXNzd29yZCB3aWxsIHJlbWFpbiB1bmNoYW5nZWQuXG5cbiAgICAgICAgUmVnYXJkcyxcbiAgICAgICAgQWRtaW4iCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMubG9hZF90YXNrKCk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuZnJlZXplX3BvcnRhbCgpOwogICAgfSwgMTAwMCk7CiAgICB0aGlzLiRyb290LiRvbigiTmVyVHJhaW5pbmdQYWdlRGlzYWJsZWQiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICBpZiAoZGF0YSA9PT0gdHJ1ZSkgewogICAgICAgIF90aGlzLmRpc2FibGVfYnRuX2V4cGlyZWQgPSB0cnVlOwogICAgICB9CiAgICB9KTsKICAgIHZhciB2bSA9IHRoaXM7CiAgICAkKCIjdGFza21vZGFsIikub24oImhpZGRlbi5icy5tb2RhbCIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZtLmNsZWFyX2ZpZWxkcygpOwogICAgfSk7CiAgICAkKCIjc2VsZWN0YWxsIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICBpZiAoJCh0aGlzKS5pcygiOmNoZWNrZWQiKSkgewogICAgICAgIC8vICQoJ2RpdjppbnB1dCcpLnByb3AoJ2NoZWNrZWQnLHRydWUpOwogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIHRydWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHZtLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKICAgICAgfQogICAgfSk7CiAgfSwKICB3YXRjaDogewogICAgc2VhcmNoX25hbWU6IGZ1bmN0aW9uIHNlYXJjaF9uYW1lKCkgewogICAgICBpZiAodGhpcy5zZWFyY2hfbmFtZSA9PT0gIiIpIHsKICAgICAgICB0aGlzLmxvYWRfdGFzaygpOwogICAgICAgIHRoaXMuaXNWaXNpYmxlU2VhcmNoQ2xlYXIgPSBmYWxzZTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnNlYXJjaF9uYW1lICE9PSAiIikgewogICAgICAgIHRoaXMuaXNWaXNpYmxlU2VhcmNoQ2xlYXIgPSB0cnVlOwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhZGRfdGFzazogZnVuY3Rpb24gYWRkX3Rhc2soKSB7CiAgICAgIGlmICghdGhpcy5kaXNhYmxlX2J0bl9leHBpcmVkKSB7CiAgICAgICAgJCgiI3Rhc2ttb2RhbCIpLm1vZGFsKCdzaG93Jyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zaG93X3N1YnNjcmlwdGlvbl9leHBpcmVkX3N3YWwoKTsKICAgICAgfQogICAgfSwKICAgIGNsZWFyX3NlYXJjaF9uYW1lOiBmdW5jdGlvbiBjbGVhcl9zZWFyY2hfbmFtZSgpIHsKICAgICAgdGhpcy5zZWFyY2hfbmFtZSA9ICIiOwogICAgfSwKICAgIGxvYWRfdGFzazogZnVuY3Rpb24gbG9hZF90YXNrKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICghdGhpcy4kc2Vzc2lvbi5oYXMoIkNvbXBhbnlJZCIpICYmIHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5yb2xlID09ICJTdXBlckFkbWluIikgewogICAgICAgIHRvYXN0ci53YXJuaW5nKCJQbGVhc2Ugc2VsZWN0IGEgY29tcGFueSBuYW1lIGZyb20gdGhlIGRyb3Bkb3duIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgfQoKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuc2hvd19pbnRlbnRfdXJsKCksIHsKICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICBnZXRfaW50ZW50czogdHJ1ZSwKICAgICAgICBzaG93aW50ZW50OiAiVHJ1ZSIKICAgICAgfSwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIC8vIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YSkgewogICAgICAgIC8vICAgdGhpcy5pbnRlbnRsaXN0LnB1c2goCiAgICAgICAgLy8gICAgIHJlc3BvbnNlLmRhdGFbaV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpCiAgICAgICAgLy8gICApOwogICAgICAgIC8vIH0KICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIF90aGlzMi5pbnRlbnRsaXN0LnB1c2gocmVzcG9uc2UuZGF0YVtpXSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgX3RoaXMyLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLm9wZW5fZm9ybV90YXNrcygpLCB7CiAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgaXNTaG93OiB0cnVlLAogICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubwogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coIk1BaU4gTElTVCIsIHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0KTsKICAgICAgICBfdGhpczIudGFza19saXN0ID0gW107CgogICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3QpIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrVHlwZSA9PSAiZGVmYXVsdCIpIHsKICAgICAgICAgICAgdmFyIGRlc2MgPSBbXTsKCiAgICAgICAgICAgIGZvciAodmFyIGogaW4gcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uVXR0ZXJhbmNlcykgewogICAgICAgICAgICAgIGRlc2MucHVzaCh7CiAgICAgICAgICAgICAgICBRdWVzdGlvbklkOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5VdHRlcmFuY2VzW2pdLlNsb3ROYW1lLAogICAgICAgICAgICAgICAgVGV4dDogcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uVXR0ZXJhbmNlc1tqXS5UZXh0CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChkZXNjLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgICAgICAgX3RoaXMyLnRhc2tfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIEludGVudDogcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uSW50ZW50LAogICAgICAgICAgICAgICAgVGFza05hbWU6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tOYW1lLAogICAgICAgICAgICAgICAgVGFza19EZXNjcmlwdGlvbjogZGVzYywKICAgICAgICAgICAgICAgIFRhc2tfSWQ6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tJRCwKICAgICAgICAgICAgICAgIFRhc2tfVHlwZTogcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uVGFza1R5cGUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrVHlwZSA9PSAiRW1haWwiKSB7CiAgICAgICAgICAgIF90aGlzMi50YXNrX2xpc3QucHVzaCh7CiAgICAgICAgICAgICAgSW50ZW50OiAiTm9uZSIsCiAgICAgICAgICAgICAgLy8gSW50ZW50OiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5JbnRlbnQsCiAgICAgICAgICAgICAgVGFza05hbWU6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tOYW1lLAogICAgICAgICAgICAgIFRhc2tfRGVzY3JpcHRpb246IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tEZXRhaWxzLAogICAgICAgICAgICAgIFRhc2tfSWQ6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tJRCwKICAgICAgICAgICAgICBUYXNrX1R5cGU6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tUeXBlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrVHlwZSA9PSAiU01TIikgewogICAgICAgICAgICBfdGhpczIudGFza19saXN0LnB1c2goewogICAgICAgICAgICAgIEludGVudDogIk5vbmUiLAogICAgICAgICAgICAgIC8vIEludGVudDogcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uSW50ZW50LAogICAgICAgICAgICAgIFRhc2tOYW1lOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrTmFtZSwKICAgICAgICAgICAgICBUYXNrX0Rlc2NyaXB0aW9uOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrRGV0YWlscywKICAgICAgICAgICAgICBUYXNrX0lkOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrSUQsCiAgICAgICAgICAgICAgVGFza19UeXBlOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrVHlwZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0pIHsKICAgICAgICAgICAgdmFyIF9kZXNjID0gW107CgogICAgICAgICAgICBmb3IgKHZhciBqIGluIHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlV0dGVyYW5jZXMpIHsKICAgICAgICAgICAgICBfZGVzYy5wdXNoKHsKICAgICAgICAgICAgICAgIFF1ZXN0aW9uSWQ6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlV0dGVyYW5jZXNbal0uU2xvdE5hbWUsCiAgICAgICAgICAgICAgICBUZXh0OiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5VdHRlcmFuY2VzW2pdLlRleHQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKF9kZXNjLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgICAgICAgX3RoaXMyLnRhc2tfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIEludGVudDogcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uSW50ZW50LAogICAgICAgICAgICAgICAgVGFza05hbWU6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tOYW1lLAogICAgICAgICAgICAgICAgVGFza19EZXNjcmlwdGlvbjogX2Rlc2MsCiAgICAgICAgICAgICAgICBUYXNrX0lkOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrSUQsCiAgICAgICAgICAgICAgICBUYXNrX1R5cGU6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tUeXBlCiAgICAgICAgICAgICAgfSk7IC8vIGNvbnNvbGUubG9nKCJ0YXNrIGlkIik7CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uVGFza0lEKQoKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgX3RoaXMyLm9yaWdpbmFsX2ludGVudF9saXN0ID0gX3RoaXMyLnRhc2tfbGlzdDsgLy8gY29uc29sZS5sb2codGhpcy5vcmlnaW5hbF9pbnRlbnRfbGlzdCk7CiAgICAgICAgLy8gZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdCkgewogICAgICAgIC8vICAgbGV0IGRlc2MgPSBbXTsKICAgICAgICAvLyAgIGZvciAodmFyIGogaW4gcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uVXR0ZXJhbmNlcykgewogICAgICAgIC8vICAgICBkZXNjLnB1c2goewogICAgICAgIC8vICAgICAgIFRleHQ6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlV0dGVyYW5jZXNbal0uVGV4dAogICAgICAgIC8vICAgICB9KTsKICAgICAgICAvLyAgIH0KICAgICAgICAvLyAgIGlmIChkZXNjLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgLy8gICAgIHRoaXMudGFza19saXN0LnB1c2goewogICAgICAgIC8vICAgICAgIEludGVudDogcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uSW50ZW50LAogICAgICAgIC8vICAgICAgIFRhc2tOYW1lOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrTmFtZSwKICAgICAgICAvLyAgICAgICBUYXNrX0Rlc2NyaXB0aW9uOiBkZXNjLAogICAgICAgIC8vICAgICAgIFRhc2tfSWQ6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tJRCwKICAgICAgICAvLyAgICAgICBUYXNrX1R5cGU6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tUeXBlLAogICAgICAgIC8vICAgICB9KTsKICAgICAgICAvLyAgIH0KICAgICAgICAvLyB9CgogICAgICAgIF90aGlzMi50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnZWNvdW50OwoKICAgICAgICBfdGhpczIuc2V0cGFnaW5hdGlvbihfdGhpczIucGFnZV9ubyk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczIuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBhZGRfcXVlc3Rpb246IGZ1bmN0aW9uIGFkZF9xdWVzdGlvbih0eXBlLCBpbmRleCkgewogICAgICBpZiAodHlwZSA9PSAiYWRkIikgewogICAgICAgIGlmICh0aGlzLmlzRWRpdCA9PSB0cnVlKSB7CiAgICAgICAgICB2YXIgY291bnQgPSB0aGlzLnF1ZXN0aW9uc19saXN0Lmxlbmd0aCArIDI7CiAgICAgICAgICB0aGlzLnF1ZXN0aW9uc19saXN0LnB1c2goewogICAgICAgICAgICBUZXh0OiAiIiwKICAgICAgICAgICAgUXVlc3Rpb25JZDogIlF1ZXN0aW9uX051bWJlcl8iICsgY291bnQgKyAiXyIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKQogICAgICAgICAgfSk7CiAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5xdWVzdGlvbnNfbGlzdC5wdXNoKHsKICAgICAgICAgICAgVGV4dDogIiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0eXBlID09ICJyZW1vdmUiKSB7CiAgICAgICAgdGhpcy5xdWVzdGlvbnNfbGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CiAgICB9LAogICAgYWRkX2VtYWlsOiBmdW5jdGlvbiBhZGRfZW1haWwodHlwZSwgaW5kZXgpIHsKICAgICAgaWYgKHR5cGUgPT0gImFkZCIpIHsKICAgICAgICB0aGlzLmN1c3RvbV9lbWFpbHMucHVzaCh0aGlzLm5ld19jdXN0b21fZW1haWwpOwogICAgICAgIHRoaXMubmV3X2N1c3RvbV9lbWFpbCA9IG51bGw7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAicmVtb3ZlIikgewogICAgICAgIHRoaXMuY3VzdG9tX2VtYWlscy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CiAgICB9LAogICAgYWRkX251bWJlcjogZnVuY3Rpb24gYWRkX251bWJlcih0eXBlLCBpbmRleCkgewogICAgICBpZiAodHlwZSA9PSAiYWRkIiAmJiBldmVudC5rZXlDb2RlID09PSAxMykgewogICAgICAgIHRoaXMuY3VzdG9tX251bWJlci5wdXNoKHRoaXMubmV3X2N1c3RvbV9udW1iZXIpOwogICAgICAgIHRoaXMubmV3X2N1c3RvbV9udW1iZXIgPSBudWxsOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gInJlbW92ZSIpIHsKICAgICAgICB0aGlzLmN1c3RvbV9udW1iZXIuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQogICAgfSwKICAgIGludGVudF9zZWxlY3RlZF9hcGk6IGZ1bmN0aW9uIGludGVudF9zZWxlY3RlZF9hcGkoKSB7fSwKICAgIGVkaXRfbW9kYWw6IGZ1bmN0aW9uIGVkaXRfbW9kYWwoKSB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuc2VsZWN0ZWRfdGFzazsKICAgICAgdGhpcy5pc0VkaXQgPSB0cnVlOwogICAgICB0aGlzLnByZXZpZXcgPSBmYWxzZTsgLy8gdGhpcy50YXNrX3R5cGUgPSBCb29sZWFuKHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX1R5cGUpCiAgICAgIC8vICAgPyB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19UeXBlCiAgICAgIC8vICAgOiAiRGVmYXVsdCIKICAgICAgLy8gdGhpcy5pbnB1dF9saXN0LmludGVudCA9IHRoaXMudGFza19saXN0W2luZGV4XS5JbnRlbnQ7CiAgICAgIC8vIHRoaXMuaW5wdXRfbGlzdC50YXNrX25hbWUgPSB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza05hbWU7CiAgICAgIC8vIHRoaXMuaW5wdXRfbGlzdC5xdWVzdGlvbiA9IHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uWzBdLlRleHQ7CiAgICAgIC8vIHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uLnNwbGljZSgwLCAxKTsKICAgICAgLy8gZm9yICh2YXIgaiBpbiB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbikgewogICAgICAvLyAgIHRoaXMucXVlc3Rpb25zX2xpc3QucHVzaCh0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbltqXSk7CiAgICAgIC8vIH0KICAgIH0sCiAgICBzZWxlY3RlZF90YXNrczogZnVuY3Rpb24gc2VsZWN0ZWRfdGFza3MoaW5kZXgpIHsKICAgICAgaWYgKGluZGV4ID09ICJhbGwiKSB7CiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IHRoaXMudGFza19saXN0OwogICAgICAgIH0gZWxzZSBpZiAoIWV2ZW50LnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdCA9IFtdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNoZWNrZWQgPT0gdHJ1ZSkgewogICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QucHVzaChpbmRleCk7CiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCA9PSBmYWxzZSkgewogICAgICAgICAgdmFyIHZhbF9pbmRleCA9IHRoaXMuY2hlY2tlZF9saXN0LmluZGV4T2YoaW5kZXgpOwogICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3Quc3BsaWNlKHZhbF9pbmRleCwgMSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYWRkX2VkaXRfdGFza3M6IGZ1bmN0aW9uIGFkZF9lZGl0X3Rhc2tzKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnRhc2tfdHlwZSA9PSAiRGVmYXVsdCIpIHsKICAgICAgICB2YXIgZW1wdHlfcXVlc3Rpb25zID0gdGhpcy5xdWVzdGlvbnNfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKHF1ZXN0aW9uKSB7CiAgICAgICAgICByZXR1cm4gcXVlc3Rpb24uVGV4dCA9PSAiIjsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKHRoaXMuZW1wdHlfZmllbGRzX2NoZWNrKCkgJiYgKHRoaXMucXVlc3Rpb25zX2xpc3QubGVuZ3RoID09IDAgfHwgZW1wdHlfcXVlc3Rpb25zLmxlbmd0aCA9PSAwKSkgewogICAgICAgICAgLy8gdGhpcy5pbnB1dF9saXN0LmZpZWxkcy5wdXNoKHsKICAgICAgICAgIC8vICAgVGV4dDogdGhpcy5pbnB1dF9saXN0LnF1ZXN0aW9uCiAgICAgICAgICAvLyB9KTsKICAgICAgICAgIC8vIGZvciAodmFyIGkgaW4gdGhpcy5xdWVzdGlvbnNfbGlzdCkgewogICAgICAgICAgLy8gICB0aGlzLmlucHV0X2xpc3QuZmllbGRzLnB1c2godGhpcy5xdWVzdGlvbnNfbGlzdFtpXSk7CiAgICAgICAgICAvLyB9CiAgICAgICAgICBpZiAodGhpcy5pc0VkaXQgPT0gdHJ1ZSkgewogICAgICAgICAgICB2YXIgZWRpdF9vYmplY3QgPSB7fTsKICAgICAgICAgICAgdmFyIGVkaXRfc2xvdF9tYXBwaW5nX2RhdGEgPSB7fTsKICAgICAgICAgICAgdmFyIGkgPSAxOwogICAgICAgICAgICB2YXIgdGFza3F1ZXN0aW9uID0gW107CiAgICAgICAgICAgIHRhc2txdWVzdGlvbi5wdXNoKHsKICAgICAgICAgICAgICBUeXBlOiAiQXNrIiwKICAgICAgICAgICAgICBUZXh0OiB0aGlzLmlucHV0X2xpc3QucXVlc3Rpb24KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGVkaXRfb2JqZWN0W3RoaXMuaW5wdXRfbGlzdC5xdWVzdGlvbl9pZF0gPSB0YXNrcXVlc3Rpb25bMF07CiAgICAgICAgICAgIGVkaXRfc2xvdF9tYXBwaW5nX2RhdGFbdGhpcy5pbnB1dF9saXN0LnF1ZXN0aW9uX2lkXSA9IHsKICAgICAgICAgICAgICBmcm9tX3RleHQ6IHRydWUsCiAgICAgICAgICAgICAgZnJvbV9lbnRpdHk6IGZhbHNlLAogICAgICAgICAgICAgIGludGVudDogdHJ1ZSwKICAgICAgICAgICAgICBub3RfaW50ZW50OiBmYWxzZQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgZm9yIChpID0gMjsgaSA8IHRoaXMucXVlc3Rpb25zX2xpc3QubGVuZ3RoICsgMjsgaSsrKSB7CiAgICAgICAgICAgICAgdGFza3F1ZXN0aW9uLnB1c2goewogICAgICAgICAgICAgICAgVHlwZTogIkFzayIsCiAgICAgICAgICAgICAgICBUZXh0OiB0aGlzLnF1ZXN0aW9uc19saXN0W2kgLSAyXS5UZXh0CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgZWRpdF9vYmplY3RbdGhpcy5xdWVzdGlvbnNfbGlzdFtpIC0gMl0uUXVlc3Rpb25JZF0gPSB0YXNrcXVlc3Rpb25baSAtIDFdOwogICAgICAgICAgICAgIGVkaXRfc2xvdF9tYXBwaW5nX2RhdGFbdGhpcy5xdWVzdGlvbnNfbGlzdFtpIC0gMl0uUXVlc3Rpb25JZF0gPSB7CiAgICAgICAgICAgICAgICBmcm9tX3RleHQ6IHRydWUsCiAgICAgICAgICAgICAgICBmcm9tX2VudGl0eTogZmFsc2UsCiAgICAgICAgICAgICAgICBpbnRlbnQ6IHRydWUsCiAgICAgICAgICAgICAgICBub3RfaW50ZW50OiBmYWxzZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0gLy8gY29uc29sZS5sb2coIlRoaXMgaXMgdGhlIEVESVQgb2JqZWN0IiwgZWRpdF9vYmplY3QpOwoKCiAgICAgICAgICAgIGF4aW9zLnB1dChhcGlfY2FsbHMudGFza19saXN0X3VybCgpLCB7CiAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgaW50ZW50OiB0aGlzLmlucHV0X2xpc3QuaW50ZW50LAogICAgICAgICAgICAgIHRhc2tfZGV0YWlsczogZWRpdF9vYmplY3QsCiAgICAgICAgICAgICAgdGFza19pZDogdGhpcy50YXNrX2xpc3RbdGhpcy5zZWxlY3RlZF90YXNrXS5UYXNrX0lkLAogICAgICAgICAgICAgIHRhc2tfdHlwZTogIkRlZmF1bHQiIC8vIHRhc2tfZGV0YWlsczogdGhpcy5pbnB1dF9saXN0LmZpZWxkcwoKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJUYXNrIEVkaXQiKSB7CiAgICAgICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICAgICAgdGV4dDogIlRoZSBzYXZlZCBjaGFuZ2VzIHdvdWxkIGJlIHJlZmxlY3RlZCBvbmNlIHRoZSBtb2RlbCBpcyB0cmFpbmVkLiIsCiAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgICB0aW1lcjogMzAwMAogICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczMubG9hZF90YXNrKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YSA9PSAiSW50ZXJuYWwgU2VydmVyIEVycm9yIikgewogICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICQoIiN0YXNrbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICAgICAgX3RoaXMzLiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNFZGl0ID09IGZhbHNlKSB7CiAgICAgICAgICAgIHZhciBvYmplY3QgPSB7fTsKICAgICAgICAgICAgdmFyIHNsb3RfbWFwcGluZ19kYXRhID0ge307CiAgICAgICAgICAgIHZhciBfaSA9IDE7CiAgICAgICAgICAgIHZhciB0YXNrcXVlc3Rpb24gPSBbXTsKICAgICAgICAgICAgdGFza3F1ZXN0aW9uLnB1c2goewogICAgICAgICAgICAgIFR5cGU6ICJBc2siLAogICAgICAgICAgICAgIFRleHQ6IHRoaXMuaW5wdXRfbGlzdC5xdWVzdGlvbgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIHVuaXF1ZV9rZXkgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICAgICAgb2JqZWN0WyJRdWVzdGlvbl9OdW1iZXJfMSIgKyAiXyIgKyB1bmlxdWVfa2V5XSA9IHRhc2txdWVzdGlvblswXTsKICAgICAgICAgICAgc2xvdF9tYXBwaW5nX2RhdGFbIlF1ZXN0aW9uX051bWJlcl8xIiArICJfIiArIHVuaXF1ZV9rZXldID0gewogICAgICAgICAgICAgIGZyb21fdGV4dDogdHJ1ZSwKICAgICAgICAgICAgICBmcm9tX2VudGl0eTogZmFsc2UsCiAgICAgICAgICAgICAgaW50ZW50OiB0cnVlLAogICAgICAgICAgICAgIG5vdF9pbnRlbnQ6IGZhbHNlCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBmb3IgKF9pID0gMjsgX2kgPCB0aGlzLnF1ZXN0aW9uc19saXN0Lmxlbmd0aCArIDI7IF9pKyspIHsKICAgICAgICAgICAgICB0YXNrcXVlc3Rpb24ucHVzaCh7CiAgICAgICAgICAgICAgICBUeXBlOiAiQXNrIiwKICAgICAgICAgICAgICAgIFRleHQ6IHRoaXMucXVlc3Rpb25zX2xpc3RbX2kgLSAyXS5UZXh0CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdmFyIHVuaXF1ZV9rZXlfMiA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgICAgICAgICAgIG9iamVjdFsiUXVlc3Rpb25fTnVtYmVyXyIgKyBfaSArICJfIiArIHVuaXF1ZV9rZXlfMl0gPSB0YXNrcXVlc3Rpb25bX2kgLSAxXTsKICAgICAgICAgICAgICBzbG90X21hcHBpbmdfZGF0YVsiUXVlc3Rpb25fTnVtYmVyXyIgKyBfaSArICJfIiArIHVuaXF1ZV9rZXlfMl0gPSB7CiAgICAgICAgICAgICAgICBmcm9tX3RleHQ6IHRydWUsCiAgICAgICAgICAgICAgICBmcm9tX2VudGl0eTogZmFsc2UsCiAgICAgICAgICAgICAgICBpbnRlbnQ6IHRydWUsCiAgICAgICAgICAgICAgICBub3RfaW50ZW50OiBmYWxzZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0gLy8gY29uc29sZS5sb2coIlRoaXMgaXMgdGhlIG9iamVjdCIsIG9iamVjdCk7CgoKICAgICAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMudGFza19saXN0X3VybCgpLCB7CiAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgaW50ZW50OiB0aGlzLmlucHV0X2xpc3QuaW50ZW50LAogICAgICAgICAgICAgIHRhc2tfZGV0YWlsczogb2JqZWN0LAogICAgICAgICAgICAgIC8vIHRhc2tfZGV0YWlsczogdGhpcy5pbnB1dF9saXN0LmZpZWxkcywKICAgICAgICAgICAgICBzbG90X21hcHBpbmdfZGF0YTogc2xvdF9tYXBwaW5nX2RhdGEsCiAgICAgICAgICAgICAgdGFza19uYW1lOiB0aGlzLmlucHV0X2xpc3QudGFza19uYW1lCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9PSAiVGFzayBBZGRlZCIpIHsKICAgICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCJZb3VyIHRhc2sgaGFzIGJlZW4gYWRkZWQgc3VjY2Vzc2Z1bGx5Iik7CiAgICAgICAgICAgICAgICAkKCIjdGFza21vZGFsIikubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICAgICAgX3RoaXMzLmxvYWRfdGFzaygpOwogICAgICAgICAgICAgICAgfSwgMjUwMCk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhID09ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKSB7CiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludGVybmFsIFNlcnZlciBFcnJvciIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgJCgiI3Rhc2ttb2RhbCIpLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgICBfdGhpczMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgYWxsIHRoZSByZXF1aXJlZCBmaWVsZHMuIik7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMudGFza190eXBlID09ICJFbWFpbCIpIHsKICAgICAgICB2YXIgb2JqZWN0ID0ge307CiAgICAgICAgdmFyIGFsbG9rID0gdHJ1ZTsKCiAgICAgICAgaWYgKHRoaXMuZW1haWxfdGl0bGUgPT0gbnVsbCB8fCB0aGlzLmVtYWlsX3RpdGxlID09ICIiIHx8IHRoaXMuZW1haWxfYm9keSA9PSBudWxsIHx8IHRoaXMuZW1haWxfYm9keSA9PSAiIikgewogICAgICAgICAgYWxsb2sgPSBmYWxzZTsKICAgICAgICB9IC8vIGlmKHRoaXMuYWRkX2N1c3RvbXNfZW1haWwmJnRoaXMuY3VzdG9tX2VtYWlscy5sZW5ndGg9PTApewogICAgICAgIC8vICAgYWxsb2sgPSBmYWxzZTsKICAgICAgICAvLyB9CgoKICAgICAgICBpZiAodGhpcy5pbnB1dF9saXN0LnRhc2tfbmFtZSA9PSAiIikgewogICAgICAgICAgYWxsb2sgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmVtYWlsX3ZhcmlhYmxlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCB0aGlzLmVtYWlsX3ZhcmlhYmxlcy5sZW5ndGg7IF9pMisrKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmVtYWlsX3ZhcmlhYmxlc1tfaTJdLnZhcmlhYmxlX2Rlc2NyaXB0aW9uID09ICIiIHx8IHRoaXMuZW1haWxfdmFyaWFibGVzW19pMl0udmFyaWFibGVfZGVzY3JpcHRpb24gPT0gbnVsbCB8fCB0aGlzLmVtYWlsX3ZhcmlhYmxlc1tfaTJdLnZhcmlhYmxlX2Rlc2NyaXB0aW9uID09ICIgIikgewogICAgICAgICAgICAgIGFsbG9rID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChhbGxvaykgewogICAgICAgICAgb2JqZWN0WyJzdWJqZWN0Il0gPSB0aGlzLmVtYWlsX3RpdGxlOwogICAgICAgICAgb2JqZWN0WyJib2R5Il0gPSB0aGlzLmVtYWlsX2JvZHk7CiAgICAgICAgICBvYmplY3RbInVzZXJfZW1haWwiXSA9IHRoaXMuZW1haWxfdG9fdXNlcjsKICAgICAgICAgIG9iamVjdFsiY3VzdG9tX2VtYWlscyJdID0gdGhpcy5jdXN0b21fZW1haWxzOwogICAgICAgICAgb2JqZWN0WyJlbWFpbF92YXJpYWJsZXMiXSA9IHRoaXMuZW1haWxfdmFyaWFibGVzOwoKICAgICAgICAgIGlmICh0aGlzLmlzRWRpdCA9PSBmYWxzZSkgewogICAgICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5vcGVuX2Zvcm1fdGFza3MoKSwgewogICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgIGludGVudDogdGhpcy5pbnB1dF9saXN0LmludGVudCwKICAgICAgICAgICAgICB0YXNrX25hbWU6IHRoaXMuaW5wdXRfbGlzdC50YXNrX25hbWUsCiAgICAgICAgICAgICAgdGFza190eXBlOiAiRW1haWwiLAogICAgICAgICAgICAgIHRhc2tfZGV0YWlsczogb2JqZWN0CiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9ICJUYXNrIEFkZGVkIikgewogICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIllvdXIgdGFzayBoYXMgYmVlbiBhZGRlZCBzdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgICAgICQoIiN0YXNrbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgICBfdGhpczMubG9hZF90YXNrKCk7CiAgICAgICAgICAgICAgICB9LCAyNTAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgICBfdGhpczMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0VkaXQgPT0gdHJ1ZSkgewogICAgICAgICAgICBheGlvcy5wdXQoYXBpX2NhbGxzLm9wZW5fZm9ybV90YXNrcygpLCB7CiAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgaW50ZW50OiB0aGlzLmlucHV0X2xpc3QuaW50ZW50LAogICAgICAgICAgICAgIHRhc2tfbmFtZTogdGhpcy5pbnB1dF9saXN0LnRhc2tfbmFtZSwKICAgICAgICAgICAgICB0YXNrX3R5cGU6ICJFbWFpbCIsCiAgICAgICAgICAgICAgdGFza19kZXRhaWxzOiBvYmplY3QsCiAgICAgICAgICAgICAgdGFza19pZDogdGhpcy50YXNrX2xpc3RbdGhpcy5zZWxlY3RlZF90YXNrXS5UYXNrX0lkCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9ICJUYXNrIEVkaXQiKSB7CiAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiWW91ciB0YXNrIGhhcyBiZWVuIGVkaXRlZCBzdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgICAgICQoIiN0YXNrbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgICBfdGhpczMubG9hZF90YXNrKCk7CiAgICAgICAgICAgICAgICB9LCAyNTAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgICBfdGhpczMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgYWxsIHRoZSByZXF1aXJlZCBmaWVsZHMuIik7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMudGFza190eXBlID09ICJTTVMiKSB7CiAgICAgICAgdmFyIG9iamVjdCA9IHt9OwogICAgICAgIHZhciBhbGxvayA9IHRydWU7CgogICAgICAgIGlmICh0aGlzLnNtc19ib2R5ID09IG51bGwgfHwgdGhpcy5zbXNfYm9keSA9PSAiIikgewogICAgICAgICAgYWxsb2sgPSBmYWxzZTsKICAgICAgICB9IC8vIGlmKHRoaXMuYWRkX2N1c3RvbXNfbnVtYmVyJiZ0aGlzLmN1c3RvbV9udW1iZXIubGVuZ3RoPT0wKXsKICAgICAgICAvLyAgIGFsbG9rID0gZmFsc2U7CiAgICAgICAgLy8gfQoKCiAgICAgICAgaWYgKHRoaXMuaW5wdXRfbGlzdC50YXNrX25hbWUgPT0gIiIpIHsKICAgICAgICAgIGFsbG9rID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5zbXNfdmFyaWJsZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgdGhpcy5zbXNfdmFyaWJsZXMubGVuZ3RoOyBfaTMrKykgewogICAgICAgICAgICBpZiAodGhpcy5zbXNfdmFyaWJsZXNbX2kzXS52YXJpYWJsZV9kZXNjcmlwdGlvbiA9PSAiIiB8fCB0aGlzLnNtc192YXJpYmxlc1tfaTNdLnZhcmlhYmxlX2Rlc2NyaXB0aW9uID09IG51bGwgfHwgdGhpcy5zbXNfdmFyaWJsZXNbX2kzXS52YXJpYWJsZV9kZXNjcmlwdGlvbiA9PSAiICIpIHsKICAgICAgICAgICAgICBhbGxvayA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYWxsb2spIHsKICAgICAgICAgIG9iamVjdFsiYm9keSJdID0gdGhpcy5zbXNfYm9keTsKICAgICAgICAgIG9iamVjdFsidXNlcl9udW1iZXIiXSA9IHRoaXMuc21zX3RvX3VzZXI7CiAgICAgICAgICBvYmplY3RbImN1c3RvbV9udW1iZXJzIl0gPSB0aGlzLmN1c3RvbV9udW1iZXI7CiAgICAgICAgICBvYmplY3RbInNtc192YXJpYWJsZXMiXSA9IHRoaXMuc21zX3ZhcmlibGVzOwoKICAgICAgICAgIGlmICh0aGlzLmlzRWRpdCA9PSBmYWxzZSkgewogICAgICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5vcGVuX2Zvcm1fdGFza3MoKSwgewogICAgICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgICAgY29tcGFueW5hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICAgIHRhc2tfbmFtZTogdGhpcy5pbnB1dF9saXN0LnRhc2tfbmFtZSwKICAgICAgICAgICAgICB0YXNrX3R5cGU6ICJTTVMiLAogICAgICAgICAgICAgIHRhc2tfZGV0YWlsczogb2JqZWN0CiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9ICJUYXNrIEFkZGVkIikgewogICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIllvdXIgdGFzayBoYXMgYmVlbiBhZGRlZCBzdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgICAgICQoIiN0YXNrbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgICBfdGhpczMubG9hZF90YXNrKCk7CiAgICAgICAgICAgICAgICB9LCAyNTAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgICBfdGhpczMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0VkaXQgPT0gdHJ1ZSkgewogICAgICAgICAgICBheGlvcy5wdXQoYXBpX2NhbGxzLm9wZW5fZm9ybV90YXNrcygpLCB7CiAgICAgICAgICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgdGFza19uYW1lOiB0aGlzLmlucHV0X2xpc3QudGFza19uYW1lLAogICAgICAgICAgICAgIHRhc2tfdHlwZTogIlNNUyIsCiAgICAgICAgICAgICAgdGFza19kZXRhaWxzOiBvYmplY3QsCiAgICAgICAgICAgICAgdGFza19pZDogdGhpcy50YXNrX2xpc3RbdGhpcy5zZWxlY3RlZF90YXNrXS5UYXNrX0lkCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSA9ICJUYXNrIEVkaXQiKSB7CiAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygiWW91ciB0YXNrIGhhcyBiZWVuIGVkaXRlZCBzdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgICAgICQoIiN0YXNrbW9kYWwiKS5tb2RhbCgiaGlkZSIpOwogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgICAgICBfdGhpczMubG9hZF90YXNrKCk7CiAgICAgICAgICAgICAgICB9LCAyNTAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgICBfdGhpczMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVfc2VsZWN0ZWQ6IGZ1bmN0aW9uIGRlbGV0ZV9zZWxlY3RlZCgpIHsKICAgICAgaWYgKHRoaXMuY2hlY2tlZF9saXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgIHRpdGxlOiAiTm8gdGFzayBzZWxlY3RlZCEiLAogICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGltZXI6IDIwMDAKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmRlbGV0ZV90YXNrX2lkcyA9IFtdOwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2hlY2tlZF9saXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZGVsZXRlIHRhc2snKTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGkuVGFza19JZCk7CiAgICAgICAgICB0aGlzLmRlbGV0ZV90YXNrX2lkcy5wdXNoKHRoaXMudGFza19saXN0W3RoaXMuY2hlY2tlZF9saXN0W2ldXS5UYXNrX0lkKTsKICAgICAgICB9IC8vIGNvbnNvbGUubG9nKHRoaXMuZGVsZXRlX3Rhc2tfaWRzKTsKCgogICAgICAgIHRoaXMuZGVsZXRlX3Rhc2tzX2FwaSgpOyAvLyBsZXQgcXVlc3Rpb25saXN0ID0gW10sZGVsZXRlX3Rhc2tfaWRzCiAgICAgICAgLy8gICByZXNwb25zZWxpc3QgPSBbXSwKICAgICAgICAvLyAgIGludGVudGxpc3QgPSBbXSwKICAgICAgICAvLyAgIHNvdXJjZWxpc3QgPSBbXTsKICAgICAgICAvLyBmb3IgKHZhciBpIGluIHRoaXMuY2hlY2tlZF9saXN0KSB7CiAgICAgICAgLy8gICBxdWVzdGlvbmxpc3QucHVzaCh0aGlzLmNoZWNrZWRfbGlzdFtpXS5xdWVzdGlvbik7CiAgICAgICAgLy8gICByZXNwb25zZWxpc3QucHVzaCh0aGlzLmNoZWNrZWRfbGlzdFtpXS5yZXNwb25zZSk7CiAgICAgICAgLy8gICBzb3VyY2VsaXN0LnB1c2godGhpcy5jaGVja2VkX2xpc3RbaV0uc291cmNlKTsKICAgICAgICAvLyAgIGludGVudGxpc3QucHVzaCh0aGlzLmNoZWNrZWRfbGlzdFtpXS5pbnRlbnQpOwogICAgICAgIC8vIH0KICAgICAgICAvLyB0aGlzLmRlbGV0ZV90YXNrc19hcGkocXVlc3Rpb25saXN0LCByZXNwb25zZWxpc3QsIHNvdXJjZWxpc3QsIGludGVudGxpc3QpOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlX3NpbmdsZTogZnVuY3Rpb24gZGVsZXRlX3NpbmdsZShpbmRleCkgewogICAgICAvLyBsZXQgaW50ZW50cyA9IFtdOwogICAgICAvLyBpbnRlbnRzLnB1c2godGhpcy50YXNrX2xpc3RbaW5kZXhdLkludGVudCk7CiAgICAgIC8vIGNvbnNvbGUubG9nKGluZGV4KTsKICAgICAgdGhpcy5kZWxldGVfdGFza19pZHMgPSBbXTsKICAgICAgdGhpcy5kZWxldGVfdGFza19pZHMucHVzaCh0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19JZCk7IC8vIGNvbnNvbGUubG9nKHRoaXMuZGVsZXRlX3Rhc2tfaWRzKTsKCiAgICAgIHRoaXMuZGVsZXRlX3Rhc2tzX2FwaSgpOyAvLyBjb25zb2xlLmxvZygiZGVsZXRlIHNpbmdsZSIpCiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0lkKQogICAgfSwKICAgIGRlbGV0ZV90YXNrc19hcGk6IGZ1bmN0aW9uIGRlbGV0ZV90YXNrc19hcGkoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgU3dhbC5maXJlKHsKICAgICAgICB0aXRsZTogIkFyZSB5b3Ugc3VyZT8iLAogICAgICAgIHRleHQ6ICJZb3Ugd29uJ3QgYmUgYWJsZSB0byByZXZlcnQgdGhpcyEiLAogICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLAogICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI2QzMyIsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMsIGRlbGV0ZSBpdCEiCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgIF90aGlzNC5zcGlubmVyT24gPSB0cnVlOwogICAgICAgICAgYXhpb3MuZGVsZXRlKGFwaV9jYWxscy5vcGVuX2Zvcm1fdGFza3MoKSwgewogICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICBjb21wYW55aWQ6IF90aGlzNC4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgY29tcGFueW5hbWU6IF90aGlzNC4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgICBsaWNlbnNlX2tleTogX3RoaXM0LiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgICAgZW1haWw6IF90aGlzNC4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgICAgIHRva2VuOiBfdGhpczQuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgICAgdGFza19pZHM6IF90aGlzNC5kZWxldGVfdGFza19pZHMKICAgICAgICAgICAgfQogICAgICAgICAgfSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChfdGhpczQuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczQuc3Bpbm5lck9uID0gZmFsc2U7CgogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIkZhaWx1cmUiKSB7CiAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJGYWlsZWQgdG8gZGVsZXRlIHRhc2suIik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT0gIlN1Y2Nlc3MiKSB7CiAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoIlRhc2sgd2FzIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5Iik7CiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICAgIF90aGlzNC5sb2FkX3Rhc2soKTsKICAgICAgICAgICAgICB9LCAyNTAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgX3RoaXM0LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsgLy8gYXhpb3MKICAgICAgICAgIC8vICAgLmRlbGV0ZShhcGlfY2FsbHMudGFza19saXN0X3VybCgpLCB7CiAgICAgICAgICAvLyAgICAgZGF0YTogewogICAgICAgICAgLy8gICAgICAgaW50ZW50czogaW50ZW50cywKICAgICAgICAgIC8vICAgICAgIGNvbXBhbnluYW1lOiB0aGlzLmNvbXBhbnluYW1lLAogICAgICAgICAgLy8gICAgICAgY29tcGFueWlkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgIC8vICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAvLyAgICAgICBsaWNlbnNlX2tleTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmxpY2Vuc2Vfa2V5LAogICAgICAgICAgLy8gICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAvLyAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24KICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAvLyAgIH0sIHsKICAgICAgICAgIC8vICAgaGVhZGVyczogewogICAgICAgICAgLy8gICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLiRzZXNzaW9uLmdldCgiYXQiKX1gLAogICAgICAgICAgLy8gICB9LAogICAgICAgICAgLy8gfSkKICAgICAgICAgIC8vICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgLy8gICAgIGlmIChyZXNwb25zZS5kYXRhID09ICJUYXNrKHMpIERlbGV0ZWQiKSB7CiAgICAgICAgICAvLyAgICAgICBTd2FsLmZpcmUoCiAgICAgICAgICAvLyAgICAgICAgICJEZWxldGVkISIsCiAgICAgICAgICAvLyAgICAgICAgICJZb3VyIHRhc2socykgaGF2ZSBiZWVuIGRlbGV0ZWQuIiwKICAgICAgICAgIC8vICAgICAgICAgInN1Y2Nlc3MiCiAgICAgICAgICAvLyAgICAgICApOwogICAgICAgICAgLy8gICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAvLyAgICAgICAgIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgLy8gICAgICAgfSwgMjUwMCk7CiAgICAgICAgICAvLyAgICAgfQogICAgICAgICAgLy8gICB9KQogICAgICAgICAgLy8gLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAvLyAgICAgaWYgKAogICAgICAgICAgLy8gICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fAogICAgICAgICAgLy8gICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fAogICAgICAgICAgLy8gICAgICAgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOQogICAgICAgICAgLy8gICAgICkgewogICAgICAgICAgLy8gICAgICAgdGhpcy4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAvLyAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZW1wdHlfZmllbGRzX2NoZWNrOiBmdW5jdGlvbiBlbXB0eV9maWVsZHNfY2hlY2soKSB7CiAgICAgIGlmICh0aGlzLmlucHV0X2xpc3QuaW50ZW50ID09ICIiIHx8IHRoaXMuaW5wdXRfbGlzdC50YXNrX25hbWUgPT0gIiIgfHwgdGhpcy5pbnB1dF9saXN0LnF1ZXN0aW9uID09ICIiKSB7CiAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgYWxsIHRoZSBmaWVsZHMiKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRydWU7IC8vIGZvciAodmFyIGkgaW4gdGhpcy5pbnB1dF9saXN0LmZpZWxkcykgewogICAgICAgIC8vICAgaWYgKAogICAgICAgIC8vICAgICB0aGlzLmlucHV0X2xpc3QudGFza19uYW1lID09ICIiIHx8CiAgICAgICAgLy8gICAgIHRoaXMuaW5wdXRfbGlzdC5pbnRlbnQgPT0gIiIgfHwKICAgICAgICAvLyAgICAgdGhpcy5pbnB1dF9saXN0LnF1ZXN0aW9uID09ICIiCiAgICAgICAgLy8gICApIHsKICAgICAgICAvLyAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2UgZW50ZXIgYWxsIHRoZSBmaWVsZHMiKTsKICAgICAgICAvLyAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIC8vICAgfSBlbHNlIGlmICh0aGlzLmlucHV0X2xpc3QuZmllbGRzW2ldLnZhbHVlID09ICIiKSB7CiAgICAgICAgLy8gICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIGVudGVyIGFsbCB0aGUgZmllbGRzIik7CiAgICAgICAgLy8gICAgIHJldHVybiBmYWxzZTsKICAgICAgICAvLyAgIH0gZWxzZSBpZiAoCiAgICAgICAgLy8gICAgIGkgPT0gdGhpcy5pbnB1dF9saXN0LmZpZWxkcy5sZW5ndGggLSAxICYmCiAgICAgICAgLy8gICAgIHRoaXMuaW5wdXRfbGlzdC5maWVsZHNbaV0udmFsdWUgIT0gIiIKICAgICAgICAvLyAgICkgewogICAgICAgIC8vICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAvLyAgIH0KICAgICAgICAvLyB9CiAgICAgIH0KICAgIH0sCiAgICBjbGVhcl9maWVsZHM6IGZ1bmN0aW9uIGNsZWFyX2ZpZWxkcygpIHsKICAgICAgdGhpcy5pbnB1dF9saXN0LmludGVudCA9ICIiOwogICAgICB0aGlzLmlucHV0X2xpc3QudGFza19uYW1lID0gIiI7CiAgICAgIHRoaXMuaW5wdXRfbGlzdC5maWVsZHMgPSBbXTsKICAgICAgdGhpcy5pbnB1dF9saXN0LnF1ZXN0aW9uID0gIiI7CiAgICAgIHRoaXMucXVlc3Rpb25zX2xpc3QgPSBbXTsKICAgICAgdGhpcy5pc0VkaXQgPSBmYWxzZTsKICAgICAgdGhpcy5wcmV2aWV3ID0gZmFsc2U7CiAgICAgIHRoaXMucXVlc3Rpb25fdGV4dCA9IGZhbHNlOwogICAgICB0aGlzLnRhc2tfbGlzdFt0aGlzLnNlbGVjdGVkX3Rhc2tdID0gdGhpcy5vcmlnaW5hbF9pbnRlbnRfbGlzdFt0aGlzLnNlbGVjdGVkX3Rhc2tdOwogICAgfSwKICAgIGNhbGxzZWFyY2g6IGZ1bmN0aW9uIGNhbGxzZWFyY2goKSB7CiAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykgewogICAgICAgIHRoaXMuc2VhcmNoX3Byb2R1Y3QoKTsKICAgICAgfQogICAgfSwKICAgIHNlYXJjaF9wcm9kdWN0OiBmdW5jdGlvbiBzZWFyY2hfcHJvZHVjdCgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICAvLyBpZih0aGlzLnNlYXJjaF9ieSE9JycpewogICAgICBpZiAodGhpcy5zZWFyY2hfbmFtZSAhPSAiIikgewogICAgICAgIHRoaXMuc3Bpbm5lck9uID0gdHJ1ZTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy50YXNrX2xpc3RfdXJsKCksIHsKICAgICAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBpc3NlYXJjaDogdHJ1ZSwKICAgICAgICAgIC8vIHNlYXJjaGJ5OiB0aGlzLnNlYXJjaF9ieSwKICAgICAgICAgIGtleTogdGhpcy5zZWFyY2hfbmFtZSwKICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgcGFnZV9ubzogMQogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXM1LnNwaW5uZXJPbiA9IGZhbHNlOwoKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnBhZ2Vjb3VudCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgX3RoaXM1LnBhZ2Vfbm8gPSAxOwogICAgICAgICAgICBfdGhpczUudGFza19saXN0ID0gW107CiAgICAgICAgICAgIF90aGlzNS5vcmlnaW5hbF9pbnRlbnRfbGlzdCA9IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0OwoKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdCkgewogICAgICAgICAgICAgIHZhciBkZXNjID0gW107CgogICAgICAgICAgICAgIGZvciAodmFyIGogaW4gcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uVXR0ZXJhbmNlcykgewogICAgICAgICAgICAgICAgZGVzYy5wdXNoKHsKICAgICAgICAgICAgICAgICAgVGV4dDogcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uVXR0ZXJhbmNlc1tqXS5UZXh0CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChkZXNjLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgICAgICAgICBfdGhpczUudGFza19saXN0LnB1c2goewogICAgICAgICAgICAgICAgICBJbnRlbnQ6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLkludGVudCwKICAgICAgICAgICAgICAgICAgVGFza05hbWU6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlRhc2tOYW1lLAogICAgICAgICAgICAgICAgICBUYXNrX0Rlc2NyaXB0aW9uOiBkZXNjCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzNS50b3RhbF9wYWdlcyA9IHJlc3BvbnNlLmRhdGEucGFnZWNvdW50OwoKICAgICAgICAgICAgX3RoaXM1LnNldHBhZ2luYXRpb24oX3RoaXM1LnBhZ2Vfbm8pOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLk1TRyA9PSAiTm8gVGFza3MgRm91bmQiKSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcigiTm8gVGFzayBGb3VuZCIpOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICBfdGhpczUubG9hZF90YXNrKCk7CiAgICAgICAgICAgIH0sIDI1MDApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRybmFsIFNlcnZlciBFcnJvciIpOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICBfdGhpczUubG9hZF90YXNrKCk7CiAgICAgICAgICAgIH0sIDI1MDApOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXM1LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRvYXN0ci5lcnJvcigiRW50ZXIgcHJvcGVyIGRhdGEgZm9yIHNlYXJjaGluZyIpOwogICAgICB9IC8vIH1lbHNlewogICAgICAvLyAgIHRvYXN0ci5lcnJvcigiU2VsZWN0IGhlYWRlciBmb3Igc2VhcmNoaW5nIik7CiAgICAgIC8vIH0KCiAgICB9LAogICAgcGFnZV9yZXF1aXJlOiBmdW5jdGlvbiBwYWdlX3JlcXVpcmUocGFnZSkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIGlmIChwYWdlID09IDAgfHwgcGFnZSA9PSB0aGlzLnRvdGFsX3BhZ2VzICsgMSkgewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuc2VhcmNoX25hbWUgPT0gIiIpIHsKICAgICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKCiAgICAgICAgICBpZiAocGFnZSA9PSAiLi4ucyIpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCgxICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgICAgfSBlbHNlIGlmIChwYWdlID09ICIuLi5sIikgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKHRoaXMudG90YWxfcGFnZXMgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBwYWdlOwogICAgICAgICAgfQoKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnRhc2tfbGlzdF91cmwoKSwgewogICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIGlzU2hvdzogdHJ1ZSwKICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubwogICAgICAgICAgfSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXM2LnRhc2tfbGlzdCA9IFtdOwogICAgICAgICAgICBfdGhpczYub3JpZ2luYWxfaW50ZW50X2xpc3QgPSByZXNwb25zZS5kYXRhLlRhc2tzTGlzdDsKCiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3QpIHsKICAgICAgICAgICAgICB2YXIgZGVzYyA9IFtdOwoKICAgICAgICAgICAgICBmb3IgKHZhciBqIGluIHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlV0dGVyYW5jZXMpIHsKICAgICAgICAgICAgICAgIGRlc2MucHVzaCh7CiAgICAgICAgICAgICAgICAgIFRleHQ6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlV0dGVyYW5jZXNbal0uVGV4dAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoZGVzYy5sZW5ndGggIT0gMCkgewogICAgICAgICAgICAgICAgX3RoaXM2LnRhc2tfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgSW50ZW50OiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5JbnRlbnQsCiAgICAgICAgICAgICAgICAgIFRhc2tOYW1lOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrTmFtZSwKICAgICAgICAgICAgICAgICAgVGFza19EZXNjcmlwdGlvbjogZGVzYwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczYudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2Vjb3VudDsKCiAgICAgICAgICAgIF90aGlzNi5zZXRwYWdpbmF0aW9uKF90aGlzNi5wYWdlX25vKTsKICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICAgIF90aGlzNi4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICQoImlucHV0OmNoZWNrYm94IikucHJvcCgiY2hlY2tlZCIsIGZhbHNlKTsKCiAgICAgICAgICBpZiAocGFnZW5vID09ICIuLi5zIikgewogICAgICAgICAgICB0aGlzLnBhZ2Vfbm8gPSBNYXRoLmNlaWwoKDEgKyB0aGlzLnBhZ2Vfbm8pIC8gMik7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2VubyA9PSAiLi4ubCIpIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCh0aGlzLnRvdGFsX3BhZ2VzICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5wYWdlX25vID0gcGFnZW5vOwogICAgICAgICAgfQoKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLnRhc2tfbGlzdF91cmwoKSwgewogICAgICAgICAgICBjb21wYW55aWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55bmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgICAgZW1haWw6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5lbWFpbCwKICAgICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICAgIGlzc2VhcmNoOiB0cnVlLAogICAgICAgICAgICAvLyBzZWFyY2hieTogdGhpcy5zZWFyY2hfYnksCiAgICAgICAgICAgIGtleTogdGhpcy5zZWFyY2hfbmFtZSwKICAgICAgICAgICAgcGVyX3BhZ2U6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgIHBhZ2Vfbm86IHBhZ2UKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnBhZ2Vjb3VudCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBfdGhpczYucGFnZV9ubyA9IHBhZ2U7CiAgICAgICAgICAgICAgX3RoaXM2LnRhc2tfbGlzdCA9IFtdOwogICAgICAgICAgICAgIF90aGlzNi5vcmlnaW5hbF9pbnRlbnRfbGlzdCA9IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0OwoKICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0KSB7CiAgICAgICAgICAgICAgICB2YXIgZGVzYyA9IFtdOwoKICAgICAgICAgICAgICAgIGZvciAodmFyIGogaW4gcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uVXR0ZXJhbmNlcykgewogICAgICAgICAgICAgICAgICBkZXNjLnB1c2goewogICAgICAgICAgICAgICAgICAgIFRleHQ6IHJlc3BvbnNlLmRhdGEuVGFza3NMaXN0W2ldLlV0dGVyYW5jZXNbal0uVGV4dAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoZGVzYy5sZW5ndGggIT0gMCkgewogICAgICAgICAgICAgICAgICBfdGhpczYudGFza19saXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgIEludGVudDogcmVzcG9uc2UuZGF0YS5UYXNrc0xpc3RbaV0uSW50ZW50LAogICAgICAgICAgICAgICAgICAgIFRhc2tOYW1lOiByZXNwb25zZS5kYXRhLlRhc2tzTGlzdFtpXS5UYXNrTmFtZSwKICAgICAgICAgICAgICAgICAgICBUYXNrX0Rlc2NyaXB0aW9uOiBkZXNjCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX3RoaXM2LnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdlY291bnQ7CgogICAgICAgICAgICAgIF90aGlzNi5zZXRwYWdpbmF0aW9uKF90aGlzNi5wYWdlX25vKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IoIkludHJuYWwgU2VydmVyIEVycm9yIik7CiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICAgIF90aGlzNi5sb2FkX3Rhc2soKTsKICAgICAgICAgICAgICB9LCAyNTAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgICAgX3RoaXM2LiRyb290LiRlbWl0KCJTZXNzaW9uX0V4cGlyZWQiLCBlLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzZXRwYWdpbmF0aW9uOiBmdW5jdGlvbiBzZXRwYWdpbmF0aW9uKHBhZ2Vfbm8pIHsKICAgICAgdGhpcy5wYWdlX2FycmF5ID0gW107CgogICAgICBpZiAodGhpcy50b3RhbF9wYWdlcyA8PSA3KSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRvdGFsX3BhZ2VzOyBpKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSAxKSB7CiAgICAgICAgZm9yICh2YXIgX2k0ID0gMDsgX2k0IDwgNDsgX2k0KyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKF9pNCArIDEpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfSBlbHNlIGlmIChwYWdlX25vID09IHRoaXMudG90YWxfcGFnZXMpIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwoKICAgICAgICBmb3IgKHZhciBfaTUgPSB0aGlzLnRvdGFsX3BhZ2VzIC0gNDsgX2k1IDwgdGhpcy50b3RhbF9wYWdlczsgX2k1KyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKF9pNSArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwYWdlX25vIDw9IDQpIHsKICAgICAgICBmb3IgKHZhciBfaTYgPSAwOyBfaTYgPCBwYWdlX25vICsgMzsgX2k2KyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKF9pNiArIDEpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLmwiKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCh0aGlzLnRvdGFsX3BhZ2VzKTsKICAgICAgfSBlbHNlIGlmIChwYWdlX25vID49IHRoaXMudG90YWxfcGFnZXMgLSA0KSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKCiAgICAgICAgZm9yICh2YXIgX2k3ID0gcGFnZV9ubyAtIDQ7IF9pNyA8IHRoaXMudG90YWxfcGFnZXM7IF9pNysrKSB7CiAgICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaChfaTcgKyAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goMSk7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goIi4uLnMiKTsKCiAgICAgICAgZm9yICh2YXIgX2k4ID0gcGFnZV9ubyAtIDM7IF9pOCA8PSBwYWdlX25vICsgMzsgX2k4KyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKF9pOCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9CiAgICB9LAogICAgc2VuZF9tc2dfdG9fdXNlcjogZnVuY3Rpb24gc2VuZF9tc2dfdG9fdXNlcigpIHsKICAgICAgaWYgKHRoaXMuYWRkX2N1c3RvbXNfZW1haWwgfHwgIXRoaXMuYWRkX2N1c3RvbXNfZW1haWwgJiYgIXRoaXMuZW1haWxfdG9fdXNlcikgewogICAgICAgIHRoaXMuZW1haWxfdG9fdXNlciA9ICF0aGlzLmVtYWlsX3RvX3VzZXI7CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuYWRkX2N1c3RvbXNfZW1haWwgJiYgdGhpcy5lbWFpbF90b191c2VyKSB7CiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICB0b2FzdHIuZXJyb3IoIlBsZWFzZSBzZWxlY3QgYXRsZWFzdCBvbmUgdHlwZSBvZiByZWNpcGllbnQiKTsKICAgICAgfQogICAgfSwKICAgIHNlbmRfbXNnX3RvX2N1c3RvbV91c2VyOiBmdW5jdGlvbiBzZW5kX21zZ190b19jdXN0b21fdXNlcigpIHsKICAgICAgaWYgKHRoaXMuZW1haWxfdG9fdXNlciB8fCAhdGhpcy5hZGRfY3VzdG9tc19lbWFpbCAmJiAhdGhpcy5lbWFpbF90b191c2VyKSB7CiAgICAgICAgdGhpcy5hZGRfY3VzdG9tc19lbWFpbCA9ICF0aGlzLmFkZF9jdXN0b21zX2VtYWlsOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYWRkX2N1c3RvbXNfZW1haWwgJiYgIXRoaXMuZW1haWxfdG9fdXNlcikgewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdG9hc3RyLmVycm9yKCJQbGVhc2Ugc2VsZWN0IGF0bGVhc3Qgb25lIHR5cGUgb2YgcmVjaXBpZW50Iik7CiAgICAgIH0KICAgIH0sCiAgICBzZW5kX3Ntc190b191c2VyOiBmdW5jdGlvbiBzZW5kX3Ntc190b191c2VyKCkgewogICAgICBpZiAodGhpcy5hZGRfY3VzdG9tc19udW1iZXIgfHwgIXRoaXMuYWRkX2N1c3RvbXNfbnVtYmVyICYmICF0aGlzLnNtc190b191c2VyKSB7CiAgICAgICAgdGhpcy5zbXNfdG9fdXNlciA9ICF0aGlzLnNtc190b191c2VyOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmFkZF9jdXN0b21zX251bWJlciAmJiB0aGlzLnNtc190b191c2VyKSB7CiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICB0b2FzdHIuZXJyb3IoIlBsZWFzZSBzZWxlY3QgYXRsZWFzdCBvbmUgdHlwZSBvZiByZWNpcGllbnQiKTsKICAgICAgfQogICAgfSwKICAgIHNlbmRfc21zX3RvX2N1c3RvbV91c2VyOiBmdW5jdGlvbiBzZW5kX3Ntc190b19jdXN0b21fdXNlcigpIHsKICAgICAgaWYgKHRoaXMuc21zX3RvX3VzZXIgfHwgIXRoaXMuYWRkX2N1c3RvbXNfbnVtYmVyICYmICF0aGlzLnNtc190b191c2VyKSB7CiAgICAgICAgdGhpcy5hZGRfY3VzdG9tc19udW1iZXIgPSAhdGhpcy5hZGRfY3VzdG9tc19udW1iZXI7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5hZGRfY3VzdG9tc19udW1iZXIgJiYgIXRoaXMuc21zX3RvX3VzZXIpIHsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHRvYXN0ci5lcnJvcigiUGxlYXNlIHNlbGVjdCBhdGxlYXN0IG9uZSB0eXBlIG9mIHJlY2lwaWVudCIpOwogICAgICB9CiAgICB9LAogICAgY2hlY2tmb3JlbWFpbHZhcmlhYmxlczogZnVuY3Rpb24gY2hlY2tmb3JlbWFpbHZhcmlhYmxlcygpIHsKICAgICAgdmFyIGFyclN0cjEgPSB0aGlzLmVtYWlsX2JvZHkuc3BsaXQoInt7Iik7CiAgICAgIHZhciBhcnJTdHIyID0gW107CiAgICAgIHZhciBuZXdfdmFyX2xpc3QgPSBbXTsKICAgICAgdmFyIG5ld192YXJfYWN0aW9uID0gW107CgogICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyclN0cjEubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoYXJyU3RyMVtpXS5pbmNsdWRlcygifX0iKSkgewogICAgICAgICAgYXJyU3RyMi5wdXNoKGFyclN0cjFbaV0uc3BsaXQoIn19IilbMF0pOwoKICAgICAgICAgIGlmIChuZXdfdmFyX2xpc3QuaW5kZXhPZihhcnJTdHIxW2ldLnNwbGl0KCJ9fSIpWzBdKSA9PSAtMSkgewogICAgICAgICAgICBuZXdfdmFyX2xpc3QucHVzaChhcnJTdHIxW2ldLnNwbGl0KCJ9fSIpWzBdKTsKICAgICAgICAgICAgbmV3X3Zhcl9hY3Rpb24ucHVzaCgiYWRkIik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBfaTkgPSAwOyBfaTkgPCB0aGlzLmVtYWlsX3ZhcmlhYmxlcy5sZW5ndGg7IF9pOSsrKSB7CiAgICAgICAgaWYgKG5ld192YXJfbGlzdC5pbmRleE9mKHRoaXMuZW1haWxfdmFyaWFibGVzW19pOV0udmFyaWFibGVfbmFtZSkgPiAtMSkgewogICAgICAgICAgbmV3X3Zhcl9hY3Rpb25bbmV3X3Zhcl9saXN0LmluZGV4T2YodGhpcy5lbWFpbF92YXJpYWJsZXNbX2k5XS52YXJpYWJsZV9uYW1lKV0gPSAia2VlcCI7CiAgICAgICAgfSBlbHNlIGlmIChuZXdfdmFyX2xpc3QuaW5kZXhPZih0aGlzLmVtYWlsX3ZhcmlhYmxlc1tfaTldLnZhcmlhYmxlX25hbWUpID09IC0xKSB7CiAgICAgICAgICBuZXdfdmFyX2xpc3QucHVzaCh0aGlzLmVtYWlsX3ZhcmlhYmxlc1tfaTldLnZhcmlhYmxlX25hbWUpOwogICAgICAgICAgbmV3X3Zhcl9hY3Rpb24ucHVzaCgicmVtb3ZlIik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBfaTEwID0gMDsgX2kxMCA8IG5ld192YXJfbGlzdC5sZW5ndGg7IF9pMTArKykgewogICAgICAgIGlmIChuZXdfdmFyX2FjdGlvbltfaTEwXSA9PSAiYWRkIikgewogICAgICAgICAgdGhpcy5lbWFpbF92YXJpYWJsZXMucHVzaCh7CiAgICAgICAgICAgIHZhcmlhYmxlX25hbWU6IG5ld192YXJfbGlzdFtfaTEwXSwKICAgICAgICAgICAgdmFyaWFibGVfZGVzY3JpcHRpb246IG51bGwKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAobmV3X3Zhcl9hY3Rpb25bX2kxMF0gPT0gInJlbW92ZSIpIHsKICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5lbWFpbF92YXJpYWJsZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgaWYgKHRoaXMuZW1haWxfdmFyaWFibGVzW2pdLnZhcmlhYmxlX25hbWUgPT0gbmV3X3Zhcl9saXN0W19pMTBdKSB7CiAgICAgICAgICAgICAgdGhpcy5lbWFpbF92YXJpYWJsZXMuc3BsaWNlKGosIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY2hlY2tmb3JzbXN2YXJpYWJsZXM6IGZ1bmN0aW9uIGNoZWNrZm9yc21zdmFyaWFibGVzKCkgewogICAgICAvLyBzbXNfdmFyaWJsZXMKICAgICAgdmFyIGFyclN0cjEgPSB0aGlzLnNtc19ib2R5LnNwbGl0KCJ7eyIpOwogICAgICB2YXIgYXJyU3RyMiA9IFtdOwogICAgICB2YXIgbmV3X3Zhcl9saXN0ID0gW107CiAgICAgIHZhciBuZXdfdmFyX2FjdGlvbiA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcnJTdHIxLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGFyclN0cjFbaV0uaW5jbHVkZXMoIn19IikpIHsKICAgICAgICAgIGFyclN0cjIucHVzaChhcnJTdHIxW2ldLnNwbGl0KCJ9fSIpWzBdKTsKCiAgICAgICAgICBpZiAobmV3X3Zhcl9saXN0LmluZGV4T2YoYXJyU3RyMVtpXS5zcGxpdCgifX0iKVswXSkgPT0gLTEpIHsKICAgICAgICAgICAgbmV3X3Zhcl9saXN0LnB1c2goYXJyU3RyMVtpXS5zcGxpdCgifX0iKVswXSk7CiAgICAgICAgICAgIG5ld192YXJfYWN0aW9uLnB1c2goImFkZCIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yICh2YXIgX2kxMSA9IDA7IF9pMTEgPCB0aGlzLnNtc192YXJpYmxlcy5sZW5ndGg7IF9pMTErKykgewogICAgICAgIGlmIChuZXdfdmFyX2xpc3QuaW5kZXhPZih0aGlzLnNtc192YXJpYmxlc1tfaTExXS52YXJpYWJsZV9uYW1lKSA+IC0xKSB7CiAgICAgICAgICBuZXdfdmFyX2FjdGlvbltuZXdfdmFyX2xpc3QuaW5kZXhPZih0aGlzLnNtc192YXJpYmxlc1tfaTExXS52YXJpYWJsZV9uYW1lKV0gPSAia2VlcCI7CiAgICAgICAgfSBlbHNlIGlmIChuZXdfdmFyX2xpc3QuaW5kZXhPZih0aGlzLnNtc192YXJpYmxlc1tfaTExXS52YXJpYWJsZV9uYW1lKSA9PSAtMSkgewogICAgICAgICAgbmV3X3Zhcl9saXN0LnB1c2godGhpcy5zbXNfdmFyaWJsZXNbX2kxMV0udmFyaWFibGVfbmFtZSk7CiAgICAgICAgICBuZXdfdmFyX2FjdGlvbi5wdXNoKCJyZW1vdmUiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAodmFyIF9pMTIgPSAwOyBfaTEyIDwgbmV3X3Zhcl9saXN0Lmxlbmd0aDsgX2kxMisrKSB7CiAgICAgICAgaWYgKG5ld192YXJfYWN0aW9uW19pMTJdID09ICJhZGQiKSB7CiAgICAgICAgICB0aGlzLnNtc192YXJpYmxlcy5wdXNoKHsKICAgICAgICAgICAgdmFyaWFibGVfbmFtZTogbmV3X3Zhcl9saXN0W19pMTJdLAogICAgICAgICAgICB2YXJpYWJsZV9kZXNjcmlwdGlvbjogbnVsbAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChuZXdfdmFyX2FjdGlvbltfaTEyXSA9PSAicmVtb3ZlIikgewogICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnNtc192YXJpYmxlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAodGhpcy5zbXNfdmFyaWJsZXNbal0udmFyaWFibGVfbmFtZSA9PSBuZXdfdmFyX2xpc3RbX2kxMl0pIHsKICAgICAgICAgICAgICB0aGlzLnNtc192YXJpYmxlcy5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBvcGVucHJldmlldzogZnVuY3Rpb24gb3BlbnByZXZpZXcoaW5kZXgpIHsKICAgICAgJCgiI3Rhc2ttb2RhbCIpLm1vZGFsKCJzaG93Iik7CiAgICAgIHRoaXMudGFza190eXBlID0gdGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tfVHlwZTsgLy8gdGhpcy5wcmV2aWV3ID0gdHJ1ZTsKCiAgICAgIHRoaXMuaXNFZGl0ID0gdHJ1ZTsKICAgICAgdGhpcy5wcmV2aWV3ID0gZmFsc2U7CiAgICAgIHRoaXMuc2VsZWN0ZWRfdGFzayA9IGluZGV4OwogICAgICB0aGlzLmlucHV0X2xpc3QudGFza19uYW1lID0gdGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tOYW1lOwoKICAgICAgaWYgKHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX1R5cGUgPT0gImRlZmF1bHQiIHx8ICFCb29sZWFuKHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX1R5cGUpKSB7CiAgICAgICAgdGhpcy50YXNrX3R5cGUgPSAiRGVmYXVsdCI7CiAgICAgICAgdGhpcy5pbnB1dF9saXN0LmludGVudCA9IHRoaXMudGFza19saXN0W2luZGV4XS5JbnRlbnQ7CiAgICAgICAgdGhpcy5pbnB1dF9saXN0LnF1ZXN0aW9uID0gdGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tfRGVzY3JpcHRpb25bMF0uVGV4dDsKICAgICAgICB0aGlzLmlucHV0X2xpc3QucXVlc3Rpb25faWQgPSB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvblswXS5RdWVzdGlvbklkOwoKICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICB0aGlzLnF1ZXN0aW9uc19saXN0LnB1c2godGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tfRGVzY3JpcHRpb25bal0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19UeXBlID09ICJFbWFpbCIpIHsKICAgICAgICAvLyB0aGlzLmN1c3RvbV9lbWFpbHMgPSB0aGlzLmdldGRhdGFzb2JzKHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uLmN1c3RvbV9lbWFpbHMpOwogICAgICAgIC8vIHRoaXMuY3VzdG9tX2VtYWlscyA9IHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uLmN1c3RvbV9lbWFpbHM7CiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5jdXN0b21fZW1haWxzKTsKICAgICAgICB0aGlzLmN1c3RvbV9lbWFpbHMgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgX2kxMyA9IDA7IF9pMTMgPCB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbi5jdXN0b21fZW1haWxzLmxlbmd0aDsgX2kxMysrKSB7CiAgICAgICAgICB0aGlzLmN1c3RvbV9lbWFpbHMucHVzaCh0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbi5jdXN0b21fZW1haWxzW19pMTNdKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuZW1haWxfdGl0bGUgPSB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbi5zdWJqZWN0OwogICAgICAgIHRoaXMuZW1haWxfYm9keSA9IHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uLmJvZHk7CiAgICAgICAgdGhpcy5lbWFpbF92YXJpYWJsZXMgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbi5lbWFpbF92YXJpYWJsZXMpIHsKICAgICAgICAgIHRoaXMuZW1haWxfdmFyaWFibGVzLnB1c2goewogICAgICAgICAgICB2YXJpYWJsZV9uYW1lOiB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbi5lbWFpbF92YXJpYWJsZXNbaV0udmFyaWFibGVfbmFtZSwKICAgICAgICAgICAgdmFyaWFibGVfZGVzY3JpcHRpb246IHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uLmVtYWlsX3ZhcmlhYmxlc1tpXS52YXJpYWJsZV9kZXNjcmlwdGlvbgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX1R5cGUgPT0gIlNNUyIpIHsKICAgICAgICB0aGlzLmN1c3RvbV9udW1iZXIgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgX2kxNCA9IDA7IF9pMTQgPCB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbi5jdXN0b21fbnVtYmVycy5sZW5ndGg7IF9pMTQrKykgewogICAgICAgICAgdGhpcy5jdXN0b21fbnVtYmVyLnB1c2godGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tfRGVzY3JpcHRpb24uY3VzdG9tX251bWJlcnNbX2kxNF0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zbXNfYm9keSA9IHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uLmJvZHk7CiAgICAgICAgdGhpcy5zbXNfdmFyaWJsZXMgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbi5zbXNfdmFyaWFibGVzKSB7CiAgICAgICAgICB0aGlzLnNtc192YXJpYmxlcy5wdXNoKHsKICAgICAgICAgICAgdmFyaWFibGVfbmFtZTogdGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tfRGVzY3JpcHRpb24uc21zX3ZhcmlhYmxlc1tpXS52YXJpYWJsZV9uYW1lLAogICAgICAgICAgICB2YXJpYWJsZV9kZXNjcmlwdGlvbjogdGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tfRGVzY3JpcHRpb24uc21zX3ZhcmlhYmxlc1tpXS52YXJpYWJsZV9kZXNjcmlwdGlvbgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IC8vIHRoaXMuaXNFZGl0ID0gdHJ1ZTsKICAgICAgLy8gdGhpcy50YXNrX3R5cGUgPSB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19UeXBlOwogICAgICAvLyB0aGlzLnByZXZpZXcgPSB0cnVlOwogICAgICAvLyB0aGlzLnNlbGVjdGVkX3Rhc2sgPSBpbmRleDsKICAgICAgLy8gdGhpcy50YXNrX3R5cGUgPSAnRGVmYXVsdCc7CiAgICAgIC8vIHRoaXMuaW5wdXRfbGlzdC5pbnRlbnQgPSB0aGlzLnRhc2tfbGlzdFtpbmRleF0uSW50ZW50OwogICAgICAvLyB0aGlzLmlucHV0X2xpc3QudGFza19uYW1lID0gdGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tOYW1lOwogICAgICAvLyB0aGlzLmlucHV0X2xpc3QucXVlc3Rpb24gPSB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvblswXS5UZXh0OwogICAgICAvLyB0aGlzLnRhc2tfbGlzdFtpbmRleF0uVGFza19EZXNjcmlwdGlvbi5zcGxpY2UoMCwgMSk7CiAgICAgIC8vIGZvciAodmFyIGo9MTtqPHRoaXMudGFza19saXN0W2luZGV4XS5UYXNrX0Rlc2NyaXB0aW9uLmxlbmd0aDtqKyspIHsKICAgICAgLy8gICB0aGlzLnF1ZXN0aW9uc19saXN0LnB1c2godGhpcy50YXNrX2xpc3RbaW5kZXhdLlRhc2tfRGVzY3JpcHRpb25bal0pOwogICAgICAvLyB9CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudGFza19saXN0W2luZGV4XSk7CgogICAgfSAvLyBnZXRkYXRhc29icyhkYXRhKXsKICAgIC8vICAgdmFyIHg7CiAgICAvLyAgIGNvbnNvbGUubG9nKGRhdGEseCk7CiAgICAvLyAgIHg9ZGF0YTsKICAgIC8vICAgY29uc29sZS5sb2coZGF0YSx4KTsKICAgIC8vICAgcmV0dXJuIHg7CiAgICAvLyB9LAoKICB9Cn07"},null]}