{"remainingRequest":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js!/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/End User Response/VerifyResponsesUnanswered.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vimalesh/CENSE/chatbot-portal/src/portal/Chatbot/Dashboard/End User Response/VerifyResponsesUnanswered.vue","mtime":1663910265466},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vimalesh/CENSE/chatbot-portal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IHN3YWwgZnJvbSAic3dlZXRhbGVydDIiOwppbXBvcnQgU3dhbCBmcm9tICJzd2VldGFsZXJ0MiI7CmltcG9ydCBhcGlfY2FsbHMgZnJvbSAiQC9wb3J0YWwvYXBpX2NhbGxzIjsKaW1wb3J0IHsgc2V0VGltZW91dCB9IGZyb20gInRpbWVycyI7CmltcG9ydCBNdWx0aXNlbGVjdCBmcm9tICJ2dWUtbXVsdGlzZWxlY3QiOwppbXBvcnQgeyBjbG9zZV9tb2RhbCB9IGZyb20gIkAvcG9ydGFsL21peGlucyI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAndmVyaWZ5X3Jlc3BvbnNlc191bmFuc3dlcmVkJywKICBjb21wb25lbnRzOiB7CiAgICBNdWx0aXNlbGVjdDogTXVsdGlzZWxlY3QKICB9LAogIG1peGluczogW2Nsb3NlX21vZGFsXSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdW5hbnN3ZXJlZF9saXN0OiBbXSwKICAgICAgdXNlcl9yb2xlOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikucm9sZSwKICAgICAgY29tcGFueW5hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgIGNvbXBhbnlpZDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQsCiAgICAgIGludGVudF9saXN0OiBbXSwKICAgICAgY2hlY2tlZF9saXN0OiBbXSwKICAgICAgaW50ZW50bGlzdDogIiIsCiAgICAgIHBlcl9wYWdlOiAxNSwKICAgICAgcGFnZV9ubzogMSwKICAgICAgdG90YWxfcGFnZXM6IDAsCiAgICAgIHNob3dfbG9hZGVyOiBmYWxzZSwKICAgICAgbnVtYmVyX29mX3Jvd3M6IG51bGwsCiAgICAgIHNlYXJjaF9uYW1lOiAiIiwKICAgICAgcGFnZV9hcnJheTogW10sCiAgICAgIG9sZF9xdWVzdGlvbjogIiIsCiAgICAgIG9sZF9pbnRlbnQ6ICIiLAogICAgICBuZXdfaW50ZW50X2xpc3Q6IFtdLAogICAgICBvbGRfZGF0YTogewogICAgICAgIHF1ZXN0aW9uOiBudWxsLAogICAgICAgIGludGVudDogbnVsbAogICAgICB9LAogICAgICB0aHVtYnNfZG93bl9pY29uOiByZXF1aXJlKCJAL3BvcnRhbC9hc3NldHMvaW1nL0dyb3VwIDYxLnN2ZyIpLAogICAgICB0aHVtYnNfdXBfaWNvbjogcmVxdWlyZSgiQC9wb3J0YWwvYXNzZXRzL2ltZy9Hcm91cCA3MS5zdmciKSAvLyB2aWV3X2NvbXBvbmVudF9uYW1lOiAidW5hbnN3ZXJlZF9xdWVzdGlvbnMiLAoKICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgdm0gPSB0aGlzOwogICAgJCgiI3NlbGVjdGFsbCIpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCQodGhpcykuaXMoIjpjaGVja2VkIikpIHsKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCB0cnVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2bS5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CiAgICAgIH0KICAgIH0pOwogICAgdGhpcy4kcm9vdC4kb24oImFkZF9xdWVzdGlvbnNfdW5hbnN3ZXJlZCIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpOyAgIAogICAgICBfdGhpcy5hZGRfcXVlc3Rpb25zKCk7CiAgICB9KTsKICAgIHRoaXMuJHJvb3QuJG9uKCJzZWFyY2hfdW5hbnN3ZXJlZCIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIF90aGlzLnNlYXJjaF9uYW1lID0gZGF0YTsKCiAgICAgIF90aGlzLnNlYXJjaF9xdWVzdGlvbigpOyAvLyB0aGlzLmFkZF9xdWVzdGlvbnMoKTsKCiAgICB9KTsKICAgIHRoaXMuJHJvb3QuJG9uKCJkZWxldGVfbXVsdGlwbGVfdW5hbnN3ZXJlZCIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIF90aGlzLmRlbGV0ZV9tdWx0aXBsZSgpOwogICAgfSk7CiAgICB0aGlzLiRyb290LiRvbigibG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICBfdGhpcy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgfSk7CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy4kcm9vdC4kb2ZmKCJhZGRfcXVlc3Rpb25zX3VuYW5zd2VyZWQiKTsKICAgIHRoaXMuJHJvb3QuJG9mZigic2VhcmNoX3VuYW5zd2VyZWQiKTsKICAgIHRoaXMuJHJvb3QuJG9mZigiZGVsZXRlX211bHRpcGxlX3VuYW5zd2VyZWQiKTsKICAgIHRoaXMuJHJvb3QuJG9mZigibG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQiKTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191bmFuc3dlcmVkKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBsb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZDogZnVuY3Rpb24gbG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgdGhpcy5pbnRlbnRfbGlzdCA9IFtdOwogICAgICB0aGlzLm5ld19pbnRlbnRfbGlzdCA9IFtdOwogICAgICB0aGlzLnVuYW5zd2VyZWRfbGlzdCA9IFtdOwogICAgICB0aGlzLnNlYXJjaF9uYW1lID0gIiI7CgogICAgICBpZiAodGhpcy51c2VyX3JvbGUgPT0gIlN1cGVyQWRtaW4iKSB7CiAgICAgICAgaWYgKHRoaXMuJHNlc3Npb24uaGFzKCJDb21wYW55SWQiKSkgewogICAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiQ29tcGFueUlkIik7CiAgICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIkNvbXBhbnlOYW1lIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuY29tcGFueWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfaWQ7CiAgICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb21wYW55aWQgPSB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZDsKICAgICAgICB0aGlzLmNvbXBhbnluYW1lID0gdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuY29tcGFueW5hbWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICBpc0RlbGV0ZTogIkZhbHNlIiwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucywKICAgICAgICAgIHBhZ2Vfbm86IHRoaXMucGFnZV9ubywKICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgaXNfZ2V0X3VzZXJfcmVzcG9uc2U6IGZhbHNlCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczIuc2hvd19sb2FkZXIgPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczIuYXBpX3N0YXR1c19jb2RlLkRBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICAgIF90aGlzMi5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhID09IHVuZGVmaW5lZCA/IDAgOiByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfZGF0YTsKICAgICAgICAgICAgX3RoaXMyLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2UgPT0gdW5kZWZpbmVkID8gMCA6IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9wYWdlOwogICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgX3RoaXMyLnVuYW5zd2VyZWRfbGlzdCA9IFtdOwoKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBkYXRhWzBdKSB7CiAgICAgICAgICAgICAgdmFyIHRlbXBfaW50ID0gIiI7CgogICAgICAgICAgICAgIGlmIChCb29sZWFuKGRhdGFbMl1baV0pKSB7CiAgICAgICAgICAgICAgICAvLyB0ZW1wX2ludCA9IGRhdGFbMl1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpOwogICAgICAgICAgICAgICAgdGVtcF9pbnQgPSBkYXRhWzJdW2ldOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX3RoaXMyLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiBkYXRhWzBdW2ldLAogICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgIHNvdXJjZTogZGF0YVsxXVtpXSwKICAgICAgICAgICAgICAgIHVzZXJfcmVzcG9uc2U6IGRhdGFbMl1baV0sCiAgICAgICAgICAgICAgICB1c2VyX2ZlZWRiYWNrOiBkYXRhWzNdW2ldLAogICAgICAgICAgICAgICAgZWRpdDogZmFsc2UKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX3RoaXMyLnNldHBhZ2luYXRpb24oX3RoaXMyLnBhZ2Vfbm8pOwoKICAgICAgICAgICAgX3RoaXMyLnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSA9PT0gX3RoaXMyLmFwaV9zdGF0dXNfY29kZS5OT19EQVRBX0FWQUlMQUJMRS5NU0dfQ09ERSkgewogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICAgIHR5cGU6ICJpbmZvIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzMi5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFLAogICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmIChlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDEwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0NDAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICBfdGhpczIuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0b2FzdHIuZXJyb3IoZS5tZXNzYWdlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczIuc2hvd19sb2FkZXIgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksIHsKICAgICAgICBjb21wYW55X2lkOiB0aGlzLmNvbXBhbnlpZCwKICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuY29tcGFueW5hbWUsCiAgICAgICAgaXNEcm9wZG93bjogIlRydWUiLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7CiAgICAgICAgLy8gZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhWzBdKSB7CiAgICAgICAgLy8gdGhpcy5pbnRlbnRfbGlzdC5wdXNoKAogICAgICAgIC8vICAgICByZXNwb25zZS5kYXRhWzBdW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKQogICAgICAgIC8vICk7CiAgICAgICAgLy8gdGhpcy5uZXdfaW50ZW50X2xpc3QucHVzaCgKICAgICAgICAvLyAgICAgcmVzcG9uc2UuZGF0YVswXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIikKICAgICAgICAvLyApOwogICAgICAgIC8vIH0KICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczIuYXBpX3N0YXR1c19jb2RlLkRBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICBmb3IgKHZhciBpIGluIHJlc3BvbnNlLmRhdGEuZGF0YVswXSkgewogICAgICAgICAgICBfdGhpczIuaW50ZW50X2xpc3QucHVzaChyZXNwb25zZS5kYXRhLmRhdGFbMF1baV0pOwoKICAgICAgICAgICAgX3RoaXMyLm5ld19pbnRlbnRfbGlzdC5wdXNoKHJlc3BvbnNlLmRhdGEuZGF0YVswXVtpXSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzMi5hcGlfc3RhdHVzX2NvZGUuTk9fREFUQV9BVkFJTEFCTEUuTVNHX0NPREUpIHsKICAgICAgICAgIFN3YWwoewogICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1lbmQiLAogICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgIHR5cGU6ICJpbmZvIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzMi5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgIHNob3dDYW5jZWxCdXR0b246IGZhbHNlLAogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczIuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBzZXRwYWdpbmF0aW9uOiBmdW5jdGlvbiBzZXRwYWdpbmF0aW9uKHBhZ2Vfbm8pIHsKICAgICAgdGhpcy5wYWdlX2FycmF5ID0gW107CgogICAgICBpZiAodGhpcy50b3RhbF9wYWdlcyA8PSA3KSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRvdGFsX3BhZ2VzOyBpKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKGkgKyAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocGFnZV9ubyA9PSAxKSB7CiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IDQ7IF9pKyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKF9pICsgMSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPT0gdGhpcy50b3RhbF9wYWdlcykgewogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKDEpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5zIik7CgogICAgICAgIGZvciAodmFyIF9pMiA9IHRoaXMudG90YWxfcGFnZXMgLSA0OyBfaTIgPCB0aGlzLnRvdGFsX3BhZ2VzOyBfaTIrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2kyICsgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPD0gNCkgewogICAgICAgIGZvciAodmFyIF9pMyA9IDA7IF9pMyA8IHBhZ2Vfbm8gKyAzOyBfaTMrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2kzICsgMSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ubCIpOwogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKHRoaXMudG90YWxfcGFnZXMpOwogICAgICB9IGVsc2UgaWYgKHBhZ2Vfbm8gPj0gdGhpcy50b3RhbF9wYWdlcyAtIDQpIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwoKICAgICAgICBmb3IgKHZhciBfaTQgPSBwYWdlX25vIC0gNDsgX2k0IDwgdGhpcy50b3RhbF9wYWdlczsgX2k0KyspIHsKICAgICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKF9pNCArIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgxKTsKICAgICAgICB0aGlzLnBhZ2VfYXJyYXkucHVzaCgiLi4ucyIpOwoKICAgICAgICBmb3IgKHZhciBfaTUgPSBwYWdlX25vIC0gMzsgX2k1IDw9IHBhZ2Vfbm8gKyAzOyBfaTUrKykgewogICAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2goX2k1KTsKICAgICAgICB9CgogICAgICAgIHRoaXMucGFnZV9hcnJheS5wdXNoKCIuLi5sIik7CiAgICAgICAgdGhpcy5wYWdlX2FycmF5LnB1c2godGhpcy50b3RhbF9wYWdlcyk7CiAgICAgIH0KICAgIH0sCiAgICBwYWdlX3JlcXVpcmU6IGZ1bmN0aW9uIHBhZ2VfcmVxdWlyZShwYWdlKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwoKICAgICAgaWYgKHBhZ2UgPT0gMCB8fCBwYWdlID09IHRoaXMudG90YWxfcGFnZXMgKyAxKSB7fSBlbHNlIHsKICAgICAgICAkKCJpbnB1dDpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCBmYWxzZSk7CgogICAgICAgIGlmIChwYWdlID09ICIuLi5zIikgewogICAgICAgICAgdGhpcy5wYWdlX25vID0gTWF0aC5jZWlsKCgxICsgdGhpcy5wYWdlX25vKSAvIDIpOwogICAgICAgIH0gZWxzZSBpZiAocGFnZSA9PSAiLi4ubCIpIHsKICAgICAgICAgIHRoaXMucGFnZV9ubyA9IE1hdGguY2VpbCgodGhpcy50b3RhbF9wYWdlcyArIHRoaXMucGFnZV9ubykgLyAyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5wYWdlX25vID0gcGFnZTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnNlYXJjaF9uYW1lID09ICIiKSB7CiAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgICAgY29tcGFueV9pZDogdGhpcy5jb21wYW55aWQsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBzdWJzY3JpcHRpb246IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5zdWJzY3JpcHRpb24sCiAgICAgICAgICAgIGlzRGVsZXRlOiAiRmFsc2UiLAogICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICBpc19nZXRfdXNlcl9yZXNwb25zZTogZmFsc2UKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQodGhpcy4kc2Vzc2lvbi5nZXQoImF0IikpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIF90aGlzMy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICBfdGhpczMudW5hbnN3ZXJlZF9saXN0ID0gW107CgogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczMuYXBpX3N0YXR1c19jb2RlLkRBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLmRhdGFbMF0pIHsKICAgICAgICAgICAgICAgIHZhciB0ZW1wX2ludCA9ICIiOwoKICAgICAgICAgICAgICAgIGlmIChCb29sZWFuKHJlc3BvbnNlLmRhdGEuZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgICAgLy8gdGVtcF9pbnQgPSByZXNwb25zZS5kYXRhWzJdW2ldLnJlcGxhY2UodGhpcy5jb21wYW55aWQgKyAiXyIsICIiKTsKICAgICAgICAgICAgICAgICAgdGVtcF9pbnQgPSByZXNwb25zZS5kYXRhLmRhdGFbMl1baV07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMzLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgcXVlc3Rpb246IHJlc3BvbnNlLmRhdGEuZGF0YVswXVtpXSwKICAgICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgICAgc291cmNlOiByZXNwb25zZS5kYXRhLmRhdGFbMV1baV0sCiAgICAgICAgICAgICAgICAgIHVzZXJfcmVzcG9uc2U6IHJlc3BvbnNlLmRhdGEuZGF0YVsyXVtpXSwKICAgICAgICAgICAgICAgICAgdXNlcl9mZWVkYmFjazogcmVzcG9uc2UuZGF0YS5kYXRhWzNdW2ldLAogICAgICAgICAgICAgICAgICBlZGl0OiBmYWxzZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczMuc2V0cGFnaW5hdGlvbihfdGhpczMucGFnZV9ubyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczMuYXBpX3N0YXR1c19jb2RlLk5PX0RBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICAgICAgU3dhbCh7CiAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHLAogICAgICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLWVuZCIsCiAgICAgICAgICAgICAgICB0aW1lcjogMjUwMCwKICAgICAgICAgICAgICAgIHR5cGU6ICJpbmZvIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIF90aGlzMy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgICAgIHRleHQ6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0csCiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHRpbWVyOiAyNTAwLAogICAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICBfdGhpczMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X2lkLAogICAgICAgICAgICBjb21wYW55X25hbWU6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5jb21wYW55X25hbWUsCiAgICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgICBpc3NlYXJjaDogdHJ1ZSwKICAgICAgICAgICAgLy8gc2VhcmNoYnk6IHRoaXMuc2VhcmNoX2J5LAogICAgICAgICAgICBrZXk6IHRoaXMuc2VhcmNoX25hbWUsCiAgICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgICBwYWdlX25vOiB0aGlzLnBhZ2Vfbm8sCiAgICAgICAgICAgIGlzX2dldF91c2VyX3Jlc3BvbnNlOiBmYWxzZQogICAgICAgICAgfSwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXMzLnNob3dfbG9hZGVyID0gZmFsc2U7CgogICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2UgIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgX3RoaXMzLnBhZ2Vfbm8gPSBwYWdlOwogICAgICAgICAgICAgIF90aGlzMy51bmFuc3dlcmVkX2xpc3QgPSBbXTsKICAgICAgICAgICAgICBfdGhpczMubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfZGF0YTsKICAgICAgICAgICAgICBfdGhpczMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZTsKICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzcG9uc2UuZGF0YS5kYXRhWzBdKSB7CiAgICAgICAgICAgICAgICB2YXIgdGVtcF9pbnQgPSAiIjsKCiAgICAgICAgICAgICAgICBpZiAoQm9vbGVhbihkYXRhWzJdW2ldKSkgewogICAgICAgICAgICAgICAgICAvLyB0ZW1wX2ludCA9IGRhdGFbMl1baV0ucmVwbGFjZSh0aGlzLmNvbXBhbnlpZCArICJfIiwgIiIpOwogICAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IGRhdGFbMl1baV07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMzLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgcXVlc3Rpb246IHJlc3BvbnNlLmRhdGEuZGF0YVswXVtpXSwKICAgICAgICAgICAgICAgICAgaW50ZW50OiB0ZW1wX2ludCwKICAgICAgICAgICAgICAgICAgc291cmNlOiByZXNwb25zZS5kYXRhLmRhdGFbMV1baV0sCiAgICAgICAgICAgICAgICAgIHVzZXJfcmVzcG9uc2U6IHJlc3BvbnNlLmRhdGEuZGF0YVsyXVtpXSwKICAgICAgICAgICAgICAgICAgdXNlcl9mZWVkYmFjazogcmVzcG9uc2UuZGF0YS5kYXRhWzNdW2ldLAogICAgICAgICAgICAgICAgICBlZGl0OiBmYWxzZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczMuc2V0cGFnaW5hdGlvbihfdGhpczMucGFnZV9ubyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKCJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiKTsgLy8gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgLy8gdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgICAgLy8gfSwgMjUwMCk7CgogICAgICAgICAgICAgIF90aGlzMy5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgICBfdGhpczMuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHF1ZXN0aW9uX3NlbGVjdGVkOiBmdW5jdGlvbiBxdWVzdGlvbl9zZWxlY3RlZCh2YWx1ZSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgIGlmICh2YWx1ZSA9PSAiYWxsIikgewogICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSBbXTsKCiAgICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMudW5hbnN3ZXJlZF9saXN0KSB7CiAgICAgICAgICAgIHRoaXMuY2hlY2tlZF9saXN0LnB1c2godGhpcy51bmFuc3dlcmVkX2xpc3RbaV0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRfbGlzdC5wdXNoKHRoaXMudW5hbnN3ZXJlZF9saXN0W3ZhbHVlXSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKCFldmVudC50YXJnZXQuY2hlY2tlZCkgewogICAgICAgIGlmICh2YWx1ZSAhPSAiYWxsIikgewogICAgICAgICAgdmFyIHNlbGVjdGFsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNzZWxlY3RhbGwiKTsKCiAgICAgICAgICBpZiAoc2VsZWN0YWxsLmNoZWNrZWQpIHsKICAgICAgICAgICAgc2VsZWN0YWxsLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgdGVtcCA9IHRoaXMuY2hlY2tlZF9saXN0LmZpbHRlcihmdW5jdGlvbiAocXVlc3Rpb24pIHsKICAgICAgICAgICAgcmV0dXJuIHF1ZXN0aW9uICE9PSBfdGhpczQudW5hbnN3ZXJlZF9saXN0W3ZhbHVlXTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5jaGVja2VkX2xpc3QgPSB0ZW1wOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGRlbGV0ZV9zaW5nbGU6IGZ1bmN0aW9uIGRlbGV0ZV9zaW5nbGUoaW5kZXgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgdmFyIHF1ZXN0aW9ubGlzdCA9IFtdOwogICAgICBTd2FsLmZpcmUoewogICAgICAgIHRpdGxlOiB0aGlzLnRsdCgndW5hbnN3ZXJlZF9kZWxldGVfc3dhbF9tc2cnKSwKICAgICAgICB0ZXh0OiB0aGlzLnRsdCgndW5hbnN3ZXJlZF9kZWxldGVfdGhpc19xc19tc2cnKSwKICAgICAgICB0eXBlOiAicXVlc3Rpb24iLAogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICIjZDMzIiwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogdGhpcy50bHQoJ3VuYW5zd2VyZWRfZGVsZXRlX3N3YWxfY29uZmlybV9tc2cnKQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICBfdGhpczUuc2hvd19sb2FkZXIgPSBmYWxzZTsgLy8gY29uc29sZS5sb2cocmVzdWx0LnZhbHVlKTsKCiAgICAgICAgaWYgKHJlc3VsdC52YWx1ZSkgewogICAgICAgICAgLy8gY29uc29sZS5sb2coImRlbGV0ZWQiKTsKICAgICAgICAgIHF1ZXN0aW9ubGlzdC5wdXNoKF90aGlzNS51bmFuc3dlcmVkX2xpc3RbaW5kZXhdLnF1ZXN0aW9uKTsKCiAgICAgICAgICBfdGhpczUuZGVsZXRlX3F1ZXN0aW9uc19hcGkocXVlc3Rpb25saXN0KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGRlbGV0ZV9tdWx0aXBsZTogZnVuY3Rpb24gZGVsZXRlX211bHRpcGxlKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmNoZWNrZWRfbGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ3VuYW5zd2VyZWRfZGVsZXRlX25vX3FzX3NlbGVjdGVkX21zZycpLAogICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiLAogICAgICAgICAgdGltZXI6IDIwMDAKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNoZWNrZWRfbGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIHF1ZXN0aW9ubGlzdCA9IFtdOwogICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogdGhpcy50bHQoJ3VuYW5zd2VyZWRfZGVsZXRlX3N3YWxfYWxlcnRfbXNnJyksCiAgICAgICAgICB0ZXh0OiB0aGlzLnRsdCgndW5hbnN3ZXJlZF9kZWxldGVfdGhpc19xc19tdWx0aXBsZV9tc2cnKSwKICAgICAgICAgIHR5cGU6ICJxdWVzdGlvbiIsCiAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLAogICAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsCiAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IHRoaXMudGx0KCd1bmFuc3dlcmVkX2RlbGV0ZV9jb25maXJtX3N3YWxfbXNnJykKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBfdGhpczYuY2hlY2tlZF9saXN0KSB7CiAgICAgICAgICAgICAgcXVlc3Rpb25saXN0LnB1c2goX3RoaXM2LmNoZWNrZWRfbGlzdFtpXS5xdWVzdGlvbik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzNi5kZWxldGVfcXVlc3Rpb25zX2FwaShxdWVzdGlvbmxpc3QpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlX3F1ZXN0aW9uc19hcGk6IGZ1bmN0aW9uIGRlbGV0ZV9xdWVzdGlvbnNfYXBpKHF1ZXN0aW9ubGlzdCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwgewogICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICBxdWVzdGlvbmxpc3Q6IHF1ZXN0aW9ubGlzdCwKICAgICAgICBpc0RlbGV0ZTogIlRydWUiLAogICAgICAgIGVtYWlsOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuZW1haWwsCiAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICB0b2tlbjogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLnRva2VucwogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM3LnNob3dfbG9hZGVyID0gZmFsc2U7CgogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzNy5hcGlfc3RhdHVzX2NvZGUuREVMRVRFRF9TVUNDRVNTRlVMTFlfMDAwNC5NU0dfQ09ERSkgewogICAgICAgICAgLy8gY29uc29sZS5sb2coImRlbGV0ZWQgc3VjY2Vzc2Z1bGx5Iik7CiAgICAgICAgICBfdGhpczcuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgICBfdGhpczcubnVtYmVyX29mX3Jvd3MgPSByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfZGF0YSA9PSB1bmRlZmluZWQgPyAwIDogcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX2RhdGE7CiAgICAgICAgICBfdGhpczcudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZSA9PSB1bmRlZmluZWQgPyAwIDogcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2U7CiAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhfdGhpczcudGx0KCd1bmFuc3dlcmVkX2RlbGV0ZV9zdWNjZXNzX21zZycpKTsgLy8gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgIC8vIH0sIDE1MDApOwoKICAgICAgICAgIGlmIChxdWVzdGlvbmxpc3QubGVuZ3RoID09PSBfdGhpczcudW5hbnN3ZXJlZF9saXN0Lmxlbmd0aCAmJiBfdGhpczcucGFnZV9ubyA+IDEpIHsKICAgICAgICAgICAgX3RoaXM3LnBhZ2Vfbm8gPSBfdGhpczcucGFnZV9ubyAtIDE7CiAgICAgICAgICB9CgogICAgICAgICAgd2hpbGUgKF90aGlzNy5wYWdlX25vID4gMSAmJiBfdGhpczcucGFnZV9ubyA+IF90aGlzNy50b3RhbF9wYWdlcykgewogICAgICAgICAgICBfdGhpczcucGFnZV9ubyA9IF90aGlzNy5wYWdlX25vIC0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczcubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXM3LnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICBTd2FsKHsKICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLmRhdGEubWVzc2FnZS5NU0dfQ09ERSwKICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgX3RoaXM3LnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICBfdGhpczcuJHJvb3QuJGVtaXQoIlNlc3Npb25fRXhwaXJlZCIsIGUucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRvYXN0ci5lcnJvcihlLm1lc3NhZ2UpOwogICAgICAgIH0KCiAgICAgICAgX3RoaXM3LnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIGVkaXRfaXRlbTogZnVuY3Rpb24gZWRpdF9pdGVtKGluZGV4KSB7CiAgICAgIHRoaXMudW5hbnN3ZXJlZF9saXN0W2luZGV4XS5lZGl0ID0gIXRoaXMudW5hbnN3ZXJlZF9saXN0W2luZGV4XS5lZGl0OwogICAgICB0aGlzLm9sZF9xdWVzdGlvbiA9IHRoaXMudW5hbnN3ZXJlZF9saXN0W2luZGV4XS5xdWVzdGlvbjsgLy8gdGhpcy5vbGRfaW50ZW50ID0gdGhpcy51bmFuc3dlcmVkX2xpc3RbaW5kZXhdLmludGVudDsKCiAgICAgIHRoaXMub2xkX2RhdGEucXVlc3Rpb24gPSB0aGlzLm9sZF9xdWVzdGlvbjsgLy8gdGhpcy5vbGRfZGF0YS5pbnRlbnQgPSB0aGlzLmNvbXBhbnlpZCArICJfIiArIHRoaXMub2xkX2ludGVudDsKICAgICAgLy8gdGhpcy5xdWVzdGlvbiA9IHF1ZXN0aW9uLnF1ZXN0aW9uOwogICAgICAvLyB0aGlzLmludGVudCA9IHF1ZXN0aW9uLmludGVudDsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy5vbGRfZGF0YSk7CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMub2xkX3F1ZXN0aW9uKTsKICAgIH0sCiAgICBzdWJtaXRfcXVlc3Rpb246IGZ1bmN0aW9uIHN1Ym1pdF9xdWVzdGlvbigpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICAvLyBjb25zb2xlLmxvZygic3VibWl0Iik7CiAgICAgIC8vIGNvbnNvbGUubG9nKCJxdWVzdGlvbiIsIHRoaXMub2xkX3F1ZXN0aW9uKTsKICAgICAgLy8gY29uc29sZS5sb2coImludGVudCIsIHRoaXMub2xkX2ludGVudCk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCJpbnRlbnQiLCB0aGlzLmlzZWRpdCk7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAodGhpcy5vbGRfcXVlc3Rpb24gPT0gIiIpIHsKICAgICAgICB0b2FzdHIuZXJyb3IodGhpcy50bHQoJ3VuYW5zd2VyZWRfZW50ZXJfYWxsX2ZpZWxkX21zZycpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNob3dfbG9hZGVyID0gdHJ1ZTsKICAgICAgICBheGlvcy5wb3N0KGFwaV9jYWxscy5nZXRfdW5hbnN3ZXJlZF91cmwoKSwgewogICAgICAgICAgaXNfRWRpdDogIlRydWUiLAogICAgICAgICAgcXVlc3Rpb246IHRoaXMub2xkX3F1ZXN0aW9uLAogICAgICAgICAgLy8gaW50ZW50OiB0aGlzLmNvbXBhbnlpZCArICJfIiArIHRoaXMub2xkX2ludGVudCwKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgb2xkX3F1ZXN0aW9uX2RhdGE6IHRoaXMub2xkX2RhdGEsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zLAogICAgICAgICAgc3Vic2NyaXB0aW9uOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuc3Vic2NyaXB0aW9uCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczguc2hvd19sb2FkZXIgPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczguYXBpX3N0YXR1c19jb2RlLklOVEVSTkFMX1NFUlZFUl9FUlJPUi5NU0dfQ09ERSkgewogICAgICAgICAgICB0b2FzdHIuZXJyb3IoX3RoaXM4LnRsdCgndW5hbnN3ZXJlZF9pbnRlcnZhbF9zZXJ2ZXJfbXNnJykpOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzOC5hcGlfc3RhdHVzX2NvZGUuRURJVEVEX1NVQ0NFU1NGVUxMWV8wMDA1Lk1TR19DT0RFKSB7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICB0ZXh0OiBfdGhpczgudGx0KCd1bmFuc3dlcmVkX3FzX2VkaXRlZF9zdWNjZXNzZnVsX21zZycpLAogICAgICAgICAgICAgIHRpbWVyOiAyNTAwCiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgIC8vIGlmIChyZXN1bHQudmFsdWUpIHsKICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oKTsKICAgICAgICAgICAgICAvLyB9CiAgICAgICAgICAgICAgX3RoaXM4LmxvYWRfdmVyaWZ5X3Jlc3BvbnNlc191bmFuc3dlcmVkKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXM4LnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gLy8gZWxzZSBpZiAocmVzcG9uc2UuZGF0YSA9PSAiUXVlc3Rpb24gSW50ZW50IFVwZGF0ZWQiKSB7CiAgICAgICAgICAvLyBTd2FsKHsKICAgICAgICAgIC8vICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAvLyAgICAgdGV4dDogIllvdXIgcXVlc3Rpb24gaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgLy8gICAgIHRpbWVyOjIwMDAsCiAgICAgICAgICAvLyB9KS50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgIC8vICAgICAvLyBpZiAocmVzdWx0LnZhbHVlKSB7CiAgICAgICAgICAvLyAgICAgLy8gdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAvLyAgICAgLy8gfQogICAgICAgICAgLy8gICAgIHRoaXMubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQoKTsKICAgICAgICAgIC8vIH0pOwogICAgICAgICAgLy8gfQoKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzOC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihfdGhpczgudGx0KCd1bmFuc3dlcmVkX2ludGVydmFsX3NlcnZlcl9tc2cxJykpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuY2xvc2VfbW9kYWwoJ2FkZF9xdWVzbl9zYXZlJyk7CiAgICAgIH0KICAgIH0sCiAgICBwYWdpbmF0aW9uX2NsYXNzOiBmdW5jdGlvbiBwYWdpbmF0aW9uX2NsYXNzKGluZGV4KSB7CiAgICAgIGlmIChpbmRleCA9PSB0aGlzLnBhZ2Vfbm8pIHsKICAgICAgICByZXR1cm4gIiBhY3RpdmUiOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgfSwKICAgIGFkZF9xdWVzdGlvbnM6IGZ1bmN0aW9uIGFkZF9xdWVzdGlvbnMoKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgdGhpcy5zaG93X2xvYWRlciA9IHRydWU7CiAgICAgIHZhciBxdWVzdGlvbmxpc3QgPSBbXTsKICAgICAgdmFyIHRlbXBfbGlzdCA9IFtdOwogICAgICB2YXIgZW1wdHkgPSB0aGlzLnVuYW5zd2VyZWRfbGlzdC5maWx0ZXIoZnVuY3Rpb24gKHVuYW5zd2VyZWQpIHsKICAgICAgICByZXR1cm4gdW5hbnN3ZXJlZC5pbnRlbnQgPT0gIiI7CiAgICAgIH0pOwoKICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLnVuYW5zd2VyZWRfbGlzdCkgewogICAgICAgIGlmICh0aGlzLnVuYW5zd2VyZWRfbGlzdFtpXS5pbnRlbnQgIT0gIiIpIHsKICAgICAgICAgIHRlbXBfbGlzdC5wdXNoKHRoaXMudW5hbnN3ZXJlZF9saXN0W2ldLnF1ZXN0aW9uLCAvLyB0aGlzLmNvbXBhbnlpZCArICJfIiArIHRoaXMudW5hbnN3ZXJlZF9saXN0W2ldLmludGVudAogICAgICAgICAgdGhpcy51bmFuc3dlcmVkX2xpc3RbaV0uaW50ZW50KTsKICAgICAgICAgIHF1ZXN0aW9ubGlzdC5wdXNoKHRlbXBfbGlzdCk7CiAgICAgICAgfQoKICAgICAgICB0ZW1wX2xpc3QgPSBbXTsKICAgICAgfQoKICAgICAgaWYgKHF1ZXN0aW9ubGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgdGhpcy5zaG93X2xvYWRlciA9IHRydWU7CiAgICAgICAgYXhpb3MucG9zdChhcGlfY2FsbHMuZ2V0X3VuYW5zd2VyZWRfdXJsKCksIHsKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy5jb21wYW55bmFtZSwKICAgICAgICAgIGNvbXBhbnlfaWQ6IHRoaXMuY29tcGFueWlkLAogICAgICAgICAgaXNBZGQ6ICJUcnVlIiwKICAgICAgICAgIHF1ZXN0aW9uaW50ZW50OiBxdWVzdGlvbmxpc3QsCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgbGljZW5zZV9rZXk6IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS5saWNlbnNlX2tleSwKICAgICAgICAgIHRva2VuOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikudG9rZW5zCiAgICAgICAgfSwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHRoaXMuJHNlc3Npb24uZ2V0KCJhdCIpKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczkuc2hvd19sb2FkZXIgPSBmYWxzZTsKCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TR19DT0RFID09PSBfdGhpczkuYXBpX3N0YXR1c19jb2RlLkFEREVEX1NVQ0NFU1NGVUxMWV8wMDAyLk1TR19DT0RFKSB7CiAgICAgICAgICAgIHN3YWwoewogICAgICAgICAgICAgIHRleHQ6IF90aGlzOS50bHQoJ3VuYW5zd2VyZWRfYWRkZWRfc3VjY2Vzc2Z1bF9tc2cnKSwKICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgdGltZXI6IDMwMDAKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAocXVlc3Rpb25saXN0Lmxlbmd0aCA9PT0gX3RoaXM5LnVuYW5zd2VyZWRfbGlzdC5sZW5ndGggJiYgX3RoaXM5LnBhZ2Vfbm8gPiAxKSB7CiAgICAgICAgICAgICAgX3RoaXM5LnBhZ2Vfbm8gPSBfdGhpczkucGFnZV9ubyAtIDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzOS5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXM5LnNob3dfbG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgIFN3YWwoewogICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUsCiAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UuZGF0YS5tZXNzYWdlLk1TRywKICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgdGltZXI6IDI1MDAsCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgX3RoaXM5LnNob3dfbG9hZGVyID0gZmFsc2U7CgogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MTAgfHwgZS5yZXNwb25zZS5zdGF0dXMgPT09IDQ0MCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA5KSB7CiAgICAgICAgICAgIF90aGlzOS4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0b2FzdHIuZXJyb3IodGhpcy50bHQoJ3VuYW5zd2VyZWRfYWRkX3F1ZXN0aW9uX21zZycpKTsKICAgICAgfQoKICAgICAgdGhpcy5zaG93X2xvYWRlciA9IGZhbHNlOwogICAgfSwKICAgIHNlYXJjaF9xdWVzdGlvbjogZnVuY3Rpb24gc2VhcmNoX3F1ZXN0aW9uKCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICAvLyBpZih0aGlzLnNlYXJjaF9ieSE9JycpewogICAgICBpZiAodGhpcy5zZWFyY2hfbmFtZSAhPSAiIikgewogICAgICAgIHRoaXMuY2hlY2tlZF9saXN0ID0gW107CiAgICAgICAgJCgiaW5wdXQ6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIiwgZmFsc2UpOwogICAgICAgIHRoaXMuc2hvd19sb2FkZXIgPSB0cnVlOwogICAgICAgIGF4aW9zLnBvc3QoYXBpX2NhbGxzLmdldF91bmFuc3dlcmVkX3VybCgpLCB7CiAgICAgICAgICBjb21wYW55X2lkOiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikuY29tcGFueV9pZCwKICAgICAgICAgIGNvbXBhbnlfbmFtZTogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmNvbXBhbnlfbmFtZSwKICAgICAgICAgIGxpY2Vuc2Vfa2V5OiB0aGlzLiRzZXNzaW9uLmdldCgiVXNlckluZm9ybWF0aW9uIikubGljZW5zZV9rZXksCiAgICAgICAgICBlbWFpbDogdGhpcy4kc2Vzc2lvbi5nZXQoIlVzZXJJbmZvcm1hdGlvbiIpLmVtYWlsLAogICAgICAgICAgdG9rZW46IHRoaXMuJHNlc3Npb24uZ2V0KCJVc2VySW5mb3JtYXRpb24iKS50b2tlbnMsCiAgICAgICAgICBpc3NlYXJjaDogdHJ1ZSwKICAgICAgICAgIC8vIHNlYXJjaGJ5OiB0aGlzLnNlYXJjaF9ieSwKICAgICAgICAgIGtleTogdGhpcy5zZWFyY2hfbmFtZSwKICAgICAgICAgIHBlcl9wYWdlOiB0aGlzLnBlcl9wYWdlLAogICAgICAgICAgcGFnZV9ubzogMSwKICAgICAgICAgIGlzX2dldF91c2VyX3Jlc3BvbnNlOiBmYWxzZQogICAgICAgIH0sIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdCh0aGlzLiRzZXNzaW9uLmdldCgiYXQiKSkKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXMxMC5zaG93X2xvYWRlciA9IGZhbHNlOwoKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UuTVNHX0NPREUgPT09IF90aGlzMTAuYXBpX3N0YXR1c19jb2RlLk5PX0RBVEFfQVZBSUxBQkxFLk1TR19DT0RFKSB7CiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihfdGhpczEwLnRsdCgndW5hbnN3ZXJlZF9ub19xc19mb3VuZF9tc2cnKSk7IC8vIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAvLyAgICAgdGhpcy4kcm91dGVyLmdvKCk7CiAgICAgICAgICAgIC8vIH0sIDI1MDApOwoKICAgICAgICAgICAgX3RoaXMxMC5sb2FkX3ZlcmlmeV9yZXNwb25zZXNfdW5hbnN3ZXJlZCgpOwogICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5kYXRhLnBhZ2luYXRpb24udG90YWxfcGFnZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgX3RoaXMxMC5wYWdlX25vID0gMTsKICAgICAgICAgICAgX3RoaXMxMC51bmFuc3dlcmVkX2xpc3QgPSBbXTsKICAgICAgICAgICAgX3RoaXMxMC5udW1iZXJfb2Zfcm93cyA9IHJlc3BvbnNlLmRhdGEucGFnaW5hdGlvbi50b3RhbF9kYXRhOwogICAgICAgICAgICBfdGhpczEwLnRvdGFsX3BhZ2VzID0gcmVzcG9uc2UuZGF0YS5wYWdpbmF0aW9uLnRvdGFsX3BhZ2U7CiAgICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhOwoKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXNwb25zZS5kYXRhLmRhdGFbMF0pIHsKICAgICAgICAgICAgICB2YXIgdGVtcF9pbnQgPSAiIjsKCiAgICAgICAgICAgICAgaWYgKEJvb2xlYW4oZGF0YVsyXVtpXSkpIHsKICAgICAgICAgICAgICAgIC8vIHRlbXBfaW50ID0gZGF0YVsyXVtpXS5yZXBsYWNlKHRoaXMuY29tcGFueWlkICsgIl8iLCAiIik7CiAgICAgICAgICAgICAgICB0ZW1wX2ludCA9IGRhdGFbMl1baV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfdGhpczEwLnVuYW5zd2VyZWRfbGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiByZXNwb25zZS5kYXRhLmRhdGFbMF1baV0sCiAgICAgICAgICAgICAgICBpbnRlbnQ6IHRlbXBfaW50LAogICAgICAgICAgICAgICAgc291cmNlOiByZXNwb25zZS5kYXRhLmRhdGFbMV1baV0sCiAgICAgICAgICAgICAgICB1c2VyX3Jlc3BvbnNlOiBkYXRhWzJdW2ldLAogICAgICAgICAgICAgICAgdXNlcl9mZWVkYmFjazogZGF0YVszXVtpXSwKICAgICAgICAgICAgICAgIGVkaXQ6IGZhbHNlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzMTAuc2V0cGFnaW5hdGlvbihfdGhpczEwLnBhZ2Vfbm8pOwogICAgICAgICAgfSAvLyBlbHNlIGlmIChyZXNwb25zZS5kYXRhLk1TRyA9PSAiTm8gUXVlc3Rpb25zIEZvdW5kIikgewogICAgICAgICAgLy8gICB0b2FzdHIuZXJyb3IoIk5vIFF1ZXN0aW9uIEZvdW5kIik7CiAgICAgICAgICAvLyAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgLy8gICAgIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgLy8gICB9LCAyNTAwKTsKICAgICAgICAgIC8vIHRoaXMubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQoKTsKICAgICAgICAgIC8vIH0KICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihfdGhpczEwLnRsdCgndW5hbnN3ZXJlZF9pbnRlcm5hbF9zZXJ2ZXJfbXNnMicpKTsgLy8gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgLy8gICAgIHRoaXMuJHJvdXRlci5nbygpOwogICAgICAgICAgICAgIC8vICAgfSwgMjUwMCk7CgogICAgICAgICAgICAgIF90aGlzMTAubG9hZF92ZXJpZnlfcmVzcG9uc2VzX3VuYW5zd2VyZWQoKTsKICAgICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBpZiAoZS5yZXNwb25zZS5zdGF0dXMgPT09IDQxMCB8fCBlLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDQwIHx8IGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDkpIHsKICAgICAgICAgICAgX3RoaXMxMC4kcm9vdC4kZW1pdCgiU2Vzc2lvbl9FeHBpcmVkIiwgZS5yZXNwb25zZS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0b2FzdHIuZXJyb3IodGhpcy50bHQoJ3VuYW5zd2VyZWRfZGF0YV9mb3Jfc2VhcmNoX21zZycpKTsKICAgICAgfSAvLyB9ZWxzZXsKICAgICAgLy8gICB0b2FzdHIuZXJyb3IoIlNlbGVjdCBoZWFkZXIgZm9yIHNlYXJjaGluZyIpOwogICAgICAvLyB9CgogICAgfQogIH0KfTs="},null]}