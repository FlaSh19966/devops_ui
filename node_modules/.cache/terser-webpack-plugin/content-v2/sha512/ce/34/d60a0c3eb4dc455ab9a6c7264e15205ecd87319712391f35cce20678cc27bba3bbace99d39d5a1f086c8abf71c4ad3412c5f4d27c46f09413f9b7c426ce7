{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-b1ee98f0\"],{\"0cce\":function(t,e,s){},\"31c4\":function(t,e,s){\"use strict\";var a=s(\"6de3\"),i=s.n(a);i.a},\"6de3\":function(t,e,s){},\"8d71\":function(t,e,s){\"use strict\";var a=s(\"0cce\"),i=s.n(a);i.a},c6eb:function(t,e,s){},d2ab:function(t,e,s){\"use strict\";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",[s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.spinnerOn,expression:\"spinnerOn\"}],staticClass:\"spinner\",attrs:{id:\"spinner\"}}),s(\"div\",{staticClass:\"dash-cont\"},[s(\"div\",{staticClass:\"container-fluid\"},[s(\"div\",{staticClass:\"card dash-card\"},[s(\"div\",{staticClass:\"card-header d-block d-sm-flex flex-wrap justify-content-between\"},[s(\"h4\",{staticClass:\"mb-sm-0\"},[t._v(\"Chat History\")]),s(\"div\",{staticClass:\"card-act d-flex\"},[s(\"div\",{staticClass:\"form-group mb-0\"},[s(\"select\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.filter_chat_history,expression:\"filter_chat_history\"}],staticClass:\"form-control\",attrs:{id:\"exampleFormControlSelect1\"},on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e=\"_value\"in t?t._value:t.value;return e}));t.filter_chat_history=e.target.multiple?s:s[0]},t.load_task_responses]}},[s(\"option\",[t._v(\"Last 7 days\")]),s(\"option\",[t._v(\"Last 30 days\")]),s(\"option\",[t._v(\"Last 3 months\")]),s(\"option\",[t._v(\"Last 9 months\")]),s(\"option\",[t._v(\"Last 12 months\")]),s(\"option\",[t._v(\"All\")])])])])]),s(\"div\",{staticClass:\"card-body\"},[s(\"ul\",{staticClass:\"nav nav-tabs mb-3\",attrs:{id:\"myTab\",role:\"tablist\"}},[s(\"li\",{staticClass:\"nav-item\"},[s(\"a\",{staticClass:\"nav-link pl-5 pr-5\",attrs:{id:\"portal_user-tab\",\"data-toggle\":\"tab\",href:\"#portal_user\",role:\"tab\",\"aria-controls\":\"portal_user\"},on:{click:function(e){t.view_component_name=\"portal_user\"}}},[t._v(\"Portal User\")])]),s(\"li\",{staticClass:\"nav-item\"},[s(\"a\",{staticClass:\"nav-link pl-5 pr-5\",attrs:{id:\"bot_user-tab\",\"data-toggle\":\"tab\",href:\"#bot_user\",role:\"tab\",\"aria-controls\":\"bot_user\"},on:{click:function(e){t.view_component_name=\"bot_user\"}}},[t._v(\"Bot User\")])])]),s(\"div\",{staticClass:\"tab-content\",attrs:{id:\"myTabContent\"}},[s(\"div\",{staticClass:\"tab-pane fade\",attrs:{id:\"portal_user\",role:\"tabpanel\",\"aria-labelledby\":\"portal_user-tab\"}},[\"portal_user\"===t.view_component_name?[s(\"portal-user-chat-history\")]:t._e()],2),s(\"div\",{staticClass:\"tab-pane fade\",attrs:{id:\"bot_user\",role:\"tabpanel\",\"aria-labelledby\":\"bot_user-tab\"}},[\"bot_user\"===t.view_component_name?[s(\"bot-user-chat-history\")]:t._e()],2)])])])])])])},i=[],r=s(\"bc3a\"),n=s.n(r),o=s(\"ea54\"),c=s.n(o),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"table-box\"},[s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.show_loader,expression:\"show_loader\"}],staticClass:\"spinner\",attrs:{id:\"spinner\"}}),\"general_chat_history\"!=t.selected?s(\"div\",{staticClass:\"table-responsive\",staticStyle:{\"min-height\":\"349px\"}},[s(\"table\",{staticClass:\"table\"},[t._m(0),t._l(t.user_action_stats,(function(e,a){return s(\"tr\",{key:a},[\"Bot User\"!=e.username&&\"\"!=e.username&&Boolean(e.username)?[s(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\" \"+t._s(e.username)+\" \")]),s(\"td\",t._l(e.action_list,(function(e,i){return s(\"tr\",{key:i},[s(\"td\",{staticStyle:{width:\"50%\",\"text-align\":\"center\"}},[s(\"a\",{attrs:{href:\"javascript:void(0)\",\"data-toggle\":\"modal\",\"data-target\":\"#conversation_model\"},on:{click:function(e){return t.chat_conversation(a,i)}}},[t._v(t._s(e.name))])])])})),0),s(\"td\",{staticStyle:{\"text-align\":\"center\"}},t._l(e.action_list,(function(e,a){return s(\"tr\",{key:a},[s(\"td\",{staticStyle:{width:\"10%\"}},[t._v(t._s(e.date))])])})),0),s(\"td\",{staticStyle:{\"text-align\":\"center\"}},t._l(e.action_list,(function(e,a){return s(\"tr\",{key:a},[s(\"td\",{staticStyle:{width:\"10%\"}},[t._v(t._s(e.time))])])})),0)]:t._e()],2)}))],2)]):t._e(),\"general_chat_history\"==t.selected?s(\"div\",{staticClass:\"table-responsive\",staticStyle:{\"min-height\":\"349px\"}},[s(\"table\",{staticClass:\"table\"},[t._m(1),t._l(t.user_action_stats,(function(e,a){return s(\"tr\",{key:a},[[s(\"td\",{staticClass:\"text-center\"},[t._v(t._s(e.useremail))]),s(\"td\",{staticClass:\"text-center\"},[t._v(t._s(t.format_date_in_local_timezone(e.date)))]),s(\"td\",{staticStyle:{width:\"50%\",\"text-align\":\"center\"}},[s(\"a\",{staticStyle:{\"text-align\":\"center\"},attrs:{href:\"javascript:void(0)\",\"data-toggle\":\"modal\",\"data-target\":\"#conversation_model1\"},on:{click:function(e){return t.chat_date(a)}}},[t._v(\"View Chat History\")])])]],2)}))],2)]):t._e(),s(\"div\",{staticClass:\"pagin-table\",staticStyle:{\"margin-top\":\"2%\"}},[s(\"nav\",{attrs:{\"aria-label\":\"Page navigation example\"}},[s(\"ul\",{staticClass:\"pagination justify-content-center\"},[s(\"li\",{staticClass:\"page-item\"},[s(\"a\",{staticClass:\"page-link\",attrs:{href:\"javascript:void(0)\"},on:{click:function(e){return t.page_require(t.page_no-1)}}},[s(\"svg\",{attrs:{xmlns:\"http://www.w3.org/2000/svg\",width:\"8.667\",height:\"15.204\",viewBox:\"0 0 8.667 15.204\"}},[s(\"g\",{attrs:{id:\"arrow-point-to-left\",transform:\"translate(105.806 15.204) rotate(180)\"}},[s(\"path\",{attrs:{id:\"Path_1136\",\"data-name\":\"Path 1136\",d:\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\",transform:\"translate(0 0)\",fill:\"#9499ae\"}})])])])]),t._l(t.page_array,(function(e){return s(\"li\",{key:e,class:\"page-item \"+t.pagination_class(e)},[\"...s\"==e||\"...l\"==e?s(\"a\",{staticClass:\"page-link\",attrs:{href:\"javascript:void(0)\"},on:{click:function(s){return t.page_require(e)}}},[t._v(\"...\")]):t._e(),\"...s\"!=e&&\"...l\"!=e?s(\"a\",{staticClass:\"page-link\",attrs:{href:\"#\"},on:{click:function(s){return t.page_require(e)}}},[t._v(t._s(e))]):t._e()])})),s(\"li\",{staticClass:\"page-item\"},[s(\"a\",{staticClass:\"page-link\",attrs:{href:\"javascript:void(0)\"},on:{click:function(e){return t.page_require(t.page_no+1)}}},[s(\"svg\",{attrs:{xmlns:\"http://www.w3.org/2000/svg\",width:\"8.667\",height:\"15.204\",viewBox:\"0 0 8.667 15.204\"}},[s(\"g\",{attrs:{id:\"arrow-point-to-right\",transform:\"translate(-97.139 0)\"}},[s(\"path\",{attrs:{id:\"Path_1136\",\"data-name\":\"Path 1136\",d:\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\",transform:\"translate(0 0)\",fill:\"#9499ae\"}})])])])])],2)])]),\"general_chat_history\"!=t.selected?s(\"div\",{staticClass:\"modal fade dash-modal\",staticStyle:{\"margin-left\":\"-1%\"},attrs:{id:\"conversation_model\",tabindex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"conversation_model\",\"aria-hidden\":\"true\"}},[s(\"div\",{staticClass:\"modal-dialog modal-dialog-centered\",attrs:{role:\"document\"}},[s(\"div\",{staticClass:\"modal-content\"},[s(\"div\",{staticClass:\"modal-body\"},[t._m(2),t._m(3),s(\"div\",t._l(t.user_reply,(function(e,a){return s(\"div\",{key:a},[s(\"span\",{staticClass:\"d-flex\"},[s(\"h5\",[t._v(t._s(t.current_user)+\": \")]),s(\"p\",[t._v(t._s(e))])]),s(\"span\",{staticStyle:{display:\"flex\"}},[s(\"h5\",[t._v(\"Bot: \")]),s(\"p\",[t._v(t._s(t.bot_reply[a]))])])])})),0)])])])]):t._e(),\"general_chat_history\"==t.selected?s(\"div\",{staticClass:\"modal fade dash-modal\",staticStyle:{\"margin-left\":\"-1%\"},attrs:{id:\"conversation_model1\",tabindex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"conversation_model1\",\"aria-hidden\":\"true\"}},[s(\"div\",{staticClass:\"modal-dialog modal-dialog-centered\",staticStyle:{\"max-width\":\"60%\"},attrs:{role:\"document\"}},[s(\"div\",{staticClass:\"modal-content\"},[s(\"div\",{staticClass:\"modal-body\"},[t._m(4),t._m(5),s(\"div\",[s(\"div\",{staticClass:\"form-group\"},[s(\"label\",[t._v(\"Select Time Range\")]),s(\"multiselect\",{attrs:{id:\"select_coversation_date\",options:t.chat_dates,searchable:!0,\"close-on-select\":!0,\"show-labels\":!1,\"allow-empty\":!1,placeholder:\"Select Time Range\",\"disabled-selected\":!1,\"hide-selected\":!1,\"max-height\":200},on:{input:t.chat_conversation},model:{value:t.selected_date,callback:function(e){t.selected_date=e},expression:\"selected_date\"}},[s(\"span\",[t._v(t._s(t.selected_date))])])],1),s(\"p\"),t._l(t.chatDetails,(function(e,a){return s(\"div\",{key:a,staticStyle:{\"text-align\":\"justify\"}},[\"\"!=e.UserQuery?s(\"span\",{staticClass:\"py-0 my-0\",staticStyle:{display:\"flex\",height:\"0%\"}},[s(\"h5\",{staticClass:\"py-0 mt-2 mb-0\",staticStyle:{float:\"left\",width:\"3%\",height:\"0%\"}},[t._v(\"Q:\")]),s(\"p\",{staticClass:\"py-0 mb-0\",staticStyle:{\"word-break\":\"break-all\",\"margin-top\":\"11px\"}},[t._v(\" \"+t._s(e.UserQuery)+\" \")])]):t._e(),\"\"!=e.UserQuery||t.checkintent(a)?s(\"div\",t._l(e.BOTResponse,(function(a,i){return s(\"span\",{key:i,style:t.check_bot_offers(e.BOTResponse)},[void 0!=a.img||void 0!=a.text||void 0!=a.products||void 0!=a.offers||\"utter_default\"==a.template||void 0!=a.contact_us_email||void 0!=a.contact_us_phone_number||void 0!=a.buttons?s(\"h5\",{staticClass:\"py-0 mt-0 mb-0\",staticStyle:{float:\"left\",width:\"3%\"}},[t._v(\" A: \")]):t._e(),!0===Boolean(a.buttons)&&\"\"==a.text?s(\"div\",{staticStyle:{width:\"max-content\"}},[!0===Boolean(a.buttons)&&a.buttons.length>0&&\"\"==a.text?s(\"strong\",{staticStyle:{color:\"dimgray\"}},[t._v(\" Options :\")]):t._e(),t._l(a.buttons,(function(e,a){return s(\"span\",{key:a,staticStyle:{border:\"1px solid #cccccc\",cursor:\"default\",padding:\"2px\",\"margin-right\":\"5px\",background:\"#f2f2f2\",\"border-radius\":\"5px\"}},[s(\"span\",{staticClass:\"p-0 mb-1\"},[t._v(\" \"+t._s(e.title))])])}))],2):t._e(),void 0!=a.contact_us_email?s(\"p\",{staticStyle:{\"margin-top\":\"2px\",\"margin-bottom\":\"0px\",width:\"100%\"},domProps:{innerHTML:t._s(t.messaging_platform_formating(a.contact_us_email)+t.messaging_platform_formating_number(a.contact_us_phone_number))}}):t._e(),void 0!=a.message?s(\"p\",{staticStyle:{\"margin-top\":\"2px\",\"margin-bottom\":\"0px\",width:\"100%\"},domProps:{innerHTML:t._s(t.confusion_message_formating(a.message))}}):t._e(),s(\"div\",[void 0!=a.text&&\"\"!=a.text?s(\"p\",{staticStyle:{\"margin-top\":\"2px\",\"margin-bottom\":\"0px\",width:\"100%\"},domProps:{innerHTML:t._s(a.text)}}):t._e(),void 0!=a.video&&\"\"!=a.video?s(\"span\",[s(\"a\",{attrs:{href:a.video,target:\"blank\"}},[t._v(\"Attach Video\")])]):t._e()]),t._l(a.offers,(function(e,i){return s(\"div\",{key:i,staticClass:\"pb-0\",staticStyle:{width:\"100%\",\"margin-bottom\":\"0px\",\"padding-left\":\"1.7rem\"}},[void 0!=a.offers?s(\"span\",{domProps:{innerHTML:t._s(e.offer)}}):t._e()])})),void 0!=a.img&&\"\"!=a.img?s(\"div\",{staticStyle:{float:\"left\",width:\"100%\"}},[s(\"img\",{attrs:{src:a.img}})]):t._e(),void 0!=a.image&&\"\"!=a.image?s(\"div\",{staticStyle:{height:\"140px\",width:\"140px\",position:\"relative\"}},[s(\"img\",{staticStyle:{position:\"absolute\",height:\"inherit\"},attrs:{src:a.image}})]):t._e(),void 0!=a.products?s(\"div\",{staticClass:\"buy-products\",staticStyle:{display:\"flex\",overflow:\"auto hidden\",float:\"left\",width:\"100%\"},on:{mousewheel:t.scroll_div}},t._l(t.product_variation(a.products.products_list),(function(e,a){return s(\"div\",{key:a,staticClass:\"image-container\"},[null!=e.img_url?s(\"img\",{staticClass:\"center-block p-0 m-0\",staticStyle:{height:\"140px\",width:\"140px\"},attrs:{src:t.check_image_type(e.img_url)}}):s(\"img\",{staticClass:\"image-product-blank\",staticStyle:{height:\"140px\",width:\"140px\",border:\"1px solid\"},attrs:{src:\"/img/blank_product_image.png\",alt:\"No Product Image\"}}),s(\"p\",{staticClass:\"p-0 mb-1\"},[t._v(t._s(e.title))]),s(\"p\",{staticClass:\"p-0 mb-1\"},[t._v(t._s(e.price))])])})),0):t._e()],2)})),0):t._e()])}))],2)])])])]):t._e()])},h=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"thead\",[s(\"tr\",[s(\"th\",{staticStyle:{width:\"25%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" USER NAME \")]),s(\"th\",{staticStyle:{width:\"20%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" NAME OF TASK \")]),s(\"th\",{staticStyle:{width:\"20%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" LAST INTERACTED ON \")]),s(\"th\",{staticStyle:{width:\"20%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" TIME \")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"thead\",[s(\"tr\",[s(\"th\",{staticStyle:{width:\"30%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" UNIQUE ID \")]),s(\"th\",{staticStyle:{width:\"30%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" LAST INTERACTED ON \")]),s(\"th\",{staticStyle:{width:\"40%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" VIEW CHAT \")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"modal-head d-flex align-items-center\"},[s(\"div\",{staticClass:\"head-icn\"},[s(\"img\",{attrs:{src:\"/img/user-blue.png\",alt:\"\"}})]),s(\"h3\",[t._v(\"Chat History\")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"button\",{staticClass:\"close\",attrs:{type:\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[s(\"img\",{attrs:{src:\"/img/close-icn.png\",alt:\"\"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"modal-head d-flex align-items-center\"},[s(\"div\",{staticClass:\"head-icn\"},[s(\"img\",{attrs:{src:\"/img/user-blue.png\",alt:\"\"}})]),s(\"h3\",[t._v(\"Chat History\")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"button\",{staticClass:\"close\",attrs:{type:\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[s(\"img\",{attrs:{src:\"/img/close-icn.png\",alt:\"\"}})])}],_=(s(\"4de4\"),s(\"a15b\"),s(\"d3b7\"),s(\"ac1f\"),s(\"25f0\"),s(\"1276\"),s(\"ade3\")),d=s(\"8e5f\"),p=s.n(d),u=s(\"c1df\"),m=s.n(u),g={components:{Multiselect:p.a},data:function(){return{number_of_rows:\"\",total_pages:0,page_no:1,per_page:15,user_list:[],user_reply:[],bot_reply:[],chatDetails:[],action_stats:[],user_action_stats:[],current_user:\"\",timestamp:\"\",sender_id:[],selected:\"general_chat_history\",selected_date:\"\",selected_index:null,chat_dates:[],companyname:this.$session.get(\"UserInformation\").company_name,companyid:this.$session.get(\"UserInformation\").company_id,issearch:!1,searchstring:\"\",spinnerOn:!1,view_component_name:\"portal_user\",fingerprintregex:/^[0-9-+\\/\\s]{9,}$/,page_array:[],show_loader:!1,is_portal_user:!0,contact_help_email:null,retail_web_framework:this.$session.get(\"retail_web_framework\"),filter_chat_history:this.$session.get(\"filter_chat_history\")}},mounted:function(){var t=this;this.retail_web_framework=this.$session.get(\"retail_web_framework\"),$(\"#selectall\").click((function(){$(this).is(\":checked\")?$(\"input:checkbox\").prop(\"checked\",!0):$(\"input:checkbox\").prop(\"checked\",!1)})),this.$root.$on(\"search_portal_user_chat_history\",(function(e){t.searchstring=e,t.search_chat()})),this.$root.$on(\"load_portal_user_chat_history\",(function(e){t.load_portal_user_chat_history()}))},beforeDestroy:function(){this.$root.$off(\"search_portal_user_chat_history\"),this.$root.$off(\"load_portal_user_chat_history\")},created:function(){this.load_product_settings(),this.load_portal_user_chat_history()},methods:{format_date_in_local_timezone:function(t){var e=m.a.utc(t),s=m()(e).local().toDate();return s=m()(s).format(\"ddd MMM D YYYY\"),s.toString()},messaging_platform_formating:function(t){return\"Please feel free to reachout to us at :\"+t},messaging_platform_formating_number:function(t){return null!=t?\" or call us at :\"+t:\"\"},confusion_message_formating:function(t){return t.split(\"{email}\").join(this.contact_help_email)},load_product_settings:function(){var t=this;this.show_loader=!0,n.a.post(c.a.product_settings(),{company_name:this.companyname,company_id:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,is_get:!0},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(e){var s=t.retail_web_framework;\"\"!=e.data&&null!=e.data&&\"Internal server Error\"!=e.data&&(t.contact_help_email=e.data[s+\"_details\"].contact_help_email)})).catch((function(e){t.show_loader=!1,410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data)}))},check_image_type:function(t){return\"string\"==typeof t?t:null!=t?t.src:\"\"},load_portal_user_chat_history:function(){var t=this;this.page_no=1,this.checked_list=[],this.searchstring=\"\",this.action_stats=[],this.user_action_stats=[],this.show_loader=!0,n.a.post(c.a.action_stats_url(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(e){t.action_stats=e.data.action_stats,t.action_stats.push({Hits:1,Name:\"general_chat_history\"})})).catch((function(e){t.show_loader=!1,410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data)})),this.show_loader=!0,n.a.post(c.a.general_chat_history(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,isshow:!0,is_portal_user:!0,action:\"general_chat_history\",filter_chat_history:this.$session.get(\"filter_chat_history\"),pageno:this.page_no,perpage:this.per_page,issearch:this.issearch},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(e){t.show_loader=!1,t.user_action_stats=[];for(var s=0;s<e.data.chatHistory.length;s++)t.fingerprintregex.test(e.data.chatHistory[s]._id.User)?t.user_action_stats.push({useremail:e.data.chatHistory[s].Email,userphonenumber:e.data.chatHistory[s].PhoneNumber,username:e.data.chatHistory[s].UserName,userid:e.data.chatHistory[s]._id.User,date:e.data.chatHistory[s].Date}):t.user_action_stats.push({useremail:e.data.chatHistory[s]._id.User,userphonenumber:e.data.chatHistory[s].PhoneNumber,username:e.data.chatHistory[s].UserName,userid:e.data.chatHistory[s]._id.User,date:e.data.chatHistory[s].Date});t.total_pages=e.data.PageCount,t.setpagination(t.page_no)})).catch((function(e){410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data),t.show_loader=!1}))},page_require:function(t){var e=this;\"general_chat_history\"!=this.selected?0==t||t==this.total_pages+1||(\"...s\"==page?this.page_no=Math.ceil((1+this.page_no)/2):\"...l\"==page?this.page_no=Math.ceil((this.total_pages+this.page_no)/2):this.page_no=page,n.a.post(c.a.action_usage_stats_url(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,action:this.selected,page_no:this.page_no,per_page:this.per_page},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)}))):0==t||t==this.total_pages+1||(this.page_no=\"...s\"==t?Math.ceil((1+this.page_no)/2):\"...l\"==t?Math.ceil((this.total_pages+this.page_no)/2):t,this.spinnerOn=!0,n.a.post(c.a.general_chat_history(),Object(_[\"a\"])({companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,isshow:!0,is_portal_user:!0,action:this.selected,filter_chat_history:this.$session.get(\"filter_chat_history\"),pageno:this.page_no,perpage:this.per_page,issearch:this.issearch},\"is_portal_user\",!0),{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){e.spinnerOn=!1,e.user_action_stats=[];for(var s=0;s<t.data.chatHistory.length;s++)e.fingerprintregex.test(t.data.chatHistory[s]._id.User)?e.user_action_stats.push({useremail:t.data.chatHistory[s].Email,userphonenumber:t.data.chatHistory[s].PhoneNumber,username:t.data.chatHistory[s].UserName,userid:t.data.chatHistory[s]._id.User,date:t.data.chatHistory[s].Date}):e.user_action_stats.push({useremail:t.data.chatHistory[s]._id.User,userphonenumber:t.data.chatHistory[s].PhoneNumber,username:t.data.chatHistory[s].UserName,userid:t.data.chatHistory[s]._id.User,date:t.data.chatHistory[s].Date});e.total_pages=t.data.PageCount,e.setpagination(e.page_no)})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)})))},pagination_class:function(t){return t==this.page_no?\" active\":\"\"},setpagination:function(t){if(this.page_array=[],this.total_pages<=7)for(var e=0;e<this.total_pages;e++)this.page_array.push(e+1);else if(1==t){for(var s=0;s<4;s++)this.page_array.push(s+1);this.page_array.push(\"...l\"),this.page_array.push(this.total_pages)}else if(t==this.total_pages){this.page_array.push(1),this.page_array.push(\"...s\");for(var a=this.total_pages-4;a<this.total_pages;a++)this.page_array.push(a+1)}else if(t<=4){for(var i=0;i<t+3;i++)this.page_array.push(i+1);this.page_array.push(\"...l\"),this.page_array.push(this.total_pages)}else if(t>=this.total_pages-4){this.page_array.push(1),this.page_array.push(\"...s\");for(var r=t-4;r<this.total_pages;r++)this.page_array.push(r+1)}else{this.page_array.push(1),this.page_array.push(\"...s\");for(var n=t-3;n<=t+3;n++)this.page_array.push(n);this.page_array.push(\"...l\"),this.page_array.push(this.total_pages)}},scroll_div:function(){var t=document.querySelector(\".buy-products\");event.deltaX>event.deltaY?t.scrollLeft+=10:event.deltaX<event.deltaY&&(t.scrollLeft-=10)},checkintent:function(t){return void 0!=this.chatDetails[t-1]&&void 0!=this.chatDetails[t-1].BOTResponse[0]&&void 0!=this.chatDetails[t-1].BOTResponse[0].intent},chat_date:function(t){var e=this;this.chatDetails=[],this.sender_id=this.user_action_stats[t].userid,this.spinnerOn=!0,n.a.post(c.a.general_chat_history(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,username:this.sender_id,isshowdates:!0,issearch:this.issearch,is_portal_user:!0,searchstring:this.searchstring},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(s){e.spinnerOn=!1,e.chat_dates=s.data.Dates,e.selected_date=s.data.Dates[s.data.Dates.length-1],e.chat_dates.reverse(),e.selected_index=t,e.chat_conversation(t)})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)}))},chat_conversation:function(t,e){var s=this;\"general_chat_history\"!=this.selected?(this.sender_id=this.user_action_stats[t].userid,this.spinnerOn=!0,n.a.post(c.a.conversation_stats_url(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,sender_id:this.user_action_stats[t].sender_id,action_timestamp:this.user_action_stats[t].action_list[e].timestamp},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){if(s.spinnerOn=!1,s.user_reply=[],s.bot_reply=[],null!=t.data){for(var e in s.current_user=t.data.user_conversations.username,t.data.user_conversations.interactions)void 0!=t.data.user_conversations.interactions[e].user?s.user_reply.push(t.data.user_conversations.interactions[e].user):void 0!=t.data.user_conversations.interactions[e].bot&&s.bot_reply.push(t.data.user_conversations.interactions[e].bot);$(\"#conversation_model1 :input\").prop(\"disabled\",!0)}else toastr.error(\"No Chats Available\"),$(\"#conversation_model1\").modal(\"hide\");$(\"#conversation_model1 :input\").prop(\"disabled\",!0)})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||s.$root.$emit(\"Session_Expired\",t.response.data)}))):(this.chatDetails=[],this.spinnerOn=!0,n.a.post(c.a.general_chat_history(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,username:this.sender_id,isshowchatdetails:!0,date:this.selected_date,issearch:this.issearch,is_portal_user:!0,searchstring:this.searchstring},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){if(s.spinnerOn=!1,s.user_reply=[],s.bot_reply=[],null!=t.data){s.current_user=s.user_action_stats[s.selected_index].useremail,s.chatDetails=t.data.chatDetails;for(var e=null,a=0;a<s.chatDetails.length;a++){for(var i=0;i<s.chatDetails[a].BOTResponse.length;i++)1==s.chatDetails[a].BOTResponse[i].shopify_fetch_customer_id&&null==s.chatDetails[a].BOTResponse[i].text&&\"Promotional offers\"===s.chatDetails[a].UserQuery&&(e=a);null!=e&&delete s.chatDetails[e],e=null}var r=s.chatDetails.filter((function(t){return t}));s.chatDetails=r}})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||s.$root.$emit(\"Session_Expired\",t.response.data)})))},product_variation:function(t){for(var e in t)t[e].order_qty=1,t[e].buy_qty=1,t[e].variations&&t[e].variations.length>0&&(t[e].id=t[e].variations[0].id,t[e].img_url=null===t[e].variations[0].img_url?t[e].img_url:t[e].variations[0].img_url||t[e].variations[0].image,t[e].permalink=t[e].variations[0].permalink,t[e].variant_title=t[e].variations[0].variant_title,t[e].stock_quantity=t[e].variations[0].stock_quantity,t[e].stock_status=t[e].variations[0].stock_status,t[e].price=t[e].variations[0].price,t[e].regular_price=t[e].variations[0].regular_price);return t},search_chat:function(){var t,e=this;\"\"!=this.searchstring?(this.page_no=1,this.issearch=!0,this.spinnerOn=!0,n.a.post(c.a.general_chat_history(),(t={companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,isshow:!0,is_portal_user:!0,action:\"general_chat_history\",pageno:this.page_no,perpage:this.per_page,issearch:this.issearch},Object(_[\"a\"])(t,\"is_portal_user\",!0),Object(_[\"a\"])(t,\"searchstring\",this.searchstring),t),{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){if(e.spinnerOn=!1,e.user_action_stats=[],\"No Results Found\"!=t.data.MSG&&\"Internal Server Error\"!=t.data.MSG){for(var s=0;s<t.data.chatHistory.length;s++)e.user_action_stats.push({username:t.data.chatHistory[s]});e.total_pages=t.data.PageCount,e.setpagination(e.page_no)}else\"No Results Found\"==t.data.MSG?toastr.error(\"No Results found\"):(t.data.MSG,toastr.error(\"Internal Server Error\"),e.load_portal_user_chat_history())})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)}))):toastr.error(\"Enter proper data for searching\")},close_modal:function(){$(\"#conversation_model1\").modal(\"hide\")},check_bot_offers:function(t){var e=t.filter((function(t){return!0===Boolean(t.offers)}));return e.length>0?\"display :block\":\"display : flex\"}}},f=g,y=(s(\"8d71\"),s(\"2877\")),v=Object(y[\"a\"])(f,l,h,!1,null,\"27383f5a\",null),b=v.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"table-box\"},[s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.show_loader,expression:\"show_loader\"}],staticClass:\"spinner\",attrs:{id:\"spinner\"}}),\"general_chat_history\"!=t.selected?s(\"div\",{staticClass:\"table-responsive\",staticStyle:{\"min-height\":\"349px\"}},[s(\"table\",{staticClass:\"table\"},[t._m(0),t._l(t.user_action_stats,(function(e,a){return s(\"tr\",{key:a},[\"Bot User\"==e.username||\"\"==e.username?[s(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\" \"+t._s(e.username)+\" \")]),s(\"td\",t._l(e.action_list,(function(e,i){return s(\"tr\",{key:i},[s(\"td\",{staticStyle:{width:\"50%\",\"text-align\":\"center\"}},[s(\"a\",{attrs:{href:\"javascript:void(0)\",\"data-toggle\":\"modal\",\"data-target\":\"#conversation_model\"},on:{click:function(e){return t.chat_conversation(a,i)}}},[t._v(t._s(e.name))])])])})),0),s(\"td\",{staticStyle:{\"text-align\":\"center\"}},t._l(e.action_list,(function(e,a){return s(\"tr\",{key:a},[s(\"td\",{staticStyle:{width:\"10%\"}},[t._v(t._s(e.date))])])})),0),s(\"td\",{staticStyle:{\"text-align\":\"center\"}},t._l(e.action_list,(function(e,a){return s(\"tr\",{key:a},[s(\"td\",{staticStyle:{width:\"10%\"}},[t._v(t._s(e.time))])])})),0)]:t._e()],2)}))],2)]):t._e(),\"general_chat_history\"==t.selected?s(\"div\",{staticClass:\"table-responsive\",staticStyle:{\"min-height\":\"349px\"}},[s(\"table\",{staticClass:\"table\"},[t._m(1),t._l(t.user_action_stats,(function(e,a){return s(\"tr\",{key:a},[[s(\"td\",{staticClass:\"text-center\"},[t._v(t._s(e.userid))]),s(\"td\",{staticClass:\"text-center\"},[t._v(t._s(t.format_date_in_local_timezone(e.date)))]),s(\"td\",{staticStyle:{width:\"50%\",\"text-align\":\"center\"}},[s(\"a\",{staticStyle:{\"text-align\":\"center\"},attrs:{href:\"javascript:void(0)\",\"data-toggle\":\"modal\",\"data-target\":\"#conversation_model1\"},on:{click:function(e){return t.chat_date(a)}}},[t._v(\"View Chat History\")])])]],2)}))],2)]):t._e(),s(\"div\",{staticClass:\"pagin-table\",staticStyle:{\"margin-top\":\"2%\"}},[s(\"nav\",{attrs:{\"aria-label\":\"Page navigation example\"}},[s(\"ul\",{staticClass:\"pagination justify-content-center\"},[s(\"li\",{staticClass:\"page-item\"},[s(\"a\",{staticClass:\"page-link\",attrs:{href:\"javascript:void(0)\"},on:{click:function(e){return t.page_require(t.page_no-1)}}},[s(\"svg\",{attrs:{xmlns:\"http://www.w3.org/2000/svg\",width:\"8.667\",height:\"15.204\",viewBox:\"0 0 8.667 15.204\"}},[s(\"g\",{attrs:{id:\"arrow-point-to-left\",transform:\"translate(105.806 15.204) rotate(180)\"}},[s(\"path\",{attrs:{id:\"Path_1136\",\"data-name\":\"Path 1136\",d:\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\",transform:\"translate(0 0)\",fill:\"#9499ae\"}})])])])]),t._l(t.page_array,(function(e){return s(\"li\",{key:e,class:\"page-item \"+t.pagination_class(e)},[\"...s\"==e||\"...l\"==e?s(\"a\",{staticClass:\"page-link\",attrs:{href:\"javascript:void(0)\"},on:{click:function(s){return t.page_require(e)}}},[t._v(\"...\")]):t._e(),\"...s\"!=e&&\"...l\"!=e?s(\"a\",{staticClass:\"page-link\",attrs:{href:\"#\"},on:{click:function(s){return t.page_require(e)}}},[t._v(t._s(e))]):t._e()])})),s(\"li\",{staticClass:\"page-item\"},[s(\"a\",{staticClass:\"page-link\",attrs:{href:\"javascript:void(0)\"},on:{click:function(e){return t.page_require(t.page_no+1)}}},[s(\"svg\",{attrs:{xmlns:\"http://www.w3.org/2000/svg\",width:\"8.667\",height:\"15.204\",viewBox:\"0 0 8.667 15.204\"}},[s(\"g\",{attrs:{id:\"arrow-point-to-right\",transform:\"translate(-97.139 0)\"}},[s(\"path\",{attrs:{id:\"Path_1136\",\"data-name\":\"Path 1136\",d:\"M105.493,8.354l-6.537,6.537a1.065,1.065,0,1,1-1.506-1.506L103.235,7.6,97.45,1.817A1.065,1.065,0,0,1,98.956.312l6.537,6.537a1.065,1.065,0,0,1,0,1.505Z\",transform:\"translate(0 0)\",fill:\"#9499ae\"}})])])])])],2)])]),\"general_chat_history\"!=t.selected?s(\"div\",{staticClass:\"modal fade dash-modal\",staticStyle:{\"margin-left\":\"-1%\"},attrs:{id:\"conversation_model\",tabindex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"conversation_model\",\"aria-hidden\":\"true\"}},[s(\"div\",{staticClass:\"modal-dialog modal-dialog-centered\",attrs:{role:\"document\"}},[s(\"div\",{staticClass:\"modal-content\"},[s(\"div\",{staticClass:\"modal-body\"},[t._m(2),t._m(3),s(\"div\",t._l(t.user_reply,(function(e,a){return s(\"div\",{key:a},[s(\"span\",{staticClass:\"d-flex\"},[s(\"h5\",[t._v(t._s(t.current_user)+\": \")]),s(\"p\",[t._v(t._s(e))])]),s(\"span\",{staticStyle:{display:\"flex\"}},[s(\"h5\",[t._v(\"Bot: \")]),s(\"p\",[t._v(t._s(t.bot_reply[a]))])])])})),0)])])])]):t._e(),\"general_chat_history\"==t.selected?s(\"div\",{staticClass:\"modal fade dash-modal\",staticStyle:{\"margin-left\":\"-1%\"},attrs:{id:\"conversation_model1\",tabindex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"conversation_model1\",\"aria-hidden\":\"true\"}},[s(\"div\",{staticClass:\"modal-dialog modal-dialog-centered\",staticStyle:{\"max-width\":\"60%\"},attrs:{role:\"document\"}},[s(\"div\",{staticClass:\"modal-content\"},[s(\"div\",{staticClass:\"modal-body\"},[t._m(4),t._m(5),s(\"div\",[s(\"div\",{staticClass:\"form-group\"},[s(\"label\",[t._v(\"Select Time Range\")]),s(\"multiselect\",{attrs:{id:\"select_coversation_date\",options:t.chat_dates,searchable:!0,\"close-on-select\":!0,\"show-labels\":!1,\"allow-empty\":!1,placeholder:\"Select Time Range\",\"disabled-selected\":!1,\"hide-selected\":!1,\"max-height\":200},on:{input:t.chat_conversation},model:{value:t.selected_date,callback:function(e){t.selected_date=e},expression:\"selected_date\"}},[s(\"span\",[t._v(t._s(t.selected_date))])])],1),s(\"p\"),t._l(t.chatDetails,(function(e,a){return s(\"div\",{key:a,staticStyle:{\"text-align\":\"justify\"}},[\"\"!=e.UserQuery?s(\"span\",{staticClass:\"py-0 my-0\",staticStyle:{display:\"flex\"}},[s(\"h5\",{staticClass:\"py-0 mt-2 mb-0\",staticStyle:{float:\"left\",width:\"3%\",height:\"0%\"}},[t._v(\"Q:\")]),s(\"p\",{staticClass:\"py-0 mb-0\",staticStyle:{\"word-break\":\"break-all\",\"margin-top\":\"11px\"}},[t._v(\" \"+t._s(e.UserQuery)+\" \")])]):t._e(),\"\"!=e.UserQuery||t.checkintent(a)?s(\"div\",t._l(e.BOTResponse,(function(a,i){return s(\"span\",{key:i,style:t.check_bot_offers(e.BOTResponse)},[void 0!=a.img||void 0!=a.text||void 0!=a.products||void 0!=a.offers||\"utter_default\"==a.template||void 0!=a.contact_us_email||void 0!=a.contact_us_phone_number||void 0!=a.buttons?s(\"h5\",{staticClass:\"py-0 mt-0 mb-0\",staticStyle:{float:\"left\",width:\"3%\",\"margin-bottom\":\"0px\"}},[t._v(\" A: \")]):t._e(),!0===Boolean(a.buttons)&&\"\"==a.text?s(\"div\",{staticStyle:{width:\"max-content\"}},[!0===Boolean(a.buttons)&&a.buttons.length>0&&\"\"==a.text?s(\"strong\",{staticStyle:{color:\"dimgray\"}},[t._v(\" Options :\")]):t._e(),t._l(a.buttons,(function(e,a){return s(\"span\",{key:a,staticStyle:{border:\"1px solid #cccccc\",cursor:\"default\",padding:\"2px\",\"margin-right\":\"5px\",background:\"#f2f2f2\",\"border-radius\":\"5px\"}},[s(\"span\",{staticClass:\"p-0 mb-1\"},[t._v(\" \"+t._s(e.title))])])}))],2):t._e(),void 0!=a.contact_us_email?s(\"p\",{staticStyle:{\"margin-top\":\"2px\",\"margin-bottom\":\"0px\",width:\"100%\"},domProps:{innerHTML:t._s(t.messaging_platform_formating(a.contact_us_email)+t.messaging_platform_formating_number(a.contact_us_phone_number))}}):t._e(),void 0!=a.message?s(\"p\",{staticStyle:{\"margin-top\":\"2px\",\"margin-bottom\":\"0px\",width:\"100%\"},domProps:{innerHTML:t._s(t.confusion_message_formating(a.message))}}):t._e(),s(\"div\",[void 0!=a.text&&\"\"!=a.text?s(\"p\",{staticStyle:{\"margin-top\":\"2px\",\"margin-bottom\":\"0px\",width:\"100%\"},domProps:{innerHTML:t._s(a.text)}}):t._e(),void 0!=a.video&&\"\"!=a.video?s(\"span\",[s(\"a\",{attrs:{href:a.video,target:\"blank\"}},[t._v(\"Attach Video\")])]):t._e()]),t._l(a.offers,(function(e,i){return s(\"div\",{key:i,staticClass:\"pb-0\",staticStyle:{width:\"100%\",\"margin-bottom\":\"0px\",\"padding-left\":\"1.7rem\"}},[void 0!=a.offers?s(\"span\",{domProps:{innerHTML:t._s(e.offer)}}):t._e()])})),void 0!=a.img&&\"\"!=a.img?s(\"div\",{staticStyle:{float:\"left\",width:\"100%\"}},[s(\"img\",{attrs:{src:a.img}})]):t._e(),void 0!=a.image&&\"\"!=a.image?s(\"div\",{staticStyle:{height:\"140px\",width:\"140px\",position:\"relative\"}},[s(\"img\",{staticStyle:{position:\"absolute\",height:\"inherit\"},attrs:{src:a.image}})]):t._e(),void 0!=a.products?s(\"div\",{staticClass:\"buy-products\",staticStyle:{display:\"flex\",overflow:\"auto hidden\",float:\"left\",width:\"100%\"},on:{mousewheel:t.scroll_div}},t._l(t.product_variation(a.products.products_list),(function(e,a){return s(\"div\",{key:a,staticClass:\"image-container\"},[s(\"img\",{staticClass:\"center-block p-0 m-0\",staticStyle:{height:\"140px\",width:\"140px\"},attrs:{src:t.check_image_type(e.img_url)}}),s(\"p\",{staticClass:\"p-0 mb-1\"},[t._v(t._s(e.title))]),s(\"p\",{staticClass:\"p-0 mb-1\"},[t._v(t._s(e.price))])])})),0):t._e()],2)})),0):t._e()])}))],2)])])])]):t._e()])},w=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"thead\",[s(\"tr\",[s(\"th\",{staticStyle:{width:\"25%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" USER NAME \")]),s(\"th\",{staticStyle:{width:\"20%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" NAME OF TASK \")]),s(\"th\",{staticStyle:{width:\"20%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" LAST INTERACTED ON \")]),s(\"th\",{staticStyle:{width:\"20%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" TIME \")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"thead\",[s(\"tr\",[s(\"th\",{staticStyle:{width:\"30%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" UNIQUE ID \")]),s(\"th\",{staticStyle:{width:\"30%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" LAST INTERACTED ON \")]),s(\"th\",{staticStyle:{width:\"40%\",\"text-align\":\"center\"},attrs:{scope:\"col\"}},[t._v(\" VIEW CHAT \")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"modal-head d-flex align-items-center\"},[s(\"div\",{staticClass:\"head-icn\"},[s(\"img\",{attrs:{src:\"/img/user-blue.png\",alt:\"\"}})]),s(\"h3\",[t._v(\"Chat History\")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"button\",{staticClass:\"close\",attrs:{type:\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[s(\"img\",{attrs:{src:\"/img/close-icn.png\",alt:\"\"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"modal-head d-flex align-items-center\"},[s(\"div\",{staticClass:\"head-icn\"},[s(\"img\",{attrs:{src:\"/img/user-blue.png\",alt:\"\"}})]),s(\"h3\",[t._v(\"Chat History\")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"button\",{staticClass:\"close\",attrs:{type:\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[s(\"img\",{attrs:{src:\"/img/close-icn.png\",alt:\"\"}})])}],x={components:{Multiselect:p.a},data:function(){return{number_of_rows:\"\",total_pages:0,page_no:1,per_page:15,user_list:[],user_reply:[],bot_reply:[],chatDetails:[],action_stats:[],user_action_stats:[],current_user:\"\",timestamp:\"\",sender_id:[],selected:\"general_chat_history\",selected_date:\"\",selected_index:null,chat_dates:[],companyname:this.$session.get(\"UserInformation\").company_name,companyid:this.$session.get(\"UserInformation\").company_id,issearch:!1,searchstring:\"\",spinnerOn:!1,view_component_name:\"portal_user\",fingerprintregex:/^[0-9-+\\/\\s]{9,}$/,page_array:[],show_loader:!1,contact_help_email:null,retail_web_framework:this.$session.get(\"retail_web_framework\"),filter_chat_history:this.$session.get(\"filter_chat_history\")}},mounted:function(){var t=this;this.retail_web_framework=this.$session.get(\"retail_web_framework\"),$(\"#selectall\").click((function(){$(this).is(\":checked\")?$(\"input:checkbox\").prop(\"checked\",!0):$(\"input:checkbox\").prop(\"checked\",!1)})),this.$root.$on(\"search_bot_user_chat_history\",(function(e){t.searchstring=e,t.search_chat()})),this.$root.$on(\"load_bot_user_chat_history\",(function(e){t.load_bot_user_chat_history()}))},beforeDestroy:function(){this.$root.$off(\"search_bot_user_chat_history\"),this.$root.$off(\"load_bot_user_chat_history\")},created:function(){this.load_product_settings(),this.load_bot_user_chat_history()},methods:{format_date_in_local_timezone:function(t){var e=m.a.utc(t),s=m()(e).local().toDate();return s=m()(s).format(\"ddd MMM D YYYY\"),s.toString()},messaging_platform_formating:function(t){return\"Please feel free to reachout to us at : \"+t},messaging_platform_formating_number:function(t){return null!=t?\" or call us at :\"+t:\"\"},confusion_message_formating:function(t){return t.split(\"{email}\").join(this.contact_help_email)},load_product_settings:function(){var t=this;this.show_loader=!0,n.a.post(c.a.product_settings(),{company_name:this.companyname,company_id:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,is_get:!0},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(e){var s=t.retail_web_framework;\"\"!=e.data&&null!=e.data&&\"Internal server Error\"!=e.data&&(t.contact_help_email=e.data[s+\"_details\"].contact_help_email)})).catch((function(e){t.show_loader=!1,410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data)}))},check_image_type:function(t){return\"string\"==typeof t?t:t.src},load_bot_user_chat_history:function(){var t=this;this.page_no=1,this.checked_list=[],this.searchstring=\"\",this.action_stats=[],this.user_action_stats=[],this.show_loader=!0,n.a.post(c.a.action_stats_url(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(e){t.action_stats=e.data.action_stats,t.action_stats.push({Hits:1,Name:\"general_chat_history\"})})).catch((function(e){t.show_loader=!1,410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data)})),this.show_loader=!0,n.a.post(c.a.general_chat_history(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,isshow:!0,action:\"general_chat_history\",filter_chat_history:this.$session.get(\"filter_chat_history\"),pageno:this.page_no,perpage:this.per_page,issearch:this.issearch},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(e){t.show_loader=!1,t.user_action_stats=[];for(var s=0;s<e.data.chatHistory.length;s++)t.fingerprintregex.test(e.data.chatHistory[s]._id.User)?t.user_action_stats.push({useremail:e.data.chatHistory[s].Email,userphonenumber:e.data.chatHistory[s].PhoneNumber,username:null==e.data.chatHistory[s].UserName?\"Guest user\":e.data.chatHistory[s].UserName,userid:e.data.chatHistory[s]._id.User,date:e.data.chatHistory[s].Date}):t.user_action_stats.push({useremail:e.data.chatHistory[s]._id.User,userphonenumber:e.data.chatHistory[s].PhoneNumber,username:null==e.data.chatHistory[s].UserName?\"Guest user\":e.data.chatHistory[s].UserName,userid:e.data.chatHistory[s]._id.User,date:e.data.chatHistory[s].Date});t.total_pages=e.data.PageCount,t.setpagination(t.page_no)})).catch((function(e){410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data),t.show_loader=!1}))},page_require:function(t){var e=this;\"general_chat_history\"!=this.selected?0==t||t==this.total_pages+1||(\"...s\"==page?this.page_no=Math.ceil((1+this.page_no)/2):\"...l\"==page?this.page_no=Math.ceil((this.total_pages+this.page_no)/2):this.page_no=page,n.a.post(c.a.action_usage_stats_url(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,action:this.selected,page_no:this.page_no,per_page:this.per_page},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)}))):0==t||t==this.total_pages+1||(this.page_no=\"...s\"==t?Math.ceil((1+this.page_no)/2):\"...l\"==t?Math.ceil((this.total_pages+this.page_no)/2):t,this.spinnerOn=!0,n.a.post(c.a.general_chat_history(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,isshow:!0,action:this.selected,filter_chat_history:this.$session.get(\"filter_chat_history\"),pageno:this.page_no,perpage:this.per_page,issearch:this.issearch},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){e.spinnerOn=!1,e.user_action_stats=[];for(var s=0;s<t.data.chatHistory.length;s++)e.fingerprintregex.test(t.data.chatHistory[s]._id.User)?e.user_action_stats.push({useremail:t.data.chatHistory[s].Email,userphonenumber:t.data.chatHistory[s].PhoneNumber,username:t.data.chatHistory[s].UserName,userid:t.data.chatHistory[s]._id.User,date:t.data.chatHistory[s].Date}):e.user_action_stats.push({useremail:t.data.chatHistory[s]._id.User,userphonenumber:t.data.chatHistory[s].PhoneNumber,username:t.data.chatHistory[s].UserName,userid:t.data.chatHistory[s]._id.User,date:t.data.chatHistory[s].Date});e.total_pages=t.data.PageCount,e.setpagination(e.page_no)})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)})))},pagination_class:function(t){return t==this.page_no?\" active\":\"\"},setpagination:function(t){if(this.page_array=[],this.total_pages<=7)for(var e=0;e<this.total_pages;e++)this.page_array.push(e+1);else if(1==t){for(var s=0;s<4;s++)this.page_array.push(s+1);this.page_array.push(\"...l\"),this.page_array.push(this.total_pages)}else if(t==this.total_pages){this.page_array.push(1),this.page_array.push(\"...s\");for(var a=this.total_pages-4;a<this.total_pages;a++)this.page_array.push(a+1)}else if(t<=4){for(var i=0;i<t+3;i++)this.page_array.push(i+1);this.page_array.push(\"...l\"),this.page_array.push(this.total_pages)}else if(t>=this.total_pages-4){this.page_array.push(1),this.page_array.push(\"...s\");for(var r=t-4;r<this.total_pages;r++)this.page_array.push(r+1)}else{this.page_array.push(1),this.page_array.push(\"...s\");for(var n=t-3;n<=t+3;n++)this.page_array.push(n);this.page_array.push(\"...l\"),this.page_array.push(this.total_pages)}},scroll_div:function(){var t=document.querySelector(\".buy-products\");event.deltaX>event.deltaY?t.scrollLeft+=10:event.deltaX<event.deltaY&&(t.scrollLeft-=10)},checkintent:function(t){return void 0!=this.chatDetails[t-1]&&void 0!=this.chatDetails[t-1].BOTResponse[0]&&void 0!=this.chatDetails[t-1].BOTResponse[0].intent},chat_date:function(t){var e=this;this.chatDetails=[],this.sender_id=this.user_action_stats[t].userid,this.spinnerOn=!0,n.a.post(c.a.general_chat_history(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,username:this.sender_id,isshowdates:!0,issearch:this.issearch,searchstring:this.searchstring},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(s){e.spinnerOn=!1,e.chat_dates=s.data.Dates,e.selected_date=s.data.Dates[s.data.Dates.length-1],e.chat_dates.reverse(),e.selected_index=t,e.chat_conversation(t)})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)}))},chat_conversation:function(t,e){var s=this;\"general_chat_history\"!=this.selected?(this.sender_id=this.user_action_stats[t].userid,this.spinnerOn=!0,n.a.post(c.a.conversation_stats_url(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,sender_id:this.user_action_stats[t].sender_id,action_timestamp:this.user_action_stats[t].action_list[e].timestamp},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){if(s.spinnerOn=!1,s.user_reply=[],s.bot_reply=[],null!=t.data){for(var e in s.current_user=t.data.user_conversations.username,t.data.user_conversations.interactions)void 0!=t.data.user_conversations.interactions[e].user?s.user_reply.push(t.data.user_conversations.interactions[e].user):void 0!=t.data.user_conversations.interactions[e].bot&&s.bot_reply.push(t.data.user_conversations.interactions[e].bot);$(\"#conversation_model1 :input\").prop(\"disabled\",!0)}else toastr.error(\"No Chats Available\"),$(\"#conversation_model1\").modal(\"hide\");$(\"#conversation_model1 :input\").prop(\"disabled\",!0)})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||s.$root.$emit(\"Session_Expired\",t.response.data)}))):(this.chatDetails=[],this.spinnerOn=!0,n.a.post(c.a.general_chat_history(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,username:this.sender_id,isshowchatdetails:!0,date:this.selected_date,issearch:this.issearch,searchstring:this.searchstring},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){if(s.spinnerOn=!1,s.user_reply=[],s.bot_reply=[],null!=t.data){s.current_user=s.user_action_stats[s.selected_index].useremail,s.chatDetails=t.data.chatDetails;for(var e=null,a=0;a<s.chatDetails.length;a++){for(var i=0;i<s.chatDetails[a].BOTResponse.length;i++)1==s.chatDetails[a].BOTResponse[i].shopify_fetch_customer_id&&null==s.chatDetails[a].BOTResponse[i].text&&\"Promotional offers\"===s.chatDetails[a].UserQuery&&(e=a);null!=e&&delete s.chatDetails[e],e=null}var r=s.chatDetails.filter((function(t){return t}));s.chatDetails=r}})).catch((function(t){410!==t.response.status&&440!==t.response.status&&409!==t.response.status||s.$root.$emit(\"Session_Expired\",t.response.data)})))},product_variation:function(t){for(var e in t)t[e].order_qty=1,t[e].buy_qty=1,t[e].variations&&t[e].variations.length>0&&(t[e].id=t[e].variations[0].id,t[e].img_url=null===t[e].variations[0].img_url?t[e].img_url:t[e].variations[0].img_url,t[e].permalink=t[e].variations[0].permalink,t[e].variant_title=t[e].variations[0].variant_title,t[e].stock_quantity=t[e].variations[0].stock_quantity,t[e].stock_status=t[e].variations[0].stock_status,t[e].price=t[e].variations[0].price,t[e].regular_price=t[e].variations[0].regular_price);return t},search_chat:function(){var t=this;\"\"!=this.searchstring?(this.page_no=1,this.issearch=!0,this.spinnerOn=!0,n.a.post(c.a.general_chat_history(),{companyname:this.companyname,companyid:this.companyid,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,isshow:!0,action:\"general_chat_history\",pageno:this.page_no,perpage:this.per_page,issearch:this.issearch,searchstring:this.searchstring},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(e){if(t.spinnerOn=!1,t.user_action_stats=[],\"No Results Found\"!=e.data.MSG&&\"Internal Server Error\"!=e.data.MSG){for(var s=0;s<e.data.chatHistory.length;s++)t.user_action_stats.push({username:e.data.chatHistory[s]});t.total_pages=e.data.PageCount,t.setpagination(t.page_no)}else\"No Results Found\"==e.data.MSG?toastr.error(\"No Results found\"):(e.data.MSG,toastr.error(\"Internal Server Error\"),t.load_bot_user_chat_history())})).catch((function(e){410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data)}))):toastr.error(\"Enter proper data for searching\")},close_modal:function(){$(\"#conversation_model1\").modal(\"hide\")},check_bot_offers:function(t){var e=t.filter((function(t){return!0===Boolean(t.offers)}));return e.length>0?\"display :block\":\"display : flex\"}}},C=x,S=(s(\"e4a2\"),Object(y[\"a\"])(C,k,w,!1,null,\"36ca8940\",null)),U=S.exports,I={components:{PortalUserChatHistory:b,BotUserChatHistory:U},data:function(){return{number_of_rows:\"\",total_pages:0,page_no:1,per_page:10,user_list:[],user_reply:[],bot_reply:[],chatDetails:[],action_stats:[],user_action_stats:[],current_user:\"\",timestamp:\"\",sender_id:[],selected:\"general_chat_history\",selected_date:\"\",selected_index:null,chat_dates:[],companyname:this.$session.get(\"UserInformation\").company_name,companyid:this.$session.get(\"UserInformation\").company_id,issearch:!1,searchstring:\"\",spinnerOn:!1,view_component_name:\"portal_user\",fingerprintregex:/^[0-9-+\\/\\s]{9,}$/,page_array:[],isVisibleSearchClear:!1,show_loader:!1,filter_chat_history:\"Last 7 days\"}},mounted:function(){$(\"#selectall\").click((function(){$(this).is(\":checked\")?$(\"input:checkbox\").prop(\"checked\",!0):$(\"input:checkbox\").prop(\"checked\",!1)})),$(\"#portal_user-tab\").click()},created:function(){this.load_task_responses(),this.$session.set(\"filter_chat_history\",\"Last 7 days\")},watch:{view_component_name:function(t,e){this.searchstring=\"\"},searchstring:function(){\"\"===this.searchstring?(this.load_task_responses(),this.isVisibleSearchClear=!1):\"\"!==this.searchstring&&(this.isVisibleSearchClear=!0)}},methods:{clear_searchstring:function(){this.searchstring=\"\"},load_task_responses:function(){this.show_loader=!1,this.checked_list=[],this.searchstring=\"\",this.$session.set(\"filter_chat_history\",this.filter_chat_history),\"portal_user\"===this.view_component_name?this.$root.$emit(\"load_portal_user_chat_history\",!0):\"bot_user\"===this.view_component_name&&this.$root.$emit(\"load_bot_user_chat_history\",!0)},search_chat:function(){\"portal_user\"===this.view_component_name?this.$root.$emit(\"search_portal_user_chat_history\",this.searchstring):\"bot_user\"===this.view_component_name&&this.$root.$emit(\"search_bot_user_chat_history\",this.searchstring)}}},H=I,E=(s(\"31c4\"),Object(y[\"a\"])(H,a,i,!1,null,\"46243cf9\",null));e[\"default\"]=E.exports},e4a2:function(t,e,s){\"use strict\";var a=s(\"c6eb\"),i=s.n(a);i.a}}]);","extractedComments":[]}