{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-61755275\"],{79150:function(e,t,s){},\"83a7\":function(e,t,s){\"use strict\";var a=s(\"c167\"),i=s.n(a);i.a},\"8a1f\":function(e,t,s){\"use strict\";var a=s(\"9b0a\"),i=s.n(a);i.a},\"9b0a\":function(e,t,s){},b0471:function(e,t,s){\"use strict\";var a=s(\"79150\"),i=s.n(a);i.a},b25c:function(e,t,s){e.exports=s.p+\"img/messenger-logo.99227288.png\"},c167:function(e,t,s){},c8d8:function(e,t,s){\"use strict\";s.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{},[a(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.big_spinner,expression:\"big_spinner\"}],staticClass:\"spinner\",attrs:{id:\"spinner\"}}),a(\"div\",{staticClass:\"card-header d-block d-sm-flex flex-wrap justify-content-between\"},[a(\"div\",{staticClass:\"col-sm-12\"},[a(\"h4\",{staticClass:\"mb-sm-0\"},[e._v(e._s(e.tlt(\"messenger_framework_header\")))])])]),a(\"div\",{staticClass:\"col-sm-12\"},[a(\"div\",{staticClass:\"row m-0 p-0\"},[a(\"div\",{staticClass:\"col-sm-3 p-3\"},[a(\"div\",{staticClass:\"card border-1\",attrs:{id:\"facebook_messenger_img\"}},[a(\"a\",{staticClass:\"mx-auto\",attrs:{href:\"javascript:void(0)\",\"data-toggle\":\"modal\",\"data-target\":\"#messaging_framework_card_modal\"},on:{click:function(t){e.website_name=\"Messenger\"}}},[a(\"img\",{staticClass:\"third-party-logo\",staticStyle:{height:\"100px !important\"},attrs:{src:s(\"b25c\")}})])])]),a(\"i\",{attrs:{id:\"check_btn_facebook_messenger\"}}),a(\"div\",{staticClass:\"col-sm-3 p-3\"},[a(\"div\",{staticClass:\"card border-1\",attrs:{id:\"whatsapp_img\"}},[a(\"a\",{staticClass:\"mx-auto\",attrs:{href:\"javascript:void(0)\",\"data-toggle\":\"modal\",\"data-target\":\"#messaging_framework_card_modal\"},on:{click:function(t){e.website_name=\"Whatsapp\"}}},[a(\"img\",{staticClass:\"third-party-logo\",staticStyle:{height:\"100px !important\"},attrs:{src:s(\"6dc1\")}})])])]),a(\"i\",{attrs:{id:\"check_btn_whatsapp\"}})])]),a(\"div\",{staticClass:\"modal fade dash-modal\",attrs:{id:\"messaging_framework_card_modal\",role:\"dialog\",\"aria-labelledby\":\"widget_code_modaltitle\",\"data-keyboard\":\"false\",\"aria-hidden\":\"true\",\"data-backdrop\":\"static\"}},[\"Whatsapp\"==e.website_name?a(\"div\",{staticClass:\"modal-dialog modal-dialog-centered\",staticStyle:{\"max-width\":\"800px\"},attrs:{role:\"document\"}},[a(\"div\",{staticClass:\"modal-content\"},[\"Whatsapp\"==e.website_name?[a(\"whats-app\")]:e._e()],2)]):e._e(),\"Messenger\"==e.website_name?a(\"div\",{staticClass:\"modal-dialog modal-dialog-centered\",attrs:{role:\"document\"}},[a(\"div\",{staticClass:\"modal-content\"},[\"Messenger\"==e.website_name?[a(\"facebook-messenger\")]:e._e()],2)]):e._e()])])},i=[],n=s(\"bc3a\"),o=s.n(n),_=s(\"3d20\"),r=s.n(_),c=s(\"ea54\"),p=s.n(c),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",[s(\"div\",{staticClass:\"modal-body\"},[s(\"div\",{staticClass:\"modal-head d-flex align-items-center\"},[s(\"h3\",[e._v(e._s(e.tlt(\"messenger_setting_header\")))])]),e._m(0),s(\"div\",[s(\"div\",[s(\"h4\",[e._v(e._s(e.tlt(\"connect_fb_account\")))]),s(\"div\",{staticClass:\"d-flex\"},[s(\"div\",{staticClass:\"fb-button\",attrs:{id:\"login\"},on:{click:function(t){return e.checkLoginState()}}},[s(\"div\",{staticClass:\"icon\"},[s(\"svg\",{attrs:{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 118 222\"}},[s(\"path\",{staticStyle:{fill:\"#fff\"},attrs:{id:\"f\",d:\"M75.41,220.31V120.5h33.5l5-38.9H75.41V56.78c0-11.26,3.13-18.93,19.27-18.93h20.6V3a275.33,275.33,0,0,0-30-1.53c-29.7,0-50,18.13-50,51.41V81.61H1.66v38.9H35.24v99.8Z\"}})])]),s(\"span\",[e._v(e._s(e.tlt(\"connect_facebook\")))])]),s(\"div\",{staticClass:\"logout-button\",staticStyle:{display:\"none\"},attrs:{id:\"logout\"},on:{click:function(t){return e.facebookLogout()}}},[s(\"span\",[e._v(e._s(e.tlt(\"logout_btn\")))])])]),s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:Boolean(e.fb_page_data.length),expression:\"Boolean(fb_page_data.length)\"}]},[s(\"div\",{staticClass:\"col-sm-12 p-0\"},[s(\"h4\",{staticClass:\"mt-2\"},[e._v(e._s(e.tlt(\"connect_pages\")))]),e._l(e.fb_page_data,(function(t,a){return s(\"div\",{key:a},[s(\"div\",{staticClass:\"messenger-pages d-flex\"},[s(\"div\",[e._v(\" \"+e._s(t.name)+\" \")]),s(\"div\",{staticStyle:{\"margin-left\":\"auto\"}},[s(\"button\",{staticClass:\"fb-connect-btn\",on:{click:function(s){return e.page_connect_fb(t)}}},[e._v(e._s(e.tlt(\"connect_btn\")))])])])])}))],2)]),s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:Boolean(e.fb_saved_page_data.length),expression:\"Boolean(fb_saved_page_data.length)\"}]},[s(\"div\",{staticClass:\"col-sm-12 p-0\"},[s(\"h4\",{staticClass:\"mt-2\"},[e._v(e._s(e.tlt(\"connect_pages\")))]),e._l(e.fb_saved_page_data,(function(t,a){return s(\"div\",{key:a},[s(\"div\",{staticClass:\"messenger-pages d-flex\"},[s(\"div\",[e._v(\" \"+e._s(t.fb_page_name)+\" \")]),s(\"label\",{staticClass:\"switch mb-0 mt-0 mr-2\",staticStyle:{\"margin-left\":\"auto\"}},[s(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.fb_page_enabled,expression:\"page.fb_page_enabled\"}],attrs:{type:\"checkbox\",id:\"email_required_id\"},domProps:{checked:Array.isArray(t.fb_page_enabled)?e._i(t.fb_page_enabled,null)>-1:t.fb_page_enabled},on:{click:function(t){return e.edit_fb_page(a)},change:function(s){var a=t.fb_page_enabled,i=s.target,n=!!i.checked;if(Array.isArray(a)){var o=null,_=e._i(a,o);i.checked?_<0&&e.$set(t,\"fb_page_enabled\",a.concat([o])):_>-1&&e.$set(t,\"fb_page_enabled\",a.slice(0,_).concat(a.slice(_+1)))}else e.$set(t,\"fb_page_enabled\",n)}}}),s(\"span\",{staticClass:\"slider round\",staticStyle:{\"border-radius\":\"50px\"}})]),s(\"span\",{staticClass:\"delete-cart-item\",on:{click:function(s){return e.delete_fb_page(t)}}},[s(\"svg\",{attrs:{xmlns:\"http://www.w3.org/2000/svg\",width:\"13.682\",height:\"15.392\",viewBox:\"0 0 13.682 15.392\"}},[s(\"path\",{attrs:{\"data-v-0f909d54\":\"\",d:\"M8.276,3v.855H4v1.71h.855V16.682a1.71,1.71,0,0,0,1.71,1.71h8.551a1.71,1.71,0,0,0,1.71-1.71V5.565h.855V3.855H13.406V3H8.276M6.565,5.565h8.551V16.682H6.565V5.565m1.71,1.71v7.7h1.71v-7.7H8.276m3.42,0v7.7h1.71v-7.7Z\",transform:\"translate(-4 -3)\",fill:\"#f23d3d\"}})])])])])}))],2)])])])])])},l=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"button\",{staticClass:\"close\",attrs:{type:\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[s(\"img\",{attrs:{src:\"/img/close-icn.png\",alt:\"\"}})])}],u=(s(\"a434\"),s(\"b0c0\"),{name:\"MessagingFrameworks\",components:{},data:function(){return{big_spinner:!1,website_name:\"\",widget_code:\"\",company_name:this.$session.get(\"UserInformation\").company_name,company_id:this.$session.get(\"UserInformation\").company_id,fb_access_token:\"\",fb_user_id:\"\",user_access_token:null,fb_page_data:[],fb_saved_page_data:[]}},watch:{fb_page_enabled:function(e){}},mounted:function(){this.get_integration_details()},methods:{update_data:function(){for(var e in this.fb_saved_page_data)for(var t in this.fb_page_data)this.fb_saved_page_data[e].fb_page_id==this.fb_page_data[t].id&&this.fb_page_data.splice(t,1)},get_integration_details:function(){var e=this;this.big_spinner=!0,o.a.post(p.a.chatbot_integration_details(),{is_get:!0,company_name:this.company_name,company_id:this.company_id,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){var s=t.data;if(e.big_spinner=!1,s.message.MSG_CODE===e.api_status_code.DATA_AVAILABLE.MSG_CODE){if(e.fb_saved_page_data=[],Boolean(s.data.facebook_details.length))for(var a in s.data.facebook_details){var i={};i={fb_access_token:s.data.facebook_details[a].fb_access_token,fb_page_id:s.data.facebook_details[a].fb_page_id,fb_page_name:s.data.facebook_details[a].fb_page_name,fb_verify_token:s.data.facebook_details[a].fb_verify_token,fb_page_enabled:s.data.facebook_details[a].enabled},e.fb_saved_page_data.push(i)}e.update_data()}else s.message.MSG_CODE===e.api_status_code.EMPTY_DATA.MSG_CODE||swal({title:s.message.MSG_CODE,text:s.message.MSG,showCancelButton:!1,showConfirmButton:!1,toast:!0,position:\"top-end\",timer:2500,type:\"error\"})})).catch((function(t){e.big_spinner=!1,410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)}))},page_connect_fb:function(e){var t=this;null!=e&&o.a.post(p.a.chatbot_integration_details(),{company_name:this.company_name,company_id:this.company_id,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,fb_page_name:e.name,fb_access_token:e.access_token,fb_page_id:e.id,fb_page_enabled:!0,is_save:!0,is_facebook:!0,is_messaging_platform:!1},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(s){if(s.data.message.MSG_CODE==t.api_status_code.SUCCESSFUL_DB_QUERY.MSG_CODE){r.a.fire({title:t.tlt(\"facebook_connect_msg\"),type:\"success\",timer:2500});var a=\"/\"+e.id+\"/subscribed_apps?access_token=\"+e.access_token;FB.api(a,\"POST\",{subscribed_fields:\"messages\"},(function(e){console.log(\"Subscription\",e)})),t.get_integration_details()}else s.data.message.MSG_CODE===t.api_status_code.INTERNAL_SERVER_ERROR.MSG_CODE?r.a.fire({title:t.tlt(\"facebook_internal_server_msg\"),type:\"error\",timer:2500}):swal({title:data.message.MSG_CODE,text:data.message.MSG,showCancelButton:!1,showConfirmButton:!1,toast:!0,position:\"top-end\",timer:2500,type:\"error\"})})).catch((function(e){410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data)}))},edit_fb_page:function(e){var t=this,s=this;0==this.fb_saved_page_data[e].fb_page_enabled?this.fb_saved_page_data[e].fb_page_enabled=!0:this.fb_saved_page_data[e].fb_page_enabled=!1,null!=e&&o.a.post(p.a.chatbot_integration_details(),{company_name:this.company_name,company_id:this.company_id,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,fb_page_id:this.fb_saved_page_data[e].fb_page_id,is_edit:!0,is_facebook:!0,fb_page_enabled:this.fb_saved_page_data[e].fb_page_enabled},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(a){if(a.data.message.MSG_CODE===t.api_status_code.SUCCESSFUL_DB_QUERY.MSG_CODE){if(r.a.fire({title:t.tlt(\"facebook_edited_msg\"),type:\"success\",timer:2500}),Boolean(t.fb_saved_page_data[e].fb_page_enabled)){i=\"/\"+s.fb_saved_page_data[e].fb_page_id+\"/subscribed_apps?access_token=\"+s.fb_saved_page_data[e].fb_access_token;FB.api(i,\"POST\",{subscribed_fields:\"messages\"},(function(e){console.log(\"Subscription\",e)}))}else{var i=\"/\"+s.fb_saved_page_data[e].fb_page_id+\"/subscribed_apps?access_token=\"+s.fb_saved_page_data[e].fb_access_token;FB.api(i,\"DELETE\",{},(function(e){console.log(\"DELETE\",e)}))}t.get_integration_details()}else a.data.message.MSG_CODE===t.api_status_code.FACEBOOK_PAGE_ID_DOESNT_EXISTS.MSG_CODE?r.a.fire({title:t.tlt(\"page_id_not_exist\"),type:\"warning\",timer:2500}):a.data.message.MSG_CODE===t.api_status_code.INTERNAL_SERVER_ERROR.MSG_CODE?r.a.fire({title:t.tlt(\"facebook_internal_server_msg\"),type:\"error\",timer:2500}):swal({title:data.message.MSG_CODE,text:data.message.MSG,showCancelButton:!1,showConfirmButton:!1,toast:!0,position:\"top-end\",timer:2500,type:\"error\"})})).catch((function(e){410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data)}))},delete_fb_page:function(e){var t=this;null!=e&&o.a.post(p.a.chatbot_integration_details(),{company_name:this.company_name,company_id:this.company_id,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens,fb_page_id:e.fb_page_id,is_delete:!0,is_facebook:!0},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(s){if(s.data.message.MSG_CODE===t.api_status_code.SUCCESSFUL_DB_QUERY.MSG_CODE){r.a.fire({title:t.tlt(\"facebook_edited_msg\"),type:\"success\",timer:2500});var a=\"/\"+e.fb_page_id+\"/subscribed_apps?access_token=\"+e.fb_access_token;FB.api(a,\"DELETE\",{},(function(e){console.log(\"DELETE\",e)})),t.get_integration_details()}else s.data.message.MSG_CODE===t.api_status_code.FACEBOOK_PAGE_ID_DOESNT_EXISTS.MSG_CODE?r.a.fire({title:t.tlt(\"page_id_not_exist\"),type:\"warning\",timer:2500}):s.data.message.MSG_CODE===t.api_status_code.INTERNAL_SERVER_ERROR.MSG_CODE?r.a.fire({title:t.tlt(\"facebook_internal_server_msg\"),type:\"error\",timer:2500}):swal({title:data.message.MSG_CODE,text:data.message.MSG,showCancelButton:!1,showConfirmButton:!1,toast:!0,position:\"top-end\",timer:2500,type:\"error\"})})).catch((function(e){410!==e.response.status&&440!==e.response.status&&409!==e.response.status||t.$root.$emit(\"Session_Expired\",e.response.data)}))},checkLoginState:function(){var e=this;FB.getLoginStatus((function(t){e.statusChangeCallback(t)}))},statusChangeCallback:function(e){console.log(\"Messenger login1\",e),\"connected\"===e.status?(this.fb_access_token=e.authResponse.accessToken,this.fb_user_id=e.authResponse.userID,$(\"#login\").hide(),$(\"#logout\").show(),this.fetchUserProfile()):this.facebookLoginByDialog()},facebookLogout:function(){$(\"#logout\").hide(),$(\"#login\").show(),$(\"#status\").empty(),FB.logout((function(e){})),this.fb_page_data=[],this.fb_access_token=\"\",this.fb_user_id=\"\",this.get_integration_details()},facebookLoginByDialog:function(){var e=this;FB.login((function(t){e.statusChangeCallback(t)}),{scope:\"public_profile,pages_manage_metadata,pages_show_list,pages_messaging,pages_read_engagement\"})},fetchUserProfile:function(){var e=this,t=this,s=this.fb_user_id,a=this.fb_access_token,i=Object({NODE_ENV:\"production\",BASE_URL:\"/\"}).VUE_APP_FB_APP_ID,n=Object({NODE_ENV:\"production\",BASE_URL:\"/\"}).VUE_APP_FB_APP_SECRET,o=\"/oauth/access_token?grant_type=fb_exchange_token&client_id=\"+i+\"&client_secret=\"+n+\"&fb_exchange_token=\"+a;FB.api(o,(function(e){t.user_access_token=e.access_token})),setTimeout((function(){var a=\"/\"+s+\"?fields=id,name,email,picture&access_token=\"+e.user_access_token;FB.api(a,(function(e){}));var i=\"/\"+s+\"/accounts?fields=name,access_token&access_token=\"+e.user_access_token;FB.api(i,(function(e){t.fb_page_data=e.data,t.update_data()}))}),2e3)}}}),m=u,h=(s(\"83a7\"),s(\"2877\")),g=Object(h[\"a\"])(m,d,l,!1,null,\"1b1aa356\",null),b=g.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",[s(\"div\",{staticClass:\"modal-body\"},[s(\"div\",{staticClass:\"modal-head d-flex align-items-center\"},[s(\"h3\",[e._v(e._s(e.tlt(\"whatsapp_setting\")))])]),e._m(0),s(\"div\",[s(\"div\",[\"success\"!=this.whatsapp_details_status?s(\"h4\",[e._v(\"Create a WhatsApp Business profile\")]):e._e(),\"\"!=this.whatsapp_details_status?s(\"div\",{staticClass:\"alert alert-warning\",attrs:{role:\"alert\"}},[e._v(\" \"+e._s(this.whatsapp_details_status)+\" : \"+e._s(this.whatsapp_details_status_message)+\" \")]):e._e(),s(\"form\",[s(\"div\",{staticClass:\"form-group mb-2\"},[e._m(1),e._m(2),s(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:e.whatsapp_display_name,expression:\"whatsapp_display_name\"}],staticClass:\"form-control\",attrs:{type:\"text\",placeholder:\"Ex. Business Name\",disabled:\"In-progress\"==e.whatsapp_details_status,required:\"\"},domProps:{value:e.whatsapp_display_name},on:{input:function(t){t.target.composing||(e.whatsapp_display_name=t.target.value)}}})]),s(\"div\",{staticClass:\"form-group mb-2\"},[e._m(3),s(\"multiselect\",{attrs:{options:e.category_list,searchable:!1,\"close-on-select\":!0,\"show-labels\":!1,disabled:\"In-progress\"==e.whatsapp_details_status||\"display_name_error\"==e.whatsapp_details_status,placeholder:\"Business type\"},model:{value:e.whatsapp_business_category,callback:function(t){e.whatsapp_business_category=t},expression:\"whatsapp_business_category\"}})],1),s(\"div\",{staticClass:\"form-group mb-2\"},[e._m(4),s(\"textarea\",{directives:[{name:\"model\",rawName:\"v-model\",value:e.whatsapp_business_description,expression:\"whatsapp_business_description\"}],staticClass:\"form-control\",staticStyle:{\"padding-right\":\"61px\",\"margin-top\":\"0px\",\"margin-bottom\":\"0px\",height:\"87px\"},attrs:{disabled:\"In-progress\"==e.whatsapp_details_status||\"display_name_error\"==e.whatsapp_details_status,rows:\"3\",maxlength:\"512\",placeholder:\"Tell us about your business\"},domProps:{value:e.whatsapp_business_description},on:{input:function(t){t.target.composing||(e.whatsapp_business_description=t.target.value)}}})]),s(\"div\",{staticClass:\"form-group mb-2\"},[e._m(5),e._m(6),s(\"vue-phone-number-input\",{attrs:{\"default-country-code\":\"IN\",disabled:\"In-progress\"==e.whatsapp_details_status||\"display_name_error\"==e.whatsapp_details_status},on:{update:function(t){e.whatsapp_business_phoneNumber_check=t}},model:{value:e.whatsapp_business_number,callback:function(t){e.whatsapp_business_number=t},expression:\"whatsapp_business_number\"}})],1),s(\"div\",{staticClass:\"form-group mb-2\"},[e._m(7),s(\"p\",[e._v(\" (This number will be used by our support team to get in touch with you related to whatsapp integration.) \")]),s(\"vue-phone-number-input\",{attrs:{\"default-country-code\":\"IN\",disabled:\"In-progress\"==e.whatsapp_details_status||\"display_name_error\"==e.whatsapp_details_status},on:{update:function(t){e.business_contact_phoneNumber_check=t}},model:{value:e.business_contact_number,callback:function(t){e.business_contact_number=t},expression:\"business_contact_number\"}})],1),\"In-progress\"!=e.whatsapp_details_status?s(\"div\",{staticClass:\"btn-wrap mt-0 border-top-0\",staticStyle:{\"text-align\":\"end\"}},[s(\"button\",{staticClass:\"darkblue-btn ml-0\",attrs:{type:\"submit\",id:\"whatsapp_save_btn\"},on:{click:function(t){return t.preventDefault(),e.submit_details(t)}}},[e._v(\" \"+e._s(e.tlt(\"save_btn\"))+\" \")])]):e._e()])])])])])},v=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"button\",{staticClass:\"close\",attrs:{type:\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[s(\"img\",{attrs:{src:\"/img/close-icn.png\",alt:\"\"}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"label\",[s(\"b\",[e._v(\"WhatsApp Business profile display name\")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"p\",[e._v(\" (This is the name of your business that is shown to customers in the WhatsApp app. \"),s(\"a\",{attrs:{target:\"_blank\",href:\"https://developers.facebook.com/docs/whatsapp/display-name\"}},[e._v(\"Learn more\")]),e._v(\") \")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"label\",[s(\"b\",[e._v(\"Category\")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"label\",[s(\"b\",[e._v(\"Business descripton\")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"label\",[s(\"b\",[e._v(\"Add a phone number for WhatsApp \")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"p\",[e._v(\" (This is the number people will see when they chat with you. Use a number that's not been registered on WhatsApp. \"),s(\"a\",{attrs:{target:\"_blank\",href:\"https://www.facebook.com/business/help/353293243562513\"}},[e._v(\"Learn more\")]),e._v(\") \")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"label\",[s(\"b\",[e._v(\"Add your contact number\")])])}],w=s(\"ade3\"),y=s(\"8e5f\"),k=s.n(y),C=s(\"7bec\"),E=s.n(C),S=(s(\"4413\"),s(\"61b2\")),B={name:\"MessagingFrameworks\",components:{Multiselect:k.a,VuePhoneNumberInput:E.a},mixins:[S[\"c\"]],data:function(){return{big_spinner:!1,company_name:this.$session.get(\"UserInformation\").company_name,company_id:this.$session.get(\"UserInformation\").company_id,fb_access_token:\"\",fb_user_id:\"\",user_access_token:null,whatsapp_business_ids_data:[],whatsapp_business_ids:[],waba_id:null,whatsapp_display_name:\"\",whatsapp_business_category:\"\",category_list:[\"Automotive\",\"Beauty and Salon\",\"Clothing and Apparel\",\"Education\",\"Entertainment\",\"Event Planning and Service\",\"Finance and Banking\",\"Food and Grocery\",\"Public Service\",\"Hotel and Lodging\",\"Medical and Health\",\"Non-profit\",\"Professional Services\",\"Shopping and Retail\",\"Travel and Transportation\",\"Restaurant\",\"Other\"],whatsapp_business_description:\"\",whatsapp_business_number:null,whatsapp_business_phoneNumber_check:null,business_contact_number:null,business_contact_phoneNumber_check:null,whatsapp_business_details:[],whatsapp_details_status:\"\",whatsapp_details_status_message:\"\"}},mounted:function(){this.get_integration_details()},methods:{get_integration_details:function(){var e=this;this.big_spinner=!0,o.a.post(p.a.chatbot_integration_details(),{is_get:!0,company_name:this.company_name,company_id:this.company_id,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){var s=t.data;e.big_spinner=!1,s.message.MSG_CODE===e.api_status_code.DATA_AVAILABLE.MSG_CODE?\"whatsapp_request_form\"in s.data&&(e.whatsapp_details_status=s.data.whatsapp_request_form[\"status\"],e.whatsapp_details_status_message=s.data.whatsapp_request_form[\"status_message\"],e.whatsapp_display_name=s.data.whatsapp_request_form[\"whatsapp_display_name\"],e.whatsapp_business_category=s.data.whatsapp_request_form[\"whatsapp_business_category\"],e.whatsapp_business_description=s.data.whatsapp_request_form[\"whatsapp_business_description\"],e.whatsapp_business_number=s.data.whatsapp_request_form[\"whatsapp_business_number\"],e.business_contact_number=s.data.whatsapp_request_form[\"business_contact_number\"]):response.data.message.MSG_CODE===e.api_status_code.EMPTY_DATA.MSG_CODE||r()({title:s.message.MSG_CODE,text:s.message.MSG,showCancelButton:!1,showConfirmButton:!1,toast:!0,position:\"top-end\",timer:2500,type:\"error\"})})).catch((function(t){e.big_spinner=!1,410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)}))},checkLoginState:function(){var e=this;FB.getLoginStatus((function(t){e.statusChangeCallback(t)}))},statusChangeCallback:function(e){\"connected\"===e.status?(this.fb_access_token=e.authResponse.accessToken,this.fb_user_id=e.authResponse.userID,$(\"#login\").hide(),$(\"#logout\").show(),this.fetchUserProfile()):this.facebookLoginByDialog()},facebookLogout:function(){$(\"#logout\").hide(),$(\"#login\").show(),$(\"#status\").empty(),FB.logout((function(e){})),this.fb_page_data=[],this.fb_access_token=\"\",this.fb_user_id=\"\",this.get_integration_details(),this.whatsapp_business_ids=[],this.whatsapp_business_ids_data=[]},facebookLoginByDialog:function(){var e=this;FB.login((function(t){e.statusChangeCallback(t)}),{scope:\"public_profile,whatsapp_business_management,business_management,whatsapp_business_messaging\"})},submit_details:function(){var e=this;\"\"!=this.whatsapp_display_name?\"\"!=this.whatsapp_business_category?\"\"!=this.whatsapp_business_description?1==this.whatsapp_business_phoneNumber_check.isValid&&1==this.business_contact_phoneNumber_check.isValid&&(this.whatsapp_business_details={whatsapp_display_name:this.whatsapp_display_name,whatsapp_business_category:this.whatsapp_business_category,whatsapp_business_description:this.whatsapp_business_description,whatsapp_business_number:this.whatsapp_business_phoneNumber_check.formattedNumber,business_contact_number:this.business_contact_phoneNumber_check.formattedNumber,status_message:\"We have notified our team, we will get in touch with you shortly.\",status:\"In-progress\"},o.a.post(p.a.chatbot_integration_details(),{company_name:this.$session.get(\"UserInformation\").company_name,company_id:this.$session.get(\"UserInformation\").company_id,wa_is_third_party:!1,whatsapp_business_details:this.whatsapp_business_details,is_messaging_platform:!1,is_whatsapp_request:!0,is_save:!0,email:this.$session.get(\"UserInformation\").email},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){t.data.message.MSG_CODE===e.api_status_code.SUCCESSFUL_DB_QUERY.MSG_CODE?(r.a.fire({title:\"Whatsapp Integration Successfully\",type:\"success\",timer:2500}),e.get_integration_details()):t.data.message.MSG_CODE===e.api_status_code.INTERNAL_SERVER_ERROR.MSG_CODE?r.a.fire({title:\"Internal Server Error\",type:\"error\",timer:2500}):t.data.message.MSG_CODE===e.api_status_code.UNSUCCESSFUL_DB_OPERATION.MSG_CODE?r.a.fire({type:\"error\",timer:2500,text:t.data.message.MSG}):r.a.fire({title:t.data.message.MSG_CODE,text:t.data.message.MSG,showCancelButton:!1,showConfirmButton:!1,toast:!0,position:\"top-end\",timer:2500,type:\"error\"})})).catch((function(t){e.spinnerOn=!1,410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)})),this.close_modal(\"whatsapp_save_btn\")):r()({text:\"Tell us about your business description\",toast:!0,position:\"top-end\",type:\"warning\",showConfirmButton:!1,timer:2e3}):r()({text:\"Select your business category\",toast:!0,position:\"top-end\",type:\"warning\",showConfirmButton:!1,timer:2e3}):r()({text:\"Display name cannot be blank\",toast:!0,position:\"top-end\",type:\"warning\",showConfirmButton:!1,timer:2e3})},fetchUserProfile:function(){var e=this,t=this.fb_access_token,s=Object({NODE_ENV:\"production\",BASE_URL:\"/\"}).VUE_APP_FB_WP_SYSTEM_ACCESS_TOKEN,a=null,i=\"/debug_token?input_token=\"+t+\"&access_token=\"+s;FB.api(i,(function(t){for(var s in a=t.data,a.granular_scopes)\"whatsapp_business_management\"==a.granular_scopes[s].scope&&(e.whatsapp_business_ids=a.granular_scopes[s].target_ids)})),setTimeout((function(){for(var s in e.whatsapp_business_ids){var a=e.whatsapp_business_ids[s],i=\"/\"+a+\"/phone_numbers?access_token=\"+t;FB.api(i,(function(t){e.whatsapp_business_ids_data.push(Object(w[\"a\"])({},a,t.data[0])),e.submit_details()}))}}),2e3)}}},D=B,x=(s(\"b0471\"),Object(h[\"a\"])(D,f,v,!1,null,\"48090d7c\",null)),M=x.exports,O={name:\"MessagingFrameworks\",components:{FacebookMessenger:b,WhatsApp:M},data:function(){return{big_spinner:!1,website_name:\"\",widget_code:\"\",company_name:this.$session.get(\"UserInformation\").company_name,company_id:this.$session.get(\"UserInformation\").company_id,fb_access_token:\"\",fb_user_id:\"\",user_access_token:null,fb_page_data:[],fb_saved_page_data:[]}},watch:{fb_page_enabled:function(e){}},mounted:function(){this.get_integration_details(),this.$root.$on(\"messenger_framework_integrated\",(function(e,t){1==e&&\"whatsapp_request_form\"==t?(document.getElementById(\"whatsapp_img\").style.border=\"1px solid #273679\",document.getElementById(\"whatsapp_img\").style.borderRadius=\"0.4rem\",document.getElementById(\"check_btn_whatsapp\").innerHTML='<i class=\"fa fa-check-circle\" aria-hidden=\"true\" style=\"color:#273679;margin-left: -1.0rem;margin-top:4px\"></i>'):1==e&&\"facebook_details\"==t&&(document.getElementById(\"facebook_messenger_img\").style.border=\"1px solid #273679\",document.getElementById(\"facebook_messenger_img\").style.borderRadius=\"0.4rem\",document.getElementById(\"check_btn_facebook_messenger\").innerHTML='<i class=\"fa fa-check-circle\" aria-hidden=\"true\" style=\"color:#273679;margin-left: -1.0rem;margin-top:4px\"></i>')}))},methods:{get_integration_details:function(){var e=this;this.big_spinner=!0,o.a.post(p.a.chatbot_integration_details(),{is_get:!0,company_name:this.company_name,company_id:this.company_id,email:this.$session.get(\"UserInformation\").email,license_key:this.$session.get(\"UserInformation\").license_key,token:this.$session.get(\"UserInformation\").tokens},{headers:{Authorization:\"Bearer \".concat(this.$session.get(\"at\"))}}).then((function(t){var s=t.data;if(e.big_spinner=!1,s.message.MSG_CODE!=e.api_status_code.STATUS_SUCCESS.MSG_CODE){if(\"facebook_details\"in s.data&&0!=s.data.facebook_details.length){var a=!0;e.$root.$emit(\"messenger_framework_integrated\",a,\"facebook_details\")}if(\"whatsapp_request_form\"in s.data&&0!=s.data.whatsapp_details.length){a=!0;e.$root.$emit(\"messenger_framework_integrated\",a,\"whatsapp_request_form\")}}else e.api_status_code.EMPTY_DATA.MSG_CODE==s.message.MSG_CODE||r()({title:s.message.MSG_CODE,text:s.message.MSG,showCancelButton:!1,showConfirmButton:!1,toast:!0,position:\"top-end\",timer:2500,type:\"error\"})})).catch((function(t){e.big_spinner=!1,410!==t.response.status&&440!==t.response.status&&409!==t.response.status||e.$root.$emit(\"Session_Expired\",t.response.data)}))}}},I=O,A=(s(\"8a1f\"),Object(h[\"a\"])(I,a,i,!1,null,\"48b5181e\",null));t[\"default\"]=A.exports}}]);","extractedComments":[]}